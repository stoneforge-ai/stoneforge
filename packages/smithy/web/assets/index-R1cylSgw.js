var I1e=Object.defineProperty;var _H=e=>{throw TypeError(e)};var R1e=(e,t,r)=>t in e?I1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var xt=(e,t,r)=>R1e(e,typeof t!="symbol"?t+"":t,r),NH=(e,t,r)=>t.has(e)||_H("Cannot "+r);var gv=(e,t,r)=>(NH(e,t,"read from private field"),r?r.call(e):t.get(e)),CH=(e,t,r)=>t.has(e)?_H("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),jH=(e,t,r,n)=>(NH(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{d as P1e,e as z1e,r as w,j as o,u as gt,c as pd,f as gd,g as Fr,R as le,i as gh,h as ht,k as Ct,l as B1e,w as $1e,a as F1e,m as UC,L as Aae,n as U1e,o as Ma,p as Dae,O as Lae,q as rl,s as H1e,t as q1e,v as W1e,x as yi,y as K1e,z as G1e,Q as V1e,A as Y1e,B as Q1e}from"./router-vendor-DHlGizSU.js";import{X as wt,C as cr,a as Xg,b as Vn,M as E6,c as Jk,S as Zk,d as Fl,P as HC,G as cu,L as Ox,e as Od,U as Zr,B as Xr,T as M6,f as gn,F as J1e,W as vh,g as Ii,h as EH,A as Ix,i as Rx,j as Bn,k as ay,l as Zo,m as Z1e,n as X1e,o as $e,p as tn,E as Sl,q as li,r as ewe,s as qC,H as qp,t as oi,u as Yn,v as T6,w as Wp,x as Oae,y as br,z as Bt,D as Sr,I as A6,J as _r,K as Uh,N as WC,O as en,Q as tu,R as KC,V as Iae,Y as Rs,Z as e0,_ as ru,$ as Vc,a0 as _O,a1 as NO,a2 as Kp,a3 as Bs,a4 as Rae,a5 as Pae,a6 as twe,a7 as Tl,a8 as rn,a9 as rwe,aa as nwe,ab as awe,ac as zae,ad as Bae,ae as iy,af as iwe,ag as Px,ah as $ae,ai as Fae,aj as Hh,ak as rs,al as Ri,am as bh,an as ss,ao as GC,ap as swe,aq as jr,ar as VC,as as YC,at as QC,au as na,av as nu,aw as owe,ax as uu,ay as D6,az as JC,aA as lwe,aB as Uae,aC as Kr,aD as cwe,aE as CO,aF as uwe,aG as Xi,aH as qh,aI as L6,aJ as dwe,aK as Hae,aL as qae,aM as Wae,aN as fwe,aO as hwe,aP as mwe,aQ as Kae,aR as Gae,aS as Pi,aT as pwe,aU as Xo,aV as gwe,aW as t0,aX as vwe,aY as bwe,aZ as du,a_ as ywe,a$ as jO,b0 as r0,b1 as Xf,b2 as O6,b3 as xwe,b4 as I6,b5 as Vae,b6 as wwe,b7 as Swe,b8 as Yae,b9 as kwe,ba as eh,bb as R6,bc as ZC,bd as n0,be as _we,bf as Qae,bg as Nwe,bh as Cwe,bi as jwe,bj as XC,bk as kd,bl as dT,bm as EO,bn as Jae,bo as ej,bp as sy,bq as zx,br as Zae,bs as Ewe,bt as P6,bu as a0,bv as Mwe,bw as Twe,bx as Awe,by as Dwe,bz as MO,bA as Xae,bB as hk,bC as z6,bD as eie,bE as Lwe,bF as B6,bG as Owe,bH as Iwe,bI as Rwe,bJ as oy,bK as Pwe,bL as zwe,bM as tie,bN as rie,bO as nie,bP as Bwe,bQ as fT,bR as $we,bS as Fwe,bT as Uwe,bU as Hwe,bV as qwe}from"./utils-vendor-DaJ2Dubl.js";import{O as tj,P as $6,C as rj,a as F6,T as nj,D as U6,b as aie,I as Wwe,S as iie,d as sie,e as Kwe,f as oie,V as Gwe,L as lie,g as cie,h as Vwe,i as Ywe,j as uie,k as die,l as fie,m as hie,n as mie,A as pie,o as gie,p as Qwe,q as Jwe,r as Zwe,s as Xwe,t as Bc,v as vie,w as eSe,x as tSe,y as bie,z as rSe,B as nSe,E as aSe,F as iSe,R as yie,G as sSe,H as oSe,J as lSe,K as cSe,M as uSe,N as dSe,Q as fSe,U as hSe,W as xie,X as wie,Y as Sie,Z as kie,_ as _s,$ as mk}from"./ui-vendor-BSco96uv.js";import{e as Gp,l as ws,m as TO,U as mSe}from"./monaco-editor-B4lwqA13.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var hT={exports:{}},vv={},mT={exports:{}},pT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MH;function pSe(){return MH||(MH=1,(function(e){function t(I,B){var F=I.length;I.push(B);e:for(;0<F;){var U=F-1>>>1,V=I[U];if(0<a(V,B))I[U]=B,I[F]=V,F=U;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var B=I[0],F=I.pop();if(F!==B){I[0]=F;e:for(var U=0,V=I.length,K=V>>>1;U<K;){var G=2*(U+1)-1,J=I[G],ee=G+1,Y=I[ee];if(0>a(J,F))ee<V&&0>a(Y,J)?(I[U]=Y,I[ee]=F,U=ee):(I[U]=J,I[G]=F,U=G);else if(ee<V&&0>a(Y,F))I[U]=Y,I[ee]=F,U=ee;else break e}}return B}function a(I,B){var F=I.sortIndex-B.sortIndex;return F!==0?F:I.id-B.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,f=null,m=3,p=!1,v=!1,b=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function k(I){for(var B=r(u);B!==null;){if(B.callback===null)n(u);else if(B.startTime<=I)n(u),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(u)}}function j(I){if(b=!1,k(I),!v)if(r(c)!==null)v=!0,E||(E=!0,L());else{var B=r(u);B!==null&&z(j,B.startTime-I)}}var E=!1,T=-1,O=5,R=-1;function q(){return y?!0:!(e.unstable_now()-R<O)}function $(){if(y=!1,E){var I=e.unstable_now();R=I;var B=!0;try{e:{v=!1,b&&(b=!1,_(T),T=-1),p=!0;var F=m;try{t:{for(k(I),f=r(c);f!==null&&!(f.expirationTime>I&&q());){var U=f.callback;if(typeof U=="function"){f.callback=null,m=f.priorityLevel;var V=U(f.expirationTime<=I);if(I=e.unstable_now(),typeof V=="function"){f.callback=V,k(I),B=!0;break t}f===r(c)&&n(c),k(I)}else n(c);f=r(c)}if(f!==null)B=!0;else{var K=r(u);K!==null&&z(j,K.startTime-I),B=!1}}break e}finally{f=null,m=F,p=!1}B=void 0}}finally{B?L():E=!1}}}var L;if(typeof N=="function")L=function(){N($)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,M=A.port2;A.port1.onmessage=$,L=function(){M.postMessage(null)}}else L=function(){S($,0)};function z(I,B){T=S(function(){I(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(I){switch(m){case 1:case 2:case 3:var B=3;break;default:B=m}var F=m;m=B;try{return I()}finally{m=F}},e.unstable_requestPaint=function(){y=!0},e.unstable_runWithPriority=function(I,B){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var F=m;m=I;try{return B()}finally{m=F}},e.unstable_scheduleCallback=function(I,B,F){var U=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?U+F:U):F=U,I){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=F+V,I={id:d++,callback:B,priorityLevel:I,startTime:F,expirationTime:V,sortIndex:-1},F>U?(I.sortIndex=F,t(u,I),r(c)===null&&I===r(u)&&(b?(_(T),T=-1):b=!0,z(j,F-U))):(I.sortIndex=V,t(c,I),v||p||(v=!0,E||(E=!0,L()))),I},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(I){var B=m;return function(){var F=m;m=B;try{return I.apply(this,arguments)}finally{m=F}}}})(pT)),pT}var TH;function gSe(){return TH||(TH=1,mT.exports=pSe()),mT.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AH;function vSe(){if(AH)return vv;AH=1;var e=gSe(),t=P1e(),r=z1e();function n(h){var g="https://react.dev/errors/"+h;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)g+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function i(h){var g=h,x=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,(g.flags&4098)!==0&&(x=g.return),h=g.return;while(h)}return g.tag===3?x:null}function s(h){if(h.tag===13){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function l(h){if(h.tag===31){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function c(h){if(i(h)!==h)throw Error(n(188))}function u(h){var g=h.alternate;if(!g){if(g=i(h),g===null)throw Error(n(188));return g!==h?null:h}for(var x=h,C=g;;){var D=x.return;if(D===null)break;var P=D.alternate;if(P===null){if(C=D.return,C!==null){x=C;continue}break}if(D.child===P.child){for(P=D.child;P;){if(P===x)return c(D),h;if(P===C)return c(D),g;P=P.sibling}throw Error(n(188))}if(x.return!==C.return)x=D,C=P;else{for(var Q=!1,ae=D.child;ae;){if(ae===x){Q=!0,x=D,C=P;break}if(ae===C){Q=!0,C=D,x=P;break}ae=ae.sibling}if(!Q){for(ae=P.child;ae;){if(ae===x){Q=!0,x=P,C=D;break}if(ae===C){Q=!0,C=P,x=D;break}ae=ae.sibling}if(!Q)throw Error(n(189))}}if(x.alternate!==C)throw Error(n(190))}if(x.tag!==3)throw Error(n(188));return x.stateNode.current===x?h:g}function d(h){var g=h.tag;if(g===5||g===26||g===27||g===6)return h;for(h=h.child;h!==null;){if(g=d(h),g!==null)return g;h=h.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),N=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function L(h){return h===null||typeof h!="object"?null:(h=$&&h[$]||h["@@iterator"],typeof h=="function"?h:null)}var A=Symbol.for("react.client.reference");function M(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===A?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case b:return"Fragment";case S:return"Profiler";case y:return"StrictMode";case j:return"Suspense";case E:return"SuspenseList";case R:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case v:return"Portal";case N:return h.displayName||"Context";case _:return(h._context.displayName||"Context")+".Consumer";case k:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case T:return g=h.displayName||null,g!==null?g:M(h.type)||"Memo";case O:g=h._payload,h=h._init;try{return M(h(g))}catch{}}return null}var z=Array.isArray,I=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},U=[],V=-1;function K(h){return{current:h}}function G(h){0>V||(h.current=U[V],U[V]=null,V--)}function J(h,g){V++,U[V]=h.current,h.current=g}var ee=K(null),Y=K(null),ie=K(null),fe=K(null);function me(h,g){switch(J(ie,g),J(Y,h),J(ee,null),g.nodeType){case 9:case 11:h=(h=g.documentElement)&&(h=h.namespaceURI)?GU(h):0;break;default:if(h=g.tagName,g=g.namespaceURI)g=GU(g),h=VU(g,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}G(ee),J(ee,h)}function te(){G(ee),G(Y),G(ie)}function oe(h){h.memoizedState!==null&&J(fe,h);var g=ee.current,x=VU(g,h.type);g!==x&&(J(Y,h),J(ee,x))}function ce(h){Y.current===h&&(G(ee),G(Y)),fe.current===h&&(G(fe),fv._currentValue=F)}var Z,ue;function H(h){if(Z===void 0)try{throw Error()}catch(x){var g=x.stack.trim().match(/\n( *(at )?)/);Z=g&&g[1]||"",ue=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+h+ue}var ge=!1;function de(h,g){if(!h||ge)return"";ge=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(g){var He=function(){throw Error()};if(Object.defineProperty(He.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(He,[])}catch(Ie){var Te=Ie}Reflect.construct(h,[],He)}else{try{He.call()}catch(Ie){Te=Ie}h.call(He.prototype)}}else{try{throw Error()}catch(Ie){Te=Ie}(He=h())&&typeof He.catch=="function"&&He.catch(function(){})}}catch(Ie){if(Ie&&Te&&typeof Ie.stack=="string")return[Ie.stack,Te.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=C.DetermineComponentFrameRoot(),Q=P[0],ae=P[1];if(Q&&ae){var ye=Q.split(`
`),Ee=ae.split(`
`);for(D=C=0;C<ye.length&&!ye[C].includes("DetermineComponentFrameRoot");)C++;for(;D<Ee.length&&!Ee[D].includes("DetermineComponentFrameRoot");)D++;if(C===ye.length||D===Ee.length)for(C=ye.length-1,D=Ee.length-1;1<=C&&0<=D&&ye[C]!==Ee[D];)D--;for(;1<=C&&0<=D;C--,D--)if(ye[C]!==Ee[D]){if(C!==1||D!==1)do if(C--,D--,0>D||ye[C]!==Ee[D]){var Pe=`
`+ye[C].replace(" at new "," at ");return h.displayName&&Pe.includes("<anonymous>")&&(Pe=Pe.replace("<anonymous>",h.displayName)),Pe}while(1<=C&&0<=D);break}}}finally{ge=!1,Error.prepareStackTrace=x}return(x=h?h.displayName||h.name:"")?H(x):""}function re(h,g){switch(h.tag){case 26:case 27:case 5:return H(h.type);case 16:return H("Lazy");case 13:return h.child!==g&&g!==null?H("Suspense Fallback"):H("Suspense");case 19:return H("SuspenseList");case 0:case 15:return de(h.type,!1);case 11:return de(h.type.render,!1);case 1:return de(h.type,!0);case 31:return H("Activity");default:return""}}function ne(h){try{var g="",x=null;do g+=re(h,x),x=h,h=h.return;while(h);return g}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}var pe=Object.prototype.hasOwnProperty,ke=e.unstable_scheduleCallback,we=e.unstable_cancelCallback,ve=e.unstable_shouldYield,Le=e.unstable_requestPaint,Ae=e.unstable_now,Re=e.unstable_getCurrentPriorityLevel,Ye=e.unstable_ImmediatePriority,mt=e.unstable_UserBlockingPriority,ot=e.unstable_NormalPriority,Ot=e.unstable_LowPriority,rt=e.unstable_IdlePriority,ze=e.log,bt=e.unstable_setDisableYieldValue,tt=null,_e=null;function We(h){if(typeof ze=="function"&&bt(h),_e&&typeof _e.setStrictMode=="function")try{_e.setStrictMode(tt,h)}catch{}}var Ve=Math.clz32?Math.clz32:er,Mt=Math.log,kt=Math.LN2;function er(h){return h>>>=0,h===0?32:31-(Mt(h)/kt|0)|0}var mr=256,Zt=262144,Wt=4194304;function Rt(h){var g=h&42;if(g!==0)return g;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return h&261888;case 262144:case 524288:case 1048576:case 2097152:return h&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function he(h,g,x){var C=h.pendingLanes;if(C===0)return 0;var D=0,P=h.suspendedLanes,Q=h.pingedLanes;h=h.warmLanes;var ae=C&134217727;return ae!==0?(C=ae&~P,C!==0?D=Rt(C):(Q&=ae,Q!==0?D=Rt(Q):x||(x=ae&~h,x!==0&&(D=Rt(x))))):(ae=C&~P,ae!==0?D=Rt(ae):Q!==0?D=Rt(Q):x||(x=C&~h,x!==0&&(D=Rt(x)))),D===0?0:g!==0&&g!==D&&(g&P)===0&&(P=D&-D,x=g&-g,P>=x||P===32&&(x&4194048)!==0)?g:D}function De(h,g){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&g)===0}function Ue(h,g){switch(h){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ut(){var h=Wt;return Wt<<=1,(Wt&62914560)===0&&(Wt=4194304),h}function St(h){for(var g=[],x=0;31>x;x++)g.push(h);return g}function jt(h,g){h.pendingLanes|=g,g!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function Je(h,g,x,C,D,P){var Q=h.pendingLanes;h.pendingLanes=x,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=x,h.entangledLanes&=x,h.errorRecoveryDisabledLanes&=x,h.shellSuspendCounter=0;var ae=h.entanglements,ye=h.expirationTimes,Ee=h.hiddenUpdates;for(x=Q&~x;0<x;){var Pe=31-Ve(x),He=1<<Pe;ae[Pe]=0,ye[Pe]=-1;var Te=Ee[Pe];if(Te!==null)for(Ee[Pe]=null,Pe=0;Pe<Te.length;Pe++){var Ie=Te[Pe];Ie!==null&&(Ie.lane&=-536870913)}x&=~He}C!==0&&Xe(h,C,0),P!==0&&D===0&&h.tag!==0&&(h.suspendedLanes|=P&~(Q&~g))}function Xe(h,g,x){h.pendingLanes|=g,h.suspendedLanes&=~g;var C=31-Ve(g);h.entangledLanes|=g,h.entanglements[C]=h.entanglements[C]|1073741824|x&261930}function it(h,g){var x=h.entangledLanes|=g;for(h=h.entanglements;x;){var C=31-Ve(x),D=1<<C;D&g|h[C]&g&&(h[C]|=g),x&=~D}}function Xt(h,g){var x=g&-g;return x=(x&42)!==0?1:X(x),(x&(h.suspendedLanes|g))!==0?0:x}function X(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function Oe(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function Ke(){var h=B.p;return h!==0?h:(h=window.event,h===void 0?32:vH(h.type))}function be(h,g){var x=B.p;try{return B.p=h,g()}finally{B.p=x}}var W=Math.random().toString(36).slice(2),se="__reactFiber$"+W,xe="__reactProps$"+W,Ce="__reactContainer$"+W,dt="__reactEvents$"+W,st="__reactListeners$"+W,Tt="__reactHandles$"+W,Ft="__reactResources$"+W,lt="__reactMarker$"+W;function Pt(h){delete h[se],delete h[xe],delete h[dt],delete h[st],delete h[Tt]}function ct(h){var g=h[se];if(g)return g;for(var x=h.parentNode;x;){if(g=x[Ce]||x[se]){if(x=g.alternate,g.child!==null||x!==null&&x.child!==null)for(h=tH(h);h!==null;){if(x=h[se])return x;h=tH(h)}return g}h=x,x=h.parentNode}return null}function Ht(h){if(h=h[se]||h[Ce]){var g=h.tag;if(g===5||g===6||g===13||g===31||g===26||g===27||g===3)return h}return null}function rr(h){var g=h.tag;if(g===5||g===26||g===27||g===6)return h.stateNode;throw Error(n(33))}function Dr(h){var g=h[Ft];return g||(g=h[Ft]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function vn(h){h[lt]=!0}var gm=new Set,Kl={};function Mo(h,g){Qe(h,g),Qe(h+"Capture",g)}function Qe(h,g){for(Kl[h]=g,h=0;h<g.length;h++)gm.add(g[h])}var Et=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sr={},Br={};function On(h){return pe.call(Br,h)?!0:pe.call(sr,h)?!1:Et.test(h)?Br[h]=!0:(sr[h]=!0,!1)}function Aa(h,g,x){if(On(g))if(x===null)h.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":h.removeAttribute(g);return;case"boolean":var C=g.toLowerCase().slice(0,5);if(C!=="data-"&&C!=="aria-"){h.removeAttribute(g);return}}h.setAttribute(g,""+x)}}function ki(h,g,x){if(x===null)h.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(g);return}h.setAttribute(g,""+x)}}function di(h,g,x,C){if(C===null)h.removeAttribute(x);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(x);return}h.setAttributeNS(g,x,""+C)}}function nn(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function _i(h){var g=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function vm(h,g,x){var C=Object.getOwnPropertyDescriptor(h.constructor.prototype,g);if(!h.hasOwnProperty(g)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var D=C.get,P=C.set;return Object.defineProperty(h,g,{configurable:!0,get:function(){return D.call(this)},set:function(Q){x=""+Q,P.call(this,Q)}}),Object.defineProperty(h,g,{enumerable:C.enumerable}),{getValue:function(){return x},setValue:function(Q){x=""+Q},stopTracking:function(){h._valueTracker=null,delete h[g]}}}}function Gl(h){if(!h._valueTracker){var g=_i(h)?"checked":"value";h._valueTracker=vm(h,g,""+h[g])}}function Yd(h){if(!h)return!1;var g=h._valueTracker;if(!g)return!0;var x=g.getValue(),C="";return h&&(C=_i(h)?h.checked?"true":"false":h.value),h=C,h!==x?(g.setValue(h),!0):!1}function Vl(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var C0=/[\n"\\]/g;function fi(h){return h.replace(C0,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Yl(h,g,x,C,D,P,Q,ae){h.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?h.type=Q:h.removeAttribute("type"),g!=null?Q==="number"?(g===0&&h.value===""||h.value!=g)&&(h.value=""+nn(g)):h.value!==""+nn(g)&&(h.value=""+nn(g)):Q!=="submit"&&Q!=="reset"||h.removeAttribute("value"),g!=null?wu(h,Q,nn(g)):x!=null?wu(h,Q,nn(x)):C!=null&&h.removeAttribute("value"),D==null&&P!=null&&(h.defaultChecked=!!P),D!=null&&(h.checked=D&&typeof D!="function"&&typeof D!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?h.name=""+nn(ae):h.removeAttribute("name")}function Ql(h,g,x,C,D,P,Q,ae){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(h.type=P),g!=null||x!=null){if(!(P!=="submit"&&P!=="reset"||g!=null)){Gl(h);return}x=x!=null?""+nn(x):"",g=g!=null?""+nn(g):x,ae||g===h.value||(h.value=g),h.defaultValue=g}C=C??D,C=typeof C!="function"&&typeof C!="symbol"&&!!C,h.checked=ae?h.checked:!!C,h.defaultChecked=!!C,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(h.name=Q),Gl(h)}function wu(h,g,x){g==="number"&&Vl(h.ownerDocument)===h||h.defaultValue===""+x||(h.defaultValue=""+x)}function aa(h,g,x,C){if(h=h.options,g){g={};for(var D=0;D<x.length;D++)g["$"+x[D]]=!0;for(x=0;x<h.length;x++)D=g.hasOwnProperty("$"+h[x].value),h[x].selected!==D&&(h[x].selected=D),D&&C&&(h[x].defaultSelected=!0)}else{for(x=""+nn(x),g=null,D=0;D<h.length;D++){if(h[D].value===x){h[D].selected=!0,C&&(h[D].defaultSelected=!0);return}g!==null||h[D].disabled||(g=h[D])}g!==null&&(g.selected=!0)}}function I1(h,g,x){if(g!=null&&(g=""+nn(g),g!==h.value&&(h.value=g),x==null)){h.defaultValue!==g&&(h.defaultValue=g);return}h.defaultValue=x!=null?""+nn(x):""}function bm(h,g,x,C){if(g==null){if(C!=null){if(x!=null)throw Error(n(92));if(z(C)){if(1<C.length)throw Error(n(93));C=C[0]}x=C}x==null&&(x=""),g=x}x=nn(g),h.defaultValue=x,C=h.textContent,C===x&&C!==""&&C!==null&&(h.value=C),Gl(h)}function Kt(h,g){if(g){var x=h.firstChild;if(x&&x===h.lastChild&&x.nodeType===3){x.nodeValue=g;return}}h.textContent=g}var R1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ia(h,g,x){var C=g.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?C?h.setProperty(g,""):g==="float"?h.cssFloat="":h[g]="":C?h.setProperty(g,x):typeof x!="number"||x===0||R1.has(g)?g==="float"?h.cssFloat=x:h[g]=(""+x).trim():h[g]=x+"px"}function Vr(h,g,x){if(g!=null&&typeof g!="object")throw Error(n(62));if(h=h.style,x!=null){for(var C in x)!x.hasOwnProperty(C)||g!=null&&g.hasOwnProperty(C)||(C.indexOf("--")===0?h.setProperty(C,""):C==="float"?h.cssFloat="":h[C]="");for(var D in g)C=g[D],g.hasOwnProperty(D)&&x[D]!==C&&ia(h,D,C)}else for(var P in g)g.hasOwnProperty(P)&&ia(h,P,g[P])}function Su(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),j0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ku(h){return j0.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}function at(){}var _t=null;function nr(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var yr=null,In=null;function qs(h){var g=Ht(h);if(g&&(h=g.stateNode)){var x=h[xe]||null;e:switch(h=g.stateNode,g.type){case"input":if(Yl(h,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),g=x.name,x.type==="radio"&&g!=null){for(x=h;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+fi(""+g)+'"][type="radio"]'),g=0;g<x.length;g++){var C=x[g];if(C!==h&&C.form===h.form){var D=C[xe]||null;if(!D)throw Error(n(90));Yl(C,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(g=0;g<x.length;g++)C=x[g],C.form===h.form&&Yd(C)}break e;case"textarea":I1(h,x.value,x.defaultValue);break e;case"select":g=x.value,g!=null&&aa(h,!!x.multiple,g,!1)}}}var E0=!1;function P1(h,g,x){if(E0)return h(g,x);E0=!0;try{var C=h(g);return C}finally{if(E0=!1,(yr!==null||In!==null)&&(_w(),yr&&(g=yr,h=In,In=yr=null,qs(g),h)))for(g=0;g<h.length;g++)qs(h[g])}}function M0(h,g){var x=h.stateNode;if(x===null)return null;var C=x[xe]||null;if(C===null)return null;x=C[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(h=h.type,C=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!C;break e;default:h=!1}if(h)return null;if(x&&typeof x!="function")throw Error(n(231,g,typeof x));return x}var Zl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dE=!1;if(Zl)try{var T0={};Object.defineProperty(T0,"passive",{get:function(){dE=!0}}),window.addEventListener("test",T0,T0),window.removeEventListener("test",T0,T0)}catch{dE=!1}var _u=null,fE=null,z1=null;function V$(){if(z1)return z1;var h,g=fE,x=g.length,C,D="value"in _u?_u.value:_u.textContent,P=D.length;for(h=0;h<x&&g[h]===D[h];h++);var Q=x-h;for(C=1;C<=Q&&g[x-C]===D[P-C];C++);return z1=D.slice(h,1<C?1-C:void 0)}function B1(h){var g=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&g===13&&(h=13)):h=g,h===10&&(h=13),32<=h||h===13?h:0}function $1(){return!0}function Y$(){return!1}function Wi(h){function g(x,C,D,P,Q){this._reactName=x,this._targetInst=D,this.type=C,this.nativeEvent=P,this.target=Q,this.currentTarget=null;for(var ae in h)h.hasOwnProperty(ae)&&(x=h[ae],this[ae]=x?x(P):P[ae]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?$1:Y$,this.isPropagationStopped=Y$,this}return f(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=$1)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=$1)},persist:function(){},isPersistent:$1}),g}var Qd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},F1=Wi(Qd),A0=f({},Qd,{view:0,detail:0}),Lye=Wi(A0),hE,mE,D0,U1=f({},A0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gE,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==D0&&(D0&&h.type==="mousemove"?(hE=h.screenX-D0.screenX,mE=h.screenY-D0.screenY):mE=hE=0,D0=h),hE)},movementY:function(h){return"movementY"in h?h.movementY:mE}}),Q$=Wi(U1),Oye=f({},U1,{dataTransfer:0}),Iye=Wi(Oye),Rye=f({},A0,{relatedTarget:0}),pE=Wi(Rye),Pye=f({},Qd,{animationName:0,elapsedTime:0,pseudoElement:0}),zye=Wi(Pye),Bye=f({},Qd,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),$ye=Wi(Bye),Fye=f({},Qd,{data:0}),J$=Wi(Fye),Uye={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hye={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qye={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wye(h){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(h):(h=qye[h])?!!g[h]:!1}function gE(){return Wye}var Kye=f({},A0,{key:function(h){if(h.key){var g=Uye[h.key]||h.key;if(g!=="Unidentified")return g}return h.type==="keypress"?(h=B1(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?Hye[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gE,charCode:function(h){return h.type==="keypress"?B1(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?B1(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),Gye=Wi(Kye),Vye=f({},U1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Z$=Wi(Vye),Yye=f({},A0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gE}),Qye=Wi(Yye),Jye=f({},Qd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zye=Wi(Jye),Xye=f({},U1,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),exe=Wi(Xye),txe=f({},Qd,{newState:0,oldState:0}),rxe=Wi(txe),nxe=[9,13,27,32],vE=Zl&&"CompositionEvent"in window,L0=null;Zl&&"documentMode"in document&&(L0=document.documentMode);var axe=Zl&&"TextEvent"in window&&!L0,X$=Zl&&(!vE||L0&&8<L0&&11>=L0),e8=" ",t8=!1;function r8(h,g){switch(h){case"keyup":return nxe.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function n8(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var ym=!1;function ixe(h,g){switch(h){case"compositionend":return n8(g);case"keypress":return g.which!==32?null:(t8=!0,e8);case"textInput":return h=g.data,h===e8&&t8?null:h;default:return null}}function sxe(h,g){if(ym)return h==="compositionend"||!vE&&r8(h,g)?(h=V$(),z1=fE=_u=null,ym=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return X$&&g.locale!=="ko"?null:g.data;default:return null}}var oxe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a8(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g==="input"?!!oxe[h.type]:g==="textarea"}function i8(h,g,x,C){yr?In?In.push(C):In=[C]:yr=C,g=Aw(g,"onChange"),0<g.length&&(x=new F1("onChange","change",null,x,C),h.push({event:x,listeners:g}))}var O0=null,I0=null;function lxe(h){FU(h,0)}function H1(h){var g=rr(h);if(Yd(g))return h}function s8(h,g){if(h==="change")return g}var o8=!1;if(Zl){var bE;if(Zl){var yE="oninput"in document;if(!yE){var l8=document.createElement("div");l8.setAttribute("oninput","return;"),yE=typeof l8.oninput=="function"}bE=yE}else bE=!1;o8=bE&&(!document.documentMode||9<document.documentMode)}function c8(){O0&&(O0.detachEvent("onpropertychange",u8),I0=O0=null)}function u8(h){if(h.propertyName==="value"&&H1(I0)){var g=[];i8(g,I0,h,nr(h)),P1(lxe,g)}}function cxe(h,g,x){h==="focusin"?(c8(),O0=g,I0=x,O0.attachEvent("onpropertychange",u8)):h==="focusout"&&c8()}function uxe(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return H1(I0)}function dxe(h,g){if(h==="click")return H1(g)}function fxe(h,g){if(h==="input"||h==="change")return H1(g)}function hxe(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var cs=typeof Object.is=="function"?Object.is:hxe;function R0(h,g){if(cs(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var x=Object.keys(h),C=Object.keys(g);if(x.length!==C.length)return!1;for(C=0;C<x.length;C++){var D=x[C];if(!pe.call(g,D)||!cs(h[D],g[D]))return!1}return!0}function d8(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function f8(h,g){var x=d8(h);h=0;for(var C;x;){if(x.nodeType===3){if(C=h+x.textContent.length,h<=g&&C>=g)return{node:x,offset:g-h};h=C}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=d8(x)}}function h8(h,g){return h&&g?h===g?!0:h&&h.nodeType===3?!1:g&&g.nodeType===3?h8(h,g.parentNode):"contains"in h?h.contains(g):h.compareDocumentPosition?!!(h.compareDocumentPosition(g)&16):!1:!1}function m8(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var g=Vl(h.document);g instanceof h.HTMLIFrameElement;){try{var x=typeof g.contentWindow.location.href=="string"}catch{x=!1}if(x)h=g.contentWindow;else break;g=Vl(h.document)}return g}function xE(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g&&(g==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||g==="textarea"||h.contentEditable==="true")}var mxe=Zl&&"documentMode"in document&&11>=document.documentMode,xm=null,wE=null,P0=null,SE=!1;function p8(h,g,x){var C=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;SE||xm==null||xm!==Vl(C)||(C=xm,"selectionStart"in C&&xE(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),P0&&R0(P0,C)||(P0=C,C=Aw(wE,"onSelect"),0<C.length&&(g=new F1("onSelect","select",null,g,x),h.push({event:g,listeners:C}),g.target=xm)))}function Jd(h,g){var x={};return x[h.toLowerCase()]=g.toLowerCase(),x["Webkit"+h]="webkit"+g,x["Moz"+h]="moz"+g,x}var wm={animationend:Jd("Animation","AnimationEnd"),animationiteration:Jd("Animation","AnimationIteration"),animationstart:Jd("Animation","AnimationStart"),transitionrun:Jd("Transition","TransitionRun"),transitionstart:Jd("Transition","TransitionStart"),transitioncancel:Jd("Transition","TransitionCancel"),transitionend:Jd("Transition","TransitionEnd")},kE={},g8={};Zl&&(g8=document.createElement("div").style,"AnimationEvent"in window||(delete wm.animationend.animation,delete wm.animationiteration.animation,delete wm.animationstart.animation),"TransitionEvent"in window||delete wm.transitionend.transition);function Zd(h){if(kE[h])return kE[h];if(!wm[h])return h;var g=wm[h],x;for(x in g)if(g.hasOwnProperty(x)&&x in g8)return kE[h]=g[x];return h}var v8=Zd("animationend"),b8=Zd("animationiteration"),y8=Zd("animationstart"),pxe=Zd("transitionrun"),gxe=Zd("transitionstart"),vxe=Zd("transitioncancel"),x8=Zd("transitionend"),w8=new Map,_E="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_E.push("scrollEnd");function To(h,g){w8.set(h,g),Mo(g,[h])}var q1=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)},Ws=[],Sm=0,NE=0;function W1(){for(var h=Sm,g=NE=Sm=0;g<h;){var x=Ws[g];Ws[g++]=null;var C=Ws[g];Ws[g++]=null;var D=Ws[g];Ws[g++]=null;var P=Ws[g];if(Ws[g++]=null,C!==null&&D!==null){var Q=C.pending;Q===null?D.next=D:(D.next=Q.next,Q.next=D),C.pending=D}P!==0&&S8(x,D,P)}}function K1(h,g,x,C){Ws[Sm++]=h,Ws[Sm++]=g,Ws[Sm++]=x,Ws[Sm++]=C,NE|=C,h.lanes|=C,h=h.alternate,h!==null&&(h.lanes|=C)}function CE(h,g,x,C){return K1(h,g,x,C),G1(h)}function Xd(h,g){return K1(h,null,null,g),G1(h)}function S8(h,g,x){h.lanes|=x;var C=h.alternate;C!==null&&(C.lanes|=x);for(var D=!1,P=h.return;P!==null;)P.childLanes|=x,C=P.alternate,C!==null&&(C.childLanes|=x),P.tag===22&&(h=P.stateNode,h===null||h._visibility&1||(D=!0)),h=P,P=P.return;return h.tag===3?(P=h.stateNode,D&&g!==null&&(D=31-Ve(x),h=P.hiddenUpdates,C=h[D],C===null?h[D]=[g]:C.push(g),g.lane=x|536870912),P):null}function G1(h){if(50<iv)throw iv=0,IM=null,Error(n(185));for(var g=h.return;g!==null;)h=g,g=h.return;return h.tag===3?h.stateNode:null}var km={};function bxe(h,g,x,C){this.tag=h,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function us(h,g,x,C){return new bxe(h,g,x,C)}function jE(h){return h=h.prototype,!(!h||!h.isReactComponent)}function Xl(h,g){var x=h.alternate;return x===null?(x=us(h.tag,g,h.key,h.mode),x.elementType=h.elementType,x.type=h.type,x.stateNode=h.stateNode,x.alternate=h,h.alternate=x):(x.pendingProps=g,x.type=h.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=h.flags&65011712,x.childLanes=h.childLanes,x.lanes=h.lanes,x.child=h.child,x.memoizedProps=h.memoizedProps,x.memoizedState=h.memoizedState,x.updateQueue=h.updateQueue,g=h.dependencies,x.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},x.sibling=h.sibling,x.index=h.index,x.ref=h.ref,x.refCleanup=h.refCleanup,x}function k8(h,g){h.flags&=65011714;var x=h.alternate;return x===null?(h.childLanes=0,h.lanes=g,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=x.childLanes,h.lanes=x.lanes,h.child=x.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=x.memoizedProps,h.memoizedState=x.memoizedState,h.updateQueue=x.updateQueue,h.type=x.type,g=x.dependencies,h.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),h}function V1(h,g,x,C,D,P){var Q=0;if(C=h,typeof h=="function")jE(h)&&(Q=1);else if(typeof h=="string")Q=k1e(h,x,ee.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case R:return h=us(31,x,g,D),h.elementType=R,h.lanes=P,h;case b:return ef(x.children,D,P,g);case y:Q=8,D|=24;break;case S:return h=us(12,x,g,D|2),h.elementType=S,h.lanes=P,h;case j:return h=us(13,x,g,D),h.elementType=j,h.lanes=P,h;case E:return h=us(19,x,g,D),h.elementType=E,h.lanes=P,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case N:Q=10;break e;case _:Q=9;break e;case k:Q=11;break e;case T:Q=14;break e;case O:Q=16,C=null;break e}Q=29,x=Error(n(130,h===null?"null":typeof h,"")),C=null}return g=us(Q,x,g,D),g.elementType=h,g.type=C,g.lanes=P,g}function ef(h,g,x,C){return h=us(7,h,C,g),h.lanes=x,h}function EE(h,g,x){return h=us(6,h,null,g),h.lanes=x,h}function _8(h){var g=us(18,null,null,0);return g.stateNode=h,g}function ME(h,g,x){return g=us(4,h.children!==null?h.children:[],h.key,g),g.lanes=x,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}var N8=new WeakMap;function Ks(h,g){if(typeof h=="object"&&h!==null){var x=N8.get(h);return x!==void 0?x:(g={value:h,source:g,stack:ne(g)},N8.set(h,g),g)}return{value:h,source:g,stack:ne(g)}}var _m=[],Nm=0,Y1=null,z0=0,Gs=[],Vs=0,Nu=null,sl=1,ol="";function ec(h,g){_m[Nm++]=z0,_m[Nm++]=Y1,Y1=h,z0=g}function C8(h,g,x){Gs[Vs++]=sl,Gs[Vs++]=ol,Gs[Vs++]=Nu,Nu=h;var C=sl;h=ol;var D=32-Ve(C)-1;C&=~(1<<D),x+=1;var P=32-Ve(g)+D;if(30<P){var Q=D-D%5;P=(C&(1<<Q)-1).toString(32),C>>=Q,D-=Q,sl=1<<32-Ve(g)+D|x<<D|C,ol=P+h}else sl=1<<P|x<<D|C,ol=h}function TE(h){h.return!==null&&(ec(h,1),C8(h,1,0))}function AE(h){for(;h===Y1;)Y1=_m[--Nm],_m[Nm]=null,z0=_m[--Nm],_m[Nm]=null;for(;h===Nu;)Nu=Gs[--Vs],Gs[Vs]=null,ol=Gs[--Vs],Gs[Vs]=null,sl=Gs[--Vs],Gs[Vs]=null}function j8(h,g){Gs[Vs++]=sl,Gs[Vs++]=ol,Gs[Vs++]=Nu,sl=g.id,ol=g.overflow,Nu=h}var Ga=null,wn=null,Nr=!1,Cu=null,Ys=!1,DE=Error(n(519));function ju(h){var g=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw B0(Ks(g,h)),DE}function E8(h){var g=h.stateNode,x=h.type,C=h.memoizedProps;switch(g[se]=h,g[xe]=C,x){case"dialog":gr("cancel",g),gr("close",g);break;case"iframe":case"object":case"embed":gr("load",g);break;case"video":case"audio":for(x=0;x<ov.length;x++)gr(ov[x],g);break;case"source":gr("error",g);break;case"img":case"image":case"link":gr("error",g),gr("load",g);break;case"details":gr("toggle",g);break;case"input":gr("invalid",g),Ql(g,C.value,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name,!0);break;case"select":gr("invalid",g);break;case"textarea":gr("invalid",g),bm(g,C.value,C.defaultValue,C.children)}x=C.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||g.textContent===""+x||C.suppressHydrationWarning===!0||WU(g.textContent,x)?(C.popover!=null&&(gr("beforetoggle",g),gr("toggle",g)),C.onScroll!=null&&gr("scroll",g),C.onScrollEnd!=null&&gr("scrollend",g),C.onClick!=null&&(g.onclick=at),g=!0):g=!1,g||ju(h,!0)}function M8(h){for(Ga=h.return;Ga;)switch(Ga.tag){case 5:case 31:case 13:Ys=!1;return;case 27:case 3:Ys=!0;return;default:Ga=Ga.return}}function Cm(h){if(h!==Ga)return!1;if(!Nr)return M8(h),Nr=!0,!1;var g=h.tag,x;if((x=g!==3&&g!==27)&&((x=g===5)&&(x=h.type,x=!(x!=="form"&&x!=="button")||QM(h.type,h.memoizedProps)),x=!x),x&&wn&&ju(h),M8(h),g===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(317));wn=eH(h)}else if(g===31){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(317));wn=eH(h)}else g===27?(g=wn,Fu(h.type)?(h=tT,tT=null,wn=h):wn=g):wn=Ga?Js(h.stateNode.nextSibling):null;return!0}function tf(){wn=Ga=null,Nr=!1}function LE(){var h=Cu;return h!==null&&(Yi===null?Yi=h:Yi.push.apply(Yi,h),Cu=null),h}function B0(h){Cu===null?Cu=[h]:Cu.push(h)}var OE=K(null),rf=null,tc=null;function Eu(h,g,x){J(OE,g._currentValue),g._currentValue=x}function rc(h){h._currentValue=OE.current,G(OE)}function IE(h,g,x){for(;h!==null;){var C=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,C!==null&&(C.childLanes|=g)):C!==null&&(C.childLanes&g)!==g&&(C.childLanes|=g),h===x)break;h=h.return}}function RE(h,g,x,C){var D=h.child;for(D!==null&&(D.return=h);D!==null;){var P=D.dependencies;if(P!==null){var Q=D.child;P=P.firstContext;e:for(;P!==null;){var ae=P;P=D;for(var ye=0;ye<g.length;ye++)if(ae.context===g[ye]){P.lanes|=x,ae=P.alternate,ae!==null&&(ae.lanes|=x),IE(P.return,x,h),C||(Q=null);break e}P=ae.next}}else if(D.tag===18){if(Q=D.return,Q===null)throw Error(n(341));Q.lanes|=x,P=Q.alternate,P!==null&&(P.lanes|=x),IE(Q,x,h),Q=null}else Q=D.child;if(Q!==null)Q.return=D;else for(Q=D;Q!==null;){if(Q===h){Q=null;break}if(D=Q.sibling,D!==null){D.return=Q.return,Q=D;break}Q=Q.return}D=Q}}function jm(h,g,x,C){h=null;for(var D=g,P=!1;D!==null;){if(!P){if((D.flags&524288)!==0)P=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var Q=D.alternate;if(Q===null)throw Error(n(387));if(Q=Q.memoizedProps,Q!==null){var ae=D.type;cs(D.pendingProps.value,Q.value)||(h!==null?h.push(ae):h=[ae])}}else if(D===fe.current){if(Q=D.alternate,Q===null)throw Error(n(387));Q.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(h!==null?h.push(fv):h=[fv])}D=D.return}h!==null&&RE(g,h,x,C),g.flags|=262144}function Q1(h){for(h=h.firstContext;h!==null;){if(!cs(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function nf(h){rf=h,tc=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function Va(h){return T8(rf,h)}function J1(h,g){return rf===null&&nf(h),T8(h,g)}function T8(h,g){var x=g._currentValue;if(g={context:g,memoizedValue:x,next:null},tc===null){if(h===null)throw Error(n(308));tc=g,h.dependencies={lanes:0,firstContext:g},h.flags|=524288}else tc=tc.next=g;return x}var yxe=typeof AbortController<"u"?AbortController:function(){var h=[],g=this.signal={aborted:!1,addEventListener:function(x,C){h.push(C)}};this.abort=function(){g.aborted=!0,h.forEach(function(x){return x()})}},xxe=e.unstable_scheduleCallback,wxe=e.unstable_NormalPriority,sa={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function PE(){return{controller:new yxe,data:new Map,refCount:0}}function $0(h){h.refCount--,h.refCount===0&&xxe(wxe,function(){h.controller.abort()})}var F0=null,zE=0,Em=0,Mm=null;function Sxe(h,g){if(F0===null){var x=F0=[];zE=0,Em=FM(),Mm={status:"pending",value:void 0,then:function(C){x.push(C)}}}return zE++,g.then(A8,A8),g}function A8(){if(--zE===0&&F0!==null){Mm!==null&&(Mm.status="fulfilled");var h=F0;F0=null,Em=0,Mm=null;for(var g=0;g<h.length;g++)(0,h[g])()}}function kxe(h,g){var x=[],C={status:"pending",value:null,reason:null,then:function(D){x.push(D)}};return h.then(function(){C.status="fulfilled",C.value=g;for(var D=0;D<x.length;D++)(0,x[D])(g)},function(D){for(C.status="rejected",C.reason=D,D=0;D<x.length;D++)(0,x[D])(void 0)}),C}var D8=I.S;I.S=function(h,g){pU=Ae(),typeof g=="object"&&g!==null&&typeof g.then=="function"&&Sxe(h,g),D8!==null&&D8(h,g)};var af=K(null);function BE(){var h=af.current;return h!==null?h:fn.pooledCache}function Z1(h,g){g===null?J(af,af.current):J(af,g.pool)}function L8(){var h=BE();return h===null?null:{parent:sa._currentValue,pool:h}}var Tm=Error(n(460)),$E=Error(n(474)),X1=Error(n(542)),ew={then:function(){}};function O8(h){return h=h.status,h==="fulfilled"||h==="rejected"}function I8(h,g,x){switch(x=h[x],x===void 0?h.push(g):x!==g&&(g.then(at,at),g=x),g.status){case"fulfilled":return g.value;case"rejected":throw h=g.reason,P8(h),h;default:if(typeof g.status=="string")g.then(at,at);else{if(h=fn,h!==null&&100<h.shellSuspendCounter)throw Error(n(482));h=g,h.status="pending",h.then(function(C){if(g.status==="pending"){var D=g;D.status="fulfilled",D.value=C}},function(C){if(g.status==="pending"){var D=g;D.status="rejected",D.reason=C}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw h=g.reason,P8(h),h}throw of=g,Tm}}function sf(h){try{var g=h._init;return g(h._payload)}catch(x){throw x!==null&&typeof x=="object"&&typeof x.then=="function"?(of=x,Tm):x}}var of=null;function R8(){if(of===null)throw Error(n(459));var h=of;return of=null,h}function P8(h){if(h===Tm||h===X1)throw Error(n(483))}var Am=null,U0=0;function tw(h){var g=U0;return U0+=1,Am===null&&(Am=[]),I8(Am,h,g)}function H0(h,g){g=g.props.ref,h.ref=g!==void 0?g:null}function rw(h,g){throw g.$$typeof===m?Error(n(525)):(h=Object.prototype.toString.call(g),Error(n(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h)))}function z8(h){function g(Ne,Se){if(h){var je=Ne.deletions;je===null?(Ne.deletions=[Se],Ne.flags|=16):je.push(Se)}}function x(Ne,Se){if(!h)return null;for(;Se!==null;)g(Ne,Se),Se=Se.sibling;return null}function C(Ne){for(var Se=new Map;Ne!==null;)Ne.key!==null?Se.set(Ne.key,Ne):Se.set(Ne.index,Ne),Ne=Ne.sibling;return Se}function D(Ne,Se){return Ne=Xl(Ne,Se),Ne.index=0,Ne.sibling=null,Ne}function P(Ne,Se,je){return Ne.index=je,h?(je=Ne.alternate,je!==null?(je=je.index,je<Se?(Ne.flags|=67108866,Se):je):(Ne.flags|=67108866,Se)):(Ne.flags|=1048576,Se)}function Q(Ne){return h&&Ne.alternate===null&&(Ne.flags|=67108866),Ne}function ae(Ne,Se,je,Fe){return Se===null||Se.tag!==6?(Se=EE(je,Ne.mode,Fe),Se.return=Ne,Se):(Se=D(Se,je),Se.return=Ne,Se)}function ye(Ne,Se,je,Fe){var zt=je.type;return zt===b?Pe(Ne,Se,je.props.children,Fe,je.key):Se!==null&&(Se.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===O&&sf(zt)===Se.type)?(Se=D(Se,je.props),H0(Se,je),Se.return=Ne,Se):(Se=V1(je.type,je.key,je.props,null,Ne.mode,Fe),H0(Se,je),Se.return=Ne,Se)}function Ee(Ne,Se,je,Fe){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==je.containerInfo||Se.stateNode.implementation!==je.implementation?(Se=ME(je,Ne.mode,Fe),Se.return=Ne,Se):(Se=D(Se,je.children||[]),Se.return=Ne,Se)}function Pe(Ne,Se,je,Fe,zt){return Se===null||Se.tag!==7?(Se=ef(je,Ne.mode,Fe,zt),Se.return=Ne,Se):(Se=D(Se,je),Se.return=Ne,Se)}function He(Ne,Se,je){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=EE(""+Se,Ne.mode,je),Se.return=Ne,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case p:return je=V1(Se.type,Se.key,Se.props,null,Ne.mode,je),H0(je,Se),je.return=Ne,je;case v:return Se=ME(Se,Ne.mode,je),Se.return=Ne,Se;case O:return Se=sf(Se),He(Ne,Se,je)}if(z(Se)||L(Se))return Se=ef(Se,Ne.mode,je,null),Se.return=Ne,Se;if(typeof Se.then=="function")return He(Ne,tw(Se),je);if(Se.$$typeof===N)return He(Ne,J1(Ne,Se),je);rw(Ne,Se)}return null}function Te(Ne,Se,je,Fe){var zt=Se!==null?Se.key:null;if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return zt!==null?null:ae(Ne,Se,""+je,Fe);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case p:return je.key===zt?ye(Ne,Se,je,Fe):null;case v:return je.key===zt?Ee(Ne,Se,je,Fe):null;case O:return je=sf(je),Te(Ne,Se,je,Fe)}if(z(je)||L(je))return zt!==null?null:Pe(Ne,Se,je,Fe,null);if(typeof je.then=="function")return Te(Ne,Se,tw(je),Fe);if(je.$$typeof===N)return Te(Ne,Se,J1(Ne,je),Fe);rw(Ne,je)}return null}function Ie(Ne,Se,je,Fe,zt){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return Ne=Ne.get(je)||null,ae(Se,Ne,""+Fe,zt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case p:return Ne=Ne.get(Fe.key===null?je:Fe.key)||null,ye(Se,Ne,Fe,zt);case v:return Ne=Ne.get(Fe.key===null?je:Fe.key)||null,Ee(Se,Ne,Fe,zt);case O:return Fe=sf(Fe),Ie(Ne,Se,je,Fe,zt)}if(z(Fe)||L(Fe))return Ne=Ne.get(je)||null,Pe(Se,Ne,Fe,zt,null);if(typeof Fe.then=="function")return Ie(Ne,Se,je,tw(Fe),zt);if(Fe.$$typeof===N)return Ie(Ne,Se,je,J1(Se,Fe),zt);rw(Se,Fe)}return null}function yt(Ne,Se,je,Fe){for(var zt=null,Lr=null,Nt=Se,or=Se=0,wr=null;Nt!==null&&or<je.length;or++){Nt.index>or?(wr=Nt,Nt=null):wr=Nt.sibling;var Or=Te(Ne,Nt,je[or],Fe);if(Or===null){Nt===null&&(Nt=wr);break}h&&Nt&&Or.alternate===null&&g(Ne,Nt),Se=P(Or,Se,or),Lr===null?zt=Or:Lr.sibling=Or,Lr=Or,Nt=wr}if(or===je.length)return x(Ne,Nt),Nr&&ec(Ne,or),zt;if(Nt===null){for(;or<je.length;or++)Nt=He(Ne,je[or],Fe),Nt!==null&&(Se=P(Nt,Se,or),Lr===null?zt=Nt:Lr.sibling=Nt,Lr=Nt);return Nr&&ec(Ne,or),zt}for(Nt=C(Nt);or<je.length;or++)wr=Ie(Nt,Ne,or,je[or],Fe),wr!==null&&(h&&wr.alternate!==null&&Nt.delete(wr.key===null?or:wr.key),Se=P(wr,Se,or),Lr===null?zt=wr:Lr.sibling=wr,Lr=wr);return h&&Nt.forEach(function(Ku){return g(Ne,Ku)}),Nr&&ec(Ne,or),zt}function qt(Ne,Se,je,Fe){if(je==null)throw Error(n(151));for(var zt=null,Lr=null,Nt=Se,or=Se=0,wr=null,Or=je.next();Nt!==null&&!Or.done;or++,Or=je.next()){Nt.index>or?(wr=Nt,Nt=null):wr=Nt.sibling;var Ku=Te(Ne,Nt,Or.value,Fe);if(Ku===null){Nt===null&&(Nt=wr);break}h&&Nt&&Ku.alternate===null&&g(Ne,Nt),Se=P(Ku,Se,or),Lr===null?zt=Ku:Lr.sibling=Ku,Lr=Ku,Nt=wr}if(Or.done)return x(Ne,Nt),Nr&&ec(Ne,or),zt;if(Nt===null){for(;!Or.done;or++,Or=je.next())Or=He(Ne,Or.value,Fe),Or!==null&&(Se=P(Or,Se,or),Lr===null?zt=Or:Lr.sibling=Or,Lr=Or);return Nr&&ec(Ne,or),zt}for(Nt=C(Nt);!Or.done;or++,Or=je.next())Or=Ie(Nt,Ne,or,Or.value,Fe),Or!==null&&(h&&Or.alternate!==null&&Nt.delete(Or.key===null?or:Or.key),Se=P(Or,Se,or),Lr===null?zt=Or:Lr.sibling=Or,Lr=Or);return h&&Nt.forEach(function(O1e){return g(Ne,O1e)}),Nr&&ec(Ne,or),zt}function on(Ne,Se,je,Fe){if(typeof je=="object"&&je!==null&&je.type===b&&je.key===null&&(je=je.props.children),typeof je=="object"&&je!==null){switch(je.$$typeof){case p:e:{for(var zt=je.key;Se!==null;){if(Se.key===zt){if(zt=je.type,zt===b){if(Se.tag===7){x(Ne,Se.sibling),Fe=D(Se,je.props.children),Fe.return=Ne,Ne=Fe;break e}}else if(Se.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===O&&sf(zt)===Se.type){x(Ne,Se.sibling),Fe=D(Se,je.props),H0(Fe,je),Fe.return=Ne,Ne=Fe;break e}x(Ne,Se);break}else g(Ne,Se);Se=Se.sibling}je.type===b?(Fe=ef(je.props.children,Ne.mode,Fe,je.key),Fe.return=Ne,Ne=Fe):(Fe=V1(je.type,je.key,je.props,null,Ne.mode,Fe),H0(Fe,je),Fe.return=Ne,Ne=Fe)}return Q(Ne);case v:e:{for(zt=je.key;Se!==null;){if(Se.key===zt)if(Se.tag===4&&Se.stateNode.containerInfo===je.containerInfo&&Se.stateNode.implementation===je.implementation){x(Ne,Se.sibling),Fe=D(Se,je.children||[]),Fe.return=Ne,Ne=Fe;break e}else{x(Ne,Se);break}else g(Ne,Se);Se=Se.sibling}Fe=ME(je,Ne.mode,Fe),Fe.return=Ne,Ne=Fe}return Q(Ne);case O:return je=sf(je),on(Ne,Se,je,Fe)}if(z(je))return yt(Ne,Se,je,Fe);if(L(je)){if(zt=L(je),typeof zt!="function")throw Error(n(150));return je=zt.call(je),qt(Ne,Se,je,Fe)}if(typeof je.then=="function")return on(Ne,Se,tw(je),Fe);if(je.$$typeof===N)return on(Ne,Se,J1(Ne,je),Fe);rw(Ne,je)}return typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint"?(je=""+je,Se!==null&&Se.tag===6?(x(Ne,Se.sibling),Fe=D(Se,je),Fe.return=Ne,Ne=Fe):(x(Ne,Se),Fe=EE(je,Ne.mode,Fe),Fe.return=Ne,Ne=Fe),Q(Ne)):x(Ne,Se)}return function(Ne,Se,je,Fe){try{U0=0;var zt=on(Ne,Se,je,Fe);return Am=null,zt}catch(Nt){if(Nt===Tm||Nt===X1)throw Nt;var Lr=us(29,Nt,null,Ne.mode);return Lr.lanes=Fe,Lr.return=Ne,Lr}finally{}}}var lf=z8(!0),B8=z8(!1),Mu=!1;function FE(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function UE(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function Tu(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Au(h,g,x){var C=h.updateQueue;if(C===null)return null;if(C=C.shared,($r&2)!==0){var D=C.pending;return D===null?g.next=g:(g.next=D.next,D.next=g),C.pending=g,g=G1(h),S8(h,null,x),g}return K1(h,C,g,x),G1(h)}function q0(h,g,x){if(g=g.updateQueue,g!==null&&(g=g.shared,(x&4194048)!==0)){var C=g.lanes;C&=h.pendingLanes,x|=C,g.lanes=x,it(h,x)}}function HE(h,g){var x=h.updateQueue,C=h.alternate;if(C!==null&&(C=C.updateQueue,x===C)){var D=null,P=null;if(x=x.firstBaseUpdate,x!==null){do{var Q={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};P===null?D=P=Q:P=P.next=Q,x=x.next}while(x!==null);P===null?D=P=g:P=P.next=g}else D=P=g;x={baseState:C.baseState,firstBaseUpdate:D,lastBaseUpdate:P,shared:C.shared,callbacks:C.callbacks},h.updateQueue=x;return}h=x.lastBaseUpdate,h===null?x.firstBaseUpdate=g:h.next=g,x.lastBaseUpdate=g}var qE=!1;function W0(){if(qE){var h=Mm;if(h!==null)throw h}}function K0(h,g,x,C){qE=!1;var D=h.updateQueue;Mu=!1;var P=D.firstBaseUpdate,Q=D.lastBaseUpdate,ae=D.shared.pending;if(ae!==null){D.shared.pending=null;var ye=ae,Ee=ye.next;ye.next=null,Q===null?P=Ee:Q.next=Ee,Q=ye;var Pe=h.alternate;Pe!==null&&(Pe=Pe.updateQueue,ae=Pe.lastBaseUpdate,ae!==Q&&(ae===null?Pe.firstBaseUpdate=Ee:ae.next=Ee,Pe.lastBaseUpdate=ye))}if(P!==null){var He=D.baseState;Q=0,Pe=Ee=ye=null,ae=P;do{var Te=ae.lane&-536870913,Ie=Te!==ae.lane;if(Ie?(xr&Te)===Te:(C&Te)===Te){Te!==0&&Te===Em&&(qE=!0),Pe!==null&&(Pe=Pe.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var yt=h,qt=ae;Te=g;var on=x;switch(qt.tag){case 1:if(yt=qt.payload,typeof yt=="function"){He=yt.call(on,He,Te);break e}He=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=qt.payload,Te=typeof yt=="function"?yt.call(on,He,Te):yt,Te==null)break e;He=f({},He,Te);break e;case 2:Mu=!0}}Te=ae.callback,Te!==null&&(h.flags|=64,Ie&&(h.flags|=8192),Ie=D.callbacks,Ie===null?D.callbacks=[Te]:Ie.push(Te))}else Ie={lane:Te,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Pe===null?(Ee=Pe=Ie,ye=He):Pe=Pe.next=Ie,Q|=Te;if(ae=ae.next,ae===null){if(ae=D.shared.pending,ae===null)break;Ie=ae,ae=Ie.next,Ie.next=null,D.lastBaseUpdate=Ie,D.shared.pending=null}}while(!0);Pe===null&&(ye=He),D.baseState=ye,D.firstBaseUpdate=Ee,D.lastBaseUpdate=Pe,P===null&&(D.shared.lanes=0),Ru|=Q,h.lanes=Q,h.memoizedState=He}}function $8(h,g){if(typeof h!="function")throw Error(n(191,h));h.call(g)}function F8(h,g){var x=h.callbacks;if(x!==null)for(h.callbacks=null,h=0;h<x.length;h++)$8(x[h],g)}var Dm=K(null),nw=K(0);function U8(h,g){h=dc,J(nw,h),J(Dm,g),dc=h|g.baseLanes}function WE(){J(nw,dc),J(Dm,Dm.current)}function KE(){dc=nw.current,G(Dm),G(nw)}var ds=K(null),Qs=null;function Du(h){var g=h.alternate;J(Xn,Xn.current&1),J(ds,h),Qs===null&&(g===null||Dm.current!==null||g.memoizedState!==null)&&(Qs=h)}function GE(h){J(Xn,Xn.current),J(ds,h),Qs===null&&(Qs=h)}function H8(h){h.tag===22?(J(Xn,Xn.current),J(ds,h),Qs===null&&(Qs=h)):Lu()}function Lu(){J(Xn,Xn.current),J(ds,ds.current)}function fs(h){G(ds),Qs===h&&(Qs=null),G(Xn)}var Xn=K(0);function aw(h){for(var g=h;g!==null;){if(g.tag===13){var x=g.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||XM(x)||eT(x)))return g}else if(g.tag===19&&(g.memoizedProps.revealOrder==="forwards"||g.memoizedProps.revealOrder==="backwards"||g.memoizedProps.revealOrder==="unstable_legacy-backwards"||g.memoizedProps.revealOrder==="together")){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var nc=0,ir=null,an=null,oa=null,iw=!1,Lm=!1,cf=!1,sw=0,G0=0,Om=null,_xe=0;function Fn(){throw Error(n(321))}function VE(h,g){if(g===null)return!1;for(var x=0;x<g.length&&x<h.length;x++)if(!cs(h[x],g[x]))return!1;return!0}function YE(h,g,x,C,D,P){return nc=P,ir=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,I.H=h===null||h.memoizedState===null?CF:uM,cf=!1,P=x(C,D),cf=!1,Lm&&(P=W8(g,x,C,D)),q8(h),P}function q8(h){I.H=Q0;var g=an!==null&&an.next!==null;if(nc=0,oa=an=ir=null,iw=!1,G0=0,Om=null,g)throw Error(n(300));h===null||la||(h=h.dependencies,h!==null&&Q1(h)&&(la=!0))}function W8(h,g,x,C){ir=h;var D=0;do{if(Lm&&(Om=null),G0=0,Lm=!1,25<=D)throw Error(n(301));if(D+=1,oa=an=null,h.updateQueue!=null){var P=h.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}I.H=jF,P=g(x,C)}while(Lm);return P}function Nxe(){var h=I.H,g=h.useState()[0];return g=typeof g.then=="function"?V0(g):g,h=h.useState()[0],(an!==null?an.memoizedState:null)!==h&&(ir.flags|=1024),g}function QE(){var h=sw!==0;return sw=0,h}function JE(h,g,x){g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~x}function ZE(h){if(iw){for(h=h.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}iw=!1}nc=0,oa=an=ir=null,Lm=!1,G0=sw=0,Om=null}function Ni(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oa===null?ir.memoizedState=oa=h:oa=oa.next=h,oa}function ea(){if(an===null){var h=ir.alternate;h=h!==null?h.memoizedState:null}else h=an.next;var g=oa===null?ir.memoizedState:oa.next;if(g!==null)oa=g,an=h;else{if(h===null)throw ir.alternate===null?Error(n(467)):Error(n(310));an=h,h={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},oa===null?ir.memoizedState=oa=h:oa=oa.next=h}return oa}function ow(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function V0(h){var g=G0;return G0+=1,Om===null&&(Om=[]),h=I8(Om,h,g),g=ir,(oa===null?g.memoizedState:oa.next)===null&&(g=g.alternate,I.H=g===null||g.memoizedState===null?CF:uM),h}function lw(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return V0(h);if(h.$$typeof===N)return Va(h)}throw Error(n(438,String(h)))}function XE(h){var g=null,x=ir.updateQueue;if(x!==null&&(g=x.memoCache),g==null){var C=ir.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(g={data:C.data.map(function(D){return D.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),x===null&&(x=ow(),ir.updateQueue=x),x.memoCache=g,x=g.data[g.index],x===void 0)for(x=g.data[g.index]=Array(h),C=0;C<h;C++)x[C]=q;return g.index++,x}function ac(h,g){return typeof g=="function"?g(h):g}function cw(h){var g=ea();return eM(g,an,h)}function eM(h,g,x){var C=h.queue;if(C===null)throw Error(n(311));C.lastRenderedReducer=x;var D=h.baseQueue,P=C.pending;if(P!==null){if(D!==null){var Q=D.next;D.next=P.next,P.next=Q}g.baseQueue=D=P,C.pending=null}if(P=h.baseState,D===null)h.memoizedState=P;else{g=D.next;var ae=Q=null,ye=null,Ee=g,Pe=!1;do{var He=Ee.lane&-536870913;if(He!==Ee.lane?(xr&He)===He:(nc&He)===He){var Te=Ee.revertLane;if(Te===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),He===Em&&(Pe=!0);else if((nc&Te)===Te){Ee=Ee.next,Te===Em&&(Pe=!0);continue}else He={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},ye===null?(ae=ye=He,Q=P):ye=ye.next=He,ir.lanes|=Te,Ru|=Te;He=Ee.action,cf&&x(P,He),P=Ee.hasEagerState?Ee.eagerState:x(P,He)}else Te={lane:He,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},ye===null?(ae=ye=Te,Q=P):ye=ye.next=Te,ir.lanes|=He,Ru|=He;Ee=Ee.next}while(Ee!==null&&Ee!==g);if(ye===null?Q=P:ye.next=ae,!cs(P,h.memoizedState)&&(la=!0,Pe&&(x=Mm,x!==null)))throw x;h.memoizedState=P,h.baseState=Q,h.baseQueue=ye,C.lastRenderedState=P}return D===null&&(C.lanes=0),[h.memoizedState,C.dispatch]}function tM(h){var g=ea(),x=g.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=h;var C=x.dispatch,D=x.pending,P=g.memoizedState;if(D!==null){x.pending=null;var Q=D=D.next;do P=h(P,Q.action),Q=Q.next;while(Q!==D);cs(P,g.memoizedState)||(la=!0),g.memoizedState=P,g.baseQueue===null&&(g.baseState=P),x.lastRenderedState=P}return[P,C]}function K8(h,g,x){var C=ir,D=ea(),P=Nr;if(P){if(x===void 0)throw Error(n(407));x=x()}else x=g();var Q=!cs((an||D).memoizedState,x);if(Q&&(D.memoizedState=x,la=!0),D=D.queue,aM(Y8.bind(null,C,D,h),[h]),D.getSnapshot!==g||Q||oa!==null&&oa.memoizedState.tag&1){if(C.flags|=2048,Im(9,{destroy:void 0},V8.bind(null,C,D,x,g),null),fn===null)throw Error(n(349));P||(nc&127)!==0||G8(C,g,x)}return x}function G8(h,g,x){h.flags|=16384,h={getSnapshot:g,value:x},g=ir.updateQueue,g===null?(g=ow(),ir.updateQueue=g,g.stores=[h]):(x=g.stores,x===null?g.stores=[h]:x.push(h))}function V8(h,g,x,C){g.value=x,g.getSnapshot=C,Q8(g)&&J8(h)}function Y8(h,g,x){return x(function(){Q8(g)&&J8(h)})}function Q8(h){var g=h.getSnapshot;h=h.value;try{var x=g();return!cs(h,x)}catch{return!0}}function J8(h){var g=Xd(h,2);g!==null&&Qi(g,h,2)}function rM(h){var g=Ni();if(typeof h=="function"){var x=h;if(h=x(),cf){We(!0);try{x()}finally{We(!1)}}}return g.memoizedState=g.baseState=h,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ac,lastRenderedState:h},g}function Z8(h,g,x,C){return h.baseState=x,eM(h,an,typeof C=="function"?C:ac)}function Cxe(h,g,x,C,D){if(fw(h))throw Error(n(485));if(h=g.action,h!==null){var P={payload:D,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){P.listeners.push(Q)}};I.T!==null?x(!0):P.isTransition=!1,C(P),x=g.pending,x===null?(P.next=g.pending=P,X8(g,P)):(P.next=x.next,g.pending=x.next=P)}}function X8(h,g){var x=g.action,C=g.payload,D=h.state;if(g.isTransition){var P=I.T,Q={};I.T=Q;try{var ae=x(D,C),ye=I.S;ye!==null&&ye(Q,ae),eF(h,g,ae)}catch(Ee){nM(h,g,Ee)}finally{P!==null&&Q.types!==null&&(P.types=Q.types),I.T=P}}else try{P=x(D,C),eF(h,g,P)}catch(Ee){nM(h,g,Ee)}}function eF(h,g,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(C){tF(h,g,C)},function(C){return nM(h,g,C)}):tF(h,g,x)}function tF(h,g,x){g.status="fulfilled",g.value=x,rF(g),h.state=x,g=h.pending,g!==null&&(x=g.next,x===g?h.pending=null:(x=x.next,g.next=x,X8(h,x)))}function nM(h,g,x){var C=h.pending;if(h.pending=null,C!==null){C=C.next;do g.status="rejected",g.reason=x,rF(g),g=g.next;while(g!==C)}h.action=null}function rF(h){h=h.listeners;for(var g=0;g<h.length;g++)(0,h[g])()}function nF(h,g){return g}function aF(h,g){if(Nr){var x=fn.formState;if(x!==null){e:{var C=ir;if(Nr){if(wn){t:{for(var D=wn,P=Ys;D.nodeType!==8;){if(!P){D=null;break t}if(D=Js(D.nextSibling),D===null){D=null;break t}}P=D.data,D=P==="F!"||P==="F"?D:null}if(D){wn=Js(D.nextSibling),C=D.data==="F!";break e}}ju(C)}C=!1}C&&(g=x[0])}}return x=Ni(),x.memoizedState=x.baseState=g,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nF,lastRenderedState:g},x.queue=C,x=kF.bind(null,ir,C),C.dispatch=x,C=rM(!1),P=cM.bind(null,ir,!1,C.queue),C=Ni(),D={state:g,dispatch:null,action:h,pending:null},C.queue=D,x=Cxe.bind(null,ir,D,P,x),D.dispatch=x,C.memoizedState=h,[g,x,!1]}function iF(h){var g=ea();return sF(g,an,h)}function sF(h,g,x){if(g=eM(h,g,nF)[0],h=cw(ac)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var C=V0(g)}catch(Q){throw Q===Tm?X1:Q}else C=g;g=ea();var D=g.queue,P=D.dispatch;return x!==g.memoizedState&&(ir.flags|=2048,Im(9,{destroy:void 0},jxe.bind(null,D,x),null)),[C,P,h]}function jxe(h,g){h.action=g}function oF(h){var g=ea(),x=an;if(x!==null)return sF(g,x,h);ea(),g=g.memoizedState,x=ea();var C=x.queue.dispatch;return x.memoizedState=h,[g,C,!1]}function Im(h,g,x,C){return h={tag:h,create:x,deps:C,inst:g,next:null},g=ir.updateQueue,g===null&&(g=ow(),ir.updateQueue=g),x=g.lastEffect,x===null?g.lastEffect=h.next=h:(C=x.next,x.next=h,h.next=C,g.lastEffect=h),h}function lF(){return ea().memoizedState}function uw(h,g,x,C){var D=Ni();ir.flags|=h,D.memoizedState=Im(1|g,{destroy:void 0},x,C===void 0?null:C)}function dw(h,g,x,C){var D=ea();C=C===void 0?null:C;var P=D.memoizedState.inst;an!==null&&C!==null&&VE(C,an.memoizedState.deps)?D.memoizedState=Im(g,P,x,C):(ir.flags|=h,D.memoizedState=Im(1|g,P,x,C))}function cF(h,g){uw(8390656,8,h,g)}function aM(h,g){dw(2048,8,h,g)}function Exe(h){ir.flags|=4;var g=ir.updateQueue;if(g===null)g=ow(),ir.updateQueue=g,g.events=[h];else{var x=g.events;x===null?g.events=[h]:x.push(h)}}function uF(h){var g=ea().memoizedState;return Exe({ref:g,nextImpl:h}),function(){if(($r&2)!==0)throw Error(n(440));return g.impl.apply(void 0,arguments)}}function dF(h,g){return dw(4,2,h,g)}function fF(h,g){return dw(4,4,h,g)}function hF(h,g){if(typeof g=="function"){h=h();var x=g(h);return function(){typeof x=="function"?x():g(null)}}if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function mF(h,g,x){x=x!=null?x.concat([h]):null,dw(4,4,hF.bind(null,g,h),x)}function iM(){}function pF(h,g){var x=ea();g=g===void 0?null:g;var C=x.memoizedState;return g!==null&&VE(g,C[1])?C[0]:(x.memoizedState=[h,g],h)}function gF(h,g){var x=ea();g=g===void 0?null:g;var C=x.memoizedState;if(g!==null&&VE(g,C[1]))return C[0];if(C=h(),cf){We(!0);try{h()}finally{We(!1)}}return x.memoizedState=[C,g],C}function sM(h,g,x){return x===void 0||(nc&1073741824)!==0&&(xr&261930)===0?h.memoizedState=g:(h.memoizedState=x,h=vU(),ir.lanes|=h,Ru|=h,x)}function vF(h,g,x,C){return cs(x,g)?x:Dm.current!==null?(h=sM(h,x,C),cs(h,g)||(la=!0),h):(nc&42)===0||(nc&1073741824)!==0&&(xr&261930)===0?(la=!0,h.memoizedState=x):(h=vU(),ir.lanes|=h,Ru|=h,g)}function bF(h,g,x,C,D){var P=B.p;B.p=P!==0&&8>P?P:8;var Q=I.T,ae={};I.T=ae,cM(h,!1,g,x);try{var ye=D(),Ee=I.S;if(Ee!==null&&Ee(ae,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var Pe=kxe(ye,C);Y0(h,g,Pe,ps(h))}else Y0(h,g,C,ps(h))}catch(He){Y0(h,g,{then:function(){},status:"rejected",reason:He},ps())}finally{B.p=P,Q!==null&&ae.types!==null&&(Q.types=ae.types),I.T=Q}}function Mxe(){}function oM(h,g,x,C){if(h.tag!==5)throw Error(n(476));var D=yF(h).queue;bF(h,D,g,F,x===null?Mxe:function(){return xF(h),x(C)})}function yF(h){var g=h.memoizedState;if(g!==null)return g;g={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ac,lastRenderedState:F},next:null};var x={};return g.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ac,lastRenderedState:x},next:null},h.memoizedState=g,h=h.alternate,h!==null&&(h.memoizedState=g),g}function xF(h){var g=yF(h);g.next===null&&(g=h.alternate.memoizedState),Y0(h,g.next.queue,{},ps())}function lM(){return Va(fv)}function wF(){return ea().memoizedState}function SF(){return ea().memoizedState}function Txe(h){for(var g=h.return;g!==null;){switch(g.tag){case 24:case 3:var x=ps();h=Tu(x);var C=Au(g,h,x);C!==null&&(Qi(C,g,x),q0(C,g,x)),g={cache:PE()},h.payload=g;return}g=g.return}}function Axe(h,g,x){var C=ps();x={lane:C,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},fw(h)?_F(g,x):(x=CE(h,g,x,C),x!==null&&(Qi(x,h,C),NF(x,g,C)))}function kF(h,g,x){var C=ps();Y0(h,g,x,C)}function Y0(h,g,x,C){var D={lane:C,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null};if(fw(h))_F(g,D);else{var P=h.alternate;if(h.lanes===0&&(P===null||P.lanes===0)&&(P=g.lastRenderedReducer,P!==null))try{var Q=g.lastRenderedState,ae=P(Q,x);if(D.hasEagerState=!0,D.eagerState=ae,cs(ae,Q))return K1(h,g,D,0),fn===null&&W1(),!1}catch{}finally{}if(x=CE(h,g,D,C),x!==null)return Qi(x,h,C),NF(x,g,C),!0}return!1}function cM(h,g,x,C){if(C={lane:2,revertLane:FM(),gesture:null,action:C,hasEagerState:!1,eagerState:null,next:null},fw(h)){if(g)throw Error(n(479))}else g=CE(h,x,C,2),g!==null&&Qi(g,h,2)}function fw(h){var g=h.alternate;return h===ir||g!==null&&g===ir}function _F(h,g){Lm=iw=!0;var x=h.pending;x===null?g.next=g:(g.next=x.next,x.next=g),h.pending=g}function NF(h,g,x){if((x&4194048)!==0){var C=g.lanes;C&=h.pendingLanes,x|=C,g.lanes=x,it(h,x)}}var Q0={readContext:Va,use:lw,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useLayoutEffect:Fn,useInsertionEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useSyncExternalStore:Fn,useId:Fn,useHostTransitionStatus:Fn,useFormState:Fn,useActionState:Fn,useOptimistic:Fn,useMemoCache:Fn,useCacheRefresh:Fn};Q0.useEffectEvent=Fn;var CF={readContext:Va,use:lw,useCallback:function(h,g){return Ni().memoizedState=[h,g===void 0?null:g],h},useContext:Va,useEffect:cF,useImperativeHandle:function(h,g,x){x=x!=null?x.concat([h]):null,uw(4194308,4,hF.bind(null,g,h),x)},useLayoutEffect:function(h,g){return uw(4194308,4,h,g)},useInsertionEffect:function(h,g){uw(4,2,h,g)},useMemo:function(h,g){var x=Ni();g=g===void 0?null:g;var C=h();if(cf){We(!0);try{h()}finally{We(!1)}}return x.memoizedState=[C,g],C},useReducer:function(h,g,x){var C=Ni();if(x!==void 0){var D=x(g);if(cf){We(!0);try{x(g)}finally{We(!1)}}}else D=g;return C.memoizedState=C.baseState=D,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:D},C.queue=h,h=h.dispatch=Axe.bind(null,ir,h),[C.memoizedState,h]},useRef:function(h){var g=Ni();return h={current:h},g.memoizedState=h},useState:function(h){h=rM(h);var g=h.queue,x=kF.bind(null,ir,g);return g.dispatch=x,[h.memoizedState,x]},useDebugValue:iM,useDeferredValue:function(h,g){var x=Ni();return sM(x,h,g)},useTransition:function(){var h=rM(!1);return h=bF.bind(null,ir,h.queue,!0,!1),Ni().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,g,x){var C=ir,D=Ni();if(Nr){if(x===void 0)throw Error(n(407));x=x()}else{if(x=g(),fn===null)throw Error(n(349));(xr&127)!==0||G8(C,g,x)}D.memoizedState=x;var P={value:x,getSnapshot:g};return D.queue=P,cF(Y8.bind(null,C,P,h),[h]),C.flags|=2048,Im(9,{destroy:void 0},V8.bind(null,C,P,x,g),null),x},useId:function(){var h=Ni(),g=fn.identifierPrefix;if(Nr){var x=ol,C=sl;x=(C&~(1<<32-Ve(C)-1)).toString(32)+x,g="_"+g+"R_"+x,x=sw++,0<x&&(g+="H"+x.toString(32)),g+="_"}else x=_xe++,g="_"+g+"r_"+x.toString(32)+"_";return h.memoizedState=g},useHostTransitionStatus:lM,useFormState:aF,useActionState:aF,useOptimistic:function(h){var g=Ni();g.memoizedState=g.baseState=h;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=x,g=cM.bind(null,ir,!0,x),x.dispatch=g,[h,g]},useMemoCache:XE,useCacheRefresh:function(){return Ni().memoizedState=Txe.bind(null,ir)},useEffectEvent:function(h){var g=Ni(),x={impl:h};return g.memoizedState=x,function(){if(($r&2)!==0)throw Error(n(440));return x.impl.apply(void 0,arguments)}}},uM={readContext:Va,use:lw,useCallback:pF,useContext:Va,useEffect:aM,useImperativeHandle:mF,useInsertionEffect:dF,useLayoutEffect:fF,useMemo:gF,useReducer:cw,useRef:lF,useState:function(){return cw(ac)},useDebugValue:iM,useDeferredValue:function(h,g){var x=ea();return vF(x,an.memoizedState,h,g)},useTransition:function(){var h=cw(ac)[0],g=ea().memoizedState;return[typeof h=="boolean"?h:V0(h),g]},useSyncExternalStore:K8,useId:wF,useHostTransitionStatus:lM,useFormState:iF,useActionState:iF,useOptimistic:function(h,g){var x=ea();return Z8(x,an,h,g)},useMemoCache:XE,useCacheRefresh:SF};uM.useEffectEvent=uF;var jF={readContext:Va,use:lw,useCallback:pF,useContext:Va,useEffect:aM,useImperativeHandle:mF,useInsertionEffect:dF,useLayoutEffect:fF,useMemo:gF,useReducer:tM,useRef:lF,useState:function(){return tM(ac)},useDebugValue:iM,useDeferredValue:function(h,g){var x=ea();return an===null?sM(x,h,g):vF(x,an.memoizedState,h,g)},useTransition:function(){var h=tM(ac)[0],g=ea().memoizedState;return[typeof h=="boolean"?h:V0(h),g]},useSyncExternalStore:K8,useId:wF,useHostTransitionStatus:lM,useFormState:oF,useActionState:oF,useOptimistic:function(h,g){var x=ea();return an!==null?Z8(x,an,h,g):(x.baseState=h,[h,x.queue.dispatch])},useMemoCache:XE,useCacheRefresh:SF};jF.useEffectEvent=uF;function dM(h,g,x,C){g=h.memoizedState,x=x(C,g),x=x==null?g:f({},g,x),h.memoizedState=x,h.lanes===0&&(h.updateQueue.baseState=x)}var fM={enqueueSetState:function(h,g,x){h=h._reactInternals;var C=ps(),D=Tu(C);D.payload=g,x!=null&&(D.callback=x),g=Au(h,D,C),g!==null&&(Qi(g,h,C),q0(g,h,C))},enqueueReplaceState:function(h,g,x){h=h._reactInternals;var C=ps(),D=Tu(C);D.tag=1,D.payload=g,x!=null&&(D.callback=x),g=Au(h,D,C),g!==null&&(Qi(g,h,C),q0(g,h,C))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var x=ps(),C=Tu(x);C.tag=2,g!=null&&(C.callback=g),g=Au(h,C,x),g!==null&&(Qi(g,h,x),q0(g,h,x))}};function EF(h,g,x,C,D,P,Q){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(C,P,Q):g.prototype&&g.prototype.isPureReactComponent?!R0(x,C)||!R0(D,P):!0}function MF(h,g,x,C){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(x,C),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(x,C),g.state!==h&&fM.enqueueReplaceState(g,g.state,null)}function uf(h,g){var x=g;if("ref"in g){x={};for(var C in g)C!=="ref"&&(x[C]=g[C])}if(h=h.defaultProps){x===g&&(x=f({},x));for(var D in h)x[D]===void 0&&(x[D]=h[D])}return x}function TF(h){q1(h)}function AF(h){console.error(h)}function DF(h){q1(h)}function hw(h,g){try{var x=h.onUncaughtError;x(g.value,{componentStack:g.stack})}catch(C){setTimeout(function(){throw C})}}function LF(h,g,x){try{var C=h.onCaughtError;C(x.value,{componentStack:x.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function hM(h,g,x){return x=Tu(x),x.tag=3,x.payload={element:null},x.callback=function(){hw(h,g)},x}function OF(h){return h=Tu(h),h.tag=3,h}function IF(h,g,x,C){var D=x.type.getDerivedStateFromError;if(typeof D=="function"){var P=C.value;h.payload=function(){return D(P)},h.callback=function(){LF(g,x,C)}}var Q=x.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(h.callback=function(){LF(g,x,C),typeof D!="function"&&(Pu===null?Pu=new Set([this]):Pu.add(this));var ae=C.stack;this.componentDidCatch(C.value,{componentStack:ae!==null?ae:""})})}function Dxe(h,g,x,C,D){if(x.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(g=x.alternate,g!==null&&jm(g,x,D,!0),x=ds.current,x!==null){switch(x.tag){case 31:case 13:return Qs===null?Nw():x.alternate===null&&Un===0&&(Un=3),x.flags&=-257,x.flags|=65536,x.lanes=D,C===ew?x.flags|=16384:(g=x.updateQueue,g===null?x.updateQueue=new Set([C]):g.add(C),zM(h,C,D)),!1;case 22:return x.flags|=65536,C===ew?x.flags|=16384:(g=x.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([C])},x.updateQueue=g):(x=g.retryQueue,x===null?g.retryQueue=new Set([C]):x.add(C)),zM(h,C,D)),!1}throw Error(n(435,x.tag))}return zM(h,C,D),Nw(),!1}if(Nr)return g=ds.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=D,C!==DE&&(h=Error(n(422),{cause:C}),B0(Ks(h,x)))):(C!==DE&&(g=Error(n(423),{cause:C}),B0(Ks(g,x))),h=h.current.alternate,h.flags|=65536,D&=-D,h.lanes|=D,C=Ks(C,x),D=hM(h.stateNode,C,D),HE(h,D),Un!==4&&(Un=2)),!1;var P=Error(n(520),{cause:C});if(P=Ks(P,x),av===null?av=[P]:av.push(P),Un!==4&&(Un=2),g===null)return!0;C=Ks(C,x),x=g;do{switch(x.tag){case 3:return x.flags|=65536,h=D&-D,x.lanes|=h,h=hM(x.stateNode,C,h),HE(x,h),!1;case 1:if(g=x.type,P=x.stateNode,(x.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Pu===null||!Pu.has(P))))return x.flags|=65536,D&=-D,x.lanes|=D,D=OF(D),IF(D,h,x,C),HE(x,D),!1}x=x.return}while(x!==null);return!1}var mM=Error(n(461)),la=!1;function Ya(h,g,x,C){g.child=h===null?B8(g,null,x,C):lf(g,h.child,x,C)}function RF(h,g,x,C,D){x=x.render;var P=g.ref;if("ref"in C){var Q={};for(var ae in C)ae!=="ref"&&(Q[ae]=C[ae])}else Q=C;return nf(g),C=YE(h,g,x,Q,P,D),ae=QE(),h!==null&&!la?(JE(h,g,D),ic(h,g,D)):(Nr&&ae&&TE(g),g.flags|=1,Ya(h,g,C,D),g.child)}function PF(h,g,x,C,D){if(h===null){var P=x.type;return typeof P=="function"&&!jE(P)&&P.defaultProps===void 0&&x.compare===null?(g.tag=15,g.type=P,zF(h,g,P,C,D)):(h=V1(x.type,null,C,g,g.mode,D),h.ref=g.ref,h.return=g,g.child=h)}if(P=h.child,!SM(h,D)){var Q=P.memoizedProps;if(x=x.compare,x=x!==null?x:R0,x(Q,C)&&h.ref===g.ref)return ic(h,g,D)}return g.flags|=1,h=Xl(P,C),h.ref=g.ref,h.return=g,g.child=h}function zF(h,g,x,C,D){if(h!==null){var P=h.memoizedProps;if(R0(P,C)&&h.ref===g.ref)if(la=!1,g.pendingProps=C=P,SM(h,D))(h.flags&131072)!==0&&(la=!0);else return g.lanes=h.lanes,ic(h,g,D)}return pM(h,g,x,C,D)}function BF(h,g,x,C){var D=C.children,P=h!==null?h.memoizedState:null;if(h===null&&g.stateNode===null&&(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),C.mode==="hidden"){if((g.flags&128)!==0){if(P=P!==null?P.baseLanes|x:x,h!==null){for(C=g.child=h.child,D=0;C!==null;)D=D|C.lanes|C.childLanes,C=C.sibling;C=D&~P}else C=0,g.child=null;return $F(h,g,P,x,C)}if((x&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},h!==null&&Z1(g,P!==null?P.cachePool:null),P!==null?U8(g,P):WE(),H8(g);else return C=g.lanes=536870912,$F(h,g,P!==null?P.baseLanes|x:x,x,C)}else P!==null?(Z1(g,P.cachePool),U8(g,P),Lu(),g.memoizedState=null):(h!==null&&Z1(g,null),WE(),Lu());return Ya(h,g,D,x),g.child}function J0(h,g){return h!==null&&h.tag===22||g.stateNode!==null||(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.sibling}function $F(h,g,x,C,D){var P=BE();return P=P===null?null:{parent:sa._currentValue,pool:P},g.memoizedState={baseLanes:x,cachePool:P},h!==null&&Z1(g,null),WE(),H8(g),h!==null&&jm(h,g,C,!0),g.childLanes=D,null}function mw(h,g){return g=gw({mode:g.mode,children:g.children},h.mode),g.ref=h.ref,h.child=g,g.return=h,g}function FF(h,g,x){return lf(g,h.child,null,x),h=mw(g,g.pendingProps),h.flags|=2,fs(g),g.memoizedState=null,h}function Lxe(h,g,x){var C=g.pendingProps,D=(g.flags&128)!==0;if(g.flags&=-129,h===null){if(Nr){if(C.mode==="hidden")return h=mw(g,C),g.lanes=536870912,J0(null,h);if(GE(g),(h=wn)?(h=XU(h,Ys),h=h!==null&&h.data==="&"?h:null,h!==null&&(g.memoizedState={dehydrated:h,treeContext:Nu!==null?{id:sl,overflow:ol}:null,retryLane:536870912,hydrationErrors:null},x=_8(h),x.return=g,g.child=x,Ga=g,wn=null)):h=null,h===null)throw ju(g);return g.lanes=536870912,null}return mw(g,C)}var P=h.memoizedState;if(P!==null){var Q=P.dehydrated;if(GE(g),D)if(g.flags&256)g.flags&=-257,g=FF(h,g,x);else if(g.memoizedState!==null)g.child=h.child,g.flags|=128,g=null;else throw Error(n(558));else if(la||jm(h,g,x,!1),D=(x&h.childLanes)!==0,la||D){if(C=fn,C!==null&&(Q=Xt(C,x),Q!==0&&Q!==P.retryLane))throw P.retryLane=Q,Xd(h,Q),Qi(C,h,Q),mM;Nw(),g=FF(h,g,x)}else h=P.treeContext,wn=Js(Q.nextSibling),Ga=g,Nr=!0,Cu=null,Ys=!1,h!==null&&j8(g,h),g=mw(g,C),g.flags|=4096;return g}return h=Xl(h.child,{mode:C.mode,children:C.children}),h.ref=g.ref,g.child=h,h.return=g,h}function pw(h,g){var x=g.ref;if(x===null)h!==null&&h.ref!==null&&(g.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(n(284));(h===null||h.ref!==x)&&(g.flags|=4194816)}}function pM(h,g,x,C,D){return nf(g),x=YE(h,g,x,C,void 0,D),C=QE(),h!==null&&!la?(JE(h,g,D),ic(h,g,D)):(Nr&&C&&TE(g),g.flags|=1,Ya(h,g,x,D),g.child)}function UF(h,g,x,C,D,P){return nf(g),g.updateQueue=null,x=W8(g,C,x,D),q8(h),C=QE(),h!==null&&!la?(JE(h,g,P),ic(h,g,P)):(Nr&&C&&TE(g),g.flags|=1,Ya(h,g,x,P),g.child)}function HF(h,g,x,C,D){if(nf(g),g.stateNode===null){var P=km,Q=x.contextType;typeof Q=="object"&&Q!==null&&(P=Va(Q)),P=new x(C,P),g.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=fM,g.stateNode=P,P._reactInternals=g,P=g.stateNode,P.props=C,P.state=g.memoizedState,P.refs={},FE(g),Q=x.contextType,P.context=typeof Q=="object"&&Q!==null?Va(Q):km,P.state=g.memoizedState,Q=x.getDerivedStateFromProps,typeof Q=="function"&&(dM(g,x,Q,C),P.state=g.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(Q=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),Q!==P.state&&fM.enqueueReplaceState(P,P.state,null),K0(g,C,P,D),W0(),P.state=g.memoizedState),typeof P.componentDidMount=="function"&&(g.flags|=4194308),C=!0}else if(h===null){P=g.stateNode;var ae=g.memoizedProps,ye=uf(x,ae);P.props=ye;var Ee=P.context,Pe=x.contextType;Q=km,typeof Pe=="object"&&Pe!==null&&(Q=Va(Pe));var He=x.getDerivedStateFromProps;Pe=typeof He=="function"||typeof P.getSnapshotBeforeUpdate=="function",ae=g.pendingProps!==ae,Pe||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(ae||Ee!==Q)&&MF(g,P,C,Q),Mu=!1;var Te=g.memoizedState;P.state=Te,K0(g,C,P,D),W0(),Ee=g.memoizedState,ae||Te!==Ee||Mu?(typeof He=="function"&&(dM(g,x,He,C),Ee=g.memoizedState),(ye=Mu||EF(g,x,ye,C,Te,Ee,Q))?(Pe||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(g.flags|=4194308)):(typeof P.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=C,g.memoizedState=Ee),P.props=C,P.state=Ee,P.context=Q,C=ye):(typeof P.componentDidMount=="function"&&(g.flags|=4194308),C=!1)}else{P=g.stateNode,UE(h,g),Q=g.memoizedProps,Pe=uf(x,Q),P.props=Pe,He=g.pendingProps,Te=P.context,Ee=x.contextType,ye=km,typeof Ee=="object"&&Ee!==null&&(ye=Va(Ee)),ae=x.getDerivedStateFromProps,(Ee=typeof ae=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(Q!==He||Te!==ye)&&MF(g,P,C,ye),Mu=!1,Te=g.memoizedState,P.state=Te,K0(g,C,P,D),W0();var Ie=g.memoizedState;Q!==He||Te!==Ie||Mu||h!==null&&h.dependencies!==null&&Q1(h.dependencies)?(typeof ae=="function"&&(dM(g,x,ae,C),Ie=g.memoizedState),(Pe=Mu||EF(g,x,Pe,C,Te,Ie,ye)||h!==null&&h.dependencies!==null&&Q1(h.dependencies))?(Ee||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(C,Ie,ye),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(C,Ie,ye)),typeof P.componentDidUpdate=="function"&&(g.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof P.componentDidUpdate!="function"||Q===h.memoizedProps&&Te===h.memoizedState||(g.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Q===h.memoizedProps&&Te===h.memoizedState||(g.flags|=1024),g.memoizedProps=C,g.memoizedState=Ie),P.props=C,P.state=Ie,P.context=ye,C=Pe):(typeof P.componentDidUpdate!="function"||Q===h.memoizedProps&&Te===h.memoizedState||(g.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||Q===h.memoizedProps&&Te===h.memoizedState||(g.flags|=1024),C=!1)}return P=C,pw(h,g),C=(g.flags&128)!==0,P||C?(P=g.stateNode,x=C&&typeof x.getDerivedStateFromError!="function"?null:P.render(),g.flags|=1,h!==null&&C?(g.child=lf(g,h.child,null,D),g.child=lf(g,null,x,D)):Ya(h,g,x,D),g.memoizedState=P.state,h=g.child):h=ic(h,g,D),h}function qF(h,g,x,C){return tf(),g.flags|=256,Ya(h,g,x,C),g.child}var gM={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vM(h){return{baseLanes:h,cachePool:L8()}}function bM(h,g,x){return h=h!==null?h.childLanes&~x:0,g&&(h|=ms),h}function WF(h,g,x){var C=g.pendingProps,D=!1,P=(g.flags&128)!==0,Q;if((Q=P)||(Q=h!==null&&h.memoizedState===null?!1:(Xn.current&2)!==0),Q&&(D=!0,g.flags&=-129),Q=(g.flags&32)!==0,g.flags&=-33,h===null){if(Nr){if(D?Du(g):Lu(),(h=wn)?(h=XU(h,Ys),h=h!==null&&h.data!=="&"?h:null,h!==null&&(g.memoizedState={dehydrated:h,treeContext:Nu!==null?{id:sl,overflow:ol}:null,retryLane:536870912,hydrationErrors:null},x=_8(h),x.return=g,g.child=x,Ga=g,wn=null)):h=null,h===null)throw ju(g);return eT(h)?g.lanes=32:g.lanes=536870912,null}var ae=C.children;return C=C.fallback,D?(Lu(),D=g.mode,ae=gw({mode:"hidden",children:ae},D),C=ef(C,D,x,null),ae.return=g,C.return=g,ae.sibling=C,g.child=ae,C=g.child,C.memoizedState=vM(x),C.childLanes=bM(h,Q,x),g.memoizedState=gM,J0(null,C)):(Du(g),yM(g,ae))}var ye=h.memoizedState;if(ye!==null&&(ae=ye.dehydrated,ae!==null)){if(P)g.flags&256?(Du(g),g.flags&=-257,g=xM(h,g,x)):g.memoizedState!==null?(Lu(),g.child=h.child,g.flags|=128,g=null):(Lu(),ae=C.fallback,D=g.mode,C=gw({mode:"visible",children:C.children},D),ae=ef(ae,D,x,null),ae.flags|=2,C.return=g,ae.return=g,C.sibling=ae,g.child=C,lf(g,h.child,null,x),C=g.child,C.memoizedState=vM(x),C.childLanes=bM(h,Q,x),g.memoizedState=gM,g=J0(null,C));else if(Du(g),eT(ae)){if(Q=ae.nextSibling&&ae.nextSibling.dataset,Q)var Ee=Q.dgst;Q=Ee,C=Error(n(419)),C.stack="",C.digest=Q,B0({value:C,source:null,stack:null}),g=xM(h,g,x)}else if(la||jm(h,g,x,!1),Q=(x&h.childLanes)!==0,la||Q){if(Q=fn,Q!==null&&(C=Xt(Q,x),C!==0&&C!==ye.retryLane))throw ye.retryLane=C,Xd(h,C),Qi(Q,h,C),mM;XM(ae)||Nw(),g=xM(h,g,x)}else XM(ae)?(g.flags|=192,g.child=h.child,g=null):(h=ye.treeContext,wn=Js(ae.nextSibling),Ga=g,Nr=!0,Cu=null,Ys=!1,h!==null&&j8(g,h),g=yM(g,C.children),g.flags|=4096);return g}return D?(Lu(),ae=C.fallback,D=g.mode,ye=h.child,Ee=ye.sibling,C=Xl(ye,{mode:"hidden",children:C.children}),C.subtreeFlags=ye.subtreeFlags&65011712,Ee!==null?ae=Xl(Ee,ae):(ae=ef(ae,D,x,null),ae.flags|=2),ae.return=g,C.return=g,C.sibling=ae,g.child=C,J0(null,C),C=g.child,ae=h.child.memoizedState,ae===null?ae=vM(x):(D=ae.cachePool,D!==null?(ye=sa._currentValue,D=D.parent!==ye?{parent:ye,pool:ye}:D):D=L8(),ae={baseLanes:ae.baseLanes|x,cachePool:D}),C.memoizedState=ae,C.childLanes=bM(h,Q,x),g.memoizedState=gM,J0(h.child,C)):(Du(g),x=h.child,h=x.sibling,x=Xl(x,{mode:"visible",children:C.children}),x.return=g,x.sibling=null,h!==null&&(Q=g.deletions,Q===null?(g.deletions=[h],g.flags|=16):Q.push(h)),g.child=x,g.memoizedState=null,x)}function yM(h,g){return g=gw({mode:"visible",children:g},h.mode),g.return=h,h.child=g}function gw(h,g){return h=us(22,h,null,g),h.lanes=0,h}function xM(h,g,x){return lf(g,h.child,null,x),h=yM(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function KF(h,g,x){h.lanes|=g;var C=h.alternate;C!==null&&(C.lanes|=g),IE(h.return,g,x)}function wM(h,g,x,C,D,P){var Q=h.memoizedState;Q===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:C,tail:x,tailMode:D,treeForkCount:P}:(Q.isBackwards=g,Q.rendering=null,Q.renderingStartTime=0,Q.last=C,Q.tail=x,Q.tailMode=D,Q.treeForkCount=P)}function GF(h,g,x){var C=g.pendingProps,D=C.revealOrder,P=C.tail;C=C.children;var Q=Xn.current,ae=(Q&2)!==0;if(ae?(Q=Q&1|2,g.flags|=128):Q&=1,J(Xn,Q),Ya(h,g,C,x),C=Nr?z0:0,!ae&&h!==null&&(h.flags&128)!==0)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&KF(h,x,g);else if(h.tag===19)KF(h,x,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}switch(D){case"forwards":for(x=g.child,D=null;x!==null;)h=x.alternate,h!==null&&aw(h)===null&&(D=x),x=x.sibling;x=D,x===null?(D=g.child,g.child=null):(D=x.sibling,x.sibling=null),wM(g,!1,D,x,P,C);break;case"backwards":case"unstable_legacy-backwards":for(x=null,D=g.child,g.child=null;D!==null;){if(h=D.alternate,h!==null&&aw(h)===null){g.child=D;break}h=D.sibling,D.sibling=x,x=D,D=h}wM(g,!0,x,null,P,C);break;case"together":wM(g,!1,null,null,void 0,C);break;default:g.memoizedState=null}return g.child}function ic(h,g,x){if(h!==null&&(g.dependencies=h.dependencies),Ru|=g.lanes,(x&g.childLanes)===0)if(h!==null){if(jm(h,g,x,!1),(x&g.childLanes)===0)return null}else return null;if(h!==null&&g.child!==h.child)throw Error(n(153));if(g.child!==null){for(h=g.child,x=Xl(h,h.pendingProps),g.child=x,x.return=g;h.sibling!==null;)h=h.sibling,x=x.sibling=Xl(h,h.pendingProps),x.return=g;x.sibling=null}return g.child}function SM(h,g){return(h.lanes&g)!==0?!0:(h=h.dependencies,!!(h!==null&&Q1(h)))}function Oxe(h,g,x){switch(g.tag){case 3:me(g,g.stateNode.containerInfo),Eu(g,sa,h.memoizedState.cache),tf();break;case 27:case 5:oe(g);break;case 4:me(g,g.stateNode.containerInfo);break;case 10:Eu(g,g.type,g.memoizedProps.value);break;case 31:if(g.memoizedState!==null)return g.flags|=128,GE(g),null;break;case 13:var C=g.memoizedState;if(C!==null)return C.dehydrated!==null?(Du(g),g.flags|=128,null):(x&g.child.childLanes)!==0?WF(h,g,x):(Du(g),h=ic(h,g,x),h!==null?h.sibling:null);Du(g);break;case 19:var D=(h.flags&128)!==0;if(C=(x&g.childLanes)!==0,C||(jm(h,g,x,!1),C=(x&g.childLanes)!==0),D){if(C)return GF(h,g,x);g.flags|=128}if(D=g.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),J(Xn,Xn.current),C)break;return null;case 22:return g.lanes=0,BF(h,g,x,g.pendingProps);case 24:Eu(g,sa,h.memoizedState.cache)}return ic(h,g,x)}function VF(h,g,x){if(h!==null)if(h.memoizedProps!==g.pendingProps)la=!0;else{if(!SM(h,x)&&(g.flags&128)===0)return la=!1,Oxe(h,g,x);la=(h.flags&131072)!==0}else la=!1,Nr&&(g.flags&1048576)!==0&&C8(g,z0,g.index);switch(g.lanes=0,g.tag){case 16:e:{var C=g.pendingProps;if(h=sf(g.elementType),g.type=h,typeof h=="function")jE(h)?(C=uf(h,C),g.tag=1,g=HF(null,g,h,C,x)):(g.tag=0,g=pM(null,g,h,C,x));else{if(h!=null){var D=h.$$typeof;if(D===k){g.tag=11,g=RF(null,g,h,C,x);break e}else if(D===T){g.tag=14,g=PF(null,g,h,C,x);break e}}throw g=M(h)||h,Error(n(306,g,""))}}return g;case 0:return pM(h,g,g.type,g.pendingProps,x);case 1:return C=g.type,D=uf(C,g.pendingProps),HF(h,g,C,D,x);case 3:e:{if(me(g,g.stateNode.containerInfo),h===null)throw Error(n(387));C=g.pendingProps;var P=g.memoizedState;D=P.element,UE(h,g),K0(g,C,null,x);var Q=g.memoizedState;if(C=Q.cache,Eu(g,sa,C),C!==P.cache&&RE(g,[sa],x,!0),W0(),C=Q.element,P.isDehydrated)if(P={element:C,isDehydrated:!1,cache:Q.cache},g.updateQueue.baseState=P,g.memoizedState=P,g.flags&256){g=qF(h,g,C,x);break e}else if(C!==D){D=Ks(Error(n(424)),g),B0(D),g=qF(h,g,C,x);break e}else{switch(h=g.stateNode.containerInfo,h.nodeType){case 9:h=h.body;break;default:h=h.nodeName==="HTML"?h.ownerDocument.body:h}for(wn=Js(h.firstChild),Ga=g,Nr=!0,Cu=null,Ys=!0,x=B8(g,null,C,x),g.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling}else{if(tf(),C===D){g=ic(h,g,x);break e}Ya(h,g,C,x)}g=g.child}return g;case 26:return pw(h,g),h===null?(x=iH(g.type,null,g.pendingProps,null))?g.memoizedState=x:Nr||(x=g.type,h=g.pendingProps,C=Dw(ie.current).createElement(x),C[se]=g,C[xe]=h,Qa(C,x,h),vn(C),g.stateNode=C):g.memoizedState=iH(g.type,h.memoizedProps,g.pendingProps,h.memoizedState),null;case 27:return oe(g),h===null&&Nr&&(C=g.stateNode=rH(g.type,g.pendingProps,ie.current),Ga=g,Ys=!0,D=wn,Fu(g.type)?(tT=D,wn=Js(C.firstChild)):wn=D),Ya(h,g,g.pendingProps.children,x),pw(h,g),h===null&&(g.flags|=4194304),g.child;case 5:return h===null&&Nr&&((D=C=wn)&&(C=u1e(C,g.type,g.pendingProps,Ys),C!==null?(g.stateNode=C,Ga=g,wn=Js(C.firstChild),Ys=!1,D=!0):D=!1),D||ju(g)),oe(g),D=g.type,P=g.pendingProps,Q=h!==null?h.memoizedProps:null,C=P.children,QM(D,P)?C=null:Q!==null&&QM(D,Q)&&(g.flags|=32),g.memoizedState!==null&&(D=YE(h,g,Nxe,null,null,x),fv._currentValue=D),pw(h,g),Ya(h,g,C,x),g.child;case 6:return h===null&&Nr&&((h=x=wn)&&(x=d1e(x,g.pendingProps,Ys),x!==null?(g.stateNode=x,Ga=g,wn=null,h=!0):h=!1),h||ju(g)),null;case 13:return WF(h,g,x);case 4:return me(g,g.stateNode.containerInfo),C=g.pendingProps,h===null?g.child=lf(g,null,C,x):Ya(h,g,C,x),g.child;case 11:return RF(h,g,g.type,g.pendingProps,x);case 7:return Ya(h,g,g.pendingProps,x),g.child;case 8:return Ya(h,g,g.pendingProps.children,x),g.child;case 12:return Ya(h,g,g.pendingProps.children,x),g.child;case 10:return C=g.pendingProps,Eu(g,g.type,C.value),Ya(h,g,C.children,x),g.child;case 9:return D=g.type._context,C=g.pendingProps.children,nf(g),D=Va(D),C=C(D),g.flags|=1,Ya(h,g,C,x),g.child;case 14:return PF(h,g,g.type,g.pendingProps,x);case 15:return zF(h,g,g.type,g.pendingProps,x);case 19:return GF(h,g,x);case 31:return Lxe(h,g,x);case 22:return BF(h,g,x,g.pendingProps);case 24:return nf(g),C=Va(sa),h===null?(D=BE(),D===null&&(D=fn,P=PE(),D.pooledCache=P,P.refCount++,P!==null&&(D.pooledCacheLanes|=x),D=P),g.memoizedState={parent:C,cache:D},FE(g),Eu(g,sa,D)):((h.lanes&x)!==0&&(UE(h,g),K0(g,null,null,x),W0()),D=h.memoizedState,P=g.memoizedState,D.parent!==C?(D={parent:C,cache:C},g.memoizedState=D,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=D),Eu(g,sa,C)):(C=P.cache,Eu(g,sa,C),C!==D.cache&&RE(g,[sa],x,!0))),Ya(h,g,g.pendingProps.children,x),g.child;case 29:throw g.pendingProps}throw Error(n(156,g.tag))}function sc(h){h.flags|=4}function kM(h,g,x,C,D){if((g=(h.mode&32)!==0)&&(g=!1),g){if(h.flags|=16777216,(D&335544128)===D)if(h.stateNode.complete)h.flags|=8192;else if(wU())h.flags|=8192;else throw of=ew,$E}else h.flags&=-16777217}function YF(h,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)h.flags&=-16777217;else if(h.flags|=16777216,!uH(g))if(wU())h.flags|=8192;else throw of=ew,$E}function vw(h,g){g!==null&&(h.flags|=4),h.flags&16384&&(g=h.tag!==22?ut():536870912,h.lanes|=g,Bm|=g)}function Z0(h,g){if(!Nr)switch(h.tailMode){case"hidden":g=h.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?h.tail=null:x.sibling=null;break;case"collapsed":x=h.tail;for(var C=null;x!==null;)x.alternate!==null&&(C=x),x=x.sibling;C===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:C.sibling=null}}function Sn(h){var g=h.alternate!==null&&h.alternate.child===h.child,x=0,C=0;if(g)for(var D=h.child;D!==null;)x|=D.lanes|D.childLanes,C|=D.subtreeFlags&65011712,C|=D.flags&65011712,D.return=h,D=D.sibling;else for(D=h.child;D!==null;)x|=D.lanes|D.childLanes,C|=D.subtreeFlags,C|=D.flags,D.return=h,D=D.sibling;return h.subtreeFlags|=C,h.childLanes=x,g}function Ixe(h,g,x){var C=g.pendingProps;switch(AE(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(g),null;case 1:return Sn(g),null;case 3:return x=g.stateNode,C=null,h!==null&&(C=h.memoizedState.cache),g.memoizedState.cache!==C&&(g.flags|=2048),rc(sa),te(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(h===null||h.child===null)&&(Cm(g)?sc(g):h===null||h.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,LE())),Sn(g),null;case 26:var D=g.type,P=g.memoizedState;return h===null?(sc(g),P!==null?(Sn(g),YF(g,P)):(Sn(g),kM(g,D,null,C,x))):P?P!==h.memoizedState?(sc(g),Sn(g),YF(g,P)):(Sn(g),g.flags&=-16777217):(h=h.memoizedProps,h!==C&&sc(g),Sn(g),kM(g,D,h,C,x)),null;case 27:if(ce(g),x=ie.current,D=g.type,h!==null&&g.stateNode!=null)h.memoizedProps!==C&&sc(g);else{if(!C){if(g.stateNode===null)throw Error(n(166));return Sn(g),null}h=ee.current,Cm(g)?E8(g):(h=rH(D,C,x),g.stateNode=h,sc(g))}return Sn(g),null;case 5:if(ce(g),D=g.type,h!==null&&g.stateNode!=null)h.memoizedProps!==C&&sc(g);else{if(!C){if(g.stateNode===null)throw Error(n(166));return Sn(g),null}if(P=ee.current,Cm(g))E8(g);else{var Q=Dw(ie.current);switch(P){case 1:P=Q.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:P=Q.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":P=Q.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":P=Q.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":P=Q.createElement("div"),P.innerHTML="<script><\/script>",P=P.removeChild(P.firstChild);break;case"select":P=typeof C.is=="string"?Q.createElement("select",{is:C.is}):Q.createElement("select"),C.multiple?P.multiple=!0:C.size&&(P.size=C.size);break;default:P=typeof C.is=="string"?Q.createElement(D,{is:C.is}):Q.createElement(D)}}P[se]=g,P[xe]=C;e:for(Q=g.child;Q!==null;){if(Q.tag===5||Q.tag===6)P.appendChild(Q.stateNode);else if(Q.tag!==4&&Q.tag!==27&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===g)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===g)break e;Q=Q.return}Q.sibling.return=Q.return,Q=Q.sibling}g.stateNode=P;e:switch(Qa(P,D,C),D){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}C&&sc(g)}}return Sn(g),kM(g,g.type,h===null?null:h.memoizedProps,g.pendingProps,x),null;case 6:if(h&&g.stateNode!=null)h.memoizedProps!==C&&sc(g);else{if(typeof C!="string"&&g.stateNode===null)throw Error(n(166));if(h=ie.current,Cm(g)){if(h=g.stateNode,x=g.memoizedProps,C=null,D=Ga,D!==null)switch(D.tag){case 27:case 5:C=D.memoizedProps}h[se]=g,h=!!(h.nodeValue===x||C!==null&&C.suppressHydrationWarning===!0||WU(h.nodeValue,x)),h||ju(g,!0)}else h=Dw(h).createTextNode(C),h[se]=g,g.stateNode=h}return Sn(g),null;case 31:if(x=g.memoizedState,h===null||h.memoizedState!==null){if(C=Cm(g),x!==null){if(h===null){if(!C)throw Error(n(318));if(h=g.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(557));h[se]=g}else tf(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Sn(g),h=!1}else x=LE(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=x),h=!0;if(!h)return g.flags&256?(fs(g),g):(fs(g),null);if((g.flags&128)!==0)throw Error(n(558))}return Sn(g),null;case 13:if(C=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(D=Cm(g),C!==null&&C.dehydrated!==null){if(h===null){if(!D)throw Error(n(318));if(D=g.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(n(317));D[se]=g}else tf(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Sn(g),D=!1}else D=LE(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=D),D=!0;if(!D)return g.flags&256?(fs(g),g):(fs(g),null)}return fs(g),(g.flags&128)!==0?(g.lanes=x,g):(x=C!==null,h=h!==null&&h.memoizedState!==null,x&&(C=g.child,D=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(D=C.alternate.memoizedState.cachePool.pool),P=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(P=C.memoizedState.cachePool.pool),P!==D&&(C.flags|=2048)),x!==h&&x&&(g.child.flags|=8192),vw(g,g.updateQueue),Sn(g),null);case 4:return te(),h===null&&WM(g.stateNode.containerInfo),Sn(g),null;case 10:return rc(g.type),Sn(g),null;case 19:if(G(Xn),C=g.memoizedState,C===null)return Sn(g),null;if(D=(g.flags&128)!==0,P=C.rendering,P===null)if(D)Z0(C,!1);else{if(Un!==0||h!==null&&(h.flags&128)!==0)for(h=g.child;h!==null;){if(P=aw(h),P!==null){for(g.flags|=128,Z0(C,!1),h=P.updateQueue,g.updateQueue=h,vw(g,h),g.subtreeFlags=0,h=x,x=g.child;x!==null;)k8(x,h),x=x.sibling;return J(Xn,Xn.current&1|2),Nr&&ec(g,C.treeForkCount),g.child}h=h.sibling}C.tail!==null&&Ae()>Sw&&(g.flags|=128,D=!0,Z0(C,!1),g.lanes=4194304)}else{if(!D)if(h=aw(P),h!==null){if(g.flags|=128,D=!0,h=h.updateQueue,g.updateQueue=h,vw(g,h),Z0(C,!0),C.tail===null&&C.tailMode==="hidden"&&!P.alternate&&!Nr)return Sn(g),null}else 2*Ae()-C.renderingStartTime>Sw&&x!==536870912&&(g.flags|=128,D=!0,Z0(C,!1),g.lanes=4194304);C.isBackwards?(P.sibling=g.child,g.child=P):(h=C.last,h!==null?h.sibling=P:g.child=P,C.last=P)}return C.tail!==null?(h=C.tail,C.rendering=h,C.tail=h.sibling,C.renderingStartTime=Ae(),h.sibling=null,x=Xn.current,J(Xn,D?x&1|2:x&1),Nr&&ec(g,C.treeForkCount),h):(Sn(g),null);case 22:case 23:return fs(g),KE(),C=g.memoizedState!==null,h!==null?h.memoizedState!==null!==C&&(g.flags|=8192):C&&(g.flags|=8192),C?(x&536870912)!==0&&(g.flags&128)===0&&(Sn(g),g.subtreeFlags&6&&(g.flags|=8192)):Sn(g),x=g.updateQueue,x!==null&&vw(g,x.retryQueue),x=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==x&&(g.flags|=2048),h!==null&&G(af),null;case 24:return x=null,h!==null&&(x=h.memoizedState.cache),g.memoizedState.cache!==x&&(g.flags|=2048),rc(sa),Sn(g),null;case 25:return null;case 30:return null}throw Error(n(156,g.tag))}function Rxe(h,g){switch(AE(g),g.tag){case 1:return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return rc(sa),te(),h=g.flags,(h&65536)!==0&&(h&128)===0?(g.flags=h&-65537|128,g):null;case 26:case 27:case 5:return ce(g),null;case 31:if(g.memoizedState!==null){if(fs(g),g.alternate===null)throw Error(n(340));tf()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 13:if(fs(g),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(n(340));tf()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return G(Xn),null;case 4:return te(),null;case 10:return rc(g.type),null;case 22:case 23:return fs(g),KE(),h!==null&&G(af),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 24:return rc(sa),null;case 25:return null;default:return null}}function QF(h,g){switch(AE(g),g.tag){case 3:rc(sa),te();break;case 26:case 27:case 5:ce(g);break;case 4:te();break;case 31:g.memoizedState!==null&&fs(g);break;case 13:fs(g);break;case 19:G(Xn);break;case 10:rc(g.type);break;case 22:case 23:fs(g),KE(),h!==null&&G(af);break;case 24:rc(sa)}}function X0(h,g){try{var x=g.updateQueue,C=x!==null?x.lastEffect:null;if(C!==null){var D=C.next;x=D;do{if((x.tag&h)===h){C=void 0;var P=x.create,Q=x.inst;C=P(),Q.destroy=C}x=x.next}while(x!==D)}}catch(ae){Qr(g,g.return,ae)}}function Ou(h,g,x){try{var C=g.updateQueue,D=C!==null?C.lastEffect:null;if(D!==null){var P=D.next;C=P;do{if((C.tag&h)===h){var Q=C.inst,ae=Q.destroy;if(ae!==void 0){Q.destroy=void 0,D=g;var ye=x,Ee=ae;try{Ee()}catch(Pe){Qr(D,ye,Pe)}}}C=C.next}while(C!==P)}}catch(Pe){Qr(g,g.return,Pe)}}function JF(h){var g=h.updateQueue;if(g!==null){var x=h.stateNode;try{F8(g,x)}catch(C){Qr(h,h.return,C)}}}function ZF(h,g,x){x.props=uf(h.type,h.memoizedProps),x.state=h.memoizedState;try{x.componentWillUnmount()}catch(C){Qr(h,g,C)}}function ev(h,g){try{var x=h.ref;if(x!==null){switch(h.tag){case 26:case 27:case 5:var C=h.stateNode;break;case 30:C=h.stateNode;break;default:C=h.stateNode}typeof x=="function"?h.refCleanup=x(C):x.current=C}}catch(D){Qr(h,g,D)}}function ll(h,g){var x=h.ref,C=h.refCleanup;if(x!==null)if(typeof C=="function")try{C()}catch(D){Qr(h,g,D)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(D){Qr(h,g,D)}else x.current=null}function XF(h){var g=h.type,x=h.memoizedProps,C=h.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":x.autoFocus&&C.focus();break e;case"img":x.src?C.src=x.src:x.srcSet&&(C.srcset=x.srcSet)}}catch(D){Qr(h,h.return,D)}}function _M(h,g,x){try{var C=h.stateNode;a1e(C,h.type,x,g),C[xe]=g}catch(D){Qr(h,h.return,D)}}function eU(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27&&Fu(h.type)||h.tag===4}function NM(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||eU(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.tag===27&&Fu(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function CM(h,g,x){var C=h.tag;if(C===5||C===6)h=h.stateNode,g?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(h,g):(g=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,g.appendChild(h),x=x._reactRootContainer,x!=null||g.onclick!==null||(g.onclick=at));else if(C!==4&&(C===27&&Fu(h.type)&&(x=h.stateNode,g=null),h=h.child,h!==null))for(CM(h,g,x),h=h.sibling;h!==null;)CM(h,g,x),h=h.sibling}function bw(h,g,x){var C=h.tag;if(C===5||C===6)h=h.stateNode,g?x.insertBefore(h,g):x.appendChild(h);else if(C!==4&&(C===27&&Fu(h.type)&&(x=h.stateNode),h=h.child,h!==null))for(bw(h,g,x),h=h.sibling;h!==null;)bw(h,g,x),h=h.sibling}function tU(h){var g=h.stateNode,x=h.memoizedProps;try{for(var C=h.type,D=g.attributes;D.length;)g.removeAttributeNode(D[0]);Qa(g,C,x),g[se]=h,g[xe]=x}catch(P){Qr(h,h.return,P)}}var oc=!1,ca=!1,jM=!1,rU=typeof WeakSet=="function"?WeakSet:Set,Da=null;function Pxe(h,g){if(h=h.containerInfo,VM=Bw,h=m8(h),xE(h)){if("selectionStart"in h)var x={start:h.selectionStart,end:h.selectionEnd};else e:{x=(x=h.ownerDocument)&&x.defaultView||window;var C=x.getSelection&&x.getSelection();if(C&&C.rangeCount!==0){x=C.anchorNode;var D=C.anchorOffset,P=C.focusNode;C=C.focusOffset;try{x.nodeType,P.nodeType}catch{x=null;break e}var Q=0,ae=-1,ye=-1,Ee=0,Pe=0,He=h,Te=null;t:for(;;){for(var Ie;He!==x||D!==0&&He.nodeType!==3||(ae=Q+D),He!==P||C!==0&&He.nodeType!==3||(ye=Q+C),He.nodeType===3&&(Q+=He.nodeValue.length),(Ie=He.firstChild)!==null;)Te=He,He=Ie;for(;;){if(He===h)break t;if(Te===x&&++Ee===D&&(ae=Q),Te===P&&++Pe===C&&(ye=Q),(Ie=He.nextSibling)!==null)break;He=Te,Te=He.parentNode}He=Ie}x=ae===-1||ye===-1?null:{start:ae,end:ye}}else x=null}x=x||{start:0,end:0}}else x=null;for(YM={focusedElem:h,selectionRange:x},Bw=!1,Da=g;Da!==null;)if(g=Da,h=g.child,(g.subtreeFlags&1028)!==0&&h!==null)h.return=g,Da=h;else for(;Da!==null;){switch(g=Da,P=g.alternate,h=g.flags,g.tag){case 0:if((h&4)!==0&&(h=g.updateQueue,h=h!==null?h.events:null,h!==null))for(x=0;x<h.length;x++)D=h[x],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((h&1024)!==0&&P!==null){h=void 0,x=g,D=P.memoizedProps,P=P.memoizedState,C=x.stateNode;try{var yt=uf(x.type,D);h=C.getSnapshotBeforeUpdate(yt,P),C.__reactInternalSnapshotBeforeUpdate=h}catch(qt){Qr(x,x.return,qt)}}break;case 3:if((h&1024)!==0){if(h=g.stateNode.containerInfo,x=h.nodeType,x===9)ZM(h);else if(x===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":ZM(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(n(163))}if(h=g.sibling,h!==null){h.return=g.return,Da=h;break}Da=g.return}}function nU(h,g,x){var C=x.flags;switch(x.tag){case 0:case 11:case 15:cc(h,x),C&4&&X0(5,x);break;case 1:if(cc(h,x),C&4)if(h=x.stateNode,g===null)try{h.componentDidMount()}catch(Q){Qr(x,x.return,Q)}else{var D=uf(x.type,g.memoizedProps);g=g.memoizedState;try{h.componentDidUpdate(D,g,h.__reactInternalSnapshotBeforeUpdate)}catch(Q){Qr(x,x.return,Q)}}C&64&&JF(x),C&512&&ev(x,x.return);break;case 3:if(cc(h,x),C&64&&(h=x.updateQueue,h!==null)){if(g=null,x.child!==null)switch(x.child.tag){case 27:case 5:g=x.child.stateNode;break;case 1:g=x.child.stateNode}try{F8(h,g)}catch(Q){Qr(x,x.return,Q)}}break;case 27:g===null&&C&4&&tU(x);case 26:case 5:cc(h,x),g===null&&C&4&&XF(x),C&512&&ev(x,x.return);break;case 12:cc(h,x);break;case 31:cc(h,x),C&4&&sU(h,x);break;case 13:cc(h,x),C&4&&oU(h,x),C&64&&(h=x.memoizedState,h!==null&&(h=h.dehydrated,h!==null&&(x=Kxe.bind(null,x),f1e(h,x))));break;case 22:if(C=x.memoizedState!==null||oc,!C){g=g!==null&&g.memoizedState!==null||ca,D=oc;var P=ca;oc=C,(ca=g)&&!P?uc(h,x,(x.subtreeFlags&8772)!==0):cc(h,x),oc=D,ca=P}break;case 30:break;default:cc(h,x)}}function aU(h){var g=h.alternate;g!==null&&(h.alternate=null,aU(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&Pt(g)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var jn=null,Ki=!1;function lc(h,g,x){for(x=x.child;x!==null;)iU(h,g,x),x=x.sibling}function iU(h,g,x){if(_e&&typeof _e.onCommitFiberUnmount=="function")try{_e.onCommitFiberUnmount(tt,x)}catch{}switch(x.tag){case 26:ca||ll(x,g),lc(h,g,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:ca||ll(x,g);var C=jn,D=Ki;Fu(x.type)&&(jn=x.stateNode,Ki=!1),lc(h,g,x),cv(x.stateNode),jn=C,Ki=D;break;case 5:ca||ll(x,g);case 6:if(C=jn,D=Ki,jn=null,lc(h,g,x),jn=C,Ki=D,jn!==null)if(Ki)try{(jn.nodeType===9?jn.body:jn.nodeName==="HTML"?jn.ownerDocument.body:jn).removeChild(x.stateNode)}catch(P){Qr(x,g,P)}else try{jn.removeChild(x.stateNode)}catch(P){Qr(x,g,P)}break;case 18:jn!==null&&(Ki?(h=jn,JU(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,x.stateNode),Gm(h)):JU(jn,x.stateNode));break;case 4:C=jn,D=Ki,jn=x.stateNode.containerInfo,Ki=!0,lc(h,g,x),jn=C,Ki=D;break;case 0:case 11:case 14:case 15:Ou(2,x,g),ca||Ou(4,x,g),lc(h,g,x);break;case 1:ca||(ll(x,g),C=x.stateNode,typeof C.componentWillUnmount=="function"&&ZF(x,g,C)),lc(h,g,x);break;case 21:lc(h,g,x);break;case 22:ca=(C=ca)||x.memoizedState!==null,lc(h,g,x),ca=C;break;default:lc(h,g,x)}}function sU(h,g){if(g.memoizedState===null&&(h=g.alternate,h!==null&&(h=h.memoizedState,h!==null))){h=h.dehydrated;try{Gm(h)}catch(x){Qr(g,g.return,x)}}}function oU(h,g){if(g.memoizedState===null&&(h=g.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{Gm(h)}catch(x){Qr(g,g.return,x)}}function zxe(h){switch(h.tag){case 31:case 13:case 19:var g=h.stateNode;return g===null&&(g=h.stateNode=new rU),g;case 22:return h=h.stateNode,g=h._retryCache,g===null&&(g=h._retryCache=new rU),g;default:throw Error(n(435,h.tag))}}function yw(h,g){var x=zxe(h);g.forEach(function(C){if(!x.has(C)){x.add(C);var D=Gxe.bind(null,h,C);C.then(D,D)}})}function Gi(h,g){var x=g.deletions;if(x!==null)for(var C=0;C<x.length;C++){var D=x[C],P=h,Q=g,ae=Q;e:for(;ae!==null;){switch(ae.tag){case 27:if(Fu(ae.type)){jn=ae.stateNode,Ki=!1;break e}break;case 5:jn=ae.stateNode,Ki=!1;break e;case 3:case 4:jn=ae.stateNode.containerInfo,Ki=!0;break e}ae=ae.return}if(jn===null)throw Error(n(160));iU(P,Q,D),jn=null,Ki=!1,P=D.alternate,P!==null&&(P.return=null),D.return=null}if(g.subtreeFlags&13886)for(g=g.child;g!==null;)lU(g,h),g=g.sibling}var Ao=null;function lU(h,g){var x=h.alternate,C=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Gi(g,h),Vi(h),C&4&&(Ou(3,h,h.return),X0(3,h),Ou(5,h,h.return));break;case 1:Gi(g,h),Vi(h),C&512&&(ca||x===null||ll(x,x.return)),C&64&&oc&&(h=h.updateQueue,h!==null&&(C=h.callbacks,C!==null&&(x=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=x===null?C:x.concat(C))));break;case 26:var D=Ao;if(Gi(g,h),Vi(h),C&512&&(ca||x===null||ll(x,x.return)),C&4){var P=x!==null?x.memoizedState:null;if(C=h.memoizedState,x===null)if(C===null)if(h.stateNode===null){e:{C=h.type,x=h.memoizedProps,D=D.ownerDocument||D;t:switch(C){case"title":P=D.getElementsByTagName("title")[0],(!P||P[lt]||P[se]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=D.createElement(C),D.head.insertBefore(P,D.querySelector("head > title"))),Qa(P,C,x),P[se]=h,vn(P),C=P;break e;case"link":var Q=lH("link","href",D).get(C+(x.href||""));if(Q){for(var ae=0;ae<Q.length;ae++)if(P=Q[ae],P.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&P.getAttribute("rel")===(x.rel==null?null:x.rel)&&P.getAttribute("title")===(x.title==null?null:x.title)&&P.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){Q.splice(ae,1);break t}}P=D.createElement(C),Qa(P,C,x),D.head.appendChild(P);break;case"meta":if(Q=lH("meta","content",D).get(C+(x.content||""))){for(ae=0;ae<Q.length;ae++)if(P=Q[ae],P.getAttribute("content")===(x.content==null?null:""+x.content)&&P.getAttribute("name")===(x.name==null?null:x.name)&&P.getAttribute("property")===(x.property==null?null:x.property)&&P.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&P.getAttribute("charset")===(x.charSet==null?null:x.charSet)){Q.splice(ae,1);break t}}P=D.createElement(C),Qa(P,C,x),D.head.appendChild(P);break;default:throw Error(n(468,C))}P[se]=h,vn(P),C=P}h.stateNode=C}else cH(D,h.type,h.stateNode);else h.stateNode=oH(D,C,h.memoizedProps);else P!==C?(P===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):P.count--,C===null?cH(D,h.type,h.stateNode):oH(D,C,h.memoizedProps)):C===null&&h.stateNode!==null&&_M(h,h.memoizedProps,x.memoizedProps)}break;case 27:Gi(g,h),Vi(h),C&512&&(ca||x===null||ll(x,x.return)),x!==null&&C&4&&_M(h,h.memoizedProps,x.memoizedProps);break;case 5:if(Gi(g,h),Vi(h),C&512&&(ca||x===null||ll(x,x.return)),h.flags&32){D=h.stateNode;try{Kt(D,"")}catch(yt){Qr(h,h.return,yt)}}C&4&&h.stateNode!=null&&(D=h.memoizedProps,_M(h,D,x!==null?x.memoizedProps:D)),C&1024&&(jM=!0);break;case 6:if(Gi(g,h),Vi(h),C&4){if(h.stateNode===null)throw Error(n(162));C=h.memoizedProps,x=h.stateNode;try{x.nodeValue=C}catch(yt){Qr(h,h.return,yt)}}break;case 3:if(Iw=null,D=Ao,Ao=Lw(g.containerInfo),Gi(g,h),Ao=D,Vi(h),C&4&&x!==null&&x.memoizedState.isDehydrated)try{Gm(g.containerInfo)}catch(yt){Qr(h,h.return,yt)}jM&&(jM=!1,cU(h));break;case 4:C=Ao,Ao=Lw(h.stateNode.containerInfo),Gi(g,h),Vi(h),Ao=C;break;case 12:Gi(g,h),Vi(h);break;case 31:Gi(g,h),Vi(h),C&4&&(C=h.updateQueue,C!==null&&(h.updateQueue=null,yw(h,C)));break;case 13:Gi(g,h),Vi(h),h.child.flags&8192&&h.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(ww=Ae()),C&4&&(C=h.updateQueue,C!==null&&(h.updateQueue=null,yw(h,C)));break;case 22:D=h.memoizedState!==null;var ye=x!==null&&x.memoizedState!==null,Ee=oc,Pe=ca;if(oc=Ee||D,ca=Pe||ye,Gi(g,h),ca=Pe,oc=Ee,Vi(h),C&8192)e:for(g=h.stateNode,g._visibility=D?g._visibility&-2:g._visibility|1,D&&(x===null||ye||oc||ca||df(h)),x=null,g=h;;){if(g.tag===5||g.tag===26){if(x===null){ye=x=g;try{if(P=ye.stateNode,D)Q=P.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{ae=ye.stateNode;var He=ye.memoizedProps.style,Te=He!=null&&He.hasOwnProperty("display")?He.display:null;ae.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch(yt){Qr(ye,ye.return,yt)}}}else if(g.tag===6){if(x===null){ye=g;try{ye.stateNode.nodeValue=D?"":ye.memoizedProps}catch(yt){Qr(ye,ye.return,yt)}}}else if(g.tag===18){if(x===null){ye=g;try{var Ie=ye.stateNode;D?ZU(Ie,!0):ZU(ye.stateNode,!1)}catch(yt){Qr(ye,ye.return,yt)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===h)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break e;for(;g.sibling===null;){if(g.return===null||g.return===h)break e;x===g&&(x=null),g=g.return}x===g&&(x=null),g.sibling.return=g.return,g=g.sibling}C&4&&(C=h.updateQueue,C!==null&&(x=C.retryQueue,x!==null&&(C.retryQueue=null,yw(h,x))));break;case 19:Gi(g,h),Vi(h),C&4&&(C=h.updateQueue,C!==null&&(h.updateQueue=null,yw(h,C)));break;case 30:break;case 21:break;default:Gi(g,h),Vi(h)}}function Vi(h){var g=h.flags;if(g&2){try{for(var x,C=h.return;C!==null;){if(eU(C)){x=C;break}C=C.return}if(x==null)throw Error(n(160));switch(x.tag){case 27:var D=x.stateNode,P=NM(h);bw(h,P,D);break;case 5:var Q=x.stateNode;x.flags&32&&(Kt(Q,""),x.flags&=-33);var ae=NM(h);bw(h,ae,Q);break;case 3:case 4:var ye=x.stateNode.containerInfo,Ee=NM(h);CM(h,Ee,ye);break;default:throw Error(n(161))}}catch(Pe){Qr(h,h.return,Pe)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function cU(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var g=h;cU(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),h=h.sibling}}function cc(h,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)nU(h,g.alternate,g),g=g.sibling}function df(h){for(h=h.child;h!==null;){var g=h;switch(g.tag){case 0:case 11:case 14:case 15:Ou(4,g,g.return),df(g);break;case 1:ll(g,g.return);var x=g.stateNode;typeof x.componentWillUnmount=="function"&&ZF(g,g.return,x),df(g);break;case 27:cv(g.stateNode);case 26:case 5:ll(g,g.return),df(g);break;case 22:g.memoizedState===null&&df(g);break;case 30:df(g);break;default:df(g)}h=h.sibling}}function uc(h,g,x){for(x=x&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var C=g.alternate,D=h,P=g,Q=P.flags;switch(P.tag){case 0:case 11:case 15:uc(D,P,x),X0(4,P);break;case 1:if(uc(D,P,x),C=P,D=C.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(Ee){Qr(C,C.return,Ee)}if(C=P,D=C.updateQueue,D!==null){var ae=C.stateNode;try{var ye=D.shared.hiddenCallbacks;if(ye!==null)for(D.shared.hiddenCallbacks=null,D=0;D<ye.length;D++)$8(ye[D],ae)}catch(Ee){Qr(C,C.return,Ee)}}x&&Q&64&&JF(P),ev(P,P.return);break;case 27:tU(P);case 26:case 5:uc(D,P,x),x&&C===null&&Q&4&&XF(P),ev(P,P.return);break;case 12:uc(D,P,x);break;case 31:uc(D,P,x),x&&Q&4&&sU(D,P);break;case 13:uc(D,P,x),x&&Q&4&&oU(D,P);break;case 22:P.memoizedState===null&&uc(D,P,x),ev(P,P.return);break;case 30:break;default:uc(D,P,x)}g=g.sibling}}function EM(h,g){var x=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),h=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(h=g.memoizedState.cachePool.pool),h!==x&&(h!=null&&h.refCount++,x!=null&&$0(x))}function MM(h,g){h=null,g.alternate!==null&&(h=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==h&&(g.refCount++,h!=null&&$0(h))}function Do(h,g,x,C){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)uU(h,g,x,C),g=g.sibling}function uU(h,g,x,C){var D=g.flags;switch(g.tag){case 0:case 11:case 15:Do(h,g,x,C),D&2048&&X0(9,g);break;case 1:Do(h,g,x,C);break;case 3:Do(h,g,x,C),D&2048&&(h=null,g.alternate!==null&&(h=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==h&&(g.refCount++,h!=null&&$0(h)));break;case 12:if(D&2048){Do(h,g,x,C),h=g.stateNode;try{var P=g.memoizedProps,Q=P.id,ae=P.onPostCommit;typeof ae=="function"&&ae(Q,g.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(ye){Qr(g,g.return,ye)}}else Do(h,g,x,C);break;case 31:Do(h,g,x,C);break;case 13:Do(h,g,x,C);break;case 23:break;case 22:P=g.stateNode,Q=g.alternate,g.memoizedState!==null?P._visibility&2?Do(h,g,x,C):tv(h,g):P._visibility&2?Do(h,g,x,C):(P._visibility|=2,Rm(h,g,x,C,(g.subtreeFlags&10256)!==0||!1)),D&2048&&EM(Q,g);break;case 24:Do(h,g,x,C),D&2048&&MM(g.alternate,g);break;default:Do(h,g,x,C)}}function Rm(h,g,x,C,D){for(D=D&&((g.subtreeFlags&10256)!==0||!1),g=g.child;g!==null;){var P=h,Q=g,ae=x,ye=C,Ee=Q.flags;switch(Q.tag){case 0:case 11:case 15:Rm(P,Q,ae,ye,D),X0(8,Q);break;case 23:break;case 22:var Pe=Q.stateNode;Q.memoizedState!==null?Pe._visibility&2?Rm(P,Q,ae,ye,D):tv(P,Q):(Pe._visibility|=2,Rm(P,Q,ae,ye,D)),D&&Ee&2048&&EM(Q.alternate,Q);break;case 24:Rm(P,Q,ae,ye,D),D&&Ee&2048&&MM(Q.alternate,Q);break;default:Rm(P,Q,ae,ye,D)}g=g.sibling}}function tv(h,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var x=h,C=g,D=C.flags;switch(C.tag){case 22:tv(x,C),D&2048&&EM(C.alternate,C);break;case 24:tv(x,C),D&2048&&MM(C.alternate,C);break;default:tv(x,C)}g=g.sibling}}var rv=8192;function Pm(h,g,x){if(h.subtreeFlags&rv)for(h=h.child;h!==null;)dU(h,g,x),h=h.sibling}function dU(h,g,x){switch(h.tag){case 26:Pm(h,g,x),h.flags&rv&&h.memoizedState!==null&&_1e(x,Ao,h.memoizedState,h.memoizedProps);break;case 5:Pm(h,g,x);break;case 3:case 4:var C=Ao;Ao=Lw(h.stateNode.containerInfo),Pm(h,g,x),Ao=C;break;case 22:h.memoizedState===null&&(C=h.alternate,C!==null&&C.memoizedState!==null?(C=rv,rv=16777216,Pm(h,g,x),rv=C):Pm(h,g,x));break;default:Pm(h,g,x)}}function fU(h){var g=h.alternate;if(g!==null&&(h=g.child,h!==null)){g.child=null;do g=h.sibling,h.sibling=null,h=g;while(h!==null)}}function nv(h){var g=h.deletions;if((h.flags&16)!==0){if(g!==null)for(var x=0;x<g.length;x++){var C=g[x];Da=C,mU(C,h)}fU(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)hU(h),h=h.sibling}function hU(h){switch(h.tag){case 0:case 11:case 15:nv(h),h.flags&2048&&Ou(9,h,h.return);break;case 3:nv(h);break;case 12:nv(h);break;case 22:var g=h.stateNode;h.memoizedState!==null&&g._visibility&2&&(h.return===null||h.return.tag!==13)?(g._visibility&=-3,xw(h)):nv(h);break;default:nv(h)}}function xw(h){var g=h.deletions;if((h.flags&16)!==0){if(g!==null)for(var x=0;x<g.length;x++){var C=g[x];Da=C,mU(C,h)}fU(h)}for(h=h.child;h!==null;){switch(g=h,g.tag){case 0:case 11:case 15:Ou(8,g,g.return),xw(g);break;case 22:x=g.stateNode,x._visibility&2&&(x._visibility&=-3,xw(g));break;default:xw(g)}h=h.sibling}}function mU(h,g){for(;Da!==null;){var x=Da;switch(x.tag){case 0:case 11:case 15:Ou(8,x,g);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var C=x.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:$0(x.memoizedState.cache)}if(C=x.child,C!==null)C.return=x,Da=C;else e:for(x=h;Da!==null;){C=Da;var D=C.sibling,P=C.return;if(aU(C),C===x){Da=null;break e}if(D!==null){D.return=P,Da=D;break e}Da=P}}}var Bxe={getCacheForType:function(h){var g=Va(sa),x=g.data.get(h);return x===void 0&&(x=h(),g.data.set(h,x)),x},cacheSignal:function(){return Va(sa).controller.signal}},$xe=typeof WeakMap=="function"?WeakMap:Map,$r=0,fn=null,pr=null,xr=0,Yr=0,hs=null,Iu=!1,zm=!1,TM=!1,dc=0,Un=0,Ru=0,ff=0,AM=0,ms=0,Bm=0,av=null,Yi=null,DM=!1,ww=0,pU=0,Sw=1/0,kw=null,Pu=null,xa=0,zu=null,$m=null,fc=0,LM=0,OM=null,gU=null,iv=0,IM=null;function ps(){return($r&2)!==0&&xr!==0?xr&-xr:I.T!==null?FM():Ke()}function vU(){if(ms===0)if((xr&536870912)===0||Nr){var h=Zt;Zt<<=1,(Zt&3932160)===0&&(Zt=262144),ms=h}else ms=536870912;return h=ds.current,h!==null&&(h.flags|=32),ms}function Qi(h,g,x){(h===fn&&(Yr===2||Yr===9)||h.cancelPendingCommit!==null)&&(Fm(h,0),Bu(h,xr,ms,!1)),jt(h,x),(($r&2)===0||h!==fn)&&(h===fn&&(($r&2)===0&&(ff|=x),Un===4&&Bu(h,xr,ms,!1)),cl(h))}function bU(h,g,x){if(($r&6)!==0)throw Error(n(327));var C=!x&&(g&127)===0&&(g&h.expiredLanes)===0||De(h,g),D=C?Hxe(h,g):PM(h,g,!0),P=C;do{if(D===0){zm&&!C&&Bu(h,g,0,!1);break}else{if(x=h.current.alternate,P&&!Fxe(x)){D=PM(h,g,!1),P=!1;continue}if(D===2){if(P=g,h.errorRecoveryDisabledLanes&P)var Q=0;else Q=h.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){g=Q;e:{var ae=h;D=av;var ye=ae.current.memoizedState.isDehydrated;if(ye&&(Fm(ae,Q).flags|=256),Q=PM(ae,Q,!1),Q!==2){if(TM&&!ye){ae.errorRecoveryDisabledLanes|=P,ff|=P,D=4;break e}P=Yi,Yi=D,P!==null&&(Yi===null?Yi=P:Yi.push.apply(Yi,P))}D=Q}if(P=!1,D!==2)continue}}if(D===1){Fm(h,0),Bu(h,g,0,!0);break}e:{switch(C=h,P=D,P){case 0:case 1:throw Error(n(345));case 4:if((g&4194048)!==g)break;case 6:Bu(C,g,ms,!Iu);break e;case 2:Yi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((g&62914560)===g&&(D=ww+300-Ae(),10<D)){if(Bu(C,g,ms,!Iu),he(C,0,!0)!==0)break e;fc=g,C.timeoutHandle=YU(yU.bind(null,C,x,Yi,kw,DM,g,ms,ff,Bm,Iu,P,"Throttled",-0,0),D);break e}yU(C,x,Yi,kw,DM,g,ms,ff,Bm,Iu,P,null,-0,0)}}break}while(!0);cl(h)}function yU(h,g,x,C,D,P,Q,ae,ye,Ee,Pe,He,Te,Ie){if(h.timeoutHandle=-1,He=g.subtreeFlags,He&8192||(He&16785408)===16785408){He={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:at},dU(g,P,He);var yt=(P&62914560)===P?ww-Ae():(P&4194048)===P?pU-Ae():0;if(yt=N1e(He,yt),yt!==null){fc=P,h.cancelPendingCommit=yt(jU.bind(null,h,g,P,x,C,D,Q,ae,ye,Pe,He,null,Te,Ie)),Bu(h,P,Q,!Ee);return}}jU(h,g,P,x,C,D,Q,ae,ye)}function Fxe(h){for(var g=h;;){var x=g.tag;if((x===0||x===11||x===15)&&g.flags&16384&&(x=g.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var C=0;C<x.length;C++){var D=x[C],P=D.getSnapshot;D=D.value;try{if(!cs(P(),D))return!1}catch{return!1}}if(x=g.child,g.subtreeFlags&16384&&x!==null)x.return=g,g=x;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Bu(h,g,x,C){g&=~AM,g&=~ff,h.suspendedLanes|=g,h.pingedLanes&=~g,C&&(h.warmLanes|=g),C=h.expirationTimes;for(var D=g;0<D;){var P=31-Ve(D),Q=1<<P;C[P]=-1,D&=~Q}x!==0&&Xe(h,x,g)}function _w(){return($r&6)===0?(sv(0),!1):!0}function RM(){if(pr!==null){if(Yr===0)var h=pr.return;else h=pr,tc=rf=null,ZE(h),Am=null,U0=0,h=pr;for(;h!==null;)QF(h.alternate,h),h=h.return;pr=null}}function Fm(h,g){var x=h.timeoutHandle;x!==-1&&(h.timeoutHandle=-1,o1e(x)),x=h.cancelPendingCommit,x!==null&&(h.cancelPendingCommit=null,x()),fc=0,RM(),fn=h,pr=x=Xl(h.current,null),xr=g,Yr=0,hs=null,Iu=!1,zm=De(h,g),TM=!1,Bm=ms=AM=ff=Ru=Un=0,Yi=av=null,DM=!1,(g&8)!==0&&(g|=g&32);var C=h.entangledLanes;if(C!==0)for(h=h.entanglements,C&=g;0<C;){var D=31-Ve(C),P=1<<D;g|=h[D],C&=~P}return dc=g,W1(),x}function xU(h,g){ir=null,I.H=Q0,g===Tm||g===X1?(g=R8(),Yr=3):g===$E?(g=R8(),Yr=4):Yr=g===mM?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,hs=g,pr===null&&(Un=1,hw(h,Ks(g,h.current)))}function wU(){var h=ds.current;return h===null?!0:(xr&4194048)===xr?Qs===null:(xr&62914560)===xr||(xr&536870912)!==0?h===Qs:!1}function SU(){var h=I.H;return I.H=Q0,h===null?Q0:h}function kU(){var h=I.A;return I.A=Bxe,h}function Nw(){Un=4,Iu||(xr&4194048)!==xr&&ds.current!==null||(zm=!0),(Ru&134217727)===0&&(ff&134217727)===0||fn===null||Bu(fn,xr,ms,!1)}function PM(h,g,x){var C=$r;$r|=2;var D=SU(),P=kU();(fn!==h||xr!==g)&&(kw=null,Fm(h,g)),g=!1;var Q=Un;e:do try{if(Yr!==0&&pr!==null){var ae=pr,ye=hs;switch(Yr){case 8:RM(),Q=6;break e;case 3:case 2:case 9:case 6:ds.current===null&&(g=!0);var Ee=Yr;if(Yr=0,hs=null,Um(h,ae,ye,Ee),x&&zm){Q=0;break e}break;default:Ee=Yr,Yr=0,hs=null,Um(h,ae,ye,Ee)}}Uxe(),Q=Un;break}catch(Pe){xU(h,Pe)}while(!0);return g&&h.shellSuspendCounter++,tc=rf=null,$r=C,I.H=D,I.A=P,pr===null&&(fn=null,xr=0,W1()),Q}function Uxe(){for(;pr!==null;)_U(pr)}function Hxe(h,g){var x=$r;$r|=2;var C=SU(),D=kU();fn!==h||xr!==g?(kw=null,Sw=Ae()+500,Fm(h,g)):zm=De(h,g);e:do try{if(Yr!==0&&pr!==null){g=pr;var P=hs;t:switch(Yr){case 1:Yr=0,hs=null,Um(h,g,P,1);break;case 2:case 9:if(O8(P)){Yr=0,hs=null,NU(g);break}g=function(){Yr!==2&&Yr!==9||fn!==h||(Yr=7),cl(h)},P.then(g,g);break e;case 3:Yr=7;break e;case 4:Yr=5;break e;case 7:O8(P)?(Yr=0,hs=null,NU(g)):(Yr=0,hs=null,Um(h,g,P,7));break;case 5:var Q=null;switch(pr.tag){case 26:Q=pr.memoizedState;case 5:case 27:var ae=pr;if(Q?uH(Q):ae.stateNode.complete){Yr=0,hs=null;var ye=ae.sibling;if(ye!==null)pr=ye;else{var Ee=ae.return;Ee!==null?(pr=Ee,Cw(Ee)):pr=null}break t}}Yr=0,hs=null,Um(h,g,P,5);break;case 6:Yr=0,hs=null,Um(h,g,P,6);break;case 8:RM(),Un=6;break e;default:throw Error(n(462))}}qxe();break}catch(Pe){xU(h,Pe)}while(!0);return tc=rf=null,I.H=C,I.A=D,$r=x,pr!==null?0:(fn=null,xr=0,W1(),Un)}function qxe(){for(;pr!==null&&!ve();)_U(pr)}function _U(h){var g=VF(h.alternate,h,dc);h.memoizedProps=h.pendingProps,g===null?Cw(h):pr=g}function NU(h){var g=h,x=g.alternate;switch(g.tag){case 15:case 0:g=UF(x,g,g.pendingProps,g.type,void 0,xr);break;case 11:g=UF(x,g,g.pendingProps,g.type.render,g.ref,xr);break;case 5:ZE(g);default:QF(x,g),g=pr=k8(g,dc),g=VF(x,g,dc)}h.memoizedProps=h.pendingProps,g===null?Cw(h):pr=g}function Um(h,g,x,C){tc=rf=null,ZE(g),Am=null,U0=0;var D=g.return;try{if(Dxe(h,D,g,x,xr)){Un=1,hw(h,Ks(x,h.current)),pr=null;return}}catch(P){if(D!==null)throw pr=D,P;Un=1,hw(h,Ks(x,h.current)),pr=null;return}g.flags&32768?(Nr||C===1?h=!0:zm||(xr&536870912)!==0?h=!1:(Iu=h=!0,(C===2||C===9||C===3||C===6)&&(C=ds.current,C!==null&&C.tag===13&&(C.flags|=16384))),CU(g,h)):Cw(g)}function Cw(h){var g=h;do{if((g.flags&32768)!==0){CU(g,Iu);return}h=g.return;var x=Ixe(g.alternate,g,dc);if(x!==null){pr=x;return}if(g=g.sibling,g!==null){pr=g;return}pr=g=h}while(g!==null);Un===0&&(Un=5)}function CU(h,g){do{var x=Rxe(h.alternate,h);if(x!==null){x.flags&=32767,pr=x;return}if(x=h.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!g&&(h=h.sibling,h!==null)){pr=h;return}pr=h=x}while(h!==null);Un=6,pr=null}function jU(h,g,x,C,D,P,Q,ae,ye){h.cancelPendingCommit=null;do jw();while(xa!==0);if(($r&6)!==0)throw Error(n(327));if(g!==null){if(g===h.current)throw Error(n(177));if(P=g.lanes|g.childLanes,P|=NE,Je(h,x,P,Q,ae,ye),h===fn&&(pr=fn=null,xr=0),$m=g,zu=h,fc=x,LM=P,OM=D,gU=C,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,Vxe(ot,function(){return DU(),null})):(h.callbackNode=null,h.callbackPriority=0),C=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||C){C=I.T,I.T=null,D=B.p,B.p=2,Q=$r,$r|=4;try{Pxe(h,g,x)}finally{$r=Q,B.p=D,I.T=C}}xa=1,EU(),MU(),TU()}}function EU(){if(xa===1){xa=0;var h=zu,g=$m,x=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||x){x=I.T,I.T=null;var C=B.p;B.p=2;var D=$r;$r|=4;try{lU(g,h);var P=YM,Q=m8(h.containerInfo),ae=P.focusedElem,ye=P.selectionRange;if(Q!==ae&&ae&&ae.ownerDocument&&h8(ae.ownerDocument.documentElement,ae)){if(ye!==null&&xE(ae)){var Ee=ye.start,Pe=ye.end;if(Pe===void 0&&(Pe=Ee),"selectionStart"in ae)ae.selectionStart=Ee,ae.selectionEnd=Math.min(Pe,ae.value.length);else{var He=ae.ownerDocument||document,Te=He&&He.defaultView||window;if(Te.getSelection){var Ie=Te.getSelection(),yt=ae.textContent.length,qt=Math.min(ye.start,yt),on=ye.end===void 0?qt:Math.min(ye.end,yt);!Ie.extend&&qt>on&&(Q=on,on=qt,qt=Q);var Ne=f8(ae,qt),Se=f8(ae,on);if(Ne&&Se&&(Ie.rangeCount!==1||Ie.anchorNode!==Ne.node||Ie.anchorOffset!==Ne.offset||Ie.focusNode!==Se.node||Ie.focusOffset!==Se.offset)){var je=He.createRange();je.setStart(Ne.node,Ne.offset),Ie.removeAllRanges(),qt>on?(Ie.addRange(je),Ie.extend(Se.node,Se.offset)):(je.setEnd(Se.node,Se.offset),Ie.addRange(je))}}}}for(He=[],Ie=ae;Ie=Ie.parentNode;)Ie.nodeType===1&&He.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<He.length;ae++){var Fe=He[ae];Fe.element.scrollLeft=Fe.left,Fe.element.scrollTop=Fe.top}}Bw=!!VM,YM=VM=null}finally{$r=D,B.p=C,I.T=x}}h.current=g,xa=2}}function MU(){if(xa===2){xa=0;var h=zu,g=$m,x=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||x){x=I.T,I.T=null;var C=B.p;B.p=2;var D=$r;$r|=4;try{nU(h,g.alternate,g)}finally{$r=D,B.p=C,I.T=x}}xa=3}}function TU(){if(xa===4||xa===3){xa=0,Le();var h=zu,g=$m,x=fc,C=gU;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?xa=5:(xa=0,$m=zu=null,AU(h,h.pendingLanes));var D=h.pendingLanes;if(D===0&&(Pu=null),Oe(x),g=g.stateNode,_e&&typeof _e.onCommitFiberRoot=="function")try{_e.onCommitFiberRoot(tt,g,void 0,(g.current.flags&128)===128)}catch{}if(C!==null){g=I.T,D=B.p,B.p=2,I.T=null;try{for(var P=h.onRecoverableError,Q=0;Q<C.length;Q++){var ae=C[Q];P(ae.value,{componentStack:ae.stack})}}finally{I.T=g,B.p=D}}(fc&3)!==0&&jw(),cl(h),D=h.pendingLanes,(x&261930)!==0&&(D&42)!==0?h===IM?iv++:(iv=0,IM=h):iv=0,sv(0)}}function AU(h,g){(h.pooledCacheLanes&=g)===0&&(g=h.pooledCache,g!=null&&(h.pooledCache=null,$0(g)))}function jw(){return EU(),MU(),TU(),DU()}function DU(){if(xa!==5)return!1;var h=zu,g=LM;LM=0;var x=Oe(fc),C=I.T,D=B.p;try{B.p=32>x?32:x,I.T=null,x=OM,OM=null;var P=zu,Q=fc;if(xa=0,$m=zu=null,fc=0,($r&6)!==0)throw Error(n(331));var ae=$r;if($r|=4,hU(P.current),uU(P,P.current,Q,x),$r=ae,sv(0,!1),_e&&typeof _e.onPostCommitFiberRoot=="function")try{_e.onPostCommitFiberRoot(tt,P)}catch{}return!0}finally{B.p=D,I.T=C,AU(h,g)}}function LU(h,g,x){g=Ks(x,g),g=hM(h.stateNode,g,2),h=Au(h,g,2),h!==null&&(jt(h,2),cl(h))}function Qr(h,g,x){if(h.tag===3)LU(h,h,x);else for(;g!==null;){if(g.tag===3){LU(g,h,x);break}else if(g.tag===1){var C=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(Pu===null||!Pu.has(C))){h=Ks(x,h),x=OF(2),C=Au(g,x,2),C!==null&&(IF(x,C,g,h),jt(C,2),cl(C));break}}g=g.return}}function zM(h,g,x){var C=h.pingCache;if(C===null){C=h.pingCache=new $xe;var D=new Set;C.set(g,D)}else D=C.get(g),D===void 0&&(D=new Set,C.set(g,D));D.has(x)||(TM=!0,D.add(x),h=Wxe.bind(null,h,g,x),g.then(h,h))}function Wxe(h,g,x){var C=h.pingCache;C!==null&&C.delete(g),h.pingedLanes|=h.suspendedLanes&x,h.warmLanes&=~x,fn===h&&(xr&x)===x&&(Un===4||Un===3&&(xr&62914560)===xr&&300>Ae()-ww?($r&2)===0&&Fm(h,0):AM|=x,Bm===xr&&(Bm=0)),cl(h)}function OU(h,g){g===0&&(g=ut()),h=Xd(h,g),h!==null&&(jt(h,g),cl(h))}function Kxe(h){var g=h.memoizedState,x=0;g!==null&&(x=g.retryLane),OU(h,x)}function Gxe(h,g){var x=0;switch(h.tag){case 31:case 13:var C=h.stateNode,D=h.memoizedState;D!==null&&(x=D.retryLane);break;case 19:C=h.stateNode;break;case 22:C=h.stateNode._retryCache;break;default:throw Error(n(314))}C!==null&&C.delete(g),OU(h,x)}function Vxe(h,g){return ke(h,g)}var Ew=null,Hm=null,BM=!1,Mw=!1,$M=!1,$u=0;function cl(h){h!==Hm&&h.next===null&&(Hm===null?Ew=Hm=h:Hm=Hm.next=h),Mw=!0,BM||(BM=!0,Qxe())}function sv(h,g){if(!$M&&Mw){$M=!0;do for(var x=!1,C=Ew;C!==null;){if(h!==0){var D=C.pendingLanes;if(D===0)var P=0;else{var Q=C.suspendedLanes,ae=C.pingedLanes;P=(1<<31-Ve(42|h)+1)-1,P&=D&~(Q&~ae),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(x=!0,zU(C,P))}else P=xr,P=he(C,C===fn?P:0,C.cancelPendingCommit!==null||C.timeoutHandle!==-1),(P&3)===0||De(C,P)||(x=!0,zU(C,P));C=C.next}while(x);$M=!1}}function Yxe(){IU()}function IU(){Mw=BM=!1;var h=0;$u!==0&&s1e()&&(h=$u);for(var g=Ae(),x=null,C=Ew;C!==null;){var D=C.next,P=RU(C,g);P===0?(C.next=null,x===null?Ew=D:x.next=D,D===null&&(Hm=x)):(x=C,(h!==0||(P&3)!==0)&&(Mw=!0)),C=D}xa!==0&&xa!==5||sv(h),$u!==0&&($u=0)}function RU(h,g){for(var x=h.suspendedLanes,C=h.pingedLanes,D=h.expirationTimes,P=h.pendingLanes&-62914561;0<P;){var Q=31-Ve(P),ae=1<<Q,ye=D[Q];ye===-1?((ae&x)===0||(ae&C)!==0)&&(D[Q]=Ue(ae,g)):ye<=g&&(h.expiredLanes|=ae),P&=~ae}if(g=fn,x=xr,x=he(h,h===g?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),C=h.callbackNode,x===0||h===g&&(Yr===2||Yr===9)||h.cancelPendingCommit!==null)return C!==null&&C!==null&&we(C),h.callbackNode=null,h.callbackPriority=0;if((x&3)===0||De(h,x)){if(g=x&-x,g===h.callbackPriority)return g;switch(C!==null&&we(C),Oe(x)){case 2:case 8:x=mt;break;case 32:x=ot;break;case 268435456:x=rt;break;default:x=ot}return C=PU.bind(null,h),x=ke(x,C),h.callbackPriority=g,h.callbackNode=x,g}return C!==null&&C!==null&&we(C),h.callbackPriority=2,h.callbackNode=null,2}function PU(h,g){if(xa!==0&&xa!==5)return h.callbackNode=null,h.callbackPriority=0,null;var x=h.callbackNode;if(jw()&&h.callbackNode!==x)return null;var C=xr;return C=he(h,h===fn?C:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),C===0?null:(bU(h,C,g),RU(h,Ae()),h.callbackNode!=null&&h.callbackNode===x?PU.bind(null,h):null)}function zU(h,g){if(jw())return null;bU(h,g,!0)}function Qxe(){l1e(function(){($r&6)!==0?ke(Ye,Yxe):IU()})}function FM(){if($u===0){var h=Em;h===0&&(h=mr,mr<<=1,(mr&261888)===0&&(mr=256)),$u=h}return $u}function BU(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:ku(""+h)}function $U(h,g){var x=g.ownerDocument.createElement("input");return x.name=g.name,x.value=g.value,h.id&&x.setAttribute("form",h.id),g.parentNode.insertBefore(x,g),h=new FormData(h),x.parentNode.removeChild(x),h}function Jxe(h,g,x,C,D){if(g==="submit"&&x&&x.stateNode===D){var P=BU((D[xe]||null).action),Q=C.submitter;Q&&(g=(g=Q[xe]||null)?BU(g.formAction):Q.getAttribute("formAction"),g!==null&&(P=g,Q=null));var ae=new F1("action","action",null,C,D);h.push({event:ae,listeners:[{instance:null,listener:function(){if(C.defaultPrevented){if($u!==0){var ye=Q?$U(D,Q):new FormData(D);oM(x,{pending:!0,data:ye,method:D.method,action:P},null,ye)}}else typeof P=="function"&&(ae.preventDefault(),ye=Q?$U(D,Q):new FormData(D),oM(x,{pending:!0,data:ye,method:D.method,action:P},P,ye))},currentTarget:D}]})}}for(var UM=0;UM<_E.length;UM++){var HM=_E[UM],Zxe=HM.toLowerCase(),Xxe=HM[0].toUpperCase()+HM.slice(1);To(Zxe,"on"+Xxe)}To(v8,"onAnimationEnd"),To(b8,"onAnimationIteration"),To(y8,"onAnimationStart"),To("dblclick","onDoubleClick"),To("focusin","onFocus"),To("focusout","onBlur"),To(pxe,"onTransitionRun"),To(gxe,"onTransitionStart"),To(vxe,"onTransitionCancel"),To(x8,"onTransitionEnd"),Qe("onMouseEnter",["mouseout","mouseover"]),Qe("onMouseLeave",["mouseout","mouseover"]),Qe("onPointerEnter",["pointerout","pointerover"]),Qe("onPointerLeave",["pointerout","pointerover"]),Mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ov="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e1e=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ov));function FU(h,g){g=(g&4)!==0;for(var x=0;x<h.length;x++){var C=h[x],D=C.event;C=C.listeners;e:{var P=void 0;if(g)for(var Q=C.length-1;0<=Q;Q--){var ae=C[Q],ye=ae.instance,Ee=ae.currentTarget;if(ae=ae.listener,ye!==P&&D.isPropagationStopped())break e;P=ae,D.currentTarget=Ee;try{P(D)}catch(Pe){q1(Pe)}D.currentTarget=null,P=ye}else for(Q=0;Q<C.length;Q++){if(ae=C[Q],ye=ae.instance,Ee=ae.currentTarget,ae=ae.listener,ye!==P&&D.isPropagationStopped())break e;P=ae,D.currentTarget=Ee;try{P(D)}catch(Pe){q1(Pe)}D.currentTarget=null,P=ye}}}}function gr(h,g){var x=g[dt];x===void 0&&(x=g[dt]=new Set);var C=h+"__bubble";x.has(C)||(UU(g,h,2,!1),x.add(C))}function qM(h,g,x){var C=0;g&&(C|=4),UU(x,h,C,g)}var Tw="_reactListening"+Math.random().toString(36).slice(2);function WM(h){if(!h[Tw]){h[Tw]=!0,gm.forEach(function(x){x!=="selectionchange"&&(e1e.has(x)||qM(x,!1,h),qM(x,!0,h))});var g=h.nodeType===9?h:h.ownerDocument;g===null||g[Tw]||(g[Tw]=!0,qM("selectionchange",!1,g))}}function UU(h,g,x,C){switch(vH(g)){case 2:var D=E1e;break;case 8:D=M1e;break;default:D=sT}x=D.bind(null,g,x,h),D=void 0,!dE||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(D=!0),C?D!==void 0?h.addEventListener(g,x,{capture:!0,passive:D}):h.addEventListener(g,x,!0):D!==void 0?h.addEventListener(g,x,{passive:D}):h.addEventListener(g,x,!1)}function KM(h,g,x,C,D){var P=C;if((g&1)===0&&(g&2)===0&&C!==null)e:for(;;){if(C===null)return;var Q=C.tag;if(Q===3||Q===4){var ae=C.stateNode.containerInfo;if(ae===D)break;if(Q===4)for(Q=C.return;Q!==null;){var ye=Q.tag;if((ye===3||ye===4)&&Q.stateNode.containerInfo===D)return;Q=Q.return}for(;ae!==null;){if(Q=ct(ae),Q===null)return;if(ye=Q.tag,ye===5||ye===6||ye===26||ye===27){C=P=Q;continue e}ae=ae.parentNode}}C=C.return}P1(function(){var Ee=P,Pe=nr(x),He=[];e:{var Te=w8.get(h);if(Te!==void 0){var Ie=F1,yt=h;switch(h){case"keypress":if(B1(x)===0)break e;case"keydown":case"keyup":Ie=Gye;break;case"focusin":yt="focus",Ie=pE;break;case"focusout":yt="blur",Ie=pE;break;case"beforeblur":case"afterblur":Ie=pE;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=Q$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=Iye;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=Qye;break;case v8:case b8:case y8:Ie=zye;break;case x8:Ie=Zye;break;case"scroll":case"scrollend":Ie=Lye;break;case"wheel":Ie=exe;break;case"copy":case"cut":case"paste":Ie=$ye;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=Z$;break;case"toggle":case"beforetoggle":Ie=rxe}var qt=(g&4)!==0,on=!qt&&(h==="scroll"||h==="scrollend"),Ne=qt?Te!==null?Te+"Capture":null:Te;qt=[];for(var Se=Ee,je;Se!==null;){var Fe=Se;if(je=Fe.stateNode,Fe=Fe.tag,Fe!==5&&Fe!==26&&Fe!==27||je===null||Ne===null||(Fe=M0(Se,Ne),Fe!=null&&qt.push(lv(Se,Fe,je))),on)break;Se=Se.return}0<qt.length&&(Te=new Ie(Te,yt,null,x,Pe),He.push({event:Te,listeners:qt}))}}if((g&7)===0){e:{if(Te=h==="mouseover"||h==="pointerover",Ie=h==="mouseout"||h==="pointerout",Te&&x!==_t&&(yt=x.relatedTarget||x.fromElement)&&(ct(yt)||yt[Ce]))break e;if((Ie||Te)&&(Te=Pe.window===Pe?Pe:(Te=Pe.ownerDocument)?Te.defaultView||Te.parentWindow:window,Ie?(yt=x.relatedTarget||x.toElement,Ie=Ee,yt=yt?ct(yt):null,yt!==null&&(on=i(yt),qt=yt.tag,yt!==on||qt!==5&&qt!==27&&qt!==6)&&(yt=null)):(Ie=null,yt=Ee),Ie!==yt)){if(qt=Q$,Fe="onMouseLeave",Ne="onMouseEnter",Se="mouse",(h==="pointerout"||h==="pointerover")&&(qt=Z$,Fe="onPointerLeave",Ne="onPointerEnter",Se="pointer"),on=Ie==null?Te:rr(Ie),je=yt==null?Te:rr(yt),Te=new qt(Fe,Se+"leave",Ie,x,Pe),Te.target=on,Te.relatedTarget=je,Fe=null,ct(Pe)===Ee&&(qt=new qt(Ne,Se+"enter",yt,x,Pe),qt.target=je,qt.relatedTarget=on,Fe=qt),on=Fe,Ie&&yt)t:{for(qt=t1e,Ne=Ie,Se=yt,je=0,Fe=Ne;Fe;Fe=qt(Fe))je++;Fe=0;for(var zt=Se;zt;zt=qt(zt))Fe++;for(;0<je-Fe;)Ne=qt(Ne),je--;for(;0<Fe-je;)Se=qt(Se),Fe--;for(;je--;){if(Ne===Se||Se!==null&&Ne===Se.alternate){qt=Ne;break t}Ne=qt(Ne),Se=qt(Se)}qt=null}else qt=null;Ie!==null&&HU(He,Te,Ie,qt,!1),yt!==null&&on!==null&&HU(He,on,yt,qt,!0)}}e:{if(Te=Ee?rr(Ee):window,Ie=Te.nodeName&&Te.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&Te.type==="file")var Lr=s8;else if(a8(Te))if(o8)Lr=fxe;else{Lr=uxe;var Nt=cxe}else Ie=Te.nodeName,!Ie||Ie.toLowerCase()!=="input"||Te.type!=="checkbox"&&Te.type!=="radio"?Ee&&Su(Ee.elementType)&&(Lr=s8):Lr=dxe;if(Lr&&(Lr=Lr(h,Ee))){i8(He,Lr,x,Pe);break e}Nt&&Nt(h,Te,Ee),h==="focusout"&&Ee&&Te.type==="number"&&Ee.memoizedProps.value!=null&&wu(Te,"number",Te.value)}switch(Nt=Ee?rr(Ee):window,h){case"focusin":(a8(Nt)||Nt.contentEditable==="true")&&(xm=Nt,wE=Ee,P0=null);break;case"focusout":P0=wE=xm=null;break;case"mousedown":SE=!0;break;case"contextmenu":case"mouseup":case"dragend":SE=!1,p8(He,x,Pe);break;case"selectionchange":if(mxe)break;case"keydown":case"keyup":p8(He,x,Pe)}var or;if(vE)e:{switch(h){case"compositionstart":var wr="onCompositionStart";break e;case"compositionend":wr="onCompositionEnd";break e;case"compositionupdate":wr="onCompositionUpdate";break e}wr=void 0}else ym?r8(h,x)&&(wr="onCompositionEnd"):h==="keydown"&&x.keyCode===229&&(wr="onCompositionStart");wr&&(X$&&x.locale!=="ko"&&(ym||wr!=="onCompositionStart"?wr==="onCompositionEnd"&&ym&&(or=V$()):(_u=Pe,fE="value"in _u?_u.value:_u.textContent,ym=!0)),Nt=Aw(Ee,wr),0<Nt.length&&(wr=new J$(wr,h,null,x,Pe),He.push({event:wr,listeners:Nt}),or?wr.data=or:(or=n8(x),or!==null&&(wr.data=or)))),(or=axe?ixe(h,x):sxe(h,x))&&(wr=Aw(Ee,"onBeforeInput"),0<wr.length&&(Nt=new J$("onBeforeInput","beforeinput",null,x,Pe),He.push({event:Nt,listeners:wr}),Nt.data=or)),Jxe(He,h,Ee,x,Pe)}FU(He,g)})}function lv(h,g,x){return{instance:h,listener:g,currentTarget:x}}function Aw(h,g){for(var x=g+"Capture",C=[];h!==null;){var D=h,P=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||P===null||(D=M0(h,x),D!=null&&C.unshift(lv(h,D,P)),D=M0(h,g),D!=null&&C.push(lv(h,D,P))),h.tag===3)return C;h=h.return}return[]}function t1e(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function HU(h,g,x,C,D){for(var P=g._reactName,Q=[];x!==null&&x!==C;){var ae=x,ye=ae.alternate,Ee=ae.stateNode;if(ae=ae.tag,ye!==null&&ye===C)break;ae!==5&&ae!==26&&ae!==27||Ee===null||(ye=Ee,D?(Ee=M0(x,P),Ee!=null&&Q.unshift(lv(x,Ee,ye))):D||(Ee=M0(x,P),Ee!=null&&Q.push(lv(x,Ee,ye)))),x=x.return}Q.length!==0&&h.push({event:g,listeners:Q})}var r1e=/\r\n?/g,n1e=/\u0000|\uFFFD/g;function qU(h){return(typeof h=="string"?h:""+h).replace(r1e,`
`).replace(n1e,"")}function WU(h,g){return g=qU(g),qU(h)===g}function sn(h,g,x,C,D,P){switch(x){case"children":typeof C=="string"?g==="body"||g==="textarea"&&C===""||Kt(h,C):(typeof C=="number"||typeof C=="bigint")&&g!=="body"&&Kt(h,""+C);break;case"className":ki(h,"class",C);break;case"tabIndex":ki(h,"tabindex",C);break;case"dir":case"role":case"viewBox":case"width":case"height":ki(h,x,C);break;case"style":Vr(h,C,P);break;case"data":if(g!=="object"){ki(h,"data",C);break}case"src":case"href":if(C===""&&(g!=="a"||x!=="href")){h.removeAttribute(x);break}if(C==null||typeof C=="function"||typeof C=="symbol"||typeof C=="boolean"){h.removeAttribute(x);break}C=ku(""+C),h.setAttribute(x,C);break;case"action":case"formAction":if(typeof C=="function"){h.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(x==="formAction"?(g!=="input"&&sn(h,g,"name",D.name,D,null),sn(h,g,"formEncType",D.formEncType,D,null),sn(h,g,"formMethod",D.formMethod,D,null),sn(h,g,"formTarget",D.formTarget,D,null)):(sn(h,g,"encType",D.encType,D,null),sn(h,g,"method",D.method,D,null),sn(h,g,"target",D.target,D,null)));if(C==null||typeof C=="symbol"||typeof C=="boolean"){h.removeAttribute(x);break}C=ku(""+C),h.setAttribute(x,C);break;case"onClick":C!=null&&(h.onclick=at);break;case"onScroll":C!=null&&gr("scroll",h);break;case"onScrollEnd":C!=null&&gr("scrollend",h);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(n(61));if(x=C.__html,x!=null){if(D.children!=null)throw Error(n(60));h.innerHTML=x}}break;case"multiple":h.multiple=C&&typeof C!="function"&&typeof C!="symbol";break;case"muted":h.muted=C&&typeof C!="function"&&typeof C!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(C==null||typeof C=="function"||typeof C=="boolean"||typeof C=="symbol"){h.removeAttribute("xlink:href");break}x=ku(""+C),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":C!=null&&typeof C!="function"&&typeof C!="symbol"?h.setAttribute(x,""+C):h.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":C&&typeof C!="function"&&typeof C!="symbol"?h.setAttribute(x,""):h.removeAttribute(x);break;case"capture":case"download":C===!0?h.setAttribute(x,""):C!==!1&&C!=null&&typeof C!="function"&&typeof C!="symbol"?h.setAttribute(x,C):h.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":C!=null&&typeof C!="function"&&typeof C!="symbol"&&!isNaN(C)&&1<=C?h.setAttribute(x,C):h.removeAttribute(x);break;case"rowSpan":case"start":C==null||typeof C=="function"||typeof C=="symbol"||isNaN(C)?h.removeAttribute(x):h.setAttribute(x,C);break;case"popover":gr("beforetoggle",h),gr("toggle",h),Aa(h,"popover",C);break;case"xlinkActuate":di(h,"http://www.w3.org/1999/xlink","xlink:actuate",C);break;case"xlinkArcrole":di(h,"http://www.w3.org/1999/xlink","xlink:arcrole",C);break;case"xlinkRole":di(h,"http://www.w3.org/1999/xlink","xlink:role",C);break;case"xlinkShow":di(h,"http://www.w3.org/1999/xlink","xlink:show",C);break;case"xlinkTitle":di(h,"http://www.w3.org/1999/xlink","xlink:title",C);break;case"xlinkType":di(h,"http://www.w3.org/1999/xlink","xlink:type",C);break;case"xmlBase":di(h,"http://www.w3.org/XML/1998/namespace","xml:base",C);break;case"xmlLang":di(h,"http://www.w3.org/XML/1998/namespace","xml:lang",C);break;case"xmlSpace":di(h,"http://www.w3.org/XML/1998/namespace","xml:space",C);break;case"is":Aa(h,"is",C);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=Jl.get(x)||x,Aa(h,x,C))}}function GM(h,g,x,C,D,P){switch(x){case"style":Vr(h,C,P);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(n(61));if(x=C.__html,x!=null){if(D.children!=null)throw Error(n(60));h.innerHTML=x}}break;case"children":typeof C=="string"?Kt(h,C):(typeof C=="number"||typeof C=="bigint")&&Kt(h,""+C);break;case"onScroll":C!=null&&gr("scroll",h);break;case"onScrollEnd":C!=null&&gr("scrollend",h);break;case"onClick":C!=null&&(h.onclick=at);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kl.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(D=x.endsWith("Capture"),g=x.slice(2,D?x.length-7:void 0),P=h[xe]||null,P=P!=null?P[x]:null,typeof P=="function"&&h.removeEventListener(g,P,D),typeof C=="function")){typeof P!="function"&&P!==null&&(x in h?h[x]=null:h.hasAttribute(x)&&h.removeAttribute(x)),h.addEventListener(g,C,D);break e}x in h?h[x]=C:C===!0?h.setAttribute(x,""):Aa(h,x,C)}}}function Qa(h,g,x){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gr("error",h),gr("load",h);var C=!1,D=!1,P;for(P in x)if(x.hasOwnProperty(P)){var Q=x[P];if(Q!=null)switch(P){case"src":C=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,g));default:sn(h,g,P,Q,x,null)}}D&&sn(h,g,"srcSet",x.srcSet,x,null),C&&sn(h,g,"src",x.src,x,null);return;case"input":gr("invalid",h);var ae=P=Q=D=null,ye=null,Ee=null;for(C in x)if(x.hasOwnProperty(C)){var Pe=x[C];if(Pe!=null)switch(C){case"name":D=Pe;break;case"type":Q=Pe;break;case"checked":ye=Pe;break;case"defaultChecked":Ee=Pe;break;case"value":P=Pe;break;case"defaultValue":ae=Pe;break;case"children":case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(n(137,g));break;default:sn(h,g,C,Pe,x,null)}}Ql(h,P,ae,ye,Ee,Q,D,!1);return;case"select":gr("invalid",h),C=Q=P=null;for(D in x)if(x.hasOwnProperty(D)&&(ae=x[D],ae!=null))switch(D){case"value":P=ae;break;case"defaultValue":Q=ae;break;case"multiple":C=ae;default:sn(h,g,D,ae,x,null)}g=P,x=Q,h.multiple=!!C,g!=null?aa(h,!!C,g,!1):x!=null&&aa(h,!!C,x,!0);return;case"textarea":gr("invalid",h),P=D=C=null;for(Q in x)if(x.hasOwnProperty(Q)&&(ae=x[Q],ae!=null))switch(Q){case"value":C=ae;break;case"defaultValue":D=ae;break;case"children":P=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(91));break;default:sn(h,g,Q,ae,x,null)}bm(h,C,D,P);return;case"option":for(ye in x)if(x.hasOwnProperty(ye)&&(C=x[ye],C!=null))switch(ye){case"selected":h.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:sn(h,g,ye,C,x,null)}return;case"dialog":gr("beforetoggle",h),gr("toggle",h),gr("cancel",h),gr("close",h);break;case"iframe":case"object":gr("load",h);break;case"video":case"audio":for(C=0;C<ov.length;C++)gr(ov[C],h);break;case"image":gr("error",h),gr("load",h);break;case"details":gr("toggle",h);break;case"embed":case"source":case"link":gr("error",h),gr("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in x)if(x.hasOwnProperty(Ee)&&(C=x[Ee],C!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,g));default:sn(h,g,Ee,C,x,null)}return;default:if(Su(g)){for(Pe in x)x.hasOwnProperty(Pe)&&(C=x[Pe],C!==void 0&&GM(h,g,Pe,C,x,void 0));return}}for(ae in x)x.hasOwnProperty(ae)&&(C=x[ae],C!=null&&sn(h,g,ae,C,x,null))}function a1e(h,g,x,C){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,P=null,Q=null,ae=null,ye=null,Ee=null,Pe=null;for(Ie in x){var He=x[Ie];if(x.hasOwnProperty(Ie)&&He!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":ye=He;default:C.hasOwnProperty(Ie)||sn(h,g,Ie,null,C,He)}}for(var Te in C){var Ie=C[Te];if(He=x[Te],C.hasOwnProperty(Te)&&(Ie!=null||He!=null))switch(Te){case"type":P=Ie;break;case"name":D=Ie;break;case"checked":Ee=Ie;break;case"defaultChecked":Pe=Ie;break;case"value":Q=Ie;break;case"defaultValue":ae=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,g));break;default:Ie!==He&&sn(h,g,Te,Ie,C,He)}}Yl(h,Q,ae,ye,Ee,Pe,P,D);return;case"select":Ie=Q=ae=Te=null;for(P in x)if(ye=x[P],x.hasOwnProperty(P)&&ye!=null)switch(P){case"value":break;case"multiple":Ie=ye;default:C.hasOwnProperty(P)||sn(h,g,P,null,C,ye)}for(D in C)if(P=C[D],ye=x[D],C.hasOwnProperty(D)&&(P!=null||ye!=null))switch(D){case"value":Te=P;break;case"defaultValue":ae=P;break;case"multiple":Q=P;default:P!==ye&&sn(h,g,D,P,C,ye)}g=ae,x=Q,C=Ie,Te!=null?aa(h,!!x,Te,!1):!!C!=!!x&&(g!=null?aa(h,!!x,g,!0):aa(h,!!x,x?[]:"",!1));return;case"textarea":Ie=Te=null;for(ae in x)if(D=x[ae],x.hasOwnProperty(ae)&&D!=null&&!C.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:sn(h,g,ae,null,C,D)}for(Q in C)if(D=C[Q],P=x[Q],C.hasOwnProperty(Q)&&(D!=null||P!=null))switch(Q){case"value":Te=D;break;case"defaultValue":Ie=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:D!==P&&sn(h,g,Q,D,C,P)}I1(h,Te,Ie);return;case"option":for(var yt in x)if(Te=x[yt],x.hasOwnProperty(yt)&&Te!=null&&!C.hasOwnProperty(yt))switch(yt){case"selected":h.selected=!1;break;default:sn(h,g,yt,null,C,Te)}for(ye in C)if(Te=C[ye],Ie=x[ye],C.hasOwnProperty(ye)&&Te!==Ie&&(Te!=null||Ie!=null))switch(ye){case"selected":h.selected=Te&&typeof Te!="function"&&typeof Te!="symbol";break;default:sn(h,g,ye,Te,C,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qt in x)Te=x[qt],x.hasOwnProperty(qt)&&Te!=null&&!C.hasOwnProperty(qt)&&sn(h,g,qt,null,C,Te);for(Ee in C)if(Te=C[Ee],Ie=x[Ee],C.hasOwnProperty(Ee)&&Te!==Ie&&(Te!=null||Ie!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,g));break;default:sn(h,g,Ee,Te,C,Ie)}return;default:if(Su(g)){for(var on in x)Te=x[on],x.hasOwnProperty(on)&&Te!==void 0&&!C.hasOwnProperty(on)&&GM(h,g,on,void 0,C,Te);for(Pe in C)Te=C[Pe],Ie=x[Pe],!C.hasOwnProperty(Pe)||Te===Ie||Te===void 0&&Ie===void 0||GM(h,g,Pe,Te,C,Ie);return}}for(var Ne in x)Te=x[Ne],x.hasOwnProperty(Ne)&&Te!=null&&!C.hasOwnProperty(Ne)&&sn(h,g,Ne,null,C,Te);for(He in C)Te=C[He],Ie=x[He],!C.hasOwnProperty(He)||Te===Ie||Te==null&&Ie==null||sn(h,g,He,Te,C,Ie)}function KU(h){switch(h){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function i1e(){if(typeof performance.getEntriesByType=="function"){for(var h=0,g=0,x=performance.getEntriesByType("resource"),C=0;C<x.length;C++){var D=x[C],P=D.transferSize,Q=D.initiatorType,ae=D.duration;if(P&&ae&&KU(Q)){for(Q=0,ae=D.responseEnd,C+=1;C<x.length;C++){var ye=x[C],Ee=ye.startTime;if(Ee>ae)break;var Pe=ye.transferSize,He=ye.initiatorType;Pe&&KU(He)&&(ye=ye.responseEnd,Q+=Pe*(ye<ae?1:(ae-Ee)/(ye-Ee)))}if(--C,g+=8*(P+Q)/(D.duration/1e3),h++,10<h)break}}if(0<h)return g/h/1e6}return navigator.connection&&(h=navigator.connection.downlink,typeof h=="number")?h:5}var VM=null,YM=null;function Dw(h){return h.nodeType===9?h:h.ownerDocument}function GU(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function VU(h,g){if(h===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&g==="foreignObject"?0:h}function QM(h,g){return h==="textarea"||h==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var JM=null;function s1e(){var h=window.event;return h&&h.type==="popstate"?h===JM?!1:(JM=h,!0):(JM=null,!1)}var YU=typeof setTimeout=="function"?setTimeout:void 0,o1e=typeof clearTimeout=="function"?clearTimeout:void 0,QU=typeof Promise=="function"?Promise:void 0,l1e=typeof queueMicrotask=="function"?queueMicrotask:typeof QU<"u"?function(h){return QU.resolve(null).then(h).catch(c1e)}:YU;function c1e(h){setTimeout(function(){throw h})}function Fu(h){return h==="head"}function JU(h,g){var x=g,C=0;do{var D=x.nextSibling;if(h.removeChild(x),D&&D.nodeType===8)if(x=D.data,x==="/$"||x==="/&"){if(C===0){h.removeChild(D),Gm(g);return}C--}else if(x==="$"||x==="$?"||x==="$~"||x==="$!"||x==="&")C++;else if(x==="html")cv(h.ownerDocument.documentElement);else if(x==="head"){x=h.ownerDocument.head,cv(x);for(var P=x.firstChild;P;){var Q=P.nextSibling,ae=P.nodeName;P[lt]||ae==="SCRIPT"||ae==="STYLE"||ae==="LINK"&&P.rel.toLowerCase()==="stylesheet"||x.removeChild(P),P=Q}}else x==="body"&&cv(h.ownerDocument.body);x=D}while(x);Gm(g)}function ZU(h,g){var x=h;h=0;do{var C=x.nextSibling;if(x.nodeType===1?g?(x._stashedDisplay=x.style.display,x.style.display="none"):(x.style.display=x._stashedDisplay||"",x.getAttribute("style")===""&&x.removeAttribute("style")):x.nodeType===3&&(g?(x._stashedText=x.nodeValue,x.nodeValue=""):x.nodeValue=x._stashedText||""),C&&C.nodeType===8)if(x=C.data,x==="/$"){if(h===0)break;h--}else x!=="$"&&x!=="$?"&&x!=="$~"&&x!=="$!"||h++;x=C}while(x)}function ZM(h){var g=h.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var x=g;switch(g=g.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":ZM(x),Pt(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}h.removeChild(x)}}function u1e(h,g,x,C){for(;h.nodeType===1;){var D=x;if(h.nodeName.toLowerCase()!==g.toLowerCase()){if(!C&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(C){if(!h[lt])switch(g){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(P=h.getAttribute("rel"),P==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(P!==D.rel||h.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||h.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||h.getAttribute("title")!==(D.title==null?null:D.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(P=h.getAttribute("src"),(P!==(D.src==null?null:D.src)||h.getAttribute("type")!==(D.type==null?null:D.type)||h.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&P&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(g==="input"&&h.type==="hidden"){var P=D.name==null?null:""+D.name;if(D.type==="hidden"&&h.getAttribute("name")===P)return h}else return h;if(h=Js(h.nextSibling),h===null)break}return null}function d1e(h,g,x){if(g==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!x||(h=Js(h.nextSibling),h===null))return null;return h}function XU(h,g){for(;h.nodeType!==8;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!g||(h=Js(h.nextSibling),h===null))return null;return h}function XM(h){return h.data==="$?"||h.data==="$~"}function eT(h){return h.data==="$!"||h.data==="$?"&&h.ownerDocument.readyState!=="loading"}function f1e(h,g){var x=h.ownerDocument;if(h.data==="$~")h._reactRetry=g;else if(h.data!=="$?"||x.readyState!=="loading")g();else{var C=function(){g(),x.removeEventListener("DOMContentLoaded",C)};x.addEventListener("DOMContentLoaded",C),h._reactRetry=C}}function Js(h){for(;h!=null;h=h.nextSibling){var g=h.nodeType;if(g===1||g===3)break;if(g===8){if(g=h.data,g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"||g==="F!"||g==="F")break;if(g==="/$"||g==="/&")return null}}return h}var tT=null;function eH(h){h=h.nextSibling;for(var g=0;h;){if(h.nodeType===8){var x=h.data;if(x==="/$"||x==="/&"){if(g===0)return Js(h.nextSibling);g--}else x!=="$"&&x!=="$!"&&x!=="$?"&&x!=="$~"&&x!=="&"||g++}h=h.nextSibling}return null}function tH(h){h=h.previousSibling;for(var g=0;h;){if(h.nodeType===8){var x=h.data;if(x==="$"||x==="$!"||x==="$?"||x==="$~"||x==="&"){if(g===0)return h;g--}else x!=="/$"&&x!=="/&"||g++}h=h.previousSibling}return null}function rH(h,g,x){switch(g=Dw(x),h){case"html":if(h=g.documentElement,!h)throw Error(n(452));return h;case"head":if(h=g.head,!h)throw Error(n(453));return h;case"body":if(h=g.body,!h)throw Error(n(454));return h;default:throw Error(n(451))}}function cv(h){for(var g=h.attributes;g.length;)h.removeAttributeNode(g[0]);Pt(h)}var Zs=new Map,nH=new Set;function Lw(h){return typeof h.getRootNode=="function"?h.getRootNode():h.nodeType===9?h:h.ownerDocument}var hc=B.d;B.d={f:h1e,r:m1e,D:p1e,C:g1e,L:v1e,m:b1e,X:x1e,S:y1e,M:w1e};function h1e(){var h=hc.f(),g=_w();return h||g}function m1e(h){var g=Ht(h);g!==null&&g.tag===5&&g.type==="form"?xF(g):hc.r(h)}var qm=typeof document>"u"?null:document;function aH(h,g,x){var C=qm;if(C&&typeof g=="string"&&g){var D=fi(g);D='link[rel="'+h+'"][href="'+D+'"]',typeof x=="string"&&(D+='[crossorigin="'+x+'"]'),nH.has(D)||(nH.add(D),h={rel:h,crossOrigin:x,href:g},C.querySelector(D)===null&&(g=C.createElement("link"),Qa(g,"link",h),vn(g),C.head.appendChild(g)))}}function p1e(h){hc.D(h),aH("dns-prefetch",h,null)}function g1e(h,g){hc.C(h,g),aH("preconnect",h,g)}function v1e(h,g,x){hc.L(h,g,x);var C=qm;if(C&&h&&g){var D='link[rel="preload"][as="'+fi(g)+'"]';g==="image"&&x&&x.imageSrcSet?(D+='[imagesrcset="'+fi(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(D+='[imagesizes="'+fi(x.imageSizes)+'"]')):D+='[href="'+fi(h)+'"]';var P=D;switch(g){case"style":P=Wm(h);break;case"script":P=Km(h)}Zs.has(P)||(h=f({rel:"preload",href:g==="image"&&x&&x.imageSrcSet?void 0:h,as:g},x),Zs.set(P,h),C.querySelector(D)!==null||g==="style"&&C.querySelector(uv(P))||g==="script"&&C.querySelector(dv(P))||(g=C.createElement("link"),Qa(g,"link",h),vn(g),C.head.appendChild(g)))}}function b1e(h,g){hc.m(h,g);var x=qm;if(x&&h){var C=g&&typeof g.as=="string"?g.as:"script",D='link[rel="modulepreload"][as="'+fi(C)+'"][href="'+fi(h)+'"]',P=D;switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Km(h)}if(!Zs.has(P)&&(h=f({rel:"modulepreload",href:h},g),Zs.set(P,h),x.querySelector(D)===null)){switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(dv(P)))return}C=x.createElement("link"),Qa(C,"link",h),vn(C),x.head.appendChild(C)}}}function y1e(h,g,x){hc.S(h,g,x);var C=qm;if(C&&h){var D=Dr(C).hoistableStyles,P=Wm(h);g=g||"default";var Q=D.get(P);if(!Q){var ae={loading:0,preload:null};if(Q=C.querySelector(uv(P)))ae.loading=5;else{h=f({rel:"stylesheet",href:h,"data-precedence":g},x),(x=Zs.get(P))&&rT(h,x);var ye=Q=C.createElement("link");vn(ye),Qa(ye,"link",h),ye._p=new Promise(function(Ee,Pe){ye.onload=Ee,ye.onerror=Pe}),ye.addEventListener("load",function(){ae.loading|=1}),ye.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,Ow(Q,g,C)}Q={type:"stylesheet",instance:Q,count:1,state:ae},D.set(P,Q)}}}function x1e(h,g){hc.X(h,g);var x=qm;if(x&&h){var C=Dr(x).hoistableScripts,D=Km(h),P=C.get(D);P||(P=x.querySelector(dv(D)),P||(h=f({src:h,async:!0},g),(g=Zs.get(D))&&nT(h,g),P=x.createElement("script"),vn(P),Qa(P,"link",h),x.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},C.set(D,P))}}function w1e(h,g){hc.M(h,g);var x=qm;if(x&&h){var C=Dr(x).hoistableScripts,D=Km(h),P=C.get(D);P||(P=x.querySelector(dv(D)),P||(h=f({src:h,async:!0,type:"module"},g),(g=Zs.get(D))&&nT(h,g),P=x.createElement("script"),vn(P),Qa(P,"link",h),x.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},C.set(D,P))}}function iH(h,g,x,C){var D=(D=ie.current)?Lw(D):null;if(!D)throw Error(n(446));switch(h){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(g=Wm(x.href),x=Dr(D).hoistableStyles,C=x.get(g),C||(C={type:"style",instance:null,count:0,state:null},x.set(g,C)),C):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){h=Wm(x.href);var P=Dr(D).hoistableStyles,Q=P.get(h);if(Q||(D=D.ownerDocument||D,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(h,Q),(P=D.querySelector(uv(h)))&&!P._p&&(Q.instance=P,Q.state.loading=5),Zs.has(h)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},Zs.set(h,x),P||S1e(D,h,x,Q.state))),g&&C===null)throw Error(n(528,""));return Q}if(g&&C!==null)throw Error(n(529,""));return null;case"script":return g=x.async,x=x.src,typeof x=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Km(x),x=Dr(D).hoistableScripts,C=x.get(g),C||(C={type:"script",instance:null,count:0,state:null},x.set(g,C)),C):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,h))}}function Wm(h){return'href="'+fi(h)+'"'}function uv(h){return'link[rel="stylesheet"]['+h+"]"}function sH(h){return f({},h,{"data-precedence":h.precedence,precedence:null})}function S1e(h,g,x,C){h.querySelector('link[rel="preload"][as="style"]['+g+"]")?C.loading=1:(g=h.createElement("link"),C.preload=g,g.addEventListener("load",function(){return C.loading|=1}),g.addEventListener("error",function(){return C.loading|=2}),Qa(g,"link",x),vn(g),h.head.appendChild(g))}function Km(h){return'[src="'+fi(h)+'"]'}function dv(h){return"script[async]"+h}function oH(h,g,x){if(g.count++,g.instance===null)switch(g.type){case"style":var C=h.querySelector('style[data-href~="'+fi(x.href)+'"]');if(C)return g.instance=C,vn(C),C;var D=f({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return C=(h.ownerDocument||h).createElement("style"),vn(C),Qa(C,"style",D),Ow(C,x.precedence,h),g.instance=C;case"stylesheet":D=Wm(x.href);var P=h.querySelector(uv(D));if(P)return g.state.loading|=4,g.instance=P,vn(P),P;C=sH(x),(D=Zs.get(D))&&rT(C,D),P=(h.ownerDocument||h).createElement("link"),vn(P);var Q=P;return Q._p=new Promise(function(ae,ye){Q.onload=ae,Q.onerror=ye}),Qa(P,"link",C),g.state.loading|=4,Ow(P,x.precedence,h),g.instance=P;case"script":return P=Km(x.src),(D=h.querySelector(dv(P)))?(g.instance=D,vn(D),D):(C=x,(D=Zs.get(P))&&(C=f({},x),nT(C,D)),h=h.ownerDocument||h,D=h.createElement("script"),vn(D),Qa(D,"link",C),h.head.appendChild(D),g.instance=D);case"void":return null;default:throw Error(n(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(C=g.instance,g.state.loading|=4,Ow(C,x.precedence,h));return g.instance}function Ow(h,g,x){for(var C=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=C.length?C[C.length-1]:null,P=D,Q=0;Q<C.length;Q++){var ae=C[Q];if(ae.dataset.precedence===g)P=ae;else if(P!==D)break}P?P.parentNode.insertBefore(h,P.nextSibling):(g=x.nodeType===9?x.head:x,g.insertBefore(h,g.firstChild))}function rT(h,g){h.crossOrigin==null&&(h.crossOrigin=g.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=g.referrerPolicy),h.title==null&&(h.title=g.title)}function nT(h,g){h.crossOrigin==null&&(h.crossOrigin=g.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=g.referrerPolicy),h.integrity==null&&(h.integrity=g.integrity)}var Iw=null;function lH(h,g,x){if(Iw===null){var C=new Map,D=Iw=new Map;D.set(x,C)}else D=Iw,C=D.get(x),C||(C=new Map,D.set(x,C));if(C.has(h))return C;for(C.set(h,null),x=x.getElementsByTagName(h),D=0;D<x.length;D++){var P=x[D];if(!(P[lt]||P[se]||h==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=P.getAttribute(g)||"";Q=h+Q;var ae=C.get(Q);ae?ae.push(P):C.set(Q,[P])}}return C}function cH(h,g,x){h=h.ownerDocument||h,h.head.insertBefore(x,g==="title"?h.querySelector("head > title"):null)}function k1e(h,g,x){if(x===1||g.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return h=g.disabled,typeof g.precedence=="string"&&h==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function uH(h){return!(h.type==="stylesheet"&&(h.state.loading&3)===0)}function _1e(h,g,x,C){if(x.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(x.state.loading&4)===0){if(x.instance===null){var D=Wm(C.href),P=g.querySelector(uv(D));if(P){g=P._p,g!==null&&typeof g=="object"&&typeof g.then=="function"&&(h.count++,h=Rw.bind(h),g.then(h,h)),x.state.loading|=4,x.instance=P,vn(P);return}P=g.ownerDocument||g,C=sH(C),(D=Zs.get(D))&&rT(C,D),P=P.createElement("link"),vn(P);var Q=P;Q._p=new Promise(function(ae,ye){Q.onload=ae,Q.onerror=ye}),Qa(P,"link",C),x.instance=P}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(x,g),(g=x.state.preload)&&(x.state.loading&3)===0&&(h.count++,x=Rw.bind(h),g.addEventListener("load",x),g.addEventListener("error",x))}}var aT=0;function N1e(h,g){return h.stylesheets&&h.count===0&&zw(h,h.stylesheets),0<h.count||0<h.imgCount?function(x){var C=setTimeout(function(){if(h.stylesheets&&zw(h,h.stylesheets),h.unsuspend){var P=h.unsuspend;h.unsuspend=null,P()}},6e4+g);0<h.imgBytes&&aT===0&&(aT=62500*i1e());var D=setTimeout(function(){if(h.waitingForImages=!1,h.count===0&&(h.stylesheets&&zw(h,h.stylesheets),h.unsuspend)){var P=h.unsuspend;h.unsuspend=null,P()}},(h.imgBytes>aT?50:800)+g);return h.unsuspend=x,function(){h.unsuspend=null,clearTimeout(C),clearTimeout(D)}}:null}function Rw(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)zw(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var Pw=null;function zw(h,g){h.stylesheets=null,h.unsuspend!==null&&(h.count++,Pw=new Map,g.forEach(C1e,h),Pw=null,Rw.call(h))}function C1e(h,g){if(!(g.state.loading&4)){var x=Pw.get(h);if(x)var C=x.get(null);else{x=new Map,Pw.set(h,x);for(var D=h.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<D.length;P++){var Q=D[P];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(x.set(Q.dataset.precedence,Q),C=Q)}C&&x.set(null,C)}D=g.instance,Q=D.getAttribute("data-precedence"),P=x.get(Q)||C,P===C&&x.set(null,D),x.set(Q,D),this.count++,C=Rw.bind(this),D.addEventListener("load",C),D.addEventListener("error",C),P?P.parentNode.insertBefore(D,P.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(D,h.firstChild)),g.state.loading|=4}}var fv={$$typeof:N,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function j1e(h,g,x,C,D,P,Q,ae,ye){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=St(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.hiddenUpdates=St(null),this.identifierPrefix=C,this.onUncaughtError=D,this.onCaughtError=P,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ye,this.incompleteTransitions=new Map}function dH(h,g,x,C,D,P,Q,ae,ye,Ee,Pe,He){return h=new j1e(h,g,x,Q,ye,Ee,Pe,He,ae),g=1,P===!0&&(g|=24),P=us(3,null,null,g),h.current=P,P.stateNode=h,g=PE(),g.refCount++,h.pooledCache=g,g.refCount++,P.memoizedState={element:C,isDehydrated:x,cache:g},FE(P),h}function fH(h){return h?(h=km,h):km}function hH(h,g,x,C,D,P){D=fH(D),C.context===null?C.context=D:C.pendingContext=D,C=Tu(g),C.payload={element:x},P=P===void 0?null:P,P!==null&&(C.callback=P),x=Au(h,C,g),x!==null&&(Qi(x,h,g),q0(x,h,g))}function mH(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var x=h.retryLane;h.retryLane=x!==0&&x<g?x:g}}function iT(h,g){mH(h,g),(h=h.alternate)&&mH(h,g)}function pH(h){if(h.tag===13||h.tag===31){var g=Xd(h,67108864);g!==null&&Qi(g,h,67108864),iT(h,67108864)}}function gH(h){if(h.tag===13||h.tag===31){var g=ps();g=X(g);var x=Xd(h,g);x!==null&&Qi(x,h,g),iT(h,g)}}var Bw=!0;function E1e(h,g,x,C){var D=I.T;I.T=null;var P=B.p;try{B.p=2,sT(h,g,x,C)}finally{B.p=P,I.T=D}}function M1e(h,g,x,C){var D=I.T;I.T=null;var P=B.p;try{B.p=8,sT(h,g,x,C)}finally{B.p=P,I.T=D}}function sT(h,g,x,C){if(Bw){var D=oT(C);if(D===null)KM(h,g,C,$w,x),bH(h,C);else if(A1e(D,h,g,x,C))C.stopPropagation();else if(bH(h,C),g&4&&-1<T1e.indexOf(h)){for(;D!==null;){var P=Ht(D);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var Q=Rt(P.pendingLanes);if(Q!==0){var ae=P;for(ae.pendingLanes|=2,ae.entangledLanes|=2;Q;){var ye=1<<31-Ve(Q);ae.entanglements[1]|=ye,Q&=~ye}cl(P),($r&6)===0&&(Sw=Ae()+500,sv(0))}}break;case 31:case 13:ae=Xd(P,2),ae!==null&&Qi(ae,P,2),_w(),iT(P,2)}if(P=oT(C),P===null&&KM(h,g,C,$w,x),P===D)break;D=P}D!==null&&C.stopPropagation()}else KM(h,g,C,null,x)}}function oT(h){return h=nr(h),lT(h)}var $w=null;function lT(h){if($w=null,h=ct(h),h!==null){var g=i(h);if(g===null)h=null;else{var x=g.tag;if(x===13){if(h=s(g),h!==null)return h;h=null}else if(x===31){if(h=l(g),h!==null)return h;h=null}else if(x===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;h=null}else g!==h&&(h=null)}}return $w=h,null}function vH(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Re()){case Ye:return 2;case mt:return 8;case ot:case Ot:return 32;case rt:return 268435456;default:return 32}default:return 32}}var cT=!1,Uu=null,Hu=null,qu=null,hv=new Map,mv=new Map,Wu=[],T1e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bH(h,g){switch(h){case"focusin":case"focusout":Uu=null;break;case"dragenter":case"dragleave":Hu=null;break;case"mouseover":case"mouseout":qu=null;break;case"pointerover":case"pointerout":hv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":mv.delete(g.pointerId)}}function pv(h,g,x,C,D,P){return h===null||h.nativeEvent!==P?(h={blockedOn:g,domEventName:x,eventSystemFlags:C,nativeEvent:P,targetContainers:[D]},g!==null&&(g=Ht(g),g!==null&&pH(g)),h):(h.eventSystemFlags|=C,g=h.targetContainers,D!==null&&g.indexOf(D)===-1&&g.push(D),h)}function A1e(h,g,x,C,D){switch(g){case"focusin":return Uu=pv(Uu,h,g,x,C,D),!0;case"dragenter":return Hu=pv(Hu,h,g,x,C,D),!0;case"mouseover":return qu=pv(qu,h,g,x,C,D),!0;case"pointerover":var P=D.pointerId;return hv.set(P,pv(hv.get(P)||null,h,g,x,C,D)),!0;case"gotpointercapture":return P=D.pointerId,mv.set(P,pv(mv.get(P)||null,h,g,x,C,D)),!0}return!1}function yH(h){var g=ct(h.target);if(g!==null){var x=i(g);if(x!==null){if(g=x.tag,g===13){if(g=s(x),g!==null){h.blockedOn=g,be(h.priority,function(){gH(x)});return}}else if(g===31){if(g=l(x),g!==null){h.blockedOn=g,be(h.priority,function(){gH(x)});return}}else if(g===3&&x.stateNode.current.memoizedState.isDehydrated){h.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}h.blockedOn=null}function Fw(h){if(h.blockedOn!==null)return!1;for(var g=h.targetContainers;0<g.length;){var x=oT(h.nativeEvent);if(x===null){x=h.nativeEvent;var C=new x.constructor(x.type,x);_t=C,x.target.dispatchEvent(C),_t=null}else return g=Ht(x),g!==null&&pH(g),h.blockedOn=x,!1;g.shift()}return!0}function xH(h,g,x){Fw(h)&&x.delete(g)}function D1e(){cT=!1,Uu!==null&&Fw(Uu)&&(Uu=null),Hu!==null&&Fw(Hu)&&(Hu=null),qu!==null&&Fw(qu)&&(qu=null),hv.forEach(xH),mv.forEach(xH)}function Uw(h,g){h.blockedOn===g&&(h.blockedOn=null,cT||(cT=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,D1e)))}var Hw=null;function wH(h){Hw!==h&&(Hw=h,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Hw===h&&(Hw=null);for(var g=0;g<h.length;g+=3){var x=h[g],C=h[g+1],D=h[g+2];if(typeof C!="function"){if(lT(C||x)===null)continue;break}var P=Ht(x);P!==null&&(h.splice(g,3),g-=3,oM(P,{pending:!0,data:D,method:x.method,action:C},C,D))}}))}function Gm(h){function g(ye){return Uw(ye,h)}Uu!==null&&Uw(Uu,h),Hu!==null&&Uw(Hu,h),qu!==null&&Uw(qu,h),hv.forEach(g),mv.forEach(g);for(var x=0;x<Wu.length;x++){var C=Wu[x];C.blockedOn===h&&(C.blockedOn=null)}for(;0<Wu.length&&(x=Wu[0],x.blockedOn===null);)yH(x),x.blockedOn===null&&Wu.shift();if(x=(h.ownerDocument||h).$$reactFormReplay,x!=null)for(C=0;C<x.length;C+=3){var D=x[C],P=x[C+1],Q=D[xe]||null;if(typeof P=="function")Q||wH(x);else if(Q){var ae=null;if(P&&P.hasAttribute("formAction")){if(D=P,Q=P[xe]||null)ae=Q.formAction;else if(lT(D)!==null)continue}else ae=Q.action;typeof ae=="function"?x[C+1]=ae:(x.splice(C,3),C-=3),wH(x)}}}function SH(){function h(P){P.canIntercept&&P.info==="react-transition"&&P.intercept({handler:function(){return new Promise(function(Q){return D=Q})},focusReset:"manual",scroll:"manual"})}function g(){D!==null&&(D(),D=null),C||setTimeout(x,20)}function x(){if(!C&&!navigation.transition){var P=navigation.currentEntry;P&&P.url!=null&&navigation.navigate(P.url,{state:P.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var C=!1,D=null;return navigation.addEventListener("navigate",h),navigation.addEventListener("navigatesuccess",g),navigation.addEventListener("navigateerror",g),setTimeout(x,100),function(){C=!0,navigation.removeEventListener("navigate",h),navigation.removeEventListener("navigatesuccess",g),navigation.removeEventListener("navigateerror",g),D!==null&&(D(),D=null)}}}function uT(h){this._internalRoot=h}qw.prototype.render=uT.prototype.render=function(h){var g=this._internalRoot;if(g===null)throw Error(n(409));var x=g.current,C=ps();hH(x,C,h,g,null,null)},qw.prototype.unmount=uT.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var g=h.containerInfo;hH(h.current,2,null,h,null,null),_w(),g[Ce]=null}};function qw(h){this._internalRoot=h}qw.prototype.unstable_scheduleHydration=function(h){if(h){var g=Ke();h={blockedOn:null,target:h,priority:g};for(var x=0;x<Wu.length&&g!==0&&g<Wu[x].priority;x++);Wu.splice(x,0,h),x===0&&yH(h)}};var kH=t.version;if(kH!=="19.2.4")throw Error(n(527,kH,"19.2.4"));B.findDOMNode=function(h){var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(n(188)):(h=Object.keys(h).join(","),Error(n(268,h)));return h=u(g),h=h!==null?d(h):null,h=h===null?null:h.stateNode,h};var L1e={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ww=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ww.isDisabled&&Ww.supportsFiber)try{tt=Ww.inject(L1e),_e=Ww}catch{}}return vv.createRoot=function(h,g){if(!a(h))throw Error(n(299));var x=!1,C="",D=TF,P=AF,Q=DF;return g!=null&&(g.unstable_strictMode===!0&&(x=!0),g.identifierPrefix!==void 0&&(C=g.identifierPrefix),g.onUncaughtError!==void 0&&(D=g.onUncaughtError),g.onCaughtError!==void 0&&(P=g.onCaughtError),g.onRecoverableError!==void 0&&(Q=g.onRecoverableError)),g=dH(h,1,!1,null,null,x,C,null,D,P,Q,SH),h[Ce]=g.current,WM(h),new uT(g)},vv.hydrateRoot=function(h,g,x){if(!a(h))throw Error(n(299));var C=!1,D="",P=TF,Q=AF,ae=DF,ye=null;return x!=null&&(x.unstable_strictMode===!0&&(C=!0),x.identifierPrefix!==void 0&&(D=x.identifierPrefix),x.onUncaughtError!==void 0&&(P=x.onUncaughtError),x.onCaughtError!==void 0&&(Q=x.onCaughtError),x.onRecoverableError!==void 0&&(ae=x.onRecoverableError),x.formState!==void 0&&(ye=x.formState)),g=dH(h,1,!0,g,x??null,C,D,ye,P,Q,ae,SH),g.context=fH(null),x=g.current,C=ps(),C=X(C),D=Tu(C),D.callback=null,Au(x,D,C),x=C,g.current.lanes=x,jt(g,x),cl(g),h[Ce]=g.current,WM(h),new qw(g)},vv.version="19.2.4",vv}var DH;function bSe(){if(DH)return hT.exports;DH=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hT.exports=vSe(),hT.exports}var ySe=bSe();const xSe={primary:["bg-[var(--color-primary)] text-white","hover:bg-[var(--color-primary-hover)]","active:bg-[var(--color-primary-active)]","focus-visible:ring-2 focus-visible:ring-[var(--color-primary-200)] focus-visible:ring-offset-2","dark:focus-visible:ring-[var(--color-primary-800)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),secondary:["bg-[var(--color-neutral-100)] text-[var(--color-text)]","hover:bg-[var(--color-neutral-200)]","active:bg-[var(--color-neutral-300)]","focus-visible:ring-2 focus-visible:ring-[var(--color-neutral-400)] focus-visible:ring-offset-2","dark:bg-[var(--color-surface)] dark:text-[var(--color-text)]","dark:hover:bg-[var(--color-surface-hover)]","dark:active:bg-[var(--color-surface-active)]","dark:focus-visible:ring-[var(--color-neutral-600)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),ghost:["bg-transparent text-[var(--color-text-secondary)]","hover:bg-[var(--color-neutral-100)] hover:text-[var(--color-text)]","active:bg-[var(--color-neutral-200)]","focus-visible:ring-2 focus-visible:ring-[var(--color-neutral-400)] focus-visible:ring-offset-2","dark:text-[var(--color-text-secondary)]","dark:hover:bg-[var(--color-surface-hover)] dark:hover:text-[var(--color-text)]","dark:active:bg-[var(--color-surface-active)]","dark:focus-visible:ring-[var(--color-neutral-600)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),danger:["bg-[var(--color-danger)] text-white","hover:bg-[var(--color-danger-hover)]","active:bg-[var(--color-error-700)]","focus-visible:ring-2 focus-visible:ring-[var(--color-error-200)] focus-visible:ring-offset-2","dark:focus-visible:ring-[var(--color-error-900)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),outline:["bg-transparent border border-[var(--color-border)] text-[var(--color-text)]","hover:bg-[var(--color-surface-hover)] hover:border-[var(--color-neutral-400)]","active:bg-[var(--color-surface-active)]","focus-visible:ring-2 focus-visible:ring-[var(--color-primary-200)] focus-visible:ring-offset-2","dark:border-[var(--color-border)] dark:text-[var(--color-text)]","dark:hover:bg-[var(--color-surface-hover)] dark:hover:border-[var(--color-neutral-600)]","dark:active:bg-[var(--color-surface-active)]","dark:focus-visible:ring-[var(--color-primary-800)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" ")},wSe={xs:"h-6 px-2 text-xs gap-1 rounded",sm:"h-7 px-2.5 text-sm gap-1.5 rounded-md",md:"h-9 px-4 text-sm gap-2 rounded-md",lg:"h-11 px-6 text-base gap-2 rounded-lg"},SSe={xs:"h-6 w-6 p-0",sm:"h-7 w-7 p-0",md:"h-9 w-9 p-0",lg:"h-11 w-11 p-0"};function kSe({className:e=""}){return o.jsxs("svg",{className:`animate-spin ${e}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}const _Se=w.forwardRef(({className:e="",variant:t="primary",size:r="md",isLoading:n=!1,leftIcon:a,rightIcon:i,fullWidth:s=!1,disabled:l,children:c,...u},d)=>{const m=["inline-flex items-center justify-center","font-medium","transition-all duration-[var(--duration-fast)]","active:scale-[0.98]",s?"w-full":"",!c&&(a||i)&&!(a&&i)?SSe[r]:wSe[r],xSe[t],e].filter(Boolean).join(" "),p=r==="xs"||r==="sm"?"w-3 h-3":"w-4 h-4";return o.jsx("button",{ref:d,className:m,disabled:l||n,...u,children:n?o.jsxs(o.Fragment,{children:[o.jsx(kSe,{className:p}),c&&o.jsx("span",{className:"opacity-0",children:c})]}):o.jsxs(o.Fragment,{children:[a&&o.jsx("span",{className:"flex-shrink-0",children:a}),c,i&&o.jsx("span",{className:"flex-shrink-0",children:i})]})})});_Se.displayName="Button";const NSe={sm:"h-7 px-2.5 text-sm",md:"h-9 px-3 text-sm",lg:"h-11 px-4 text-base"},CSe={sm:"px-2",md:"px-3",lg:"px-4"},jSe=w.forwardRef(({className:e="",size:t="md",error:r,leftAddon:n,rightAddon:a,fullWidth:i=!1,wrapperClassName:s="",disabled:l,...c},u)=>{const d=!!r,f=["bg-[var(--color-input-bg)]","text-[var(--color-text)]","placeholder:text-[var(--color-text-tertiary)]",d?"border border-[var(--color-error-500)] focus:border-[var(--color-error-500)]":"border border-[var(--color-input-border)] focus:border-[var(--color-border-focus)]","focus:outline-none",d?"focus:ring-2 focus:ring-[var(--color-error-200)] dark:focus:ring-[var(--color-error-900)]":"focus:ring-2 focus:ring-[var(--color-input-focus-ring)]",n?"rounded-r-md":a?"rounded-l-md":"rounded-md",NSe[t],i||n||a?"w-full":"","transition-colors duration-[var(--duration-fast)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-[var(--color-bg-secondary)]",e].filter(Boolean).join(" "),m=["flex items-center","bg-[var(--color-bg-secondary)] dark:bg-[var(--color-surface)]","text-[var(--color-text-secondary)]","border border-[var(--color-input-border)]",CSe[t]].join(" ");return n||a?o.jsxs("div",{className:`${i?"w-full":""} ${s}`,children:[o.jsxs("div",{className:"flex",children:[n&&o.jsx("span",{className:`${m} rounded-l-md border-r-0`,children:n}),o.jsx("input",{ref:u,className:f,disabled:l,"aria-invalid":d,"aria-describedby":r?`${c.id}-error`:void 0,...c}),a&&o.jsx("span",{className:`${m} rounded-r-md border-l-0`,children:a})]}),r&&o.jsx("p",{id:`${c.id}-error`,className:"mt-1.5 text-xs text-[var(--color-error-500)] dark:text-[var(--color-error-400)]",children:r})]}):o.jsxs("div",{className:`${i?"w-full":""} ${s}`,children:[o.jsx("input",{ref:u,className:f,disabled:l,"aria-invalid":d,"aria-describedby":r?`${c.id}-error`:void 0,...c}),r&&o.jsx("p",{id:`${c.id}-error`,className:"mt-1.5 text-xs text-[var(--color-error-500)] dark:text-[var(--color-error-400)]",children:r})]})});jSe.displayName="Input";const ESe={sm:"px-2.5 py-1.5 text-sm",md:"px-3 py-2 text-sm",lg:"px-4 py-3 text-base"},MSe=w.forwardRef(({className:e="",size:t="md",error:r,fullWidth:n=!1,wrapperClassName:a="",disabled:i,...s},l)=>{const c=!!r,u=["bg-[var(--color-input-bg)]","text-[var(--color-text)]","placeholder:text-[var(--color-text-tertiary)]",c?"border border-[var(--color-error-500)] focus:border-[var(--color-error-500)]":"border border-[var(--color-input-border)] focus:border-[var(--color-border-focus)]","focus:outline-none",c?"focus:ring-2 focus:ring-[var(--color-error-200)] dark:focus:ring-[var(--color-error-900)]":"focus:ring-2 focus:ring-[var(--color-input-focus-ring)]","rounded-md",ESe[t],n?"w-full":"","resize-y min-h-[80px]","transition-colors duration-[var(--duration-fast)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-[var(--color-bg-secondary)]",e].filter(Boolean).join(" ");return o.jsxs("div",{className:`${n?"w-full":""} ${a}`,children:[o.jsx("textarea",{ref:l,className:u,disabled:i,"aria-invalid":c,"aria-describedby":r?`${s.id}-error`:void 0,...s}),r&&o.jsx("p",{id:`${s.id}-error`,className:"mt-1.5 text-xs text-[var(--color-error-500)] dark:text-[var(--color-error-400)]",children:r})]})});MSe.displayName="Textarea";const TSe=w.forwardRef(({className:e="",required:t,children:r,...n},a)=>o.jsxs("label",{ref:a,className:`block text-sm font-medium text-[var(--color-text)] mb-1.5 ${e}`,...n,children:[r,t&&o.jsx("span",{className:"text-[var(--color-error-500)] ml-0.5",children:"*"})]}));TSe.displayName="Label";const ASe=$6,_ie=w.forwardRef(({className:e="",...t},r)=>o.jsx(tj,{ref:r,className:["fixed inset-0","bg-black/50 dark:bg-black/70","backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","z-[var(--z-index-modal-backdrop)]",e].join(" "),...t}));_ie.displayName=tj.displayName;const DSe={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-[calc(100vw-2rem)] max-h-[calc(100vh-2rem)]"},LSe=w.forwardRef(({className:e="",children:t,size:r="md",hideClose:n=!1,...a},i)=>o.jsxs(ASe,{children:[o.jsx(_ie,{}),o.jsxs(rj,{ref:i,className:["fixed left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%]","w-full",DSe[r],"bg-[var(--color-bg-elevated)] dark:bg-[var(--color-card-bg)]","border border-[var(--color-border)] dark:border-[var(--color-card-border)]","rounded-xl","shadow-2xl dark:shadow-2xl","overflow-hidden","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]","duration-200","z-[var(--z-index-modal)]","focus:outline-none",e].join(" "),...a,children:[t,!n&&o.jsx(F6,{className:["absolute right-3 top-3","p-1.5 rounded-md","text-[var(--color-text-tertiary)]","hover:text-[var(--color-text-secondary)]","hover:bg-[var(--color-surface-hover)]","focus:outline-none focus:ring-2 focus:ring-[var(--color-border-focus)]","transition-colors duration-[var(--duration-fast)]","disabled:pointer-events-none"].join(" "),"aria-label":"Close",children:o.jsx(wt,{className:"h-4 w-4"})})]})]}));LSe.displayName=rj.displayName;const OSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(nj,{ref:r,className:["text-lg font-semibold","text-[var(--color-text)]","leading-tight",e].join(" "),...t}));OSe.displayName=nj.displayName;const ISe=w.forwardRef(({className:e="",...t},r)=>o.jsx(U6,{ref:r,className:["mt-1.5 text-sm","text-[var(--color-text-secondary)]",e].join(" "),...t}));ISe.displayName=U6.displayName;const RSe={sm:"h-7 px-2.5 text-sm",md:"h-9 px-3 text-sm",lg:"h-11 px-4 text-base"},PSe=w.forwardRef(({className:e="",children:t,size:r="md",error:n=!1,fullWidth:a=!1,...i},s)=>o.jsxs(aie,{ref:s,className:["inline-flex items-center justify-between gap-2","bg-[var(--color-input-bg)]","text-[var(--color-text)]",n?"border border-[var(--color-error-500)]":"border border-[var(--color-input-border)]","rounded-md",RSe[r],a?"w-full":"","data-[placeholder]:text-[var(--color-text-tertiary)]","focus:outline-none",n?"focus:ring-2 focus:ring-[var(--color-error-200)] dark:focus:ring-[var(--color-error-900)]":"focus:ring-2 focus:ring-[var(--color-input-focus-ring)] focus:border-[var(--color-border-focus)]","hover:border-[var(--color-neutral-400)] dark:hover:border-[var(--color-neutral-600)]","transition-colors duration-[var(--duration-fast)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-[var(--color-bg-secondary)]",e].join(" "),...i,children:[o.jsx("span",{className:"truncate",children:t}),o.jsx(Wwe,{asChild:!0,children:o.jsx(cr,{className:"h-4 w-4 flex-shrink-0 text-[var(--color-text-tertiary)]"})})]}));PSe.displayName=aie.displayName;const Nie=w.forwardRef(({className:e="",...t},r)=>o.jsx(iie,{ref:r,className:["flex items-center justify-center h-6","cursor-default","text-[var(--color-text-tertiary)]",e].join(" "),...t,children:o.jsx(Xg,{className:"h-4 w-4"})}));Nie.displayName=iie.displayName;const Cie=w.forwardRef(({className:e="",...t},r)=>o.jsx(sie,{ref:r,className:["flex items-center justify-center h-6","cursor-default","text-[var(--color-text-tertiary)]",e].join(" "),...t,children:o.jsx(cr,{className:"h-4 w-4"})}));Cie.displayName=sie.displayName;const zSe=w.forwardRef(({className:e="",children:t,position:r="popper",...n},a)=>o.jsx(Kwe,{children:o.jsxs(oie,{ref:a,className:["z-[var(--z-index-dropdown)]","relative","bg-[var(--color-bg-elevated)] dark:bg-[var(--color-card-bg)]","border border-[var(--color-border)] dark:border-[var(--color-card-border)]","shadow-lg dark:shadow-lg","rounded-lg","overflow-hidden","p-1","min-w-[8rem]",r==="popper"&&"max-h-[var(--radix-select-content-available-height)]","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=top]:slide-in-from-bottom-2",e].filter(Boolean).join(" "),position:r,...n,children:[o.jsx(Nie,{}),o.jsx(Gwe,{className:r==="popper"?"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]":"",children:t}),o.jsx(Cie,{})]})}));zSe.displayName=oie.displayName;const BSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(lie,{ref:r,className:["px-2 py-1.5","text-xs font-semibold","text-[var(--color-text-tertiary)]","uppercase tracking-wide",e].join(" "),...t}));BSe.displayName=lie.displayName;const $Se=w.forwardRef(({className:e="",children:t,...r},n)=>o.jsxs(cie,{ref:n,className:["relative flex items-center","w-full","pl-8 pr-2 py-2","text-sm","text-[var(--color-text)]","rounded-md","cursor-pointer select-none outline-none","hover:bg-[var(--color-surface-hover)]","focus:bg-[var(--color-surface-hover)]","data-[highlighted]:bg-[var(--color-surface-hover)]","data-[disabled]:opacity-50 data-[disabled]:pointer-events-none",e].join(" "),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-4 w-4 items-center justify-center",children:o.jsx(Vwe,{children:o.jsx(Vn,{className:"h-4 w-4 text-[var(--color-primary)]"})})}),o.jsx(Ywe,{children:t})]}));$Se.displayName=cie.displayName;const FSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(uie,{ref:r,className:["-mx-1 my-1 h-px","bg-[var(--color-border)] dark:bg-[var(--color-card-border)]",e].join(" "),...t}));FSe.displayName=uie.displayName;const USe={default:["bg-[var(--color-neutral-100)] text-[var(--color-text-secondary)]","dark:bg-[var(--color-surface)] dark:text-[var(--color-text-secondary)]"].join(" "),primary:["bg-[var(--color-primary-muted)] text-[var(--color-primary-text)]","dark:bg-[var(--color-primary-muted)] dark:text-[var(--color-primary)]"].join(" "),success:["bg-[var(--color-success-bg)] text-[var(--color-success-700)]","dark:bg-[var(--color-success-bg)] dark:text-[var(--color-success-text)]"].join(" "),warning:["bg-[var(--color-warning-bg)] text-[var(--color-warning-700)]","dark:bg-[var(--color-warning-bg)] dark:text-[var(--color-warning-text)]"].join(" "),error:["bg-[var(--color-danger-bg)] text-[var(--color-error-700)]","dark:bg-[var(--color-danger-bg)] dark:text-[var(--color-danger-text)]"].join(" "),outline:["bg-transparent border border-[var(--color-border)] text-[var(--color-text-secondary)]","dark:border-[var(--color-border)] dark:text-[var(--color-text-secondary)]"].join(" ")},HSe={sm:"px-1.5 py-0.5 text-[10px]",md:"px-2 py-0.5 text-xs"},Al=w.forwardRef(({className:e="",variant:t="default",size:r="md",...n},a)=>o.jsx("span",{ref:a,className:["inline-flex items-center","font-medium","rounded-md","whitespace-nowrap",USe[t],HSe[r],e].join(" "),...n}));Al.displayName="Badge";const qSe={default:["bg-[var(--color-card-bg)]","border border-[var(--color-card-border)]"].join(" "),elevated:["bg-[var(--color-card-bg)]","border border-[var(--color-card-border)]","shadow-md dark:shadow-md"].join(" "),outlined:["bg-transparent","border border-[var(--color-border)]"].join(" ")},i0=w.forwardRef(({className:e="",variant:t="default",hoverable:r=!1,clickable:n=!1,noPadding:a=!1,...i},s)=>o.jsx("div",{ref:s,className:["rounded-lg",a?"":"p-4",qSe[t],r?"hover:bg-[var(--color-card-hover)] transition-colors duration-[var(--duration-fast)]":"",n?["cursor-pointer","hover:bg-[var(--color-card-hover)]","focus:outline-none focus:ring-2 focus:ring-[var(--color-border-focus)] focus:ring-offset-2","transition-colors duration-[var(--duration-fast)]"].join(" "):"",e].filter(Boolean).join(" "),tabIndex:n?0:void 0,role:n?"button":void 0,...i}));i0.displayName="Card";const WSe=w.forwardRef(({className:e="",...t},r)=>o.jsx("div",{ref:r,className:["flex flex-col space-y-1.5",e].join(" "),...t}));WSe.displayName="CardHeader";const KSe=w.forwardRef(({className:e="",...t},r)=>o.jsx("h3",{ref:r,className:["text-base font-semibold","text-[var(--color-text)]","leading-tight",e].join(" "),...t}));KSe.displayName="CardTitle";const GSe=w.forwardRef(({className:e="",...t},r)=>o.jsx("p",{ref:r,className:["text-sm","text-[var(--color-text-secondary)]",e].join(" "),...t}));GSe.displayName="CardDescription";const VSe=w.forwardRef(({className:e="",...t},r)=>o.jsx("div",{ref:r,className:e,...t}));VSe.displayName="CardContent";const YSe=w.forwardRef(({className:e="",...t},r)=>o.jsx("div",{ref:r,className:["flex items-center pt-4",e].join(" "),...t}));YSe.displayName="CardFooter";function Cn({children:e,content:t,shortcut:r,side:n="top",align:a="center",delayDuration:i=200}){return o.jsxs(die,{delayDuration:i,children:[o.jsx(fie,{asChild:!0,children:e}),o.jsx(hie,{children:o.jsxs(mie,{side:n,align:a,sideOffset:4,className:`z-50 px-2.5 py-1.5 text-xs rounded-md bg-gray-900 text-white shadow-lg
                     animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out
                     data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95
                     data-[side=top]:slide-in-from-bottom-2
                     data-[side=bottom]:slide-in-from-top-2
                     data-[side=left]:slide-in-from-right-2
                     data-[side=right]:slide-in-from-left-2`,"data-testid":"tooltip-content",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{children:t}),r&&o.jsx("kbd",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded bg-gray-700 text-gray-200 font-mono text-[10px]",children:r})]}),o.jsx(pie,{className:"fill-gray-900"})]})})]})}function QSe({children:e}){return o.jsx(gie,{children:e})}function aj({tags:e,onChange:t,placeholder:r="Type and press comma to add tags",className:n="","data-testid":a}){const[i,s]=w.useState(""),l=m=>{const p=m.trim().toLowerCase();p&&!e.includes(p)&&t([...e,p]),s("")},c=m=>{t(e.filter(p=>p!==m))},u=m=>{m.key===","||m.key==="Enter"?(m.preventDefault(),l(i)):m.key==="Backspace"&&!i&&e.length>0&&c(e[e.length-1])},d=m=>{const p=m.target.value;if(p.includes(",")){const v=p.split(",");v.slice(0,-1).forEach(b=>l(b)),s(v[v.length-1])}else s(p)},f=()=>{i.trim()&&l(i)};return o.jsxs("div",{className:`flex flex-wrap items-center gap-1.5 p-2 border border-[var(--color-border)] rounded-md focus-within:ring-2 focus-within:ring-[var(--color-primary)] focus-within:border-transparent bg-[var(--color-input-bg)] min-h-[42px] ${n}`,"data-testid":a,children:[e.map(m=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-sm bg-[var(--color-surface-elevated)] text-[var(--color-text)] rounded","data-testid":`tag-${m}`,children:[m,o.jsx("button",{type:"button",onClick:()=>c(m),className:"p-0.5 hover:bg-[var(--color-surface-hover)] rounded text-[var(--color-text-tertiary)] hover:text-[var(--color-text)]","aria-label":`Remove tag ${m}`,"data-testid":`tag-remove-${m}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},m)),o.jsx("input",{type:"text",value:i,onChange:d,onKeyDown:u,onBlur:f,placeholder:e.length===0?r:"",className:"flex-1 min-w-[100px] outline-none text-sm bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)]","data-testid":`${a}-input`})]})}const jie="settings.theme",Eie="settings.highContrastBase";function JSe(){if(typeof window>"u")return"system";const e=localStorage.getItem(jie);return e==="light"||e==="dark"||e==="system"||e==="high-contrast"?e:"system"}function ZSe(e){typeof window>"u"||localStorage.setItem(jie,e)}function AO(){return typeof window>"u"?"light":localStorage.getItem(Eie)==="dark"?"dark":"light"}function XSe(e){typeof window>"u"||localStorage.setItem(Eie,e)}function DO(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Kw(e){if(typeof window>"u")return;const t=document.documentElement;if(t.classList.remove("dark","theme-dark","theme-light","high-contrast"),e==="high-contrast"){const r=AO();t.classList.add("high-contrast"),r==="dark"?t.classList.add("dark","theme-dark"):t.classList.add("theme-light")}else(e==="system"?DO():e)==="dark"?t.classList.add("dark","theme-dark"):t.classList.add("theme-light")}function eke(){const[e,t]=w.useState("system"),[r,n]=w.useState("light"),[a,i]=w.useState("light"),s=w.useCallback(f=>f==="high-contrast"?AO():f==="system"?DO():f,[]);w.useEffect(()=>{const f=JSe();t(f),Kw(f),n(s(f)),i(AO())},[s]),w.useEffect(()=>{if(e!=="system")return;const f=window.matchMedia("(prefers-color-scheme: dark)"),m=()=>{Kw("system"),n(DO())};return f.addEventListener("change",m),()=>f.removeEventListener("change",m)},[e]);const l=w.useCallback(f=>{t(f),ZSe(f),Kw(f),n(s(f))},[s]),c=w.useCallback(f=>{XSe(f),i(f),e==="high-contrast"&&(Kw("high-contrast"),n(f))},[e]),u=w.useCallback(()=>{l(e==="light"?"dark":e==="dark"?"high-contrast":e==="high-contrast"?"system":"light")},[e,l]),d=w.useCallback(()=>{l(r==="dark"?"light":"dark")},[r,l]);return{theme:e,resolvedTheme:r,isDark:r==="dark",isHighContrast:e==="high-contrast",highContrastBase:a,setTheme:l,setHighContrastThemeBase:c,toggleTheme:u,toggleDarkMode:d}}function tke({showCycle:e=!1,className:t=""}){const{theme:r,resolvedTheme:n,toggleTheme:a,toggleDarkMode:i}=eke();return e?o.jsx("button",{onClick:a,className:`
          p-2 rounded-lg transition-colors
          text-gray-500 dark:text-gray-400
          hover:bg-gray-100 dark:hover:bg-[var(--color-sidebar-item-hover)]
          hover:text-gray-700 dark:hover:text-gray-200
          ${t}
        `,"aria-label":`Current theme: ${r}. Click to change.`,title:`Theme: ${r==="system"?`System (${n})`:r}`,"data-testid":"theme-toggle",children:r==="system"?o.jsx(E6,{className:"w-5 h-5"}):r==="dark"?o.jsx(Jk,{className:"w-5 h-5"}):o.jsx(Zk,{className:"w-5 h-5"})}):o.jsx("button",{onClick:i,className:`
        p-2 rounded-lg transition-colors
        text-gray-500 dark:text-gray-400
        hover:bg-gray-100 dark:hover:bg-[var(--color-sidebar-item-hover)]
        hover:text-gray-700 dark:hover:text-gray-200
        ${t}
      `,"aria-label":n==="dark"?"Switch to light mode":"Switch to dark mode",title:n==="dark"?"Switch to light mode":"Switch to dark mode","data-testid":"theme-toggle",children:n==="dark"?o.jsx(Zk,{className:"w-5 h-5"}):o.jsx(Jk,{className:"w-5 h-5"})})}const rke=w.forwardRef(({width:e="100%",height:t="1rem",radius:r="0.25rem",animate:n=!0,variant:a,className:i="",style:s,...l},c)=>{let u=e,d=t,f=r;switch(a){case"text":d="1rem",f="0.25rem";break;case"circular":f="50%";break;case"rectangular":f="0";break;case"rounded":f="0.5rem";break}const m="bg-gray-200 dark:bg-gray-700",p=n?"animate-pulse":"";return o.jsx("div",{ref:c,className:`${m} ${p} ${i}`,style:{width:typeof u=="number"?`${u}px`:u,height:typeof d=="number"?`${d}px`:d,borderRadius:typeof f=="number"?`${f}px`:f,...s},"data-testid":"skeleton",...l})});rke.displayName="Skeleton";const LO={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function nke(e){const[t,r]=w.useState(!1);return w.useEffect(()=>{const n=()=>{r(window.innerWidth<LO[e])};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[e]),t}function jo(){return nke("md")}function ake(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=()=>{const n=window.innerWidth;t(n>=LO.md&&n<LO.lg)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),e}function ike({open:e,onClose:t,children:r,width:n=280,maxWidth:a="85vw","data-testid":i="mobile-drawer",contentClassName:s="",showCloseButton:l=!0,closeButtonContent:c,swipeThreshold:u=50,backdropBlur:d=!0,backdropClassName:f=""}){const m=w.useRef(null),p=w.useRef(null);w.useEffect(()=>{if(e){const _=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=_}}},[e]),w.useEffect(()=>{if(!e)return;const _=N=>{N.key==="Escape"&&t()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[e,t]);const v=_=>{p.current=_.touches[0].clientX},b=_=>{if(p.current===null)return;const N=_.touches[0].clientX;p.current-N>u&&(t(),p.current=null)},y=()=>{p.current=null};if(w.useEffect(()=>{if(!e||!m.current)return;const _=m.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),N=_[0],k=_[_.length-1];N?.focus();const j=E=>{E.key==="Tab"&&(E.shiftKey?document.activeElement===N&&(k?.focus(),E.preventDefault()):document.activeElement===k&&(N?.focus(),E.preventDefault()))};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[e]),!e)return null;const S=typeof n=="number"?`${n}px`:n;return o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":i,role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[o.jsx("div",{className:`absolute inset-0 bg-black/50 transition-opacity duration-200 ${d?"backdrop-blur-sm":""} ${f}`,onClick:t,"data-testid":`${i}-backdrop`,"aria-hidden":"true"}),o.jsxs("div",{ref:m,className:`absolute left-0 top-0 bottom-0 bg-[var(--color-sidebar-bg)] shadow-2xl transform transition-transform duration-200 ease-out flex flex-col ${s}`,style:{width:S,maxWidth:a,transform:e?"translateX(0)":"translateX(-100%)"},onTouchStart:v,onTouchMove:b,onTouchEnd:y,"data-testid":`${i}-content`,children:[l&&o.jsx("button",{onClick:t,className:"absolute top-3 right-3 p-2 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-sidebar-item-hover)] transition-colors duration-150 z-10","aria-label":"Close navigation menu","data-testid":`${i}-close`,children:c??o.jsx(wt,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:r})]})]})}const ske={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};function Bx({open:e,onClose:t,children:r,title:n,icon:a,size:i="md",className:s="","data-testid":l="responsive-modal",footer:c,hideClose:u=!1}){const d=jo(),f=w.useRef(null),m=w.useRef(null),p=w.useRef(0);w.useEffect(()=>{if(e){const S=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=S}}},[e]),w.useEffect(()=>{if(!e)return;const S=_=>{_.key==="Escape"&&t()};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[e,t]),w.useEffect(()=>{if(!e||!d)return;window.history.pushState({responsiveModal:!0},"");const S=_=>{_.state?.responsiveModal===void 0&&t()};return window.addEventListener("popstate",S),()=>{window.removeEventListener("popstate",S),window.history.state?.responsiveModal&&window.history.back()}},[e,d,t]);const v=S=>{d&&(m.current=S.touches[0].clientY,p.current=0)},b=S=>{!d||m.current===null||(p.current=S.touches[0].clientY-m.current,p.current<0&&(p.current=0),f.current&&p.current>0&&(f.current.style.transform=`translateY(${p.current}px)`))},y=()=>{!d||m.current===null||(p.current>100?t():f.current&&(f.current.style.transform="translateY(0)"),m.current=null,p.current=0)};return w.useEffect(()=>{e&&f.current&&f.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},[e]),e?d?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":l,role:"dialog","aria-modal":"true","aria-labelledby":`${l}-title`,children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-200",onClick:t,"data-testid":`${l}-backdrop`,"aria-hidden":"true"}),o.jsxs("div",{ref:f,className:"absolute inset-x-0 bottom-0 top-0 bg-[var(--color-bg)] shadow-2xl flex flex-col transform transition-transform duration-200 ease-out",style:{transform:e?"translateY(0)":"translateY(100%)"},"data-testid":`${l}-content`,children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",onTouchStart:v,onTouchMove:b,onTouchEnd:y,children:[o.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 w-10 h-1 bg-[var(--color-border)] rounded-full"}),!u&&o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Close","data-testid":`${l}-close`,children:o.jsx(Fl,{className:"w-5 h-5"})}),a&&o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:a}),o.jsx("h2",{id:`${l}-title`,className:"flex-1 text-lg font-semibold text-[var(--color-text)] truncate",children:n})]}),o.jsx("div",{className:`flex-1 overflow-y-auto ${s}`,children:r}),c&&o.jsx("div",{className:"sticky bottom-0 px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:c})]})]}):o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":l,role:"dialog","aria-modal":"true","aria-labelledby":`${l}-title`,children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"data-testid":`${l}-backdrop`,"aria-hidden":"true"}),o.jsx("div",{ref:f,className:`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full ${ske[i]} max-h-[90vh] overflow-y-auto mx-4`,"data-testid":`${l}-content`,children:o.jsxs("div",{className:"bg-white dark:bg-[var(--color-surface)] rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:a}),o.jsx("h2",{id:`${l}-title`,className:"text-lg font-semibold text-gray-900 dark:text-white",children:n})]}),!u&&o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Close","data-testid":`${l}-close`,children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:s,children:r}),c&&o.jsx("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-[var(--color-surface-secondary)]",children:c})]})})]}):null}const LH={1:{label:"Critical",variant:"error"},2:{label:"High",variant:"warning"},3:{label:"Medium",variant:"primary"},4:{label:"Low",variant:"default"},5:{label:"Trivial",variant:"outline"}};function Mie(e){return LH[e]||LH[3]}function oke(e){return Mie(e).label}function lke(e){switch(e){case 1:return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case 2:return"text-orange-600 bg-orange-100 dark:text-orange-400 dark:bg-orange-900/30";case 3:return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case 4:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50";case 5:return"text-gray-500 bg-gray-50 dark:text-gray-500 dark:bg-gray-800/30";default:return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30"}}function cke(e){switch(e){case"open":return"Open";case"todo":return"To Do";case"in_progress":return"In Progress";case"blocked":return"Blocked";case"review":return"Review";case"closed":return"Closed";case"cancelled":return"Cancelled";case"deferred":return"Deferred";case"backlog":return"Backlog";default:return e}}function uke(e){switch(e){case"open":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case"todo":return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50";case"in_progress":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case"blocked":return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case"review":return"text-purple-600 bg-purple-100 dark:text-purple-400 dark:bg-purple-900/30";case"closed":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/30";case"cancelled":return"text-gray-500 bg-gray-50 dark:text-gray-500 dark:bg-gray-800/30";case"deferred":return"text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/30";case"backlog":return"text-gray-700 bg-gray-200 dark:text-gray-300 dark:bg-gray-700";default:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50"}}function dke(e){switch(e){case"bug":return"Bug";case"feature":return"Feature";case"task":return"Task";case"chore":return"Chore";default:return e}}function fke(e){switch(e){case"bug":return"text-red-700 bg-red-50 dark:text-red-300 dark:bg-red-900/20";case"feature":return"text-purple-700 bg-purple-50 dark:text-purple-300 dark:bg-purple-900/20";case"task":return"text-blue-700 bg-blue-50 dark:text-blue-300 dark:bg-blue-900/20";case"chore":return"text-gray-700 bg-gray-50 dark:text-gray-300 dark:bg-gray-800/50";default:return"text-gray-700 bg-gray-50 dark:text-gray-300 dark:bg-gray-800/50"}}function hke(e){switch(e){case"pending":return"Pending Merge";case"testing":return"Testing";case"merging":return"Merging";case"merged":return"Merged";case"conflict":return"Conflict";case"test_failed":return"Tests Failed";case"failed":return"Merge Failed";case"not_applicable":return"No Merge Needed";default:return e}}function mke(e){switch(e){case"pending":return"text-purple-600 bg-purple-100 dark:text-purple-400 dark:bg-purple-900/30";case"testing":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case"merging":return"text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/30";case"merged":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/30";case"conflict":return"text-orange-600 bg-orange-100 dark:text-orange-400 dark:bg-orange-900/30";case"test_failed":return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case"failed":return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case"not_applicable":return"text-gray-500 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50";default:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50"}}const OH={bug:"border-l-4 border-l-[var(--color-error-400)]",feature:"border-l-4 border-l-[var(--color-accent-400)]",task:"border-l-4 border-l-[var(--color-primary-400)]",chore:"border-l-4 border-l-[var(--color-neutral-400)]"};function pke(e){return OH[e]||OH.task}const IH={agent:{bgColor:"bg-[var(--color-primary-muted)]",textColor:"text-[var(--color-primary-text)]",variant:"primary"},human:{bgColor:"bg-[var(--color-success-bg)]",textColor:"text-[var(--color-success-text)]",variant:"success"},system:{bgColor:"bg-[var(--color-warning-bg)]",textColor:"text-[var(--color-warning-text)]",variant:"warning"}};function gke(e){return IH[e]||IH.system}function vke(e,t){if(!e)return{truncated:"",isTruncated:!1};const n=e.split(`
`).slice(0,t).join(`
`),a=e.split(`
`).length>t||n.length<e.length;return n.length>150?{truncated:n.slice(0,147)+"...",isTruncated:!0}:{truncated:n,isTruncated:a}}const bke=w.forwardRef(({task:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!0,showTimestamp:i=!1,showDescription:s=!0,showCounts:l=!0},c)=>{const u=Mie(e.priority),d=pke(e.taskType),{truncated:f,isTruncated:m}=vke(e.description,2),p=!!e.description&&e.description.trim().length>0,v=e._attachmentCount||0,b=e._blocksCount||0,y=e._blockedByCount||0,S=v>0||b>0||y>0,_=()=>{if(!s||!p)return null;const N=o.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-secondary)] line-clamp-2 leading-relaxed","data-testid":"task-description-preview",children:f});return m&&e.description?o.jsx(gie,{delayDuration:400,children:o.jsxs(die,{children:[o.jsx(fie,{asChild:!0,children:N}),o.jsx(hie,{children:o.jsxs(mie,{className:"max-w-sm p-3 text-xs text-[var(--color-text)] bg-[var(--color-surface-elevated)] border border-[var(--color-border)] rounded-lg shadow-lg z-50",sideOffset:5,"data-testid":"task-description-tooltip",children:[o.jsxs("p",{className:"whitespace-pre-wrap",children:[e.description.slice(0,500),e.description.length>500?"...":""]}),o.jsx(pie,{className:"fill-[var(--color-surface-elevated)]"})]})})]})}):N};return o.jsxs(i0,{ref:c,variant:"default",clickable:!!r,onClick:r,className:[d,t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)]":"","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`task-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-medium text-[var(--color-text)] truncate leading-tight",children:e.title}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] mt-1 font-mono truncate",children:e.id})]}),o.jsx(Al,{variant:u.variant,size:"sm",children:u.label})]}),_(),o.jsxs("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[o.jsx(Al,{variant:"outline",size:"sm",className:"capitalize",children:e.taskType}),e.assignee&&o.jsxs("span",{className:"text-xs text-[var(--color-text-secondary)]",children:["Assigned: ",o.jsx("span",{className:"text-[var(--color-text)]",children:e.assignee})]})]}),l&&S&&o.jsxs("div",{className:"mt-2 flex items-center gap-3 flex-wrap","data-testid":"task-counts",children:[v>0&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-[var(--color-text-secondary)]","data-testid":"task-attachment-count",children:[o.jsx(HC,{className:"w-3 h-3"}),v]}),b>0&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-[var(--color-warning-text)]","data-testid":"task-blocks-count",title:`Blocks ${b} task${b>1?"s":""}`,children:[o.jsx(cu,{className:"w-3 h-3"}),"Blocks ",b]}),y>0&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-[var(--color-danger-text)]","data-testid":"task-blocked-by-count",title:`Blocked by ${y} task${y>1?"s":""}`,children:[o.jsx(Ox,{className:"w-3 h-3"}),"Blocked by ",y]})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(N=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:N},N)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]}),i&&o.jsxs("div",{className:"mt-3 text-[11px] text-[var(--color-text-tertiary)]",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})});bke.displayName="TaskCard";function yke(e){switch(e){case"agent":return Xr;case"human":return Zr;case"system":return Od;default:return Od}}const xke=w.forwardRef(({entity:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!0,showTimestamp:i=!0},s)=>{const l=gke(e.entityType),c=yke(e.entityType),u=e.active!==!1;return o.jsxs(i0,{ref:s,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)]":"",u?"":"opacity-60","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`entity-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${l.bgColor} flex-shrink-0`,"data-testid":`entity-avatar-${e.id}`,children:o.jsx(c,{className:`w-5 h-5 ${l.textColor}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-medium text-[var(--color-text)] truncate",children:e.name}),!u&&o.jsx(Al,{variant:"outline",size:"sm",children:"Inactive"})]}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate",children:e.id})]}),o.jsx(Al,{variant:l.variant,size:"sm",className:"capitalize flex-shrink-0","data-testid":`entity-type-badge-${e.id}`,children:e.entityType})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:d},d)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]}),i&&o.jsxs("div",{className:"mt-3 text-[11px] text-[var(--color-text-tertiary)]",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})});xke.displayName="EntityCard";const RH={draft:{label:"Draft",variant:"default"},active:{label:"Active",variant:"primary"},completed:{label:"Completed",variant:"success"},cancelled:{label:"Cancelled",variant:"error"}};function wke(e){return RH[e]||RH.draft}const Ske=w.forwardRef(({plan:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!1,progress:i,children:s},l)=>{const c=wke(e.status);return o.jsxs(i0,{ref:l,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)] bg-[var(--color-surface-selected)]":"","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`plan-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--color-primary-muted)] flex items-center justify-center flex-shrink-0",children:o.jsx(M6,{className:"w-4 h-4 text-[var(--color-primary)]"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h3",{"data-testid":"plan-card-title",className:"font-medium text-[var(--color-text)] truncate",children:e.title}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate mt-0.5",children:e.id})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx(Al,{variant:c.variant,size:"sm",children:c.label}),o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]})]}),typeof i=="number"&&o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:"Progress"}),o.jsxs("span",{className:"text-xs font-medium text-[var(--color-text)]",children:[i,"%"]})]}),o.jsx("div",{className:"w-full h-1.5 bg-[var(--color-surface-active)] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-[var(--color-primary)] rounded-full transition-all duration-300",style:{width:`${i}%`}})})]}),s,e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(u=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:u},u)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]})]})});Ske.displayName="PlanCard";const PH={created:{label:"Created",variant:"default"},active:{label:"Active",variant:"primary"},completed:{label:"Completed",variant:"success"},failed:{label:"Failed",variant:"error"},cancelled:{label:"Cancelled",variant:"warning"}};function kke(e){return PH[e]||PH.created}function _ke(e){return e==="failed"?"bg-[var(--color-error)]":e==="completed"?"bg-[var(--color-success)]":"bg-[var(--color-primary)]"}const Nke=w.forwardRef(({workflow:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!1,progress:i,children:s},l)=>{const c=kke(e.status),u=e.ephemeral===!0;return o.jsxs(i0,{ref:l,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)] bg-[var(--color-surface-selected)]":"",u?"border-dashed":"","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`workflow-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[o.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${u?"bg-[var(--color-warning-bg)]":"bg-[var(--color-accent-100)] dark:bg-[var(--color-accent-900)]"}`,children:u?o.jsx(J1e,{className:"w-4 h-4 text-[var(--color-warning)]"}):o.jsx(vh,{className:"w-4 h-4 text-[var(--color-accent-600)] dark:text-[var(--color-accent-400)]"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h3",{"data-testid":"workflow-card-title",className:"font-medium text-[var(--color-text)] truncate",children:e.title}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate mt-0.5",children:e.id})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[u&&o.jsx(Al,{variant:"warning",size:"sm",children:"Ephemeral"}),o.jsx(Al,{variant:c.variant,size:"sm",children:c.label}),o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]})]}),typeof i=="number"&&o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:"Progress"}),o.jsxs("span",{className:"text-xs font-medium text-[var(--color-text)]",children:[i,"%"]})]}),o.jsx("div",{className:"w-full h-1.5 bg-[var(--color-surface-active)] rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${_ke(e.status)}`,style:{width:`${i}%`}})})]}),e.playbookId&&o.jsxs("div",{className:"mt-2 text-xs text-[var(--color-text-secondary)]",children:["From playbook:"," ",o.jsx("span",{className:"font-mono text-[var(--color-text-tertiary)]",children:e.playbookId})]}),s,e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:d},d)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]})]})});Nke.displayName="WorkflowCard";const Cke=w.forwardRef(({team:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!0,showTimestamp:i=!0,memberAvatarStack:s},l)=>{const c=e.status!=="tombstone",u=e.members?.length||0;return o.jsxs(i0,{ref:l,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)]":"",c?"":"opacity-60","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`team-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--color-accent-100)] dark:bg-[var(--color-accent-900)] flex items-center justify-center flex-shrink-0","data-testid":`team-avatar-${e.id}`,children:o.jsx(Ii,{className:"w-5 h-5 text-[var(--color-accent-600)] dark:text-[var(--color-accent-400)]"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-medium text-[var(--color-text)] truncate",children:e.name}),!c&&o.jsx(Al,{variant:"outline",size:"sm",children:"Deleted"})]}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate",children:e.id})]}),o.jsxs(Al,{variant:"primary",size:"sm",className:"flex-shrink-0","data-testid":`team-member-count-${e.id}`,children:[u," ",u===1?"member":"members"]})]}),u>0&&s&&o.jsx("div",{className:"mt-3",children:s}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:d},d)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]}),i&&o.jsxs("div",{className:"mt-3 text-[11px] text-[var(--color-text-tertiary)]",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})});Cke.displayName="TeamCard";function Vp({status:e,className:t=""}){return o.jsx("span",{className:`inline-flex items-center whitespace-nowrap px-2 py-0.5 text-xs font-medium rounded-full ${uke(e)} ${t}`,"data-testid":"task-status-badge",children:cke(e)})}Vp.displayName="TaskStatusBadge";function jke(e){switch(e){case 1:return Bn;case 2:return Rx;case 3:return EH;case 4:return Ix;case 5:return cr;default:return EH}}function Yp({priority:e,showIcon:t=!0,className:r=""}){const n=jke(e);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full ${lke(e)} ${r}`,"data-testid":"task-priority-badge",children:[t&&o.jsx(n,{className:"w-3 h-3"}),oke(e)]})}Yp.displayName="TaskPriorityBadge";function Eke(e){switch(e){case"bug":return X1e;case"feature":return Z1e;case"task":return ay;case"chore":return Zo;default:return ay}}function H6({taskType:e,className:t=""}){const r=Eke(e);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded ${fke(e)} ${t}`,"data-testid":"task-type-badge",children:[o.jsx(r,{className:"w-3 h-3"}),dke(e)]})}H6.displayName="TaskTypeBadge";function Qp({status:e,className:t=""}){return o.jsx("span",{className:`inline-flex items-center whitespace-nowrap px-2 py-0.5 text-xs font-medium rounded-full ${mke(e)} ${t}`,"data-testid":"merge-status-badge",children:hke(e)})}Qp.displayName="MergeStatusBadge";var gT,ij="HoverCard",[Tie]=iSe(ij,[bie]),sj=bie(),[Mke,oj]=Tie(ij),Aie=e=>{const{__scopeHoverCard:t,children:r,open:n,defaultOpen:a,onOpenChange:i,openDelay:s=700,closeDelay:l=300}=e,c=sj(t),u=w.useRef(0),d=w.useRef(0),f=w.useRef(!1),m=w.useRef(!1),[p,v]=Qwe({prop:n,defaultProp:a??!1,onChange:i,caller:ij}),b=w.useCallback(()=>{clearTimeout(d.current),u.current=window.setTimeout(()=>v(!0),s)},[s,v]),y=w.useCallback(()=>{clearTimeout(u.current),!f.current&&!m.current&&(d.current=window.setTimeout(()=>v(!1),l))},[l,v]),S=w.useCallback(()=>v(!1),[v]);return w.useEffect(()=>()=>{clearTimeout(u.current),clearTimeout(d.current)},[]),o.jsx(Mke,{scope:t,open:p,onOpenChange:v,onOpen:b,onClose:y,onDismiss:S,hasSelectionRef:f,isPointerDownOnContentRef:m,children:o.jsx(Jwe,{...c,children:r})})};Aie.displayName=ij;var Die="HoverCardTrigger",Lie=w.forwardRef((e,t)=>{const{__scopeHoverCard:r,...n}=e,a=oj(Die,r),i=sj(r);return o.jsx(Zwe,{asChild:!0,...i,children:o.jsx(Xwe.a,{"data-state":a.open?"open":"closed",...n,ref:t,onPointerEnter:Bc(e.onPointerEnter,e_(a.onOpen)),onPointerLeave:Bc(e.onPointerLeave,e_(a.onClose)),onFocus:Bc(e.onFocus,a.onOpen),onBlur:Bc(e.onBlur,a.onClose),onTouchStart:Bc(e.onTouchStart,s=>s.preventDefault())})})});Lie.displayName=Die;var q6="HoverCardPortal",[Tke,Ake]=Tie(q6,{forceMount:void 0}),Oie=e=>{const{__scopeHoverCard:t,forceMount:r,children:n,container:a}=e,i=oj(q6,t);return o.jsx(Tke,{scope:t,forceMount:r,children:o.jsx(vie,{present:r||i.open,children:o.jsx(eSe,{asChild:!0,container:a,children:n})})})};Oie.displayName=q6;var Xk="HoverCardContent",Iie=w.forwardRef((e,t)=>{const r=Ake(Xk,e.__scopeHoverCard),{forceMount:n=r.forceMount,...a}=e,i=oj(Xk,e.__scopeHoverCard);return o.jsx(vie,{present:n||i.open,children:o.jsx(Dke,{"data-state":i.open?"open":"closed",...a,onPointerEnter:Bc(e.onPointerEnter,e_(i.onOpen)),onPointerLeave:Bc(e.onPointerLeave,e_(i.onClose)),ref:t})})});Iie.displayName=Xk;var Dke=w.forwardRef((e,t)=>{const{__scopeHoverCard:r,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:s,...l}=e,c=oj(Xk,r),u=sj(r),d=w.useRef(null),f=rSe(t,d),[m,p]=w.useState(!1);return w.useEffect(()=>{if(m){const v=document.body;return gT=v.style.userSelect||v.style.webkitUserSelect,v.style.userSelect="none",v.style.webkitUserSelect="none",()=>{v.style.userSelect=gT,v.style.webkitUserSelect=gT}}},[m]),w.useEffect(()=>{if(d.current){const v=()=>{p(!1),c.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(c.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",v),()=>{document.removeEventListener("pointerup",v),c.hasSelectionRef.current=!1,c.isPointerDownOnContentRef.current=!1}}},[c.isPointerDownOnContentRef,c.hasSelectionRef]),w.useEffect(()=>{d.current&&Oke(d.current).forEach(b=>b.setAttribute("tabindex","-1"))}),o.jsx(nSe,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:s,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:Bc(i,v=>{v.preventDefault()}),onDismiss:c.onDismiss,children:o.jsx(aSe,{...u,...l,onPointerDown:Bc(l.onPointerDown,v=>{v.currentTarget.contains(v.target)&&p(!0),c.hasSelectionRef.current=!1,c.isPointerDownOnContentRef.current=!0}),ref:f,style:{...l.style,userSelect:m?"text":void 0,WebkitUserSelect:m?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),Lke="HoverCardArrow",Rie=w.forwardRef((e,t)=>{const{__scopeHoverCard:r,...n}=e,a=sj(r);return o.jsx(tSe,{...a,...n,ref:t})});Rie.displayName=Lke;function e_(e){return t=>t.pointerType==="touch"?void 0:e()}function Oke(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;r.nextNode();)t.push(r.currentNode);return t}var Ike=Aie,Rke=Lie,Pke=Oie,zke=Iie,Bke=Rie;const zH={agent:{icon:Xr,bg:"bg-purple-100",text:"text-purple-700",darkBg:"dark:bg-purple-900/30",darkText:"dark:text-purple-300"},human:{icon:Zr,bg:"bg-blue-100",text:"text-blue-700",darkBg:"dark:bg-blue-900/30",darkText:"dark:text-blue-300"},system:{icon:Od,bg:"bg-gray-100",text:"text-gray-700",darkBg:"dark:bg-gray-800/50",darkText:"dark:text-gray-300"}};function Pie(e){return zH[e??"system"]||zH.system}function $ke(e){const t=e?.startsWith("el-");return gt({queryKey:["entities","byRef",e],queryFn:async()=>{if(!e)return null;if(t){const r=await fetch(`/api/entities/${e}`);if(!r.ok){if(r.status===404)return null;throw new Error("Failed to fetch entity")}return r.json()}else{const r=await fetch(`/api/entities?search=${encodeURIComponent(e)}&limit=100`);if(!r.ok)throw new Error("Failed to fetch entity");return(await r.json()).items.find(i=>i.name.toLowerCase()===e.toLowerCase())??null}},enabled:!!e,staleTime:3e4})}function Fke(e){return gt({queryKey:["entities",e,"stats"],queryFn:async()=>{const t=await fetch(`/api/entities/${e}/stats`);if(!t.ok)throw new Error("Failed to fetch entity stats");return t.json()},enabled:!!e,staleTime:3e4})}function zie({entityRef:e,children:t,className:r="",showHoverCard:n=!1,showStats:a=!0,showIcon:i=!1,navigable:s=!1,onNavigate:l,renderProfileLink:c,"data-testid":u}){const{data:d,isLoading:f}=$ke(e),{data:m,isLoading:p}=Fke(n&&a?d?.id??null:null),v=t??d?.name??e,b=Pie(d?.entityType),y=b.icon,S=s?N=>{N.preventDefault(),N.stopPropagation(),l?.(d??null,e)}:void 0;if(!s&&!n&&f)return o.jsxs("span",{className:`inline-flex items-center gap-1 text-gray-400 ${r}`,children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),e]});const _=s?o.jsxs("button",{onClick:S,className:`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 hover:underline cursor-pointer font-medium ${r}`,"data-testid":u||`entity-link-${e}`,children:[i&&o.jsx(y,{className:`w-3.5 h-3.5 ${b.text} ${b.darkText}`}),v]}):o.jsxs("span",{className:`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium ${r}`,"data-testid":u||`entity-link-${e}`,title:d?`${d.name} (${d.entityType})`:e,children:[i&&o.jsx(y,{className:`w-3.5 h-3.5 ${b.text} ${b.darkText}`}),v]});return n?o.jsxs(Ike,{openDelay:400,closeDelay:200,children:[o.jsx(Rke,{asChild:!0,children:_}),o.jsx(Pke,{children:o.jsxs(zke,{className:`w-72 p-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50
                     animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out
                     data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95
                     data-[side=top]:slide-in-from-bottom-2
                     data-[side=bottom]:slide-in-from-top-2`,sideOffset:5,"data-testid":`entity-preview-${e}`,children:[f?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx($e,{className:"w-5 h-5 animate-spin text-gray-400"})}):d?o.jsx(Uke,{entity:d,stats:a?m:void 0,statsLoading:a?p:!1,onNavigate:l,renderProfileLink:c}):o.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Entity not found: ",e]}),o.jsx(Bke,{className:"fill-white dark:fill-gray-900"})]})})]}):_}function Uke({entity:e,stats:t,statsLoading:r,onNavigate:n,renderProfileLink:a}){const i=Pie(e.entityType),s=i.icon;return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${i.bg} ${i.darkBg}`,children:o.jsx(s,{className:`w-5 h-5 ${i.text} ${i.darkText}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:e.name}),o.jsx("div",{className:`text-xs ${i.text} ${i.darkText} capitalize`,children:e.entityType})]})]}),r?o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),"Loading stats..."]}):t?o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.openTasks}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Open"})]}),o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.completedTasks}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Done"})]}),o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.totalTasks}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total"})]})]}):null,t?.currentTask&&o.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/30 rounded border border-blue-100 dark:border-blue-800",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-blue-600 dark:text-blue-400 mb-1",children:[o.jsx(tn,{className:"w-3 h-3"}),"Currently working on"]}),o.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:t.currentTask.title})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(l=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded",children:l},l)),e.tags.length>3&&o.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",e.tags.length-3," more"]})]}),a?a(e):n?o.jsxs("button",{onClick:()=>n(e,e.id),className:"flex items-center gap-1 text-xs text-blue-600 dark:text-blue-400 hover:underline cursor-pointer","data-testid":`entity-preview-link-${e.id}`,children:["View full profile",o.jsx(Sl,{className:"w-3 h-3"})]}):null]})}function Vm(e,t,r){let n=r.initialDeps??[],a,i=!0;function s(){var l,c,u;let d;r.key&&((l=r.debug)!=null&&l.call(r))&&(d=Date.now());const f=e();if(!(f.length!==n.length||f.some((v,b)=>n[b]!==v)))return a;n=f;let p;if(r.key&&((c=r.debug)!=null&&c.call(r))&&(p=Date.now()),a=t(...f),r.key&&((u=r.debug)!=null&&u.call(r))){const v=Math.round((Date.now()-d)*100)/100,b=Math.round((Date.now()-p)*100)/100,y=b/16,S=(_,N)=>{for(_=String(_);_.length<N;)_=" "+_;return _};console.info(`%c ${S(b,5)} /${S(v,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,r?.key)}return r?.onChange&&!(i&&r.skipInitialOnChange)&&r.onChange(a),i=!1,a}return s.updateDeps=l=>{n=l},s}function BH(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const Hke=(e,t)=>Math.abs(e-t)<1.01,qke=(e,t,r)=>{let n;return function(...a){e.clearTimeout(n),n=e.setTimeout(()=>t.apply(this,a),r)}},$H=e=>{const{offsetWidth:t,offsetHeight:r}=e;return{width:t,height:r}},Wke=e=>e,Kke=e=>{const t=Math.max(e.startIndex-e.overscan,0),r=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let a=t;a<=r;a++)n.push(a);return n},Gke=(e,t)=>{const r=e.scrollElement;if(!r)return;const n=e.targetWindow;if(!n)return;const a=s=>{const{width:l,height:c}=s;t({width:Math.round(l),height:Math.round(c)})};if(a($H(r)),!n.ResizeObserver)return()=>{};const i=new n.ResizeObserver(s=>{const l=()=>{const c=s[0];if(c?.borderBoxSize){const u=c.borderBoxSize[0];if(u){a({width:u.inlineSize,height:u.blockSize});return}}a($H(r))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(r,{box:"border-box"}),()=>{i.unobserve(r)}},FH={passive:!0},UH=typeof window>"u"?!0:"onscrollend"in window,Vke=(e,t)=>{const r=e.scrollElement;if(!r)return;const n=e.targetWindow;if(!n)return;let a=0;const i=e.options.useScrollendEvent&&UH?()=>{}:qke(n,()=>{t(a,!1)},e.options.isScrollingResetDelay),s=d=>()=>{const{horizontal:f,isRtl:m}=e.options;a=f?r.scrollLeft*(m&&-1||1):r.scrollTop,i(),t(a,d)},l=s(!0),c=s(!1);r.addEventListener("scroll",l,FH);const u=e.options.useScrollendEvent&&UH;return u&&r.addEventListener("scrollend",c,FH),()=>{r.removeEventListener("scroll",l),u&&r.removeEventListener("scrollend",c)}},Yke=(e,t,r)=>{if(t?.borderBoxSize){const n=t.borderBoxSize[0];if(n)return Math.round(n[r.options.horizontal?"inlineSize":"blockSize"])}return e[r.options.horizontal?"offsetWidth":"offsetHeight"]},Qke=(e,{adjustments:t=0,behavior:r},n)=>{var a,i;const s=e+t;(i=(a=n.scrollElement)==null?void 0:a.scrollTo)==null||i.call(a,{[n.options.horizontal?"left":"top"]:s,behavior:r})};class Jke{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.currentScrollToIndex=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let r=null;const n=()=>r||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:r=new this.targetWindow.ResizeObserver(a=>{a.forEach(i=>{const s=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(s):s()})}));return{disconnect:()=>{var a;(a=n())==null||a.disconnect(),r=null},observe:a=>{var i;return(i=n())==null?void 0:i.observe(a,{box:"border-box"})},unobserve:a=>{var i;return(i=n())==null?void 0:i.unobserve(a)}}})(),this.range=null,this.setOptions=r=>{Object.entries(r).forEach(([n,a])=>{typeof a>"u"&&delete r[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Wke,rangeExtractor:Kke,onChange:()=>{},measureElement:Yke,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...r}},this.notify=r=>{var n,a;(a=(n=this.options).onChange)==null||a.call(n,this,r)},this.maybeNotify=Vm(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),r=>{this.notify(r)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var r;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((r=this.scrollElement)==null?void 0:r.window)??null,this.elementsCache.forEach(a=>{this.observer.observe(a)}),this.unsubs.push(this.options.observeElementRect(this,a=>{this.scrollRect=a,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(a,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<a?"forward":"backward":null,this.scrollOffset=a,this.isScrolling=i,this.maybeNotify()})),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0})}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(r,n)=>{const a=new Map,i=new Map;for(let s=n-1;s>=0;s--){const l=r[s];if(a.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&a.set(l.lane,!0),a.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((s,l)=>s.end===l.end?s.index-l.index:s.end-l.end)[0]:void 0},this.getMeasurementOptions=Vm(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(r,n,a,i,s,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:r,paddingStart:n,scrollMargin:a,getItemKey:i,enabled:s,lanes:l}),{key:!1}),this.getMeasurements=Vm(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:r,paddingStart:n,scrollMargin:a,getItemKey:i,enabled:s,lanes:l},c)=>{if(!s)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>r)for(const m of this.laneAssignments.keys())m>=r&&this.laneAssignments.delete(m);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&!this.lanesSettling&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(m=>{this.itemSizeCache.set(m.key,m.size)}));const u=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===r&&(this.lanesSettling=!1);const d=this.measurementsCache.slice(0,u),f=new Array(l).fill(void 0);for(let m=0;m<u;m++){const p=d[m];p&&(f[p.lane]=m)}for(let m=u;m<r;m++){const p=i(m),v=this.laneAssignments.get(m);let b,y;if(v!==void 0&&this.options.lanes>1){b=v;const k=f[b],j=k!==void 0?d[k]:void 0;y=j?j.end+this.options.gap:n+a}else{const k=this.options.lanes===1?d[m-1]:this.getFurthestMeasurement(d,m);y=k?k.end+this.options.gap:n+a,b=k?k.lane:m%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(m,b)}const S=c.get(p),_=typeof S=="number"?S:this.options.estimateSize(m),N=y+_;d[m]={index:m,start:y,size:_,end:N,key:p,lane:b},f[b]=m}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Vm(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(r,n,a,i)=>this.range=r.length>0&&n>0?Zke({measurements:r,outerSize:n,scrollOffset:a,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Vm(()=>{let r=null,n=null;const a=this.calculateRange();return a&&(r=a.startIndex,n=a.endIndex),this.maybeNotify.updateDeps([this.isScrolling,r,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,r,n]},(r,n,a,i,s)=>i===null||s===null?[]:r({startIndex:i,endIndex:s,overscan:n,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=r=>{const n=this.options.indexAttribute,a=r.getAttribute(n);return a?parseInt(a,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(r,n)=>{const a=this.indexFromElement(r),i=this.measurementsCache[a];if(!i)return;const s=i.key,l=this.elementsCache.get(s);l!==r&&(l&&this.observer.unobserve(l),this.observer.observe(r),this.elementsCache.set(s,r)),r.isConnected&&this.resizeItem(a,this.options.measureElement(r,n,this))},this.resizeItem=(r,n)=>{const a=this.measurementsCache[r];if(!a)return;const i=this.itemSizeCache.get(a.key)??a.size,s=n-i;s!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(a,s,this):a.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=s,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(a.index),this.itemSizeCache=new Map(this.itemSizeCache.set(a.key,n)),this.notify(!1))},this.measureElement=r=>{if(!r){this.elementsCache.forEach((n,a)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(a))});return}this._measureElement(r,void 0)},this.getVirtualItems=Vm(()=>[this.getVirtualIndexes(),this.getMeasurements()],(r,n)=>{const a=[];for(let i=0,s=r.length;i<s;i++){const l=r[i],c=n[l];a.push(c)}return a},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=r=>{const n=this.getMeasurements();if(n.length!==0)return BH(n[Bie(0,n.length-1,a=>BH(n[a]).start,r)])},this.getMaxScrollOffset=()=>{if(!this.scrollElement)return 0;if("scrollHeight"in this.scrollElement)return this.options.horizontal?this.scrollElement.scrollWidth-this.scrollElement.clientWidth:this.scrollElement.scrollHeight-this.scrollElement.clientHeight;{const r=this.scrollElement.document.documentElement;return this.options.horizontal?r.scrollWidth-this.scrollElement.innerWidth:r.scrollHeight-this.scrollElement.innerHeight}},this.getOffsetForAlignment=(r,n,a=0)=>{if(!this.scrollElement)return 0;const i=this.getSize(),s=this.getScrollOffset();n==="auto"&&(n=r>=s+i?"end":"start"),n==="center"?r+=(a-i)/2:n==="end"&&(r-=i);const l=this.getMaxScrollOffset();return Math.max(Math.min(l,r),0)},this.getOffsetForIndex=(r,n="auto")=>{r=Math.max(0,Math.min(r,this.options.count-1));const a=this.measurementsCache[r];if(!a)return;const i=this.getSize(),s=this.getScrollOffset();if(n==="auto")if(a.end>=s+i-this.options.scrollPaddingEnd)n="end";else if(a.start<=s+this.options.scrollPaddingStart)n="start";else return[s,n];if(n==="end"&&r===this.options.count-1)return[this.getMaxScrollOffset(),n];const l=n==="end"?a.end+this.options.scrollPaddingEnd:a.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,n,a.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(r,{align:n="start",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(r,n),{adjustments:void 0,behavior:a})},this.scrollToIndex=(r,{align:n="auto",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r=Math.max(0,Math.min(r,this.options.count-1)),this.currentScrollToIndex=r;let i=0;const s=10,l=u=>{if(!this.targetWindow)return;const d=this.getOffsetForIndex(r,u);if(!d){console.warn("Failed to get offset for index:",r);return}const[f,m]=d;this._scrollToOffset(f,{adjustments:void 0,behavior:a}),this.targetWindow.requestAnimationFrame(()=>{const p=()=>{if(this.currentScrollToIndex!==r)return;const v=this.getScrollOffset(),b=this.getOffsetForIndex(r,m);if(!b){console.warn("Failed to get offset for index:",r);return}Hke(b[0],v)||c(m)};this.isDynamicMode()?this.targetWindow.requestAnimationFrame(p):p()})},c=u=>{this.targetWindow&&this.currentScrollToIndex===r&&(i++,i<s?this.targetWindow.requestAnimationFrame(()=>l(u)):console.warn(`Failed to scroll to index ${r} after ${s} attempts.`))};l(n)},this.scrollBy=(r,{behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+r,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var r;const n=this.getMeasurements();let a;if(n.length===0)a=this.options.paddingStart;else if(this.options.lanes===1)a=((r=n[n.length-1])==null?void 0:r.end)??0;else{const i=Array(this.options.lanes).fill(null);let s=n.length-1;for(;s>=0&&i.some(l=>l===null);){const l=n[s];i[l.lane]===null&&(i[l.lane]=l.end),s--}a=Math.max(...i.filter(l=>l!==null))}return Math.max(a-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(r,{adjustments:n,behavior:a})=>{this.options.scrollToFn(r,{behavior:a,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const Bie=(e,t,r,n)=>{for(;e<=t;){const a=(e+t)/2|0,i=r(a);if(i<n)e=a+1;else if(i>n)t=a-1;else return a}return e>0?e-1:0};function Zke({measurements:e,outerSize:t,scrollOffset:r,lanes:n}){const a=e.length-1,i=c=>e[c].start;if(e.length<=n)return{startIndex:0,endIndex:a};let s=Bie(0,a,i,r),l=s;if(n===1)for(;l<a&&e[l].end<r+t;)l++;else if(n>1){const c=Array(n).fill(0);for(;l<a&&c.some(d=>d<r+t);){const d=e[l];c[d.lane]=d.end,l++}const u=Array(n).fill(r+t);for(;s>=0&&u.some(d=>d>=r);){const d=e[s];u[d.lane]=d.start,s--}s=Math.max(0,s-s%n),l=Math.min(a,l+(n-1-l%n))}return{startIndex:s,endIndex:l}}const HH=typeof document<"u"?w.useLayoutEffect:w.useEffect;function Xke({useFlushSync:e=!0,...t}){const r=w.useReducer(()=>({}),{})[1],n={...t,onChange:(i,s)=>{var l;e&&s?pd.flushSync(r):r(),(l=t.onChange)==null||l.call(t,i,s)}},[a]=w.useState(()=>new Jke(n));return a.setOptions(n),HH(()=>a._didMount(),[]),HH(()=>a._willUpdate()),a}function lj(e){return Xke({observeElementRect:Gke,observeElementOffset:Vke,scrollToFn:Qke,...e})}const vT="stoneforge-current-user-id",$ie=w.createContext(void 0);function e_e({children:e,useHumanEntities:t}){const{data:r=[],isLoading:n}=t(),[a,i]=w.useState(()=>typeof window<"u"?localStorage.getItem(vT):null),s=c=>{i(c),typeof window<"u"&&(c?localStorage.setItem(vT,c):localStorage.removeItem(vT))};w.useEffect(()=>{!n&&r.length>0&&!a&&s(r[0].id),!n&&r.length>0&&a&&(r.some(u=>u.id===a)||s(r[0].id))},[r,n,a]);const l=r.find(c=>c.id===a)??null;return o.jsx($ie.Provider,{value:{currentUser:l,setCurrentUserId:s,humanEntities:r,isLoading:n},children:e})}function nl(){const e=w.useContext($ie);if(e===void 0)throw new Error("useCurrentUser must be used within a CurrentUserProvider");return e}const OO=36,Fie=8,t_e=OO*Fie+8;function r_e(){const{currentUser:e,setCurrentUserId:t,humanEntities:r,isLoading:n}=nl(),[a,i]=w.useState(!1),[s,l]=w.useState(-1),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null),f=lj({count:r.length,getScrollElement:()=>d.current,estimateSize:()=>OO,overscan:3}),[m,p]=w.useState({}),v=w.useCallback(()=>{if(c.current){const N=c.current.getBoundingClientRect();p({position:"fixed",top:N.bottom+4,left:N.left,width:N.width*2,zIndex:9999})}},[]);w.useEffect(()=>{if(a){v();const N=r.findIndex(k=>k.id===e?.id);l(N>=0?N:0)}},[a,v,r,e?.id]),w.useEffect(()=>{if(!a)return;const N=j=>{c.current&&!c.current.contains(j.target)&&u.current&&!u.current.contains(j.target)&&i(!1)},k=j=>{j.key==="Escape"&&(i(!1),c.current?.focus())};return document.addEventListener("mousedown",N),document.addEventListener("keydown",k),()=>{document.removeEventListener("mousedown",N),document.removeEventListener("keydown",k)}},[a]);const b=w.useCallback(N=>{if(!a){(N.key==="ArrowDown"||N.key==="ArrowUp"||N.key==="Enter"||N.key===" ")&&(N.preventDefault(),i(!0));return}switch(N.key){case"ArrowDown":N.preventDefault(),l(k=>{const j=k<r.length-1?k+1:k;return f.scrollToIndex(j,{align:"auto"}),j});break;case"ArrowUp":N.preventDefault(),l(k=>{const j=k>0?k-1:k;return f.scrollToIndex(j,{align:"auto"}),j});break;case"Enter":case" ":N.preventDefault(),s>=0&&s<r.length&&(t(r[s].id),i(!1),c.current?.focus());break;case"Home":N.preventDefault(),l(0),f.scrollToIndex(0,{align:"start"});break;case"End":N.preventDefault(),l(r.length-1),f.scrollToIndex(r.length-1,{align:"end"});break}},[a,s,r,t,f]),y=w.useCallback(N=>{t(N),i(!1),c.current?.focus()},[t]);if(n)return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(Zr,{className:"w-4 h-4"}),o.jsx("span",{children:"Loading..."})]});if(r.length===0)return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(Zr,{className:"w-4 h-4"}),o.jsx("span",{children:"No users"})]});const S=f.getVirtualItems(),_=r.length>Fie;return o.jsxs(o.Fragment,{children:[o.jsxs("button",{ref:c,type:"button",onClick:()=>i(!a),onKeyDown:b,className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)]","data-testid":"user-selector-trigger","aria-haspopup":"listbox","aria-expanded":a,children:[o.jsx(Zr,{className:"w-4 h-4"}),o.jsx("span",{className:"truncate max-w-[120px]",children:e?.name??"Select user"}),o.jsx(cr,{className:`w-3.5 h-3.5 transition-transform ${a?"rotate-180":""}`})]}),a&&pd.createPortal(o.jsxs("div",{ref:u,style:m,className:"bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 overflow-hidden",role:"listbox","data-testid":"user-selector-dropdown",children:[o.jsx("div",{ref:d,className:"overflow-auto p-1",style:{maxHeight:t_e},onKeyDown:b,children:o.jsx("div",{style:{height:f.getTotalSize(),width:"100%",position:"relative"},children:S.map(N=>{const k=r[N.index],j=k.id===e?.id,E=N.index===s;return o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:OO,transform:`translateY(${N.start}px)`},children:o.jsxs("button",{type:"button",onClick:()=>y(k.id),onMouseEnter:()=>l(N.index),className:["w-full text-left px-3 py-1.5 text-sm","flex items-center justify-between","transition-colors",j?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]",E?"bg-[var(--color-surface-hover)]":"hover:bg-[var(--color-surface-hover)]"].join(" "),role:"option","aria-selected":j,"data-testid":`user-selector-option-${k.id}`,children:[o.jsx("span",{className:"truncate",children:k.name}),j&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]})},k.id)})})}),_&&o.jsxs("div",{className:"px-2 py-1 text-xs text-center text-[var(--color-text-tertiary)] border-t border-[var(--color-border)]",children:[r.length," users"]})]}),document.body)]})}function Uie({channel:e,className:t="w-5 h-5"}){return e.channelType==="direct"?o.jsx(Ii,{className:`text-gray-400 ${t}`}):e.permissions?.visibility==="private"?o.jsx(qC,{className:`text-gray-400 ${t}`}):o.jsx(qp,{className:`text-gray-400 ${t}`})}function n_e({channel:e,isMobile:t=!1,onBack:r,onOpenMembers:n,renderIcon:a,renderActions:i,showMemberCount:s=!1,membersButtonLabel:l,useSettingsIcon:c=!1}){const u=e.members?.length||0,d=m=>`${m} ${m===1?"member":"members"}`,f=c?li:ewe;return o.jsx("div",{"data-testid":"channel-header",className:`border-b border-[var(--color-border)] bg-[var(--color-bg)] ${t?"px-2 py-2":"px-4 py-3"}`,children:o.jsxs("div",{className:`flex items-center ${t?"gap-2":"gap-2 sm:gap-3"}`,children:[t&&r&&o.jsx("button",{onClick:r,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"channel-back-button","aria-label":"Back to channels",children:o.jsx(Fl,{className:"w-5 h-5"})}),a?a(e):o.jsx(Uie,{channel:e,className:t?"w-4 h-4":"w-5 h-5"}),o.jsx("h3",{"data-testid":"channel-name",className:`font-medium text-[var(--color-text)] truncate ${t?"text-base":s?"text-lg font-semibold":""}`,children:e.name}),n&&!t&&o.jsxs("button",{onClick:n,className:"flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 px-2 py-1 rounded transition-colors","data-testid":"channel-members-button",children:[o.jsx(f,{className:"w-4 h-4"}),(l||d)(u)]}),o.jsx("div",{className:"flex-1"}),i?.({channel:e,isMobile:t}),n&&t&&o.jsx("button",{onClick:n,className:"p-2 rounded-md text-gray-500 dark:text-gray-400 hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"channel-members-button","aria-label":"View members",children:c?o.jsx(li,{className:"w-5 h-5"}):o.jsx(Ii,{className:"w-5 h-5"})})]})})}function a_e(e={}){const{onResultSelect:t,enableKeyboardShortcut:r=!0}=e,[n,a]=w.useState(""),[i,s]=w.useState(!1),l=w.useRef(null),c=w.useCallback(d=>{a(""),s(!1),t?.(d)},[t]),u=w.useCallback(()=>{a(""),s(!1)},[]);return w.useEffect(()=>{if(!r)return;const d=f=>{(f.metaKey||f.ctrlKey)&&f.key==="f"&&(f.preventDefault(),l.current?.focus(),s(!0))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[r]),{searchQuery:n,setSearchQuery:a,isSearchOpen:i,setIsSearchOpen:s,searchInputRef:l,handleResultSelect:c,clearSearch:u}}function Hie(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Hie(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ur(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Hie(e))&&(n&&(n+=" "),n+=t);return n}var bT,qH;function ls(){if(qH)return bT;qH=1;var e=Array.isArray;return bT=e,bT}var yT,WH;function qie(){if(WH)return yT;WH=1;var e=typeof gd=="object"&&gd&&gd.Object===Object&&gd;return yT=e,yT}var xT,KH;function Ul(){if(KH)return xT;KH=1;var e=qie(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return xT=r,xT}var wT,GH;function $x(){if(GH)return wT;GH=1;var e=Ul(),t=e.Symbol;return wT=t,wT}var ST,VH;function i_e(){if(VH)return ST;VH=1;var e=$x(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function i(s){var l=r.call(s,a),c=s[a];try{s[a]=void 0;var u=!0}catch{}var d=n.call(s);return u&&(l?s[a]=c:delete s[a]),d}return ST=i,ST}var kT,YH;function s_e(){if(YH)return kT;YH=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return kT=r,kT}var _T,QH;function fu(){if(QH)return _T;QH=1;var e=$x(),t=i_e(),r=s_e(),n="[object Null]",a="[object Undefined]",i=e?e.toStringTag:void 0;function s(l){return l==null?l===void 0?a:n:i&&i in Object(l)?t(l):r(l)}return _T=s,_T}var NT,JH;function hu(){if(JH)return NT;JH=1;function e(t){return t!=null&&typeof t=="object"}return NT=e,NT}var CT,ZH;function s0(){if(ZH)return CT;ZH=1;var e=fu(),t=hu(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return CT=n,CT}var jT,XH;function W6(){if(XH)return jT;XH=1;var e=ls(),t=s0(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){if(e(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||t(i)?!0:n.test(i)||!r.test(i)||s!=null&&i in Object(s)}return jT=a,jT}var ET,eq;function Bd(){if(eq)return ET;eq=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return ET=e,ET}var MT,tq;function K6(){if(tq)return MT;tq=1;var e=fu(),t=Bd(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function s(l){if(!t(l))return!1;var c=e(l);return c==n||c==a||c==r||c==i}return MT=s,MT}var TT,rq;function o_e(){if(rq)return TT;rq=1;var e=Ul(),t=e["__core-js_shared__"];return TT=t,TT}var AT,nq;function l_e(){if(nq)return AT;nq=1;var e=o_e(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return AT=r,AT}var DT,aq;function Wie(){if(aq)return DT;aq=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return DT=r,DT}var LT,iq;function c_e(){if(iq)return LT;iq=1;var e=K6(),t=l_e(),r=Bd(),n=Wie(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,s=Function.prototype,l=Object.prototype,c=s.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(m){if(!r(m)||t(m))return!1;var p=e(m)?d:i;return p.test(n(m))}return LT=f,LT}var OT,sq;function u_e(){if(sq)return OT;sq=1;function e(t,r){return t?.[r]}return OT=e,OT}var IT,oq;function Wh(){if(oq)return IT;oq=1;var e=c_e(),t=u_e();function r(n,a){var i=t(n,a);return e(i)?i:void 0}return IT=r,IT}var RT,lq;function cj(){if(lq)return RT;lq=1;var e=Wh(),t=e(Object,"create");return RT=t,RT}var PT,cq;function d_e(){if(cq)return PT;cq=1;var e=cj();function t(){this.__data__=e?e(null):{},this.size=0}return PT=t,PT}var zT,uq;function f_e(){if(uq)return zT;uq=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return zT=e,zT}var BT,dq;function h_e(){if(dq)return BT;dq=1;var e=cj(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(i){var s=this.__data__;if(e){var l=s[i];return l===t?void 0:l}return n.call(s,i)?s[i]:void 0}return BT=a,BT}var $T,fq;function m_e(){if(fq)return $T;fq=1;var e=cj(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var i=this.__data__;return e?i[a]!==void 0:r.call(i,a)}return $T=n,$T}var FT,hq;function p_e(){if(hq)return FT;hq=1;var e=cj(),t="__lodash_hash_undefined__";function r(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=e&&a===void 0?t:a,this}return FT=r,FT}var UT,mq;function g_e(){if(mq)return UT;mq=1;var e=d_e(),t=f_e(),r=h_e(),n=m_e(),a=p_e();function i(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var u=s[l];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,UT=i,UT}var HT,pq;function v_e(){if(pq)return HT;pq=1;function e(){this.__data__=[],this.size=0}return HT=e,HT}var qT,gq;function G6(){if(gq)return qT;gq=1;function e(t,r){return t===r||t!==t&&r!==r}return qT=e,qT}var WT,vq;function uj(){if(vq)return WT;vq=1;var e=G6();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return WT=t,WT}var KT,bq;function b_e(){if(bq)return KT;bq=1;var e=uj(),t=Array.prototype,r=t.splice;function n(a){var i=this.__data__,s=e(i,a);if(s<0)return!1;var l=i.length-1;return s==l?i.pop():r.call(i,s,1),--this.size,!0}return KT=n,KT}var GT,yq;function y_e(){if(yq)return GT;yq=1;var e=uj();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return GT=t,GT}var VT,xq;function x_e(){if(xq)return VT;xq=1;var e=uj();function t(r){return e(this.__data__,r)>-1}return VT=t,VT}var YT,wq;function w_e(){if(wq)return YT;wq=1;var e=uj();function t(r,n){var a=this.__data__,i=e(a,r);return i<0?(++this.size,a.push([r,n])):a[i][1]=n,this}return YT=t,YT}var QT,Sq;function dj(){if(Sq)return QT;Sq=1;var e=v_e(),t=b_e(),r=y_e(),n=x_e(),a=w_e();function i(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var u=s[l];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,QT=i,QT}var JT,kq;function V6(){if(kq)return JT;kq=1;var e=Wh(),t=Ul(),r=e(t,"Map");return JT=r,JT}var ZT,_q;function S_e(){if(_q)return ZT;_q=1;var e=g_e(),t=dj(),r=V6();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return ZT=n,ZT}var XT,Nq;function k_e(){if(Nq)return XT;Nq=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return XT=e,XT}var e4,Cq;function fj(){if(Cq)return e4;Cq=1;var e=k_e();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return e4=t,e4}var t4,jq;function __e(){if(jq)return t4;jq=1;var e=fj();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return t4=t,t4}var r4,Eq;function N_e(){if(Eq)return r4;Eq=1;var e=fj();function t(r){return e(this,r).get(r)}return r4=t,r4}var n4,Mq;function C_e(){if(Mq)return n4;Mq=1;var e=fj();function t(r){return e(this,r).has(r)}return n4=t,n4}var a4,Tq;function j_e(){if(Tq)return a4;Tq=1;var e=fj();function t(r,n){var a=e(this,r),i=a.size;return a.set(r,n),this.size+=a.size==i?0:1,this}return a4=t,a4}var i4,Aq;function Y6(){if(Aq)return i4;Aq=1;var e=S_e(),t=__e(),r=N_e(),n=C_e(),a=j_e();function i(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var u=s[l];this.set(u[0],u[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,i4=i,i4}var s4,Dq;function Kie(){if(Dq)return s4;Dq=1;var e=Y6(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var i=function(){var s=arguments,l=a?a.apply(this,s):s[0],c=i.cache;if(c.has(l))return c.get(l);var u=n.apply(this,s);return i.cache=c.set(l,u)||c,u};return i.cache=new(r.Cache||e),i}return r.Cache=e,s4=r,s4}var o4,Lq;function E_e(){if(Lq)return o4;Lq=1;var e=Kie(),t=500;function r(n){var a=e(n,function(s){return i.size===t&&i.clear(),s}),i=a.cache;return a}return o4=r,o4}var l4,Oq;function M_e(){if(Oq)return l4;Oq=1;var e=E_e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(t,function(s,l,c,u){i.push(c?u.replace(r,"$1"):l||s)}),i});return l4=n,l4}var c4,Iq;function Q6(){if(Iq)return c4;Iq=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,i=Array(a);++n<a;)i[n]=r(t[n],n,t);return i}return c4=e,c4}var u4,Rq;function T_e(){if(Rq)return u4;Rq=1;var e=$x(),t=Q6(),r=ls(),n=s0(),a=e?e.prototype:void 0,i=a?a.toString:void 0;function s(l){if(typeof l=="string")return l;if(r(l))return t(l,s)+"";if(n(l))return i?i.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return u4=s,u4}var d4,Pq;function Gie(){if(Pq)return d4;Pq=1;var e=T_e();function t(r){return r==null?"":e(r)}return d4=t,d4}var f4,zq;function Vie(){if(zq)return f4;zq=1;var e=ls(),t=W6(),r=M_e(),n=Gie();function a(i,s){return e(i)?i:t(i,s)?[i]:r(n(i))}return f4=a,f4}var h4,Bq;function hj(){if(Bq)return h4;Bq=1;var e=s0();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return h4=t,h4}var m4,$q;function J6(){if($q)return m4;$q=1;var e=Vie(),t=hj();function r(n,a){a=e(a,n);for(var i=0,s=a.length;n!=null&&i<s;)n=n[t(a[i++])];return i&&i==s?n:void 0}return m4=r,m4}var p4,Fq;function Yie(){if(Fq)return p4;Fq=1;var e=J6();function t(r,n,a){var i=r==null?void 0:e(r,n);return i===void 0?a:i}return p4=t,p4}var A_e=Yie();const Ds=Fr(A_e);var g4,Uq;function D_e(){if(Uq)return g4;Uq=1;function e(t){return t==null}return g4=e,g4}var L_e=D_e();const tr=Fr(L_e);var v4,Hq;function O_e(){if(Hq)return v4;Hq=1;var e=fu(),t=ls(),r=hu(),n="[object String]";function a(i){return typeof i=="string"||!t(i)&&r(i)&&e(i)==n}return v4=a,v4}var I_e=O_e();const yh=Fr(I_e);var R_e=K6();const Jt=Fr(R_e);var P_e=Bd();const o0=Fr(P_e);var b4={exports:{}},Hr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qq;function z_e(){if(qq)return Hr;qq=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),v;v=Symbol.for("react.module.reference");function b(y){if(typeof y=="object"&&y!==null){var S=y.$$typeof;switch(S){case e:switch(y=y.type,y){case r:case a:case n:case u:case d:return y;default:switch(y=y&&y.$$typeof,y){case l:case s:case c:case m:case f:case i:return y;default:return S}}case t:return S}}}return Hr.ContextConsumer=s,Hr.ContextProvider=i,Hr.Element=e,Hr.ForwardRef=c,Hr.Fragment=r,Hr.Lazy=m,Hr.Memo=f,Hr.Portal=t,Hr.Profiler=a,Hr.StrictMode=n,Hr.Suspense=u,Hr.SuspenseList=d,Hr.isAsyncMode=function(){return!1},Hr.isConcurrentMode=function(){return!1},Hr.isContextConsumer=function(y){return b(y)===s},Hr.isContextProvider=function(y){return b(y)===i},Hr.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===e},Hr.isForwardRef=function(y){return b(y)===c},Hr.isFragment=function(y){return b(y)===r},Hr.isLazy=function(y){return b(y)===m},Hr.isMemo=function(y){return b(y)===f},Hr.isPortal=function(y){return b(y)===t},Hr.isProfiler=function(y){return b(y)===a},Hr.isStrictMode=function(y){return b(y)===n},Hr.isSuspense=function(y){return b(y)===u},Hr.isSuspenseList=function(y){return b(y)===d},Hr.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===r||y===a||y===n||y===u||y===d||y===p||typeof y=="object"&&y!==null&&(y.$$typeof===m||y.$$typeof===f||y.$$typeof===i||y.$$typeof===s||y.$$typeof===c||y.$$typeof===v||y.getModuleId!==void 0)},Hr.typeOf=b,Hr}var Wq;function B_e(){return Wq||(Wq=1,b4.exports=z_e()),b4.exports}var $_e=B_e(),y4,Kq;function Qie(){if(Kq)return y4;Kq=1;var e=fu(),t=hu(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return y4=n,y4}var x4,Gq;function F_e(){if(Gq)return x4;Gq=1;var e=Qie();function t(r){return e(r)&&r!=+r}return x4=t,x4}var U_e=F_e();const Fx=Fr(U_e);var H_e=Qie();const q_e=Fr(H_e);var Ai=function(t){return t===0?0:t>0?1:-1},qf=function(t){return yh(t)&&t.indexOf("%")===t.length-1},et=function(t){return q_e(t)&&!Fx(t)},W_e=function(t){return tr(t)},ja=function(t){return et(t)||yh(t)},K_e=0,l0=function(t){var r=++K_e;return"".concat(t||"").concat(r)},Di=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!et(t)&&!yh(t))return n;var i;if(qf(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Fx(i)&&(i=n),a&&i>r&&(i=r),i},ud=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},G_e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},js=function(t,r){return et(t)&&et(r)?function(n){return t+n*(r-t)}:function(){return r}};function t_(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Ds(n,t))===r})}var V_e=function(t,r){return et(t)&&et(r)?t-r:yh(t)&&yh(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Op(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function IO(e){"@babel/helpers - typeof";return IO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},IO(e)}var Y_e=["viewBox","children"],Q_e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Vq=["points","pathLength"],w4={svg:Y_e,polygon:Vq,polyline:Vq},Z6=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],r_=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),!o0(n))return null;var a={};return Object.keys(n).forEach(function(i){Z6.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},J_e=function(t,r,n){return function(a){return t(r,n,a),null}},xh=function(t,r,n){if(!o0(t)||IO(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];Z6.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=J_e(s,r,n))}),a},Z_e=["children"],X_e=["children"];function Yq(e,t){if(e==null)return{};var r=eNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function RO(e){"@babel/helpers - typeof";return RO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RO(e)}var Qq={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Yc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Jq=null,S4=null,X6=function e(t){if(t===Jq&&Array.isArray(S4))return S4;var r=[];return w.Children.forEach(t,function(n){tr(n)||($_e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),S4=r,Jq=t,r};function Ls(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return Yc(a)}):n=[Yc(t)],X6(e).forEach(function(a){var i=Ds(a,"type.displayName")||Ds(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Ns(e,t){var r=Ls(e,t);return r&&r[0]}var Zq=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!et(n)||n<=0||!et(a)||a<=0)},tNe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],rNe=function(t){return t&&t.type&&yh(t.type)&&tNe.indexOf(t.type)>=0},nNe=function(t){return t&&RO(t)==="object"&&"clipDot"in t},aNe=function(t,r,n,a){var i,s=(i=w4?.[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Jt(t)&&(a&&s.includes(r)||Q_e.includes(r))||n&&Z6.includes(r)},Ut=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(w.isValidElement(t)&&(a=t.props),!o0(a))return null;var i={};return Object.keys(a).forEach(function(s){var l;aNe((l=a)===null||l===void 0?void 0:l[s],s,r,n)&&(i[s]=a[s])}),i},PO=function e(t,r){if(t===r)return!0;var n=w.Children.count(t);if(n!==w.Children.count(r))return!1;if(n===0)return!0;if(n===1)return Xq(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!Xq(i,s))return!1}return!0},Xq=function(t,r){if(tr(t)&&tr(r))return!0;if(!tr(t)&&!tr(r)){var n=t.props||{},a=n.children,i=Yq(n,Z_e),s=r.props||{},l=s.children,c=Yq(s,X_e);return a&&l?Op(i,c)&&PO(a,l):!a&&!l?Op(i,c):!1}return!1},e7=function(t,r){var n=[],a={};return X6(t).forEach(function(i,s){if(rNe(i))n.push(i);else if(i){var l=Yc(i.type),c=r[l]||{},u=c.handler,d=c.once;if(u&&(!d||!a[l])){var f=u(i,l,s);n.push(f),a[l]=!0}}}),n},iNe=function(t){var r=t&&t.type;return r&&Qq[r]?Qq[r]:null},sNe=function(t,r){return X6(r).indexOf(t)},oNe=["children","width","height","viewBox","className","style","title","desc"];function zO(){return zO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zO.apply(this,arguments)}function lNe(e,t){if(e==null)return{};var r=cNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function BO(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,l=e.title,c=e.desc,u=lNe(e,oNe),d=a||{width:r,height:n,x:0,y:0},f=ur("recharts-surface",i);return le.createElement("svg",zO({},Ut(u,!0,"svg"),{className:f,width:r,height:n,style:s,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),le.createElement("title",null,l),le.createElement("desc",null,c),t)}var uNe=["children","className"];function $O(){return $O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$O.apply(this,arguments)}function dNe(e,t){if(e==null)return{};var r=fNe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Ir=le.forwardRef(function(e,t){var r=e.children,n=e.className,a=dNe(e,uNe),i=ur("recharts-layer",n);return le.createElement("g",$O({className:i},Ut(a,!0),{ref:t}),r)}),Qo=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},k4,t7;function hNe(){if(t7)return k4;t7=1;function e(t,r,n){var a=-1,i=t.length;r<0&&(r=-r>i?0:i+r),n=n>i?i:n,n<0&&(n+=i),i=r>n?0:n-r>>>0,r>>>=0;for(var s=Array(i);++a<i;)s[a]=t[a+r];return s}return k4=e,k4}var _4,r7;function mNe(){if(r7)return _4;r7=1;var e=hNe();function t(r,n,a){var i=r.length;return a=a===void 0?i:a,!n&&a>=i?r:e(r,n,a)}return _4=t,_4}var N4,n7;function Jie(){if(n7)return N4;n7=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,i="\\ufe0e\\ufe0f",s="\\u200d",l=RegExp("["+s+e+a+i+"]");function c(u){return l.test(u)}return N4=c,N4}var C4,a7;function pNe(){if(a7)return C4;a7=1;function e(t){return t.split("")}return C4=e,C4}var j4,i7;function gNe(){if(i7)return j4;i7=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,i="\\ufe0e\\ufe0f",s="["+e+"]",l="["+a+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+l+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",v=u+"?",b="["+i+"]?",y="(?:"+p+"(?:"+[d,f,m].join("|")+")"+b+v+")*",S=b+v+y,_="(?:"+[d+l+"?",l,f,m,s].join("|")+")",N=RegExp(c+"(?="+c+")|"+_+S,"g");function k(j){return j.match(N)||[]}return j4=k,j4}var E4,s7;function vNe(){if(s7)return E4;s7=1;var e=pNe(),t=Jie(),r=gNe();function n(a){return t(a)?r(a):e(a)}return E4=n,E4}var M4,o7;function bNe(){if(o7)return M4;o7=1;var e=mNe(),t=Jie(),r=vNe(),n=Gie();function a(i){return function(s){s=n(s);var l=t(s)?r(s):void 0,c=l?l[0]:s.charAt(0),u=l?e(l,1).join(""):s.slice(1);return c[i]()+u}}return M4=a,M4}var T4,l7;function yNe(){if(l7)return T4;l7=1;var e=bNe(),t=e("toUpperCase");return T4=t,T4}var xNe=yNe();const mj=Fr(xNe);function yn(e){return function(){return e}}const Zie=Math.cos,n_=Math.sin,al=Math.sqrt,a_=Math.PI,pj=2*a_,FO=Math.PI,UO=2*FO,If=1e-6,wNe=UO-If;function Xie(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function SNe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Xie;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class kNe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Xie:SNe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,u=a-r,d=s-t,f=l-r,m=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>If)if(!(Math.abs(f*c-u*d)>If)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-s,v=a-l,b=c*c+u*u,y=p*p+v*v,S=Math.sqrt(b),_=Math.sqrt(m),N=i*Math.tan((FO-Math.acos((b+m-y)/(2*S*_)))/2),k=N/_,j=N/S;Math.abs(k-1)>If&&this._append`L${t+k*d},${r+k*f}`,this._append`A${i},${i},0,0,${+(f*p>d*v)},${this._x1=t+j*c},${this._y1=r+j*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,f=1^s,m=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>If||Math.abs(this._y1-d)>If)&&this._append`L${u},${d}`,n&&(m<0&&(m=m%UO+UO),m>wNe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:m>If&&this._append`A${n},${n},0,${+(m>=FO)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function ez(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new kNe(t)}function tz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ese(e){this._context=e}ese.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function gj(e){return new ese(e)}function tse(e){return e[0]}function rse(e){return e[1]}function nse(e,t){var r=yn(!0),n=null,a=gj,i=null,s=ez(l);e=typeof e=="function"?e:e===void 0?tse:yn(e),t=typeof t=="function"?t:t===void 0?rse:yn(t);function l(c){var u,d=(c=tz(c)).length,f,m=!1,p;for(n==null&&(i=a(p=s())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+e(f,u,c),+t(f,u,c));if(p)return i=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:yn(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:yn(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:yn(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function Gw(e,t,r){var n=null,a=yn(!0),i=null,s=gj,l=null,c=ez(u);e=typeof e=="function"?e:e===void 0?tse:yn(+e),t=typeof t=="function"?t:yn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?rse:yn(+r);function u(f){var m,p,v,b=(f=tz(f)).length,y,S=!1,_,N=new Array(b),k=new Array(b);for(i==null&&(l=s(_=c())),m=0;m<=b;++m){if(!(m<b&&a(y=f[m],m,f))===S)if(S=!S)p=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=m-1;v>=p;--v)l.point(N[v],k[v]);l.lineEnd(),l.areaEnd()}S&&(N[m]=+e(y,m,f),k[m]=+t(y,m,f),l.point(n?+n(y,m,f):N[m],r?+r(y,m,f):k[m]))}if(_)return l=null,_+""||null}function d(){return nse().defined(a).curve(s).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:yn(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:yn(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:yn(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:yn(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:yn(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:yn(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:yn(!!f),u):a},u.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),u):i},u}class ase{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function _Ne(e){return new ase(e,!0)}function NNe(e){return new ase(e,!1)}const rz={draw(e,t){const r=al(t/a_);e.moveTo(r,0),e.arc(0,0,r,0,pj)}},CNe={draw(e,t){const r=al(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},ise=al(1/3),jNe=ise*2,ENe={draw(e,t){const r=al(t/jNe),n=r*ise;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},MNe={draw(e,t){const r=al(t),n=-r/2;e.rect(n,n,r,r)}},TNe=.8908130915292852,sse=n_(a_/10)/n_(7*a_/10),ANe=n_(pj/10)*sse,DNe=-Zie(pj/10)*sse,LNe={draw(e,t){const r=al(t*TNe),n=ANe*r,a=DNe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=pj*i/5,l=Zie(s),c=n_(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},A4=al(3),ONe={draw(e,t){const r=-al(t/(A4*3));e.moveTo(0,r*2),e.lineTo(-A4*r,-r),e.lineTo(A4*r,-r),e.closePath()}},Xs=-.5,eo=al(3)/2,HO=1/al(12),INe=(HO/2+1)*3,RNe={draw(e,t){const r=al(t/INe),n=r/2,a=r*HO,i=n,s=r*HO+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(Xs*n-eo*a,eo*n+Xs*a),e.lineTo(Xs*i-eo*s,eo*i+Xs*s),e.lineTo(Xs*l-eo*c,eo*l+Xs*c),e.lineTo(Xs*n+eo*a,Xs*a-eo*n),e.lineTo(Xs*i+eo*s,Xs*s-eo*i),e.lineTo(Xs*l+eo*c,Xs*c-eo*l),e.closePath()}};function PNe(e,t){let r=null,n=ez(a);e=typeof e=="function"?e:yn(e||rz),t=typeof t=="function"?t:yn(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:yn(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:yn(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function i_(){}function s_(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ose(e){this._context=e}ose.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:s_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:s_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zNe(e){return new ose(e)}function lse(e){this._context=e}lse.prototype={areaStart:i_,areaEnd:i_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:s_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function BNe(e){return new lse(e)}function cse(e){this._context=e}cse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:s_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $Ne(e){return new cse(e)}function use(e){this._context=e}use.prototype={areaStart:i_,areaEnd:i_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function FNe(e){return new use(e)}function c7(e){return e<0?-1:1}function u7(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(c7(i)+c7(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function d7(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function D4(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function o_(e){this._context=e}o_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:D4(this,this._t0,d7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,D4(this,d7(this,r=u7(this,e,t)),r);break;default:D4(this,this._t0,r=u7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function dse(e){this._context=new fse(e)}(dse.prototype=Object.create(o_.prototype)).point=function(e,t){o_.prototype.point.call(this,t,e)};function fse(e){this._context=e}fse.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function UNe(e){return new o_(e)}function HNe(e){return new dse(e)}function hse(e){this._context=e}hse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=f7(e),a=f7(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function f7(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function qNe(e){return new hse(e)}function vj(e,t){this._context=e,this._t=t}vj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function WNe(e){return new vj(e,.5)}function KNe(e){return new vj(e,0)}function GNe(e){return new vj(e,1)}function Jp(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function qO(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function VNe(e,t){return e[t]}function YNe(e){const t=[];return t.key=e,t}function QNe(){var e=yn([]),t=qO,r=Jp,n=VNe;function a(i){var s=Array.from(e.apply(this,arguments),YNe),l,c=s.length,u=-1,d;for(const f of i)for(l=0,++u;l<c;++l)(s[l][u]=[0,+n(f,s[l].key,u,i)]).data=f;for(l=0,d=tz(t(s));l<c;++l)s[d[l]].index=l;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:yn(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:yn(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?qO:typeof i=="function"?i:yn(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Jp,a):r},a}function JNe(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Jp(e,t)}}function ZNe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}Jp(e,t)}}function XNe(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,u=0;l<s;++l){for(var d=e[t[l]],f=d[n][1]||0,m=d[n-1][1]||0,p=(f-m)/2,v=0;v<l;++v){var b=e[t[v]],y=b[n][1]||0,S=b[n-1][1]||0;p+=y-S}c+=f,u+=p*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Jp(e,t)}}function ly(e){"@babel/helpers - typeof";return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ly(e)}var eCe=["type","size","sizeType"];function WO(){return WO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WO.apply(this,arguments)}function h7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function m7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h7(Object(r),!0).forEach(function(n){tCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tCe(e,t,r){return t=rCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rCe(e){var t=nCe(e,"string");return ly(t)=="symbol"?t:t+""}function nCe(e,t){if(ly(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ly(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aCe(e,t){if(e==null)return{};var r=iCe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var mse={symbolCircle:rz,symbolCross:CNe,symbolDiamond:ENe,symbolSquare:MNe,symbolStar:LNe,symbolTriangle:ONe,symbolWye:RNe},sCe=Math.PI/180,oCe=function(t){var r="symbol".concat(mj(t));return mse[r]||rz},lCe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*sCe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},cCe=function(t,r){mse["symbol".concat(mj(t))]=r},nz=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,l=s===void 0?"area":s,c=aCe(t,eCe),u=m7(m7({},c),{},{type:n,size:i,sizeType:l}),d=function(){var y=oCe(n),S=PNe().type(y).size(lCe(i,l,n));return S()},f=u.className,m=u.cx,p=u.cy,v=Ut(u,!0);return m===+m&&p===+p&&i===+i?le.createElement("path",WO({},v,{className:ur("recharts-symbols",f),transform:"translate(".concat(m,", ").concat(p,")"),d:d()})):null};nz.registerSymbol=cCe;function Zp(e){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(e)}function KO(){return KO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KO.apply(this,arguments)}function p7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p7(Object(r),!0).forEach(function(n){cy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fCe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gse(n.key),n)}}function hCe(e,t,r){return t&&fCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mCe(e,t,r){return t=l_(t),pCe(e,pse()?Reflect.construct(t,r||[],l_(e).constructor):t.apply(e,r))}function pCe(e,t){if(t&&(Zp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gCe(e)}function gCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pse=function(){return!!e})()}function l_(e){return l_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l_(e)}function vCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},GO(e,t)}function cy(e,t,r){return t=gse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gse(e){var t=bCe(e,"string");return Zp(t)=="symbol"?t:t+""}function bCe(e,t){if(Zp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var to=32,az=(function(e){function t(){return dCe(this,t),mCe(this,t,arguments)}return vCe(t,e),hCe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=to/2,s=to/6,l=to/3,c=n.inactive?a:n.color;if(n.type==="plainline")return le.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:to,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return le.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(to,"M").concat(2*l,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return le.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(to/8,"h").concat(to,"v").concat(to*3/4,"h").concat(-to,"z"),className:"recharts-legend-icon"});if(le.isValidElement(n.legendIcon)){var u=uCe({},n);return delete u.legendIcon,le.cloneElement(n.legendIcon,u)}return le.createElement(nz,{fill:c,cx:i,cy:i,size:to,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,l=a.layout,c=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:to,height:to},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},m={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(p,v){var b=p.formatter||c,y=ur(cy(cy({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",p.inactive));if(p.type==="none")return null;var S=Jt(p.value)?null:p.value;Qo(!Jt(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var _=p.inactive?u:p.color;return le.createElement("li",KO({className:y,style:f,key:"legend-item-".concat(v)},xh(n.props,p,v)),le.createElement(BO,{width:s,height:s,viewBox:d,style:m},n.renderIcon(p)),le.createElement("span",{className:"recharts-legend-item-text",style:{color:_}},b?b(S,p,v):S))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return le.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])})(w.PureComponent);cy(az,"displayName","Legend");cy(az,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var L4,g7;function yCe(){if(g7)return L4;g7=1;var e=dj();function t(){this.__data__=new e,this.size=0}return L4=t,L4}var O4,v7;function xCe(){if(v7)return O4;v7=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return O4=e,O4}var I4,b7;function wCe(){if(b7)return I4;b7=1;function e(t){return this.__data__.get(t)}return I4=e,I4}var R4,y7;function SCe(){if(y7)return R4;y7=1;function e(t){return this.__data__.has(t)}return R4=e,R4}var P4,x7;function kCe(){if(x7)return P4;x7=1;var e=dj(),t=V6(),r=Y6(),n=200;function a(i,s){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([i,s]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(i,s),this.size=l.size,this}return P4=a,P4}var z4,w7;function vse(){if(w7)return z4;w7=1;var e=dj(),t=yCe(),r=xCe(),n=wCe(),a=SCe(),i=kCe();function s(l){var c=this.__data__=new e(l);this.size=c.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=a,s.prototype.set=i,z4=s,z4}var B4,S7;function _Ce(){if(S7)return B4;S7=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return B4=t,B4}var $4,k7;function NCe(){if(k7)return $4;k7=1;function e(t){return this.__data__.has(t)}return $4=e,$4}var F4,_7;function bse(){if(_7)return F4;_7=1;var e=Y6(),t=_Ce(),r=NCe();function n(a){var i=-1,s=a==null?0:a.length;for(this.__data__=new e;++i<s;)this.add(a[i])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,F4=n,F4}var U4,N7;function yse(){if(N7)return U4;N7=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return U4=e,U4}var H4,C7;function xse(){if(C7)return H4;C7=1;function e(t,r){return t.has(r)}return H4=e,H4}var q4,j7;function wse(){if(j7)return q4;j7=1;var e=bse(),t=yse(),r=xse(),n=1,a=2;function i(s,l,c,u,d,f){var m=c&n,p=s.length,v=l.length;if(p!=v&&!(m&&v>p))return!1;var b=f.get(s),y=f.get(l);if(b&&y)return b==l&&y==s;var S=-1,_=!0,N=c&a?new e:void 0;for(f.set(s,l),f.set(l,s);++S<p;){var k=s[S],j=l[S];if(u)var E=m?u(j,k,S,l,s,f):u(k,j,S,s,l,f);if(E!==void 0){if(E)continue;_=!1;break}if(N){if(!t(l,function(T,O){if(!r(N,O)&&(k===T||d(k,T,c,u,f)))return N.push(O)})){_=!1;break}}else if(!(k===j||d(k,j,c,u,f))){_=!1;break}}return f.delete(s),f.delete(l),_}return q4=i,q4}var W4,E7;function CCe(){if(E7)return W4;E7=1;var e=Ul(),t=e.Uint8Array;return W4=t,W4}var K4,M7;function jCe(){if(M7)return K4;M7=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,i){n[++r]=[i,a]}),n}return K4=e,K4}var G4,T7;function iz(){if(T7)return G4;T7=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return G4=e,G4}var V4,A7;function ECe(){if(A7)return V4;A7=1;var e=$x(),t=CCe(),r=G6(),n=wse(),a=jCe(),i=iz(),s=1,l=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",m="[object Number]",p="[object RegExp]",v="[object Set]",b="[object String]",y="[object Symbol]",S="[object ArrayBuffer]",_="[object DataView]",N=e?e.prototype:void 0,k=N?N.valueOf:void 0;function j(E,T,O,R,q,$,L){switch(O){case _:if(E.byteLength!=T.byteLength||E.byteOffset!=T.byteOffset)return!1;E=E.buffer,T=T.buffer;case S:return!(E.byteLength!=T.byteLength||!$(new t(E),new t(T)));case c:case u:case m:return r(+E,+T);case d:return E.name==T.name&&E.message==T.message;case p:case b:return E==T+"";case f:var A=a;case v:var M=R&s;if(A||(A=i),E.size!=T.size&&!M)return!1;var z=L.get(E);if(z)return z==T;R|=l,L.set(E,T);var I=n(A(E),A(T),R,q,$,L);return L.delete(E),I;case y:if(k)return k.call(E)==k.call(T)}return!1}return V4=j,V4}var Y4,D7;function Sse(){if(D7)return Y4;D7=1;function e(t,r){for(var n=-1,a=r.length,i=t.length;++n<a;)t[i+n]=r[n];return t}return Y4=e,Y4}var Q4,L7;function MCe(){if(L7)return Q4;L7=1;var e=Sse(),t=ls();function r(n,a,i){var s=a(n);return t(n)?s:e(s,i(n))}return Q4=r,Q4}var J4,O7;function TCe(){if(O7)return J4;O7=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,i=0,s=[];++n<a;){var l=t[n];r(l,n,t)&&(s[i++]=l)}return s}return J4=e,J4}var Z4,I7;function ACe(){if(I7)return Z4;I7=1;function e(){return[]}return Z4=e,Z4}var X4,R7;function DCe(){if(R7)return X4;R7=1;var e=TCe(),t=ACe(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(s){return s==null?[]:(s=Object(s),e(a(s),function(l){return n.call(s,l)}))}:t;return X4=i,X4}var e3,P7;function LCe(){if(P7)return e3;P7=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return e3=e,e3}var t3,z7;function OCe(){if(z7)return t3;z7=1;var e=fu(),t=hu(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return t3=n,t3}var r3,B7;function sz(){if(B7)return r3;B7=1;var e=OCe(),t=hu(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,i=e((function(){return arguments})())?e:function(s){return t(s)&&n.call(s,"callee")&&!a.call(s,"callee")};return r3=i,r3}var cb={exports:{}},n3,$7;function ICe(){if($7)return n3;$7=1;function e(){return!1}return n3=e,n3}cb.exports;var F7;function kse(){return F7||(F7=1,(function(e,t){var r=Ul(),n=ICe(),a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,l=s?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(cb,cb.exports)),cb.exports}var a3,U7;function oz(){if(U7)return a3;U7=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var i=typeof n;return a=a??e,!!a&&(i=="number"||i!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return a3=r,a3}var i3,H7;function lz(){if(H7)return i3;H7=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return i3=t,i3}var s3,q7;function RCe(){if(q7)return s3;q7=1;var e=fu(),t=lz(),r=hu(),n="[object Arguments]",a="[object Array]",i="[object Boolean]",s="[object Date]",l="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",m="[object RegExp]",p="[object Set]",v="[object String]",b="[object WeakMap]",y="[object ArrayBuffer]",S="[object DataView]",_="[object Float32Array]",N="[object Float64Array]",k="[object Int8Array]",j="[object Int16Array]",E="[object Int32Array]",T="[object Uint8Array]",O="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",$={};$[_]=$[N]=$[k]=$[j]=$[E]=$[T]=$[O]=$[R]=$[q]=!0,$[n]=$[a]=$[y]=$[i]=$[S]=$[s]=$[l]=$[c]=$[u]=$[d]=$[f]=$[m]=$[p]=$[v]=$[b]=!1;function L(A){return r(A)&&t(A.length)&&!!$[e(A)]}return s3=L,s3}var o3,W7;function _se(){if(W7)return o3;W7=1;function e(t){return function(r){return t(r)}}return o3=e,o3}var ub={exports:{}};ub.exports;var K7;function PCe(){return K7||(K7=1,(function(e,t){var r=qie(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,l=(function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}})();e.exports=l})(ub,ub.exports)),ub.exports}var l3,G7;function Nse(){if(G7)return l3;G7=1;var e=RCe(),t=_se(),r=PCe(),n=r&&r.isTypedArray,a=n?t(n):e;return l3=a,l3}var c3,V7;function zCe(){if(V7)return c3;V7=1;var e=LCe(),t=sz(),r=ls(),n=kse(),a=oz(),i=Nse(),s=Object.prototype,l=s.hasOwnProperty;function c(u,d){var f=r(u),m=!f&&t(u),p=!f&&!m&&n(u),v=!f&&!m&&!p&&i(u),b=f||m||p||v,y=b?e(u.length,String):[],S=y.length;for(var _ in u)(d||l.call(u,_))&&!(b&&(_=="length"||p&&(_=="offset"||_=="parent")||v&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||a(_,S)))&&y.push(_);return y}return c3=c,c3}var u3,Y7;function BCe(){if(Y7)return u3;Y7=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return u3=t,u3}var d3,Q7;function Cse(){if(Q7)return d3;Q7=1;function e(t,r){return function(n){return t(r(n))}}return d3=e,d3}var f3,J7;function $Ce(){if(J7)return f3;J7=1;var e=Cse(),t=e(Object.keys,Object);return f3=t,f3}var h3,Z7;function FCe(){if(Z7)return h3;Z7=1;var e=BCe(),t=$Ce(),r=Object.prototype,n=r.hasOwnProperty;function a(i){if(!e(i))return t(i);var s=[];for(var l in Object(i))n.call(i,l)&&l!="constructor"&&s.push(l);return s}return h3=a,h3}var m3,X7;function Ux(){if(X7)return m3;X7=1;var e=K6(),t=lz();function r(n){return n!=null&&t(n.length)&&!e(n)}return m3=r,m3}var p3,eW;function bj(){if(eW)return p3;eW=1;var e=zCe(),t=FCe(),r=Ux();function n(a){return r(a)?e(a):t(a)}return p3=n,p3}var g3,tW;function UCe(){if(tW)return g3;tW=1;var e=MCe(),t=DCe(),r=bj();function n(a){return e(a,r,t)}return g3=n,g3}var v3,rW;function HCe(){if(rW)return v3;rW=1;var e=UCe(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(i,s,l,c,u,d){var f=l&t,m=e(i),p=m.length,v=e(s),b=v.length;if(p!=b&&!f)return!1;for(var y=p;y--;){var S=m[y];if(!(f?S in s:n.call(s,S)))return!1}var _=d.get(i),N=d.get(s);if(_&&N)return _==s&&N==i;var k=!0;d.set(i,s),d.set(s,i);for(var j=f;++y<p;){S=m[y];var E=i[S],T=s[S];if(c)var O=f?c(T,E,S,s,i,d):c(E,T,S,i,s,d);if(!(O===void 0?E===T||u(E,T,l,c,d):O)){k=!1;break}j||(j=S=="constructor")}if(k&&!j){var R=i.constructor,q=s.constructor;R!=q&&"constructor"in i&&"constructor"in s&&!(typeof R=="function"&&R instanceof R&&typeof q=="function"&&q instanceof q)&&(k=!1)}return d.delete(i),d.delete(s),k}return v3=a,v3}var b3,nW;function qCe(){if(nW)return b3;nW=1;var e=Wh(),t=Ul(),r=e(t,"DataView");return b3=r,b3}var y3,aW;function WCe(){if(aW)return y3;aW=1;var e=Wh(),t=Ul(),r=e(t,"Promise");return y3=r,y3}var x3,iW;function jse(){if(iW)return x3;iW=1;var e=Wh(),t=Ul(),r=e(t,"Set");return x3=r,x3}var w3,sW;function KCe(){if(sW)return w3;sW=1;var e=Wh(),t=Ul(),r=e(t,"WeakMap");return w3=r,w3}var S3,oW;function GCe(){if(oW)return S3;oW=1;var e=qCe(),t=V6(),r=WCe(),n=jse(),a=KCe(),i=fu(),s=Wie(),l="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",m="[object DataView]",p=s(e),v=s(t),b=s(r),y=s(n),S=s(a),_=i;return(e&&_(new e(new ArrayBuffer(1)))!=m||t&&_(new t)!=l||r&&_(r.resolve())!=u||n&&_(new n)!=d||a&&_(new a)!=f)&&(_=function(N){var k=i(N),j=k==c?N.constructor:void 0,E=j?s(j):"";if(E)switch(E){case p:return m;case v:return l;case b:return u;case y:return d;case S:return f}return k}),S3=_,S3}var k3,lW;function VCe(){if(lW)return k3;lW=1;var e=vse(),t=wse(),r=ECe(),n=HCe(),a=GCe(),i=ls(),s=kse(),l=Nse(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",m=Object.prototype,p=m.hasOwnProperty;function v(b,y,S,_,N,k){var j=i(b),E=i(y),T=j?d:a(b),O=E?d:a(y);T=T==u?f:T,O=O==u?f:O;var R=T==f,q=O==f,$=T==O;if($&&s(b)){if(!s(y))return!1;j=!0,R=!1}if($&&!R)return k||(k=new e),j||l(b)?t(b,y,S,_,N,k):r(b,y,T,S,_,N,k);if(!(S&c)){var L=R&&p.call(b,"__wrapped__"),A=q&&p.call(y,"__wrapped__");if(L||A){var M=L?b.value():b,z=A?y.value():y;return k||(k=new e),N(M,z,S,_,k)}}return $?(k||(k=new e),n(b,y,S,_,N,k)):!1}return k3=v,k3}var _3,cW;function cz(){if(cW)return _3;cW=1;var e=VCe(),t=hu();function r(n,a,i,s,l){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,i,s,r,l)}return _3=r,_3}var N3,uW;function YCe(){if(uW)return N3;uW=1;var e=vse(),t=cz(),r=1,n=2;function a(i,s,l,c){var u=l.length,d=u,f=!c;if(i==null)return!d;for(i=Object(i);u--;){var m=l[u];if(f&&m[2]?m[1]!==i[m[0]]:!(m[0]in i))return!1}for(;++u<d;){m=l[u];var p=m[0],v=i[p],b=m[1];if(f&&m[2]){if(v===void 0&&!(p in i))return!1}else{var y=new e;if(c)var S=c(v,b,p,i,s,y);if(!(S===void 0?t(b,v,r|n,c,y):S))return!1}}return!0}return N3=a,N3}var C3,dW;function Ese(){if(dW)return C3;dW=1;var e=Bd();function t(r){return r===r&&!e(r)}return C3=t,C3}var j3,fW;function QCe(){if(fW)return j3;fW=1;var e=Ese(),t=bj();function r(n){for(var a=t(n),i=a.length;i--;){var s=a[i],l=n[s];a[i]=[s,l,e(l)]}return a}return j3=r,j3}var E3,hW;function Mse(){if(hW)return E3;hW=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return E3=e,E3}var M3,mW;function JCe(){if(mW)return M3;mW=1;var e=YCe(),t=QCe(),r=Mse();function n(a){var i=t(a);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(s){return s===a||e(s,a,i)}}return M3=n,M3}var T3,pW;function ZCe(){if(pW)return T3;pW=1;function e(t,r){return t!=null&&r in Object(t)}return T3=e,T3}var A3,gW;function XCe(){if(gW)return A3;gW=1;var e=Vie(),t=sz(),r=ls(),n=oz(),a=lz(),i=hj();function s(l,c,u){c=e(c,l);for(var d=-1,f=c.length,m=!1;++d<f;){var p=i(c[d]);if(!(m=l!=null&&u(l,p)))break;l=l[p]}return m||++d!=f?m:(f=l==null?0:l.length,!!f&&a(f)&&n(p,f)&&(r(l)||t(l)))}return A3=s,A3}var D3,vW;function eje(){if(vW)return D3;vW=1;var e=ZCe(),t=XCe();function r(n,a){return n!=null&&t(n,a,e)}return D3=r,D3}var L3,bW;function tje(){if(bW)return L3;bW=1;var e=cz(),t=Yie(),r=eje(),n=W6(),a=Ese(),i=Mse(),s=hj(),l=1,c=2;function u(d,f){return n(d)&&a(f)?i(s(d),f):function(m){var p=t(m,d);return p===void 0&&p===f?r(m,d):e(f,p,l|c)}}return L3=u,L3}var O3,yW;function c0(){if(yW)return O3;yW=1;function e(t){return t}return O3=e,O3}var I3,xW;function rje(){if(xW)return I3;xW=1;function e(t){return function(r){return r?.[t]}}return I3=e,I3}var R3,wW;function nje(){if(wW)return R3;wW=1;var e=J6();function t(r){return function(n){return e(n,r)}}return R3=t,R3}var P3,SW;function aje(){if(SW)return P3;SW=1;var e=rje(),t=nje(),r=W6(),n=hj();function a(i){return r(i)?e(n(i)):t(i)}return P3=a,P3}var z3,kW;function Hl(){if(kW)return z3;kW=1;var e=JCe(),t=tje(),r=c0(),n=ls(),a=aje();function i(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?t(s[0],s[1]):e(s):a(s)}return z3=i,z3}var B3,_W;function Tse(){if(_W)return B3;_W=1;function e(t,r,n,a){for(var i=t.length,s=n+(a?1:-1);a?s--:++s<i;)if(r(t[s],s,t))return s;return-1}return B3=e,B3}var $3,NW;function ije(){if(NW)return $3;NW=1;function e(t){return t!==t}return $3=e,$3}var F3,CW;function sje(){if(CW)return F3;CW=1;function e(t,r,n){for(var a=n-1,i=t.length;++a<i;)if(t[a]===r)return a;return-1}return F3=e,F3}var U3,jW;function oje(){if(jW)return U3;jW=1;var e=Tse(),t=ije(),r=sje();function n(a,i,s){return i===i?r(a,i,s):e(a,t,s)}return U3=n,U3}var H3,EW;function lje(){if(EW)return H3;EW=1;var e=oje();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return H3=t,H3}var q3,MW;function cje(){if(MW)return q3;MW=1;function e(t,r,n){for(var a=-1,i=t==null?0:t.length;++a<i;)if(n(r,t[a]))return!0;return!1}return q3=e,q3}var W3,TW;function uje(){if(TW)return W3;TW=1;function e(){}return W3=e,W3}var K3,AW;function dje(){if(AW)return K3;AW=1;var e=jse(),t=uje(),r=iz(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(i){return new e(i)}:t;return K3=a,K3}var G3,DW;function fje(){if(DW)return G3;DW=1;var e=bse(),t=lje(),r=cje(),n=xse(),a=dje(),i=iz(),s=200;function l(c,u,d){var f=-1,m=t,p=c.length,v=!0,b=[],y=b;if(d)v=!1,m=r;else if(p>=s){var S=u?null:a(c);if(S)return i(S);v=!1,m=n,y=new e}else y=u?[]:b;e:for(;++f<p;){var _=c[f],N=u?u(_):_;if(_=d||_!==0?_:0,v&&N===N){for(var k=y.length;k--;)if(y[k]===N)continue e;u&&y.push(N),b.push(_)}else m(y,N,d)||(y!==b&&y.push(N),b.push(_))}return b}return G3=l,G3}var V3,LW;function hje(){if(LW)return V3;LW=1;var e=Hl(),t=fje();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return V3=r,V3}var mje=hje();const OW=Fr(mje);function Ase(e,t,r){return t===!0?OW(e,r):Jt(t)?OW(e,t):e}function Xp(e){"@babel/helpers - typeof";return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(e)}var pje=["ref"];function IW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IW(Object(r),!0).forEach(function(n){yj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lse(n.key),n)}}function vje(e,t,r){return t&&RW(e.prototype,t),r&&RW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bje(e,t,r){return t=c_(t),yje(e,Dse()?Reflect.construct(t,r||[],c_(e).constructor):t.apply(e,r))}function yje(e,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xje(e)}function xje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dse=function(){return!!e})()}function c_(e){return c_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c_(e)}function wje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},VO(e,t)}function yj(e,t,r){return t=Lse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lse(e){var t=Sje(e,"string");return Xp(t)=="symbol"?t:t+""}function Sje(e,t){if(Xp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function kje(e,t){if(e==null)return{};var r=_je(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _je(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Nje(e){return e.value}function Cje(e,t){if(le.isValidElement(e))return le.cloneElement(e,t);if(typeof e=="function")return le.createElement(e,t);t.ref;var r=kje(t,pje);return le.createElement(az,r)}var PW=1,Ip=(function(e){function t(){var r;gje(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=bje(this,t,[].concat(a)),yj(r,"lastBoundingBox",{width:-1,height:-1}),r}return wje(t,e),vje(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>PW||Math.abs(a.height-this.lastBoundingBox.height)>PW)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?mc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,l=a.verticalAlign,c=a.margin,u=a.chartWidth,d=a.chartHeight,f,m;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var p=this.getBBoxSnapshot();f={left:((u||0)-p.width)/2}}else f=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();m={top:((d||0)-v.height)/2}}else m=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return mc(mc({},f),m)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,l=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,f=mc(mc({position:"absolute",width:s||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return le.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(p){n.wrapperNode=p}},Cje(i,mc(mc({},this.props),{},{payload:Ase(d,u,Nje)})))}}],[{key:"getWithHeight",value:function(n,a){var i=mc(mc({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&et(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])})(w.PureComponent);yj(Ip,"displayName","Legend");yj(Ip,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Y3,zW;function jje(){if(zW)return Y3;zW=1;var e=$x(),t=sz(),r=ls(),n=e?e.isConcatSpreadable:void 0;function a(i){return r(i)||t(i)||!!(n&&i&&i[n])}return Y3=a,Y3}var Q3,BW;function Ose(){if(BW)return Q3;BW=1;var e=Sse(),t=jje();function r(n,a,i,s,l){var c=-1,u=n.length;for(i||(i=t),l||(l=[]);++c<u;){var d=n[c];a>0&&i(d)?a>1?r(d,a-1,i,s,l):e(l,d):s||(l[l.length]=d)}return l}return Q3=r,Q3}var J3,$W;function Eje(){if($W)return J3;$W=1;function e(t){return function(r,n,a){for(var i=-1,s=Object(r),l=a(r),c=l.length;c--;){var u=l[t?c:++i];if(n(s[u],u,s)===!1)break}return r}}return J3=e,J3}var Z3,FW;function Mje(){if(FW)return Z3;FW=1;var e=Eje(),t=e();return Z3=t,Z3}var X3,UW;function Ise(){if(UW)return X3;UW=1;var e=Mje(),t=bj();function r(n,a){return n&&e(n,a,t)}return X3=r,X3}var eA,HW;function Tje(){if(HW)return eA;HW=1;var e=Ux();function t(r,n){return function(a,i){if(a==null)return a;if(!e(a))return r(a,i);for(var s=a.length,l=n?s:-1,c=Object(a);(n?l--:++l<s)&&i(c[l],l,c)!==!1;);return a}}return eA=t,eA}var tA,qW;function uz(){if(qW)return tA;qW=1;var e=Ise(),t=Tje(),r=t(e);return tA=r,tA}var rA,WW;function Rse(){if(WW)return rA;WW=1;var e=uz(),t=Ux();function r(n,a){var i=-1,s=t(n)?Array(n.length):[];return e(n,function(l,c,u){s[++i]=a(l,c,u)}),s}return rA=r,rA}var nA,KW;function Aje(){if(KW)return nA;KW=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return nA=e,nA}var aA,GW;function Dje(){if(GW)return aA;GW=1;var e=s0();function t(r,n){if(r!==n){var a=r!==void 0,i=r===null,s=r===r,l=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!l&&r>n||l&&c&&d&&!u&&!f||i&&c&&d||!a&&d||!s)return 1;if(!i&&!l&&!f&&r<n||f&&a&&s&&!i&&!l||u&&a&&s||!c&&s||!d)return-1}return 0}return aA=t,aA}var iA,VW;function Lje(){if(VW)return iA;VW=1;var e=Dje();function t(r,n,a){for(var i=-1,s=r.criteria,l=n.criteria,c=s.length,u=a.length;++i<c;){var d=e(s[i],l[i]);if(d){if(i>=u)return d;var f=a[i];return d*(f=="desc"?-1:1)}}return r.index-n.index}return iA=t,iA}var sA,YW;function Oje(){if(YW)return sA;YW=1;var e=Q6(),t=J6(),r=Hl(),n=Rse(),a=Aje(),i=_se(),s=Lje(),l=c0(),c=ls();function u(d,f,m){f.length?f=e(f,function(b){return c(b)?function(y){return t(y,b.length===1?b[0]:b)}:b}):f=[l];var p=-1;f=e(f,i(r));var v=n(d,function(b,y,S){var _=e(f,function(N){return N(b)});return{criteria:_,index:++p,value:b}});return a(v,function(b,y){return s(b,y,m)})}return sA=u,sA}var oA,QW;function Ije(){if(QW)return oA;QW=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return oA=e,oA}var lA,JW;function Rje(){if(JW)return lA;JW=1;var e=Ije(),t=Math.max;function r(n,a,i){return a=t(a===void 0?n.length-1:a,0),function(){for(var s=arguments,l=-1,c=t(s.length-a,0),u=Array(c);++l<c;)u[l]=s[a+l];l=-1;for(var d=Array(a+1);++l<a;)d[l]=s[l];return d[a]=i(u),e(n,this,d)}}return lA=r,lA}var cA,ZW;function Pje(){if(ZW)return cA;ZW=1;function e(t){return function(){return t}}return cA=e,cA}var uA,XW;function Pse(){if(XW)return uA;XW=1;var e=Wh(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return uA=t,uA}var dA,eK;function zje(){if(eK)return dA;eK=1;var e=Pje(),t=Pse(),r=c0(),n=t?function(a,i){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:r;return dA=n,dA}var fA,tK;function Bje(){if(tK)return fA;tK=1;var e=800,t=16,r=Date.now;function n(a){var i=0,s=0;return function(){var l=r(),c=t-(l-s);if(s=l,c>0){if(++i>=e)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return fA=n,fA}var hA,rK;function $je(){if(rK)return hA;rK=1;var e=zje(),t=Bje(),r=t(e);return hA=r,hA}var mA,nK;function Fje(){if(nK)return mA;nK=1;var e=c0(),t=Rje(),r=$je();function n(a,i){return r(t(a,i,e),a+"")}return mA=n,mA}var pA,aK;function xj(){if(aK)return pA;aK=1;var e=G6(),t=Ux(),r=oz(),n=Bd();function a(i,s,l){if(!n(l))return!1;var c=typeof s;return(c=="number"?t(l)&&r(s,l.length):c=="string"&&s in l)?e(l[s],i):!1}return pA=a,pA}var gA,iK;function Uje(){if(iK)return gA;iK=1;var e=Ose(),t=Oje(),r=Fje(),n=xj(),a=r(function(i,s){if(i==null)return[];var l=s.length;return l>1&&n(i,s[0],s[1])?s=[]:l>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),t(i,e(s,1),[])});return gA=a,gA}var Hje=Uje();const dz=Fr(Hje);function uy(e){"@babel/helpers - typeof";return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}function YO(){return YO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YO.apply(this,arguments)}function qje(e,t){return Vje(e)||Gje(e,t)||Kje(e,t)||Wje()}function Wje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kje(e,t){if(e){if(typeof e=="string")return sK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sK(e,t)}}function sK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Vje(e){if(Array.isArray(e))return e}function oK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oK(Object(r),!0).forEach(function(n){Yje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yje(e,t,r){return t=Qje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qje(e){var t=Jje(e,"string");return uy(t)=="symbol"?t:t+""}function Jje(e,t){if(uy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(uy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zje(e){return Array.isArray(e)&&ja(e[0])&&ja(e[1])?e.join(" ~ "):e}var Xje=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,l=s===void 0?{}:s,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,f=t.formatter,m=t.itemSorter,p=t.wrapperClassName,v=t.labelClassName,b=t.label,y=t.labelFormatter,S=t.accessibilityLayer,_=S===void 0?!1:S,N=function(){if(d&&d.length){var L={padding:0,margin:0},A=(m?dz(d,m):d).map(function(M,z){if(M.type==="none")return null;var I=vA({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},l),B=M.formatter||f||Zje,F=M.value,U=M.name,V=F,K=U;if(B&&V!=null&&K!=null){var G=B(F,U,M,z,d);if(Array.isArray(G)){var J=qje(G,2);V=J[0],K=J[1]}else V=G}return le.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:I},ja(K)?le.createElement("span",{className:"recharts-tooltip-item-name"},K):null,ja(K)?le.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,le.createElement("span",{className:"recharts-tooltip-item-value"},V),le.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return le.createElement("ul",{className:"recharts-tooltip-item-list",style:L},A)}return null},k=vA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),j=vA({margin:0},u),E=!tr(b),T=E?b:"",O=ur("recharts-default-tooltip",p),R=ur("recharts-tooltip-label",v);E&&y&&d!==void 0&&d!==null&&(T=y(b,d));var q=_?{role:"status","aria-live":"assertive"}:{};return le.createElement("div",YO({className:O,style:k},q),le.createElement("p",{className:R,style:j},le.isValidElement(T)?T:"".concat(T)),N())};function dy(e){"@babel/helpers - typeof";return dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dy(e)}function Vw(e,t,r){return t=e2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e2e(e){var t=t2e(e,"string");return dy(t)=="symbol"?t:t+""}function t2e(e,t){if(dy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(dy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bv="recharts-tooltip-wrapper",r2e={visibility:"hidden"};function n2e(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ur(bv,Vw(Vw(Vw(Vw({},"".concat(bv,"-right"),et(r)&&t&&et(t.x)&&r>=t.x),"".concat(bv,"-left"),et(r)&&t&&et(t.x)&&r<t.x),"".concat(bv,"-bottom"),et(n)&&t&&et(t.y)&&n>=t.y),"".concat(bv,"-top"),et(n)&&t&&et(t.y)&&n<t.y))}function lK(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&et(i[n]))return i[n];var d=r[n]-l-a,f=r[n]+a;if(t[n])return s[n]?d:f;if(s[n]){var m=d,p=c[n];return m<p?Math.max(f,c[n]):Math.max(d,c[n])}var v=f+l,b=c[n]+u;return v>b?Math.max(d,c[n]):Math.max(f,c[n])}function a2e(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function i2e(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,u,d,f;return s.height>0&&s.width>0&&r?(d=lK({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=lK({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=a2e({translateX:d,translateY:f,useTranslate3d:l})):u=r2e,{cssProperties:u,cssClasses:n2e({translateX:d,translateY:f,coordinate:r})}}function eg(e){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}function cK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cK(Object(r),!0).forEach(function(n){JO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bse(n.key),n)}}function l2e(e,t,r){return t&&o2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function c2e(e,t,r){return t=u_(t),u2e(e,zse()?Reflect.construct(t,r||[],u_(e).constructor):t.apply(e,r))}function u2e(e,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d2e(e)}function d2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zse(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zse=function(){return!!e})()}function u_(e){return u_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},u_(e)}function f2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QO(e,t)}function JO(e,t,r){return t=Bse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bse(e){var t=h2e(e,"string");return eg(t)=="symbol"?t:t+""}function h2e(e,t){if(eg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(eg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var dK=1,m2e=(function(e){function t(){var r;s2e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=c2e(this,t,[].concat(a)),JO(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),JO(r,"handleKeyDown",function(s){if(s.key==="Escape"){var l,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return f2e(t,e),l2e(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>dK||Math.abs(n.height-this.state.lastBoundingBox.height)>dK)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.children,d=a.coordinate,f=a.hasPayload,m=a.isAnimationActive,p=a.offset,v=a.position,b=a.reverseDirection,y=a.useTranslate3d,S=a.viewBox,_=a.wrapperStyle,N=i2e({allowEscapeViewBox:s,coordinate:d,offsetTopLeft:p,position:v,reverseDirection:b,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:S}),k=N.cssClasses,j=N.cssProperties,E=uK(uK({transition:m&&i?"transform ".concat(l,"ms ").concat(c):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},_);return le.createElement("div",{tabIndex:-1,className:k,style:E,ref:function(O){n.wrapperNode=O}},u)}}])})(w.PureComponent),p2e=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Kh={isSsr:p2e()};function tg(e){"@babel/helpers - typeof";return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(e)}function fK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fK(Object(r),!0).forEach(function(n){fz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fse(n.key),n)}}function b2e(e,t,r){return t&&v2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function y2e(e,t,r){return t=d_(t),x2e(e,$se()?Reflect.construct(t,r||[],d_(e).constructor):t.apply(e,r))}function x2e(e,t){if(t&&(tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w2e(e)}function w2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($se=function(){return!!e})()}function d_(e){return d_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d_(e)}function S2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZO(e,t)}function fz(e,t,r){return t=Fse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fse(e){var t=k2e(e,"string");return tg(t)=="symbol"?t:t+""}function k2e(e,t){if(tg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _2e(e){return e.dataKey}function N2e(e,t){return le.isValidElement(e)?le.cloneElement(e,t):typeof e=="function"?le.createElement(e,t):le.createElement(Xje,t)}var Cs=(function(e){function t(){return g2e(this,t),y2e(this,t,arguments)}return S2e(t,e),b2e(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.content,d=a.coordinate,f=a.filterNull,m=a.isAnimationActive,p=a.offset,v=a.payload,b=a.payloadUniqBy,y=a.position,S=a.reverseDirection,_=a.useTranslate3d,N=a.viewBox,k=a.wrapperStyle,j=v??[];f&&j.length&&(j=Ase(v.filter(function(T){return T.value!=null&&(T.hide!==!0||n.props.includeHidden)}),b,_2e));var E=j.length>0;return le.createElement(m2e,{allowEscapeViewBox:s,animationDuration:l,animationEasing:c,isAnimationActive:m,active:i,coordinate:d,hasPayload:E,offset:p,position:y,reverseDirection:S,useTranslate3d:_,viewBox:N,wrapperStyle:k},N2e(u,hK(hK({},this.props),{},{payload:j})))}}])})(w.PureComponent);fz(Cs,"displayName","Tooltip");fz(Cs,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Kh.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var bA,mK;function C2e(){if(mK)return bA;mK=1;var e=Ul(),t=function(){return e.Date.now()};return bA=t,bA}var yA,pK;function j2e(){if(pK)return yA;pK=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return yA=t,yA}var xA,gK;function E2e(){if(gK)return xA;gK=1;var e=j2e(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return xA=r,xA}var wA,vK;function Use(){if(vK)return wA;vK=1;var e=E2e(),t=Bd(),r=s0(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=i.test(u);return f||s.test(u)?l(u.slice(2),f?2:8):a.test(u)?n:+u}return wA=c,wA}var SA,bK;function M2e(){if(bK)return SA;bK=1;var e=Bd(),t=C2e(),r=Use(),n="Expected a function",a=Math.max,i=Math.min;function s(l,c,u){var d,f,m,p,v,b,y=0,S=!1,_=!1,N=!0;if(typeof l!="function")throw new TypeError(n);c=r(c)||0,e(u)&&(S=!!u.leading,_="maxWait"in u,m=_?a(r(u.maxWait)||0,c):m,N="trailing"in u?!!u.trailing:N);function k(A){var M=d,z=f;return d=f=void 0,y=A,p=l.apply(z,M),p}function j(A){return y=A,v=setTimeout(O,c),S?k(A):p}function E(A){var M=A-b,z=A-y,I=c-M;return _?i(I,m-z):I}function T(A){var M=A-b,z=A-y;return b===void 0||M>=c||M<0||_&&z>=m}function O(){var A=t();if(T(A))return R(A);v=setTimeout(O,E(A))}function R(A){return v=void 0,N&&d?k(A):(d=f=void 0,p)}function q(){v!==void 0&&clearTimeout(v),y=0,d=b=f=v=void 0}function $(){return v===void 0?p:R(t())}function L(){var A=t(),M=T(A);if(d=arguments,f=this,b=A,M){if(v===void 0)return j(b);if(_)return clearTimeout(v),v=setTimeout(O,c),k(b)}return v===void 0&&(v=setTimeout(O,c)),p}return L.cancel=q,L.flush=$,L}return SA=s,SA}var kA,yK;function T2e(){if(yK)return kA;yK=1;var e=M2e(),t=Bd(),r="Expected a function";function n(a,i,s){var l=!0,c=!0;if(typeof a!="function")throw new TypeError(r);return t(s)&&(l="leading"in s?!!s.leading:l,c="trailing"in s?!!s.trailing:c),e(a,i,{leading:l,maxWait:i,trailing:c})}return kA=n,kA}var A2e=T2e();const Hse=Fr(A2e);function fy(e){"@babel/helpers - typeof";return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fy(e)}function xK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xK(Object(r),!0).forEach(function(n){D2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D2e(e,t,r){return t=L2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2e(e){var t=O2e(e,"string");return fy(t)=="symbol"?t:t+""}function O2e(e,t){if(fy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I2e(e,t){return B2e(e)||z2e(e,t)||P2e(e,t)||R2e()}function R2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P2e(e,t){if(e){if(typeof e=="string")return wK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wK(e,t)}}function wK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function B2e(e){if(Array.isArray(e))return e}var wj=w.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,m=e.maxHeight,p=e.children,v=e.debounce,b=v===void 0?0:v,y=e.id,S=e.className,_=e.onResize,N=e.style,k=N===void 0?{}:N,j=w.useRef(null),E=w.useRef();E.current=_,w.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var T=w.useState({containerWidth:a.width,containerHeight:a.height}),O=I2e(T,2),R=O[0],q=O[1],$=w.useCallback(function(A,M){q(function(z){var I=Math.round(A),B=Math.round(M);return z.containerWidth===I&&z.containerHeight===B?z:{containerWidth:I,containerHeight:B}})},[]);w.useEffect(function(){var A=function(U){var V,K=U[0].contentRect,G=K.width,J=K.height;$(G,J),(V=E.current)===null||V===void 0||V.call(E,G,J)};b>0&&(A=Hse(A,b,{trailing:!0,leading:!1}));var M=new ResizeObserver(A),z=j.current.getBoundingClientRect(),I=z.width,B=z.height;return $(I,B),M.observe(j.current),function(){M.disconnect()}},[$,b]);var L=w.useMemo(function(){var A=R.containerWidth,M=R.containerHeight;if(A<0||M<0)return null;Qo(qf(s)||qf(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),Qo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var z=qf(s)?A:s,I=qf(c)?M:c;r&&r>0&&(z?I=z/r:I&&(z=I*r),m&&I>m&&(I=m)),Qo(z>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,z,I,s,c,d,f,r);var B=!Array.isArray(p)&&Yc(p.type).endsWith("Chart");return le.Children.map(p,function(F){return le.isValidElement(F)?w.cloneElement(F,Yw({width:z,height:I},B?{style:Yw({height:"100%",width:"100%",maxHeight:I,maxWidth:z},F.props.style)}:{})):F})},[r,p,c,m,f,d,R,s]);return le.createElement("div",{id:y?"".concat(y):void 0,className:ur("recharts-responsive-container",S),style:Yw(Yw({},k),{},{width:s,height:c,minWidth:d,minHeight:f,maxHeight:m}),ref:j},L)}),Hx=function(t){return null};Hx.displayName="Cell";function hy(e){"@babel/helpers - typeof";return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}function SK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function XO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SK(Object(r),!0).forEach(function(n){$2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $2e(e,t,r){return t=F2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F2e(e){var t=U2e(e,"string");return hy(t)=="symbol"?t:t+""}function U2e(e,t){if(hy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ym={widthCache:{},cacheCount:0},H2e=2e3,q2e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},kK="recharts_measurement_span";function W2e(e){var t=XO({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var jb=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Kh.isSsr)return{width:0,height:0};var n=W2e(r),a=JSON.stringify({text:t,copyStyle:n});if(Ym.widthCache[a])return Ym.widthCache[a];try{var i=document.getElementById(kK);i||(i=document.createElement("span"),i.setAttribute("id",kK),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=XO(XO({},q2e),n);Object.assign(i.style,s),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Ym.widthCache[a]=c,++Ym.cacheCount>H2e&&(Ym.cacheCount=0,Ym.widthCache={}),c}catch{return{width:0,height:0}}},K2e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function my(e){"@babel/helpers - typeof";return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function f_(e,t){return Q2e(e)||Y2e(e,t)||V2e(e,t)||G2e()}function G2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V2e(e,t){if(e){if(typeof e=="string")return _K(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _K(e,t)}}function _K(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Q2e(e){if(Array.isArray(e))return e}function J2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X2e(n.key),n)}}function Z2e(e,t,r){return t&&NK(e.prototype,t),r&&NK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X2e(e){var t=eEe(e,"string");return my(t)=="symbol"?t:t+""}function eEe(e,t){if(my(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(my(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var CK=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,jK=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,tEe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,rEe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,qse={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},nEe=Object.keys(qse),kp="NaN";function aEe(e,t){return e*qse[t]}var Qw=(function(){function e(t,r){J2e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!tEe.test(r)&&(this.num=NaN,this.unit=""),nEe.includes(r)&&(this.num=aEe(t,r),this.unit="px")}return Z2e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=rEe.exec(r))!==null&&n!==void 0?n:[],i=f_(a,3),s=i[1],l=i[2];return new e(parseFloat(s),l??"")}}])})();function Wse(e){if(e.includes(kp))return kp;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=CK.exec(t))!==null&&r!==void 0?r:[],a=f_(n,4),i=a[1],s=a[2],l=a[3],c=Qw.parse(i??""),u=Qw.parse(l??""),d=s==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return kp;t=t.replace(CK,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,m=(f=jK.exec(t))!==null&&f!==void 0?f:[],p=f_(m,4),v=p[1],b=p[2],y=p[3],S=Qw.parse(v??""),_=Qw.parse(y??""),N=b==="+"?S.add(_):S.subtract(_);if(N.isNaN())return kp;t=t.replace(jK,N.toString())}return t}var EK=/\(([^()]*)\)/;function iEe(e){for(var t=e;t.includes("(");){var r=EK.exec(t),n=f_(r,2),a=n[1];t=t.replace(EK,Wse(a))}return t}function sEe(e){var t=e.replace(/\s+/g,"");return t=iEe(t),t=Wse(t),t}function oEe(e){try{return sEe(e)}catch{return kp}}function _A(e){var t=oEe(e.slice(5,-1));return t===kp?"":t}var lEe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],cEe=["dx","dy","angle","className","breakAll"];function eI(){return eI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eI.apply(this,arguments)}function MK(e,t){if(e==null)return{};var r=uEe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TK(e,t){return mEe(e)||hEe(e,t)||fEe(e,t)||dEe()}function dEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fEe(e,t){if(e){if(typeof e=="string")return AK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AK(e,t)}}function AK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function mEe(e){if(Array.isArray(e))return e}var Kse=/[ \f\n\r\t\v\u2028\u2029]+/,Gse=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];tr(r)||(n?i=r.toString().split(""):i=r.toString().split(Kse));var s=i.map(function(c){return{word:c,width:jb(c,a).width}}),l=n?0:jb("",a).width;return{wordsWithComputedWidth:s,spaceWidth:l}}catch{return null}},pEe=function(t,r,n,a,i){var s=t.maxLines,l=t.children,c=t.style,u=t.breakAll,d=et(s),f=l,m=function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return z.reduce(function(I,B){var F=B.word,U=B.width,V=I[I.length-1];if(V&&(a==null||i||V.width+U+n<Number(a)))V.words.push(F),V.width+=U+n;else{var K={words:[F],width:U};I.push(K)}return I},[])},p=m(r),v=function(z){return z.reduce(function(I,B){return I.width>B.width?I:B})};if(!d)return p;for(var b="",y=function(z){var I=f.slice(0,z),B=Gse({breakAll:u,style:c,children:I+b}).wordsWithComputedWidth,F=m(B),U=F.length>s||v(F).width>Number(a);return[U,F]},S=0,_=f.length-1,N=0,k;S<=_&&N<=f.length-1;){var j=Math.floor((S+_)/2),E=j-1,T=y(E),O=TK(T,2),R=O[0],q=O[1],$=y(j),L=TK($,1),A=L[0];if(!R&&!A&&(S=j+1),R&&A&&(_=j-1),!R&&A){k=q;break}N++}return k||p},DK=function(t){var r=tr(t)?[]:t.toString().split(Kse);return[{words:r}]},gEe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,l=t.maxLines;if((r||n)&&!Kh.isSsr){var c,u,d=Gse({breakAll:s,children:a,style:i});if(d){var f=d.wordsWithComputedWidth,m=d.spaceWidth;c=f,u=m}else return DK(a);return pEe({breakAll:s,children:a,maxLines:l,style:i},c,u,r,n)}return DK(a)},LK="#808080",wh=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,l=s===void 0?"1em":s,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,f=d===void 0?!1:d,m=t.textAnchor,p=m===void 0?"start":m,v=t.verticalAnchor,b=v===void 0?"end":v,y=t.fill,S=y===void 0?LK:y,_=MK(t,lEe),N=w.useMemo(function(){return gEe({breakAll:_.breakAll,children:_.children,maxLines:_.maxLines,scaleToFit:f,style:_.style,width:_.width})},[_.breakAll,_.children,_.maxLines,f,_.style,_.width]),k=_.dx,j=_.dy,E=_.angle,T=_.className,O=_.breakAll,R=MK(_,cEe);if(!ja(n)||!ja(i))return null;var q=n+(et(k)?k:0),$=i+(et(j)?j:0),L;switch(b){case"start":L=_A("calc(".concat(u,")"));break;case"middle":L=_A("calc(".concat((N.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:L=_A("calc(".concat(N.length-1," * -").concat(l,")"));break}var A=[];if(f){var M=N[0].width,z=_.width;A.push("scale(".concat((et(z)?z/M:1)/M,")"))}return E&&A.push("rotate(".concat(E,", ").concat(q,", ").concat($,")")),A.length&&(R.transform=A.join(" ")),le.createElement("text",eI({},Ut(R,!0),{x:q,y:$,className:ur("recharts-text",T),textAnchor:p,fill:S.includes("url")?LK:S}),N.map(function(I,B){var F=I.words.join(O?"":" ");return le.createElement("tspan",{x:q,dy:B===0?L:l,key:"".concat(F,"-").concat(B)},F)}))};function _d(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function vEe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hz(e){let t,r,n;e.length!==2?(t=_d,r=(l,c)=>_d(e(l),c),n=(l,c)=>e(l)-c):(t=e===_d||e===vEe?e:bEe,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function bEe(){return 0}function Vse(e){return e===null?NaN:+e}function*yEe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const xEe=hz(_d),qx=xEe.right;hz(Vse).center;class OK extends Map{constructor(t,r=kEe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(IK(this,t))}has(t){return super.has(IK(this,t))}set(t,r){return super.set(wEe(this,t),r)}delete(t){return super.delete(SEe(this,t))}}function IK({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function wEe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function SEe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function kEe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function _Ee(e=_d){if(e===_d)return Yse;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function Yse(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const NEe=Math.sqrt(50),CEe=Math.sqrt(10),jEe=Math.sqrt(2);function h_(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=NEe?10:i>=CEe?5:i>=jEe?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/s,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?h_(e,t,r*2):[l,c,u]}function tI(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?h_(t,e,r):h_(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let u=0;u<l;++u)c[u]=(i-u)/-s;else for(let u=0;u<l;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<l;++u)c[u]=(a+u)/-s;else for(let u=0;u<l;++u)c[u]=(a+u)*s;return c}function rI(e,t,r){return t=+t,e=+e,r=+r,h_(e,t,r)[2]}function nI(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?rI(t,e,r):rI(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function RK(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function PK(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Qse(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?Yse:_Ee(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+m)),v=Math.min(n,Math.floor(t+(c-u)*f/c+m));Qse(e,t,p,v,a)}const i=e[t];let s=r,l=n;for(yv(e,r,t),a(e[n],i)>0&&yv(e,r,n);s<l;){for(yv(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?yv(e,r,l):(++l,yv(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function yv(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function EEe(e,t,r){if(e=Float64Array.from(yEe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return PK(e);if(t>=1)return RK(e);var n,a=(n-1)*t,i=Math.floor(a),s=RK(Qse(e,i).subarray(0,i+1)),l=PK(e.subarray(i+1));return s+(l-s)*(a-i)}}function MEe(e,t,r=Vse){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function TEe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Eo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function mu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const aI=Symbol("implicit");function mz(){var e=new OK,t=[],r=[],n=aI;function a(i){let s=e.get(i);if(s===void 0){if(n!==aI)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new OK;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return mz(t,r).unknown(n)},Eo.apply(a,arguments),a}function py(){var e=mz().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var m=t().length,p=a<n,v=p?a:n,b=p?n:a;i=(b-v)/Math.max(1,m-c+u*2),l&&(i=Math.floor(i)),v+=(b-v-i*(m-c))*d,s=i*(1-c),l&&(v=Math.round(v),s=Math.round(s));var y=TEe(m).map(function(S){return v+i*S});return r(p?y.reverse():y)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(u=+m,f()):u},e.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),f()):d},e.copy=function(){return py(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Eo.apply(f(),arguments)}function Jse(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Jse(t())},e}function Eb(){return Jse(py.apply(null,arguments).paddingInner(1))}function pz(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Zse(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Wx(){}var gy=.7,m_=1/gy,Rp="\\s*([+-]?\\d+)\\s*",vy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",kl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",AEe=/^#([0-9a-f]{3,8})$/,DEe=new RegExp(`^rgb\\(${Rp},${Rp},${Rp}\\)$`),LEe=new RegExp(`^rgb\\(${kl},${kl},${kl}\\)$`),OEe=new RegExp(`^rgba\\(${Rp},${Rp},${Rp},${vy}\\)$`),IEe=new RegExp(`^rgba\\(${kl},${kl},${kl},${vy}\\)$`),REe=new RegExp(`^hsl\\(${vy},${kl},${kl}\\)$`),PEe=new RegExp(`^hsla\\(${vy},${kl},${kl},${vy}\\)$`),zK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pz(Wx,Sh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:BK,formatHex:BK,formatHex8:zEe,formatHsl:BEe,formatRgb:$K,toString:$K});function BK(){return this.rgb().formatHex()}function zEe(){return this.rgb().formatHex8()}function BEe(){return Xse(this).formatHsl()}function $K(){return this.rgb().formatRgb()}function Sh(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=AEe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?FK(t):r===3?new es(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Jw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Jw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=DEe.exec(e))?new es(t[1],t[2],t[3],1):(t=LEe.exec(e))?new es(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=OEe.exec(e))?Jw(t[1],t[2],t[3],t[4]):(t=IEe.exec(e))?Jw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=REe.exec(e))?qK(t[1],t[2]/100,t[3]/100,1):(t=PEe.exec(e))?qK(t[1],t[2]/100,t[3]/100,t[4]):zK.hasOwnProperty(e)?FK(zK[e]):e==="transparent"?new es(NaN,NaN,NaN,0):null}function FK(e){return new es(e>>16&255,e>>8&255,e&255,1)}function Jw(e,t,r,n){return n<=0&&(e=t=r=NaN),new es(e,t,r,n)}function $Ee(e){return e instanceof Wx||(e=Sh(e)),e?(e=e.rgb(),new es(e.r,e.g,e.b,e.opacity)):new es}function iI(e,t,r,n){return arguments.length===1?$Ee(e):new es(e,t,r,n??1)}function es(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}pz(es,iI,Zse(Wx,{brighter(e){return e=e==null?m_:Math.pow(m_,e),new es(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gy:Math.pow(gy,e),new es(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new es(th(this.r),th(this.g),th(this.b),p_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UK,formatHex:UK,formatHex8:FEe,formatRgb:HK,toString:HK}));function UK(){return`#${Wf(this.r)}${Wf(this.g)}${Wf(this.b)}`}function FEe(){return`#${Wf(this.r)}${Wf(this.g)}${Wf(this.b)}${Wf((isNaN(this.opacity)?1:this.opacity)*255)}`}function HK(){const e=p_(this.opacity);return`${e===1?"rgb(":"rgba("}${th(this.r)}, ${th(this.g)}, ${th(this.b)}${e===1?")":`, ${e})`}`}function p_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function th(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wf(e){return e=th(e),(e<16?"0":"")+e.toString(16)}function qK(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ho(e,t,r,n)}function Xse(e){if(e instanceof Ho)return new Ho(e.h,e.s,e.l,e.opacity);if(e instanceof Wx||(e=Sh(e)),!e)return new Ho;if(e instanceof Ho)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new Ho(s,l,c,e.opacity)}function UEe(e,t,r,n){return arguments.length===1?Xse(e):new Ho(e,t,r,n??1)}function Ho(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}pz(Ho,UEe,Zse(Wx,{brighter(e){return e=e==null?m_:Math.pow(m_,e),new Ho(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gy:Math.pow(gy,e),new Ho(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new es(NA(e>=240?e-240:e+120,a,n),NA(e,a,n),NA(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ho(WK(this.h),Zw(this.s),Zw(this.l),p_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=p_(this.opacity);return`${e===1?"hsl(":"hsla("}${WK(this.h)}, ${Zw(this.s)*100}%, ${Zw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function WK(e){return e=(e||0)%360,e<0?e+360:e}function Zw(e){return Math.max(0,Math.min(1,e||0))}function NA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const gz=e=>()=>e;function HEe(e,t){return function(r){return e+r*t}}function qEe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function WEe(e){return(e=+e)==1?eoe:function(t,r){return r-t?qEe(t,r,e):gz(isNaN(t)?r:t)}}function eoe(e,t){var r=t-e;return r?HEe(e,r):gz(isNaN(e)?t:e)}const g_=(function e(t){var r=WEe(t);function n(a,i){var s=r((a=iI(a)).r,(i=iI(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),u=eoe(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n})(1);function KEe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function GEe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function VEe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Qc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function YEe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Bo(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function QEe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Qc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var sI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,CA=new RegExp(sI.source,"g");function JEe(e){return function(){return e}}function ZEe(e){return function(t){return e(t)+""}}function toe(e,t){var r=sI.lastIndex=CA.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=sI.exec(e))&&(a=CA.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:Bo(n,a)})),r=CA.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?ZEe(c[0].x):JEe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function Qc(e,t){var r=typeof t,n;return t==null||r==="boolean"?gz(t):(r==="number"?Bo:r==="string"?(n=Sh(t))?(t=n,g_):toe:t instanceof Sh?g_:t instanceof Date?YEe:GEe(t)?KEe:Array.isArray(t)?VEe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?QEe:Bo)(e,t)}function vz(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var KK=180/Math.PI,oI={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function roe(e,t,r,n,a,i){var s,l,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,s=-s),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*KK,skewX:Math.atan(c)*KK,scaleX:s,scaleY:l}}var Xw;function XEe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?oI:roe(t.a,t.b,t.c,t.d,t.e,t.f)}function eMe(e){return e==null||(Xw||(Xw=document.createElementNS("http://www.w3.org/2000/svg","g")),Xw.setAttribute("transform",e),!(e=Xw.transform.baseVal.consolidate()))?oI:(e=e.matrix,roe(e.a,e.b,e.c,e.d,e.e,e.f))}function noe(e,t,r,n){function a(u){return u.length?u.pop()+" ":""}function i(u,d,f,m,p,v){if(u!==f||d!==m){var b=p.push("translate(",null,t,null,r);v.push({i:b-4,x:Bo(u,f)},{i:b-2,x:Bo(d,m)})}else(f||m)&&p.push("translate("+f+t+m+r)}function s(u,d,f,m){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),m.push({i:f.push(a(f)+"rotate(",null,n)-2,x:Bo(u,d)})):d&&f.push(a(f)+"rotate("+d+n)}function l(u,d,f,m){u!==d?m.push({i:f.push(a(f)+"skewX(",null,n)-2,x:Bo(u,d)}):d&&f.push(a(f)+"skewX("+d+n)}function c(u,d,f,m,p,v){if(u!==f||d!==m){var b=p.push(a(p)+"scale(",null,",",null,")");v.push({i:b-4,x:Bo(u,f)},{i:b-2,x:Bo(d,m)})}else(f!==1||m!==1)&&p.push(a(p)+"scale("+f+","+m+")")}return function(u,d){var f=[],m=[];return u=e(u),d=e(d),i(u.translateX,u.translateY,d.translateX,d.translateY,f,m),s(u.rotate,d.rotate,f,m),l(u.skewX,d.skewX,f,m),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,m),u=d=null,function(p){for(var v=-1,b=m.length,y;++v<b;)f[(y=m[v]).i]=y.x(p);return f.join("")}}}var tMe=noe(XEe,"px, ","px)","deg)"),rMe=noe(eMe,", ",")",")"),nMe=1e-12;function GK(e){return((e=Math.exp(e))+1/e)/2}function aMe(e){return((e=Math.exp(e))-1/e)/2}function iMe(e){return((e=Math.exp(2*e))-1)/(e+1)}const pk=(function e(t,r,n){function a(i,s){var l=i[0],c=i[1],u=i[2],d=s[0],f=s[1],m=s[2],p=d-l,v=f-c,b=p*p+v*v,y,S;if(b<nMe)S=Math.log(m/u)/t,y=function(T){return[l+T*p,c+T*v,u*Math.exp(t*T*S)]};else{var _=Math.sqrt(b),N=(m*m-u*u+n*b)/(2*u*r*_),k=(m*m-u*u-n*b)/(2*m*r*_),j=Math.log(Math.sqrt(N*N+1)-N),E=Math.log(Math.sqrt(k*k+1)-k);S=(E-j)/t,y=function(T){var O=T*S,R=GK(j),q=u/(r*_)*(R*iMe(t*O+j)-aMe(j));return[l+q*p,c+q*v,u*R/GK(t*O+j)]}}return y.duration=S*1e3*t/Math.SQRT2,y}return a.rho=function(i){var s=Math.max(.001,+i),l=s*s,c=l*l;return e(s,l,c)},a})(Math.SQRT2,2,4);function sMe(e,t){t===void 0&&(t=e,e=Qc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function oMe(e){return function(){return e}}function v_(e){return+e}var VK=[0,1];function Li(e){return e}function lI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:oMe(isNaN(t)?NaN:.5)}function lMe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function cMe(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=lI(a,n),i=r(s,i)):(n=lI(n,a),i=r(i,s)),function(l){return i(n(l))}}function uMe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=lI(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=qx(e,l,1,n)-1;return i[c](a[c](l))}}function Kx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Sj(){var e=VK,t=VK,r=Qc,n,a,i,s=Li,l,c,u;function d(){var m=Math.min(e.length,t.length);return s!==Li&&(s=lMe(e[0],e[m-1])),l=m>2?uMe:cMe,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=l(e.map(n),t,r)))(n(s(m)))}return f.invert=function(m){return s(a((u||(u=l(t,e.map(n),Bo)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,v_),d()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),d()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=vz,d()},f.clamp=function(m){return arguments.length?(s=m?!0:Li,d()):s!==Li},f.interpolate=function(m){return arguments.length?(r=m,d()):r},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,p){return n=m,a=p,d()}}function bz(){return Sj()(Li,Li)}function dMe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function b_(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function rg(e){return e=b_(Math.abs(e)),e?e[1]:NaN}function fMe(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function hMe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var mMe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function by(e){if(!(t=mMe.exec(e)))throw new Error("invalid format: "+e);var t;return new yz({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}by.prototype=yz.prototype;function yz(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}yz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function pMe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var y_;function gMe(e,t){var r=b_(e,t);if(!r)return y_=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(y_=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+b_(e,Math.max(0,t+i-1))[0]}function YK(e,t){var r=b_(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const QK={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:dMe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>YK(e*100,t),r:YK,s:gMe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function JK(e){return e}var ZK=Array.prototype.map,XK=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function vMe(e){var t=e.grouping===void 0||e.thousands===void 0?JK:fMe(ZK.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?JK:hMe(ZK.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,m){f=by(f);var p=f.fill,v=f.align,b=f.sign,y=f.symbol,S=f.zero,_=f.width,N=f.comma,k=f.precision,j=f.trim,E=f.type;E==="n"?(N=!0,E="g"):QK[E]||(k===void 0&&(k=12),j=!0,E="g"),(S||p==="0"&&v==="=")&&(S=!0,p="0",v="=");var T=(m&&m.prefix!==void 0?m.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():""),O=(y==="$"?n:/[%p]/.test(E)?s:"")+(m&&m.suffix!==void 0?m.suffix:""),R=QK[E],q=/[defgprs%]/.test(E);k=k===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function $(L){var A=T,M=O,z,I,B;if(E==="c")M=R(L)+M,L="";else{L=+L;var F=L<0||1/L<0;if(L=isNaN(L)?c:R(Math.abs(L),k),j&&(L=pMe(L)),F&&+L==0&&b!=="+"&&(F=!1),A=(F?b==="("?b:l:b==="-"||b==="("?"":b)+A,M=(E==="s"&&!isNaN(L)&&y_!==void 0?XK[8+y_/3]:"")+M+(F&&b==="("?")":""),q){for(z=-1,I=L.length;++z<I;)if(B=L.charCodeAt(z),48>B||B>57){M=(B===46?a+L.slice(z+1):L.slice(z))+M,L=L.slice(0,z);break}}}N&&!S&&(L=t(L,1/0));var U=A.length+L.length+M.length,V=U<_?new Array(_-U+1).join(p):"";switch(N&&S&&(L=t(V+L,V.length?_-M.length:1/0),V=""),v){case"<":L=A+L+M+V;break;case"=":L=A+V+L+M;break;case"^":L=V.slice(0,U=V.length>>1)+A+L+M+V.slice(U);break;default:L=V+A+L+M;break}return i(L)}return $.toString=function(){return f+""},$}function d(f,m){var p=Math.max(-8,Math.min(8,Math.floor(rg(m)/3)))*3,v=Math.pow(10,-p),b=u((f=by(f),f.type="f",f),{suffix:XK[8+p/3]});return function(y){return b(v*y)}}return{format:u,formatPrefix:d}}var eS,xz,aoe;bMe({thousands:",",grouping:[3],currency:["$",""]});function bMe(e){return eS=vMe(e),xz=eS.format,aoe=eS.formatPrefix,eS}function yMe(e){return Math.max(0,-rg(Math.abs(e)))}function xMe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rg(t)/3)))*3-rg(Math.abs(e)))}function wMe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rg(t)-rg(e))+1}function ioe(e,t,r,n){var a=nI(e,t,r),i;switch(n=by(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=xMe(a,s))&&(n.precision=i),aoe(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=wMe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=yMe(a))&&(n.precision=i-(n.type==="%")*2);break}}return xz(n)}function $d(e){var t=e.domain;return e.ticks=function(r){var n=t();return tI(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return ioe(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,u,d=10;for(l<s&&(u=s,s=l,l=u,u=a,a=i,i=u);d-- >0;){if(u=rI(s,l,r),u===c)return n[a]=s,n[i]=l,t(n);if(u>0)s=Math.floor(s/u)*u,l=Math.ceil(l/u)*u;else if(u<0)s=Math.ceil(s*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function x_(){var e=bz();return e.copy=function(){return Kx(e,x_())},Eo.apply(e,arguments),$d(e)}function soe(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,v_),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return soe(e).unknown(t)},e=arguments.length?Array.from(e,v_):[0,1],$d(r)}function ooe(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function eG(e){return Math.log(e)}function tG(e){return Math.exp(e)}function SMe(e){return-Math.log(-e)}function kMe(e){return-Math.exp(-e)}function _Me(e){return isFinite(e)?+("1e"+e):e<0?0:e}function NMe(e){return e===10?_Me:e===Math.E?Math.exp:t=>Math.pow(e,t)}function CMe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function rG(e){return(t,r)=>-e(-t,r)}function wz(e){const t=e(eG,tG),r=t.domain;let n=10,a,i;function s(){return a=CMe(n),i=NMe(n),r()[0]<0?(a=rG(a),i=rG(i),e(SMe,kMe)):e(eG,tG),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let m=a(u),p=a(d),v,b;const y=l==null?10:+l;let S=[];if(!(n%1)&&p-m<y){if(m=Math.floor(m),p=Math.ceil(p),u>0){for(;m<=p;++m)for(v=1;v<n;++v)if(b=m<0?v/i(-m):v*i(m),!(b<u)){if(b>d)break;S.push(b)}}else for(;m<=p;++m)for(v=n-1;v>=1;--v)if(b=m>0?v/i(-m):v*i(m),!(b<u)){if(b>d)break;S.push(b)}S.length*2<y&&(S=tI(u,d,y))}else S=tI(m,p,Math.min(p-m,y)).map(i);return f?S.reverse():S},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=by(c)).precision==null&&(c.trim=!0),c=xz(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(ooe(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function loe(){const e=wz(Sj()).domain([1,10]);return e.copy=()=>Kx(e,loe()).base(e.base()),Eo.apply(e,arguments),e}function nG(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function aG(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Sz(e){var t=1,r=e(nG(t),aG(t));return r.constant=function(n){return arguments.length?e(nG(t=+n),aG(t)):t},$d(r)}function coe(){var e=Sz(Sj());return e.copy=function(){return Kx(e,coe()).constant(e.constant())},Eo.apply(e,arguments)}function iG(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jMe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function EMe(e){return e<0?-e*e:e*e}function kz(e){var t=e(Li,Li),r=1;function n(){return r===1?e(Li,Li):r===.5?e(jMe,EMe):e(iG(r),iG(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},$d(t)}function _z(){var e=kz(Sj());return e.copy=function(){return Kx(e,_z()).exponent(e.exponent())},Eo.apply(e,arguments),e}function MMe(){return _z.apply(null,arguments).exponent(.5)}function sG(e){return Math.sign(e)*e*e}function TMe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function uoe(){var e=bz(),t=[0,1],r=!1,n;function a(i){var s=TMe(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(sG(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,v_)).map(sG)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return uoe(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Eo.apply(a,arguments),$d(a)}function doe(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=MEe(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[qx(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(_d),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return doe().domain(e).range(t).unknown(n)},Eo.apply(i,arguments)}function foe(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[qx(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return foe().domain([e,t]).range(a).unknown(i)},Eo.apply($d(s),arguments)}function hoe(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[qx(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return hoe().domain(e).range(t).unknown(r)},Eo.apply(a,arguments)}const jA=new Date,EA=new Date;function Ta(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<s);return c},a.filter=i=>Ta(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(jA.setTime(+i),EA.setTime(+s),e(jA),e(EA),Math.floor(r(jA,EA))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const w_=Ta(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);w_.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ta(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):w_);w_.range;const $c=1e3,bo=$c*60,Fc=bo*60,au=Fc*24,Nz=au*7,oG=au*30,MA=au*365,Kf=Ta(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*$c)},(e,t)=>(t-e)/$c,e=>e.getUTCSeconds());Kf.range;const Cz=Ta(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$c)},(e,t)=>{e.setTime(+e+t*bo)},(e,t)=>(t-e)/bo,e=>e.getMinutes());Cz.range;const jz=Ta(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*bo)},(e,t)=>(t-e)/bo,e=>e.getUTCMinutes());jz.range;const Ez=Ta(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$c-e.getMinutes()*bo)},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getHours());Ez.range;const Mz=Ta(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getUTCHours());Mz.range;const Gx=Ta(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*bo)/au,e=>e.getDate()-1);Gx.range;const kj=Ta(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/au,e=>e.getUTCDate()-1);kj.range;const moe=Ta(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/au,e=>Math.floor(e/au));moe.range;function Gh(e){return Ta(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*bo)/Nz)}const _j=Gh(0),S_=Gh(1),AMe=Gh(2),DMe=Gh(3),ng=Gh(4),LMe=Gh(5),OMe=Gh(6);_j.range;S_.range;AMe.range;DMe.range;ng.range;LMe.range;OMe.range;function Vh(e){return Ta(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Nz)}const Nj=Vh(0),k_=Vh(1),IMe=Vh(2),RMe=Vh(3),ag=Vh(4),PMe=Vh(5),zMe=Vh(6);Nj.range;k_.range;IMe.range;RMe.range;ag.range;PMe.range;zMe.range;const Tz=Ta(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Tz.range;const Az=Ta(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Az.range;const iu=Ta(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());iu.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ta(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});iu.range;const su=Ta(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());su.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ta(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});su.range;function poe(e,t,r,n,a,i){const s=[[Kf,1,$c],[Kf,5,5*$c],[Kf,15,15*$c],[Kf,30,30*$c],[i,1,bo],[i,5,5*bo],[i,15,15*bo],[i,30,30*bo],[a,1,Fc],[a,3,3*Fc],[a,6,6*Fc],[a,12,12*Fc],[n,1,au],[n,2,2*au],[r,1,Nz],[t,1,oG],[t,3,3*oG],[e,1,MA]];function l(u,d,f){const m=d<u;m&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),v=p?p.range(u,+d+1):[];return m?v.reverse():v}function c(u,d,f){const m=Math.abs(d-u)/f,p=hz(([,,y])=>y).right(s,m);if(p===s.length)return e.every(nI(u/MA,d/MA,f));if(p===0)return w_.every(Math.max(nI(u,d,f),1));const[v,b]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return v.every(b)}return[l,c]}const[BMe,$Me]=poe(su,Az,Nj,moe,Mz,jz),[FMe,UMe]=poe(iu,Tz,_j,Gx,Ez,Cz);function TA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function AA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xv(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function HMe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,u=wv(a),d=Sv(a),f=wv(i),m=Sv(i),p=wv(s),v=Sv(s),b=wv(l),y=Sv(l),S=wv(c),_=Sv(c),N={a:B,A:F,b:U,B:V,c:null,d:hG,e:hG,f:fTe,g:STe,G:_Te,H:cTe,I:uTe,j:dTe,L:goe,m:hTe,M:mTe,p:K,q:G,Q:gG,s:vG,S:pTe,u:gTe,U:vTe,V:bTe,w:yTe,W:xTe,x:null,X:null,y:wTe,Y:kTe,Z:NTe,"%":pG},k={a:J,A:ee,b:Y,B:ie,c:null,d:mG,e:mG,f:MTe,g:BTe,G:FTe,H:CTe,I:jTe,j:ETe,L:boe,m:TTe,M:ATe,p:fe,q:me,Q:gG,s:vG,S:DTe,u:LTe,U:OTe,V:ITe,w:RTe,W:PTe,x:null,X:null,y:zTe,Y:$Te,Z:UTe,"%":pG},j={a:q,A:$,b:L,B:A,c:M,d:dG,e:dG,f:iTe,g:uG,G:cG,H:fG,I:fG,j:tTe,L:aTe,m:eTe,M:rTe,p:R,q:XMe,Q:oTe,s:lTe,S:nTe,u:VMe,U:YMe,V:QMe,w:GMe,W:JMe,x:z,X:I,y:uG,Y:cG,Z:ZMe,"%":sTe};N.x=E(r,N),N.X=E(n,N),N.c=E(t,N),k.x=E(r,k),k.X=E(n,k),k.c=E(t,k);function E(te,oe){return function(ce){var Z=[],ue=-1,H=0,ge=te.length,de,re,ne;for(ce instanceof Date||(ce=new Date(+ce));++ue<ge;)te.charCodeAt(ue)===37&&(Z.push(te.slice(H,ue)),(re=lG[de=te.charAt(++ue)])!=null?de=te.charAt(++ue):re=de==="e"?" ":"0",(ne=oe[de])&&(de=ne(ce,re)),Z.push(de),H=ue+1);return Z.push(te.slice(H,ue)),Z.join("")}}function T(te,oe){return function(ce){var Z=xv(1900,void 0,1),ue=O(Z,te,ce+="",0),H,ge;if(ue!=ce.length)return null;if("Q"in Z)return new Date(Z.Q);if("s"in Z)return new Date(Z.s*1e3+("L"in Z?Z.L:0));if(oe&&!("Z"in Z)&&(Z.Z=0),"p"in Z&&(Z.H=Z.H%12+Z.p*12),Z.m===void 0&&(Z.m="q"in Z?Z.q:0),"V"in Z){if(Z.V<1||Z.V>53)return null;"w"in Z||(Z.w=1),"Z"in Z?(H=AA(xv(Z.y,0,1)),ge=H.getUTCDay(),H=ge>4||ge===0?k_.ceil(H):k_(H),H=kj.offset(H,(Z.V-1)*7),Z.y=H.getUTCFullYear(),Z.m=H.getUTCMonth(),Z.d=H.getUTCDate()+(Z.w+6)%7):(H=TA(xv(Z.y,0,1)),ge=H.getDay(),H=ge>4||ge===0?S_.ceil(H):S_(H),H=Gx.offset(H,(Z.V-1)*7),Z.y=H.getFullYear(),Z.m=H.getMonth(),Z.d=H.getDate()+(Z.w+6)%7)}else("W"in Z||"U"in Z)&&("w"in Z||(Z.w="u"in Z?Z.u%7:"W"in Z?1:0),ge="Z"in Z?AA(xv(Z.y,0,1)).getUTCDay():TA(xv(Z.y,0,1)).getDay(),Z.m=0,Z.d="W"in Z?(Z.w+6)%7+Z.W*7-(ge+5)%7:Z.w+Z.U*7-(ge+6)%7);return"Z"in Z?(Z.H+=Z.Z/100|0,Z.M+=Z.Z%100,AA(Z)):TA(Z)}}function O(te,oe,ce,Z){for(var ue=0,H=oe.length,ge=ce.length,de,re;ue<H;){if(Z>=ge)return-1;if(de=oe.charCodeAt(ue++),de===37){if(de=oe.charAt(ue++),re=j[de in lG?oe.charAt(ue++):de],!re||(Z=re(te,ce,Z))<0)return-1}else if(de!=ce.charCodeAt(Z++))return-1}return Z}function R(te,oe,ce){var Z=u.exec(oe.slice(ce));return Z?(te.p=d.get(Z[0].toLowerCase()),ce+Z[0].length):-1}function q(te,oe,ce){var Z=p.exec(oe.slice(ce));return Z?(te.w=v.get(Z[0].toLowerCase()),ce+Z[0].length):-1}function $(te,oe,ce){var Z=f.exec(oe.slice(ce));return Z?(te.w=m.get(Z[0].toLowerCase()),ce+Z[0].length):-1}function L(te,oe,ce){var Z=S.exec(oe.slice(ce));return Z?(te.m=_.get(Z[0].toLowerCase()),ce+Z[0].length):-1}function A(te,oe,ce){var Z=b.exec(oe.slice(ce));return Z?(te.m=y.get(Z[0].toLowerCase()),ce+Z[0].length):-1}function M(te,oe,ce){return O(te,t,oe,ce)}function z(te,oe,ce){return O(te,r,oe,ce)}function I(te,oe,ce){return O(te,n,oe,ce)}function B(te){return s[te.getDay()]}function F(te){return i[te.getDay()]}function U(te){return c[te.getMonth()]}function V(te){return l[te.getMonth()]}function K(te){return a[+(te.getHours()>=12)]}function G(te){return 1+~~(te.getMonth()/3)}function J(te){return s[te.getUTCDay()]}function ee(te){return i[te.getUTCDay()]}function Y(te){return c[te.getUTCMonth()]}function ie(te){return l[te.getUTCMonth()]}function fe(te){return a[+(te.getUTCHours()>=12)]}function me(te){return 1+~~(te.getUTCMonth()/3)}return{format:function(te){var oe=E(te+="",N);return oe.toString=function(){return te},oe},parse:function(te){var oe=T(te+="",!1);return oe.toString=function(){return te},oe},utcFormat:function(te){var oe=E(te+="",k);return oe.toString=function(){return te},oe},utcParse:function(te){var oe=T(te+="",!0);return oe.toString=function(){return te},oe}}}var lG={"-":"",_:" ",0:"0"},Wa=/^\s*\d+/,qMe=/^%/,WMe=/[\\^$*+?|[\]().{}]/g;function Rr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function KMe(e){return e.replace(WMe,"\\$&")}function wv(e){return new RegExp("^(?:"+e.map(KMe).join("|")+")","i")}function Sv(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function GMe(e,t,r){var n=Wa.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function VMe(e,t,r){var n=Wa.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function YMe(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function QMe(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function JMe(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function cG(e,t,r){var n=Wa.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function uG(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function ZMe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function XMe(e,t,r){var n=Wa.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function eTe(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function dG(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function tTe(e,t,r){var n=Wa.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function fG(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function rTe(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function nTe(e,t,r){var n=Wa.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function aTe(e,t,r){var n=Wa.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function iTe(e,t,r){var n=Wa.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function sTe(e,t,r){var n=qMe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function oTe(e,t,r){var n=Wa.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function lTe(e,t,r){var n=Wa.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function hG(e,t){return Rr(e.getDate(),t,2)}function cTe(e,t){return Rr(e.getHours(),t,2)}function uTe(e,t){return Rr(e.getHours()%12||12,t,2)}function dTe(e,t){return Rr(1+Gx.count(iu(e),e),t,3)}function goe(e,t){return Rr(e.getMilliseconds(),t,3)}function fTe(e,t){return goe(e,t)+"000"}function hTe(e,t){return Rr(e.getMonth()+1,t,2)}function mTe(e,t){return Rr(e.getMinutes(),t,2)}function pTe(e,t){return Rr(e.getSeconds(),t,2)}function gTe(e){var t=e.getDay();return t===0?7:t}function vTe(e,t){return Rr(_j.count(iu(e)-1,e),t,2)}function voe(e){var t=e.getDay();return t>=4||t===0?ng(e):ng.ceil(e)}function bTe(e,t){return e=voe(e),Rr(ng.count(iu(e),e)+(iu(e).getDay()===4),t,2)}function yTe(e){return e.getDay()}function xTe(e,t){return Rr(S_.count(iu(e)-1,e),t,2)}function wTe(e,t){return Rr(e.getFullYear()%100,t,2)}function STe(e,t){return e=voe(e),Rr(e.getFullYear()%100,t,2)}function kTe(e,t){return Rr(e.getFullYear()%1e4,t,4)}function _Te(e,t){var r=e.getDay();return e=r>=4||r===0?ng(e):ng.ceil(e),Rr(e.getFullYear()%1e4,t,4)}function NTe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Rr(t/60|0,"0",2)+Rr(t%60,"0",2)}function mG(e,t){return Rr(e.getUTCDate(),t,2)}function CTe(e,t){return Rr(e.getUTCHours(),t,2)}function jTe(e,t){return Rr(e.getUTCHours()%12||12,t,2)}function ETe(e,t){return Rr(1+kj.count(su(e),e),t,3)}function boe(e,t){return Rr(e.getUTCMilliseconds(),t,3)}function MTe(e,t){return boe(e,t)+"000"}function TTe(e,t){return Rr(e.getUTCMonth()+1,t,2)}function ATe(e,t){return Rr(e.getUTCMinutes(),t,2)}function DTe(e,t){return Rr(e.getUTCSeconds(),t,2)}function LTe(e){var t=e.getUTCDay();return t===0?7:t}function OTe(e,t){return Rr(Nj.count(su(e)-1,e),t,2)}function yoe(e){var t=e.getUTCDay();return t>=4||t===0?ag(e):ag.ceil(e)}function ITe(e,t){return e=yoe(e),Rr(ag.count(su(e),e)+(su(e).getUTCDay()===4),t,2)}function RTe(e){return e.getUTCDay()}function PTe(e,t){return Rr(k_.count(su(e)-1,e),t,2)}function zTe(e,t){return Rr(e.getUTCFullYear()%100,t,2)}function BTe(e,t){return e=yoe(e),Rr(e.getUTCFullYear()%100,t,2)}function $Te(e,t){return Rr(e.getUTCFullYear()%1e4,t,4)}function FTe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ag(e):ag.ceil(e),Rr(e.getUTCFullYear()%1e4,t,4)}function UTe(){return"+0000"}function pG(){return"%"}function gG(e){return+e}function vG(e){return Math.floor(+e/1e3)}var Qm,xoe,woe;HTe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function HTe(e){return Qm=HMe(e),xoe=Qm.format,Qm.parse,woe=Qm.utcFormat,Qm.utcParse,Qm}function qTe(e){return new Date(e)}function WTe(e){return e instanceof Date?+e:+new Date(+e)}function Dz(e,t,r,n,a,i,s,l,c,u){var d=bz(),f=d.invert,m=d.domain,p=u(".%L"),v=u(":%S"),b=u("%I:%M"),y=u("%I %p"),S=u("%a %d"),_=u("%b %d"),N=u("%B"),k=u("%Y");function j(E){return(c(E)<E?p:l(E)<E?v:s(E)<E?b:i(E)<E?y:n(E)<E?a(E)<E?S:_:r(E)<E?N:k)(E)}return d.invert=function(E){return new Date(f(E))},d.domain=function(E){return arguments.length?m(Array.from(E,WTe)):m().map(qTe)},d.ticks=function(E){var T=m();return e(T[0],T[T.length-1],E??10)},d.tickFormat=function(E,T){return T==null?j:u(T)},d.nice=function(E){var T=m();return(!E||typeof E.range!="function")&&(E=t(T[0],T[T.length-1],E??10)),E?m(ooe(T,E)):d},d.copy=function(){return Kx(d,Dz(e,t,r,n,a,i,s,l,c,u))},d}function KTe(){return Eo.apply(Dz(FMe,UMe,iu,Tz,_j,Gx,Ez,Cz,Kf,xoe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function GTe(){return Eo.apply(Dz(BMe,$Me,su,Az,Nj,kj,Mz,jz,Kf,woe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Cj(){var e=0,t=1,r,n,a,i,s=Li,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(m){var p,v;return arguments.length?([p,v]=m,s=f(p,v),u):[s(0),s(1)]}}return u.range=d(Qc),u.rangeRound=d(vz),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function Fd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Soe(){var e=$d(Cj()(Li));return e.copy=function(){return Fd(e,Soe())},mu.apply(e,arguments)}function koe(){var e=wz(Cj()).domain([1,10]);return e.copy=function(){return Fd(e,koe()).base(e.base())},mu.apply(e,arguments)}function _oe(){var e=Sz(Cj());return e.copy=function(){return Fd(e,_oe()).constant(e.constant())},mu.apply(e,arguments)}function Lz(){var e=kz(Cj());return e.copy=function(){return Fd(e,Lz()).exponent(e.exponent())},mu.apply(e,arguments)}function VTe(){return Lz.apply(null,arguments).exponent(.5)}function Noe(){var e=[],t=Li;function r(n){if(n!=null&&!isNaN(n=+n))return t((qx(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(_d),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>EEe(e,i/n))},r.copy=function(){return Noe(t).domain(e)},mu.apply(r,arguments)}function jj(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,u=Li,d,f=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+d(b))-i)*(n*b<n*i?l:c),u(f?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([e,t,r]=b,a=d(e=+e),i=d(t=+t),s=d(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(b){return arguments.length?(f=!!b,p):f},p.interpolator=function(b){return arguments.length?(u=b,p):u};function v(b){return function(y){var S,_,N;return arguments.length?([S,_,N]=y,u=sMe(b,[S,_,N]),p):[u(0),u(.5),u(1)]}}return p.range=v(Qc),p.rangeRound=v(vz),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return d=b,a=b(e),i=b(t),s=b(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p}}function Coe(){var e=$d(jj()(Li));return e.copy=function(){return Fd(e,Coe())},mu.apply(e,arguments)}function joe(){var e=wz(jj()).domain([.1,1,10]);return e.copy=function(){return Fd(e,joe()).base(e.base())},mu.apply(e,arguments)}function Eoe(){var e=Sz(jj());return e.copy=function(){return Fd(e,Eoe()).constant(e.constant())},mu.apply(e,arguments)}function Oz(){var e=kz(jj());return e.copy=function(){return Fd(e,Oz()).exponent(e.exponent())},mu.apply(e,arguments)}function YTe(){return Oz.apply(null,arguments).exponent(.5)}const bG=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:py,scaleDiverging:Coe,scaleDivergingLog:joe,scaleDivergingPow:Oz,scaleDivergingSqrt:YTe,scaleDivergingSymlog:Eoe,scaleIdentity:soe,scaleImplicit:aI,scaleLinear:x_,scaleLog:loe,scaleOrdinal:mz,scalePoint:Eb,scalePow:_z,scaleQuantile:doe,scaleQuantize:foe,scaleRadial:uoe,scaleSequential:Soe,scaleSequentialLog:koe,scaleSequentialPow:Lz,scaleSequentialQuantile:Noe,scaleSequentialSqrt:VTe,scaleSequentialSymlog:_oe,scaleSqrt:MMe,scaleSymlog:coe,scaleThreshold:hoe,scaleTime:KTe,scaleUtc:GTe,tickFormat:ioe},Symbol.toStringTag,{value:"Module"}));var DA,yG;function Ej(){if(yG)return DA;yG=1;var e=s0();function t(r,n,a){for(var i=-1,s=r.length;++i<s;){var l=r[i],c=n(l);if(c!=null&&(u===void 0?c===c&&!e(c):a(c,u)))var u=c,d=l}return d}return DA=t,DA}var LA,xG;function Moe(){if(xG)return LA;xG=1;function e(t,r){return t>r}return LA=e,LA}var OA,wG;function QTe(){if(wG)return OA;wG=1;var e=Ej(),t=Moe(),r=c0();function n(a){return a&&a.length?e(a,r,t):void 0}return OA=n,OA}var JTe=QTe();const Mj=Fr(JTe);var IA,SG;function Toe(){if(SG)return IA;SG=1;function e(t,r){return t<r}return IA=e,IA}var RA,kG;function ZTe(){if(kG)return RA;kG=1;var e=Ej(),t=Toe(),r=c0();function n(a){return a&&a.length?e(a,r,t):void 0}return RA=n,RA}var XTe=ZTe();const Tj=Fr(XTe);var PA,_G;function e4e(){if(_G)return PA;_G=1;var e=Q6(),t=Hl(),r=Rse(),n=ls();function a(i,s){var l=n(i)?e:r;return l(i,t(s,3))}return PA=a,PA}var zA,NG;function t4e(){if(NG)return zA;NG=1;var e=Ose(),t=e4e();function r(n,a){return e(t(n,a),1)}return zA=r,zA}var r4e=t4e();const n4e=Fr(r4e);var BA,CG;function a4e(){if(CG)return BA;CG=1;var e=cz();function t(r,n){return e(r,n)}return BA=t,BA}var i4e=a4e();const Vx=Fr(i4e);var u0=1e9,s4e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Rz,En=!0,ko="[DecimalError] ",rh=ko+"Invalid argument: ",Iz=ko+"Exponent out of range: ",d0=Math.floor,Rf=Math.pow,o4e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Es,Ia=1e7,Nn=7,Aoe=9007199254740991,__=d0(Aoe/Nn),vt={};vt.absoluteValue=vt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};vt.comparedTo=vt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};vt.decimalPlaces=vt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Nn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};vt.dividedBy=vt.div=function(e){return Jc(this,new this.constructor(e))};vt.dividedToIntegerBy=vt.idiv=function(e){var t=this,r=t.constructor;return mn(Jc(t,new r(e),0,1),r.precision)};vt.equals=vt.eq=function(e){return!this.cmp(e)};vt.exponent=function(){return va(this)};vt.greaterThan=vt.gt=function(e){return this.cmp(e)>0};vt.greaterThanOrEqualTo=vt.gte=function(e){return this.cmp(e)>=0};vt.isInteger=vt.isint=function(){return this.e>this.d.length-2};vt.isNegative=vt.isneg=function(){return this.s<0};vt.isPositive=vt.ispos=function(){return this.s>0};vt.isZero=function(){return this.s===0};vt.lessThan=vt.lt=function(e){return this.cmp(e)<0};vt.lessThanOrEqualTo=vt.lte=function(e){return this.cmp(e)<1};vt.logarithm=vt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Es))throw Error(ko+"NaN");if(r.s<1)throw Error(ko+(r.s?"NaN":"-Infinity"));return r.eq(Es)?new n(0):(En=!1,t=Jc(yy(r,i),yy(e,i),i),En=!0,mn(t,a))};vt.minus=vt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Ooe(t,e):Doe(t,(e.s=-e.s,e))};vt.modulo=vt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ko+"NaN");return r.s?(En=!1,t=Jc(r,e,0,1).times(e),En=!0,r.minus(t)):mn(new n(r),a)};vt.naturalExponential=vt.exp=function(){return Loe(this)};vt.naturalLogarithm=vt.ln=function(){return yy(this)};vt.negated=vt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};vt.plus=vt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Doe(t,e):Ooe(t,(e.s=-e.s,e))};vt.precision=vt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(rh+e);if(t=va(a)+1,n=a.d.length-1,r=n*Nn+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};vt.squareRoot=vt.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ko+"NaN")}for(e=va(l),En=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=xl(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=d0((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Jc(l,i,s+2)).times(.5),xl(i.d).slice(0,s)===(t=xl(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(mn(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return En=!0,mn(n,r)};vt.times=vt.mul=function(e){var t,r,n,a,i,s,l,c,u,d=this,f=d.constructor,m=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=m.length,u=p.length,c<u&&(i=m,m=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+p[n]*m[a-n-1]+t,i[a--]=l%Ia|0,t=l/Ia|0;i[a]=(i[a]+t)%Ia|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,En?mn(e,f.precision):e};vt.toDecimalPlaces=vt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Dl(e,0,u0),t===void 0?t=n.rounding:Dl(t,0,8),mn(r,e+va(r)+1,t))};vt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=kh(n,!0):(Dl(e,0,u0),t===void 0?t=a.rounding:Dl(t,0,8),n=mn(new a(n),e+1,t),r=kh(n,!0,e+1)),r};vt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?kh(a):(Dl(e,0,u0),t===void 0?t=i.rounding:Dl(t,0,8),n=mn(new i(a),e+va(a)+1,t),r=kh(n.abs(),!1,e+va(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};vt.toInteger=vt.toint=function(){var e=this,t=e.constructor;return mn(new t(e),va(e)+1,t.rounding)};vt.toNumber=function(){return+this};vt.toPower=vt.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Es);if(l=new c(l),!l.s){if(e.s<1)throw Error(ko+"Infinity");return l}if(l.eq(Es))return l;if(n=c.precision,e.eq(Es))return mn(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=d<0?-d:d)<=Aoe){for(a=new c(Es),t=Math.ceil(n/Nn+4),En=!1;r%2&&(a=a.times(l),EG(a.d,t)),r=d0(r/2),r!==0;)l=l.times(l),EG(l.d,t);return En=!0,e.s<0?new c(Es).div(a):mn(a,n)}}else if(i<0)throw Error(ko+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,En=!1,a=e.times(yy(l,n+u)),En=!0,a=Loe(a),a.s=i,a};vt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=va(a),n=kh(a,r<=i.toExpNeg||r>=i.toExpPos)):(Dl(e,1,u0),t===void 0?t=i.rounding:Dl(t,0,8),a=mn(new i(a),e,t),r=va(a),n=kh(a,e<=r||r<=i.toExpNeg,e)),n};vt.toSignificantDigits=vt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Dl(e,1,u0),t===void 0?t=n.rounding:Dl(t,0,8)),mn(new n(r),e,t)};vt.toString=vt.valueOf=vt.val=vt.toJSON=vt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=va(e),r=e.constructor;return kh(e,t<=r.toExpNeg||t>=r.toExpPos)};function Doe(e,t){var r,n,a,i,s,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),En?mn(t,f):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=u.length):(n=u,a=s,l=c.length),s=Math.ceil(f/Nn),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/Ia|0,c[i]%=Ia;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,En?mn(t,f):t}function Dl(e,t,r){if(e!==~~e||e<t||e>r)throw Error(rh+e)}function xl(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Nn-n.length,r&&(i+=ad(r)),i+=n;s=e[t],n=s+"",r=Nn-n.length,r&&(i+=ad(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Jc=(function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%Ia|0,s=i/Ia|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Ia+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,u,d,f,m,p,v,b,y,S,_,N,k,j,E,T,O,R=n.constructor,q=n.s==a.s?1:-1,$=n.d,L=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(ko+"Division by zero");for(c=n.e-a.e,T=L.length,j=$.length,p=new R(q),v=p.d=[],u=0;L[u]==($[u]||0);)++u;if(L[u]>($[u]||0)&&--c,i==null?_=i=R.precision:s?_=i+(va(n)-va(a))+1:_=i,_<0)return new R(0);if(_=_/Nn+2|0,u=0,T==1)for(d=0,L=L[0],_++;(u<j||d)&&_--;u++)N=d*Ia+($[u]||0),v[u]=N/L|0,d=N%L|0;else{for(d=Ia/(L[0]+1)|0,d>1&&(L=e(L,d),$=e($,d),T=L.length,j=$.length),k=T,b=$.slice(0,T),y=b.length;y<T;)b[y++]=0;O=L.slice(),O.unshift(0),E=L[0],L[1]>=Ia/2&&++E;do d=0,l=t(L,b,T,y),l<0?(S=b[0],T!=y&&(S=S*Ia+(b[1]||0)),d=S/E|0,d>1?(d>=Ia&&(d=Ia-1),f=e(L,d),m=f.length,y=b.length,l=t(f,b,m,y),l==1&&(d--,r(f,T<m?O:L,m))):(d==0&&(l=d=1),f=L.slice()),m=f.length,m<y&&f.unshift(0),r(b,f,y),l==-1&&(y=b.length,l=t(L,b,T,y),l<1&&(d++,r(b,T<y?O:L,y))),y=b.length):l===0&&(d++,b=[0]),v[u++]=d,l&&b[0]?b[y++]=$[k]||0:(b=[$[k]],y=1);while((k++<j||b[0]!==void 0)&&_--)}return v[0]||v.shift(),p.e=c,mn(p,s?i+va(p)+1:i)}})();function Loe(e,t){var r,n,a,i,s,l,c=0,u=0,d=e.constructor,f=d.precision;if(va(e)>16)throw Error(Iz+va(e));if(!e.s)return new d(Es);for(En=!1,l=f,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(Rf(2,u))/Math.LN10*2+5|0,l+=n,r=a=i=new d(Es),d.precision=l;;){if(a=mn(a.times(e),l),r=r.times(++c),s=i.plus(Jc(a,r,l)),xl(s.d).slice(0,l)===xl(i.d).slice(0,l)){for(;u--;)i=mn(i.times(i),l);return d.precision=f,t==null?(En=!0,mn(i,f)):i}i=s}}function va(e){for(var t=e.e*Nn,r=e.d[0];r>=10;r/=10)t++;return t}function $A(e,t,r){if(t>e.LN10.sd())throw En=!0,r&&(e.precision=r),Error(ko+"LN10 precision limit exceeded");return mn(new e(e.LN10),t)}function ad(e){for(var t="";e--;)t+="0";return t}function yy(e,t){var r,n,a,i,s,l,c,u,d,f=1,m=10,p=e,v=p.d,b=p.constructor,y=b.precision;if(p.s<1)throw Error(ko+(p.s?"NaN":"-Infinity"));if(p.eq(Es))return new b(0);if(t==null?(En=!1,u=y):u=t,p.eq(10))return t==null&&(En=!0),$A(b,u);if(u+=m,b.precision=u,r=xl(v),n=r.charAt(0),i=va(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=xl(p.d),n=r.charAt(0),f++;i=va(p),n>1?(p=new b("0."+r),i++):p=new b(n+"."+r.slice(1))}else return c=$A(b,u+2,y).times(i+""),p=yy(new b(n+"."+r.slice(1)),u-m).plus(c),b.precision=y,t==null?(En=!0,mn(p,y)):p;for(l=s=p=Jc(p.minus(Es),p.plus(Es),u),d=mn(p.times(p),u),a=3;;){if(s=mn(s.times(d),u),c=l.plus(Jc(s,new b(a),u)),xl(c.d).slice(0,u)===xl(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus($A(b,u+2,y).times(i+""))),l=Jc(l,new b(f),u),b.precision=y,t==null?(En=!0,mn(l,y)):l;l=c,a+=2}}function jG(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=d0(r/Nn),e.d=[],n=(r+1)%Nn,r<0&&(n+=Nn),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Nn;n<a;)e.d.push(+t.slice(n,n+=Nn));t=t.slice(n),n=Nn-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),En&&(e.e>__||e.e<-__))throw Error(Iz+r)}else e.s=0,e.e=0,e.d=[0];return e}function mn(e,t,r){var n,a,i,s,l,c,u,d,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Nn,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/Nn),i=f.length,d>=i)return e;for(u=i=f[d],s=1;i>=10;i/=10)s++;n%=Nn,a=n-Nn+s}if(r!==void 0&&(i=Rf(10,s-a-1),l=u/i%10|0,c=t<0||f[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/Rf(10,s-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=va(e),f.length=1,t=t-i-1,f[0]=Rf(10,(Nn-t%Nn)%Nn),e.e=d0(-t/Nn)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=Rf(10,Nn-n),f[d]=a>0?(u/Rf(10,s-a)%Rf(10,a)|0)*i:0),c)for(;;)if(d==0){(f[0]+=i)==Ia&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=Ia)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(En&&(e.e>__||e.e<-__))throw Error(Iz+va(e));return e}function Ooe(e,t){var r,n,a,i,s,l,c,u,d,f,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),En?mn(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(p/Nn),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}s=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=Ia-1;--c[i],c[a]+=Ia}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,En?mn(t,p):t):new m(0)}function kh(e,t,r){var n,a=va(e),i=xl(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+ad(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ad(-a-1)+i,r&&(n=r-s)>0&&(i+=ad(n))):a>=s?(i+=ad(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+ad(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=ad(n))),e.s<0?"-"+i:i}function EG(e,t){if(e.length>t)return e.length=t,!0}function Ioe(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(rh+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return jG(s,i.toString())}else if(typeof i!="string")throw Error(rh+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,o4e.test(i))jG(s,i);else throw Error(rh+i)}if(a.prototype=vt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Ioe,a.config=a.set=l4e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function l4e(e){if(!e||typeof e!="object")throw Error(ko+"Object expected");var t,r,n,a=["precision",1,u0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(d0(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(rh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(rh+r+": "+n);return this}var Rz=Ioe(s4e);Es=new Rz(1);const dn=Rz;function c4e(e){return h4e(e)||f4e(e)||d4e(e)||u4e()}function u4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d4e(e,t){if(e){if(typeof e=="string")return cI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cI(e,t)}}function f4e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function h4e(e){if(Array.isArray(e))return cI(e)}function cI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var m4e=function(t){return t},Roe={},Poe=function(t){return t===Roe},MG=function(t){return function r(){return arguments.length===0||arguments.length===1&&Poe(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},p4e=function e(t,r){return t===1?r:MG(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(l){return l!==Roe}).length;return s>=t?r.apply(void 0,a):e(t-s,MG(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=a.map(function(f){return Poe(f)?c.shift():f});return r.apply(void 0,c4e(d).concat(c))}))})},Aj=function(t){return p4e(t.length,t)},uI=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},g4e=Aj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),v4e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return m4e;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},dI=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},zoe=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function b4e(e){var t;return e===0?t=1:t=Math.floor(new dn(e).abs().log(10).toNumber())+1,t}function y4e(e,t,r){for(var n=new dn(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var x4e=Aj(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),w4e=Aj(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),S4e=Aj(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Dj={rangeStep:y4e,getDigitCount:b4e,interpolateNumber:x4e,uninterpolateNumber:w4e,uninterpolateTruncation:S4e};function fI(e){return N4e(e)||_4e(e)||Boe(e)||k4e()}function k4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _4e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function N4e(e){if(Array.isArray(e))return hI(e)}function xy(e,t){return E4e(e)||j4e(e,t)||Boe(e,t)||C4e()}function C4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Boe(e,t){if(e){if(typeof e=="string")return hI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hI(e,t)}}function hI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j4e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),l;!(n=(l=s.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function E4e(e){if(Array.isArray(e))return e}function $oe(e){var t=xy(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function Foe(e,t,r){if(e.lte(0))return new dn(0);var n=Dj.getDigitCount(e.toNumber()),a=new dn(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new dn(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?c:new dn(Math.ceil(c))}function M4e(e,t,r){var n=1,a=new dn(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new dn(10).pow(Dj.getDigitCount(e)-1),a=new dn(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new dn(Math.floor(e)))}else e===0?a=new dn(Math.floor((t-1)/2)):r||(a=new dn(Math.floor(e)));var s=Math.floor((t-1)/2),l=v4e(g4e(function(c){return a.add(new dn(c-s).mul(n)).toNumber()}),uI);return l(0,t)}function Uoe(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new dn(0),tickMin:new dn(0),tickMax:new dn(0)};var i=Foe(new dn(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new dn(0):(s=new dn(e).add(t).div(2),s=s.sub(new dn(s).mod(i)));var l=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new dn(t).sub(s).div(i).toNumber()),u=l+c+1;return u>r?Uoe(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,l=t>0?l:l+(r-u)),{step:i,tickMin:s.sub(new dn(l).mul(i)),tickMax:s.add(new dn(c).mul(i))})}function T4e(e){var t=xy(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),l=$oe([r,n]),c=xy(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(fI(uI(0,a-1).map(function(){return 1/0}))):[].concat(fI(uI(0,a-1).map(function(){return-1/0})),[d]);return r>n?dI(f):f}if(u===d)return M4e(u,a,i);var m=Uoe(u,d,s,i),p=m.step,v=m.tickMin,b=m.tickMax,y=Dj.rangeStep(v,b.add(new dn(.1).mul(p)),p);return r>n?dI(y):y}function A4e(e,t){var r=xy(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=$oe([n,a]),l=xy(s,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var d=Math.max(t,2),f=Foe(new dn(u).sub(c).div(d-1),i,0),m=[].concat(fI(Dj.rangeStep(new dn(c),new dn(u).sub(new dn(.99).mul(f)),f)),[u]);return n>a?dI(m):m}var D4e=zoe(T4e),L4e=zoe(A4e),O4e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ig(e){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function N_(){return N_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N_.apply(this,arguments)}function I4e(e,t){return B4e(e)||z4e(e,t)||P4e(e,t)||R4e()}function R4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P4e(e,t){if(e){if(typeof e=="string")return TG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TG(e,t)}}function TG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function B4e(e){if(Array.isArray(e))return e}function $4e(e,t){if(e==null)return{};var r=F4e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function U4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Woe(n.key),n)}}function q4e(e,t,r){return t&&H4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function W4e(e,t,r){return t=C_(t),K4e(e,Hoe()?Reflect.construct(t,r||[],C_(e).constructor):t.apply(e,r))}function K4e(e,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G4e(e)}function G4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hoe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hoe=function(){return!!e})()}function C_(e){return C_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},C_(e)}function V4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mI(e,t)}function mI(e,t){return mI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},mI(e,t)}function qoe(e,t,r){return t=Woe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Woe(e){var t=Y4e(e,"string");return ig(t)=="symbol"?t:t+""}function Y4e(e,t){if(ig(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ig(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Yx=(function(e){function t(){return U4e(this,t),W4e(this,t,arguments)}return V4e(t,e),q4e(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,l=n.dataKey,c=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,m=$4e(n,O4e),p=Ut(m,!1);this.props.direction==="x"&&d.type!=="number"&&gh(!1);var v=c.map(function(b){var y=u(b,l),S=y.x,_=y.y,N=y.value,k=y.errorVal;if(!k)return null;var j=[],E,T;if(Array.isArray(k)){var O=I4e(k,2);E=O[0],T=O[1]}else E=T=k;if(i==="vertical"){var R=d.scale,q=_+a,$=q+s,L=q-s,A=R(N-E),M=R(N+T);j.push({x1:M,y1:$,x2:M,y2:L}),j.push({x1:A,y1:q,x2:M,y2:q}),j.push({x1:A,y1:$,x2:A,y2:L})}else if(i==="horizontal"){var z=f.scale,I=S+a,B=I-s,F=I+s,U=z(N-E),V=z(N+T);j.push({x1:B,y1:V,x2:F,y2:V}),j.push({x1:I,y1:U,x2:I,y2:V}),j.push({x1:B,y1:U,x2:F,y2:U})}return le.createElement(Ir,N_({className:"recharts-errorBar",key:"bar-".concat(j.map(function(K){return"".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))},p),j.map(function(K){return le.createElement("line",N_({},K,{key:"line-".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))}))});return le.createElement(Ir,{className:"recharts-errorBars"},v)}}])})(le.Component);qoe(Yx,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});qoe(Yx,"displayName","ErrorBar");function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function AG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AG(Object(r),!0).forEach(function(n){Q4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q4e(e,t,r){return t=J4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J4e(e){var t=Z4e(e,"string");return wy(t)=="symbol"?t:t+""}function Z4e(e,t){if(wy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Koe=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=Ns(r,Ip);if(!s)return null;var l=Ip.defaultProps,c=l!==void 0?hf(hf({},l),s.props):{},u;return s.props&&s.props.payload?u=s.props&&s.props.payload:i==="children"?u=(n||[]).reduce(function(d,f){var m=f.item,p=f.props,v=p.sectors||p.data||[];return d.concat(v.map(function(b){return{type:s.props.iconType||m.props.legendType,value:b.name,color:b.fill,payload:b}}))},[]):u=(n||[]).map(function(d){var f=d.item,m=f.type.defaultProps,p=m!==void 0?hf(hf({},m),f.props):{},v=p.dataKey,b=p.name,y=p.legendType,S=p.hide;return{inactive:S,dataKey:v,type:c.iconType||y||"square",color:Pz(f),value:b||v,payload:p}}),hf(hf(hf({},c),Ip.getWithHeight(s,a)),{},{payload:u,item:s})};function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function DG(e){return r3e(e)||t3e(e)||e3e(e)||X4e()}function X4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e3e(e,t){if(e){if(typeof e=="string")return pI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pI(e,t)}}function t3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function r3e(e){if(Array.isArray(e))return pI(e)}function pI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LG(Object(r),!0).forEach(function(n){Pp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pp(e,t,r){return t=n3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n3e(e){var t=a3e(e,"string");return Sy(t)=="symbol"?t:t+""}function a3e(e,t){if(Sy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(e,t,r){return tr(e)||tr(t)?r:ja(t)?Ds(e,t,r):Jt(t)?t(e):r}function Mb(e,t,r,n){var a=n4e(e,function(l){return Ca(l,t)});if(r==="number"){var i=a.filter(function(l){return et(l)||parseFloat(l)});return i.length?[Tj(i),Mj(i)]:[1/0,-1/0]}var s=n?a.filter(function(l){return!tr(l)}):a;return s.map(function(l){return ja(l)||l instanceof Date?l:""})}var i3e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<l;u++){var d=u>0?a[u-1].coordinate:a[l-1].coordinate,f=a[u].coordinate,m=u>=l-1?a[0].coordinate:a[u+1].coordinate,p=void 0;if(Ai(f-d)!==Ai(m-f)){var v=[];if(Ai(m-f)===Ai(c[1]-c[0])){p=m;var b=f+c[1]-c[0];v[0]=Math.min(b,(b+d)/2),v[1]=Math.max(b,(b+d)/2)}else{p=d;var y=m+c[1]-c[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var S=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(t>S[0]&&t<=S[1]||t>=v[0]&&t<=v[1]){s=a[u].index;break}}else{var _=Math.min(d,m),N=Math.max(d,m);if(t>(_+f)/2&&t<=(N+f)/2){s=a[u].index;break}}}else for(var k=0;k<l;k++)if(k===0&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k>0&&k<l-1&&t>(n[k].coordinate+n[k-1].coordinate)/2&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k===l-1&&t>(n[k].coordinate+n[k-1].coordinate)/2){s=n[k].index;break}return s},Pz=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Kn(Kn({},t.type.defaultProps),t.props):t.props,s=i.stroke,l=i.fill,c;switch(a){case"Line":c=s;break;case"Area":case"Radar":c=s&&s!=="none"?s:l;break;default:c=l;break}return c},s3e=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},l=Object.keys(i),c=0,u=l.length;c<u;c++)for(var d=i[l[c]].stackGroups,f=Object.keys(d),m=0,p=f.length;m<p;m++){var v=d[f[m]],b=v.items,y=v.cateAxisId,S=b.filter(function(T){return Yc(T.type).indexOf("Bar")>=0});if(S&&S.length){var _=S[0].type.defaultProps,N=_!==void 0?Kn(Kn({},_),S[0].props):S[0].props,k=N.barSize,j=N[y];s[j]||(s[j]=[]);var E=tr(k)?r:k;s[j].push({item:S[0],stackList:S.slice(1),barSize:tr(E)?void 0:Di(E,n,0)})}}return s},o3e=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,l=t.maxBarSize,c=s.length;if(c<1)return null;var u=Di(r,a,0,!0),d,f=[];if(s[0].barSize===+s[0].barSize){var m=!1,p=a/c,v=s.reduce(function(k,j){return k+j.barSize||0},0);v+=(c-1)*u,v>=a&&(v-=(c-1)*u,u=0),v>=a&&p>0&&(m=!0,p*=.9,v=c*p);var b=(a-v)/2>>0,y={offset:b-u,size:0};d=s.reduce(function(k,j){var E={item:j.item,position:{offset:y.offset+y.size+u,size:m?p:j.barSize}},T=[].concat(DG(k),[E]);return y=T[T.length-1].position,j.stackList&&j.stackList.length&&j.stackList.forEach(function(O){T.push({item:O,position:y})}),T},f)}else{var S=Di(n,a,0,!0);a-2*S-(c-1)*u<=0&&(u=0);var _=(a-2*S-(c-1)*u)/c;_>1&&(_>>=0);var N=l===+l?Math.min(_,l):_;d=s.reduce(function(k,j,E){var T=[].concat(DG(k),[{item:j.item,position:{offset:S+(_+u)*E+(_-N)/2,size:N}}]);return j.stackList&&j.stackList.length&&j.stackList.forEach(function(O){T.push({item:O,position:T[T.length-1].position})}),T},f)}return d},l3e=function(t,r,n,a){var i=n.children,s=n.width,l=n.margin,c=s-(l.left||0)-(l.right||0),u=Koe({children:i,legendWidth:c});if(u){var d=a||{},f=d.width,m=d.height,p=u.align,v=u.verticalAlign,b=u.layout;if((b==="vertical"||b==="horizontal"&&v==="middle")&&p!=="center"&&et(t[p]))return Kn(Kn({},t),{},Pp({},p,t[p]+(f||0)));if((b==="horizontal"||b==="vertical"&&p==="center")&&v!=="middle"&&et(t[v]))return Kn(Kn({},t),{},Pp({},v,t[v]+(m||0)))}return t},c3e=function(t,r,n){return tr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},Goe=function(t,r,n,a,i){var s=r.props.children,l=Ls(s,Yx).filter(function(u){return c3e(a,i,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=Ca(d,n);if(tr(f))return u;var m=Array.isArray(f)?[Tj(f),Mj(f)]:[f,f],p=c.reduce(function(v,b){var y=Ca(d,b,0),S=m[0]-Math.abs(Array.isArray(y)?y[0]:y),_=m[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(S,v[0]),Math.max(_,v[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},u3e=function(t,r,n,a,i){var s=r.map(function(l){return Goe(t,l,n,i,a)}).filter(function(l){return!tr(l)});return s&&s.length?s.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},Voe=function(t,r,n,a,i){var s=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&Goe(t,c,u,a)||Mb(t,u,n,i)});if(n==="number")return s.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return s.reduce(function(c,u){for(var d=0,f=u.length;d<f;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},Yoe=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},Qoe=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,s,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate});return i||l.push(r),s||l.push(n),l},Uc=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&l?.length>=2?Ai(l[0]-l[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var m=i?i.indexOf(f):f;return{coordinate:a(m)+u,value:f,offset:u}});return d.filter(function(f){return!Fx(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,m){return{coordinate:a(f)+u,value:f,index:m,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+u,value:f,offset:u}}):a.domain().map(function(f,m){return{coordinate:a(f)+u,value:i?i[f]:f,index:m,offset:u}})},FA=new WeakMap,tS=function(t,r){if(typeof r!="function")return t;FA.has(t)||FA.set(t,new WeakMap);var n=FA.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},Joe=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,l=t.axisType;if(a==="auto")return s==="radial"&&l==="radiusAxis"?{scale:py(),realScaleType:"band"}:s==="radial"&&l==="angleAxis"?{scale:x_(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Eb(),realScaleType:"point"}:i==="category"?{scale:py(),realScaleType:"band"}:{scale:x_(),realScaleType:"linear"};if(yh(a)){var c="scale".concat(mj(a));return{scale:(bG[c]||Eb)(),realScaleType:bG[c]?c:"point"}}return Jt(a)?{scale:a}:{scale:Eb(),realScaleType:"point"}},OG=1e-4,Zoe=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-OG,s=Math.max(a[0],a[1])+OG,l=t(r[0]),c=t(r[n-1]);(l<i||l>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},d3e=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},f3e=function(t,r){if(!r||r.length!==2||!et(r[0])||!et(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!et(t[0])||t[0]<n)&&(i[0]=n),(!et(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},h3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,l=0;l<r;++l){var c=Fx(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=s,t[l][n][1]=s+c,s=t[l][n][1])}},m3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var l=Fx(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},p3e={sign:h3e,expand:JNe,none:Jp,silhouette:ZNe,wiggle:XNe,positive:m3e},g3e=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=p3e[n],s=QNe().keys(a).value(function(l,c){return+Ca(l,c,0)}).order(qO).offset(i);return s(t)},v3e=function(t,r,n,a,i,s){if(!t)return null;var l=s?r.reverse():r,c={},u=l.reduce(function(f,m){var p,v=(p=m.type)!==null&&p!==void 0&&p.defaultProps?Kn(Kn({},m.type.defaultProps),m.props):m.props,b=v.stackId,y=v.hide;if(y)return f;var S=v[n],_=f[S]||{hasStack:!1,stackGroups:{}};if(ja(b)){var N=_.stackGroups[b]||{numericAxisId:n,cateAxisId:a,items:[]};N.items.push(m),_.hasStack=!0,_.stackGroups[b]=N}else _.stackGroups[l0("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[m]};return Kn(Kn({},f),{},Pp({},S,_))},c),d={};return Object.keys(u).reduce(function(f,m){var p=u[m];if(p.hasStack){var v={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(b,y){var S=p.stackGroups[y];return Kn(Kn({},b),{},Pp({},y,{numericAxisId:n,cateAxisId:a,items:S.items,stackedData:g3e(t,S.items,i)}))},v)}return Kn(Kn({},f),{},Pp({},m,p))},d)},Xoe=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=D4e(u,i,l);return t.domain([Tj(d),Mj(d)]),{niceTicks:d}}if(i&&a==="number"){var f=t.domain(),m=L4e(f,i,l);return{niceTicks:m}}return null};function IG(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!tr(a[t.dataKey])){var l=t_(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Ca(a,tr(s)?t.dataKey:s);return tr(c)?null:t.scale(c)}var RG=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=Ca(s,r.dataKey,r.domain[l]);return tr(c)?null:r.scale(c)-i/2+a},b3e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},y3e=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Kn(Kn({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(ja(i)){var s=r[i];if(s){var l=s.items.indexOf(t);return l>=0?s.stackedData[l]:null}}return null},x3e=function(t){return t.reduce(function(r,n){return[Tj(n.concat([r[0]]).filter(et)),Mj(n.concat([r[1]]).filter(et))]},[1/0,-1/0])},ele=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],l=s.stackedData,c=l.reduce(function(u,d){var f=x3e(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},PG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gI=function(t,r,n){if(Jt(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(et(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(PG.test(t[0])){var i=+PG.exec(t[0])[1];a[0]=r[0]-i}else Jt(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(et(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(zG.test(t[1])){var s=+zG.exec(t[1])[1];a[1]=r[1]+s}else Jt(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},j_=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=dz(r,function(f){return f.coordinate}),s=1/0,l=1,c=i.length;l<c;l++){var u=i[l],d=i[l-1];s=Math.min((u.coordinate||0)-(d.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},BG=function(t,r,n){return!t||!t.length||Vx(t,Ds(n,"type.defaultProps.domain"))?r:t},tle=function(t,r){var n=t.type.defaultProps?Kn(Kn({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,l=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return Kn(Kn({},Ut(t,!1)),{},{dataKey:a,unit:s,formatter:l,name:i||a,color:Pz(t),value:Ca(r,a),type:c,payload:r,chartType:u,hide:d})};function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function $G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ic(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(r),!0).forEach(function(n){rle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$G(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rle(e,t,r){return t=w3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w3e(e){var t=S3e(e,"string");return ky(t)=="symbol"?t:t+""}function S3e(e,t){if(ky(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ky(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k3e(e,t){return j3e(e)||C3e(e,t)||N3e(e,t)||_3e()}function _3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N3e(e,t){if(e){if(typeof e=="string")return FG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FG(e,t)}}function FG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function j3e(e){if(Array.isArray(e))return e}var E_=Math.PI/180,E3e=function(t){return t*180/Math.PI},xn=function(t,r,n,a){return{x:t+Math.cos(-E_*a)*n,y:r+Math.sin(-E_*a)*n}},nle=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},M3e=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.startAngle,u=t.endAngle,d=Di(t.cx,s,s/2),f=Di(t.cy,l,l/2),m=nle(s,l,n),p=Di(t.innerRadius,m,0),v=Di(t.outerRadius,m,m*.8),b=Object.keys(r);return b.reduce(function(y,S){var _=r[S],N=_.domain,k=_.reversed,j;if(tr(_.range))a==="angleAxis"?j=[c,u]:a==="radiusAxis"&&(j=[p,v]),k&&(j=[j[1],j[0]]);else{j=_.range;var E=j,T=k3e(E,2);c=T[0],u=T[1]}var O=Joe(_,i),R=O.realScaleType,q=O.scale;q.domain(N).range(j),Zoe(q);var $=Xoe(q,Ic(Ic({},_),{},{realScaleType:R})),L=Ic(Ic(Ic({},_),$),{},{range:j,radius:v,realScaleType:R,scale:q,cx:d,cy:f,innerRadius:p,outerRadius:v,startAngle:c,endAngle:u});return Ic(Ic({},y),{},rle({},S,L))},{})},T3e=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},A3e=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,l=T3e({x:n,y:a},{x:i,y:s});if(l<=0)return{radius:l};var c=(n-i)/l,u=Math.acos(c);return a>s&&(u=2*Math.PI-u),{radius:l,angle:E3e(u),angleInRadian:u}},D3e=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},L3e=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),l=Math.min(i,s);return t+l*360},UG=function(t,r){var n=t.x,a=t.y,i=A3e({x:n,y:a},r),s=i.radius,l=i.angle,c=r.innerRadius,u=r.outerRadius;if(s<c||s>u)return!1;if(s===0)return!0;var d=D3e(r),f=d.startAngle,m=d.endAngle,p=l,v;if(f<=m){for(;p>m;)p-=360;for(;p<f;)p+=360;v=p>=f&&p<=m}else{for(;p>f;)p-=360;for(;p<m;)p+=360;v=p>=m&&p<=f}return v?Ic(Ic({},r),{},{radius:s,angle:L3e(p,r)}):null},ale=function(t){return!w.isValidElement(t)&&!Jt(t)&&typeof t!="boolean"?t.className:""};function _y(e){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}var O3e=["offset"];function I3e(e){return B3e(e)||z3e(e)||P3e(e)||R3e()}function R3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P3e(e,t){if(e){if(typeof e=="string")return vI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vI(e,t)}}function z3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B3e(e){if(Array.isArray(e))return vI(e)}function vI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $3e(e,t){if(e==null)return{};var r=F3e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HG(Object(r),!0).forEach(function(n){U3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U3e(e,t,r){return t=H3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H3e(e){var t=q3e(e,"string");return _y(t)=="symbol"?t:t+""}function q3e(e,t){if(_y(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ny(){return Ny=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ny.apply(this,arguments)}var W3e=function(t){var r=t.value,n=t.formatter,a=tr(t.children)?r:t.children;return Jt(n)?n(a):a},K3e=function(t,r){var n=Ai(r-t),a=Math.min(Math.abs(r-t),360);return n*a},G3e=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,l=t.className,c=i,u=c.cx,d=c.cy,f=c.innerRadius,m=c.outerRadius,p=c.startAngle,v=c.endAngle,b=c.clockWise,y=(f+m)/2,S=K3e(p,v),_=S>=0?1:-1,N,k;a==="insideStart"?(N=p+_*s,k=b):a==="insideEnd"?(N=v-_*s,k=!b):a==="end"&&(N=v+_*s,k=b),k=S<=0?k:!k;var j=xn(u,d,y,N),E=xn(u,d,y,N+(k?1:-1)*359),T="M".concat(j.x,",").concat(j.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(k?0:1,`,
    `).concat(E.x,",").concat(E.y),O=tr(t.id)?l0("recharts-radial-line-"):t.id;return le.createElement("text",Ny({},n,{dominantBaseline:"central",className:ur("recharts-radial-bar-label",l)}),le.createElement("defs",null,le.createElement("path",{id:O,d:T})),le.createElement("textPath",{xlinkHref:"#".concat(O)},r))},V3e=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,l=i.cy,c=i.innerRadius,u=i.outerRadius,d=i.startAngle,f=i.endAngle,m=(d+f)/2;if(a==="outside"){var p=xn(s,l,u+n,m),v=p.x,b=p.y;return{x:v,y:b,textAnchor:v>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+u)/2,S=xn(s,l,y,m),_=S.x,N=S.y;return{x:_,y:N,textAnchor:"middle",verticalAnchor:"middle"}},Y3e=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,l=s.x,c=s.y,u=s.width,d=s.height,f=d>=0?1:-1,m=f*a,p=f>0?"end":"start",v=f>0?"start":"end",b=u>=0?1:-1,y=b*a,S=b>0?"end":"start",_=b>0?"start":"end";if(i==="top"){var N={x:l+u/2,y:c-f*a,textAnchor:"middle",verticalAnchor:p};return _a(_a({},N),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var k={x:l+u/2,y:c+d+m,textAnchor:"middle",verticalAnchor:v};return _a(_a({},k),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(i==="left"){var j={x:l-y,y:c+d/2,textAnchor:S,verticalAnchor:"middle"};return _a(_a({},j),n?{width:Math.max(j.x-n.x,0),height:d}:{})}if(i==="right"){var E={x:l+u+y,y:c+d/2,textAnchor:_,verticalAnchor:"middle"};return _a(_a({},E),n?{width:Math.max(n.x+n.width-E.x,0),height:d}:{})}var T=n?{width:u,height:d}:{};return i==="insideLeft"?_a({x:l+y,y:c+d/2,textAnchor:_,verticalAnchor:"middle"},T):i==="insideRight"?_a({x:l+u-y,y:c+d/2,textAnchor:S,verticalAnchor:"middle"},T):i==="insideTop"?_a({x:l+u/2,y:c+m,textAnchor:"middle",verticalAnchor:v},T):i==="insideBottom"?_a({x:l+u/2,y:c+d-m,textAnchor:"middle",verticalAnchor:p},T):i==="insideTopLeft"?_a({x:l+y,y:c+m,textAnchor:_,verticalAnchor:v},T):i==="insideTopRight"?_a({x:l+u-y,y:c+m,textAnchor:S,verticalAnchor:v},T):i==="insideBottomLeft"?_a({x:l+y,y:c+d-m,textAnchor:_,verticalAnchor:p},T):i==="insideBottomRight"?_a({x:l+u-y,y:c+d-m,textAnchor:S,verticalAnchor:p},T):o0(i)&&(et(i.x)||qf(i.x))&&(et(i.y)||qf(i.y))?_a({x:l+Di(i.x,u),y:c+Di(i.y,d),textAnchor:"end",verticalAnchor:"end"},T):_a({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},T)},Q3e=function(t){return"cx"in t&&et(t.cx)};function $a(e){var t=e.offset,r=t===void 0?5:t,n=$3e(e,O3e),a=_a({offset:r},n),i=a.viewBox,s=a.position,l=a.value,c=a.children,u=a.content,d=a.className,f=d===void 0?"":d,m=a.textBreakAll;if(!i||tr(l)&&tr(c)&&!w.isValidElement(u)&&!Jt(u))return null;if(w.isValidElement(u))return w.cloneElement(u,a);var p;if(Jt(u)){if(p=w.createElement(u,a),w.isValidElement(p))return p}else p=W3e(a);var v=Q3e(i),b=Ut(a,!0);if(v&&(s==="insideStart"||s==="insideEnd"||s==="end"))return G3e(a,p,b);var y=v?V3e(a):Y3e(a);return le.createElement(wh,Ny({className:ur("recharts-label",f)},b,y,{breakAll:m}),p)}$a.displayName="Label";var ile=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,l=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,m=t.y,p=t.top,v=t.left,b=t.width,y=t.height,S=t.clockWise,_=t.labelViewBox;if(_)return _;if(et(b)&&et(y)){if(et(f)&&et(m))return{x:f,y:m,width:b,height:y};if(et(p)&&et(v))return{x:p,y:v,width:b,height:y}}return et(f)&&et(m)?{x:f,y:m,width:0,height:0}:et(r)&&et(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:S}:t.viewBox?t.viewBox:{}},J3e=function(t,r){return t?t===!0?le.createElement($a,{key:"label-implicit",viewBox:r}):ja(t)?le.createElement($a,{key:"label-implicit",viewBox:r,value:t}):w.isValidElement(t)?t.type===$a?w.cloneElement(t,{key:"label-implicit",viewBox:r}):le.createElement($a,{key:"label-implicit",content:t,viewBox:r}):Jt(t)?le.createElement($a,{key:"label-implicit",content:t,viewBox:r}):o0(t)?le.createElement($a,Ny({viewBox:r},t,{key:"label-implicit"})):null:null},Z3e=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=ile(t),s=Ls(a,$a).map(function(c,u){return w.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return s;var l=J3e(t.label,r||i);return[l].concat(I3e(s))};$a.parseViewBox=ile;$a.renderCallByParent=Z3e;var UA,qG;function X3e(){if(qG)return UA;qG=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return UA=e,UA}var eAe=X3e();const tAe=Fr(eAe);function Cy(e){"@babel/helpers - typeof";return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cy(e)}var rAe=["valueAccessor"],nAe=["data","dataKey","clockWise","id","textBreakAll"];function aAe(e){return lAe(e)||oAe(e)||sAe(e)||iAe()}function iAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sAe(e,t){if(e){if(typeof e=="string")return bI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bI(e,t)}}function oAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lAe(e){if(Array.isArray(e))return bI(e)}function bI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function M_(){return M_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M_.apply(this,arguments)}function WG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WG(Object(r),!0).forEach(function(n){cAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cAe(e,t,r){return t=uAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uAe(e){var t=dAe(e,"string");return Cy(t)=="symbol"?t:t+""}function dAe(e,t){if(Cy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GG(e,t){if(e==null)return{};var r=fAe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fAe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var hAe=function(t){return Array.isArray(t.value)?tAe(t.value):t.value};function Zc(e){var t=e.valueAccessor,r=t===void 0?hAe:t,n=GG(e,rAe),a=n.data,i=n.dataKey,s=n.clockWise,l=n.id,c=n.textBreakAll,u=GG(n,nAe);return!a||!a.length?null:le.createElement(Ir,{className:"recharts-label-list"},a.map(function(d,f){var m=tr(i)?r(d,f):Ca(d&&d.payload,i),p=tr(l)?{}:{id:"".concat(l,"-").concat(f)};return le.createElement($a,M_({},Ut(d,!0),u,p,{parentViewBox:d.parentViewBox,value:m,textBreakAll:c,viewBox:$a.parseViewBox(tr(s)?d:KG(KG({},d),{},{clockWise:s})),key:"label-".concat(f),index:f}))}))}Zc.displayName="LabelList";function mAe(e,t){return e?e===!0?le.createElement(Zc,{key:"labelList-implicit",data:t}):le.isValidElement(e)||Jt(e)?le.createElement(Zc,{key:"labelList-implicit",data:t,content:e}):o0(e)?le.createElement(Zc,M_({data:t},e,{key:"labelList-implicit"})):null:null}function pAe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Ls(n,Zc).map(function(s,l){return w.cloneElement(s,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=mAe(e.label,t);return[i].concat(aAe(a))}Zc.renderCallByParent=pAe;function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function yI(){return yI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yI.apply(this,arguments)}function VG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VG(Object(r),!0).forEach(function(n){gAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gAe(e,t,r){return t=vAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vAe(e){var t=bAe(e,"string");return jy(t)=="symbol"?t:t+""}function bAe(e,t){if(jy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yAe=function(t,r){var n=Ai(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},rS=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,l=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(l?1:-1)+a,f=Math.asin(c/d)/E_,m=u?i:i+s*f,p=xn(r,n,d,m),v=xn(r,n,a,m),b=u?i-s*f:i,y=xn(r,n,d*Math.cos(f*E_),b);return{center:p,circleTangency:v,lineTangency:y,theta:f}},sle=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,l=t.endAngle,c=yAe(s,l),u=s+c,d=xn(r,n,i,s),f=xn(r,n,i,u),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var p=xn(r,n,a,s),v=xn(r,n,a,u);m+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else m+="L ".concat(r,",").concat(n," Z");return m},xAe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=Ai(d-u),m=rS({cx:r,cy:n,radius:i,angle:u,sign:f,cornerRadius:s,cornerIsExternal:c}),p=m.circleTangency,v=m.lineTangency,b=m.theta,y=rS({cx:r,cy:n,radius:i,angle:d,sign:-f,cornerRadius:s,cornerIsExternal:c}),S=y.circleTangency,_=y.lineTangency,N=y.theta,k=c?Math.abs(u-d):Math.abs(u-d)-b-N;if(k<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):sle({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var j="M ".concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(k>180),",").concat(+(f<0),",").concat(S.x,",").concat(S.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(_.x,",").concat(_.y,`
  `);if(a>0){var E=rS({cx:r,cy:n,radius:a,angle:u,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),T=E.circleTangency,O=E.lineTangency,R=E.theta,q=rS({cx:r,cy:n,radius:a,angle:d,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),$=q.circleTangency,L=q.lineTangency,A=q.theta,M=c?Math.abs(u-d):Math.abs(u-d)-R-A;if(M<0&&s===0)return"".concat(j,"L").concat(r,",").concat(n,"Z");j+="L".concat(L.x,",").concat(L.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat($.x,",").concat($.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(M>180),",").concat(+(f>0),",").concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,"Z")}else j+="L".concat(r,",").concat(n,"Z");return j},wAe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},ole=function(t){var r=YG(YG({},wAe),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,m=r.className;if(s<i||d===f)return null;var p=ur("recharts-sector",m),v=s-i,b=Di(l,v,0,!0),y;return b>0&&Math.abs(d-f)<360?y=xAe({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(b,v/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:f}):y=sle({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:d,endAngle:f}),le.createElement("path",yI({},Ut(r,!0),{className:p,d:y,role:"img"}))};function Ey(e){"@babel/helpers - typeof";return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(e)}function xI(){return xI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xI.apply(this,arguments)}function QG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function JG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QG(Object(r),!0).forEach(function(n){SAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SAe(e,t,r){return t=kAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kAe(e){var t=_Ae(e,"string");return Ey(t)=="symbol"?t:t+""}function _Ae(e,t){if(Ey(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ey(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZG={curveBasisClosed:BNe,curveBasisOpen:$Ne,curveBasis:zNe,curveBumpX:_Ne,curveBumpY:NNe,curveLinearClosed:FNe,curveLinear:gj,curveMonotoneX:UNe,curveMonotoneY:HNe,curveNatural:qNe,curveStep:WNe,curveStepAfter:GNe,curveStepBefore:KNe},nS=function(t){return t.x===+t.x&&t.y===+t.y},kv=function(t){return t.x},_v=function(t){return t.y},NAe=function(t,r){if(Jt(t))return t;var n="curve".concat(mj(t));return(n==="curveMonotone"||n==="curveBump")&&r?ZG["".concat(n).concat(r==="vertical"?"Y":"X")]:ZG[n]||gj},CAe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,l=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=NAe(n,l),f=u?i.filter(function(b){return nS(b)}):i,m;if(Array.isArray(s)){var p=u?s.filter(function(b){return nS(b)}):s,v=f.map(function(b,y){return JG(JG({},b),{},{base:p[y]})});return l==="vertical"?m=Gw().y(_v).x1(kv).x0(function(b){return b.base.x}):m=Gw().x(kv).y1(_v).y0(function(b){return b.base.y}),m.defined(nS).curve(d),m(v)}return l==="vertical"&&et(s)?m=Gw().y(_v).x1(kv).x0(s):et(s)?m=Gw().x(kv).y1(_v).y0(s):m=nse().x(kv).y(_v),m.defined(nS).curve(d),m(f)},T_=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?CAe(t):a;return w.createElement("path",xI({},Ut(t,!1),r_(t),{className:ur("recharts-curve",r),d:s,ref:i}))},HA={exports:{}},qA,XG;function jAe(){if(XG)return qA;XG=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return qA=e,qA}var WA,eV;function EAe(){if(eV)return WA;eV=1;var e=jAe();function t(){}function r(){}return r.resetWarningCache=t,WA=function(){function n(s,l,c,u,d,f){if(f!==e){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return i.PropTypes=i,i},WA}var tV;function MAe(){return tV||(tV=1,HA.exports=EAe()()),HA.exports}var TAe=MAe();const qr=Fr(TAe),{getOwnPropertyNames:AAe,getOwnPropertySymbols:DAe}=Object,{hasOwnProperty:LAe}=Object.prototype;function KA(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function aS(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:i}=a,s=i.get(r),l=i.get(n);if(s&&l)return s===n&&l===r;i.set(r,n),i.set(n,r);const c=e(r,n,a);return i.delete(r),i.delete(n),c}}function OAe(e){return e?.[Symbol.toStringTag]}function rV(e){return AAe(e).concat(DAe(e))}const IAe=Object.hasOwn||((e,t)=>LAe.call(e,t));function Yh(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const RAe="__v",PAe="__o",zAe="_owner",{getOwnPropertyDescriptor:nV,keys:aV}=Object;function BAe(e,t){return e.byteLength===t.byteLength&&A_(new Uint8Array(e),new Uint8Array(t))}function $Ae(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function FAe(e,t){return e.byteLength===t.byteLength&&A_(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function UAe(e,t){return Yh(e.getTime(),t.getTime())}function HAe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function qAe(e,t){return e===t}function iV(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.entries();let s,l,c=0;for(;(s=i.next())&&!s.done;){const u=t.entries();let d=!1,f=0;for(;(l=u.next())&&!l.done;){if(a[f]){f++;continue}const m=s.value,p=l.value;if(r.equals(m[0],p[0],c,f,e,t,r)&&r.equals(m[1],p[1],m[0],p[0],e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1;c++}return!0}const WAe=Yh;function KAe(e,t,r){const n=aV(e);let a=n.length;if(aV(t).length!==a)return!1;for(;a-- >0;)if(!lle(e,t,r,n[a]))return!1;return!0}function Nv(e,t,r){const n=rV(e);let a=n.length;if(rV(t).length!==a)return!1;let i,s,l;for(;a-- >0;)if(i=n[a],!lle(e,t,r,i)||(s=nV(e,i),l=nV(t,i),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function GAe(e,t){return Yh(e.valueOf(),t.valueOf())}function VAe(e,t){return e.source===t.source&&e.flags===t.flags}function sV(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.values();let s,l;for(;(s=i.next())&&!s.done;){const c=t.values();let u=!1,d=0;for(;(l=c.next())&&!l.done;){if(!a[d]&&r.equals(s.value,l.value,s.value,l.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function A_(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function YAe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function lle(e,t,r,n){return(n===zAe||n===PAe||n===RAe)&&(e.$$typeof||t.$$typeof)?!0:IAe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const QAe="[object ArrayBuffer]",JAe="[object Arguments]",ZAe="[object Boolean]",XAe="[object DataView]",eDe="[object Date]",tDe="[object Error]",rDe="[object Map]",nDe="[object Number]",aDe="[object Object]",iDe="[object RegExp]",sDe="[object Set]",oDe="[object String]",lDe={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},cDe="[object URL]",uDe=Object.prototype.toString;function dDe({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:s,areNumbersEqual:l,areObjectsEqual:c,arePrimitiveWrappersEqual:u,areRegExpsEqual:d,areSetsEqual:f,areTypedArraysEqual:m,areUrlsEqual:p,unknownTagComparators:v}){return function(y,S,_){if(y===S)return!0;if(y==null||S==null)return!1;const N=typeof y;if(N!==typeof S)return!1;if(N!=="object")return N==="number"?l(y,S,_):N==="function"?i(y,S,_):!1;const k=y.constructor;if(k!==S.constructor)return!1;if(k===Object)return c(y,S,_);if(Array.isArray(y))return t(y,S,_);if(k===Date)return n(y,S,_);if(k===RegExp)return d(y,S,_);if(k===Map)return s(y,S,_);if(k===Set)return f(y,S,_);const j=uDe.call(y);if(j===eDe)return n(y,S,_);if(j===iDe)return d(y,S,_);if(j===rDe)return s(y,S,_);if(j===sDe)return f(y,S,_);if(j===aDe)return typeof y.then!="function"&&typeof S.then!="function"&&c(y,S,_);if(j===cDe)return p(y,S,_);if(j===tDe)return a(y,S,_);if(j===JAe)return c(y,S,_);if(lDe[j])return m(y,S,_);if(j===QAe)return e(y,S,_);if(j===XAe)return r(y,S,_);if(j===ZAe||j===nDe||j===oDe)return u(y,S,_);if(v){let E=v[j];if(!E){const T=OAe(y);T&&(E=v[T])}if(E)return E(y,S,_)}return!1}}function fDe({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:BAe,areArraysEqual:r?Nv:$Ae,areDataViewsEqual:FAe,areDatesEqual:UAe,areErrorsEqual:HAe,areFunctionsEqual:qAe,areMapsEqual:r?KA(iV,Nv):iV,areNumbersEqual:WAe,areObjectsEqual:r?Nv:KAe,arePrimitiveWrappersEqual:GAe,areRegExpsEqual:VAe,areSetsEqual:r?KA(sV,Nv):sV,areTypedArraysEqual:r?KA(A_,Nv):A_,areUrlsEqual:YAe,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=aS(n.areArraysEqual),i=aS(n.areMapsEqual),s=aS(n.areObjectsEqual),l=aS(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:l})}return n}function hDe(e){return function(t,r,n,a,i,s,l){return e(t,r,l)}}function mDe({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(l,c){const{cache:u=e?new WeakMap:void 0,meta:d}=r();return t(l,c,{cache:u,equals:n,meta:d,strict:a})};if(e)return function(l,c){return t(l,c,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(l,c){return t(l,c,i)}}const cle=Ud();Ud({strict:!0});Ud({circular:!0});Ud({circular:!0,strict:!0});Ud({createInternalComparator:()=>Yh});Ud({strict:!0,createInternalComparator:()=>Yh});Ud({circular:!0,createInternalComparator:()=>Yh});Ud({circular:!0,createInternalComparator:()=>Yh,strict:!0});function Ud(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,i=fDe(e),s=dDe(i),l=r?r(s):hDe(s);return mDe({circular:t,comparator:s,createState:n,equals:l,strict:a})}function pDe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function oV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):pDe(a)};requestAnimationFrame(n)}function wI(e){"@babel/helpers - typeof";return wI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wI(e)}function gDe(e){return xDe(e)||yDe(e)||bDe(e)||vDe()}function vDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bDe(e,t){if(e){if(typeof e=="string")return lV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lV(e,t)}}function lV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xDe(e){if(Array.isArray(e))return e}function wDe(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,l=gDe(s),c=l[0],u=l.slice(1);if(typeof c=="number"){oV(a.bind(null,u),c);return}a(c),oV(a.bind(null,u));return}wI(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function My(e){"@babel/helpers - typeof";return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},My(e)}function cV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cV(Object(r),!0).forEach(function(n){ule(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ule(e,t,r){return t=SDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SDe(e){var t=kDe(e,"string");return My(t)==="symbol"?t:String(t)}function kDe(e,t){if(My(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(My(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _De=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},NDe=function(t){return t},CDe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Tb=function(t,r){return Object.keys(r).reduce(function(n,a){return uV(uV({},n),{},ule({},a,t(a,r[a])))},{})},dV=function(t,r,n){return t.map(function(a){return"".concat(CDe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function jDe(e,t){return TDe(e)||MDe(e,t)||dle(e,t)||EDe()}function EDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function TDe(e){if(Array.isArray(e))return e}function ADe(e){return ODe(e)||LDe(e)||dle(e)||DDe()}function DDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dle(e,t){if(e){if(typeof e=="string")return SI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SI(e,t)}}function LDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ODe(e){if(Array.isArray(e))return SI(e)}function SI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var D_=1e-4,fle=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},hle=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},fV=function(t,r){return function(n){var a=fle(t,r);return hle(a,n)}},IDe=function(t,r){return function(n){var a=fle(t,r),i=[].concat(ADe(a.map(function(s,l){return s*l}).slice(1)),[0]);return hle(i,n)}},hV=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,l=1;break;case"ease":a=.25,i=.1,s=.25,l=1;break;case"ease-in":a=.42,i=0,s=1,l=1;break;case"ease-out":a=.42,i=0,s=.58,l=1;break;case"ease-in-out":a=0,i=0,s=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),d=jDe(u,4);a=d[0],i=d[1],s=d[2],l=d[3]}}}var f=fV(a,s),m=fV(i,l),p=IDe(a,s),v=function(S){return S>1?1:S<0?0:S},b=function(S){for(var _=S>1?1:S,N=_,k=0;k<8;++k){var j=f(N)-_,E=p(N);if(Math.abs(j-_)<D_||E<D_)return m(N);N=v(N-j/E)}return m(N)};return b.isStepper=!1,b},RDe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,l=s===void 0?17:s,c=function(d,f,m){var p=-(d-f)*n,v=m*i,b=m+(p-v)*l/1e3,y=m*l/1e3+d;return Math.abs(y-f)<D_&&Math.abs(b)<D_?[f,0]:[y,b]};return c.isStepper=!0,c.dt=l,c},PDe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return hV(a);case"spring":return RDe();default:if(a.split("(")[0]==="cubic-bezier")return hV(a)}return typeof a=="function"?a:null};function Ty(e){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function mV(e){return $De(e)||BDe(e)||mle(e)||zDe()}function zDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $De(e){if(Array.isArray(e))return _I(e)}function pV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pV(Object(r),!0).forEach(function(n){kI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kI(e,t,r){return t=FDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FDe(e){var t=UDe(e,"string");return Ty(t)==="symbol"?t:String(t)}function UDe(e,t){if(Ty(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HDe(e,t){return KDe(e)||WDe(e,t)||mle(e,t)||qDe()}function qDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mle(e,t){if(e){if(typeof e=="string")return _I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _I(e,t)}}function _I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function KDe(e){if(Array.isArray(e))return e}var L_=function(t,r,n){return t+(r-t)*n},NI=function(t){var r=t.from,n=t.to;return r!==n},GDe=function e(t,r,n){var a=Tb(function(i,s){if(NI(s)){var l=t(s.from,s.to,s.velocity),c=HDe(l,2),u=c[0],d=c[1];return ei(ei({},s),{},{from:u,velocity:d})}return s},r);return n<1?Tb(function(i,s){return NI(s)?ei(ei({},s),{},{velocity:L_(s.velocity,a[i].velocity,n),from:L_(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const VDe=(function(e,t,r,n,a){var i=_De(e,t),s=i.reduce(function(y,S){return ei(ei({},y),{},kI({},S,[e[S],t[S]]))},{}),l=i.reduce(function(y,S){return ei(ei({},y),{},kI({},S,{from:e[S],velocity:0,to:t[S]}))},{}),c=-1,u,d,f=function(){return null},m=function(){return Tb(function(S,_){return _.from},l)},p=function(){return!Object.values(l).filter(NI).length},v=function(S){u||(u=S);var _=S-u,N=_/r.dt;l=GDe(r,l,N),a(ei(ei(ei({},e),t),m())),u=S,p()||(c=requestAnimationFrame(f))},b=function(S){d||(d=S);var _=(S-d)/n,N=Tb(function(j,E){return L_.apply(void 0,mV(E).concat([r(_)]))},s);if(a(ei(ei(ei({},e),t),N)),_<1)c=requestAnimationFrame(f);else{var k=Tb(function(j,E){return L_.apply(void 0,mV(E).concat([r(1)]))},s);a(ei(ei(ei({},e),t),k))}};return f=r.isStepper?v:b,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}});function sg(e){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(e)}var YDe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function QDe(e,t){if(e==null)return{};var r=JDe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JDe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function GA(e){return tLe(e)||eLe(e)||XDe(e)||ZDe()}function ZDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XDe(e,t){if(e){if(typeof e=="string")return CI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CI(e,t)}}function eLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tLe(e){if(Array.isArray(e))return CI(e)}function CI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gV(Object(r),!0).forEach(function(n){db(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function db(e,t,r){return t=ple(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ple(n.key),n)}}function aLe(e,t,r){return t&&nLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ple(e){var t=iLe(e,"string");return sg(t)==="symbol"?t:String(t)}function iLe(e,t){if(sg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jI(e,t)}function jI(e,t){return jI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jI(e,t)}function oLe(e){var t=lLe();return function(){var n=O_(e),a;if(t){var i=O_(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return EI(this,a)}}function EI(e,t){if(t&&(sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MI(e)}function MI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O_(e){return O_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},O_(e)}var Ll=(function(e){sLe(r,e);var t=oLe(r);function r(n,a){var i;rLe(this,r),i=t.call(this,n,a);var s=i.props,l=s.isActive,c=s.attributeName,u=s.from,d=s.to,f=s.steps,m=s.children,p=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(MI(i)),i.changeStyle=i.changeStyle.bind(MI(i)),!l||p<=0)return i.state={style:{}},typeof m=="function"&&(i.state={style:d}),EI(i);if(f&&f.length)i.state={style:f[0].style};else if(u){if(typeof m=="function")return i.state={style:u},EI(i);i.state={style:c?db({},c,u):u}}else i.state={style:{}};return i}return aLe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,l=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,d=i.to,f=i.from,m=this.state.style;if(l){if(!s){var p={style:c?db({},c,d):d};this.state&&m&&(c&&m[c]!==d||!c&&m!==d)&&this.setState(p);return}if(!(cle(a.to,d)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var b=v||u?f:a.to;if(this.state&&m){var y={style:c?db({},c,b):b};(c&&m[c]!==b||!c&&m!==b)&&this.setState(y)}this.runAnimation(Lo(Lo({},this.props),{},{from:b,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,l=a.to,c=a.duration,u=a.easing,d=a.begin,f=a.onAnimationEnd,m=a.onAnimationStart,p=VDe(s,l,PDe(u),c,this.changeStyle),v=function(){i.stopJSAnimation=p()};this.manager.start([m,d,v,c,f])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,l=a.begin,c=a.onAnimationStart,u=s[0],d=u.style,f=u.duration,m=f===void 0?0:f,p=function(b,y,S){if(S===0)return b;var _=y.duration,N=y.easing,k=N===void 0?"ease":N,j=y.style,E=y.properties,T=y.onAnimationEnd,O=S>0?s[S-1]:y,R=E||Object.keys(j);if(typeof k=="function"||k==="spring")return[].concat(GA(b),[i.runJSAnimation.bind(i,{from:O.style,to:j,duration:_,easing:k}),_]);var q=dV(R,_,k),$=Lo(Lo(Lo({},O.style),j),{},{transition:q});return[].concat(GA(b),[$,_,T]).filter(NDe)};return this.manager.start([c].concat(GA(s.reduce(p,[d,Math.max(m,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=wDe());var i=a.begin,s=a.duration,l=a.attributeName,c=a.to,u=a.easing,d=a.onAnimationStart,f=a.onAnimationEnd,m=a.steps,p=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(a);return}if(m.length>1){this.runStepAnimation(a);return}var b=l?db({},l,c):c,y=dV(Object.keys(b),s,u);v.start([d,i,Lo(Lo({},b),{},{transition:y}),s,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=QDe(a,YDe),u=w.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!l||u===0||s<=0)return i;var f=function(p){var v=p.props,b=v.style,y=b===void 0?{}:b,S=v.className,_=w.cloneElement(p,Lo(Lo({},c),{},{style:Lo(Lo({},y),d),className:S}));return _};return u===1?f(w.Children.only(i)):le.createElement("div",null,w.Children.map(i,function(m){return f(m)}))}}]),r})(w.PureComponent);Ll.displayName="Animate";Ll.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ll.propTypes={from:qr.oneOfType([qr.object,qr.string]),to:qr.oneOfType([qr.object,qr.string]),attributeName:qr.string,duration:qr.number,begin:qr.number,easing:qr.oneOfType([qr.string,qr.func]),steps:qr.arrayOf(qr.shape({duration:qr.number.isRequired,style:qr.object.isRequired,easing:qr.oneOfType([qr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),qr.func]),properties:qr.arrayOf("string"),onAnimationEnd:qr.func})),children:qr.oneOfType([qr.node,qr.func]),isActive:qr.bool,canBegin:qr.bool,onAnimationEnd:qr.func,shouldReAnimate:qr.bool,onAnimationStart:qr.func,onAnimationReStart:qr.func};function TI(){return TI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},TI.apply(null,arguments)}function AI(e,t){return AI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},AI(e,t)}function cLe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,AI(e,t)}function vV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function I_(){return I_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I_.apply(this,arguments)}function uLe(e,t){return mLe(e)||hLe(e,t)||fLe(e,t)||dLe()}function dLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fLe(e,t){if(e){if(typeof e=="string")return bV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bV(e,t)}}function bV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function mLe(e){if(Array.isArray(e))return e}function yV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yV(Object(r),!0).forEach(function(n){pLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pLe(e,t,r){return t=gLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gLe(e){var t=vLe(e,"string");return Ay(t)=="symbol"?t:t+""}function vLe(e,t){if(Ay(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ay(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wV=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(s>0&&i instanceof Array){for(var f=[0,0,0,0],m=0,p=4;m<p;m++)f[m]=i[m]>s?s:i[m];d="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+c*f[0],",").concat(r)),d+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+l*f[1])),d+="L ".concat(t+n,",").concat(r+a-l*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-c*f[2],",").concat(r+a)),d+="L ".concat(t+c*f[3],",").concat(r+a),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-l*f[3])),d+="Z"}else if(s>0&&i===+i&&i>0){var v=Math.min(s,i);d="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+a-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n-c*v,",").concat(r+a,`
            L `).concat(t+c*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t,",").concat(r+a-l*v," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},bLe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(i,i+l),d=Math.max(i,i+l),f=Math.min(s,s+c),m=Math.max(s,s+c);return n>=u&&n<=d&&a>=f&&a<=m}return!1},yLe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zz=function(t){var r=xV(xV({},yLe),t),n=w.useRef(),a=w.useState(-1),i=uLe(a,2),s=i[0],l=i[1];w.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var k=n.current.getTotalLength();k&&l(k)}catch{}},[]);var c=r.x,u=r.y,d=r.width,f=r.height,m=r.radius,p=r.className,v=r.animationEasing,b=r.animationDuration,y=r.animationBegin,S=r.isAnimationActive,_=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var N=ur("recharts-rectangle",p);return _?le.createElement(Ll,{canBegin:s>0,from:{width:d,height:f,x:c,y:u},to:{width:d,height:f,x:c,y:u},duration:b,animationEasing:v,isActive:_},function(k){var j=k.width,E=k.height,T=k.x,O=k.y;return le.createElement(Ll,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:b,isActive:S,easing:v},le.createElement("path",I_({},Ut(r,!0),{className:N,d:wV(T,O,j,E,m),ref:n})))}):le.createElement("path",I_({},Ut(r,!0),{className:N,d:wV(c,u,d,f,m)}))},xLe=["points","className","baseLinePoints","connectNulls"];function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_p.apply(this,arguments)}function wLe(e,t){if(e==null)return{};var r=SLe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function SV(e){return CLe(e)||NLe(e)||_Le(e)||kLe()}function kLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Le(e,t){if(e){if(typeof e=="string")return DI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DI(e,t)}}function NLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CLe(e){if(Array.isArray(e))return DI(e)}function DI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var kV=function(t){return t&&t.x===+t.x&&t.y===+t.y},jLe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){kV(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),kV(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Ab=function(t,r){var n=jLe(t);r&&(n=[n.reduce(function(i,s){return[].concat(SV(i),SV(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,l,c){return"".concat(s).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},ELe=function(t,r,n){var a=Ab(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Ab(r.reverse(),n).slice(1))},MLe=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=wLe(t,xLe);if(!r||!r.length)return null;var l=ur("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",u=ELe(r,a,i);return le.createElement("g",{className:l},le.createElement("path",_p({},Ut(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:u})),c?le.createElement("path",_p({},Ut(s,!0),{fill:"none",d:Ab(r,i)})):null,c?le.createElement("path",_p({},Ut(s,!0),{fill:"none",d:Ab(a,i)})):null)}var d=Ab(r,i);return le.createElement("path",_p({},Ut(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",className:l,d}))};function LI(){return LI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LI.apply(this,arguments)}var Lj=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=ur("recharts-dot",i);return r===+r&&n===+n&&a===+a?w.createElement("circle",LI({},Ut(t,!1),r_(t),{className:s,cx:r,cy:n,r:a})):null};function Dy(e){"@babel/helpers - typeof";return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dy(e)}var TLe=["x","y","top","left","width","height","className"];function OI(){return OI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OI.apply(this,arguments)}function _V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ALe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_V(Object(r),!0).forEach(function(n){DLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_V(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DLe(e,t,r){return t=LLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LLe(e){var t=OLe(e,"string");return Dy(t)=="symbol"?t:t+""}function OLe(e,t){if(Dy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ILe(e,t){if(e==null)return{};var r=RLe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function RLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var PLe=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},zLe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,l=s===void 0?0:s,c=t.left,u=c===void 0?0:c,d=t.width,f=d===void 0?0:d,m=t.height,p=m===void 0?0:m,v=t.className,b=ILe(t,TLe),y=ALe({x:n,y:i,top:l,left:u,width:f,height:p},b);return!et(n)||!et(i)||!et(f)||!et(p)||!et(l)||!et(u)?null:le.createElement("path",OI({},Ut(y,!0),{className:ur("recharts-cross",v),d:PLe(n,i,f,p,l,u)}))},VA,NV;function BLe(){if(NV)return VA;NV=1;var e=Ej(),t=Moe(),r=Hl();function n(a,i){return a&&a.length?e(a,r(i,2),t):void 0}return VA=n,VA}var $Le=BLe();const FLe=Fr($Le);var YA,CV;function ULe(){if(CV)return YA;CV=1;var e=Ej(),t=Hl(),r=Toe();function n(a,i){return a&&a.length?e(a,t(i,2),r):void 0}return YA=n,YA}var HLe=ULe();const qLe=Fr(HLe);var WLe=["cx","cy","angle","ticks","axisLine"],KLe=["ticks","tick","angle","tickFormatter","stroke"];function og(e){"@babel/helpers - typeof";return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(e)}function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Db.apply(this,arguments)}function jV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jV(Object(r),!0).forEach(function(n){Oj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EV(e,t){if(e==null)return{};var r=GLe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function VLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vle(n.key),n)}}function YLe(e,t,r){return t&&MV(e.prototype,t),r&&MV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QLe(e,t,r){return t=R_(t),JLe(e,gle()?Reflect.construct(t,r||[],R_(e).constructor):t.apply(e,r))}function JLe(e,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZLe(e)}function ZLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gle=function(){return!!e})()}function R_(e){return R_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},R_(e)}function XLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&II(e,t)}function II(e,t){return II=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},II(e,t)}function Oj(e,t,r){return t=vle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vle(e){var t=eOe(e,"string");return og(t)=="symbol"?t:t+""}function eOe(e,t){if(og(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(og(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ij=(function(e){function t(){return VLe(this,t),QLe(this,t,arguments)}return XLe(t,e),YLe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,l=i.cx,c=i.cy;return xn(l,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=FLe(l,function(d){return d.coordinate||0}),u=qLe(l,function(d){return d.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=n.axisLine,u=EV(n,WLe),d=l.reduce(function(v,b){return[Math.min(v[0],b.coordinate),Math.max(v[1],b.coordinate)]},[1/0,-1/0]),f=xn(a,i,d[0],s),m=xn(a,i,d[1],s),p=mf(mf(mf({},Ut(u,!1)),{},{fill:"none"},Ut(c,!1)),{},{x1:f.x,y1:f.y,x2:m.x,y2:m.y});return le.createElement("line",Db({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.angle,c=a.tickFormatter,u=a.stroke,d=EV(a,KLe),f=this.getTickTextAnchor(),m=Ut(d,!1),p=Ut(s,!1),v=i.map(function(b,y){var S=n.getTickValueCoord(b),_=mf(mf(mf(mf({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(S.x,", ").concat(S.y,")")},m),{},{stroke:"none",fill:u},p),{},{index:y},S),{},{payload:b});return le.createElement(Ir,Db({className:ur("recharts-polar-radius-axis-tick",ale(s)),key:"tick-".concat(b.coordinate)},xh(n.props,b,y)),t.renderTickItem(s,_,c?c(b.value,y):b.value))});return le.createElement(Ir,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:le.createElement(Ir,{className:ur("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),$a.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return le.isValidElement(n)?s=le.cloneElement(n,a):Jt(n)?s=n(a):s=le.createElement(wh,Db({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}])})(w.PureComponent);Oj(Ij,"displayName","PolarRadiusAxis");Oj(Ij,"axisType","radiusAxis");Oj(Ij,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function lg(e){"@babel/helpers - typeof";return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lg(e)}function Ff(){return Ff=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ff.apply(this,arguments)}function TV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TV(Object(r),!0).forEach(function(n){Rj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yle(n.key),n)}}function rOe(e,t,r){return t&&AV(e.prototype,t),r&&AV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nOe(e,t,r){return t=P_(t),aOe(e,ble()?Reflect.construct(t,r||[],P_(e).constructor):t.apply(e,r))}function aOe(e,t){if(t&&(lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iOe(e)}function iOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ble(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ble=function(){return!!e})()}function P_(e){return P_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},P_(e)}function sOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RI(e,t)}function RI(e,t){return RI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},RI(e,t)}function Rj(e,t,r){return t=yle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yle(e){var t=oOe(e,"string");return lg(t)=="symbol"?t:t+""}function oOe(e,t){if(lg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lOe=Math.PI/180,DV=1e-5,Pj=(function(e){function t(){return tOe(this,t),nOe(this,t,arguments)}return sOe(t,e),rOe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,l=a.radius,c=a.orientation,u=a.tickSize,d=u||8,f=xn(i,s,l,n.coordinate),m=xn(i,s,l+(c==="inner"?-1:1)*d,n.coordinate);return{x1:f.x,y1:f.y,x2:m.x,y2:m.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*lOe),s;return i>DV?s=a==="outer"?"start":"end":i<-DV?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,l=n.axisLine,c=n.axisLineType,u=pf(pf({},Ut(this.props,!1)),{},{fill:"none"},Ut(l,!1));if(c==="circle")return le.createElement(Lj,Ff({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:i,r:s}));var d=this.props.ticks,f=d.map(function(m){return xn(a,i,s,m.coordinate)});return le.createElement(MLe,Ff({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.tickLine,c=a.tickFormatter,u=a.stroke,d=Ut(this.props,!1),f=Ut(s,!1),m=pf(pf({},d),{},{fill:"none"},Ut(l,!1)),p=i.map(function(v,b){var y=n.getTickLineCoord(v),S=n.getTickTextAnchor(v),_=pf(pf(pf({textAnchor:S},d),{},{stroke:"none",fill:u},f),{},{index:b,payload:v,x:y.x2,y:y.y2});return le.createElement(Ir,Ff({className:ur("recharts-polar-angle-axis-tick",ale(s)),key:"tick-".concat(v.coordinate)},xh(n.props,v,b)),l&&le.createElement("line",Ff({className:"recharts-polar-angle-axis-tick-line"},m,y)),s&&t.renderTickItem(s,_,c?c(v.value,b):v.value))});return le.createElement(Ir,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:le.createElement(Ir,{className:ur("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return le.isValidElement(n)?s=le.cloneElement(n,a):Jt(n)?s=n(a):s=le.createElement(wh,Ff({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}])})(w.PureComponent);Rj(Pj,"displayName","PolarAngleAxis");Rj(Pj,"axisType","angleAxis");Rj(Pj,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var QA,LV;function cOe(){if(LV)return QA;LV=1;var e=Cse(),t=e(Object.getPrototypeOf,Object);return QA=t,QA}var JA,OV;function uOe(){if(OV)return JA;OV=1;var e=fu(),t=cOe(),r=hu(),n="[object Object]",a=Function.prototype,i=Object.prototype,s=a.toString,l=i.hasOwnProperty,c=s.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var m=l.call(f,"constructor")&&f.constructor;return typeof m=="function"&&m instanceof m&&s.call(m)==c}return JA=u,JA}var dOe=uOe();const fOe=Fr(dOe);var ZA,IV;function hOe(){if(IV)return ZA;IV=1;var e=fu(),t=hu(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return ZA=n,ZA}var mOe=hOe();const pOe=Fr(mOe);function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ly(e)}function z_(){return z_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z_.apply(this,arguments)}function gOe(e,t){return xOe(e)||yOe(e,t)||bOe(e,t)||vOe()}function vOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bOe(e,t){if(e){if(typeof e=="string")return RV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RV(e,t)}}function RV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function xOe(e){if(Array.isArray(e))return e}function PV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PV(Object(r),!0).forEach(function(n){wOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wOe(e,t,r){return t=SOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SOe(e){var t=kOe(e,"string");return Ly(t)=="symbol"?t:t+""}function kOe(e,t){if(Ly(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ly(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BV=function(t,r,n,a,i){var s=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-s/2,",").concat(r+i),l+="L ".concat(t+n-s/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},_Oe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},NOe=function(t){var r=zV(zV({},_Oe),t),n=w.useRef(),a=w.useState(-1),i=gOe(a,2),s=i[0],l=i[1];w.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&l(N)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,m=r.height,p=r.className,v=r.animationEasing,b=r.animationDuration,y=r.animationBegin,S=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||m!==+m||d===0&&f===0||m===0)return null;var _=ur("recharts-trapezoid",p);return S?le.createElement(Ll,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:m,x:c,y:u},to:{upperWidth:d,lowerWidth:f,height:m,x:c,y:u},duration:b,animationEasing:v,isActive:S},function(N){var k=N.upperWidth,j=N.lowerWidth,E=N.height,T=N.x,O=N.y;return le.createElement(Ll,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:b,easing:v},le.createElement("path",z_({},Ut(r,!0),{className:_,d:BV(T,O,k,j,E),ref:n})))}):le.createElement("g",null,le.createElement("path",z_({},Ut(r,!0),{className:_,d:BV(c,u,d,f,m)})))},COe=["option","shapeType","propTransformer","activeClassName","isActive"];function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}function jOe(e,t){if(e==null)return{};var r=EOe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function EOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function B_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$V(Object(r),!0).forEach(function(n){MOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$V(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MOe(e,t,r){return t=TOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TOe(e){var t=AOe(e,"string");return Oy(t)=="symbol"?t:t+""}function AOe(e,t){if(Oy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Oy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DOe(e,t){return B_(B_({},t),e)}function LOe(e,t){return e==="symbols"}function FV(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return le.createElement(zz,r);case"trapezoid":return le.createElement(NOe,r);case"sector":return le.createElement(ole,r);case"symbols":if(LOe(t))return le.createElement(nz,r);break;default:return null}}function OOe(e){return w.isValidElement(e)?e.props:e}function xle(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?DOe:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,l=e.isActive,c=jOe(e,COe),u;if(w.isValidElement(t))u=w.cloneElement(t,B_(B_({},c),OOe(t)));else if(Jt(t))u=t(c);else if(fOe(t)&&!pOe(t)){var d=a(t,c);u=le.createElement(FV,{shapeType:r,elementProps:d})}else{var f=c;u=le.createElement(FV,{shapeType:r,elementProps:f})}return l?le.createElement(Ir,{className:s},u):u}function zj(e,t){return t!=null&&"trapezoids"in e.props}function Bj(e,t){return t!=null&&"sectors"in e.props}function Iy(e,t){return t!=null&&"points"in e.props}function IOe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function ROe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function POe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function zOe(e,t){var r;return zj(e,t)?r=IOe:Bj(e,t)?r=ROe:Iy(e,t)&&(r=POe),r}function BOe(e,t){var r;return zj(e,t)?r="trapezoids":Bj(e,t)?r="sectors":Iy(e,t)&&(r="points"),r}function $Oe(e,t){if(zj(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Bj(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Iy(e,t)?t.payload:{}}function FOe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=BOe(r,t),i=$Oe(r,t),s=n.filter(function(c,u){var d=Vx(i,c),f=r.props[a].filter(function(v){var b=zOe(r,t);return b(v,t)}),m=r.props[a].indexOf(f[f.length-1]),p=u===m;return d&&p}),l=n.indexOf(s[s.length-1]);return l}var gk;function cg(e){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(e)}function Np(){return Np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Np.apply(this,arguments)}function UV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UV(Object(r),!0).forEach(function(n){go(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sle(n.key),n)}}function HOe(e,t,r){return t&&HV(e.prototype,t),r&&HV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qOe(e,t,r){return t=$_(t),WOe(e,wle()?Reflect.construct(t,r||[],$_(e).constructor):t.apply(e,r))}function WOe(e,t){if(t&&(cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KOe(e)}function KOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wle=function(){return!!e})()}function $_(e){return $_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$_(e)}function GOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PI(e,t)}function PI(e,t){return PI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},PI(e,t)}function go(e,t,r){return t=Sle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sle(e){var t=VOe(e,"string");return cg(t)=="symbol"?t:t+""}function VOe(e,t){if(cg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pu=(function(e){function t(r){var n;return UOe(this,t),n=qOe(this,t,[r]),go(n,"pieRef",null),go(n,"sectorRefs",[]),go(n,"id",l0("recharts-pie-")),go(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Jt(a)&&a()}),go(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Jt(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return GOe(t,e),HOe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,l=i.labelLine,c=i.dataKey,u=i.valueKey,d=Ut(this.props,!1),f=Ut(s,!1),m=Ut(l,!1),p=s&&s.offsetRadius||20,v=n.map(function(b,y){var S=(b.startAngle+b.endAngle)/2,_=xn(b.cx,b.cy,b.outerRadius+p,S),N=bn(bn(bn(bn({},d),b),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(_.x,b.cx)},_),k=bn(bn(bn(bn({},d),b),{},{fill:"none",stroke:b.fill},m),{},{index:y,points:[xn(b.cx,b.cy,b.outerRadius,S),_]}),j=c;return tr(c)&&tr(u)?j="value":tr(c)&&(j=u),le.createElement(Ir,{key:"label-".concat(b.startAngle,"-").concat(b.endAngle,"-").concat(b.midAngle,"-").concat(y)},l&&t.renderLabelLineItem(l,k,"line"),t.renderLabelItem(s,N,Ca(b,j)))});return le.createElement(Ir,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return n.map(function(u,d){if(u?.startAngle===0&&u?.endAngle===0&&n.length!==1)return null;var f=a.isActiveIndex(d),m=c&&a.hasActiveIndex()?c:null,p=f?s:m,v=bn(bn({},u),{},{stroke:l?u.fill:u.stroke,tabIndex:-1});return le.createElement(Ir,Np({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},xh(a.props,u,d),{key:"sector-".concat(u?.startAngle,"-").concat(u?.endAngle,"-").concat(u.midAngle,"-").concat(d)}),le.createElement(xle,Np({option:p,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state,m=f.prevSectors,p=f.prevIsAnimationActive;return le.createElement(Ll,{begin:l,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var b=v.t,y=[],S=i&&i[0],_=S.startAngle;return i.forEach(function(N,k){var j=m&&m[k],E=k>0?Ds(N,"paddingAngle",0):0;if(j){var T=js(j.endAngle-j.startAngle,N.endAngle-N.startAngle),O=bn(bn({},N),{},{startAngle:_+E,endAngle:_+T(b)+E});y.push(O),_=O.endAngle}else{var R=N.endAngle,q=N.startAngle,$=js(0,R-q),L=$(b),A=bn(bn({},N),{},{startAngle:_+E,endAngle:_+L+E});y.push(A),_=A.endAngle}}),le.createElement(Ir,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var l=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[l].focus(),a.setState({sectorToFocus:l});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!Vx(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,l=a.className,c=a.label,u=a.cx,d=a.cy,f=a.innerRadius,m=a.outerRadius,p=a.isAnimationActive,v=this.state.isAnimationFinished;if(i||!s||!s.length||!et(u)||!et(d)||!et(f)||!et(m))return null;var b=ur("recharts-pie",l);return le.createElement(Ir,{tabIndex:this.props.rootTabIndex,className:b,ref:function(S){n.pieRef=S}},this.renderSectors(),c&&this.renderLabels(s),$a.renderCallByParent(this.props,null,!1),(!p||v)&&Zc.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(le.isValidElement(n))return le.cloneElement(n,a);if(Jt(n))return n(a);var s=ur("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return le.createElement(T_,Np({},a,{key:i,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,a,i){if(le.isValidElement(n))return le.cloneElement(n,a);var s=i;if(Jt(n)&&(s=n(a),le.isValidElement(s)))return s;var l=ur("recharts-pie-label-text",typeof n!="boolean"&&!Jt(n)?n.className:"");return le.createElement(wh,Np({},a,{alignmentBaseline:"middle",className:l}),s)}}])})(w.PureComponent);gk=pu;go(pu,"displayName","Pie");go(pu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Kh.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});go(pu,"parseDeltaAngle",function(e,t){var r=Ai(t-e),n=Math.min(Math.abs(t-e),360);return r*n});go(pu,"getRealPieData",function(e){var t=e.data,r=e.children,n=Ut(e,!1),a=Ls(r,Hx);return t&&t.length?t.map(function(i,s){return bn(bn(bn({payload:i},n),i),a&&a[s]&&a[s].props)}):a&&a.length?a.map(function(i){return bn(bn({},n),i.props)}):[]});go(pu,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=nle(a,i),l=n+Di(e.cx,a,a/2),c=r+Di(e.cy,i,i/2),u=Di(e.innerRadius,s,0),d=Di(e.outerRadius,s,s*.8),f=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:f}});go(pu,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?bn(bn({},t.type.defaultProps),t.props):t.props,a=gk.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,s=n.startAngle,l=n.endAngle,c=n.paddingAngle,u=n.dataKey,d=n.nameKey,f=n.valueKey,m=n.tooltipType,p=Math.abs(n.minAngle),v=gk.parseCoordinateOfPie(n,r),b=gk.parseDeltaAngle(s,l),y=Math.abs(b),S=u;tr(u)&&tr(f)?(Qo(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),S="value"):tr(u)&&(Qo(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),S=f);var _=a.filter(function(O){return Ca(O,S,0)!==0}).length,N=(y>=360?_:_-1)*c,k=y-_*p-N,j=a.reduce(function(O,R){var q=Ca(R,S,0);return O+(et(q)?q:0)},0),E;if(j>0){var T;E=a.map(function(O,R){var q=Ca(O,S,0),$=Ca(O,d,R),L=(et(q)?q:0)/j,A;R?A=T.endAngle+Ai(b)*c*(q!==0?1:0):A=s;var M=A+Ai(b)*((q!==0?p:0)+L*k),z=(A+M)/2,I=(v.innerRadius+v.outerRadius)/2,B=[{name:$,value:q,payload:O,dataKey:S,type:m}],F=xn(v.cx,v.cy,I,z);return T=bn(bn(bn({percent:L,cornerRadius:i,name:$,tooltipPayload:B,midAngle:z,middleRadius:I,tooltipPosition:F},O),v),{},{value:Ca(O,S),startAngle:A,endAngle:M,payload:O,paddingAngle:Ai(b)*c}),T})}return bn(bn({},v),{},{sectors:E,data:a})});var XA,qV;function YOe(){if(qV)return XA;qV=1;var e=Math.ceil,t=Math.max;function r(n,a,i,s){for(var l=-1,c=t(e((a-n)/(i||1)),0),u=Array(c);c--;)u[s?c:++l]=n,n+=i;return u}return XA=r,XA}var eD,WV;function kle(){if(WV)return eD;WV=1;var e=Use(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var i=a<0?-1:1;return i*r}return a===a?a:0}return eD=n,eD}var tD,KV;function QOe(){if(KV)return tD;KV=1;var e=YOe(),t=xj(),r=kle();function n(a){return function(i,s,l){return l&&typeof l!="number"&&t(i,s,l)&&(s=l=void 0),i=r(i),s===void 0?(s=i,i=0):s=r(s),l=l===void 0?i<s?1:-1:r(l),e(i,s,l,a)}}return tD=n,tD}var rD,GV;function JOe(){if(GV)return rD;GV=1;var e=QOe(),t=e();return rD=t,rD}var ZOe=JOe();const F_=Fr(ZOe);function Ry(e){"@babel/helpers - typeof";return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(e)}function VV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VV(Object(r),!0).forEach(function(n){_le(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _le(e,t,r){return t=XOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XOe(e){var t=eIe(e,"string");return Ry(t)=="symbol"?t:t+""}function eIe(e,t){if(Ry(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ry(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tIe=["Webkit","Moz","O","ms"],rIe=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=tIe.reduce(function(i,s){return YV(YV({},i),{},_le({},s+n,r))},{});return a[t]=r,a};function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function U_(){return U_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U_.apply(this,arguments)}function QV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QV(Object(r),!0).forEach(function(n){Ss(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cle(n.key),n)}}function aIe(e,t,r){return t&&JV(e.prototype,t),r&&JV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iIe(e,t,r){return t=H_(t),sIe(e,Nle()?Reflect.construct(t,r||[],H_(e).constructor):t.apply(e,r))}function sIe(e,t){if(t&&(ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oIe(e)}function oIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nle=function(){return!!e})()}function H_(e){return H_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},H_(e)}function lIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zI(e,t)}function zI(e,t){return zI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},zI(e,t)}function Ss(e,t,r){return t=Cle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cle(e){var t=cIe(e,"string");return ug(t)=="symbol"?t:t+""}function cIe(e,t){if(ug(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ug(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var uIe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=Eb().domain(F_(0,c)).range([i,i+s-l]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},ZV=function(t){return t.changedTouches&&!!t.changedTouches.length},dg=(function(e){function t(r){var n;return nIe(this,t),n=iIe(this,t,[r]),Ss(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Ss(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Ss(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,l=a.startIndex;s?.({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),Ss(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Ss(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Ss(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Ss(n,"handleSlideDragStart",function(a){var i=ZV(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return lIe(t,e),aIe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,f=Math.min(a,i),m=Math.max(a,i),p=t.getIndexInRange(s,f),v=t.getIndexInRange(s,m);return{startIndex:p-p%c,endIndex:v===d?d:v-v%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,l=a.dataKey,c=Ca(i[n],l,n);return Jt(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,l=a.endX,c=this.props,u=c.x,d=c.width,f=c.travellerWidth,m=c.startIndex,p=c.endIndex,v=c.onChange,b=n.pageX-i;b>0?b=Math.min(b,u+d-f-l,u+d-f-s):b<0&&(b=Math.max(b,u-s,u-l));var y=this.getIndex({startX:s+b,endX:l+b});(y.startIndex!==m||y.endIndex!==p)&&v&&v(y),this.setState({startX:s+b,endX:l+b,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=ZV(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,l=a.endX,c=a.startX,u=this.state[s],d=this.props,f=d.x,m=d.width,p=d.travellerWidth,v=d.onChange,b=d.gap,y=d.data,S={startX:this.state.startX,endX:this.state.endX},_=n.pageX-i;_>0?_=Math.min(_,f+m-p-u):_<0&&(_=Math.max(_,f-u)),S[s]=u+_;var N=this.getIndex(S),k=N.startIndex,j=N.endIndex,E=function(){var O=y.length-1;return s==="startX"&&(l>c?k%b===0:j%b===0)||l<c&&j===O||s==="endX"&&(l>c?j%b===0:k%b===0)||l>c&&j===O};this.setState(Ss(Ss({},s,u+_),"brushMoveStartX",n.pageX),function(){v&&E()&&v(N)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,l=s.scaleValues,c=s.startX,u=s.endX,d=this.state[a],f=l.indexOf(d);if(f!==-1){var m=f+n;if(!(m===-1||m>=l.length)){var p=l[m];a==="startX"&&p>=u||a==="endX"&&p<=c||this.setState(Ss({},a,p),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.fill,u=n.stroke;return le.createElement("rect",{stroke:u,fill:c,x:a,y:i,width:s,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.data,u=n.children,d=n.padding,f=w.Children.only(u);return f?le.cloneElement(f,{x:a,y:i,width:s,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,l=this,c=this.props,u=c.y,d=c.travellerWidth,f=c.height,m=c.traveller,p=c.ariaLabel,v=c.data,b=c.startIndex,y=c.endIndex,S=Math.max(n,this.props.x),_=nD(nD({},Ut(this.props,!1)),{},{x:S,y:u,width:d,height:f}),N=p||"Min value: ".concat((i=v[b])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=v[y])===null||s===void 0?void 0:s.name);return le.createElement(Ir,{tabIndex:0,role:"slider","aria-label":N,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),l.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(m,_))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,l=i.height,c=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,f=Math.max(Math.abs(a-n)-u,0);return le.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:s,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,l=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,m=d.endX,p=5,v={pointerEvents:"none",fill:u};return le.createElement(Ir,{className:"recharts-brush-texts"},le.createElement(wh,U_({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,m)-p,y:s+l/2},v),this.getTextOfTick(a)),le.createElement(wh,U_({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,m)+c+p,y:s+l/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,l=n.x,c=n.y,u=n.width,d=n.height,f=n.alwaysShowText,m=this.state,p=m.startX,v=m.endX,b=m.isTextActive,y=m.isSlideMoving,S=m.isTravellerMoving,_=m.isTravellerFocused;if(!a||!a.length||!et(l)||!et(c)||!et(u)||!et(d)||u<=0||d<=0)return null;var N=ur("recharts-brush",i),k=le.Children.count(s)===1,j=rIe("userSelect","none");return le.createElement(Ir,{className:N,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:j},this.renderBackground(),k&&this.renderPanorama(),this.renderSlide(p,v),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(v,"endX"),(b||y||S||_||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,l=n.height,c=n.stroke,u=Math.floor(i+l/2)-1;return le.createElement(le.Fragment,null,le.createElement("rect",{x:a,y:i,width:s,height:l,fill:c,stroke:"none"}),le.createElement("line",{x1:a+1,y1:u,x2:a+s-1,y2:u,fill:"none",stroke:"#fff"}),le.createElement("line",{x1:a+1,y1:u+2,x2:a+s-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return le.isValidElement(n)?i=le.cloneElement(n,a):Jt(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,l=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return nD({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:s},i&&i.length?uIe({data:i,width:s,x:l,travellerWidth:c,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+s-c]);var m=a.scale.domain().map(function(p){return a.scale(p)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:m}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,l=i-1;l-s>1;){var c=Math.floor((s+l)/2);n[c]>a?l=c:s=c}return a>=n[l]?l:s}}])})(w.PureComponent);Ss(dg,"displayName","Brush");Ss(dg,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var aD,XV;function dIe(){if(XV)return aD;XV=1;var e=uz();function t(r,n){var a;return e(r,function(i,s,l){return a=n(i,s,l),!a}),!!a}return aD=t,aD}var iD,eY;function fIe(){if(eY)return iD;eY=1;var e=yse(),t=Hl(),r=dIe(),n=ls(),a=xj();function i(s,l,c){var u=n(s)?e:r;return c&&a(s,l,c)&&(l=void 0),u(s,t(l,3))}return iD=i,iD}var hIe=fIe();const mIe=Fr(hIe);var _l=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},sD,tY;function pIe(){if(tY)return sD;tY=1;var e=Pse();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return sD=t,sD}var oD,rY;function gIe(){if(rY)return oD;rY=1;var e=pIe(),t=Ise(),r=Hl();function n(a,i){var s={};return i=r(i,3),t(a,function(l,c,u){e(s,c,i(l,c,u))}),s}return oD=n,oD}var vIe=gIe();const bIe=Fr(vIe);var lD,nY;function yIe(){if(nY)return lD;nY=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return lD=e,lD}var cD,aY;function xIe(){if(aY)return cD;aY=1;var e=uz();function t(r,n){var a=!0;return e(r,function(i,s,l){return a=!!n(i,s,l),a}),a}return cD=t,cD}var uD,iY;function wIe(){if(iY)return uD;iY=1;var e=yIe(),t=xIe(),r=Hl(),n=ls(),a=xj();function i(s,l,c){var u=n(s)?e:t;return c&&a(s,l,c)&&(l=void 0),u(s,r(l,3))}return uD=i,uD}var SIe=wIe();const jle=Fr(SIe);var kIe=["x","y"];function Py(e){"@babel/helpers - typeof";return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function BI(){return BI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BI.apply(this,arguments)}function sY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sY(Object(r),!0).forEach(function(n){_Ie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ie(e,t,r){return t=NIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NIe(e){var t=CIe(e,"string");return Py(t)=="symbol"?t:t+""}function CIe(e,t){if(Py(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Py(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jIe(e,t){if(e==null)return{};var r=EIe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function EIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function MIe(e,t){var r=e.x,n=e.y,a=jIe(e,kIe),i="".concat(r),s=parseInt(i,10),l="".concat(n),c=parseInt(l,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),m=parseInt(f,10);return Cv(Cv(Cv(Cv(Cv({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:d,width:m,name:t.name,radius:t.radius})}function oY(e){return le.createElement(xle,BI({shapeType:"rectangle",propTransformer:MIe,activeClassName:"recharts-active-bar"},e))}var TIe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=et(n)||W_e(n);return i?t(n,a):(i||gh(!1),r)}},AIe=["value","background"],Ele;function fg(e){"@babel/helpers - typeof";return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fg(e)}function DIe(e,t){if(e==null)return{};var r=LIe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function LIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function q_(){return q_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},q_.apply(this,arguments)}function lY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lY(Object(r),!0).forEach(function(n){vd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tle(n.key),n)}}function IIe(e,t,r){return t&&cY(e.prototype,t),r&&cY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RIe(e,t,r){return t=W_(t),PIe(e,Mle()?Reflect.construct(t,r||[],W_(e).constructor):t.apply(e,r))}function PIe(e,t){if(t&&(fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zIe(e)}function zIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mle=function(){return!!e})()}function W_(e){return W_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},W_(e)}function BIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$I(e,t)}function $I(e,t){return $I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$I(e,t)}function vd(e,t,r){return t=Tle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tle(e){var t=$Ie(e,"string");return fg(t)=="symbol"?t:t+""}function $Ie(e,t){if(fg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Hd=(function(e){function t(){var r;OIe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=RIe(this,t,[].concat(a)),vd(r,"state",{isAnimationFinished:!1}),vd(r,"id",l0("recharts-bar-")),vd(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),vd(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return BIe(t,e),IIe(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,l=i.dataKey,c=i.activeIndex,u=i.activeBar,d=Ut(this.props,!1);return n&&n.map(function(f,m){var p=m===c,v=p?u:s,b=da(da(da({},d),f),{},{isActive:p,option:v,index:m,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return le.createElement(Ir,q_({className:"recharts-bar-rectangle"},xh(a.props,f,m),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(m)}),le.createElement(oY,b))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,l=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,d=a.animationEasing,f=a.animationId,m=this.state.prevData;return le.createElement(Ll,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var v=p.t,b=i.map(function(y,S){var _=m&&m[S];if(_){var N=js(_.x,y.x),k=js(_.y,y.y),j=js(_.width,y.width),E=js(_.height,y.height);return da(da({},y),{},{x:N(v),y:k(v),width:j(v),height:E(v)})}if(s==="horizontal"){var T=js(0,y.height),O=T(v);return da(da({},y),{},{y:y.y+y.height-O,height:O})}var R=js(0,y.width),q=R(v);return da(da({},y),{},{width:q})});return le.createElement(Ir,null,n.renderRectanglesStatically(b))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!Vx(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,l=a.activeIndex,c=Ut(this.props.background,!1);return i.map(function(u,d){u.value;var f=u.background,m=DIe(u,AIe);if(!f)return null;var p=da(da(da(da(da({},m),{},{fill:"#eee"},f),c),xh(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:d,className:"recharts-bar-background-rectangle"});return le.createElement(oY,q_({key:"background-bar-".concat(d),option:n.props.background,isActive:d===l},p))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,f=Ls(d,Yx);if(!f)return null;var m=u==="vertical"?s[0].height/2:s[0].width/2,p=function(y,S){var _=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:_,errorVal:Ca(y,S)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return le.createElement(Ir,v,f.map(function(b){return le.cloneElement(b,{key:"error-bar-".concat(a,"-").concat(b.props.dataKey),data:s,xAxis:l,yAxis:c,layout:u,offset:m,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,l=n.xAxis,c=n.yAxis,u=n.left,d=n.top,f=n.width,m=n.height,p=n.isAnimationActive,v=n.background,b=n.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,S=ur("recharts-bar",s),_=l&&l.allowDataOverflow,N=c&&c.allowDataOverflow,k=_||N,j=tr(b)?this.id:b;return le.createElement(Ir,{className:S},_||N?le.createElement("defs",null,le.createElement("clipPath",{id:"clipPath-".concat(j)},le.createElement("rect",{x:_?u:u-f/2,y:N?d:d-m/2,width:_?f:f*2,height:N?m:m*2}))):null,le.createElement(Ir,{className:"recharts-bar-rectangles",clipPath:k?"url(#clipPath-".concat(j,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(k,j),(!p||y)&&Zc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])})(w.PureComponent);Ele=Hd;vd(Hd,"displayName","Bar");vd(Hd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Kh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});vd(Hd,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,m=e.offset,p=d3e(n,r);if(!p)return null;var v=t.layout,b=r.type.defaultProps,y=b!==void 0?da(da({},b),r.props):r.props,S=y.dataKey,_=y.children,N=y.minPointSize,k=v==="horizontal"?s:i,j=u?k.scale.domain():null,E=b3e({numericAxis:k}),T=Ls(_,Hx),O=f.map(function(R,q){var $,L,A,M,z,I;u?$=f3e(u[d+q],j):($=Ca(R,S),Array.isArray($)||($=[E,$]));var B=TIe(N,Ele.defaultProps.minPointSize)($[1],q);if(v==="horizontal"){var F,U=[s.scale($[0]),s.scale($[1])],V=U[0],K=U[1];L=RG({axis:i,ticks:l,bandSize:a,offset:p.offset,entry:R,index:q}),A=(F=K??V)!==null&&F!==void 0?F:void 0,M=p.size;var G=V-K;if(z=Number.isNaN(G)?0:G,I={x:L,y:s.y,width:M,height:s.height},Math.abs(B)>0&&Math.abs(z)<Math.abs(B)){var J=Ai(z||B)*(Math.abs(B)-Math.abs(z));A-=J,z+=J}}else{var ee=[i.scale($[0]),i.scale($[1])],Y=ee[0],ie=ee[1];if(L=Y,A=RG({axis:s,ticks:c,bandSize:a,offset:p.offset,entry:R,index:q}),M=ie-Y,z=p.size,I={x:i.x,y:A,width:i.width,height:z},Math.abs(B)>0&&Math.abs(M)<Math.abs(B)){var fe=Ai(M||B)*(Math.abs(B)-Math.abs(M));M+=fe}}return da(da(da({},R),{},{x:L,y:A,width:M,height:z,value:u?$:$[1],payload:R,background:I},T&&T[q]&&T[q].props),{},{tooltipPayload:[tle(r,R)],tooltipPosition:{x:L+M/2,y:A+z/2}})});return da({data:O,layout:v},m)});function zy(e){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zy(e)}function FIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ale(n.key),n)}}function UIe(e,t,r){return t&&uY(e.prototype,t),r&&uY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dY(Object(r),!0).forEach(function(n){$j(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $j(e,t,r){return t=Ale(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ale(e){var t=HIe(e,"string");return zy(t)=="symbol"?t:t+""}function HIe(e,t){if(zy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dle=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.layout,u=t.children,d=Object.keys(r),f={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},m=!!Ns(u,Hd);return d.reduce(function(p,v){var b=r[v],y=b.orientation,S=b.domain,_=b.padding,N=_===void 0?{}:_,k=b.mirror,j=b.reversed,E="".concat(y).concat(k?"Mirror":""),T,O,R,q,$;if(b.type==="number"&&(b.padding==="gap"||b.padding==="no-gap")){var L=S[1]-S[0],A=1/0,M=b.categoricalDomain.sort(V_e);if(M.forEach(function(ee,Y){Y>0&&(A=Math.min((ee||0)-(M[Y-1]||0),A))}),Number.isFinite(A)){var z=A/L,I=b.layout==="vertical"?n.height:n.width;if(b.padding==="gap"&&(T=z*I/2),b.padding==="no-gap"){var B=Di(t.barCategoryGap,z*I),F=z*I/2;T=F-B-(F-B)/I*B}}}a==="xAxis"?O=[n.left+(N.left||0)+(T||0),n.left+n.width-(N.right||0)-(T||0)]:a==="yAxis"?O=c==="horizontal"?[n.top+n.height-(N.bottom||0),n.top+(N.top||0)]:[n.top+(N.top||0)+(T||0),n.top+n.height-(N.bottom||0)-(T||0)]:O=b.range,j&&(O=[O[1],O[0]]);var U=Joe(b,i,m),V=U.scale,K=U.realScaleType;V.domain(S).range(O),Zoe(V);var G=Xoe(V,Ro(Ro({},b),{},{realScaleType:K}));a==="xAxis"?($=y==="top"&&!k||y==="bottom"&&k,R=n.left,q=f[E]-$*b.height):a==="yAxis"&&($=y==="left"&&!k||y==="right"&&k,R=f[E]-$*b.width,q=n.top);var J=Ro(Ro(Ro({},b),G),{},{realScaleType:K,x:R,y:q,scale:V,width:a==="xAxis"?n.width:b.width,height:a==="yAxis"?n.height:b.height});return J.bandSize=j_(J,G),!b.hide&&a==="xAxis"?f[E]+=($?-1:1)*J.height:b.hide||(f[E]+=($?-1:1)*J.width),Ro(Ro({},p),{},$j({},v,J))},{})},Lle=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},qIe=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return Lle({x:r,y:n},{x:a,y:i})},Ole=(function(){function e(t){FIe(this,e),this.scale=t}return UIe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])})();$j(Ole,"EPS",1e-4);var Bz=function(t){var r=Object.keys(t).reduce(function(n,a){return Ro(Ro({},n),{},$j({},a,Ole.create(t[a])))},{});return Ro(Ro({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,l=i.position;return bIe(a,function(c,u){return r[u].apply(c,{bandAware:s,position:l})})},isInRange:function(a){return jle(a,function(i,s){return r[s].isInRange(i)})}})};function WIe(e){return(e%180+180)%180}var KIe=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=WIe(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},dD,fY;function GIe(){if(fY)return dD;fY=1;var e=Hl(),t=Ux(),r=bj();function n(a){return function(i,s,l){var c=Object(i);if(!t(i)){var u=e(s,3);i=r(i),s=function(f){return u(c[f],f,c)}}var d=a(i,s,l);return d>-1?c[u?i[d]:d]:void 0}}return dD=n,dD}var fD,hY;function VIe(){if(hY)return fD;hY=1;var e=kle();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return fD=t,fD}var hD,mY;function YIe(){if(mY)return hD;mY=1;var e=Tse(),t=Hl(),r=VIe(),n=Math.max;function a(i,s,l){var c=i==null?0:i.length;if(!c)return-1;var u=l==null?0:r(l);return u<0&&(u=n(c+u,0)),e(i,t(s,3),u)}return hD=a,hD}var mD,pY;function QIe(){if(pY)return mD;pY=1;var e=GIe(),t=YIe(),r=e(t);return mD=r,mD}var JIe=QIe();const ZIe=Fr(JIe);var XIe=Kie();const eRe=Fr(XIe);var tRe=eRe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),$z=w.createContext(void 0),Fz=w.createContext(void 0),Ile=w.createContext(void 0),Rle=w.createContext({}),Ple=w.createContext(void 0),zle=w.createContext(0),Ble=w.createContext(0),gY=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,l=t.children,c=t.width,u=t.height,d=tRe(i);return le.createElement($z.Provider,{value:n},le.createElement(Fz.Provider,{value:a},le.createElement(Rle.Provider,{value:i},le.createElement(Ile.Provider,{value:d},le.createElement(Ple.Provider,{value:s},le.createElement(zle.Provider,{value:u},le.createElement(Ble.Provider,{value:c},l)))))))},rRe=function(){return w.useContext(Ple)},$le=function(t){var r=w.useContext($z);r==null&&gh(!1);var n=r[t];return n==null&&gh(!1),n},nRe=function(){var t=w.useContext($z);return ud(t)},aRe=function(){var t=w.useContext(Fz),r=ZIe(t,function(n){return jle(n.domain,Number.isFinite)});return r||ud(t)},Fle=function(t){var r=w.useContext(Fz);r==null&&gh(!1);var n=r[t];return n==null&&gh(!1),n},iRe=function(){var t=w.useContext(Ile);return t},sRe=function(){return w.useContext(Rle)},Uz=function(){return w.useContext(Ble)},Hz=function(){return w.useContext(zle)};function hg(e){"@babel/helpers - typeof";return hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hg(e)}function oRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hle(n.key),n)}}function cRe(e,t,r){return t&&lRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uRe(e,t,r){return t=K_(t),dRe(e,Ule()?Reflect.construct(t,r||[],K_(e).constructor):t.apply(e,r))}function dRe(e,t){if(t&&(hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fRe(e)}function fRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ule(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ule=function(){return!!e})()}function K_(e){return K_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},K_(e)}function hRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FI(e,t)}function FI(e,t){return FI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},FI(e,t)}function vY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vY(Object(r),!0).forEach(function(n){qz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qz(e,t,r){return t=Hle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hle(e){var t=mRe(e,"string");return hg(t)=="symbol"?t:t+""}function mRe(e,t){if(hg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function pRe(e,t){return yRe(e)||bRe(e,t)||vRe(e,t)||gRe()}function gRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vRe(e,t){if(e){if(typeof e=="string")return yY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yY(e,t)}}function yY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function yRe(e){if(Array.isArray(e))return e}function UI(){return UI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UI.apply(this,arguments)}var xRe=function(t,r){var n;return le.isValidElement(t)?n=le.cloneElement(t,r):Jt(t)?n=t(r):n=le.createElement("line",UI({},r,{className:"recharts-reference-line-line"})),n},wRe=function(t,r,n,a,i,s,l,c,u){var d=i.x,f=i.y,m=i.width,p=i.height;if(n){var v=u.y,b=t.y.apply(v,{position:s});if(_l(u,"discard")&&!t.y.isInRange(b))return null;var y=[{x:d+m,y:b},{x:d,y:b}];return c==="left"?y.reverse():y}if(r){var S=u.x,_=t.x.apply(S,{position:s});if(_l(u,"discard")&&!t.x.isInRange(_))return null;var N=[{x:_,y:f+p},{x:_,y:f}];return l==="top"?N.reverse():N}if(a){var k=u.segment,j=k.map(function(E){return t.apply(E,{position:s})});return _l(u,"discard")&&mIe(j,function(E){return!t.isInRange(E)})?null:j}return null};function SRe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,l=e.className,c=e.alwaysShow,u=rRe(),d=$le(a),f=Fle(i),m=iRe();if(!u||!m)return null;Qo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=Bz({x:d.scale,y:f.scale}),v=ja(t),b=ja(r),y=n&&n.length===2,S=wRe(p,v,b,y,m,e.position,d.orientation,f.orientation,e);if(!S)return null;var _=pRe(S,2),N=_[0],k=N.x,j=N.y,E=_[1],T=E.x,O=E.y,R=_l(e,"hidden")?"url(#".concat(u,")"):void 0,q=bY(bY({clipPath:R},Ut(e,!0)),{},{x1:k,y1:j,x2:T,y2:O});return le.createElement(Ir,{className:ur("recharts-reference-line",l)},xRe(s,q),$a.renderCallByParent(e,qIe({x1:k,y1:j,x2:T,y2:O})))}var Wz=(function(e){function t(){return oRe(this,t),uRe(this,t,arguments)}return hRe(t,e),cRe(t,[{key:"render",value:function(){return le.createElement(SRe,this.props)}}])})(le.Component);qz(Wz,"displayName","ReferenceLine");qz(Wz,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function HI(){return HI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HI.apply(this,arguments)}function mg(e){"@babel/helpers - typeof";return mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mg(e)}function xY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xY(Object(r),!0).forEach(function(n){Fj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wle(n.key),n)}}function NRe(e,t,r){return t&&_Re(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function CRe(e,t,r){return t=G_(t),jRe(e,qle()?Reflect.construct(t,r||[],G_(e).constructor):t.apply(e,r))}function jRe(e,t){if(t&&(mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ERe(e)}function ERe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qle=function(){return!!e})()}function G_(e){return G_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},G_(e)}function MRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qI(e,t)}function qI(e,t){return qI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qI(e,t)}function Fj(e,t,r){return t=Wle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wle(e){var t=TRe(e,"string");return mg(t)=="symbol"?t:t+""}function TRe(e,t){if(mg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ARe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=Bz({x:a.scale,y:i.scale}),l=s.apply({x:r,y:n},{bandAware:!0});return _l(t,"discard")&&!s.isInRange(l)?null:l},Uj=(function(e){function t(){return kRe(this,t),CRe(this,t,arguments)}return MRe(t,e),NRe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,l=n.alwaysShow,c=n.clipPathId,u=ja(a),d=ja(i);if(Qo(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=ARe(this.props);if(!f)return null;var m=f.x,p=f.y,v=this.props,b=v.shape,y=v.className,S=_l(this.props,"hidden")?"url(#".concat(c,")"):void 0,_=wY(wY({clipPath:S},Ut(this.props,!0)),{},{cx:m,cy:p});return le.createElement(Ir,{className:ur("recharts-reference-dot",y)},t.renderDot(b,_),$a.renderCallByParent(this.props,{x:m-s,y:p-s,width:2*s,height:2*s}))}}])})(le.Component);Fj(Uj,"displayName","ReferenceDot");Fj(Uj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Fj(Uj,"renderDot",function(e,t){var r;return le.isValidElement(e)?r=le.cloneElement(e,t):Jt(e)?r=e(t):r=le.createElement(Lj,HI({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function WI(){return WI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WI.apply(this,arguments)}function pg(e){"@babel/helpers - typeof";return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(e)}function SY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SY(Object(r),!0).forEach(function(n){Hj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gle(n.key),n)}}function ORe(e,t,r){return t&&LRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IRe(e,t,r){return t=V_(t),RRe(e,Kle()?Reflect.construct(t,r||[],V_(e).constructor):t.apply(e,r))}function RRe(e,t){if(t&&(pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PRe(e)}function PRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kle=function(){return!!e})()}function V_(e){return V_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},V_(e)}function zRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KI(e,t)}function KI(e,t){return KI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},KI(e,t)}function Hj(e,t,r){return t=Gle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gle(e){var t=BRe(e,"string");return pg(t)=="symbol"?t:t+""}function BRe(e,t){if(pg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $Re=function(t,r,n,a,i){var s=i.x1,l=i.x2,c=i.y1,u=i.y2,d=i.xAxis,f=i.yAxis;if(!d||!f)return null;var m=Bz({x:d.scale,y:f.scale}),p={x:t?m.x.apply(s,{position:"start"}):m.x.rangeMin,y:n?m.y.apply(c,{position:"start"}):m.y.rangeMin},v={x:r?m.x.apply(l,{position:"end"}):m.x.rangeMax,y:a?m.y.apply(u,{position:"end"}):m.y.rangeMax};return _l(i,"discard")&&(!m.isInRange(p)||!m.isInRange(v))?null:Lle(p,v)},qj=(function(e){function t(){return DRe(this,t),IRe(this,t,arguments)}return zRe(t,e),ORe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,l=n.y2,c=n.className,u=n.alwaysShow,d=n.clipPathId;Qo(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=ja(a),m=ja(i),p=ja(s),v=ja(l),b=this.props.shape;if(!f&&!m&&!p&&!v&&!b)return null;var y=$Re(f,m,p,v,this.props);if(!y&&!b)return null;var S=_l(this.props,"hidden")?"url(#".concat(d,")"):void 0;return le.createElement(Ir,{className:ur("recharts-reference-area",c)},t.renderRect(b,kY(kY({clipPath:S},Ut(this.props,!0)),y)),$a.renderCallByParent(this.props,y))}}])})(le.Component);Hj(qj,"displayName","ReferenceArea");Hj(qj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Hj(qj,"renderRect",function(e,t){var r;return le.isValidElement(e)?r=le.cloneElement(e,t):Jt(e)?r=e(t):r=le.createElement(zz,WI({},t,{className:"recharts-reference-area-rect"})),r});function Vle(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function FRe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return KIe(n,r)}function URe(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function Y_(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function HRe(e,t){return Vle(e,t+1)}function qRe(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,l=t.end,c=0,u=1,d=s,f=function(){var v=n?.[c];if(v===void 0)return{v:Vle(n,u)};var b=c,y,S=function(){return y===void 0&&(y=r(v,b)),y},_=v.coordinate,N=c===0||Y_(e,_,S,d,l);N||(c=0,d=s,u+=1),N&&(d=_+e*(S()/2+a),c+=u)},m;u<=i.length;)if(m=f(),m)return m.v;return[]}function By(e){"@babel/helpers - typeof";return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},By(e)}function _Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_Y(Object(r),!0).forEach(function(n){WRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_Y(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WRe(e,t,r){return t=KRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KRe(e){var t=GRe(e,"string");return By(t)=="symbol"?t:t+""}function GRe(e,t){if(By(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(By(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VRe(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,l=t.start,c=t.end,u=function(m){var p=i[m],v,b=function(){return v===void 0&&(v=r(p,m)),v};if(m===s-1){var y=e*(p.coordinate+e*b()/2-c);i[m]=p=gi(gi({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else i[m]=p=gi(gi({},p),{},{tickCoord:p.coordinate});var S=Y_(e,p.tickCoord,b,l,c);S&&(c=p.tickCoord-e*(b()/2+a),i[m]=gi(gi({},p),{},{isShow:!0}))},d=s-1;d>=0;d--)u(d);return i}function YRe(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,c=t.start,u=t.end;if(i){var d=n[l-1],f=r(d,l-1),m=e*(d.coordinate+e*f/2-u);s[l-1]=d=gi(gi({},d),{},{tickCoord:m>0?d.coordinate-m*e:d.coordinate});var p=Y_(e,d.tickCoord,function(){return f},c,u);p&&(u=d.tickCoord-e*(f/2+a),s[l-1]=gi(gi({},d),{},{isShow:!0}))}for(var v=i?l-1:l,b=function(_){var N=s[_],k,j=function(){return k===void 0&&(k=r(N,_)),k};if(_===0){var E=e*(N.coordinate-e*j()/2-c);s[_]=N=gi(gi({},N),{},{tickCoord:E<0?N.coordinate-E*e:N.coordinate})}else s[_]=N=gi(gi({},N),{},{tickCoord:N.coordinate});var T=Y_(e,N.tickCoord,j,c,u);T&&(c=N.tickCoord+e*(j()/2+a),s[_]=gi(gi({},N),{},{isShow:!0}))},y=0;y<v;y++)b(y);return s}function Kz(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,l=e.orientation,c=e.interval,u=e.tickFormatter,d=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(et(c)||Kh.isSsr)return HRe(a,typeof c=="number"&&et(c)?c:0);var m=[],p=l==="top"||l==="bottom"?"width":"height",v=d&&p==="width"?jb(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=function(N,k){var j=Jt(u)?u(N.value,k):N.value;return p==="width"?FRe(jb(j,{fontSize:t,letterSpacing:r}),v,f):jb(j,{fontSize:t,letterSpacing:r})[p]},y=a.length>=2?Ai(a[1].coordinate-a[0].coordinate):1,S=URe(i,y,p);return c==="equidistantPreserveStart"?qRe(y,S,b,a,s):(c==="preserveStart"||c==="preserveStartEnd"?m=YRe(y,S,b,a,s,c==="preserveStartEnd"):m=VRe(y,S,b,a,s),m.filter(function(_){return _.isShow}))}var QRe=["viewBox"],JRe=["viewBox"],ZRe=["ticks"];function gg(e){"@babel/helpers - typeof";return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gg(e)}function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(this,arguments)}function NY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NY(Object(r),!0).forEach(function(n){Gz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pD(e,t){if(e==null)return{};var r=XRe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ePe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qle(n.key),n)}}function tPe(e,t,r){return t&&CY(e.prototype,t),r&&CY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rPe(e,t,r){return t=Q_(t),nPe(e,Yle()?Reflect.construct(t,r||[],Q_(e).constructor):t.apply(e,r))}function nPe(e,t){if(t&&(gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aPe(e)}function aPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yle=function(){return!!e})()}function Q_(e){return Q_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q_(e)}function iPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GI(e,t)}function GI(e,t){return GI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},GI(e,t)}function Gz(e,t,r){return t=Qle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qle(e){var t=sPe(e,"string");return gg(t)=="symbol"?t:t+""}function sPe(e,t){if(gg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var f0=(function(e){function t(r){var n;return ePe(this,t),n=rPe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return iPe(t,e),tPe(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=pD(n,QRe),l=this.props,c=l.viewBox,u=pD(l,JRe);return!Op(i,c)||!Op(s,u)||!Op(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,l=a.width,c=a.height,u=a.orientation,d=a.tickSize,f=a.mirror,m=a.tickMargin,p,v,b,y,S,_,N=f?-1:1,k=n.tickSize||d,j=et(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":p=v=n.coordinate,y=s+ +!f*c,b=y-N*k,_=b-N*m,S=j;break;case"left":b=y=n.coordinate,v=i+ +!f*l,p=v-N*k,S=p-N*m,_=j;break;case"right":b=y=n.coordinate,v=i+ +f*l,p=v+N*k,S=p+N*m,_=j;break;default:p=v=n.coordinate,y=s+ +f*c,b=y+N*k,_=b+N*m,S=j;break}return{line:{x1:p,y1:b,x2:v,y2:y},tick:{x:S,y:_}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.orientation,u=n.mirror,d=n.axisLine,f=wa(wa(wa({},Ut(this.props,!1)),Ut(d,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var m=+(c==="top"&&!u||c==="bottom"&&u);f=wa(wa({},f),{},{x1:a,y1:i+m*l,x2:a+s,y2:i+m*l})}else{var p=+(c==="left"&&!u||c==="right"&&u);f=wa(wa({},f),{},{x1:a+p*s,y1:i,x2:a+p*s,y2:i+l})}return le.createElement("line",Cp({},f,{className:ur("recharts-cartesian-axis-line",Ds(d,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,l=this.props,c=l.tickLine,u=l.stroke,d=l.tick,f=l.tickFormatter,m=l.unit,p=Kz(wa(wa({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),b=this.getTickVerticalAnchor(),y=Ut(this.props,!1),S=Ut(d,!1),_=wa(wa({},y),{},{fill:"none"},Ut(c,!1)),N=p.map(function(k,j){var E=s.getTickLineCoord(k),T=E.line,O=E.tick,R=wa(wa(wa(wa({textAnchor:v,verticalAnchor:b},y),{},{stroke:"none",fill:u},S),O),{},{index:j,payload:k,visibleTicksCount:p.length,tickFormatter:f});return le.createElement(Ir,Cp({className:"recharts-cartesian-axis-tick",key:"tick-".concat(k.value,"-").concat(k.coordinate,"-").concat(k.tickCoord)},xh(s.props,k,j)),c&&le.createElement("line",Cp({},_,T,{className:ur("recharts-cartesian-axis-tick-line",Ds(c,"className"))})),d&&t.renderTickItem(d,R,"".concat(Jt(f)?f(k.value,j):k.value).concat(m||"")))});return le.createElement("g",{className:"recharts-cartesian-axis-ticks"},N)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,l=a.height,c=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var f=this.props,m=f.ticks,p=pD(f,ZRe),v=m;return Jt(c)&&(v=m&&m.length>0?c(this.props):c(p)),s<=0||l<=0||!v||!v.length?null:le.createElement(Ir,{className:ur("recharts-cartesian-axis",u),ref:function(y){n.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),$a.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,l=ur(a.className,"recharts-cartesian-axis-tick-value");return le.isValidElement(n)?s=le.cloneElement(n,wa(wa({},a),{},{className:l})):Jt(n)?s=n(wa(wa({},a),{},{className:l})):s=le.createElement(wh,Cp({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])})(w.Component);Gz(f0,"displayName","CartesianAxis");Gz(f0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var oPe=["x1","y1","x2","y2","key"],lPe=["offset"];function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function jY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jY(Object(r),!0).forEach(function(n){cPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cPe(e,t,r){return t=uPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uPe(e){var t=dPe(e,"string");return _h(t)=="symbol"?t:t+""}function dPe(e,t){if(_h(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_h(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gf(){return Gf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gf.apply(this,arguments)}function EY(e,t){if(e==null)return{};var r=fPe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var hPe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,l=t.height,c=t.ry;return le.createElement("rect",{x:a,y:i,ry:c,width:s,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Jle(e,t){var r;if(le.isValidElement(e))r=le.cloneElement(e,t);else if(Jt(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,l=t.key,c=EY(t,oPe),u=Ut(c,!1);u.offset;var d=EY(u,lPe);r=le.createElement("line",Gf({},d,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function mPe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var u=bi(bi({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return Jle(a,u)});return le.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function pPe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var u=bi(bi({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return Jle(a,u)});return le.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function gPe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,l=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var d=l.map(function(m){return Math.round(m+a-a)}).sort(function(m,p){return m-p});a!==d[0]&&d.unshift(0);var f=d.map(function(m,p){var v=!d[p+1],b=v?a+s-m:d[p+1]-m;if(b<=0)return null;var y=p%t.length;return le.createElement("rect",{key:"react-".concat(p),y:m,x:n,height:b,width:i,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return le.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function vPe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,l=e.width,c=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(m){return Math.round(m+i-i)}).sort(function(m,p){return m-p});i!==d[0]&&d.unshift(0);var f=d.map(function(m,p){var v=!d[p+1],b=v?i+l-m:d[p+1]-m;if(b<=0)return null;var y=p%n.length;return le.createElement("rect",{key:"react-".concat(p),x:m,y:s,width:b,height:c,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return le.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var bPe=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return Qoe(Kz(bi(bi(bi({},f0.defaultProps),n),{},{ticks:Uc(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},yPe=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return Qoe(Kz(bi(bi(bi({},f0.defaultProps),n),{},{ticks:Uc(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},Jm={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Vz(e){var t,r,n,a,i,s,l=Uz(),c=Hz(),u=sRe(),d=bi(bi({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Jm.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Jm.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Jm.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Jm.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Jm.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Jm.verticalFill,x:et(e.x)?e.x:u.left,y:et(e.y)?e.y:u.top,width:et(e.width)?e.width:u.width,height:et(e.height)?e.height:u.height}),f=d.x,m=d.y,p=d.width,v=d.height,b=d.syncWithTicks,y=d.horizontalValues,S=d.verticalValues,_=nRe(),N=aRe();if(!et(p)||p<=0||!et(v)||v<=0||!et(f)||f!==+f||!et(m)||m!==+m)return null;var k=d.verticalCoordinatesGenerator||bPe,j=d.horizontalCoordinatesGenerator||yPe,E=d.horizontalPoints,T=d.verticalPoints;if((!E||!E.length)&&Jt(j)){var O=y&&y.length,R=j({yAxis:N?bi(bi({},N),{},{ticks:O?y:N.ticks}):void 0,width:l,height:c,offset:u},O?!0:b);Qo(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(_h(R),"]")),Array.isArray(R)&&(E=R)}if((!T||!T.length)&&Jt(k)){var q=S&&S.length,$=k({xAxis:_?bi(bi({},_),{},{ticks:q?S:_.ticks}):void 0,width:l,height:c,offset:u},q?!0:b);Qo(Array.isArray($),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(_h($),"]")),Array.isArray($)&&(T=$)}return le.createElement("g",{className:"recharts-cartesian-grid"},le.createElement(hPe,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),le.createElement(mPe,Gf({},d,{offset:u,horizontalPoints:E,xAxis:_,yAxis:N})),le.createElement(pPe,Gf({},d,{offset:u,verticalPoints:T,xAxis:_,yAxis:N})),le.createElement(gPe,Gf({},d,{horizontalPoints:E})),le.createElement(vPe,Gf({},d,{verticalPoints:T})))}Vz.displayName="CartesianGrid";var xPe=["type","layout","connectNulls","ref"],wPe=["key"];function vg(e){"@babel/helpers - typeof";return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}function MY(e,t){if(e==null)return{};var r=SPe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Lb(){return Lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lb.apply(this,arguments)}function TY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TY(Object(r),!0).forEach(function(n){Po(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zm(e){return CPe(e)||NPe(e)||_Pe(e)||kPe()}function kPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Pe(e,t){if(e){if(typeof e=="string")return VI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VI(e,t)}}function NPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CPe(e){if(Array.isArray(e))return VI(e)}function VI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xle(n.key),n)}}function EPe(e,t,r){return t&&AY(e.prototype,t),r&&AY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MPe(e,t,r){return t=J_(t),TPe(e,Zle()?Reflect.construct(t,r||[],J_(e).constructor):t.apply(e,r))}function TPe(e,t){if(t&&(vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return APe(e)}function APe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zle=function(){return!!e})()}function J_(e){return J_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},J_(e)}function DPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YI(e,t)}function YI(e,t){return YI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YI(e,t)}function Po(e,t,r){return t=Xle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xle(e){var t=LPe(e,"string");return vg(t)=="symbol"?t:t+""}function LPe(e,t){if(vg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Qx=(function(e){function t(){var r;jPe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=MPe(this,t,[].concat(a)),Po(r,"state",{isAnimationFinished:!0,totalLength:0}),Po(r,"generateSimpleStrokeDasharray",function(s,l){return"".concat(l,"px ").concat(s-l,"px")}),Po(r,"getStrokeDasharray",function(s,l,c){var u=c.reduce(function(S,_){return S+_});if(!u)return r.generateSimpleStrokeDasharray(l,s);for(var d=Math.floor(s/u),f=s%u,m=l-s,p=[],v=0,b=0;v<c.length;b+=c[v],++v)if(b+c[v]>f){p=[].concat(Zm(c.slice(0,v)),[f-b]);break}var y=p.length%2===0?[0,m]:[m];return[].concat(Zm(t.repeat(c,d)),Zm(p),y).map(function(S){return"".concat(S,"px")}).join(", ")}),Po(r,"id",l0("recharts-line-")),Po(r,"pathRef",function(s){r.mainCurve=s}),Po(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Po(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return DPe(t,e),EPe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,f=Ls(d,Yx);if(!f)return null;var m=function(b,y){return{x:b.x,y:b.y,value:b.value,errorVal:Ca(b.payload,y)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return le.createElement(Ir,p,f.map(function(v){return le.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:s,xAxis:l,yAxis:c,layout:u,dataPointFormatter:m})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,u=l.points,d=l.dataKey,f=Ut(this.props,!1),m=Ut(c,!0),p=u.map(function(b,y){var S=ys(ys(ys({key:"dot-".concat(y),r:3},f),m),{},{index:y,cx:b.x,cy:b.y,value:b.value,dataKey:d,payload:b.payload,points:u});return t.renderDotItem(c,S)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return le.createElement(Ir,Lb({className:"recharts-line-dots",key:"dots"},v),p)}},{key:"renderCurveStatically",value:function(n,a,i,s){var l=this.props,c=l.type,u=l.layout,d=l.connectNulls;l.ref;var f=MY(l,xPe),m=ys(ys(ys({},Ut(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:c,layout:u,connectNulls:d});return le.createElement(T_,Lb({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,l=s.points,c=s.strokeDasharray,u=s.isAnimationActive,d=s.animationBegin,f=s.animationDuration,m=s.animationEasing,p=s.animationId,v=s.animateNewValues,b=s.width,y=s.height,S=this.state,_=S.prevPoints,N=S.totalLength;return le.createElement(Ll,{begin:d,duration:f,isActive:u,easing:m,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(k){var j=k.t;if(_){var E=_.length/l.length,T=l.map(function(L,A){var M=Math.floor(A*E);if(_[M]){var z=_[M],I=js(z.x,L.x),B=js(z.y,L.y);return ys(ys({},L),{},{x:I(j),y:B(j)})}if(v){var F=js(b*2,L.x),U=js(y/2,L.y);return ys(ys({},L),{},{x:F(j),y:U(j)})}return ys(ys({},L),{},{x:L.x,y:L.y})});return i.renderCurveStatically(T,n,a)}var O=js(0,N),R=O(j),q;if(c){var $="".concat(c).split(/[,\s]+/gim).map(function(L){return parseFloat(L)});q=i.getStrokeDasharray(R,N,$)}else q=i.generateSimpleStrokeDasharray(N,R);return i.renderCurveStatically(l,n,a,{strokeDasharray:q})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,l=i.isAnimationActive,c=this.state,u=c.prevPoints,d=c.totalLength;return l&&s&&s.length&&(!u&&d>0||!Vx(u,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,l=a.points,c=a.className,u=a.xAxis,d=a.yAxis,f=a.top,m=a.left,p=a.width,v=a.height,b=a.isAnimationActive,y=a.id;if(i||!l||!l.length)return null;var S=this.state.isAnimationFinished,_=l.length===1,N=ur("recharts-line",c),k=u&&u.allowDataOverflow,j=d&&d.allowDataOverflow,E=k||j,T=tr(y)?this.id:y,O=(n=Ut(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=O.r,q=R===void 0?3:R,$=O.strokeWidth,L=$===void 0?2:$,A=nNe(s)?s:{},M=A.clipDot,z=M===void 0?!0:M,I=q*2+L;return le.createElement(Ir,{className:N},k||j?le.createElement("defs",null,le.createElement("clipPath",{id:"clipPath-".concat(T)},le.createElement("rect",{x:k?m:m-p/2,y:j?f:f-v/2,width:k?p:p*2,height:j?v:v*2})),!z&&le.createElement("clipPath",{id:"clipPath-dots-".concat(T)},le.createElement("rect",{x:m-I/2,y:f-I/2,width:p+I,height:v+I}))):null,!_&&this.renderCurve(E,T),this.renderErrorBar(E,T),(_||s)&&this.renderDots(E,z,T),(!b||S)&&Zc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Zm(n),[0]):n,s=[],l=0;l<a;++l)s=[].concat(Zm(s),Zm(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(le.isValidElement(n))i=le.cloneElement(n,a);else if(Jt(n))i=n(a);else{var s=a.key,l=MY(a,wPe),c=ur("recharts-line-dot",typeof n!="boolean"?n.className:"");i=le.createElement(Lj,Lb({key:s},l,{className:c}))}return i}}])})(w.PureComponent);Po(Qx,"displayName","Line");Po(Qx,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Kh.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Po(Qx,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,l=e.bandSize,c=e.displayedData,u=e.offset,d=t.layout,f=c.map(function(m,p){var v=Ca(m,s);return d==="horizontal"?{x:IG({axis:r,ticks:a,bandSize:l,entry:m,index:p}),y:tr(v)?null:n.scale(v),value:v,payload:m}:{x:tr(v)?null:r.scale(v),y:IG({axis:n,ticks:i,bandSize:l,entry:m,index:p}),value:v,payload:m}});return ys({points:f,layout:d},u)});function bg(e){"@babel/helpers - typeof";return bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bg(e)}function OPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IPe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rce(n.key),n)}}function RPe(e,t,r){return t&&IPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PPe(e,t,r){return t=Z_(t),zPe(e,ece()?Reflect.construct(t,r||[],Z_(e).constructor):t.apply(e,r))}function zPe(e,t){if(t&&(bg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BPe(e)}function BPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ece(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ece=function(){return!!e})()}function Z_(e){return Z_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Z_(e)}function $Pe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QI(e,t)}function tce(e,t,r){return t=rce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rce(e){var t=FPe(e,"string");return bg(t)=="symbol"?t:t+""}function FPe(e,t){if(bg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JI.apply(this,arguments)}function UPe(e){var t=e.xAxisId,r=Uz(),n=Hz(),a=$le(t);return a==null?null:w.createElement(f0,JI({},a,{className:ur("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return Uc(s,!0)}}))}var Qh=(function(e){function t(){return OPe(this,t),PPe(this,t,arguments)}return $Pe(t,e),RPe(t,[{key:"render",value:function(){return w.createElement(UPe,this.props)}}])})(w.Component);tce(Qh,"displayName","XAxis");tce(Qh,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function yg(e){"@babel/helpers - typeof";return yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yg(e)}function HPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qPe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ice(n.key),n)}}function WPe(e,t,r){return t&&qPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KPe(e,t,r){return t=X_(t),GPe(e,nce()?Reflect.construct(t,r||[],X_(e).constructor):t.apply(e,r))}function GPe(e,t){if(t&&(yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VPe(e)}function VPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nce=function(){return!!e})()}function X_(e){return X_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},X_(e)}function YPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZI(e,t)}function ZI(e,t){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZI(e,t)}function ace(e,t,r){return t=ice(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ice(e){var t=QPe(e,"string");return yg(t)=="symbol"?t:t+""}function QPe(e,t){if(yg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function XI(){return XI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XI.apply(this,arguments)}var JPe=function(t){var r=t.yAxisId,n=Uz(),a=Hz(),i=Fle(r);return i==null?null:w.createElement(f0,XI({},i,{className:ur("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return Uc(l,!0)}}))},Jh=(function(e){function t(){return HPe(this,t),KPe(this,t,arguments)}return YPe(t,e),WPe(t,[{key:"render",value:function(){return w.createElement(JPe,this.props)}}])})(w.Component);ace(Jh,"displayName","YAxis");ace(Jh,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function DY(e){return t5e(e)||e5e(e)||XPe(e)||ZPe()}function ZPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XPe(e,t){if(e){if(typeof e=="string")return eR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eR(e,t)}}function e5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t5e(e){if(Array.isArray(e))return eR(e)}function eR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tR=function(t,r,n,a,i){var s=Ls(t,Wz),l=Ls(t,Uj),c=[].concat(DY(s),DY(l)),u=Ls(t,qj),d="".concat(a,"Id"),f=a[0],m=r;if(c.length&&(m=c.reduce(function(b,y){if(y.props[d]===n&&_l(y.props,"extendDomain")&&et(y.props[f])){var S=y.props[f];return[Math.min(b[0],S),Math.max(b[1],S)]}return b},m)),u.length){var p="".concat(f,"1"),v="".concat(f,"2");m=u.reduce(function(b,y){if(y.props[d]===n&&_l(y.props,"extendDomain")&&et(y.props[p])&&et(y.props[v])){var S=y.props[p],_=y.props[v];return[Math.min(b[0],S,_),Math.max(b[1],S,_)]}return b},m)}return i&&i.length&&(m=i.reduce(function(b,y){return et(y)?[Math.min(b[0],y),Math.max(b[1],y)]:b},m)),m},gD={exports:{}},LY;function r5e(){return LY||(LY=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,f,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,f||c,m),v=r?r+u:u;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],p]:c._events[v].push(p):(c._events[v]=p,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,p=f.length,v=new Array(p);m<p;m++)v[m]=f[m].fn;return v},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,m,p,v){var b=r?r+u:u;if(!this._events[b])return!1;var y=this._events[b],S=arguments.length,_,N;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),S){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,m),!0;case 5:return y.fn.call(y.context,d,f,m,p),!0;case 6:return y.fn.call(y.context,d,f,m,p,v),!0}for(N=1,_=new Array(S-1);N<S;N++)_[N-1]=arguments[N];y.fn.apply(y.context,_)}else{var k=y.length,j;for(N=0;N<k;N++)switch(y[N].once&&this.removeListener(u,y[N].fn,void 0,!0),S){case 1:y[N].fn.call(y[N].context);break;case 2:y[N].fn.call(y[N].context,d);break;case 3:y[N].fn.call(y[N].context,d,f);break;case 4:y[N].fn.call(y[N].context,d,f,m);break;default:if(!_)for(j=1,_=new Array(S-1);j<S;j++)_[j-1]=arguments[j];y[N].fn.apply(y[N].context,_)}}return!0},l.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,m){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===d&&(!m||v.once)&&(!f||v.context===f)&&s(this,p);else{for(var b=0,y=[],S=v.length;b<S;b++)(v[b].fn!==d||m&&!v[b].once||f&&v[b].context!==f)&&y.push(v[b]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(gD)),gD.exports}var n5e=r5e();const a5e=Fr(n5e);var vD=new a5e,bD="recharts.syncMouseEvents";function $y(e){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function i5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s5e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sce(n.key),n)}}function o5e(e,t,r){return t&&s5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yD(e,t,r){return t=sce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sce(e){var t=l5e(e,"string");return $y(t)=="symbol"?t:t+""}function l5e(e,t){if($y(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var c5e=(function(){function e(){i5e(this,e),yD(this,"activeIndex",0),yD(this,"coordinateList",[]),yD(this,"layout","horizontal")}return o5e(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,l=s===void 0?null:s,c=r.layout,u=c===void 0?null:c,d=r.offset,f=d===void 0?null:d,m=r.mouseHandlerCallback,p=m===void 0?null:m;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+c+u,m=s+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:f,pageY:m})}}}])})();function u5e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],a=e?.[1];if(n&&a&&et(n)&&et(a))return!0}return!1}function d5e(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function oce(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=xn(t,r,n,a),l=xn(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function f5e(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,m=xn(l,c,u,f),p=xn(l,c,d,f);n=m.x,a=m.y,i=p.x,s=p.y}else return oce(t);return[{x:n,y:a},{x:i,y:s}]}function Fy(e){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function OY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OY(Object(r),!0).forEach(function(n){h5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h5e(e,t,r){return t=m5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m5e(e){var t=p5e(e,"string");return Fy(t)=="symbol"?t:t+""}function p5e(e,t){if(Fy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g5e(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,l=e.activePayload,c=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,m=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!i||!s||m!=="ScatterChart"&&a!=="axis")return null;var v,b=T_;if(m==="ScatterChart")v=s,b=zLe;else if(m==="BarChart")v=d5e(f,s,c,d),b=zz;else if(f==="radial"){var y=oce(s),S=y.cx,_=y.cy,N=y.radius,k=y.startAngle,j=y.endAngle;v={cx:S,cy:_,startAngle:k,endAngle:j,innerRadius:N,outerRadius:N},b=ole}else v={points:f5e(f,s,c)},b=T_;var E=iS(iS(iS(iS({stroke:"#ccc",pointerEvents:"none"},c),v),Ut(p,!1)),{},{payload:l,payloadIndex:u,className:ur("recharts-tooltip-cursor",p.className)});return w.isValidElement(p)?w.cloneElement(p,E):w.createElement(b,E)}var v5e=["item"],b5e=["children","className","width","height","style","compact","title","desc"];function xg(e){"@babel/helpers - typeof";return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(e)}function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jp.apply(this,arguments)}function IY(e,t){return w5e(e)||x5e(e,t)||cce(e,t)||y5e()}function y5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function w5e(e){if(Array.isArray(e))return e}function RY(e,t){if(e==null)return{};var r=S5e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function S5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function k5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _5e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uce(n.key),n)}}function N5e(e,t,r){return t&&_5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C5e(e,t,r){return t=eN(t),j5e(e,lce()?Reflect.construct(t,r||[],eN(e).constructor):t.apply(e,r))}function j5e(e,t){if(t&&(xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E5e(e)}function E5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lce=function(){return!!e})()}function eN(e){return eN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eN(e)}function M5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rR(e,t)}function wg(e){return D5e(e)||A5e(e)||cce(e)||T5e()}function T5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cce(e,t){if(e){if(typeof e=="string")return nR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nR(e,t)}}function A5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D5e(e){if(Array.isArray(e))return nR(e)}function nR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PY(Object(r),!0).forEach(function(n){Gt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gt(e,t,r){return t=uce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uce(e){var t=L5e(e,"string");return xg(t)=="symbol"?t:t+""}function L5e(e,t){if(xg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O5e={xAxis:["bottom","top"],yAxis:["left","right"]},I5e={width:"100%",height:"100%"},dce={x:0,y:0};function sS(e){return e}var R5e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},P5e=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,l=a.radius;return Be(Be(Be({},a),xn(a.cx,a.cy,l,s)),{},{angle:s,radius:l})}var c=i.coordinate,u=a.angle;return Be(Be(Be({},a),xn(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return dce},Wj=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(wg(l),wg(u)):l},[]);return s.length>0?s:t&&t.length&&et(a)&&et(i)?t.slice(a,i+1):[]};function fce(e){return e==="number"?[0,"auto"]:void 0}var aR=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,l=Wj(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var m;if(s.dataKey&&!s.allowDuplicatedCategory){var p=f===void 0?l:f;m=t_(p,s.dataKey,a)}else m=f&&f[n]||l[n];return m?[].concat(wg(c),[tle(u,m)]):c},[])},zY=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=R5e(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=i3e(s,l,u,c);if(d>=0&&u){var f=u[d]&&u[d].value,m=aR(t,r,d,f),p=P5e(n,l,d,i);return{activeTooltipIndex:d,activeLabel:f,activePayload:m,activeCoordinate:p}}return null},z5e=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,m=t.stackOffset,p=Yoe(d,i);return n.reduce(function(v,b){var y,S=b.type.defaultProps!==void 0?Be(Be({},b.type.defaultProps),b.props):b.props,_=S.type,N=S.dataKey,k=S.allowDataOverflow,j=S.allowDuplicatedCategory,E=S.scale,T=S.ticks,O=S.includeHidden,R=S[s];if(v[R])return v;var q=Wj(t.data,{graphicalItems:a.filter(function(G){var J,ee=s in G.props?G.props[s]:(J=G.type.defaultProps)===null||J===void 0?void 0:J[s];return ee===R}),dataStartIndex:c,dataEndIndex:u}),$=q.length,L,A,M;u5e(S.domain,k,_)&&(L=gI(S.domain,null,k),p&&(_==="number"||E!=="auto")&&(M=Mb(q,N,"category")));var z=fce(_);if(!L||L.length===0){var I,B=(I=S.domain)!==null&&I!==void 0?I:z;if(N){if(L=Mb(q,N,_),_==="category"&&p){var F=G_e(L);j&&F?(A=L,L=F_(0,$)):j||(L=BG(B,L,b).reduce(function(G,J){return G.indexOf(J)>=0?G:[].concat(wg(G),[J])},[]))}else if(_==="category")j?L=L.filter(function(G){return G!==""&&!tr(G)}):L=BG(B,L,b).reduce(function(G,J){return G.indexOf(J)>=0||J===""||tr(J)?G:[].concat(wg(G),[J])},[]);else if(_==="number"){var U=u3e(q,a.filter(function(G){var J,ee,Y=s in G.props?G.props[s]:(J=G.type.defaultProps)===null||J===void 0?void 0:J[s],ie="hide"in G.props?G.props.hide:(ee=G.type.defaultProps)===null||ee===void 0?void 0:ee.hide;return Y===R&&(O||!ie)}),N,i,d);U&&(L=U)}p&&(_==="number"||E!=="auto")&&(M=Mb(q,N,"category"))}else p?L=F_(0,$):l&&l[R]&&l[R].hasStack&&_==="number"?L=m==="expand"?[0,1]:ele(l[R].stackGroups,c,u):L=Voe(q,a.filter(function(G){var J=s in G.props?G.props[s]:G.type.defaultProps[s],ee="hide"in G.props?G.props.hide:G.type.defaultProps.hide;return J===R&&(O||!ee)}),_,d,!0);if(_==="number")L=tR(f,L,R,i,T),B&&(L=gI(B,L,k));else if(_==="category"&&B){var V=B,K=L.every(function(G){return V.indexOf(G)>=0});K&&(L=V)}}return Be(Be({},v),{},Gt({},R,Be(Be({},S),{},{axisType:i,domain:L,categoricalDomain:M,duplicateDomain:A,originalDomain:(y=S.domain)!==null&&y!==void 0?y:z,isCategorical:p,layout:d})))},{})},B5e=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,m=Wj(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),p=m.length,v=Yoe(d,i),b=-1;return n.reduce(function(y,S){var _=S.type.defaultProps!==void 0?Be(Be({},S.type.defaultProps),S.props):S.props,N=_[s],k=fce("number");if(!y[N]){b++;var j;return v?j=F_(0,p):l&&l[N]&&l[N].hasStack?(j=ele(l[N].stackGroups,c,u),j=tR(f,j,N,i)):(j=gI(k,Voe(m,n.filter(function(E){var T,O,R=s in E.props?E.props[s]:(T=E.type.defaultProps)===null||T===void 0?void 0:T[s],q="hide"in E.props?E.props.hide:(O=E.type.defaultProps)===null||O===void 0?void 0:O.hide;return R===N&&!q}),"number",d),a.defaultProps.allowDataOverflow),j=tR(f,j,N,i)),Be(Be({},y),{},Gt({},N,Be(Be({axisType:i},a.defaultProps),{},{hide:!0,orientation:Ds(O5e,"".concat(i,".").concat(b%2),null),domain:j,originalDomain:k,isCategorical:v,layout:d})))}return y},{})},$5e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(a,"Id"),m=Ls(d,i),p={};return m&&m.length?p=z5e(t,{axes:m,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):s&&s.length&&(p=B5e(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),p},F5e=function(t){var r=ud(t),n=Uc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:dz(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:j_(r,n)}},BY=function(t){var r=t.children,n=t.defaultShowTooltip,a=Ns(r,dg),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},U5e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Yc(r&&r.type);return n&&n.indexOf("Bar")>=0})},$Y=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},H5e=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,u=n.width,d=n.height,f=n.children,m=n.margin||{},p=Ns(f,dg),v=Ns(f,Ip),b=Object.keys(c).reduce(function(j,E){var T=c[E],O=T.orientation;return!T.mirror&&!T.hide?Be(Be({},j),{},Gt({},O,j[O]+T.width)):j},{left:m.left||0,right:m.right||0}),y=Object.keys(s).reduce(function(j,E){var T=s[E],O=T.orientation;return!T.mirror&&!T.hide?Be(Be({},j),{},Gt({},O,Ds(j,"".concat(O))+T.height)):j},{top:m.top||0,bottom:m.bottom||0}),S=Be(Be({},y),b),_=S.bottom;p&&(S.bottom+=p.props.height||dg.defaultProps.height),v&&r&&(S=l3e(S,a,n,r));var N=u-S.left-S.right,k=d-S.top-S.bottom;return Be(Be({brushBottom:_},S),{},{width:Math.max(N,0),height:Math.max(k,0)})},q5e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Yz=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,l=s===void 0?["axis"]:s,c=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,m=function(S,_){var N=_.graphicalItems,k=_.stackGroups,j=_.offset,E=_.updateId,T=_.dataStartIndex,O=_.dataEndIndex,R=S.barSize,q=S.layout,$=S.barGap,L=S.barCategoryGap,A=S.maxBarSize,M=$Y(q),z=M.numericAxisName,I=M.cateAxisName,B=U5e(N),F=[];return N.forEach(function(U,V){var K=Wj(S.data,{graphicalItems:[U],dataStartIndex:T,dataEndIndex:O}),G=U.type.defaultProps!==void 0?Be(Be({},U.type.defaultProps),U.props):U.props,J=G.dataKey,ee=G.maxBarSize,Y=G["".concat(z,"Id")],ie=G["".concat(I,"Id")],fe={},me=c.reduce(function(we,ve){var Le=_["".concat(ve.axisType,"Map")],Ae=G["".concat(ve.axisType,"Id")];Le&&Le[Ae]||ve.axisType==="zAxis"||gh(!1);var Re=Le[Ae];return Be(Be({},we),{},Gt(Gt({},ve.axisType,Re),"".concat(ve.axisType,"Ticks"),Uc(Re)))},fe),te=me[I],oe=me["".concat(I,"Ticks")],ce=k&&k[Y]&&k[Y].hasStack&&y3e(U,k[Y].stackGroups),Z=Yc(U.type).indexOf("Bar")>=0,ue=j_(te,oe),H=[],ge=B&&s3e({barSize:R,stackGroups:k,totalSize:q5e(me,I)});if(Z){var de,re,ne=tr(ee)?A:ee,pe=(de=(re=j_(te,oe,!0))!==null&&re!==void 0?re:ne)!==null&&de!==void 0?de:0;H=o3e({barGap:$,barCategoryGap:L,bandSize:pe!==ue?pe:ue,sizeList:ge[ie],maxBarSize:ne}),pe!==ue&&(H=H.map(function(we){return Be(Be({},we),{},{position:Be(Be({},we.position),{},{offset:we.position.offset-pe/2})})}))}var ke=U&&U.type&&U.type.getComposedData;ke&&F.push({props:Be(Be({},ke(Be(Be({},me),{},{displayedData:K,props:S,dataKey:J,item:U,bandSize:ue,barPosition:H,offset:j,stackedData:ce,layout:q,dataStartIndex:T,dataEndIndex:O}))),{},Gt(Gt(Gt({key:U.key||"item-".concat(V)},z,me[z]),I,me[I]),"animationId",E)),childIndex:sNe(U,S.children),item:U})}),F},p=function(S,_){var N=S.props,k=S.dataStartIndex,j=S.dataEndIndex,E=S.updateId;if(!Zq({props:N}))return null;var T=N.children,O=N.layout,R=N.stackOffset,q=N.data,$=N.reverseStackOrder,L=$Y(O),A=L.numericAxisName,M=L.cateAxisName,z=Ls(T,n),I=v3e(q,z,"".concat(A,"Id"),"".concat(M,"Id"),R,$),B=c.reduce(function(G,J){var ee="".concat(J.axisType,"Map");return Be(Be({},G),{},Gt({},ee,$5e(N,Be(Be({},J),{},{graphicalItems:z,stackGroups:J.axisType===A&&I,dataStartIndex:k,dataEndIndex:j}))))},{}),F=H5e(Be(Be({},B),{},{props:N,graphicalItems:z}),_?.legendBBox);Object.keys(B).forEach(function(G){B[G]=d(N,B[G],F,G.replace("Map",""),r)});var U=B["".concat(M,"Map")],V=F5e(U),K=m(N,Be(Be({},B),{},{dataStartIndex:k,dataEndIndex:j,updateId:E,graphicalItems:z,stackGroups:I,offset:F}));return Be(Be({formattedGraphicalItems:K,graphicalItems:z,offset:F,stackGroups:I},V),B)},v=(function(y){function S(_){var N,k,j;return k5e(this,S),j=C5e(this,S,[_]),Gt(j,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Gt(j,"accessibilityManager",new c5e),Gt(j,"handleLegendBBoxUpdate",function(E){if(E){var T=j.state,O=T.dataStartIndex,R=T.dataEndIndex,q=T.updateId;j.setState(Be({legendBBox:E},p({props:j.props,dataStartIndex:O,dataEndIndex:R,updateId:q},Be(Be({},j.state),{},{legendBBox:E}))))}}),Gt(j,"handleReceiveSyncEvent",function(E,T,O){if(j.props.syncId===E){if(O===j.eventEmitterSymbol&&typeof j.props.syncMethod!="function")return;j.applySyncEvent(T)}}),Gt(j,"handleBrushChange",function(E){var T=E.startIndex,O=E.endIndex;if(T!==j.state.dataStartIndex||O!==j.state.dataEndIndex){var R=j.state.updateId;j.setState(function(){return Be({dataStartIndex:T,dataEndIndex:O},p({props:j.props,dataStartIndex:T,dataEndIndex:O,updateId:R},j.state))}),j.triggerSyncEvent({dataStartIndex:T,dataEndIndex:O})}}),Gt(j,"handleMouseEnter",function(E){var T=j.getMouseInfo(E);if(T){var O=Be(Be({},T),{},{isTooltipActive:!0});j.setState(O),j.triggerSyncEvent(O);var R=j.props.onMouseEnter;Jt(R)&&R(O,E)}}),Gt(j,"triggeredAfterMouseMove",function(E){var T=j.getMouseInfo(E),O=T?Be(Be({},T),{},{isTooltipActive:!0}):{isTooltipActive:!1};j.setState(O),j.triggerSyncEvent(O);var R=j.props.onMouseMove;Jt(R)&&R(O,E)}),Gt(j,"handleItemMouseEnter",function(E){j.setState(function(){return{isTooltipActive:!0,activeItem:E,activePayload:E.tooltipPayload,activeCoordinate:E.tooltipPosition||{x:E.cx,y:E.cy}}})}),Gt(j,"handleItemMouseLeave",function(){j.setState(function(){return{isTooltipActive:!1}})}),Gt(j,"handleMouseMove",function(E){E.persist(),j.throttleTriggeredAfterMouseMove(E)}),Gt(j,"handleMouseLeave",function(E){j.throttleTriggeredAfterMouseMove.cancel();var T={isTooltipActive:!1};j.setState(T),j.triggerSyncEvent(T);var O=j.props.onMouseLeave;Jt(O)&&O(T,E)}),Gt(j,"handleOuterEvent",function(E){var T=iNe(E),O=Ds(j.props,"".concat(T));if(T&&Jt(O)){var R,q;/.*touch.*/i.test(T)?q=j.getMouseInfo(E.changedTouches[0]):q=j.getMouseInfo(E),O((R=q)!==null&&R!==void 0?R:{},E)}}),Gt(j,"handleClick",function(E){var T=j.getMouseInfo(E);if(T){var O=Be(Be({},T),{},{isTooltipActive:!0});j.setState(O),j.triggerSyncEvent(O);var R=j.props.onClick;Jt(R)&&R(O,E)}}),Gt(j,"handleMouseDown",function(E){var T=j.props.onMouseDown;if(Jt(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"handleMouseUp",function(E){var T=j.props.onMouseUp;if(Jt(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"handleTouchMove",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&j.throttleTriggeredAfterMouseMove(E.changedTouches[0])}),Gt(j,"handleTouchStart",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&j.handleMouseDown(E.changedTouches[0])}),Gt(j,"handleTouchEnd",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&j.handleMouseUp(E.changedTouches[0])}),Gt(j,"handleDoubleClick",function(E){var T=j.props.onDoubleClick;if(Jt(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"handleContextMenu",function(E){var T=j.props.onContextMenu;if(Jt(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"triggerSyncEvent",function(E){j.props.syncId!==void 0&&vD.emit(bD,j.props.syncId,E,j.eventEmitterSymbol)}),Gt(j,"applySyncEvent",function(E){var T=j.props,O=T.layout,R=T.syncMethod,q=j.state.updateId,$=E.dataStartIndex,L=E.dataEndIndex;if(E.dataStartIndex!==void 0||E.dataEndIndex!==void 0)j.setState(Be({dataStartIndex:$,dataEndIndex:L},p({props:j.props,dataStartIndex:$,dataEndIndex:L,updateId:q},j.state)));else if(E.activeTooltipIndex!==void 0){var A=E.chartX,M=E.chartY,z=E.activeTooltipIndex,I=j.state,B=I.offset,F=I.tooltipTicks;if(!B)return;if(typeof R=="function")z=R(F,E);else if(R==="value"){z=-1;for(var U=0;U<F.length;U++)if(F[U].value===E.activeLabel){z=U;break}}var V=Be(Be({},B),{},{x:B.left,y:B.top}),K=Math.min(A,V.x+V.width),G=Math.min(M,V.y+V.height),J=F[z]&&F[z].value,ee=aR(j.state,j.props.data,z),Y=F[z]?{x:O==="horizontal"?F[z].coordinate:K,y:O==="horizontal"?G:F[z].coordinate}:dce;j.setState(Be(Be({},E),{},{activeLabel:J,activeCoordinate:Y,activePayload:ee,activeTooltipIndex:z}))}else j.setState(E)}),Gt(j,"renderCursor",function(E){var T,O=j.state,R=O.isTooltipActive,q=O.activeCoordinate,$=O.activePayload,L=O.offset,A=O.activeTooltipIndex,M=O.tooltipAxisBandSize,z=j.getTooltipEventType(),I=(T=E.props.active)!==null&&T!==void 0?T:R,B=j.props.layout,F=E.key||"_recharts-cursor";return le.createElement(g5e,{key:F,activeCoordinate:q,activePayload:$,activeTooltipIndex:A,chartName:r,element:E,isActive:I,layout:B,offset:L,tooltipAxisBandSize:M,tooltipEventType:z})}),Gt(j,"renderPolarAxis",function(E,T,O){var R=Ds(E,"type.axisType"),q=Ds(j.state,"".concat(R,"Map")),$=E.type.defaultProps,L=$!==void 0?Be(Be({},$),E.props):E.props,A=q&&q[L["".concat(R,"Id")]];return w.cloneElement(E,Be(Be({},A),{},{className:ur(R,A.className),key:E.key||"".concat(T,"-").concat(O),ticks:Uc(A,!0)}))}),Gt(j,"renderPolarGrid",function(E){var T=E.props,O=T.radialLines,R=T.polarAngles,q=T.polarRadius,$=j.state,L=$.radiusAxisMap,A=$.angleAxisMap,M=ud(L),z=ud(A),I=z.cx,B=z.cy,F=z.innerRadius,U=z.outerRadius;return w.cloneElement(E,{polarAngles:Array.isArray(R)?R:Uc(z,!0).map(function(V){return V.coordinate}),polarRadius:Array.isArray(q)?q:Uc(M,!0).map(function(V){return V.coordinate}),cx:I,cy:B,innerRadius:F,outerRadius:U,key:E.key||"polar-grid",radialLines:O})}),Gt(j,"renderLegend",function(){var E=j.state.formattedGraphicalItems,T=j.props,O=T.children,R=T.width,q=T.height,$=j.props.margin||{},L=R-($.left||0)-($.right||0),A=Koe({children:O,formattedGraphicalItems:E,legendWidth:L,legendContent:u});if(!A)return null;var M=A.item,z=RY(A,v5e);return w.cloneElement(M,Be(Be({},z),{},{chartWidth:R,chartHeight:q,margin:$,onBBoxUpdate:j.handleLegendBBoxUpdate}))}),Gt(j,"renderTooltip",function(){var E,T=j.props,O=T.children,R=T.accessibilityLayer,q=Ns(O,Cs);if(!q)return null;var $=j.state,L=$.isTooltipActive,A=$.activeCoordinate,M=$.activePayload,z=$.activeLabel,I=$.offset,B=(E=q.props.active)!==null&&E!==void 0?E:L;return w.cloneElement(q,{viewBox:Be(Be({},I),{},{x:I.left,y:I.top}),active:B,label:z,payload:B?M:[],coordinate:A,accessibilityLayer:R})}),Gt(j,"renderBrush",function(E){var T=j.props,O=T.margin,R=T.data,q=j.state,$=q.offset,L=q.dataStartIndex,A=q.dataEndIndex,M=q.updateId;return w.cloneElement(E,{key:E.key||"_recharts-brush",onChange:tS(j.handleBrushChange,E.props.onChange),data:R,x:et(E.props.x)?E.props.x:$.left,y:et(E.props.y)?E.props.y:$.top+$.height+$.brushBottom-(O.bottom||0),width:et(E.props.width)?E.props.width:$.width,startIndex:L,endIndex:A,updateId:"brush-".concat(M)})}),Gt(j,"renderReferenceElement",function(E,T,O){if(!E)return null;var R=j,q=R.clipPathId,$=j.state,L=$.xAxisMap,A=$.yAxisMap,M=$.offset,z=E.type.defaultProps||{},I=E.props,B=I.xAxisId,F=B===void 0?z.xAxisId:B,U=I.yAxisId,V=U===void 0?z.yAxisId:U;return w.cloneElement(E,{key:E.key||"".concat(T,"-").concat(O),xAxis:L[F],yAxis:A[V],viewBox:{x:M.left,y:M.top,width:M.width,height:M.height},clipPathId:q})}),Gt(j,"renderActivePoints",function(E){var T=E.item,O=E.activePoint,R=E.basePoint,q=E.childIndex,$=E.isRange,L=[],A=T.props.key,M=T.item.type.defaultProps!==void 0?Be(Be({},T.item.type.defaultProps),T.item.props):T.item.props,z=M.activeDot,I=M.dataKey,B=Be(Be({index:q,dataKey:I,cx:O.x,cy:O.y,r:4,fill:Pz(T.item),strokeWidth:2,stroke:"#fff",payload:O.payload,value:O.value},Ut(z,!1)),r_(z));return L.push(S.renderActiveDot(z,B,"".concat(A,"-activePoint-").concat(q))),R?L.push(S.renderActiveDot(z,Be(Be({},B),{},{cx:R.x,cy:R.y}),"".concat(A,"-basePoint-").concat(q))):$&&L.push(null),L}),Gt(j,"renderGraphicChild",function(E,T,O){var R=j.filterFormatItem(E,T,O);if(!R)return null;var q=j.getTooltipEventType(),$=j.state,L=$.isTooltipActive,A=$.tooltipAxis,M=$.activeTooltipIndex,z=$.activeLabel,I=j.props.children,B=Ns(I,Cs),F=R.props,U=F.points,V=F.isRange,K=F.baseLine,G=R.item.type.defaultProps!==void 0?Be(Be({},R.item.type.defaultProps),R.item.props):R.item.props,J=G.activeDot,ee=G.hide,Y=G.activeBar,ie=G.activeShape,fe=!!(!ee&&L&&B&&(J||Y||ie)),me={};q!=="axis"&&B&&B.props.trigger==="click"?me={onClick:tS(j.handleItemMouseEnter,E.props.onClick)}:q!=="axis"&&(me={onMouseLeave:tS(j.handleItemMouseLeave,E.props.onMouseLeave),onMouseEnter:tS(j.handleItemMouseEnter,E.props.onMouseEnter)});var te=w.cloneElement(E,Be(Be({},R.props),me));function oe(ve){return typeof A.dataKey=="function"?A.dataKey(ve.payload):null}if(fe)if(M>=0){var ce,Z;if(A.dataKey&&!A.allowDuplicatedCategory){var ue=typeof A.dataKey=="function"?oe:"payload.".concat(A.dataKey.toString());ce=t_(U,ue,z),Z=V&&K&&t_(K,ue,z)}else ce=U?.[M],Z=V&&K&&K[M];if(ie||Y){var H=E.props.activeIndex!==void 0?E.props.activeIndex:M;return[w.cloneElement(E,Be(Be(Be({},R.props),me),{},{activeIndex:H})),null,null]}if(!tr(ce))return[te].concat(wg(j.renderActivePoints({item:R,activePoint:ce,basePoint:Z,childIndex:M,isRange:V})))}else{var ge,de=(ge=j.getItemByXY(j.state.activeCoordinate))!==null&&ge!==void 0?ge:{graphicalItem:te},re=de.graphicalItem,ne=re.item,pe=ne===void 0?E:ne,ke=re.childIndex,we=Be(Be(Be({},R.props),me),{},{activeIndex:ke});return[w.cloneElement(pe,we),null,null]}return V?[te,null,null]:[te,null]}),Gt(j,"renderCustomized",function(E,T,O){return w.cloneElement(E,Be(Be({key:"recharts-customized-".concat(O)},j.props),j.state))}),Gt(j,"renderMap",{CartesianGrid:{handler:sS,once:!0},ReferenceArea:{handler:j.renderReferenceElement},ReferenceLine:{handler:sS},ReferenceDot:{handler:j.renderReferenceElement},XAxis:{handler:sS},YAxis:{handler:sS},Brush:{handler:j.renderBrush,once:!0},Bar:{handler:j.renderGraphicChild},Line:{handler:j.renderGraphicChild},Area:{handler:j.renderGraphicChild},Radar:{handler:j.renderGraphicChild},RadialBar:{handler:j.renderGraphicChild},Scatter:{handler:j.renderGraphicChild},Pie:{handler:j.renderGraphicChild},Funnel:{handler:j.renderGraphicChild},Tooltip:{handler:j.renderCursor,once:!0},PolarGrid:{handler:j.renderPolarGrid,once:!0},PolarAngleAxis:{handler:j.renderPolarAxis},PolarRadiusAxis:{handler:j.renderPolarAxis},Customized:{handler:j.renderCustomized}}),j.clipPathId="".concat((N=_.id)!==null&&N!==void 0?N:l0("recharts"),"-clip"),j.throttleTriggeredAfterMouseMove=Hse(j.triggeredAfterMouseMove,(k=_.throttleDelay)!==null&&k!==void 0?k:1e3/60),j.state={},j}return M5e(S,y),N5e(S,[{key:"componentDidMount",value:function(){var N,k;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(N=this.props.margin.left)!==null&&N!==void 0?N:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var N=this.props,k=N.children,j=N.data,E=N.height,T=N.layout,O=Ns(k,Cs);if(O){var R=O.props.defaultIndex;if(!(typeof R!="number"||R<0||R>this.state.tooltipTicks.length-1)){var q=this.state.tooltipTicks[R]&&this.state.tooltipTicks[R].value,$=aR(this.state,j,R,q),L=this.state.tooltipTicks[R].coordinate,A=(this.state.offset.top+E)/2,M=T==="horizontal",z=M?{x:L,y:A}:{y:L,x:A},I=this.state.formattedGraphicalItems.find(function(F){var U=F.item;return U.type.name==="Scatter"});I&&(z=Be(Be({},z),I.props.points[R].tooltipPosition),$=I.props.points[R].tooltipPayload);var B={activeTooltipIndex:R,isTooltipActive:!0,activeLabel:q,activePayload:$,activeCoordinate:z};this.setState(B),this.renderCursor(O),this.accessibilityManager.setIndex(R)}}}},{key:"getSnapshotBeforeUpdate",value:function(N,k){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==k.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==N.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==N.margin){var j,E;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(E=this.props.margin.top)!==null&&E!==void 0?E:0}})}return null}},{key:"componentDidUpdate",value:function(N){PO([Ns(N.children,Cs)],[Ns(this.props.children,Cs)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var N=Ns(this.props.children,Cs);if(N&&typeof N.props.shared=="boolean"){var k=N.props.shared?"axis":"item";return l.indexOf(k)>=0?k:i}return i}},{key:"getMouseInfo",value:function(N){if(!this.container)return null;var k=this.container,j=k.getBoundingClientRect(),E=K2e(j),T={chartX:Math.round(N.pageX-E.left),chartY:Math.round(N.pageY-E.top)},O=j.width/k.offsetWidth||1,R=this.inRange(T.chartX,T.chartY,O);if(!R)return null;var q=this.state,$=q.xAxisMap,L=q.yAxisMap,A=this.getTooltipEventType(),M=zY(this.state,this.props.data,this.props.layout,R);if(A!=="axis"&&$&&L){var z=ud($).scale,I=ud(L).scale,B=z&&z.invert?z.invert(T.chartX):null,F=I&&I.invert?I.invert(T.chartY):null;return Be(Be({},T),{},{xValue:B,yValue:F},M)}return M?Be(Be({},T),M):null}},{key:"inRange",value:function(N,k){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=this.props.layout,T=N/j,O=k/j;if(E==="horizontal"||E==="vertical"){var R=this.state.offset,q=T>=R.left&&T<=R.left+R.width&&O>=R.top&&O<=R.top+R.height;return q?{x:T,y:O}:null}var $=this.state,L=$.angleAxisMap,A=$.radiusAxisMap;if(L&&A){var M=ud(L);return UG({x:T,y:O},M)}return null}},{key:"parseEventsOfWrapper",value:function(){var N=this.props.children,k=this.getTooltipEventType(),j=Ns(N,Cs),E={};j&&k==="axis"&&(j.props.trigger==="click"?E={onClick:this.handleClick}:E={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var T=r_(this.props,this.handleOuterEvent);return Be(Be({},T),E)}},{key:"addListener",value:function(){vD.on(bD,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){vD.removeListener(bD,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(N,k,j){for(var E=this.state.formattedGraphicalItems,T=0,O=E.length;T<O;T++){var R=E[T];if(R.item===N||R.props.key===N.key||k===Yc(R.item.type)&&j===R.childIndex)return R}return null}},{key:"renderClipPath",value:function(){var N=this.clipPathId,k=this.state.offset,j=k.left,E=k.top,T=k.height,O=k.width;return le.createElement("defs",null,le.createElement("clipPath",{id:N},le.createElement("rect",{x:j,y:E,height:T,width:O})))}},{key:"getXScales",value:function(){var N=this.state.xAxisMap;return N?Object.entries(N).reduce(function(k,j){var E=IY(j,2),T=E[0],O=E[1];return Be(Be({},k),{},Gt({},T,O.scale))},{}):null}},{key:"getYScales",value:function(){var N=this.state.yAxisMap;return N?Object.entries(N).reduce(function(k,j){var E=IY(j,2),T=E[0],O=E[1];return Be(Be({},k),{},Gt({},T,O.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(N){var k;return(k=this.state.xAxisMap)===null||k===void 0||(k=k[N])===null||k===void 0?void 0:k.scale}},{key:"getYScaleByAxisId",value:function(N){var k;return(k=this.state.yAxisMap)===null||k===void 0||(k=k[N])===null||k===void 0?void 0:k.scale}},{key:"getItemByXY",value:function(N){var k=this.state,j=k.formattedGraphicalItems,E=k.activeItem;if(j&&j.length)for(var T=0,O=j.length;T<O;T++){var R=j[T],q=R.props,$=R.item,L=$.type.defaultProps!==void 0?Be(Be({},$.type.defaultProps),$.props):$.props,A=Yc($.type);if(A==="Bar"){var M=(q.data||[]).find(function(F){return bLe(N,F)});if(M)return{graphicalItem:R,payload:M}}else if(A==="RadialBar"){var z=(q.data||[]).find(function(F){return UG(N,F)});if(z)return{graphicalItem:R,payload:z}}else if(zj(R,E)||Bj(R,E)||Iy(R,E)){var I=FOe({graphicalItem:R,activeTooltipItem:E,itemData:L.data}),B=L.activeIndex===void 0?I:L.activeIndex;return{graphicalItem:Be(Be({},R),{},{childIndex:B}),payload:Iy(R,E)?L.data[I]:R.props.data[I]}}}return null}},{key:"render",value:function(){var N=this;if(!Zq(this))return null;var k=this.props,j=k.children,E=k.className,T=k.width,O=k.height,R=k.style,q=k.compact,$=k.title,L=k.desc,A=RY(k,b5e),M=Ut(A,!1);if(q)return le.createElement(gY,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},le.createElement(BO,jp({},M,{width:T,height:O,title:$,desc:L}),this.renderClipPath(),e7(j,this.renderMap)));if(this.props.accessibilityLayer){var z,I;M.tabIndex=(z=this.props.tabIndex)!==null&&z!==void 0?z:0,M.role=(I=this.props.role)!==null&&I!==void 0?I:"application",M.onKeyDown=function(F){N.accessibilityManager.keyboardEvent(F)},M.onFocus=function(){N.accessibilityManager.focus()}}var B=this.parseEventsOfWrapper();return le.createElement(gY,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},le.createElement("div",jp({className:ur("recharts-wrapper",E),style:Be({position:"relative",cursor:"default",width:T,height:O},R)},B,{ref:function(U){N.container=U}}),le.createElement(BO,jp({},M,{width:T,height:O,title:$,desc:L,style:I5e}),this.renderClipPath(),e7(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(w.Component);Gt(v,"displayName",r),Gt(v,"defaultProps",Be({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Gt(v,"getDerivedStateFromProps",function(y,S){var _=y.dataKey,N=y.data,k=y.children,j=y.width,E=y.height,T=y.layout,O=y.stackOffset,R=y.margin,q=S.dataStartIndex,$=S.dataEndIndex;if(S.updateId===void 0){var L=BY(y);return Be(Be(Be({},L),{},{updateId:0},p(Be(Be({props:y},L),{},{updateId:0}),S)),{},{prevDataKey:_,prevData:N,prevWidth:j,prevHeight:E,prevLayout:T,prevStackOffset:O,prevMargin:R,prevChildren:k})}if(_!==S.prevDataKey||N!==S.prevData||j!==S.prevWidth||E!==S.prevHeight||T!==S.prevLayout||O!==S.prevStackOffset||!Op(R,S.prevMargin)){var A=BY(y),M={chartX:S.chartX,chartY:S.chartY,isTooltipActive:S.isTooltipActive},z=Be(Be({},zY(S,N,T)),{},{updateId:S.updateId+1}),I=Be(Be(Be({},A),M),z);return Be(Be(Be({},I),p(Be({props:y},I),S)),{},{prevDataKey:_,prevData:N,prevWidth:j,prevHeight:E,prevLayout:T,prevStackOffset:O,prevMargin:R,prevChildren:k})}if(!PO(k,S.prevChildren)){var B,F,U,V,K=Ns(k,dg),G=K&&(B=(F=K.props)===null||F===void 0?void 0:F.startIndex)!==null&&B!==void 0?B:q,J=K&&(U=(V=K.props)===null||V===void 0?void 0:V.endIndex)!==null&&U!==void 0?U:$,ee=G!==q||J!==$,Y=!tr(N),ie=Y&&!ee?S.updateId:S.updateId+1;return Be(Be({updateId:ie},p(Be(Be({props:y},S),{},{updateId:ie,dataStartIndex:G,dataEndIndex:J}),S)),{},{prevChildren:k,dataStartIndex:G,dataEndIndex:J})}return null}),Gt(v,"renderActiveDot",function(y,S,_){var N;return w.isValidElement(y)?N=w.cloneElement(y,S):Jt(y)?N=y(S):N=le.createElement(Lj,S),le.createElement(Ir,{className:"recharts-active-dot",key:_},N)});var b=w.forwardRef(function(S,_){return le.createElement(v,jp({},S,{ref:_}))});return b.displayName=v.displayName,b},W5e=Yz({chartName:"LineChart",GraphicalChild:Qx,axisComponents:[{axisType:"xAxis",AxisComp:Qh},{axisType:"yAxis",AxisComp:Jh}],formatAxisMap:Dle}),hce=Yz({chartName:"BarChart",GraphicalChild:Hd,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Qh},{axisType:"yAxis",AxisComp:Jh}],formatAxisMap:Dle}),K5e=Yz({chartName:"PieChart",GraphicalChild:pu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Pj},{axisType:"radiusAxis",AxisComp:Ij}],formatAxisMap:M3e,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const G5e=["#3b82f6","#eab308","#ef4444","#22c55e","#8b5cf6","#06b6d4"];function V5e({active:e,payload:t}){if(!e||!t?.length)return null;const r=t[0].payload;return o.jsxs("div",{className:"bg-card p-2 rounded-lg shadow-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.value," items"]})]})}function FY(e,t,r){if(e.color)return e.color;if(r?.colorMap){const a=e.key||e.name.toLowerCase().replace(/\s+/g,"_");if(r.colorMap[a])return r.colorMap[a]}const n=r?.defaultColors||G5e;return n[t%n.length]}function xD({data:e,colors:t,title:r,testId:n="status-pie-chart",isLoading:a=!1,isError:i=!1,errorMessage:s="Failed to load chart data",emptyMessage:l="No data to display",height:c=192,innerRadius:u,outerRadius:d,showLabels:f=!0,isMobile:m=!1,isTouchDevice:p=!1,onLegendClick:v,className:b=""}){const[y,S]=w.useState(null),_=w.useCallback((O,R)=>{p&&S(y===R?null:R)},[p,y]),N=w.useCallback(O=>{if(v){const R=O.key||O.name.toLowerCase().replace(/\s+/g,"_");v(R)}},[v]),k=u??(m?30:35),j=d??(m?50:60);if(a)return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{className:"flex items-center justify-center",style:{height:c},children:o.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Loading chart..."})})]});if(i)return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{className:"flex items-center justify-center",style:{height:c},children:o.jsx("div",{className:"text-error text-sm",children:s})})]});if(e.reduce((O,R)=>O+R.value,0)===0||e.length===0)return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{className:"flex items-center justify-center",style:{height:c},children:o.jsx("div",{className:"text-muted-foreground text-sm",children:l})})]});const T=f&&!m;return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{style:{height:c},children:o.jsx(wj,{width:"100%",height:"100%",children:o.jsxs(K5e,{children:[o.jsx(pu,{data:e,cx:"50%",cy:"50%",innerRadius:k,outerRadius:j,dataKey:"value",labelLine:!1,label:T?({name:O,percent:R})=>`${O} ${((R??0)*100).toFixed(0)}%`:void 0,onClick:_,className:p?"cursor-pointer":"",children:e.map((O,R)=>o.jsx(Hx,{fill:FY(O,R,t),"data-testid":`chart-segment-${O.key||O.name.toLowerCase().replace(/\s+/g,"-")}`,stroke:y===R?"var(--color-foreground)":void 0,strokeWidth:y===R?2:0},`cell-${R}`))}),o.jsx(Cs,{content:o.jsx(V5e,{}),trigger:p?"click":"hover",wrapperStyle:{zIndex:1e3}})]})})}),m&&y!==null&&e[y]&&o.jsxs("div",{className:"mt-2 text-center text-sm text-foreground","data-testid":"mobile-tooltip",children:[o.jsx("span",{className:"font-medium",children:e[y].name}),o.jsxs("span",{className:"text-muted-foreground ml-2",children:[e[y].value," items"]})]}),o.jsx("div",{className:"mt-3 sm:mt-4 flex justify-center gap-2 sm:gap-4 flex-wrap","data-testid":"chart-legend",children:e.map((O,R)=>o.jsxs("button",{onClick:()=>N(O),className:`flex items-center gap-1 sm:gap-1.5 text-[10px] sm:text-xs text-muted-foreground hover:text-foreground transition-colors min-h-[28px] px-1 ${y===R?"text-foreground font-medium":""} ${v?"cursor-pointer":"cursor-default"}`,"data-testid":`legend-${O.key||O.name.toLowerCase().replace(/\s+/g,"-")}`,onTouchStart:()=>p&&S(R),disabled:!v,children:[o.jsx("span",{className:"w-2 h-2 sm:w-2.5 sm:h-2.5 rounded-full shrink-0",style:{backgroundColor:FY(O,R,t)}}),o.jsxs("span",{className:"truncate",children:[O.name,": ",O.value]})]},O.key||O.name))})]})}const Y5e="var(--color-success, #22c55e)";function Q5e({active:e,payload:t,label:r}){return!e||!t?.length?null:o.jsxs("div",{className:"bg-card p-2 rounded-lg shadow-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:r}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[t[0].value," completed"]})]})}function J5e({data:e,title:t,lineColor:r=Y5e,showGrid:n=!0,showDots:a=!0,total:i,testId:s="trend-line-chart",isLoading:l=!1,isError:c=!1,errorMessage:u="Failed to load chart data",emptyMessage:d="No data to display",height:f=192,isMobile:m=!1,isTouchDevice:p=!1,className:v=""}){return l?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:f},children:o.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Loading chart..."})})]}):c?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:f},children:o.jsx("div",{className:"text-error text-sm",children:u})})]}):e.length===0?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:f},children:o.jsx("div",{className:"text-muted-foreground text-sm",children:d})})]}):o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":s,children:[t&&o.jsxs("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:[o.jsx("span",{className:"hidden sm:inline",children:t}),o.jsx("span",{className:"sm:hidden",children:t.length>20?`${t.slice(0,20)}...`:t}),i!==void 0&&i>0&&o.jsxs("span",{className:"ml-1 sm:ml-2 text-[10px] sm:text-xs font-normal text-muted-foreground",children:["Total: ",i]})]}),o.jsx("div",{style:{height:f},children:o.jsx(wj,{width:"100%",height:"100%",children:o.jsxs(W5e,{data:e,children:[n&&o.jsx(Vz,{strokeDasharray:"3 3",stroke:"var(--color-border, #e5e7eb)"}),o.jsx(Qh,{dataKey:"label",tick:{fontSize:m?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"},interval:m?1:0}),o.jsx(Jh,{allowDecimals:!1,tick:{fontSize:m?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"},width:m?25:30}),o.jsx(Cs,{content:o.jsx(Q5e,{}),trigger:p?"click":"hover",wrapperStyle:{zIndex:1e3}}),o.jsx(Qx,{type:"monotone",dataKey:"value",stroke:r,strokeWidth:2,dot:a?{fill:r,strokeWidth:0,r:m?4:3}:!1,activeDot:{r:m?6:5,fill:r}})]})})})]})}const Z5e="var(--color-primary, #3b82f6)";function X5e({active:e,payload:t}){if(!e||!t?.length)return null;const r=t[0].payload;return o.jsxs("div",{className:"bg-card p-2 rounded-lg shadow-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.value," item",r.value!==1?"s":"",r.percentage!==void 0&&` (${r.percentage}%)`]}),r.id&&o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Click to view details"})]})}function UY({data:e,title:t,barColor:r=Z5e,onBarClick:n,maxBars:a=10,testId:i="horizontal-bar-chart",isLoading:s=!1,isError:l=!1,errorMessage:c="Failed to load chart data",emptyMessage:u="No data to display",height:d=192,isMobile:f=!1,isTouchDevice:m=!1,className:p=""}){const[v,b]=w.useState(null),y=e.slice(0,a).map(_=>({..._,displayName:f&&_.name.length>8?`${_.name.slice(0,8)}...`:_.name})),S=w.useCallback((_,N)=>{m?v===N?n?.(_):b(N):n?.(_)},[n,m,v]);return s?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:d},children:o.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Loading chart..."})})]}):l?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:d},children:o.jsx("div",{className:"text-error text-sm",children:c})})]}):e.length===0?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:d},children:o.jsx("div",{className:"text-muted-foreground text-sm",children:u})})]}):o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{style:{height:d},children:o.jsx(wj,{width:"100%",height:"100%",children:o.jsxs(hce,{data:y,layout:"vertical",children:[o.jsx(Vz,{strokeDasharray:"3 3",stroke:"var(--color-border, #e5e7eb)"}),o.jsx(Qh,{type:"number",allowDecimals:!1,tick:{fontSize:f?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"}}),o.jsx(Jh,{type:"category",dataKey:"displayName",tick:{fontSize:f?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"},width:f?55:70}),o.jsx(Cs,{content:o.jsx(X5e,{}),trigger:m?"click":"hover",wrapperStyle:{zIndex:1e3}}),o.jsx(Hd,{dataKey:"value",fill:r,radius:[0,4,4,0],className:n?"cursor-pointer":"",onClick:(_,N)=>S(_,N)})]})})}),f&&v!==null&&e[v]&&o.jsxs("div",{className:"mt-2 text-center text-sm","data-testid":"mobile-tooltip-bar",children:[o.jsx("span",{className:"font-medium text-foreground",children:e[v].name}),o.jsxs("span",{className:"text-muted-foreground ml-2",children:[e[v].value," items"]}),n&&o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Tap again to view details"})]})]})}class e6e{constructor(t){xt(this,"socket",null);xt(this,"url");xt(this,"channels",new Set);xt(this,"eventListeners",new Set);xt(this,"stateListeners",new Set);xt(this,"state","disconnected");xt(this,"reconnectDelay");xt(this,"maxReconnectDelay");xt(this,"currentReconnectDelay");xt(this,"reconnectTimer",null);xt(this,"pingInterval");xt(this,"pingTimer",null);xt(this,"debug");if(this.url=t.url,this.reconnectDelay=t.reconnectDelay??1e3,this.maxReconnectDelay=t.maxReconnectDelay??3e4,this.currentReconnectDelay=this.reconnectDelay,this.pingInterval=t.pingInterval??3e4,this.debug=t.debug??!1,t.channels)for(const r of t.channels)this.channels.add(r)}log(...t){this.debug&&console.log("[ws]",...t)}get connectionState(){return this.state}get isConnected(){return this.state==="connected"}get subscribedChannels(){return[...this.channels]}connect(){if(!(this.socket&&(this.socket.readyState===WebSocket.OPEN||this.socket.readyState===WebSocket.CONNECTING))){this.setState("connecting");try{this.socket=new WebSocket(this.url),this.socket.onopen=()=>{this.log("Connected to server"),this.setState("connected"),this.currentReconnectDelay=this.reconnectDelay,this.channels.size>0&&this.sendSubscribe([...this.channels]),this.startPingTimer()},this.socket.onmessage=t=>{this.handleMessage(t.data)},this.socket.onclose=t=>{this.log(`Connection closed: ${t.code} ${t.reason}`),this.handleDisconnect()},this.socket.onerror=t=>{console.error("[ws] Connection error:",t)}}catch(t){console.error("[ws] Failed to create WebSocket:",t),this.handleDisconnect()}}}disconnect(){this.stopPingTimer(),this.cancelReconnect(),this.socket&&(this.socket.close(1e3,"Client disconnect"),this.socket=null),this.setState("disconnected")}subscribe(t){const r=Array.isArray(t)?t:[t];for(const n of r)this.channels.add(n);this.isConnected&&this.sendSubscribe(r)}unsubscribe(t){const r=Array.isArray(t)?t:[t];for(const n of r)this.channels.delete(n);this.isConnected&&this.send({type:"unsubscribe",channels:r})}addEventListener(t){return this.eventListeners.add(t),()=>this.eventListeners.delete(t)}addStateListener(t){return this.stateListeners.add(t),t(this.state),()=>this.stateListeners.delete(t)}sendMessage(t){return this.send(t)}send(t){return this.socket&&this.socket.readyState===WebSocket.OPEN?(this.socket.send(JSON.stringify(t)),!0):!1}sendSubscribe(t){this.send({type:"subscribe",channels:t})}handleMessage(t){try{const r=JSON.parse(t);switch(r.type){case"event":this.dispatchEvent(r.event);break;case"pong":break;case"subscribed":this.log("Subscribed to:",r.channels.join(", "));break;case"unsubscribed":this.log("Unsubscribed from:",r.channels.join(", "));break;case"error":console.error("[ws] Server error:",r.code,r.message);break}}catch(r){console.error("[ws] Failed to parse message:",r)}}dispatchEvent(t){for(const r of this.eventListeners)try{r(t)}catch(n){console.error("[ws] Error in event listener:",n)}}setState(t){if(this.state!==t){this.state=t;for(const r of this.stateListeners)try{r(t)}catch(n){console.error("[ws] Error in state listener:",n)}}}handleDisconnect(){this.stopPingTimer(),this.socket=null,this.setState("reconnecting"),this.scheduleReconnect()}scheduleReconnect(){this.reconnectTimer||(this.log(`Reconnecting in ${this.currentReconnectDelay}ms...`),this.reconnectTimer=setTimeout(()=>{this.reconnectTimer=null,this.connect(),this.currentReconnectDelay=Math.min(this.currentReconnectDelay*2,this.maxReconnectDelay)},this.currentReconnectDelay))}cancelReconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}startPingTimer(){this.stopPingTimer(),this.pingTimer=setInterval(()=>{this.send({type:"ping"})},this.pingInterval)}stopPingTimer(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null)}}function t6e(e){const{url:t,channels:r,onEvent:n,onStateChange:a,autoConnect:i=!0,...s}=e,[l,c]=w.useState("disconnected"),[u,d]=w.useState(null),f=w.useRef(null);w.useEffect(()=>{const _=new e6e({url:t,channels:r,...s});f.current=_;const N=_.addStateListener(j=>{c(j),a?.(j)}),k=_.addEventListener(j=>{d(j),n?.(j)});return i&&_.connect(),()=>{N(),k(),_.disconnect(),f.current=null}},[t]),w.useEffect(()=>{const _=f.current;return _?_.addEventListener(k=>{d(k),n?.(k)}):void 0},[n]),w.useEffect(()=>{const _=f.current;return _?_.addStateListener(k=>{c(k),a?.(k)}):void 0},[a]);const m=w.useCallback(()=>{f.current?.connect()},[]),p=w.useCallback(()=>{f.current?.disconnect()},[]),v=w.useCallback(_=>{f.current?.subscribe(_)},[]),b=w.useCallback(_=>{f.current?.unsubscribe(_)},[]),y=w.useCallback(_=>f.current?.sendMessage(_)??!1,[]),S=f.current?.subscribedChannels??[];return{connectionState:l,isConnected:l==="connected",lastEvent:u,connect:m,disconnect:p,subscribe:v,unsubscribe:b,sendMessage:y,subscribedChannels:S}}function mce(e){const t=[],{elementType:r,elementId:n,newValue:a}=e;switch(r){case"task":t.push(["tasks"]),t.push(["tasks",n]),t.push(["tasks","ready"]),t.push(["tasks","blocked"]),t.push(["tasks","completed"]),t.push(["stats"]);break;case"plan":t.push(["plans"]),t.push(["plans",n]),t.push(["stats"]);break;case"workflow":t.push(["workflows"]),t.push(["workflows",n]),t.push(["stats"]);break;case"entity":t.push(["entities"]),t.push(["entities",n]),t.push(["agents"]),t.push(["stats"]);break;case"document":t.push(["documents"]),t.push(["documents",n]),t.push(["stats"]);break;case"channel":t.push(["channels"]),t.push(["channels",n]),t.push(["stats"]);break;case"message":t.push(["messages"]),t.push(["messages",n]),a?.channelId&&t.push(["channels",String(a.channelId),"messages"]),a?.channel&&t.push(["channels",String(a.channel),"messages"]),a?.threadId&&t.push(["messages",String(a.threadId),"replies"]);break;case"team":t.push(["teams"]),t.push(["teams",n]),t.push(["stats"]);break;case"inbox-item":if(a?.recipientId){const i=String(a.recipientId);t.push(["inbox",i,"unread"]),t.push(["inbox",i,"all"]),t.push(["inbox",i,"archived"]),t.push(["inbox",i,"count"]),t.push(["inbox",i]),t.push(["entities",i,"inbox"]),t.push(["entities",i,"inbox","count"]),t.push(["agent-inbox",i,"unread"]),t.push(["agent-inbox",i,"all"]),t.push(["agent-inbox",i,"archived"]),t.push(["agent-inbox",i]),t.push(["agent-inbox-count",i])}t.push(["inbox"]);break;case"session":t.push(["sessions"]),t.push(["sessions",n]),a?.agentId&&t.push(["agents",String(a.agentId),"sessions"]);break;case"worktree":t.push(["worktrees"]),t.push(["worktrees",n]);break;default:t.push(["stats"])}return t}function r6e(e){const{queryClient:t,getQueryKeysForEvent:r=mce,onEvent:n,onStateChange:a,autoInvalidate:i=!0,...s}=e,[l,c]=w.useState(null),u=w.useCallback(m=>{if(c(m),i&&t){const p=r(m);for(const v of p)t.invalidateQueries({queryKey:v})}n?.(m)},[i,t,r,n]),{connectionState:d,isConnected:f}=t6e({...s,onEvent:u,onStateChange:a});return{connectionState:d,isConnected:f,lastEvent:l}}const Qz="settings.customShortcuts",iR="stoneforge:shortcuts-changed";function HY(e){if(e.includes("+")){const r=e.toLowerCase().split("+");return{type:"modifier",key:r[r.length-1],meta:r.includes("cmd")||r.includes("meta"),ctrl:r.includes("ctrl"),alt:r.includes("alt"),shift:r.includes("shift")}}return{type:"sequential",sequence:e.toLowerCase().split(" ").filter(Boolean)}}class n6e{constructor(){xt(this,"shortcuts",new Map);xt(this,"sequentialShortcuts",new Map);xt(this,"modifierShortcuts",new Map);xt(this,"pendingKeys",[]);xt(this,"sequenceTimeout",null);xt(this,"SEQUENCE_TIMEOUT",1e3);xt(this,"enabled",!0);xt(this,"started",!1);this.handleKeyDown=this.handleKeyDown.bind(this)}register(t,r,n){const a={keys:t,handler:r,description:n};this.shortcuts.set(t,a);const i=HY(t);if(i.type==="modifier"){const s=this.buildModifierKey(i);this.modifierShortcuts.set(s,a)}else if(i.sequence){const s=i.sequence.join(" ");this.sequentialShortcuts.set(s,a)}}unregister(t){if(!this.shortcuts.get(t))return;this.shortcuts.delete(t);const n=HY(t);if(n.type==="modifier"){const a=this.buildModifierKey(n);this.modifierShortcuts.delete(a)}else if(n.sequence){const a=n.sequence.join(" ");this.sequentialShortcuts.delete(a)}}buildModifierKey(t){const r=[];return t.meta&&r.push("meta"),t.ctrl&&r.push("ctrl"),t.alt&&r.push("alt"),t.shift&&r.push("shift"),r.push(t.key||""),r.join("+")}setEnabled(t){this.enabled=t,t||this.resetSequence()}isEnabled(){return this.enabled}isStarted(){return this.started}resetSequence(){this.pendingKeys=[],this.sequenceTimeout&&(clearTimeout(this.sequenceTimeout),this.sequenceTimeout=null)}handleKeyDown(t){if(!this.enabled)return;const r=t.target,n=r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable;if(t.metaKey||t.ctrlKey){const c=this.buildModifierKey({type:"modifier",key:t.key.toLowerCase(),meta:t.metaKey,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey}),u=this.modifierShortcuts.get(c);if(u){t.preventDefault(),u.handler();return}}if(n){this.resetSequence();return}const a=t.key.toLowerCase();if(["meta","control","alt","shift"].includes(a))return;this.sequenceTimeout&&clearTimeout(this.sequenceTimeout),this.pendingKeys.push(a);const i=this.pendingKeys.join(" "),s=this.sequentialShortcuts.get(i);if(s){t.preventDefault(),this.resetSequence(),s.handler();return}Array.from(this.sequentialShortcuts.keys()).some(c=>c.startsWith(i+" "))?(t.preventDefault(),this.sequenceTimeout=setTimeout(()=>{this.resetSequence()},this.SEQUENCE_TIMEOUT)):this.resetSequence()}start(){this.started||(document.addEventListener("keydown",this.handleKeyDown),this.started=!0)}stop(){document.removeEventListener("keydown",this.handleKeyDown),this.resetSequence(),this.started=!1}getShortcuts(){return Array.from(this.shortcuts.values())}clear(){this.shortcuts.clear(),this.sequentialShortcuts.clear(),this.modifierShortcuts.clear(),this.resetSequence()}}let wD=null;function zp(){return wD||(wD=new n6e),wD}function Uy(){if(typeof window>"u")return{};try{const e=localStorage.getItem(Qz);return e?JSON.parse(e):{}}catch{return{}}}function a6e(e){typeof window>"u"||(localStorage.setItem(Qz,JSON.stringify(e)),pce())}function Jz(e,t){const r=Uy();return r[e]?r[e]:t[e]?.keys||""}function i6e(e,t,r){const n=Uy(),a=e.toLowerCase().trim();for(const[i,s]of Object.entries(t)){if(i===r)continue;if((n[i]||s.keys).toLowerCase().trim()===a)return i}return null}function s6e(e,t,r){const n=Uy();t===r[e]?.keys?delete n[e]:n[e]=t,a6e(n)}function o6e(){typeof window>"u"||(localStorage.removeItem(Qz),pce())}function pce(){typeof window<"u"&&window.dispatchEvent(new CustomEvent(iR))}function Jx(){const[e,t]=w.useState(0);return w.useEffect(()=>{const r=()=>{t(n=>n+1)};return window.addEventListener(iR,r),()=>{window.removeEventListener(iR,r)}},[]),e}function l6e(e,t,r){w.useEffect(()=>{const n=zp();return n.register(e,t,r),n.isStarted()||n.start(),()=>{n.unregister(e)}},[e,t,r])}function c6e(e){w.useEffect(()=>{const t=zp();return e?t.setEnabled(!1):t.setEnabled(!0),()=>{t.setEnabled(!0)}},[e])}const Hy={draft:{label:"Draft",icon:le.createElement(T6,{className:"w-4 h-4"}),color:"text-gray-600",bgColor:"bg-gray-100"},active:{label:"Active",icon:le.createElement(ay,{className:"w-4 h-4"}),color:"text-blue-700",bgColor:"bg-blue-100"},completed:{label:"Completed",icon:le.createElement(Yn,{className:"w-4 h-4"}),color:"text-green-700",bgColor:"bg-green-100"},cancelled:{label:"Cancelled",icon:le.createElement(oi,{className:"w-4 h-4"}),color:"text-red-700",bgColor:"bg-red-100"}},SD={draft:"#9ca3af",active:"#3b82f6",completed:"#22c55e",cancelled:"#ef4444"},gce={1:"bg-gray-200",2:"bg-blue-200",3:"bg-yellow-200",4:"bg-orange-200",5:"bg-red-200"},sR="plans.search",vce="plans.viewMode",u6e=300;function d6e(){return typeof window>"u"?"":localStorage.getItem(sR)||""}function f6e(e){typeof window>"u"||(e?localStorage.setItem(sR,e):localStorage.removeItem(sR))}function h6e(){return typeof window>"u"?"list":localStorage.getItem(vce)==="roadmap"?"roadmap":"list"}function m6e(e){typeof window>"u"||localStorage.setItem(vce,e)}function qY(e,t){if(!t)return{matched:!0,indices:[]};const r=e.toLowerCase(),n=t.toLowerCase(),a=[];let i=0;for(let s=0;s<r.length&&i<n.length;s++)r[s]===n[i]&&(a.push(s),i++);return i===n.length?{matched:!0,indices:a}:null}function p6e(e,t){if(t.length===0)return le.createElement(le.Fragment,null,e);const r=[],n=new Set(t);let a=0;for(let i=0;i<e.length;i++)n.has(i)&&(i>a&&r.push(le.createElement("span",{key:`text-${a}`},e.slice(a,i))),r.push(le.createElement("mark",{key:`match-${i}`,className:"bg-yellow-200 dark:bg-yellow-700/50 text-gray-900 dark:text-yellow-100 rounded-sm px-0.5"},e[i])),a=i+1);return a<e.length&&r.push(le.createElement("span",{key:`text-${a}`},e.slice(a))),le.createElement(le.Fragment,null,...r)}function Ep(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function oR(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:Ep(e)}function g6e(e){return gt({queryKey:["plans",e,"with-progress"],queryFn:async()=>{const t=new URLSearchParams;t.set("hydrate.progress","true"),e&&t.set("status",e);const r=await fetch(`/api/plans?${t.toString()}`);if(!r.ok)throw new Error("Failed to fetch plans");return r.json()}})}function v6e(e){return gt({queryKey:["plans",e],queryFn:async()=>{if(!e)throw new Error("No plan selected");const t=await fetch(`/api/plans/${e}?hydrate.progress=true`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch plan")}return t.json()},enabled:!!e})}function b6e(e){return gt({queryKey:["plans",e,"tasks"],queryFn:async()=>{if(!e)throw new Error("No plan selected");const t=await fetch(`/api/plans/${e}/tasks`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch plan tasks")}return t.json()},enabled:!!e})}function y6e(e){return gt({queryKey:["plans",e,"progress"],queryFn:async()=>{if(!e)throw new Error("No plan selected");const t=await fetch(`/api/plans/${e}/progress`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch plan progress")}return t.json()},enabled:!!e})}function x6e(){const e=ht();return Ct({mutationFn:async({planId:t,updates:r})=>{const n=await fetch(`/api/plans/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to update plan")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["plans"]}),e.invalidateQueries({queryKey:["plans",r.planId]})}})}function w6e(){const e=ht();return Ct({mutationFn:async({planId:t,taskId:r})=>{const n=await fetch(`/api/plans/${t}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to add task to plan")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["plans",r.planId,"tasks"]}),e.invalidateQueries({queryKey:["plans",r.planId,"progress"]}),e.invalidateQueries({queryKey:["plans",r.planId]})}})}function S6e(){const e=ht();return Ct({mutationFn:async({planId:t,taskId:r})=>{const n=await fetch(`/api/plans/${t}/tasks/${r}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to remove task from plan")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["plans",r.planId,"tasks"]}),e.invalidateQueries({queryKey:["plans",r.planId,"progress"]}),e.invalidateQueries({queryKey:["plans",r.planId]})}})}function k6e(e,t){return gt({queryKey:["tasks","available",e,t],queryFn:async()=>{if(!e)return[];const r=await fetch("/api/tasks?limit=500");if(!r.ok)throw new Error("Failed to fetch tasks");const n=await r.json(),a=n.tasks||n.items||(Array.isArray(n)?n:[]),i=await fetch(`/api/plans/${e}/tasks`);if(!i.ok)throw new Error("Failed to fetch plan tasks");const s=await i.json(),l=new Set(s.map(u=>u.id));let c=a.filter(u=>!l.has(u.id));if(t){const u=t.toLowerCase();c=c.filter(d=>d.title.toLowerCase().includes(u)||d.id.toLowerCase().includes(u))}return c.slice(0,50)},enabled:!!e})}function _6e(){const e=ht();return Ct({mutationFn:async t=>{const r=await fetch(`/api/plans/${t}`,{method:"DELETE"});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to delete plan")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["plans"]})}})}function N6e(){const e=ht();return Ct({mutationFn:async({title:t,createdBy:r,initialTask:n,initialTaskId:a,additionalTasks:i,status:s,tags:l})=>{const c=await fetch("/api/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,createdBy:r,initialTask:n,initialTaskId:a,status:s,tags:l})});if(!c.ok){const d=await c.json();throw new Error(d.error?.message||"Failed to create plan")}const u=await c.json();if(i&&i.length>0)try{const d=i.map(async f=>{if("existingTaskId"in f){const m=await fetch(`/api/plans/${u.id}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:f.existingTaskId})});if(!m.ok){const p=await m.json().catch(()=>({}));throw console.error("Failed to add existing task to plan:",p),new Error(p.error?.message||"Failed to add task to plan")}}else{const m=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:f.title,priority:f.priority||3,createdBy:r})});if(!m.ok){const y=await m.json().catch(()=>({}));throw console.error("Failed to create task:",y),new Error(y.error?.message||"Failed to create task")}const p=await m.json(),v=p.task||p,b=await fetch(`/api/plans/${u.id}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:v.id})});if(!b.ok){const y=await b.json().catch(()=>({}));throw console.error("Failed to add new task to plan:",y),new Error(y.error?.message||"Failed to add task to plan")}}});await Promise.all(d)}catch(d){console.error("Rolling back plan creation due to task error:",d);try{await fetch(`/api/plans/${u.id}`,{method:"DELETE"})}catch(f){console.error("Failed to rollback plan:",f)}throw d}return u},onSuccess:()=>{e.invalidateQueries({queryKey:["plans"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function bce({status:e}){const t=Hy[e]||Hy.draft;return o.jsxs("span",{"data-testid":`status-badge-${e}`,className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${t.bgColor} ${t.color}`,children:[t.icon,t.label]})}const C6e=[{value:null,label:"All"},{value:"active",label:"Active"},{value:"draft",label:"Draft"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}];function j6e({selectedStatus:e,onStatusChange:t}){return o.jsx("div",{"data-testid":"status-filter",className:"flex gap-1 p-1 bg-gray-100 rounded-lg",children:C6e.map(r=>o.jsx("button",{"data-testid":`status-filter-${r.value??"all"}`,onClick:()=>t(r.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${e===r.value?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:r.label},r.value??"all"))})}function E6e({view:e,onViewChange:t}){return o.jsxs("div",{"data-testid":"view-toggle",className:"flex p-0.5 bg-gray-100 rounded-lg",children:[o.jsxs("button",{"data-testid":"view-toggle-list",onClick:()=>t("list"),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${e==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,"aria-label":"List view",children:[o.jsx(Wp,{className:"w-4 h-4"}),"List"]}),o.jsxs("button",{"data-testid":"view-toggle-roadmap",onClick:()=>t("roadmap"),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${e==="roadmap"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,"aria-label":"Roadmap view",children:[o.jsx(Oae,{className:"w-4 h-4"}),"Roadmap"]})]})}function M6e({value:e,onChange:t,onClear:r}){const n=w.useRef(null);return w.useEffect(()=>{const a=i=>{i.key==="Escape"&&document.activeElement===n.current&&(i.preventDefault(),r(),n.current?.blur()),i.key==="/"&&!(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement)&&(i.preventDefault(),n.current?.focus())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[r]),o.jsxs("div",{className:"relative flex-1 max-w-md","data-testid":"plan-search-container",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"}),o.jsx("input",{ref:n,type:"text",name:"plan-search",value:e,onChange:a=>t(a.target.value),placeholder:"Search plans... (Press / to focus)",className:"w-full pl-10 pr-8 py-1.5 text-sm border border-[var(--color-border)] dark:border-[var(--color-card-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors","data-testid":"plan-search-input"}),e&&o.jsx("button",{onClick:r,className:"absolute inset-y-0 right-0 pr-2 flex items-center text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]","data-testid":"plan-search-clear","aria-label":"Clear search (Escape)",children:o.jsx(wt,{className:"w-4 h-4"})})]})}function T6e({plan:e,isSelected:t,onClick:r,searchMatchIndices:n,progressRing:a}){const i=e._progress,s=i&&i.totalTasks>0,l=n&&n.length>0?p6e(e.title,n):e.title;return o.jsx("div",{"data-testid":`plan-item-${e.id}`,className:`p-4 rounded-lg border cursor-pointer transition-colors ${t?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700":"bg-white dark:bg-[var(--color-surface)] border-gray-200 dark:border-[var(--color-border)] hover:border-gray-300 dark:hover:border-[var(--color-border-hover)] hover:bg-gray-50 dark:hover:bg-[var(--color-surface-hover)]"}`,onClick:()=>r(e.id),children:o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsx("h3",{"data-testid":"plan-item-title",className:"font-medium text-gray-900 dark:text-[var(--color-text)] truncate flex-1",children:l})}),o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(bce,{status:e.status}),o.jsxs("span",{className:"text-xs text-gray-500 dark:text-[var(--color-text-tertiary)]",title:Ep(e.updatedAt),children:["Updated ",oR(e.updatedAt)]})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(c=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-[var(--color-surface-hover)] text-gray-600 dark:text-[var(--color-text-secondary)] rounded",children:c},c)),e.tags.length>3&&o.jsxs("span",{className:"text-xs text-gray-400 dark:text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a||(s?o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-blue-500 flex items-center justify-center",title:`${i.completionPercentage}% complete`,"data-testid":`plan-progress-${e.id}`,children:o.jsxs("span",{className:"text-[10px] text-blue-500 font-medium",children:[i.completionPercentage,"%"]})}):o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-gray-200 dark:border-gray-600 flex items-center justify-center",title:"No tasks in plan","data-testid":`plan-progress-empty-${e.id}`,children:o.jsx("span",{className:"text-[8px] text-gray-400 dark:text-gray-500",children:"--"})})),o.jsx(gn,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})]})]})})}function A6e({tasks:e,isEditMode:t=!1,onRemoveTask:r,removingTaskId:n,onRemoveNotAllowed:a,taskLinkBase:i="/tasks"}){const[s,l]=w.useState(null);if(e.length===0)return o.jsx("div",{"data-testid":"plan-tasks-empty",className:"text-center py-8 text-gray-500 text-sm",children:"No tasks in this plan"});const c=e.length===1,u=d=>{if(c){a?.();return}s===d?(r?.(d),l(null)):l(d)};return o.jsxs("div",{"data-testid":"plan-tasks-list",className:"space-y-2",children:[c&&t&&o.jsxs("div",{"data-testid":"last-task-warning",className:"flex items-center gap-2 p-2 mb-2 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{children:"This is the only task. Plans must have at least one task."})]}),e.map(d=>o.jsxs("div",{"data-testid":`plan-task-${d.id}`,className:`flex items-center gap-3 p-2 bg-gray-50 rounded-lg group ${s===d.id?"bg-red-50 border border-red-200":""}`,children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${gce[d.priority]||"bg-gray-200"}`,title:`Priority ${d.priority}`}),o.jsx("a",{href:`${i}?selected=${d.id}`,className:"flex-1 text-sm text-gray-900 truncate hover:text-blue-600 hover:underline",onClick:f=>f.stopPropagation(),children:d.title}),o.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${d.status==="closed"?"bg-green-100 text-green-700":d.status==="blocked"?"bg-red-100 text-red-700":d.status==="in_progress"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:d.status.replace("_"," ")}),t&&r&&o.jsx("button",{"data-testid":`remove-task-${d.id}`,onClick:()=>u(d.id),disabled:n===d.id||c,className:`p-1 rounded transition-colors ${c?"text-gray-300 cursor-not-allowed opacity-50":s===d.id?"bg-red-500 text-white hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50 opacity-0 group-hover:opacity-100"} ${n===d.id?"opacity-50 cursor-not-allowed":""}`,title:c?"Cannot remove - plans must have at least one task":s===d.id?"Click again to confirm removal":"Remove from plan",children:n===d.id?o.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):o.jsx(Sr,{className:"w-4 h-4"})})]},d.id))]})}function D6e({progress:e}){const t=[{label:"Completed",count:e.completedTasks,icon:o.jsx(Yn,{className:"w-4 h-4 text-green-500"})},{label:"In Progress",count:e.inProgressTasks,icon:o.jsx(ay,{className:"w-4 h-4 text-blue-500"})},{label:"Blocked",count:e.blockedTasks,icon:o.jsx(Bt,{className:"w-4 h-4 text-red-500"})},{label:"Remaining",count:e.remainingTasks,icon:o.jsx(A6,{className:"w-4 h-4 text-gray-400"})}];return o.jsx("div",{"data-testid":"task-status-summary",className:"grid grid-cols-2 gap-3",children:t.map(r=>o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[r.icon,o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900",children:r.count}),o.jsx("div",{className:"text-xs text-gray-500",children:r.label})]})]},r.label))})}function L6e({planId:e,onClose:t,onAddTask:r,isAdding:n}){const[a,i]=w.useState(""),[s,l]=w.useState(""),c=w.useRef(void 0);w.useEffect(()=>(c.current=setTimeout(()=>{l(a)},300),()=>{c.current&&clearTimeout(c.current)}),[a]);const{data:u=[],isLoading:d}=k6e(e,s);return o.jsx("div",{"data-testid":"task-picker-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:f=>f.target===f.currentTarget&&t(),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[80vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Task to Plan"}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","data-testid":"task-picker-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text","data-testid":"task-picker-search",placeholder:"Search tasks by title or ID...",value:a,onChange:f=>i(f.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading tasks..."}):u.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:a?"No matching tasks found":"All tasks are already in this plan"}):o.jsx("div",{className:"space-y-2",children:u.map(f=>o.jsxs("button",{"data-testid":`task-picker-item-${f.id}`,onClick:()=>r(f.id),disabled:n,className:"w-full flex items-center gap-3 p-3 bg-gray-50 hover:bg-blue-50 rounded-lg text-left transition-colors disabled:opacity-50",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${gce[f.priority]||"bg-gray-200"}`,title:`Priority ${f.priority}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:f.title}),o.jsx("div",{className:"text-xs text-gray-500 font-mono",children:f.id})]}),o.jsx("span",{className:`text-xs px-2 py-0.5 rounded flex-shrink-0 ${f.status==="closed"?"bg-green-100 text-green-700":f.status==="blocked"?"bg-red-100 text-red-700":f.status==="in_progress"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:f.status.replace("_"," ")}),o.jsx(_r,{className:"w-4 h-4 text-blue-500 flex-shrink-0"})]},f.id))})})]})})}function O6e({active:e,payload:t}){if(!e||!t?.length)return null;const r=t[0].payload,n=Hy[r.status]||Hy.draft;return o.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-gray-200 max-w-xs","data-testid":"roadmap-tooltip",children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1 truncate",children:r.title}),o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${n.bgColor} ${n.color}`,children:[n.icon,n.label]}),o.jsxs("span",{className:"text-xs text-gray-500",children:[r.completionPercentage,"% complete"]})]}),o.jsxs("div",{className:"text-xs text-gray-500",children:[o.jsxs("div",{children:["Start: ",r.startDate.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),o.jsxs("div",{children:["End: ",r.endDate.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),o.jsxs("div",{children:["Duration: ",r.duration," days"]})]})]})}function I6e({plans:e,onPlanClick:t,selectedPlanId:r}){const{timelineStart:n,timelineEnd:a,chartData:i,tickValues:s,tickFormatter:l}=w.useMemo(()=>{if(e.length===0){const k=new Date,j=new Date(k);j.setDate(j.getDate()-7);const E=new Date(k);return E.setDate(E.getDate()+30),{timelineStart:j,timelineEnd:E,chartData:[],tickValues:[],tickFormatter:T=>""}}let f=new Date,m=new Date,p=!1;e.forEach(k=>{const j=new Date(k.createdAt),E=new Date(k.updatedAt),T=k.completedAt?new Date(k.completedAt):null,O=k.cancelledAt?new Date(k.cancelledAt):null,R=j,q=T||O||E;p?(R<f&&(f=new Date(R)),q>m&&(m=new Date(q))):(f=new Date(R),m=new Date(q),p=!0)});const v=new Date(f);v.setDate(v.getDate()-7);const b=new Date(m);b.setDate(b.getDate()+14);const y=Math.ceil((b.getTime()-v.getTime())/(1e3*60*60*24)),S=e.map(k=>{const j=new Date(k.createdAt),E=new Date(k.updatedAt),T=k.completedAt?new Date(k.completedAt):null,O=k.cancelledAt?new Date(k.cancelledAt):null,R=j,q=T||O||E,$=Math.ceil((R.getTime()-v.getTime())/(1e3*60*60*24)),L=Math.max(1,Math.ceil((q.getTime()-R.getTime())/(1e3*60*60*24)));return{planId:k.id,title:k.title,status:k.status,startDate:R,endDate:q,startOffset:$,duration:L,completionPercentage:k._progress?.completionPercentage??0}}),_=[];for(let k=0;k<=y;k+=7)_.push(k);return{timelineStart:v,timelineEnd:b,chartData:S,tickValues:_,tickFormatter:k=>{const j=new Date(v);return j.setDate(j.getDate()+k),j.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}},[e]),c=Math.ceil((a.getTime()-n.getTime())/(1e3*60*60*24));if(e.length===0)return o.jsxs("div",{"data-testid":"roadmap-empty",className:"flex flex-col items-center justify-center h-full py-12 text-center",children:[o.jsx(Oae,{className:"w-12 h-12 text-gray-300 mb-3"}),o.jsx("p",{className:"text-gray-500",children:"No plans to display in roadmap"}),o.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create plans to see them on the timeline"})]});const d=Math.max(200,i.length*48+60);return o.jsxs("div",{"data-testid":"roadmap-view",className:"h-full flex flex-col bg-white rounded-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:[n.toLocaleDateString("en-US",{month:"long",year:"numeric"})," "," ",a.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),o.jsxs("div",{className:"text-xs text-gray-500",children:[e.length," plan",e.length!==1?"s":""]})]})}),o.jsx("div",{className:"flex-1 overflow-auto p-4","data-testid":"roadmap-chart-container",children:o.jsx("div",{style:{height:d,minWidth:Math.max(600,c*8)},children:o.jsx(wj,{width:"100%",height:"100%",children:o.jsxs(hce,{data:i,layout:"vertical",barCategoryGap:8,margin:{top:20,right:30,left:200,bottom:20},children:[o.jsx(Qh,{type:"number",dataKey:"startOffset",domain:[0,c],ticks:s,tickFormatter:l,axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"},tick:{fontSize:11,fill:"#6b7280"}}),o.jsx(Jh,{type:"category",dataKey:"title",width:190,axisLine:{stroke:"#e5e7eb"},tickLine:!1,tick:({x:f,y:m,payload:p})=>o.jsx("g",{transform:`translate(${f},${m})`,children:o.jsx("text",{x:-5,y:0,dy:4,textAnchor:"end",fill:"#374151",fontSize:12,fontWeight:500,style:{cursor:"pointer"},children:p.value.length>25?p.value.slice(0,22)+"...":p.value})})}),o.jsx(Cs,{content:o.jsx(O6e,{}),cursor:{fill:"rgba(59, 130, 246, 0.05)"}}),o.jsx(Hd,{dataKey:"duration",radius:[4,4,4,4],style:{cursor:"pointer"},onClick:f=>{const m=f;m?.planId&&t(m.planId)},children:i.map(f=>o.jsx(Hx,{fill:SD[f.status]||SD.draft,stroke:r===f.planId?"#1d4ed8":"transparent",strokeWidth:r===f.planId?2:0},f.planId))})]})})})}),o.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50",children:o.jsx("div",{className:"flex items-center justify-center gap-6","data-testid":"roadmap-legend",children:Object.entries(Hy).map(([f,m])=>o.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[o.jsx("span",{className:"w-3 h-3 rounded",style:{backgroundColor:SD[f]}}),o.jsx("span",{className:"text-gray-600",children:m.label})]},f))})})]})}function R6e(e){switch(e){case"draft":return[{status:"active",label:"Activate",icon:en,color:"bg-blue-500 hover:bg-blue-600"}];case"active":return[{status:"completed",label:"Complete",icon:Yn,color:"bg-green-500 hover:bg-green-600"},{status:"cancelled",label:"Cancel",icon:WC,color:"bg-red-500 hover:bg-red-600"}];case"completed":case"cancelled":return[{status:"draft",label:"Reopen as Draft",icon:T6,color:"bg-gray-500 hover:bg-gray-600"}];default:return[]}}function P6e({planId:e,onClose:t,renderProgressRing:r,onRemoveTaskNotAllowed:n,taskLinkBase:a="/tasks",onDeleteSuccess:i,onDeleteError:s}){const{data:l,isLoading:c,isError:u,error:d}=v6e(e),{data:f=[]}=b6e(e),{data:m}=y6e(e),[p,v]=w.useState(!1),[b,y]=w.useState(""),[S,_]=w.useState(!1),[N,k]=w.useState(null),[j,E]=w.useState(!1),T=x6e(),O=_6e(),R=w6e(),q=S6e();w.useEffect(()=>{l&&y(l.title)},[l]),w.useEffect(()=>{v(!1),_(!1),k(null)},[e]);const $=w.useCallback(async()=>{if(!l||b.trim()===l.title){v(!1);return}try{await T.mutateAsync({planId:e,updates:{title:b.trim()}}),v(!1)}catch(U){console.error("Failed to update title:",U)}},[l,b,e,T]),L=w.useCallback(()=>{l&&y(l.title),v(!1)},[l]),A=w.useCallback(async U=>{if(!(!l||U===l.status))try{await T.mutateAsync({planId:e,updates:{status:U}})}catch(V){console.error("Failed to update status:",V)}},[l,e,T]),M=w.useCallback(async U=>{try{await R.mutateAsync({planId:e,taskId:U}),_(!1)}catch(V){console.error("Failed to add task:",V)}},[e,R]),z=w.useCallback(async U=>{k(U);try{await q.mutateAsync({planId:e,taskId:U})}catch(V){console.error("Failed to remove task:",V)}finally{k(null)}},[e,q]),I=w.useCallback(()=>{n?n():console.warn("Cannot remove the last task. Plans must have at least one task.")},[n]),B=w.useCallback(async()=>{try{await O.mutateAsync(e),E(!1),i&&i(),t()}catch(U){const V=U.message||"Failed to delete plan";s?s(V):console.error("Failed to delete plan:",U)}},[e,O,i,s,t]);if(c)return o.jsx("div",{"data-testid":"plan-detail-loading",className:"h-full flex items-center justify-center bg-white",children:o.jsx("div",{className:"text-gray-500",children:"Loading plan..."})});if(u)return o.jsxs("div",{"data-testid":"plan-detail-error",className:"h-full flex flex-col items-center justify-center bg-white",children:[o.jsx("div",{className:"text-red-600 mb-2",children:"Failed to load plan"}),o.jsx("div",{className:"text-sm text-gray-500",children:d?.message})]});if(!l)return o.jsx("div",{"data-testid":"plan-detail-not-found",className:"h-full flex items-center justify-center bg-white",children:o.jsx("div",{className:"text-gray-500",children:"Plan not found"})});const F=R6e(l.status);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{"data-testid":"plan-detail-panel",className:"h-full flex flex-col bg-white border-l border-gray-200",children:[o.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"mb-2",children:o.jsx(bce,{status:l.status})}),p?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text","data-testid":"plan-title-input",value:b,onChange:U=>y(U.target.value),onKeyDown:U=>{U.key==="Enter"&&$(),U.key==="Escape"&&L()},className:"flex-1 text-lg font-semibold text-gray-900 border border-blue-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),o.jsx("button",{"data-testid":"save-title-btn",onClick:$,disabled:T.isPending,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:o.jsx(Vn,{className:"w-5 h-5"})}),o.jsx("button",{"data-testid":"cancel-edit-btn",onClick:L,className:"p-1 text-gray-400 hover:bg-gray-100 rounded",title:"Cancel",children:o.jsx(wt,{className:"w-5 h-5"})})]}):o.jsxs("div",{className:"flex items-center gap-2 group",children:[o.jsx("h2",{"data-testid":"plan-detail-title",className:"text-lg font-semibold text-gray-900",children:l.title}),o.jsx("button",{"data-testid":"edit-title-btn",onClick:()=>v(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Edit title",children:o.jsx(Uh,{className:"w-4 h-4"})})]}),o.jsx("div",{className:"mt-1 text-xs text-gray-500 font-mono",children:o.jsx("span",{"data-testid":"plan-detail-id",children:l.id})})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>E(!0),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded","aria-label":"Delete plan","data-testid":"plan-detail-delete",title:"Delete plan",children:o.jsx(Sr,{className:"w-5 h-5"})}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","aria-label":"Close panel","data-testid":"plan-detail-close",children:o.jsx(wt,{className:"w-5 h-5"})})]})]}),F.length>0&&o.jsx("div",{className:"flex gap-2 p-4 border-b border-gray-200 bg-gray-50",children:F.map(U=>{const V=U.icon;return o.jsxs("button",{"data-testid":`status-action-${U.status}`,onClick:()=>A(U.status),disabled:T.isPending,className:`flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white rounded ${U.color} disabled:opacity-50`,children:[o.jsx(V,{className:"w-4 h-4"}),U.label]},U.status)})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[m&&o.jsxs("div",{className:"mb-6","data-testid":"plan-progress-section",children:[o.jsx("div",{className:"text-sm font-medium text-gray-700 mb-4",children:"Progress"}),o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r?r({percentage:m.completionPercentage,completed:m.completedTasks,total:m.totalTasks}):o.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-blue-500 flex items-center justify-center","data-testid":"plan-detail-progress-ring",children:o.jsxs("span",{className:"text-xl font-bold text-blue-500",children:[m.completionPercentage,"%"]})}),o.jsx("div",{className:"w-full mt-2",children:o.jsx(D6e,{progress:m})})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"text-sm font-medium text-gray-700",children:["Tasks (",f.length,")"]}),o.jsxs("button",{"data-testid":"add-task-btn",onClick:()=>_(!0),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-blue-600 hover:bg-blue-50 rounded transition-colors",children:[o.jsx(_r,{className:"w-3 h-3"}),"Add Task"]})]}),o.jsx(A6e,{tasks:f,isEditMode:!0,onRemoveTask:z,removingTaskId:N,onRemoveNotAllowed:I,taskLinkBase:a})]}),o.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-gray-500",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsx("span",{className:"font-medium",children:"Created:"})]}),o.jsx("span",{title:Ep(l.createdAt),children:oR(l.createdAt)})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsx("span",{className:"font-medium",children:"Updated:"})]}),o.jsx("span",{title:Ep(l.updatedAt),children:oR(l.updatedAt)})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(Zr,{className:"w-3 h-3"}),o.jsx("span",{className:"font-medium",children:"Created by:"})]}),o.jsx("span",{className:"font-mono",children:l.createdBy})]}),l.completedAt&&o.jsxs("div",{className:"col-span-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(Yn,{className:"w-3 h-3 text-green-500"}),o.jsx("span",{className:"font-medium",children:"Completed:"})]}),o.jsx("span",{children:Ep(l.completedAt)})]}),l.cancelledAt&&o.jsxs("div",{className:"col-span-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(oi,{className:"w-3 h-3 text-red-500"}),o.jsx("span",{className:"font-medium",children:"Cancelled:"})]}),o.jsx("span",{children:Ep(l.cancelledAt)}),l.cancelReason&&o.jsx("p",{className:"mt-1 text-gray-600",children:l.cancelReason})]})]}),l.tags&&l.tags.length>0&&o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:l.tags.map(U=>o.jsx("span",{"data-testid":`plan-tag-${U}`,className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded",children:U},U))})]})]})]})]}),S&&o.jsx(L6e,{planId:e,onClose:()=>_(!1),onAddTask:M,isAdding:R.isPending}),j&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:U=>U.target===U.currentTarget&&E(!1),"data-testid":"delete-plan-modal",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Plan"}),o.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone."})]})]}),o.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete ",o.jsxs("span",{className:"font-semibold",children:['"',l.title,'"']}),"? Tasks in this plan will be unlinked but not deleted."]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors","data-testid":"delete-plan-cancel",children:"Cancel"}),o.jsx("button",{onClick:B,disabled:O.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50","data-testid":"delete-plan-confirm",children:O.isPending?"Deleting...":"Delete Plan"})]})]})})})]})}const WY={draft:{label:"Draft",icon:o.jsx(T6,{className:"w-3 h-3"}),color:"bg-gray-100 text-gray-700 dark:bg-gray-800/50 dark:text-gray-300"},active:{label:"Active",icon:o.jsx(ay,{className:"w-3 h-3"}),color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"},completed:{label:"Completed",icon:o.jsx(Yn,{className:"w-3 h-3"}),color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"},cancelled:{label:"Cancelled",icon:o.jsx(oi,{className:"w-3 h-3"}),color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}};function z6e(e,t){if(t.length===0)return o.jsx(o.Fragment,{children:e});const r=[],n=new Set(t);let a=0;for(let i=0;i<e.length;i++)n.has(i)&&(i>a&&r.push(o.jsx("span",{children:e.slice(a,i)},`text-${a}`)),r.push(o.jsx("mark",{className:"bg-yellow-200 text-gray-900 dark:bg-yellow-700 dark:text-white rounded-sm px-0.5",children:e[i]},`match-${i}`)),a=i+1);return a<e.length&&r.push(o.jsx("span",{children:e.slice(a)},`text-${a}`)),o.jsx(o.Fragment,{children:r})}function B6e(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function $6e({plan:e,isSelected:t,onClick:r,searchMatchIndices:n,progressRing:a}){const i=WY[e.status]||WY.draft,s=e._progress,l=s&&s.totalTasks>0,c=w.useMemo(()=>n&&n.length>0?z6e(e.title,n):e.title,[e.title,n]);return o.jsxs("div",{className:`
        flex gap-3 p-4
        bg-[var(--color-surface)] border-b border-[var(--color-border)]
        cursor-pointer transition-colors duration-150
        active:bg-[var(--color-surface-hover)]
        ${t?"bg-blue-50 dark:bg-blue-900/20":""}
      `,onClick:r,"data-testid":`mobile-plan-card-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o.jsx(tu,{className:"w-5 h-5 text-blue-500"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] line-clamp-2 mb-1","data-testid":`mobile-plan-title-${e.id}`,children:c}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono",children:e.id}),o.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:[" ",B6e(e.updatedAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[o.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 text-xs font-medium rounded ${i.color}`,children:[i.icon,i.label]}),e.tags&&e.tags.length>0&&o.jsxs(o.Fragment,{children:[e.tags.slice(0,2).map(u=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-hover)] text-[var(--color-text-secondary)] rounded truncate max-w-20",children:u},u)),e.tags.length>2&&o.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["+",e.tags.length-2]})]})]})]}),o.jsx("div",{className:"flex-shrink-0 self-center",children:a||(l?o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-blue-500 flex items-center justify-center",title:`${s.completionPercentage}% complete`,"data-testid":`mobile-plan-progress-${e.id}`,children:o.jsxs("span",{className:"text-[10px] text-blue-500 font-medium",children:[s.completionPercentage,"%"]})}):o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-[var(--color-border)] flex items-center justify-center",title:"No tasks in plan",children:o.jsx("span",{className:"text-[8px] text-[var(--color-text-muted)]",children:"--"})}))}),o.jsx("div",{className:"flex-shrink-0 self-center text-[var(--color-text-tertiary)]",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}function F6e({isOpen:e,onClose:t,onSuccess:r,currentUserId:n,isMobile:a=!1,onToastSuccess:i,onToastError:s,onCreateNewTask:l}){const c=ht(),[u,d]=w.useState(""),[f,m]=w.useState([]),[p,v]=w.useState(""),[b,y]=w.useState(""),S=N6e();w.useEffect(()=>{e&&(d(""),m([]),v(""),y(""))},[e]);const _=w.useRef(void 0);w.useEffect(()=>(_.current=setTimeout(()=>{y(p)},300),()=>{_.current&&clearTimeout(_.current)}),[p]);const{data:N=[],isLoading:k,refetch:j}=gt({queryKey:["tasks","for-plan-creation",b],queryFn:async()=>{const A=b?`/api/tasks?limit=50&search=${encodeURIComponent(b)}`:"/api/tasks?limit=50",M=await fetch(A);if(!M.ok)throw new Error("Failed to fetch tasks");const z=await M.json();return z.tasks||z.items||z.data||(Array.isArray(z)?z:[])},enabled:e}),E=N.filter(A=>!f.some(M=>M.taskId===A.id)),T=f.length>0,O=u.trim().length>0&&T&&n,R=w.useCallback(A=>{m(M=>[...M,{id:String(Date.now()),taskId:A.id,taskTitle:A.title}])},[]),q=w.useCallback(A=>{m(M=>M.filter(z=>z.id!==A))},[]),$=w.useCallback(A=>{c.invalidateQueries({queryKey:["tasks","for-plan-creation"]}),j(),m(M=>[...M,{id:String(Date.now()),taskId:A.id,taskTitle:A.title}])},[c,j]);w.useEffect(()=>(e&&(window.__createPlanModalTaskCreated=$),()=>{delete window.__createPlanModalTaskCreated}),[e,$]);const L=async()=>{if(O)try{const A=f[0],M=f.slice(1),z=await S.mutateAsync({title:u.trim(),createdBy:n,initialTaskId:A.taskId,additionalTasks:M.map(I=>({existingTaskId:I.taskId}))});i?.("Plan created successfully"),r?.({id:z.id,title:u.trim()}),t()}catch(A){s?.(A.message||"Failed to create plan")}};return e?a?o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)]","data-testid":"create-plan-modal",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",children:[o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Cancel","data-testid":"create-plan-close",children:o.jsx(Fl,{className:"w-5 h-5"})}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Create Plan"}),o.jsx("button",{onClick:L,disabled:!O||S.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors touch-target","data-testid":"create-plan-submit",children:S.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):"Create"})]}),o.jsxs("div",{className:"p-4 pb-20 overflow-y-auto h-[calc(100vh-60px)] space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"plan-title-mobile",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Plan Title *"}),o.jsx("input",{id:"plan-title-mobile",type:"text","data-testid":"plan-title-input",placeholder:"Enter plan title...",value:u,onChange:A=>d(A.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),o.jsx(KY,{selectedTasks:f,availableTasks:E,isLoadingTasks:k,searchQuery:p,onSearchChange:v,onSelectTask:R,onRemoveTask:q,onCreateNewTask:l,isMobile:!0})]})]}):o.jsx("div",{"data-testid":"create-plan-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:A=>A.target===A.currentTarget&&t(),children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Create Plan"}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded","data-testid":"create-plan-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"plan-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Plan Title *"}),o.jsx("input",{id:"plan-title",type:"text","data-testid":"plan-title-input",placeholder:"Enter plan title...",value:u,onChange:A=>d(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white",autoFocus:!0})]}),o.jsx(KY,{selectedTasks:f,availableTasks:E,isLoadingTasks:k,searchQuery:p,onSearchChange:v,onSelectTask:R,onRemoveTask:q,onCreateNewTask:l,isMobile:!1})]}),o.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors","data-testid":"create-plan-cancel",children:"Cancel"}),o.jsx("button",{onClick:L,disabled:!O||S.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"create-plan-submit",children:S.isPending?"Creating...":"Create Plan"})]})]})}):null}function KY({selectedTasks:e,availableTasks:t,isLoadingTasks:r,searchQuery:n,onSearchChange:a,onSelectTask:i,onRemoveTask:s,onCreateNewTask:l,isMobile:c}){return o.jsxs("div",{className:"border border-blue-200 dark:border-blue-800 rounded-lg p-4 bg-blue-50 dark:bg-blue-900/20",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(KC,{className:"w-4 h-4 text-blue-500"}),o.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Tasks (",e.length,")"]})]}),l&&o.jsxs("button",{onClick:l,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 hover:bg-green-100 dark:hover:bg-green-900/40 rounded transition-colors","data-testid":"create-new-task-btn",children:[o.jsx(Iae,{className:"w-3 h-3"}),"Create New Task"]})]}),o.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-4",children:"Plans must have at least one task. Search and select existing tasks below."}),e.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 uppercase tracking-wide",children:"Selected Tasks"}),o.jsx("div",{className:"space-y-2",children:e.map((u,d)=>o.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-green-100 dark:bg-green-900/50 flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:d+1})}),o.jsx("span",{className:"text-sm text-gray-900 dark:text-white truncate",children:u.taskTitle})]}),o.jsx("button",{onClick:()=>s(u.id),className:"flex-shrink-0 p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors","aria-label":"Remove task","data-testid":`remove-selected-task-${u.taskId}`,children:o.jsx(Sr,{className:"w-4 h-4"})})]},u.id))})]}),o.jsxs("div",{className:"relative mb-3",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text","data-testid":"task-search-input",placeholder:"Search tasks by title or ID...",value:n,onChange:u=>a(u.target.value),className:`w-full pl-10 pr-4 ${c?"py-2.5":"py-2"} border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white`})]}),o.jsx("div",{className:`${c?"max-h-60":"max-h-48"} overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800`,children:r?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500 text-sm",children:[o.jsx($e,{className:"w-4 h-4 animate-spin mr-2"}),"Loading tasks..."]}):t.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500 text-sm",children:[n?"No matching tasks found":"No tasks available",l&&o.jsx("button",{onClick:l,className:"block mx-auto mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Create a new task"})]}):o.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:t.map(u=>o.jsxs("button",{"data-testid":`available-task-${u.id}`,onClick:()=>i(u),className:`w-full flex items-center gap-3 p-3 text-left transition-colors ${c?"touch-target":""} hover:bg-gray-50 dark:hover:bg-gray-700`,children:[o.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded border border-gray-300 dark:border-gray-600 flex items-center justify-center",children:o.jsx(_r,{className:"w-3 h-3 text-gray-400"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:u.title}),o.jsx("div",{className:"text-xs text-gray-500 font-mono",children:u.id})]})]},u.id))})})]})}function GY(e){const t=window.__createPlanModalTaskCreated;t&&t(e)}function U6e(){return typeof window>"u"?!1:navigator.platform.toUpperCase().indexOf("MAC")>=0}function lR(e){return U6e()?e.replace(/Cmd/gi,"").replace(/Ctrl/gi,"").replace(/Alt/gi,"").replace(/Shift/gi,""):e.replace(/Cmd/gi,"Ctrl")}const H6e={navigation:"Navigation",actions:"Actions",views:"Views",editing:"Editing",other:"Other"};function q6e(e){const t={navigation:[],actions:[],views:[],editing:[],other:[]};for(const[r,n]of Object.entries(e)){const a=n.category||"other";t[a].push({actionId:r,description:n.description||r,defaultKeys:n.keys})}return t}function W6e({actionId:e,description:t,currentKeys:r,defaultKeys:n,defaults:a,onSave:i,onCancel:s,isMobile:l}){const[c,u]=w.useState([]),[d,f]=w.useState(!1),[m,p]=w.useState(null),v=w.useRef(null),b=w.useCallback(j=>{if(!d)return;j.preventDefault(),j.stopPropagation();const E=j.key.toLowerCase();if(["meta","control","alt","shift"].includes(E))return;let T=[];if(j.metaKey||j.ctrlKey){const q=[];j.metaKey&&q.push("Cmd"),j.ctrlKey&&q.push("Ctrl"),j.altKey&&q.push("Alt"),j.shiftKey&&q.push("Shift"),q.push(E.toUpperCase()),T=[q.join("+")]}else T=[...c,E.toUpperCase()];const O=T.join(" ");u(T);const R=i6e(O,a,e);if(R){const q=a[R]?.description||R;p(q)}else p(null)},[d,c,e,a]);w.useEffect(()=>{if(d)return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[d,b]);const y=()=>{u([]),p(null),f(!0),v.current?.focus()},S=()=>{f(!1)},_=()=>{c.length>0&&!m&&i(c.join(" "))},N=()=>{i(n)},k=c.length>0?lR(c.join(" ")):lR(r);return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50","data-testid":"shortcut-edit-modal",children:o.jsxs("div",{className:`
        bg-white dark:bg-gray-800 shadow-xl w-full p-4 sm:p-6
        ${l?"rounded-t-2xl max-h-[90vh] overflow-y-auto pb-safe":"rounded-lg max-w-md"}
      `,children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Edit Shortcut"}),o.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 min-h-[44px] min-w-[44px] flex items-center justify-center","data-testid":"shortcut-edit-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-4",children:t}),o.jsx("div",{ref:v,tabIndex:0,onClick:y,onBlur:S,className:`
            p-4 sm:p-6 rounded-lg border-2 text-center font-mono text-base sm:text-lg cursor-pointer transition-all min-h-[60px] flex items-center justify-center
            ${d?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900"}
            ${m?"border-red-500 bg-red-50 dark:bg-red-900/20":""}
          `,"data-testid":"shortcut-capture-area",children:d&&c.length===0?o.jsx("span",{className:"text-gray-400",children:"Press keys..."}):o.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:k})}),d&&o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"Press a key combination. For sequential shortcuts, press keys one after another."}),m&&o.jsxs("div",{className:"flex items-center gap-2 mt-3 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:[o.jsx(Bt,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),o.jsxs("p",{className:"text-xs sm:text-sm text-red-600 dark:text-red-400","data-testid":"shortcut-conflict-warning",children:["Conflicts with: ",m]})]}),o.jsxs("div",{className:`mt-6 ${l?"space-y-3":"flex items-center justify-between"}`,children:[o.jsxs("button",{onClick:N,className:`flex items-center justify-center gap-2 px-3 py-3 sm:py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 min-h-[44px] ${l?"w-full border border-gray-200 dark:border-gray-700 rounded-lg":""}`,"data-testid":"shortcut-reset-default",children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reset to Default"]}),o.jsxs("div",{className:`flex gap-2 ${l?"flex-col-reverse":""}`,children:[o.jsx("button",{onClick:s,className:`px-4 py-3 sm:py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg min-h-[44px] ${l?"w-full border border-gray-200 dark:border-gray-700":""}`,"data-testid":"shortcut-edit-cancel",children:"Cancel"}),o.jsxs("button",{onClick:_,disabled:c.length===0||!!m,className:`px-4 py-3 sm:py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg flex items-center justify-center gap-2 min-h-[44px] ${l?"w-full":""}`,"data-testid":"shortcut-edit-save",children:[o.jsx(Vn,{className:"w-4 h-4"}),"Save"]})]})]})]})})}function K6e({actionId:e,description:t,currentKeys:r,isCustomized:n,onEdit:a,isMobile:i}){return o.jsxs("button",{onClick:a,className:`
        w-full text-left py-3 px-3 sm:px-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 active:bg-gray-100 dark:active:bg-gray-700 rounded-lg group min-h-[56px]
        ${i?"flex flex-col gap-2":"flex items-center justify-between"}
      `,"data-testid":`shortcut-row-${e}`,children:[o.jsxs("div",{className:`${i?"w-full":"flex-1"}`,children:[o.jsx("span",{className:"text-xs sm:text-sm text-gray-900 dark:text-gray-100",children:t}),n&&o.jsx("span",{className:"ml-2 text-xs px-1.5 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:"Customized"})]}),o.jsxs("div",{className:`flex items-center gap-3 ${i?"w-full justify-between":""}`,children:[o.jsx("kbd",{className:"px-2 py-1 text-xs sm:text-sm font-mono bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded border border-gray-200 dark:border-gray-700",children:lR(r)}),o.jsx("span",{className:`text-xs sm:text-sm text-blue-600 dark:text-blue-400 ${i?"":"opacity-0 group-hover:opacity-100 transition-opacity"}`,children:i?"Edit":"Customize"})]})]})}function G6e({defaults:e,isMobile:t}){const[r,n]=w.useState({}),[a,i]=w.useState(null),[s,l]=w.useState(!1);c6e(!!a),w.useEffect(()=>{n(Uy())},[]);const c=q6e(e),u=m=>{a&&(s6e(a.actionId,m,e),n(Uy()),i(null))},d=()=>{o6e(),n({}),l(!1)},f=Object.keys(r).length>0;return o.jsxs("div",{"data-testid":"settings-shortcuts-section",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-2",children:[o.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100",children:"Keyboard Shortcuts"}),f&&o.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-3 py-2 sm:py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 sm:border-0 min-h-[44px] sm:min-h-0","data-testid":"shortcuts-reset-all",children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reset to Defaults"]})]}),o.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-4 sm:mb-6",children:["View and customize keyboard shortcuts. ",t?"Tap":'Click "Customize"'," to change a shortcut."]}),o.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([m,p])=>p.length===0?null:o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 px-4",children:H6e[m]}),o.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg divide-y divide-gray-200 dark:divide-gray-700",children:p.map(({actionId:v,description:b,defaultKeys:y})=>{const S=Jz(v,e),_=!!r[v];return o.jsx(K6e,{actionId:v,description:b,currentKeys:S,isCustomized:_,onEdit:()=>i({actionId:v,description:b,currentKeys:S,defaultKeys:y}),isMobile:t},v)})})]},m))}),a&&o.jsx(W6e,{actionId:a.actionId,description:a.description,currentKeys:a.currentKeys,defaultKeys:a.defaultKeys,defaults:e,onSave:u,onCancel:()=>i(null),isMobile:t}),s&&o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50","data-testid":"reset-confirm-modal",children:o.jsxs("div",{className:`
            bg-white dark:bg-gray-800 shadow-xl w-full p-4 sm:p-6
            ${t?"rounded-t-2xl":"rounded-lg max-w-sm"}
          `,children:[o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Reset All Shortcuts?"}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-4 sm:mb-6",children:"This will reset all keyboard shortcuts to their default values. This action cannot be undone."}),o.jsxs("div",{className:`flex gap-2 ${t?"flex-col-reverse":"justify-end"}`,children:[o.jsx("button",{onClick:()=>l(!1),className:`px-4 py-3 sm:py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg min-h-[44px] ${t?"w-full border border-gray-200 dark:border-gray-700":""}`,"data-testid":"reset-confirm-cancel",children:"Cancel"}),o.jsx("button",{onClick:d,className:`px-4 py-3 sm:py-2 text-sm font-medium text-white bg-red-500 hover:bg-red-600 rounded-lg min-h-[44px] ${t?"w-full":""}`,"data-testid":"reset-confirm-yes",children:"Reset All"})]})]})}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-6 text-center",children:"Changes to keyboard shortcuts take effect immediately."})]})}const cR=[{value:"updatedAt",label:"Updated",defaultDirection:"desc"},{value:"createdAt",label:"Created",defaultDirection:"desc"},{value:"title",label:"Title",defaultDirection:"asc"},{value:"contentType",label:"Type",defaultDirection:"asc"}],uR=[{value:"text",label:"Text",color:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200"},{value:"markdown",label:"Markdown",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"},{value:"json",label:"JSON",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300"}],tN={sortField:"documents.sortBy",sortDirection:"documents.sortDir"},Ob={contentTypes:[],tags:[]};function yce(){if(typeof window>"u")return{field:"updatedAt",direction:"desc"};const e=localStorage.getItem(tN.sortField),t=localStorage.getItem(tN.sortDirection);return{field:e&&["updatedAt","createdAt","title","contentType"].includes(e)?e:"updatedAt",direction:t==="asc"||t==="desc"?t:"desc"}}function rN(e,t){typeof window>"u"||(localStorage.setItem(tN.sortField,e),localStorage.setItem(tN.sortDirection,t))}function xce(e,t){const r=t?.toLowerCase().trim()||"",n=e.contentTypes.length>0,a=e.tags.length>0,i=r.length>0;return!n&&!a&&!i?()=>!0:s=>{if(i&&!(s.title||"").toLowerCase().includes(r))return!1;if(n){const l=(s.contentType||"text").toLowerCase();if(!e.contentTypes.some(c=>c.toLowerCase()===l))return!1}if(a){const l=s.tags||[];if(!e.tags.some(c=>l.includes(c)))return!1}return!0}}function Zx(e){return e.contentTypes.length+e.tags.length}function nh(e){return Zx(e)>0}function V6e(e){return cR.find(r=>r.value===e)?.defaultDirection??"desc"}function nN({sortField:e,sortDirection:t,onSortFieldChange:r,onSortDirectionChange:n}){const[a,i]=w.useState(!1),s=cR.find(u=>u.value===e),l=u=>{u===e?n(t==="asc"?"desc":"asc"):(r(u),n(V6e(u))),i(!1)},c=()=>{n(t==="asc"?"desc":"asc")};return o.jsxs("div",{className:"flex items-center gap-1","data-testid":"document-sort-dropdown",children:[o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>i(!a),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors","data-testid":"sort-field-trigger",children:[o.jsx(e0,{className:"w-4 h-4"}),o.jsxs("span",{children:["Sort: ",s?.label||"Updated"]}),o.jsx(cr,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`})]}),a&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),o.jsx("div",{className:"absolute left-0 top-full mt-1 w-40 py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-20",children:cR.map(u=>o.jsxs("button",{onClick:()=>l(u.value),className:"flex items-center justify-between w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","data-testid":`sort-option-${u.value}`,children:[o.jsx("span",{children:u.label}),e===u.value&&o.jsx(Vn,{className:"w-4 h-4 text-blue-600"})]},u.value))})]})]}),o.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",title:t==="asc"?"Ascending":"Descending","data-testid":"sort-direction-toggle",children:t==="asc"?o.jsx(Rx,{className:"w-4 h-4"}):o.jsx(Ix,{className:"w-4 h-4"})})]})}function wce({filters:e,onFilterChange:t,onClearFilters:r,availableTags:n}){const[a,i]=w.useState(!1),[s,l]=w.useState(!1),c=Zx(e),u=nh(e),d=v=>{const b=e.contentTypes.includes(v)?e.contentTypes.filter(y=>y!==v):[...e.contentTypes,v];t({...e,contentTypes:b})},f=v=>{const b=e.tags.includes(v)?e.tags.filter(y=>y!==v):[...e.tags,v];t({...e,tags:b})},m=v=>{t({...e,contentTypes:e.contentTypes.filter(b=>b!==v)})},p=v=>{t({...e,tags:e.tags.filter(b=>b!==v)})};return o.jsxs("div",{"data-testid":"document-filter-bar",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>i(!a),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${u?"text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50 hover:bg-blue-200 dark:hover:bg-blue-900/70":"text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700"}`,"data-testid":"filter-toggle",children:[o.jsx(ru,{className:"w-4 h-4"}),o.jsx("span",{children:"Filters"}),c>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold bg-blue-600 text-white rounded-full",children:c}),a?o.jsx(Xg,{className:"w-4 h-4"}):o.jsx(cr,{className:"w-4 h-4"})]}),u&&o.jsx("button",{onClick:r,className:"px-2 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors","data-testid":"clear-filters",children:"Clear"})]}),a&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"filter-panel",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Type"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:uR.map(v=>{const b=e.contentTypes.includes(v.value);return o.jsxs("button",{onClick:()=>d(v.value),className:`flex items-center gap-1.5 px-3 py-1.5 text-sm rounded-md border transition-colors ${b?`${v.color} border-transparent font-medium`:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-gray-400 dark:hover:border-gray-500"}`,"data-testid":`filter-type-${v.value}`,children:[b&&o.jsx(Vn,{className:"w-3 h-3"}),v.label]},v.value)})})]}),n.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Tags"}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 min-h-[38px] px-2 py-1.5 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 cursor-text",onClick:()=>l(!0),children:[e.tags.map(v=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100 rounded",children:[v,o.jsx("button",{onClick:b=>{b.stopPropagation(),f(v)},className:"hover:opacity-70 transition-opacity","data-testid":`remove-tag-input-${v}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},v)),e.tags.length===0&&o.jsxs("span",{className:"text-sm text-gray-400 dark:text-gray-500 flex items-center gap-1.5",children:[o.jsx(Vc,{className:"w-4 h-4"}),"Click to select tags..."]})]}),s&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),o.jsx("div",{className:"absolute left-0 top-full mt-1 w-full max-h-48 overflow-y-auto py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-20",children:n.filter(v=>!e.tags.includes(v)).length===0?o.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"All tags selected"}):n.filter(v=>!e.tags.includes(v)).map(v=>o.jsxs("button",{onClick:()=>f(v),className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","data-testid":`filter-tag-${v}`,children:[o.jsx(Vc,{className:"w-3 h-3 text-gray-400"}),o.jsx("span",{children:v})]},v))})]})]})]})]}),!a&&u&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5","data-testid":"filter-chips",children:[e.contentTypes.map(v=>{const b=uR.find(y=>y.value===v);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${b?.color||"bg-gray-100 text-gray-700"}`,children:[b?.label||v,o.jsx("button",{onClick:()=>m(v),className:"hover:opacity-70 transition-opacity","data-testid":`remove-type-${v}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},`type-${v}`)}),e.tags.map(v=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100 rounded-full",children:[o.jsx(Vc,{className:"w-3 h-3"}),v,o.jsx("button",{onClick:()=>p(v),className:"hover:opacity-70 transition-opacity","data-testid":`remove-tag-${v}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},`tag-${v}`))]})]})}function Sce({open:e,onClose:t,filters:r,onFilterChange:n,onClearFilters:a,availableTags:i}){const s=w.useRef(null),l=w.useRef(null),c=w.useRef(0),u=Zx(r);w.useEffect(()=>{if(e){const y=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=y}}},[e]),w.useEffect(()=>{if(!e)return;const y=S=>{S.key==="Escape"&&t()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[e,t]),w.useEffect(()=>{if(!e)return;window.history.pushState({mobileSheet:!0},"");const y=S=>{S.state?.mobileSheet===void 0&&t()};return window.addEventListener("popstate",y),()=>{window.removeEventListener("popstate",y),window.history.state?.mobileSheet&&window.history.back()}},[e,t]);const d=y=>{l.current=y.touches[0].clientY,c.current=0},f=y=>{l.current!==null&&(c.current=y.touches[0].clientY-l.current,c.current<0&&(c.current=0),s.current&&c.current>0&&(s.current.style.transform=`translateY(${c.current}px)`))},m=()=>{l.current!==null&&(c.current>100?t():s.current&&(s.current.style.transform="translateY(0)"),l.current=null,c.current=0)};w.useEffect(()=>{e&&s.current&&s.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},[e]);const p=y=>{const S=r.contentTypes.includes(y)?r.contentTypes.filter(_=>_!==y):[...r.contentTypes,y];n({...r,contentTypes:S})},v=y=>{const S=r.tags.includes(y)?r.tags.filter(_=>_!==y):[...r.tags,y];n({...r,tags:S})},b=()=>{a(),t()};return e?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"mobile-document-filter",role:"dialog","aria-modal":"true","aria-label":"Document filters",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-200",onClick:t,"aria-hidden":"true"}),o.jsxs("div",{ref:s,className:"absolute inset-x-0 bottom-0 top-0 bg-[var(--color-bg)] shadow-2xl flex flex-col transform transition-transform duration-200 ease-out",style:{transform:e?"translateY(0)":"translateY(100%)"},children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",onTouchStart:d,onTouchMove:f,onTouchEnd:m,children:[o.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 w-10 h-1 bg-[var(--color-border)] rounded-full"}),o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Close",children:o.jsx(Fl,{className:"w-5 h-5"})}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Filters"})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2",children:"Type"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:uR.map(y=>{const S=r.contentTypes.includes(y.value);return o.jsxs("button",{onClick:()=>p(y.value),className:`flex items-center gap-1.5 px-3 py-2 text-sm rounded-lg border transition-colors touch-target ${S?`${y.color} border-transparent font-medium`:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300"}`,"data-testid":`mobile-filter-type-${y.value}`,children:[S&&o.jsx(Vn,{className:"w-4 h-4"}),y.label]},y.value)})})]}),i.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2",children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(y=>{const S=r.tags.includes(y);return o.jsxs("button",{onClick:()=>v(y),className:`flex items-center gap-1.5 px-3 py-2 text-sm rounded-lg border transition-colors touch-target ${S?"bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-100 border-transparent font-medium":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300"}`,"data-testid":`mobile-filter-tag-${y}`,children:[o.jsx(Vc,{className:"w-4 h-4"}),y,S&&o.jsx(Vn,{className:"w-4 h-4"})]},y)})})]}),u>0&&o.jsxs("button",{onClick:b,className:"w-full py-2.5 text-sm font-medium text-red-600 dark:text-red-400 border border-red-300 dark:border-red-800 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors touch-target","data-testid":"mobile-clear-filters",children:["Clear all filters (",u,")"]}),o.jsx("button",{onClick:t,className:"w-full py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors touch-target","data-testid":"mobile-apply-filters",children:"Apply Filters"})]})]})]}):null}function Y6e({tags:e,onTagsChange:t,disabled:r=!1,placeholder:n="Add tag..."}){const[a,i]=w.useState(""),[s,l]=w.useState(!1),c=w.useRef(null);w.useEffect(()=>{s&&c.current&&c.current.focus()},[s]);const u=()=>{const p=a.trim().toLowerCase();p&&!e.includes(p)&&t([...e,p]),i(""),l(!1)},d=p=>{t(e.filter(v=>v!==p))},f=p=>{p.key==="Enter"?(p.preventDefault(),u()):p.key==="Escape"?(i(""),l(!1)):p.key==="Backspace"&&a===""&&e.length>0&&d(e[e.length-1])},m=()=>{a.trim()?u():l(!1)};return o.jsxs("div",{"data-testid":"document-tag-input",children:[o.jsxs("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2 flex items-center gap-1",children:[o.jsx(Vc,{className:"w-3 h-3"}),"Tags"]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[e.map(p=>o.jsxs("span",{"data-testid":`document-tag-${p}`,className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100 rounded",children:[p,!r&&o.jsx("button",{onClick:()=>d(p),className:"hover:opacity-70 transition-opacity","data-testid":`remove-tag-${p}`,"aria-label":`Remove tag ${p}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},p)),!r&&(s?o.jsx("input",{ref:c,type:"text",value:a,onChange:p=>i(p.target.value),onKeyDown:f,onBlur:m,placeholder:n,className:"px-2 py-0.5 text-xs border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-w-[80px]","data-testid":"tag-input"}):o.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors","data-testid":"add-tag-button",children:[o.jsx(_r,{className:"w-3 h-3"}),"Add tag"]})),e.length===0&&r&&o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"No tags"})]})]})}function VY({isOpen:e,onClose:t,onConfirm:r,library:n,documentCount:a=0,isDeleting:i=!1,error:s=null,isMobile:l=!1}){const[c,u]=w.useState(!0);w.useEffect(()=>{e&&u(!0)},[e]);const d=async()=>{await r(c)},f=()=>{i||t()};return e?l?o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)]","data-testid":"delete-library-modal",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",children:[o.jsx("button",{onClick:f,disabled:i,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target disabled:opacity-50","aria-label":"Cancel","data-testid":"delete-library-close",children:o.jsx(Fl,{className:"w-5 h-5"})}),o.jsx(Sr,{className:"w-5 h-5 text-red-500"}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Delete Library"})]}),o.jsx("div",{className:"p-4 pb-24 overflow-y-auto",children:o.jsx(YY,{library:n,documentCount:a,deleteDocuments:c,setDeleteDocuments:u,error:s})}),o.jsx("div",{className:"fixed bottom-0 left-0 right-0 px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:f,disabled:i,className:"px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors disabled:opacity-50 touch-target","data-testid":"delete-library-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:d,disabled:i,className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"delete-library-confirm-button",children:i?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete Library"]})})]})})]}):o.jsx("div",{"data-testid":"delete-library-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:m=>m.target===m.currentTarget&&f(),children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md mx-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Sr,{className:"w-5 h-5 text-red-500"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Library"})]}),o.jsx("button",{onClick:f,disabled:i,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded disabled:opacity-50","data-testid":"delete-library-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-4",children:o.jsx(YY,{library:n,documentCount:a,deleteDocuments:c,setDeleteDocuments:u,error:s})}),o.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 rounded-b-lg",children:[o.jsx("button",{type:"button",onClick:f,disabled:i,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors disabled:opacity-50","data-testid":"delete-library-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:d,disabled:i,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"delete-library-confirm-button",children:i?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete Library"]})})]})]})}):null}function YY({library:e,documentCount:t,deleteDocuments:r,setDeleteDocuments:n,error:a}){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg mb-4",children:[o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"This action cannot be undone"}),o.jsxs("p",{className:"mt-1 text-sm text-red-700 dark:text-red-400",children:['You are about to delete the library "',o.jsx("strong",{children:e?.name}),'".',t>0&&o.jsxs(o.Fragment,{children:[" ","This library contains ",o.jsx("strong",{children:t})," document",t===1?"":"s","."]})]})]})]}),t>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What should happen to the documents in this library?"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[o.jsx("input",{type:"radio",name:"deleteDocuments",checked:r,onChange:()=>n(!0),className:"mt-0.5","data-testid":"delete-documents-radio"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Delete all documents"}),o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["Permanently delete all ",t," document",t===1?"":"s"," in this library"]})]})]}),o.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[o.jsx("input",{type:"radio",name:"deleteDocuments",checked:!r,onChange:()=>n(!1),className:"mt-0.5","data-testid":"keep-documents-radio"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Keep documents"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"Remove documents from this library but don't delete them"})]})]})]})]}),a&&o.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-400","data-testid":"delete-library-error",children:a})]})}var Zz=B1e();function ti(e){this.content=e}ti.prototype={constructor:ti,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,r){var n=r&&r!=e?this.remove(r):this,a=n.find(e),i=n.content.slice();return a==-1?i.push(r||e,t):(i[a+1]=t,r&&(i[a]=r)),new ti(i)},remove:function(e){var t=this.find(e);if(t==-1)return this;var r=this.content.slice();return r.splice(t,2),new ti(r)},addToStart:function(e,t){return new ti([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var r=this.remove(e).content.slice();return r.push(e,t),new ti(r)},addBefore:function(e,t,r){var n=this.remove(t),a=n.content.slice(),i=n.find(e);return a.splice(i==-1?a.length:i,0,t,r),new ti(a)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=ti.from(e),e.size?new ti(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=ti.from(e),e.size?new ti(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=ti.from(e);for(var r=0;r<e.content.length;r+=2)t=t.remove(e.content[r]);return t},toObject:function(){var e={};return this.forEach(function(t,r){e[t]=r}),e},get size(){return this.content.length>>1}};ti.from=function(e){if(e instanceof ti)return e;var t=[];if(e)for(var r in e)t.push(r,e[r]);return new ti(t)};function kce(e,t,r){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:r;let a=e.child(n),i=t.child(n);if(a==i){r+=a.nodeSize;continue}if(!a.sameMarkup(i))return r;if(a.isText&&a.text!=i.text){for(let s=0;a.text[s]==i.text[s];s++)r++;return r}if(a.content.size||i.content.size){let s=kce(a.content,i.content,r+1);if(s!=null)return s}r+=a.nodeSize}}function _ce(e,t,r,n){for(let a=e.childCount,i=t.childCount;;){if(a==0||i==0)return a==i?null:{a:r,b:n};let s=e.child(--a),l=t.child(--i),c=s.nodeSize;if(s==l){r-=c,n-=c;continue}if(!s.sameMarkup(l))return{a:r,b:n};if(s.isText&&s.text!=l.text){let u=0,d=Math.min(s.text.length,l.text.length);for(;u<d&&s.text[s.text.length-u-1]==l.text[l.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(s.content.size||l.content.size){let u=_ce(s.content,l.content,r-1,n-1);if(u)return u}r-=c,n-=c}}class Ge{constructor(t,r){if(this.content=t,this.size=r||0,r==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,r,n,a=0,i){for(let s=0,l=0;l<r;s++){let c=this.content[s],u=l+c.nodeSize;if(u>t&&n(c,a+l,i||null,s)!==!1&&c.content.size){let d=l+1;c.nodesBetween(Math.max(0,t-d),Math.min(c.content.size,r-d),n,a+d)}l=u}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,r,n,a){let i="",s=!0;return this.nodesBetween(t,r,(l,c)=>{let u=l.isText?l.text.slice(Math.max(t,c)-c,r-c):l.isLeaf?a?typeof a=="function"?a(l):a:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&n&&(s?s=!1:i+=n),i+=u},0),i}append(t){if(!t.size)return this;if(!this.size)return t;let r=this.lastChild,n=t.firstChild,a=this.content.slice(),i=0;for(r.isText&&r.sameMarkup(n)&&(a[a.length-1]=r.withText(r.text+n.text),i=1);i<t.content.length;i++)a.push(t.content[i]);return new Ge(a,this.size+t.size)}cut(t,r=this.size){if(t==0&&r==this.size)return this;let n=[],a=0;if(r>t)for(let i=0,s=0;s<r;i++){let l=this.content[i],c=s+l.nodeSize;c>t&&((s<t||c>r)&&(l.isText?l=l.cut(Math.max(0,t-s),Math.min(l.text.length,r-s)):l=l.cut(Math.max(0,t-s-1),Math.min(l.content.size,r-s-1))),n.push(l),a+=l.nodeSize),s=c}return new Ge(n,a)}cutByIndex(t,r){return t==r?Ge.empty:t==0&&r==this.content.length?this:new Ge(this.content.slice(t,r))}replaceChild(t,r){let n=this.content[t];if(n==r)return this;let a=this.content.slice(),i=this.size+r.nodeSize-n.nodeSize;return a[t]=r,new Ge(a,i)}addToStart(t){return new Ge([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new Ge(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(t.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let r=this.content[t];if(!r)throw new RangeError("Index "+t+" out of range for "+this);return r}maybeChild(t){return this.content[t]||null}forEach(t){for(let r=0,n=0;r<this.content.length;r++){let a=this.content[r];t(a,n,r),n+=a.nodeSize}}findDiffStart(t,r=0){return kce(this,t,r)}findDiffEnd(t,r=this.size,n=t.size){return _ce(this,t,r,n)}findIndex(t){if(t==0)return oS(0,t);if(t==this.size)return oS(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,n=0;;r++){let a=this.child(r),i=n+a.nodeSize;if(i>=t)return i==t?oS(r+1,i):oS(r,n);n=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,r){if(!r)return Ge.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ge(r.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return Ge.empty;let r,n=0;for(let a=0;a<t.length;a++){let i=t[a];n+=i.nodeSize,a&&i.isText&&t[a-1].sameMarkup(i)?(r||(r=t.slice(0,a)),r[r.length-1]=i.withText(r[r.length-1].text+i.text)):r&&r.push(i)}return new Ge(r||t,n)}static from(t){if(!t)return Ge.empty;if(t instanceof Ge)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Ge([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ge.empty=new Ge([],0);const kD={index:0,offset:0};function oS(e,t){return kD.index=e,kD.offset=t,kD}function aN(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let r=Array.isArray(e);if(Array.isArray(t)!=r)return!1;if(r){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!aN(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!aN(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let hn=class dR{constructor(t,r){this.type=t,this.attrs=r}addToSet(t){let r,n=!1;for(let a=0;a<t.length;a++){let i=t[a];if(this.eq(i))return t;if(this.type.excludes(i.type))r||(r=t.slice(0,a));else{if(i.type.excludes(this.type))return t;!n&&i.type.rank>this.type.rank&&(r||(r=t.slice(0,a)),r.push(this),n=!0),r&&r.push(i)}}return r||(r=t.slice()),n||r.push(this),r}removeFromSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return t.slice(0,r).concat(t.slice(r+1));return t}isInSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return!0;return!1}eq(t){return this==t||this.type==t.type&&aN(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let a=n.create(r.attrs);return n.checkAttrs(a.attrs),a}static sameSet(t,r){if(t==r)return!0;if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(r[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return dR.none;if(t instanceof dR)return[t];let r=t.slice();return r.sort((n,a)=>n.type.rank-a.type.rank),r}};hn.none=[];class iN extends Error{}class pt{constructor(t,r,n){this.content=t,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,r){let n=Cce(this.content,t+this.openStart,r);return n&&new pt(n,this.openStart,this.openEnd)}removeBetween(t,r){return new pt(Nce(this.content,t+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,r){if(!r)return pt.empty;let n=r.openStart||0,a=r.openEnd||0;if(typeof n!="number"||typeof a!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new pt(Ge.fromJSON(t,r.content),n,a)}static maxOpen(t,r=!0){let n=0,a=0;for(let i=t.firstChild;i&&!i.isLeaf&&(r||!i.type.spec.isolating);i=i.firstChild)n++;for(let i=t.lastChild;i&&!i.isLeaf&&(r||!i.type.spec.isolating);i=i.lastChild)a++;return new pt(t,n,a)}}pt.empty=new pt(Ge.empty,0,0);function Nce(e,t,r){let{index:n,offset:a}=e.findIndex(t),i=e.maybeChild(n),{index:s,offset:l}=e.findIndex(r);if(a==t||i.isText){if(l!=r&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(r))}if(n!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(n,i.copy(Nce(i.content,t-a-1,r-a-1)))}function Cce(e,t,r,n){let{index:a,offset:i}=e.findIndex(t),s=e.maybeChild(a);if(i==t||s.isText)return n&&!n.canReplace(a,a,r)?null:e.cut(0,t).append(r).append(e.cut(t));let l=Cce(s.content,t-i-1,r,s);return l&&e.replaceChild(a,s.copy(l))}function Q6e(e,t,r){if(r.openStart>e.depth)throw new iN("Inserted content deeper than insertion position");if(e.depth-r.openStart!=t.depth-r.openEnd)throw new iN("Inconsistent open depths");return jce(e,t,r,0)}function jce(e,t,r,n){let a=e.index(n),i=e.node(n);if(a==t.index(n)&&n<e.depth-r.openStart){let s=jce(e,t,r,n+1);return i.copy(i.content.replaceChild(a,s))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&e.depth==n&&t.depth==n){let s=e.parent,l=s.content;return ih(s,l.cut(0,e.parentOffset).append(r.content).append(l.cut(t.parentOffset)))}else{let{start:s,end:l}=J6e(r,e);return ih(i,Mce(e,s,l,t,n))}else return ih(i,sN(e,t,n))}function Ece(e,t){if(!t.type.compatibleContent(e.type))throw new iN("Cannot join "+t.type.name+" onto "+e.type.name)}function fR(e,t,r){let n=e.node(r);return Ece(n,t.node(r)),n}function ah(e,t){let r=t.length-1;r>=0&&e.isText&&e.sameMarkup(t[r])?t[r]=e.withText(t[r].text+e.text):t.push(e)}function Ib(e,t,r,n){let a=(t||e).node(r),i=0,s=t?t.index(r):a.childCount;e&&(i=e.index(r),e.depth>r?i++:e.textOffset&&(ah(e.nodeAfter,n),i++));for(let l=i;l<s;l++)ah(a.child(l),n);t&&t.depth==r&&t.textOffset&&ah(t.nodeBefore,n)}function ih(e,t){return e.type.checkContent(t),e.copy(t)}function Mce(e,t,r,n,a){let i=e.depth>a&&fR(e,t,a+1),s=n.depth>a&&fR(r,n,a+1),l=[];return Ib(null,e,a,l),i&&s&&t.index(a)==r.index(a)?(Ece(i,s),ah(ih(i,Mce(e,t,r,n,a+1)),l)):(i&&ah(ih(i,sN(e,t,a+1)),l),Ib(t,r,a,l),s&&ah(ih(s,sN(r,n,a+1)),l)),Ib(n,null,a,l),new Ge(l)}function sN(e,t,r){let n=[];if(Ib(null,e,r,n),e.depth>r){let a=fR(e,t,r+1);ah(ih(a,sN(e,t,r+1)),n)}return Ib(t,null,r,n),new Ge(n)}function J6e(e,t){let r=t.depth-e.openStart,a=t.node(r).copy(e.content);for(let i=r-1;i>=0;i--)a=t.node(i).copy(Ge.from(a));return{start:a.resolveNoCache(e.openStart+r),end:a.resolveNoCache(a.content.size-e.openEnd-r)}}class qy{constructor(t,r,n){this.pos=t,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,r=this.index(this.depth);if(r==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],a=t.child(r);return n?t.child(r).cut(n):a}get nodeBefore(){let t=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(t).cut(0,r):t==0?null:this.parent.child(t-1)}posAtIndex(t,r){r=this.resolveDepth(r);let n=this.path[r*3],a=r==0?0:this.path[r*3-1]+1;for(let i=0;i<t;i++)a+=n.child(i).nodeSize;return a}marks(){let t=this.parent,r=this.index();if(t.content.size==0)return hn.none;if(this.textOffset)return t.child(r).marks;let n=t.maybeChild(r-1),a=t.maybeChild(r);if(!n){let l=n;n=a,a=l}let i=n.marks;for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!a||!i[s].isInSet(a.marks))&&(i=i[s--].removeFromSet(i));return i}marksAcross(t){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,a=t.parent.maybeChild(t.index());for(var i=0;i<n.length;i++)n[i].type.spec.inclusive===!1&&(!a||!n[i].isInSet(a.marks))&&(n=n[i--].removeFromSet(n));return n}sharedDepth(t){for(let r=this.depth;r>0;r--)if(this.start(r)<=t&&this.end(r)>=t)return r;return 0}blockRange(t=this,r){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!r||r(this.node(n))))return new oN(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let r=1;r<=this.depth;r++)t+=(t?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return t+":"+this.parentOffset}static resolve(t,r){if(!(r>=0&&r<=t.content.size))throw new RangeError("Position "+r+" out of range");let n=[],a=0,i=r;for(let s=t;;){let{index:l,offset:c}=s.content.findIndex(i),u=i-c;if(n.push(s,l,a+c),!u||(s=s.child(l),s.isText))break;i=u-1,a+=c+1}return new qy(r,n,i)}static resolveCached(t,r){let n=QY.get(t);if(n)for(let i=0;i<n.elts.length;i++){let s=n.elts[i];if(s.pos==r)return s}else QY.set(t,n=new Z6e);let a=n.elts[n.i]=qy.resolve(t,r);return n.i=(n.i+1)%X6e,a}}class Z6e{constructor(){this.elts=[],this.i=0}}const X6e=12,QY=new WeakMap;class oN{constructor(t,r,n){this.$from=t,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const eze=Object.create(null);let Nd=class hR{constructor(t,r,n,a=hn.none){this.type=t,this.attrs=r,this.marks=a,this.content=n||Ge.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,r,n,a=0){this.content.nodesBetween(t,r,n,a,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,r,n,a){return this.content.textBetween(t,r,n,a)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,r,n){return this.type==t&&aN(this.attrs,r||t.defaultAttrs||eze)&&hn.sameSet(this.marks,n||hn.none)}copy(t=null){return t==this.content?this:new hR(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new hR(this.type,this.attrs,this.content,t)}cut(t,r=this.content.size){return t==0&&r==this.content.size?this:this.copy(this.content.cut(t,r))}slice(t,r=this.content.size,n=!1){if(t==r)return pt.empty;let a=this.resolve(t),i=this.resolve(r),s=n?0:a.sharedDepth(r),l=a.start(s),u=a.node(s).content.cut(a.pos-l,i.pos-l);return new pt(u,a.depth-s,i.depth-s)}replace(t,r,n){return Q6e(this.resolve(t),this.resolve(r),n)}nodeAt(t){for(let r=this;;){let{index:n,offset:a}=r.content.findIndex(t);if(r=r.maybeChild(n),!r)return null;if(a==t||r.isText)return r;t-=a+1}}childAfter(t){let{index:r,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(r),index:r,offset:n};let a=this.content.child(r-1);return{node:a,index:r-1,offset:n-a.nodeSize}}resolve(t){return qy.resolveCached(this,t)}resolveNoCache(t){return qy.resolve(this,t)}rangeHasMark(t,r,n){let a=!1;return r>t&&this.nodesBetween(t,r,i=>(n.isInSet(i.marks)&&(a=!0),!a)),a}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Tce(this.marks,t)}contentMatchAt(t){let r=this.type.contentMatch.matchFragment(this.content,0,t);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(t,r,n=Ge.empty,a=0,i=n.childCount){let s=this.contentMatchAt(t).matchFragment(n,a,i),l=s&&s.matchFragment(this.content,r);if(!l||!l.validEnd)return!1;for(let c=a;c<i;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0}canReplaceWith(t,r,n,a){if(a&&!this.type.allowsMarks(a))return!1;let i=this.contentMatchAt(t).matchType(n),s=i&&i.matchFragment(this.content,r);return s?s.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=hn.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!hn.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(r=>r.toJSON())),t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(t.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(r.text,n)}let a=Ge.fromJSON(t,r.content),i=t.nodeType(r.type).create(r.attrs,a,n);return i.type.checkAttrs(i.attrs),i}};Nd.prototype.text=void 0;class lN extends Nd{constructor(t,r,n,a){if(super(t,r,null,a),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Tce(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,r){return this.text.slice(t,r)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new lN(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new lN(this.type,this.attrs,t,this.marks)}cut(t=0,r=this.text.length){return t==0&&r==this.text.length?this:this.withText(this.text.slice(t,r))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function Tce(e,t){for(let r=e.length-1;r>=0;r--)t=e[r].type.name+"("+t+")";return t}class Nh{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,r){let n=new tze(t,r);if(n.next==null)return Nh.empty;let a=Ace(n);n.next&&n.err("Unexpected trailing text");let i=lze(oze(a));return cze(i,n),i}matchType(t){for(let r=0;r<this.next.length;r++)if(this.next[r].type==t)return this.next[r].next;return null}matchFragment(t,r=0,n=t.childCount){let a=this;for(let i=r;a&&i<n;i++)a=a.matchType(t.child(i).type);return a}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:r}=this.next[t];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(t){for(let r=0;r<this.next.length;r++)for(let n=0;n<t.next.length;n++)if(this.next[r].type==t.next[n].type)return!0;return!1}fillBefore(t,r=!1,n=0){let a=[this];function i(s,l){let c=s.matchFragment(t,n);if(c&&(!r||c.validEnd))return Ge.from(l.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:d,next:f}=s.next[u];if(!(d.isText||d.hasRequiredAttrs())&&a.indexOf(f)==-1){a.push(f);let m=i(f,l.concat(d));if(m)return m}}return null}return i(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let r=this.computeWrapping(t);return this.wrapCache.push(t,r),r}computeWrapping(t){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let a=n.shift(),i=a.match;if(i.matchType(t)){let s=[];for(let l=a;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<i.next.length;s++){let{type:l,next:c}=i.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in r)&&(!a.type||c.validEnd)&&(n.push({match:l.contentMatch,type:l,via:a}),r[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function r(n){t.push(n);for(let a=0;a<n.next.length;a++)t.indexOf(n.next[a].next)==-1&&r(n.next[a].next)}return r(this),t.map((n,a)=>{let i=a+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)i+=(s?", ":"")+n.next[s].type.name+"->"+t.indexOf(n.next[s].next);return i}).join(`
`)}}Nh.empty=new Nh(!0);class tze{constructor(t,r){this.string=t,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Ace(e){let t=[];do t.push(rze(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function rze(e){let t=[];do t.push(nze(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function nze(e){let t=sze(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=aze(e,t);else break;return t}function JY(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function aze(e,t){let r=JY(e),n=r;return e.eat(",")&&(e.next!="}"?n=JY(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:t}}function ize(e,t){let r=e.nodeTypes,n=r[t];if(n)return[n];let a=[];for(let i in r){let s=r[i];s.isInGroup(t)&&a.push(s)}return a.length==0&&e.err("No node type or group '"+t+"' found"),a}function sze(e){if(e.eat("(")){let t=Ace(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=ize(e,e.next).map(r=>(e.inline==null?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function oze(e){let t=[[]];return a(i(e,0),r()),t;function r(){return t.push([])-1}function n(s,l,c){let u={term:c,to:l};return t[s].push(u),u}function a(s,l){s.forEach(c=>c.to=l)}function i(s,l){if(s.type=="choice")return s.exprs.reduce((c,u)=>c.concat(i(u,l)),[]);if(s.type=="seq")for(let c=0;;c++){let u=i(s.exprs[c],l);if(c==s.exprs.length-1)return u;a(u,l=r())}else if(s.type=="star"){let c=r();return n(l,c),a(i(s.expr,c),c),[n(c)]}else if(s.type=="plus"){let c=r();return a(i(s.expr,l),c),a(i(s.expr,c),c),[n(c)]}else{if(s.type=="opt")return[n(l)].concat(i(s.expr,l));if(s.type=="range"){let c=l;for(let u=0;u<s.min;u++){let d=r();a(i(s.expr,c),d),c=d}if(s.max==-1)a(i(s.expr,c),c);else for(let u=s.min;u<s.max;u++){let d=r();n(c,d),a(i(s.expr,c),d),c=d}return[n(c)]}else{if(s.type=="name")return[n(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Dce(e,t){return t-e}function ZY(e,t){let r=[];return n(t),r.sort(Dce);function n(a){let i=e[a];if(i.length==1&&!i[0].term)return n(i[0].to);r.push(a);for(let s=0;s<i.length;s++){let{term:l,to:c}=i[s];!l&&r.indexOf(c)==-1&&n(c)}}}function lze(e){let t=Object.create(null);return r(ZY(e,0));function r(n){let a=[];n.forEach(s=>{e[s].forEach(({term:l,to:c})=>{if(!l)return;let u;for(let d=0;d<a.length;d++)a[d][0]==l&&(u=a[d][1]);ZY(e,c).forEach(d=>{u||a.push([l,u=[]]),u.indexOf(d)==-1&&u.push(d)})})});let i=t[n.join(",")]=new Nh(n.indexOf(e.length-1)>-1);for(let s=0;s<a.length;s++){let l=a[s][1].sort(Dce);i.next.push({type:a[s][0],next:t[l.join(",")]||r(l)})}return i}}function cze(e,t){for(let r=0,n=[e];r<n.length;r++){let a=n[r],i=!a.validEnd,s=[];for(let l=0;l<a.next.length;l++){let{type:c,next:u}=a.next[l];s.push(c.name),i&&!(c.isText||c.hasRequiredAttrs())&&(i=!1),n.indexOf(u)==-1&&n.push(u)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Lce(e){let t=Object.create(null);for(let r in e){let n=e[r];if(!n.hasDefault)return null;t[r]=n.default}return t}function Oce(e,t){let r=Object.create(null);for(let n in e){let a=t&&t[n];if(a===void 0){let i=e[n];if(i.hasDefault)a=i.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=a}return r}function Ice(e,t,r,n){for(let a in t)if(!(a in e))throw new RangeError(`Unsupported attribute ${a} for ${r} of type ${a}`);for(let a in e){let i=e[a];i.validate&&i.validate(t[a])}}function Rce(e,t){let r=Object.create(null);if(t)for(let n in t)r[n]=new dze(e,n,t[n]);return r}let XY=class Pce{constructor(t,r,n){this.name=t,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Rce(t,n.attrs),this.defaultAttrs=Lce(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Nh.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:Oce(this.attrs,t)}create(t=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Nd(this,this.computeAttrs(t),Ge.from(r),hn.setFrom(n))}createChecked(t=null,r,n){return r=Ge.from(r),this.checkContent(r),new Nd(this,this.computeAttrs(t),r,hn.setFrom(n))}createAndFill(t=null,r,n){if(t=this.computeAttrs(t),r=Ge.from(r),r.size){let s=this.contentMatch.fillBefore(r);if(!s)return null;r=s.append(r)}let a=this.contentMatch.matchFragment(r),i=a&&a.fillBefore(Ge.empty,!0);return i?new Nd(this,t,r.append(i),hn.setFrom(n)):null}validContent(t){let r=this.contentMatch.matchFragment(t);if(!r||!r.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){Ice(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let r=0;r<t.length;r++)if(!this.allowsMarkType(t[r].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let r;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?r&&r.push(t[n]):r||(r=t.slice(0,n));return r?r.length?r:hn.none:t}static compile(t,r){let n=Object.create(null);t.forEach((i,s)=>n[i]=new Pce(i,r,s));let a=r.spec.topNode||"doc";if(!n[a])throw new RangeError("Schema is missing its top node type ('"+a+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let i in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function uze(e,t,r){let n=r.split("|");return a=>{let i=a===null?"null":typeof a;if(n.indexOf(i)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${i}`)}}class dze{constructor(t,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?uze(t,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Kj{constructor(t,r,n,a){this.name=t,this.rank=r,this.schema=n,this.spec=a,this.attrs=Rce(t,a.attrs),this.excluded=null;let i=Lce(this.attrs);this.instance=i?new hn(this,i):null}create(t=null){return!t&&this.instance?this.instance:new hn(this,Oce(this.attrs,t))}static compile(t,r){let n=Object.create(null),a=0;return t.forEach((i,s)=>n[i]=new Kj(i,a++,r,s)),n}removeFromSet(t){for(var r=0;r<t.length;r++)t[r].type==this&&(t=t.slice(0,r).concat(t.slice(r+1)),r--);return t}isInSet(t){for(let r=0;r<t.length;r++)if(t[r].type==this)return t[r]}checkAttrs(t){Ice(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class zce{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let a in t)r[a]=t[a];r.nodes=ti.from(t.nodes),r.marks=ti.from(t.marks||{}),this.nodes=XY.compile(this.spec.nodes,this),this.marks=Kj.compile(this.spec.marks,this);let n=Object.create(null);for(let a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");let i=this.nodes[a],s=i.spec.content||"",l=i.spec.marks;if(i.contentMatch=n[s]||(n[s]=Nh.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=l=="_"?null:l?eQ(this,l.split(" ")):l==""||!i.inlineContent?[]:null}for(let a in this.marks){let i=this.marks[a],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:eQ(this,s.split(" "))}this.nodeFromJSON=a=>Nd.fromJSON(this,a),this.markFromJSON=a=>hn.fromJSON(this,a),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,r=null,n,a){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof XY){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(r,n,a)}text(t,r){let n=this.nodes.text;return new lN(n,n.defaultAttrs,t,hn.setFrom(r))}mark(t,r){return typeof t=="string"&&(t=this.marks[t]),t.create(r)}nodeType(t){let r=this.nodes[t];if(!r)throw new RangeError("Unknown node type: "+t);return r}}function eQ(e,t){let r=[];for(let n=0;n<t.length;n++){let a=t[n],i=e.marks[a],s=i;if(i)r.push(i);else for(let l in e.marks){let c=e.marks[l];(a=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(a)>-1)&&r.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return r}function fze(e){return e.tag!=null}function hze(e){return e.style!=null}class Cd{constructor(t,r){this.schema=t,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(a=>{if(fze(a))this.tags.push(a);else if(hze(a)){let i=/[^=]*/.exec(a.style)[0];n.indexOf(i)<0&&n.push(i),this.styles.push(a)}}),this.normalizeLists=!this.tags.some(a=>{if(!/^(ul|ol)\b/.test(a.tag)||!a.node)return!1;let i=t.nodes[a.node];return i.contentMatch.matchType(i)})}parse(t,r={}){let n=new rQ(this,r,!1);return n.addAll(t,hn.none,r.from,r.to),n.finish()}parseSlice(t,r={}){let n=new rQ(this,r,!0);return n.addAll(t,hn.none,r.from,r.to),pt.maxOpen(n.finish())}matchTag(t,r,n){for(let a=n?this.tags.indexOf(n)+1:0;a<this.tags.length;a++){let i=this.tags[a];if(gze(t,i.tag)&&(i.namespace===void 0||t.namespaceURI==i.namespace)&&(!i.context||r.matchesContext(i.context))){if(i.getAttrs){let s=i.getAttrs(t);if(s===!1)continue;i.attrs=s||void 0}return i}}}matchStyle(t,r,n,a){for(let i=a?this.styles.indexOf(a)+1:0;i<this.styles.length;i++){let s=this.styles[i],l=s.style;if(!(l.indexOf(t)!=0||s.context&&!n.matchesContext(s.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=r))){if(s.getAttrs){let c=s.getAttrs(r);if(c===!1)continue;s.attrs=c||void 0}return s}}}static schemaRules(t){let r=[];function n(a){let i=a.priority==null?50:a.priority,s=0;for(;s<r.length;s++){let l=r[s];if((l.priority==null?50:l.priority)<i)break}r.splice(s,0,a)}for(let a in t.marks){let i=t.marks[a].spec.parseDOM;i&&i.forEach(s=>{n(s=nQ(s)),s.mark||s.ignore||s.clearMark||(s.mark=a)})}for(let a in t.nodes){let i=t.nodes[a].spec.parseDOM;i&&i.forEach(s=>{n(s=nQ(s)),s.node||s.ignore||s.mark||(s.node=a)})}return r}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Cd(t,Cd.schemaRules(t)))}}const Bce={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},mze={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},$ce={ol:!0,ul:!0},Wy=1,mR=2,Rb=4;function tQ(e,t,r){return t!=null?(t?Wy:0)|(t==="full"?mR:0):e&&e.whitespace=="pre"?Wy|mR:r&~Rb}class lS{constructor(t,r,n,a,i,s){this.type=t,this.attrs=r,this.marks=n,this.solid=a,this.options=s,this.content=[],this.activeMarks=hn.none,this.match=i||(s&Rb?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ge.from(t));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,a;return(a=n.findWrapping(t.type))?(this.match=n,a):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Wy)){let n=this.content[this.content.length-1],a;if(n&&n.isText&&(a=/[ \t\r\n\u000c]+$/.exec(n.text))){let i=n;n.text.length==a[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-a[0].length))}}let r=Ge.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Ge.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Bce.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class rQ{constructor(t,r,n){this.parser=t,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let a=r.topNode,i,s=tQ(null,r.preserveWhitespace,0)|(n?Rb:0);a?i=new lS(a.type,a.attrs,hn.none,!0,r.topMatch||a.type.contentMatch,s):n?i=new lS(null,null,hn.none,!0,null,s):i=new lS(t.schema.topNodeType,null,hn.none,!0,null,s),this.nodes=[i],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,r){t.nodeType==3?this.addTextNode(t,r):t.nodeType==1&&this.addElement(t,r)}addTextNode(t,r){let n=t.nodeValue,a=this.top,i=a.options&mR?"full":this.localPreserveWS||(a.options&Wy)>0,{schema:s}=this.parser;if(i==="full"||a.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(i)if(i==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let l=n.split(/\r?\n|\r/);for(let c=0;c<l.length;c++)c&&this.insertNode(s.linebreakReplacement.create(),r,!0),l[c]&&this.insertNode(s.text(l[c]),r,!/\S/.test(l[c]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let l=a.content[a.content.length-1],c=t.previousSibling;(!l||c&&c.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),r,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,r,n){let a=this.localPreserveWS,i=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let s=t.nodeName.toLowerCase(),l;$ce.hasOwnProperty(s)&&this.parser.normalizeLists&&pze(t);let c=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,n));e:if(c?c.ignore:mze.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,r);else if(!c||c.skip||c.closeParent){c&&c.closeParent?this.open=Math.max(0,this.open-1):c&&c.skip.nodeType&&(t=c.skip);let u,d=this.needsBlock;if(Bce.hasOwnProperty(s))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),u=!0,i.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,r);break e}let f=c&&c.skip?r:this.readStyles(t,r);f&&this.addAll(t,f),u&&this.sync(i),this.needsBlock=d}else{let u=this.readStyles(t,r);u&&this.addElementByRule(t,c,u,c.consuming===!1?l:void 0)}this.localPreserveWS=a}leafFallback(t,r){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),r)}ignoreFallback(t,r){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(t,r){let n=t.style;if(n&&n.length)for(let a=0;a<this.parser.matchedStyles.length;a++){let i=this.parser.matchedStyles[a],s=n.getPropertyValue(i);if(s)for(let l=void 0;;){let c=this.parser.matchStyle(i,s,this,l);if(!c)break;if(c.ignore)return null;if(c.clearMark?r=r.filter(u=>!c.clearMark(u)):r=r.concat(this.parser.schema.marks[c.mark].create(c.attrs)),c.consuming===!1)l=c;else break}}return r}addElementByRule(t,r,n,a){let i,s;if(r.node)if(s=this.parser.schema.nodes[r.node],s.isLeaf)this.insertNode(s.create(r.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let c=this.enter(s,r.attrs||null,n,r.preserveWhitespace);c&&(i=!0,n=c)}else{let c=this.parser.schema.marks[r.mark];n=n.concat(c.create(r.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(t);else if(a)this.addElement(t,n,a);else if(r.getContent)this.findInside(t),r.getContent(t,this.parser.schema).forEach(c=>this.insertNode(c,n,!1));else{let c=t;typeof r.contentElement=="string"?c=t.querySelector(r.contentElement):typeof r.contentElement=="function"?c=r.contentElement(t):r.contentElement&&(c=r.contentElement),this.findAround(t,c,!0),this.addAll(c,n),this.findAround(t,c,!1)}i&&this.sync(l)&&this.open--}addAll(t,r,n,a){let i=n||0;for(let s=n?t.childNodes[n]:t.firstChild,l=a==null?null:t.childNodes[a];s!=l;s=s.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(s,r);this.findAtPoint(t,i)}findPlace(t,r,n){let a,i;for(let s=this.open,l=0;s>=0;s--){let c=this.nodes[s],u=c.findWrapping(t);if(u&&(!a||a.length>u.length+l)&&(a=u,i=c,!u.length))break;if(c.solid){if(n)break;l+=2}}if(!a)return null;this.sync(i);for(let s=0;s<a.length;s++)r=this.enterInner(a[s],null,r,!1);return r}insertNode(t,r,n){if(t.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(r=this.enterInner(i,null,r))}let a=this.findPlace(t,r,n);if(a){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(t.type));let s=hn.none;for(let l of a.concat(t.marks))(i.type?i.type.allowsMarkType(l.type):aQ(l.type,t.type))&&(s=l.addToSet(s));return i.content.push(t.mark(s)),!0}return!1}enter(t,r,n,a){let i=this.findPlace(t.create(r),n,!1);return i&&(i=this.enterInner(t,r,n,!0,a)),i}enterInner(t,r,n,a=!1,i){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(t);let l=tQ(t,i,s.options);s.options&Rb&&s.content.length==0&&(l|=Rb);let c=hn.none;return n=n.filter(u=>(s.type?s.type.allowsMarkType(u.type):aQ(u.type,t))?(c=u.addToSet(c),!1):!0),this.nodes.push(new lS(t,r,c,a,null,l)),this.open++,n}closeExtra(t=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let r=this.open;r>=0;r--){if(this.nodes[r]==t)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=Wy)}return!1}get currentPos(){this.closeExtra();let t=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let a=n.length-1;a>=0;a--)t+=n[a].nodeSize;r&&t++}return t}findAtPoint(t,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&t.nodeType==1&&t.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(t,r,n){if(t!=r&&this.find)for(let a=0;a<this.find.length;a++)this.find[a].pos==null&&t.nodeType==1&&t.contains(this.find[a].node)&&r.compareDocumentPosition(this.find[a].node)&(n?2:4)&&(this.find[a].pos=this.currentPos)}findInText(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&(this.find[r].pos=this.currentPos-(t.nodeValue.length-this.find[r].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let r=t.split("/"),n=this.options.context,a=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),i=-(n?n.depth+1:0)+(a?0:1),s=(l,c)=>{for(;l>=0;l--){let u=r[l];if(u==""){if(l==r.length-1||l==0)continue;for(;c>=i;c--)if(s(l-1,c))return!0;return!1}else{let d=c>0||c==0&&a?this.nodes[c].type:n&&c>=i?n.node(c-i).type:null;if(!d||d.name!=u&&!d.isInGroup(u))return!1;c--}}return!0};return s(r.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let r=t.depth;r>=0;r--){let n=t.node(r).contentMatchAt(t.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function pze(e){for(let t=e.firstChild,r=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&$ce.hasOwnProperty(n)&&r?(r.appendChild(t),t=r):n=="li"?r=t:n&&(r=null)}}function gze(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function nQ(e){let t={};for(let r in e)t[r]=e[r];return t}function aQ(e,t){let r=t.schema.nodes;for(let n in r){let a=r[n];if(!a.allowsMarkType(e))continue;let i=[],s=l=>{i.push(l);for(let c=0;c<l.edgeCount;c++){let{type:u,next:d}=l.edge(c);if(u==t||i.indexOf(d)<0&&s(d))return!0}};if(s(a.contentMatch))return!0}}class Zh{constructor(t,r){this.nodes=t,this.marks=r}serializeFragment(t,r={},n){n||(n=_D(r).createDocumentFragment());let a=n,i=[];return t.forEach(s=>{if(i.length||s.marks.length){let l=0,c=0;for(;l<i.length&&c<s.marks.length;){let u=s.marks[c];if(!this.marks[u.type.name]){c++;continue}if(!u.eq(i[l][0])||u.type.spec.spanning===!1)break;l++,c++}for(;l<i.length;)a=i.pop()[1];for(;c<s.marks.length;){let u=s.marks[c++],d=this.serializeMark(u,s.isInline,r);d&&(i.push([u,a]),a.appendChild(d.dom),a=d.contentDOM||d.dom)}}a.appendChild(this.serializeNodeInner(s,r))}),n}serializeNodeInner(t,r){let{dom:n,contentDOM:a}=vk(_D(r),this.nodes[t.type.name](t),null,t.attrs);if(a){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,r,a)}return n}serializeNode(t,r={}){let n=this.serializeNodeInner(t,r);for(let a=t.marks.length-1;a>=0;a--){let i=this.serializeMark(t.marks[a],t.isInline,r);i&&((i.contentDOM||i.dom).appendChild(n),n=i.dom)}return n}serializeMark(t,r,n={}){let a=this.marks[t.type.name];return a&&vk(_D(n),a(t,r),null,t.attrs)}static renderSpec(t,r,n=null,a){return vk(t,r,n,a)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new Zh(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let r=iQ(t.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(t){return iQ(t.marks)}}function iQ(e){let t={};for(let r in e){let n=e[r].spec.toDOM;n&&(t[r]=n)}return t}function _D(e){return e.document||window.document}const sQ=new WeakMap;function vze(e){let t=sQ.get(e);return t===void 0&&sQ.set(e,t=bze(e)),t}function bze(e){let t=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let a=0;a<n.length;a++)r(n[a]);else for(let a in n)r(n[a])}return r(e),t}function vk(e,t,r,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let a=t[0],i;if(typeof a!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(i=vze(n))&&i.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=a.indexOf(" ");s>0&&(r=a.slice(0,s),a=a.slice(s+1));let l,c=r?e.createElementNS(r,a):e.createElement(a),u=t[1],d=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){d=2;for(let f in u)if(u[f]!=null){let m=f.indexOf(" ");m>0?c.setAttributeNS(f.slice(0,m),f.slice(m+1),u[f]):f=="style"&&c.style?c.style.cssText=u[f]:c.setAttribute(f,u[f])}}for(let f=d;f<t.length;f++){let m=t[f];if(m===0){if(f<t.length-1||f>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:p,contentDOM:v}=vk(e,m,r,n);if(c.appendChild(p),v){if(l)throw new RangeError("Multiple content holes");l=v}}}return{dom:c,contentDOM:l}}const Fce=65535,Uce=Math.pow(2,16);function yze(e,t){return e+t*Uce}function oQ(e){return e&Fce}function xze(e){return(e-(e&Fce))/Uce}const Hce=1,qce=2,bk=4,Wce=8;class pR{constructor(t,r,n){this.pos=t,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&Wce)>0}get deletedBefore(){return(this.delInfo&(Hce|bk))>0}get deletedAfter(){return(this.delInfo&(qce|bk))>0}get deletedAcross(){return(this.delInfo&bk)>0}}class Ms{constructor(t,r=!1){if(this.ranges=t,this.inverted=r,!t.length&&Ms.empty)return Ms.empty}recover(t){let r=0,n=oQ(t);if(!this.inverted)for(let a=0;a<n;a++)r+=this.ranges[a*3+2]-this.ranges[a*3+1];return this.ranges[n*3]+r+xze(t)}mapResult(t,r=1){return this._map(t,r,!1)}map(t,r=1){return this._map(t,r,!0)}_map(t,r,n){let a=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?a:0);if(c>t)break;let u=this.ranges[l+i],d=this.ranges[l+s],f=c+u;if(t<=f){let m=u?t==c?-1:t==f?1:r:r,p=c+a+(m<0?0:d);if(n)return p;let v=t==(r<0?c:f)?null:yze(l/3,t-c),b=t==c?qce:t==f?Hce:bk;return(r<0?t!=c:t!=f)&&(b|=Wce),new pR(p,b,v)}a+=d-u}return n?t+a:new pR(t+a,0,null)}touches(t,r){let n=0,a=oQ(r),i=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?n:0);if(c>t)break;let u=this.ranges[l+i],d=c+u;if(t<=d&&l==a*3)return!0;n+=this.ranges[l+s]-u}return!1}forEach(t){let r=this.inverted?2:1,n=this.inverted?1:2;for(let a=0,i=0;a<this.ranges.length;a+=3){let s=this.ranges[a],l=s-(this.inverted?i:0),c=s+(this.inverted?0:i),u=this.ranges[a+r],d=this.ranges[a+n];t(l,l+u,c,c+d),i+=d-u}}invert(){return new Ms(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Ms.empty:new Ms(t<0?[0,-t,0]:[0,0,t])}}Ms.empty=new Ms([]);class Ky{constructor(t,r,n=0,a=t?t.length:0){this.mirror=r,this.from=n,this.to=a,this._maps=t||[],this.ownData=!(t||r)}get maps(){return this._maps}slice(t=0,r=this.maps.length){return new Ky(this._maps,this.mirror,t,r)}appendMap(t,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(t){for(let r=0,n=this._maps.length;r<t._maps.length;r++){let a=t.getMirror(r);this.appendMap(t._maps[r],a!=null&&a<r?n+a:void 0)}}getMirror(t){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==t)return this.mirror[r+(r%2?-1:1)]}}setMirror(t,r){this.mirror||(this.mirror=[]),this.mirror.push(t,r)}appendMappingInverted(t){for(let r=t.maps.length-1,n=this._maps.length+t._maps.length;r>=0;r--){let a=t.getMirror(r);this.appendMap(t._maps[r].invert(),a!=null&&a>r?n-a-1:void 0)}}invert(){let t=new Ky;return t.appendMappingInverted(this),t}map(t,r=1){if(this.mirror)return this._map(t,r,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,r);return t}mapResult(t,r=1){return this._map(t,r,!1)}_map(t,r,n){let a=0;for(let i=this.from;i<this.to;i++){let s=this._maps[i],l=s.mapResult(t,r);if(l.recover!=null){let c=this.getMirror(i);if(c!=null&&c>i&&c<this.to){i=c,t=this._maps[c].recover(l.recover);continue}}a|=l.delInfo,t=l.pos}return n?t:new pR(t,a,null)}}const ND=Object.create(null);class xi{getMap(){return Ms.empty}merge(t){return null}static fromJSON(t,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=ND[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in ND)throw new RangeError("Duplicate use of step JSON ID "+t);return ND[t]=r,r.prototype.jsonID=t,r}}class pa{constructor(t,r){this.doc=t,this.failed=r}static ok(t){return new pa(t,null)}static fail(t){return new pa(null,t)}static fromReplace(t,r,n,a){try{return pa.ok(t.replace(r,n,a))}catch(i){if(i instanceof iN)return pa.fail(i.message);throw i}}}function Xz(e,t,r){let n=[];for(let a=0;a<e.childCount;a++){let i=e.child(a);i.content.size&&(i=i.copy(Xz(i.content,t,i))),i.isInline&&(i=t(i,r,a)),n.push(i)}return Ge.fromArray(n)}class bd extends xi{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=t.resolve(this.from),a=n.node(n.sharedDepth(this.to)),i=new pt(Xz(r.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),a),r.openStart,r.openEnd);return pa.fromReplace(t,this.from,this.to,i)}invert(){return new Wo(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new bd(r.pos,n.pos,this.mark)}merge(t){return t instanceof bd&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new bd(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new bd(r.from,r.to,t.markFromJSON(r.mark))}}xi.jsonID("addMark",bd);class Wo extends xi{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=new pt(Xz(r.content,a=>a.mark(this.mark.removeFromSet(a.marks)),t),r.openStart,r.openEnd);return pa.fromReplace(t,this.from,this.to,n)}invert(){return new bd(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Wo(r.pos,n.pos,this.mark)}merge(t){return t instanceof Wo&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Wo(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Wo(r.from,r.to,t.markFromJSON(r.mark))}}xi.jsonID("removeMark",Wo);class yd extends xi{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return pa.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return pa.fromReplace(t,this.pos,this.pos+1,new pt(Ge.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let a=0;a<r.marks.length;a++)if(!r.marks[a].isInSet(n))return new yd(this.pos,r.marks[a]);return new yd(this.pos,this.mark)}}return new Ch(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new yd(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new yd(r.pos,t.markFromJSON(r.mark))}}xi.jsonID("addNodeMark",yd);class Ch extends xi{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return pa.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return pa.fromReplace(t,this.pos,this.pos+1,new pt(Ge.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new yd(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new Ch(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ch(r.pos,t.markFromJSON(r.mark))}}xi.jsonID("removeNodeMark",Ch);class Fa extends xi{constructor(t,r,n,a=!1){super(),this.from=t,this.to=r,this.slice=n,this.structure=a}apply(t){return this.structure&&gR(t,this.from,this.to)?pa.fail("Structure replace would overwrite content"):pa.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Ms([this.from,this.to-this.from,this.slice.size])}invert(t){return new Fa(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new Fa(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof Fa)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let r=this.slice.size+t.slice.size==0?pt.empty:new pt(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Fa(this.from,this.to+(t.to-t.from),r,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let r=this.slice.size+t.slice.size==0?pt.empty:new pt(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Fa(t.from,this.to,r,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Fa(r.from,r.to,pt.fromJSON(t,r.slice),!!r.structure)}}xi.jsonID("replace",Fa);class Ha extends xi{constructor(t,r,n,a,i,s,l=!1){super(),this.from=t,this.to=r,this.gapFrom=n,this.gapTo=a,this.slice=i,this.insert=s,this.structure=l}apply(t){if(this.structure&&(gR(t,this.from,this.gapFrom)||gR(t,this.gapTo,this.to)))return pa.fail("Structure gap-replace would overwrite content");let r=t.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return pa.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?pa.fromReplace(t,this.from,this.to,n):pa.fail("Content does not fit in gap")}getMap(){return new Ms([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let r=this.gapTo-this.gapFrom;return new Ha(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),a=this.from==this.gapFrom?r.pos:t.map(this.gapFrom,-1),i=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||a<r.pos||i>n.pos?null:new Ha(r.pos,n.pos,a,i,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ha(r.from,r.to,r.gapFrom,r.gapTo,pt.fromJSON(t,r.slice),r.insert,!!r.structure)}}xi.jsonID("replaceAround",Ha);function gR(e,t,r){let n=e.resolve(t),a=r-t,i=n.depth;for(;a>0&&i>0&&n.indexAfter(i)==n.node(i).childCount;)i--,a--;if(a>0){let s=n.node(i).maybeChild(n.indexAfter(i));for(;a>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,a--}}return!1}function wze(e,t,r,n){let a=[],i=[],s,l;e.doc.nodesBetween(t,r,(c,u,d)=>{if(!c.isInline)return;let f=c.marks;if(!n.isInSet(f)&&d.type.allowsMarkType(n.type)){let m=Math.max(u,t),p=Math.min(u+c.nodeSize,r),v=n.addToSet(f);for(let b=0;b<f.length;b++)f[b].isInSet(v)||(s&&s.to==m&&s.mark.eq(f[b])?s.to=p:a.push(s=new Wo(m,p,f[b])));l&&l.to==m?l.to=p:i.push(l=new bd(m,p,n))}}),a.forEach(c=>e.step(c)),i.forEach(c=>e.step(c))}function Sze(e,t,r,n){let a=[],i=0;e.doc.nodesBetween(t,r,(s,l)=>{if(!s.isInline)return;i++;let c=null;if(n instanceof Kj){let u=s.marks,d;for(;d=n.isInSet(u);)(c||(c=[])).push(d),u=d.removeFromSet(u)}else n?n.isInSet(s.marks)&&(c=[n]):c=s.marks;if(c&&c.length){let u=Math.min(l+s.nodeSize,r);for(let d=0;d<c.length;d++){let f=c[d],m;for(let p=0;p<a.length;p++){let v=a[p];v.step==i-1&&f.eq(a[p].style)&&(m=v)}m?(m.to=u,m.step=i):a.push({style:f,from:Math.max(l,t),to:u,step:i})}}}),a.forEach(s=>e.step(new Wo(s.from,s.to,s.style)))}function e9(e,t,r,n=r.contentMatch,a=!0){let i=e.doc.nodeAt(t),s=[],l=t+1;for(let c=0;c<i.childCount;c++){let u=i.child(c),d=l+u.nodeSize,f=n.matchType(u.type);if(!f)s.push(new Fa(l,d,pt.empty));else{n=f;for(let m=0;m<u.marks.length;m++)r.allowsMarkType(u.marks[m].type)||e.step(new Wo(l,d,u.marks[m]));if(a&&u.isText&&r.whitespace!="pre"){let m,p=/\r?\n|\r/g,v;for(;m=p.exec(u.text);)v||(v=new pt(Ge.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),s.push(new Fa(l+m.index,l+m.index+m[0].length,v))}}l=d}if(!n.validEnd){let c=n.fillBefore(Ge.empty,!0);e.replace(l,l,new pt(c,0,0))}for(let c=s.length-1;c>=0;c--)e.step(s[c])}function kze(e,t,r){return(t==0||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function h0(e){let r=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,a=0,i=0;;--n){let s=e.$from.node(n),l=e.$from.index(n)+a,c=e.$to.indexAfter(n)-i;if(n<e.depth&&s.canReplace(l,c,r))return n;if(n==0||s.type.spec.isolating||!kze(s,l,c))break;l&&(a=1),c<s.childCount&&(i=1)}return null}function _ze(e,t,r){let{$from:n,$to:a,depth:i}=t,s=n.before(i+1),l=a.after(i+1),c=s,u=l,d=Ge.empty,f=0;for(let v=i,b=!1;v>r;v--)b||n.index(v)>0?(b=!0,d=Ge.from(n.node(v).copy(d)),f++):c--;let m=Ge.empty,p=0;for(let v=i,b=!1;v>r;v--)b||a.after(v+1)<a.end(v)?(b=!0,m=Ge.from(a.node(v).copy(m)),p++):u++;e.step(new Ha(c,u,s,l,new pt(d.append(m),f,p),d.size-f,!0))}function t9(e,t,r=null,n=e){let a=Nze(e,t),i=a&&Cze(n,t);return i?a.map(lQ).concat({type:t,attrs:r}).concat(i.map(lQ)):null}function lQ(e){return{type:e,attrs:null}}function Nze(e,t){let{parent:r,startIndex:n,endIndex:a}=e,i=r.contentMatchAt(n).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return r.canReplaceWith(n,a,s)?i:null}function Cze(e,t){let{parent:r,startIndex:n,endIndex:a}=e,i=r.child(n),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let c=(s.length?s[s.length-1]:t).contentMatch;for(let u=n;c&&u<a;u++)c=c.matchType(r.child(u).type);return!c||!c.validEnd?null:s}function jze(e,t,r){let n=Ge.empty;for(let s=r.length-1;s>=0;s--){if(n.size){let l=r[s].type.contentMatch.matchFragment(n);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ge.from(r[s].type.create(r[s].attrs,n))}let a=t.start,i=t.end;e.step(new Ha(a,i,a,i,new pt(n,0,0),r.length,!0))}function Eze(e,t,r,n,a){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,r,(s,l)=>{let c=typeof a=="function"?a(s):a;if(s.isTextblock&&!s.hasMarkup(n,c)&&Mze(e.doc,e.mapping.slice(i).map(l),n)){let u=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!v?u=!1:!p&&v&&(u=!0)}u===!1&&Gce(e,s,l,i),e9(e,e.mapping.slice(i).map(l,1),n,void 0,u===null);let d=e.mapping.slice(i),f=d.map(l,1),m=d.map(l+s.nodeSize,1);return e.step(new Ha(f,m,f+1,m-1,new pt(Ge.from(n.create(c,null,s.marks)),0,0),1,!0)),u===!0&&Kce(e,s,l,i),!1}})}function Kce(e,t,r,n){t.forEach((a,i)=>{if(a.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(a.text);){let c=e.mapping.slice(n).map(r+1+i+s.index);e.replaceWith(c,c+1,t.type.schema.linebreakReplacement.create())}}})}function Gce(e,t,r,n){t.forEach((a,i)=>{if(a.type==a.type.schema.linebreakReplacement){let s=e.mapping.slice(n).map(r+1+i);e.replaceWith(s,s+1,t.type.schema.text(`
`))}})}function Mze(e,t,r){let n=e.resolve(t),a=n.index();return n.parent.canReplaceWith(a,a+1,r)}function Tze(e,t,r,n,a){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");r||(r=i.type);let s=r.create(n,null,a||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,s);if(!r.validContent(i.content))throw new RangeError("Invalid content for node type "+r.name);e.step(new Ha(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new pt(Ge.from(s),0,0),1,!0))}function Xc(e,t,r=1,n){let a=e.resolve(t),i=a.depth-r,s=n&&n[n.length-1]||a.parent;if(i<0||a.parent.type.spec.isolating||!a.parent.canReplace(a.index(),a.parent.childCount)||!s.type.validContent(a.parent.content.cutByIndex(a.index(),a.parent.childCount)))return!1;for(let u=a.depth-1,d=r-2;u>i;u--,d--){let f=a.node(u),m=a.index(u);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(m,f.childCount),v=n&&n[d+1];v&&(p=p.replaceChild(0,v.type.create(v.attrs)));let b=n&&n[d]||f;if(!f.canReplace(m+1,f.childCount)||!b.type.validContent(p))return!1}let l=a.indexAfter(i),c=n&&n[0];return a.node(i).canReplaceWith(l,l,c?c.type:a.node(i+1).type)}function Aze(e,t,r=1,n){let a=e.doc.resolve(t),i=Ge.empty,s=Ge.empty;for(let l=a.depth,c=a.depth-r,u=r-1;l>c;l--,u--){i=Ge.from(a.node(l).copy(i));let d=n&&n[u];s=Ge.from(d?d.type.create(d.attrs,s):a.node(l).copy(s))}e.step(new Fa(t,t,new pt(i.append(s),r,r),!0))}function qd(e,t){let r=e.resolve(t),n=r.index();return Vce(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function Dze(e,t){t.content.size||e.type.compatibleContent(t.type);let r=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let a=0;a<t.childCount;a++){let i=t.child(a),s=i.type==n?e.type.schema.nodes.text:i.type;if(r=r.matchType(s),!r||!e.type.allowsMarks(i.marks))return!1}return r.validEnd}function Vce(e,t){return!!(e&&t&&!e.isLeaf&&Dze(e,t))}function Gj(e,t,r=-1){let n=e.resolve(t);for(let a=n.depth;;a--){let i,s,l=n.index(a);if(a==n.depth?(i=n.nodeBefore,s=n.nodeAfter):r>0?(i=n.node(a+1),l++,s=n.node(a).maybeChild(l)):(i=n.node(a).maybeChild(l-1),s=n.node(a+1)),i&&!i.isTextblock&&Vce(i,s)&&n.node(a).canReplace(l,l+1))return t;if(a==0)break;t=r<0?n.before(a):n.after(a)}}function Lze(e,t,r){let n=null,{linebreakReplacement:a}=e.doc.type.schema,i=e.doc.resolve(t-r),s=i.node().type;if(a&&s.inlineContent){let d=s.whitespace=="pre",f=!!s.contentMatch.matchType(a);d&&!f?n=!1:!d&&f&&(n=!0)}let l=e.steps.length;if(n===!1){let d=e.doc.resolve(t+r);Gce(e,d.node(),d.before(),l)}s.inlineContent&&e9(e,t+r-1,s,i.node().contentMatchAt(i.index()),n==null);let c=e.mapping.slice(l),u=c.map(t-r);if(e.step(new Fa(u,c.map(t+r,-1),pt.empty,!0)),n===!0){let d=e.doc.resolve(u);Kce(e,d.node(),d.before(),e.steps.length)}return e}function Oze(e,t,r){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(n.parentOffset==0)for(let a=n.depth-1;a>=0;a--){let i=n.index(a);if(n.node(a).canReplaceWith(i,i,r))return n.before(a+1);if(i>0)return null}if(n.parentOffset==n.parent.content.size)for(let a=n.depth-1;a>=0;a--){let i=n.indexAfter(a);if(n.node(a).canReplaceWith(i,i,r))return n.after(a+1);if(i<n.node(a).childCount)return null}return null}function Yce(e,t,r){let n=e.resolve(t);if(!r.content.size)return t;let a=r.content;for(let i=0;i<r.openStart;i++)a=a.firstChild.content;for(let i=1;i<=(r.openStart==0&&r.size?2:1);i++)for(let s=n.depth;s>=0;s--){let l=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,c=n.index(s)+(l>0?1:0),u=n.node(s),d=!1;if(i==1)d=u.canReplace(c,c,a);else{let f=u.contentMatchAt(c).findWrapping(a.firstChild.type);d=f&&u.canReplaceWith(c,c,f[0])}if(d)return l==0?n.pos:l<0?n.before(s+1):n.after(s+1)}return null}function Vj(e,t,r=t,n=pt.empty){if(t==r&&!n.size)return null;let a=e.resolve(t),i=e.resolve(r);return Qce(a,i,n)?new Fa(t,r,n):new Ize(a,i,n).fit()}function Qce(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}class Ize{constructor(t,r,n){this.$from=t,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ge.empty;for(let a=0;a<=t.depth;a++){let i=t.node(a);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(a))})}for(let a=t.depth;a>0;a--)this.placed=Ge.from(t.node(a).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,a=this.close(t<0?this.$to:n.doc.resolve(t));if(!a)return null;let i=this.placed,s=n.depth,l=a.depth;for(;s&&l&&i.childCount==1;)i=i.firstChild.content,s--,l--;let c=new pt(i,s,l);return t>-1?new Ha(n.pos,t,this.$to.pos,this.$to.end(),c,r):c.size||n.pos!=this.$to.pos?new Fa(n.pos,a.pos,c):null}findFittable(){let t=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,a=this.unplaced.openEnd;n<t;n++){let i=r.firstChild;if(r.childCount>1&&(a=0),i.type.spec.isolating&&a<=n){t=n;break}r=i.content}for(let r=1;r<=2;r++)for(let n=r==1?t:this.unplaced.openStart;n>=0;n--){let a,i=null;n?(i=CD(this.unplaced.content,n-1).firstChild,a=i.content):a=this.unplaced.content;let s=a.firstChild;for(let l=this.depth;l>=0;l--){let{type:c,match:u}=this.frontier[l],d,f=null;if(r==1&&(s?u.matchType(s.type)||(f=u.fillBefore(Ge.from(s),!1)):i&&c.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:l,parent:i,inject:f};if(r==2&&s&&(d=u.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:l,parent:i,wrap:d};if(i&&u.matchType(i.type))break}}}openMore(){let{content:t,openStart:r,openEnd:n}=this.unplaced,a=CD(t,r);return!a.childCount||a.firstChild.isLeaf?!1:(this.unplaced=new pt(t,r+1,Math.max(n,a.size+r>=t.size-n?r+1:0)),!0)}dropNode(){let{content:t,openStart:r,openEnd:n}=this.unplaced,a=CD(t,r);if(a.childCount<=1&&r>0){let i=t.size-r<=r+a.size;this.unplaced=new pt(fb(t,r-1,1),r-1,i?r-1:n)}else this.unplaced=new pt(fb(t,r,1),r,n)}placeNodes({sliceDepth:t,frontierDepth:r,parent:n,inject:a,wrap:i}){for(;this.depth>r;)this.closeFrontierNode();if(i)for(let b=0;b<i.length;b++)this.openFrontierNode(i[b]);let s=this.unplaced,l=n?n.content:s.content,c=s.openStart-t,u=0,d=[],{match:f,type:m}=this.frontier[r];if(a){for(let b=0;b<a.childCount;b++)d.push(a.child(b));f=f.matchFragment(a)}let p=l.size+t-(s.content.size-s.openEnd);for(;u<l.childCount;){let b=l.child(u),y=f.matchType(b.type);if(!y)break;u++,(u>1||c==0||b.content.size)&&(f=y,d.push(Jce(b.mark(m.allowedMarks(b.marks)),u==1?c:0,u==l.childCount?p:-1)))}let v=u==l.childCount;v||(p=-1),this.placed=hb(this.placed,r,Ge.from(d)),this.frontier[r].match=f,v&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let b=0,y=l;b<p;b++){let S=y.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),y=S.content}this.unplaced=v?t==0?pt.empty:new pt(fb(s.content,t-1,1),t-1,p<0?s.openEnd:t-1):new pt(fb(s.content,t,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],r;if(!t.type.isTextblock||!jD(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,a=this.$to.after(n);for(;n>1&&a==this.$to.end(--n);)++a;return a}findCloseLevel(t){e:for(let r=Math.min(this.depth,t.depth);r>=0;r--){let{match:n,type:a}=this.frontier[r],i=r<t.depth&&t.end(r+1)==t.pos+(t.depth-(r+1)),s=jD(t,r,a,n,i);if(s){for(let l=r-1;l>=0;l--){let{match:c,type:u}=this.frontier[l],d=jD(t,l,u,c,!0);if(!d||d.childCount)continue e}return{depth:r,fit:s,move:i?t.doc.resolve(t.after(r+1)):t}}}}close(t){let r=this.findCloseLevel(t);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=hb(this.placed,r.depth,r.fit)),t=r.move;for(let n=r.depth+1;n<=t.depth;n++){let a=t.node(n),i=a.type.contentMatch.fillBefore(a.content,!0,t.index(n));this.openFrontierNode(a.type,a.attrs,i)}return t}openFrontierNode(t,r=null,n){let a=this.frontier[this.depth];a.match=a.match.matchType(t),this.placed=hb(this.placed,this.depth,Ge.from(t.create(r,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ge.empty,!0);r.childCount&&(this.placed=hb(this.placed,this.frontier.length,r))}}function fb(e,t,r){return t==0?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(fb(e.firstChild.content,t-1,r)))}function hb(e,t,r){return t==0?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(hb(e.lastChild.content,t-1,r)))}function CD(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function Jce(e,t,r){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,Jce(n.firstChild,t-1,n.childCount==1?r-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(Ge.empty,!0)))),e.copy(n)}function jD(e,t,r,n,a){let i=e.node(t),s=a?e.indexAfter(t):e.index(t);if(s==i.childCount&&!r.compatibleContent(i.type))return null;let l=n.fillBefore(i.content,!0,s);return l&&!Rze(r,i.content,s)?l:null}function Rze(e,t,r){for(let n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function Pze(e){return e.spec.defining||e.spec.definingForContent}function zze(e,t,r,n){if(!n.size)return e.deleteRange(t,r);let a=e.doc.resolve(t),i=e.doc.resolve(r);if(Qce(a,i,n))return e.step(new Fa(t,r,n));let s=Xce(a,i);s[s.length-1]==0&&s.pop();let l=-(a.depth+1);s.unshift(l);for(let m=a.depth,p=a.pos-1;m>0;m--,p--){let v=a.node(m).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;s.indexOf(m)>-1?l=m:a.before(m)==p&&s.splice(1,0,-m)}let c=s.indexOf(l),u=[],d=n.openStart;for(let m=n.content,p=0;;p++){let v=m.firstChild;if(u.push(v),p==n.openStart)break;m=v.content}for(let m=d-1;m>=0;m--){let p=u[m],v=Pze(p.type);if(v&&!p.sameMarkup(a.node(Math.abs(l)-1)))d=m;else if(v||!p.type.isTextblock)break}for(let m=n.openStart;m>=0;m--){let p=(m+d+1)%(n.openStart+1),v=u[p];if(v)for(let b=0;b<s.length;b++){let y=s[(b+c)%s.length],S=!0;y<0&&(S=!1,y=-y);let _=a.node(y-1),N=a.index(y-1);if(_.canReplaceWith(N,N,v.type,v.marks))return e.replace(a.before(y),S?i.after(y):r,new pt(Zce(n.content,0,n.openStart,p),p,n.openEnd))}}let f=e.steps.length;for(let m=s.length-1;m>=0&&(e.replace(t,r,n),!(e.steps.length>f));m--){let p=s[m];p<0||(t=a.before(p),r=i.after(p))}}function Zce(e,t,r,n,a){if(t<r){let i=e.firstChild;e=e.replaceChild(0,i.copy(Zce(i.content,t+1,r,n,i)))}if(t>n){let i=a.contentMatchAt(0),s=i.fillBefore(e).append(e);e=s.append(i.matchFragment(s).fillBefore(Ge.empty,!0))}return e}function Bze(e,t,r,n){if(!n.isInline&&t==r&&e.doc.resolve(t).parent.content.size){let a=Oze(e.doc,t,n.type);a!=null&&(t=r=a)}e.replaceRange(t,r,new pt(Ge.from(n),0,0))}function $ze(e,t,r){let n=e.doc.resolve(t),a=e.doc.resolve(r),i=Xce(n,a);for(let s=0;s<i.length;s++){let l=i[s],c=s==i.length-1;if(c&&l==0||n.node(l).type.contentMatch.validEnd)return e.delete(n.start(l),a.end(l));if(l>0&&(c||n.node(l-1).canReplace(n.index(l-1),a.indexAfter(l-1))))return e.delete(n.before(l),a.after(l))}for(let s=1;s<=n.depth&&s<=a.depth;s++)if(t-n.start(s)==n.depth-s&&r>n.end(s)&&a.end(s)-r!=a.depth-s&&n.start(s-1)==a.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),a.index(s-1)))return e.delete(n.before(s),r);e.delete(t,r)}function Xce(e,t){let r=[],n=Math.min(e.depth,t.depth);for(let a=n;a>=0;a--){let i=e.start(a);if(i<e.pos-(e.depth-a)||t.end(a)>t.pos+(t.depth-a)||e.node(a).type.spec.isolating||t.node(a).type.spec.isolating)break;(i==t.start(a)||a==e.depth&&a==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&a&&t.start(a-1)==i-1)&&r.push(a)}return r}class Bp extends xi{constructor(t,r,n){super(),this.pos=t,this.attr=r,this.value=n}apply(t){let r=t.nodeAt(this.pos);if(!r)return pa.fail("No node at attribute step's position");let n=Object.create(null);for(let i in r.attrs)n[i]=r.attrs[i];n[this.attr]=this.value;let a=r.type.create(n,null,r.marks);return pa.fromReplace(t,this.pos,this.pos+1,new pt(Ge.from(a),0,r.isLeaf?0:1))}getMap(){return Ms.empty}invert(t){return new Bp(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new Bp(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Bp(r.pos,r.attr,r.value)}}xi.jsonID("attr",Bp);class Gy extends xi{constructor(t,r){super(),this.attr=t,this.value=r}apply(t){let r=Object.create(null);for(let a in t.attrs)r[a]=t.attrs[a];r[this.attr]=this.value;let n=t.type.create(r,t.content,t.marks);return pa.ok(n)}getMap(){return Ms.empty}invert(t){return new Gy(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Gy(r.attr,r.value)}}xi.jsonID("docAttr",Gy);let Sg=class extends Error{};Sg=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r};Sg.prototype=Object.create(Error.prototype);Sg.prototype.constructor=Sg;Sg.prototype.name="TransformError";let eue=class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Ky}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let r=this.maybeStep(t);if(r.failed)throw new Sg(r.failed);return this}maybeStep(t){let r=t.apply(this.doc);return r.failed||this.addStep(t,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let a=this.mapping.maps[n];n&&(t=a.map(t,1),r=a.map(r,-1)),a.forEach((i,s,l,c)=>{t=Math.min(t,l),r=Math.max(r,c)})}return t==1e9?null:{from:t,to:r}}addStep(t,r){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=r}replace(t,r=t,n=pt.empty){let a=Vj(this.doc,t,r,n);return a&&this.step(a),this}replaceWith(t,r,n){return this.replace(t,r,new pt(Ge.from(n),0,0))}delete(t,r){return this.replace(t,r,pt.empty)}insert(t,r){return this.replaceWith(t,t,r)}replaceRange(t,r,n){return zze(this,t,r,n),this}replaceRangeWith(t,r,n){return Bze(this,t,r,n),this}deleteRange(t,r){return $ze(this,t,r),this}lift(t,r){return _ze(this,t,r),this}join(t,r=1){return Lze(this,t,r),this}wrap(t,r){return jze(this,t,r),this}setBlockType(t,r=t,n,a=null){return Eze(this,t,r,n,a),this}setNodeMarkup(t,r,n=null,a){return Tze(this,t,r,n,a),this}setNodeAttribute(t,r,n){return this.step(new Bp(t,r,n)),this}setDocAttribute(t,r){return this.step(new Gy(t,r)),this}addNodeMark(t,r){return this.step(new yd(t,r)),this}removeNodeMark(t,r){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(r instanceof hn)r.isInSet(n.marks)&&this.step(new Ch(t,r));else{let a=n.marks,i,s=[];for(;i=r.isInSet(a);)s.push(new Ch(t,i)),a=i.removeFromSet(a);for(let l=s.length-1;l>=0;l--)this.step(s[l])}return this}split(t,r=1,n){return Aze(this,t,r,n),this}addMark(t,r,n){return wze(this,t,r,n),this}removeMark(t,r,n){return Sze(this,t,r,n),this}clearIncompatible(t,r,n){return e9(this,t,r,n),this}};const ED=Object.create(null);let lr=class{constructor(t,r,n){this.$anchor=t,this.$head=r,this.ranges=n||[new Fze(t.min(r),t.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let r=0;r<t.length;r++)if(t[r].$from.pos!=t[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,r=pt.empty){let n=r.content.lastChild,a=null;for(let l=0;l<r.openEnd;l++)a=n,n=n.lastChild;let i=t.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:c,$to:u}=s[l],d=t.mapping.slice(i);t.replaceRange(d.map(c.pos),d.map(u.pos),l?pt.empty:r),l==0&&dQ(t,i,(n?n.isInline:a&&a.isTextblock)?-1:1)}}replaceWith(t,r){let n=t.steps.length,a=this.ranges;for(let i=0;i<a.length;i++){let{$from:s,$to:l}=a[i],c=t.mapping.slice(n),u=c.map(s.pos),d=c.map(l.pos);i?t.deleteRange(u,d):(t.replaceRangeWith(u,d,r),dQ(t,n,r.isInline?-1:1))}}static findFrom(t,r,n=!1){let a=t.parent.inlineContent?new Yt(t):gp(t.node(0),t.parent,t.pos,t.index(),r,n);if(a)return a;for(let i=t.depth-1;i>=0;i--){let s=r<0?gp(t.node(0),t.node(i),t.before(i+1),t.index(i),r,n):gp(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,r,n);if(s)return s}return null}static near(t,r=1){return this.findFrom(t,r)||this.findFrom(t,-r)||new Os(t.node(0))}static atStart(t){return gp(t,t,0,0,1)||new Os(t)}static atEnd(t){return gp(t,t,t.content.size,t.childCount,-1)||new Os(t)}static fromJSON(t,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=ED[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in ED)throw new RangeError("Duplicate use of selection JSON ID "+t);return ED[t]=r,r.prototype.jsonID=t,r}getBookmark(){return Yt.between(this.$anchor,this.$head).getBookmark()}};lr.prototype.visible=!0;let Fze=class{constructor(t,r){this.$from=t,this.$to=r}},cQ=!1;function uQ(e){!cQ&&!e.parent.inlineContent&&(cQ=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Yt extends lr{constructor(t,r=t){uQ(t),uQ(r),super(t,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,r){let n=t.resolve(r.map(this.head));if(!n.parent.inlineContent)return lr.near(n);let a=t.resolve(r.map(this.anchor));return new Yt(a.parent.inlineContent?a:n,n)}replace(t,r=pt.empty){if(super.replace(t,r),r==pt.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof Yt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Yj(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Yt(t.resolve(r.anchor),t.resolve(r.head))}static create(t,r,n=r){let a=t.resolve(r);return new this(a,n==r?a:t.resolve(n))}static between(t,r,n){let a=t.pos-r.pos;if((!n||a)&&(n=a>=0?1:-1),!r.parent.inlineContent){let i=lr.findFrom(r,n,!0)||lr.findFrom(r,-n,!0);if(i)r=i.$head;else return lr.near(r,n)}return t.parent.inlineContent||(a==0?t=r:(t=(lr.findFrom(t,-n,!0)||lr.findFrom(t,n,!0)).$anchor,t.pos<r.pos!=a<0&&(t=r))),new Yt(t,r)}}lr.jsonID("text",Yt);class Yj{constructor(t,r){this.anchor=t,this.head=r}map(t){return new Yj(t.map(this.anchor),t.map(this.head))}resolve(t){return Yt.between(t.resolve(this.anchor),t.resolve(this.head))}}class $t extends lr{constructor(t){let r=t.nodeAfter,n=t.node(0).resolve(t.pos+r.nodeSize);super(t,n),this.node=r}map(t,r){let{deleted:n,pos:a}=r.mapResult(this.anchor),i=t.resolve(a);return n?lr.near(i):new $t(i)}content(){return new pt(Ge.from(this.node),0,0)}eq(t){return t instanceof $t&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new r9(this.anchor)}static fromJSON(t,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new $t(t.resolve(r.anchor))}static create(t,r){return new $t(t.resolve(r))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}$t.prototype.visible=!1;lr.jsonID("node",$t);class r9{constructor(t){this.anchor=t}map(t){let{deleted:r,pos:n}=t.mapResult(this.anchor);return r?new Yj(n,n):new r9(n)}resolve(t){let r=t.resolve(this.anchor),n=r.nodeAfter;return n&&$t.isSelectable(n)?new $t(r):lr.near(r)}}class Os extends lr{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,r=pt.empty){if(r==pt.empty){t.delete(0,t.doc.content.size);let n=lr.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,r)}toJSON(){return{type:"all"}}static fromJSON(t){return new Os(t)}map(t){return new Os(t)}eq(t){return t instanceof Os}getBookmark(){return Uze}}lr.jsonID("all",Os);const Uze={map(){return this},resolve(e){return new Os(e)}};function gp(e,t,r,n,a,i=!1){if(t.inlineContent)return Yt.create(e,r);for(let s=n-(a>0?0:1);a>0?s<t.childCount:s>=0;s+=a){let l=t.child(s);if(l.isAtom){if(!i&&$t.isSelectable(l))return $t.create(e,r-(a<0?l.nodeSize:0))}else{let c=gp(e,l,r+a,a<0?l.childCount:0,a,i);if(c)return c}r+=l.nodeSize*a}return null}function dQ(e,t,r){let n=e.steps.length-1;if(n<t)return;let a=e.steps[n];if(!(a instanceof Fa||a instanceof Ha))return;let i=e.mapping.maps[n],s;i.forEach((l,c,u,d)=>{s==null&&(s=d)}),e.setSelection(lr.near(e.doc.resolve(s),r))}const fQ=1,cS=2,hQ=4;class Hze extends eue{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|fQ)&~cS,this.storedMarks=null,this}get selectionSet(){return(this.updated&fQ)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=cS,this}ensureMarks(t){return hn.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&cS)>0}addStep(t,r){super.addStep(t,r),this.updated=this.updated&~cS,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,r=!0){let n=this.selection;return r&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||hn.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,r,n){let a=this.doc.type.schema;if(r==null)return t?this.replaceSelectionWith(a.text(t),!0):this.deleteSelection();{if(n==null&&(n=r),!t)return this.deleteRange(r,n);let i=this.storedMarks;if(!i){let s=this.doc.resolve(r);i=n==r?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,a.text(t,i)),!this.selection.empty&&this.selection.to==r+t.length&&this.setSelection(lr.near(this.selection.$to)),this}}setMeta(t,r){return this.meta[typeof t=="string"?t:t.key]=r,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=hQ,this}get scrolledIntoView(){return(this.updated&hQ)>0}}function mQ(e,t){return!t||!e?e:e.bind(t)}class mb{constructor(t,r,n){this.name=t,this.init=mQ(r.init,n),this.apply=mQ(r.apply,n)}}const qze=[new mb("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new mb("selection",{init(e,t){return e.selection||lr.atStart(t.doc)},apply(e){return e.selection}}),new mb("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,r,n){return n.selection.$cursor?e.storedMarks:null}}),new mb("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})];class MD{constructor(t,r){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=qze.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new mb(n.key,n.spec.state,n))})}}class Mp{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let a=this.config.plugins[n];if(a.spec.filterTransaction&&!a.spec.filterTransaction.call(a,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let r=[t],n=this.applyInner(t),a=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let c=a?a[s].n:0,u=a?a[s].state:this,d=c<r.length&&l.spec.appendTransaction.call(l,c?r.slice(c):r,u,n);if(d&&n.filterTransaction(d,s)){if(d.setMeta("appendedTransaction",t),!a){a=[];for(let f=0;f<this.config.plugins.length;f++)a.push(f<s?{state:n,n:r.length}:{state:this,n:0})}r.push(d),n=n.applyInner(d),i=!0}a&&(a[s]={state:n,n:r.length})}}if(!i)return{state:n,transactions:r}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new Mp(this.config),n=this.config.fields;for(let a=0;a<n.length;a++){let i=n[a];r[i.name]=i.apply(t,this[i.name],this,r)}return r}get tr(){return new Hze(this)}static create(t){let r=new MD(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new Mp(r);for(let a=0;a<r.fields.length;a++)n[r.fields[a].name]=r.fields[a].init(t,n);return n}reconfigure(t){let r=new MD(this.schema,t.plugins),n=r.fields,a=new Mp(r);for(let i=0;i<n.length;i++){let s=n[i].name;a[s]=this.hasOwnProperty(s)?this[s]:n[i].init(t,a)}return a}toJSON(t){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let a=t[n],i=a.spec.state;i&&i.toJSON&&(r[n]=i.toJSON.call(a,this[a.key]))}return r}static fromJSON(t,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let a=new MD(t.schema,t.plugins),i=new Mp(a);return a.fields.forEach(s=>{if(s.name=="doc")i.doc=Nd.fromJSON(t.schema,r.doc);else if(s.name=="selection")i.selection=lr.fromJSON(i.doc,r.selection);else if(s.name=="storedMarks")r.storedMarks&&(i.storedMarks=r.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let l in n){let c=n[l],u=c.spec.state;if(c.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,l)){i[s.name]=u.fromJSON.call(c,t,r[l],i);return}}i[s.name]=s.init(t,i)}}),i}}function tue(e,t,r){for(let n in e){let a=e[n];a instanceof Function?a=a.bind(t):n=="handleDOMEvents"&&(a=tue(a,t,{})),r[n]=a}return r}class Ur{constructor(t){this.spec=t,this.props={},t.props&&tue(t.props,this,this.props),this.key=t.key?t.key.key:rue("plugin")}getState(t){return t[this.key]}}const TD=Object.create(null);function rue(e){return e in TD?e+"$"+ ++TD[e]:(TD[e]=0,e+"$")}class Gr{constructor(t="key"){this.key=rue(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const n9=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function nue(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("backward",e):r.parentOffset>0)?null:r}const aue=(e,t,r)=>{let n=nue(e,r);if(!n)return!1;let a=a9(n);if(!a){let s=n.blockRange(),l=s&&h0(s);return l==null?!1:(t&&t(e.tr.lift(s,l).scrollIntoView()),!0)}let i=a.nodeBefore;if(hue(e,a,t,-1))return!0;if(n.parent.content.size==0&&(kg(i,"end")||$t.isSelectable(i)))for(let s=n.depth;;s--){let l=Vj(e.doc,n.before(s),n.after(s),pt.empty);if(l&&l.slice.size<l.to-l.from){if(t){let c=e.tr.step(l);c.setSelection(kg(i,"end")?lr.findFrom(c.doc.resolve(c.mapping.map(a.pos,-1)),-1):$t.create(c.doc,a.pos-i.nodeSize)),t(c.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return i.isAtom&&a.depth==n.depth-1?(t&&t(e.tr.delete(a.pos-i.nodeSize,a.pos).scrollIntoView()),!0):!1},Wze=(e,t,r)=>{let n=nue(e,r);if(!n)return!1;let a=a9(n);return a?iue(e,a,t):!1},Kze=(e,t,r)=>{let n=oue(e,r);if(!n)return!1;let a=i9(n);return a?iue(e,a,t):!1};function iue(e,t,r){let n=t.nodeBefore,a=n,i=t.pos-1;for(;!a.isTextblock;i--){if(a.type.spec.isolating)return!1;let d=a.lastChild;if(!d)return!1;a=d}let s=t.nodeAfter,l=s,c=t.pos+1;for(;!l.isTextblock;c++){if(l.type.spec.isolating)return!1;let d=l.firstChild;if(!d)return!1;l=d}let u=Vj(e.doc,i,c,pt.empty);if(!u||u.from!=i||u instanceof Fa&&u.slice.size>=c-i)return!1;if(r){let d=e.tr.step(u);d.setSelection(Yt.create(d.doc,i)),r(d.scrollIntoView())}return!0}function kg(e,t,r=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const sue=(e,t,r)=>{let{$head:n,empty:a}=e.selection,i=n;if(!a)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):n.parentOffset>0)return!1;i=a9(n)}let s=i&&i.nodeBefore;return!s||!$t.isSelectable(s)?!1:(t&&t(e.tr.setSelection($t.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function a9(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function oue(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)?null:r}const lue=(e,t,r)=>{let n=oue(e,r);if(!n)return!1;let a=i9(n);if(!a)return!1;let i=a.nodeAfter;if(hue(e,a,t,1))return!0;if(n.parent.content.size==0&&(kg(i,"start")||$t.isSelectable(i))){let s=Vj(e.doc,n.before(),n.after(),pt.empty);if(s&&s.slice.size<s.to-s.from){if(t){let l=e.tr.step(s);l.setSelection(kg(i,"start")?lr.findFrom(l.doc.resolve(l.mapping.map(a.pos)),1):$t.create(l.doc,l.mapping.map(a.pos))),t(l.scrollIntoView())}return!0}}return i.isAtom&&a.depth==n.depth-1?(t&&t(e.tr.delete(a.pos,a.pos+i.nodeSize).scrollIntoView()),!0):!1},cue=(e,t,r)=>{let{$head:n,empty:a}=e.selection,i=n;if(!a)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;i=i9(n)}let s=i&&i.nodeAfter;return!s||!$t.isSelectable(s)?!1:(t&&t(e.tr.setSelection($t.create(e.doc,i.pos)).scrollIntoView()),!0)};function i9(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}const Gze=(e,t)=>{let r=e.selection,n=r instanceof $t,a;if(n){if(r.node.isTextblock||!qd(e.doc,r.from))return!1;a=r.from}else if(a=Gj(e.doc,r.from,-1),a==null)return!1;if(t){let i=e.tr.join(a);n&&i.setSelection($t.create(i.doc,a-e.doc.resolve(a).nodeBefore.nodeSize)),t(i.scrollIntoView())}return!0},Vze=(e,t)=>{let r=e.selection,n;if(r instanceof $t){if(r.node.isTextblock||!qd(e.doc,r.to))return!1;n=r.to}else if(n=Gj(e.doc,r.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},Yze=(e,t)=>{let{$from:r,$to:n}=e.selection,a=r.blockRange(n),i=a&&h0(a);return i==null?!1:(t&&t(e.tr.lift(a,i).scrollIntoView()),!0)},uue=(e,t)=>{let{$head:r,$anchor:n}=e.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function s9(e){for(let t=0;t<e.edgeCount;t++){let{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const Qze=(e,t)=>{let{$head:r,$anchor:n}=e.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let a=r.node(-1),i=r.indexAfter(-1),s=s9(a.contentMatchAt(i));if(!s||!a.canReplaceWith(i,i,s))return!1;if(t){let l=r.after(),c=e.tr.replaceWith(l,l,s.createAndFill());c.setSelection(lr.near(c.doc.resolve(l),1)),t(c.scrollIntoView())}return!0},due=(e,t)=>{let r=e.selection,{$from:n,$to:a}=r;if(r instanceof Os||n.parent.inlineContent||a.parent.inlineContent)return!1;let i=s9(a.parent.contentMatchAt(a.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let s=(!n.parentOffset&&a.index()<a.parent.childCount?n:a).pos,l=e.tr.insert(s,i.createAndFill());l.setSelection(Yt.create(l.doc,s+1)),t(l.scrollIntoView())}return!0},fue=(e,t)=>{let{$cursor:r}=e.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let i=r.before();if(Xc(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}let n=r.blockRange(),a=n&&h0(n);return a==null?!1:(t&&t(e.tr.lift(n,a).scrollIntoView()),!0)};function Jze(e){return(t,r)=>{let{$from:n,$to:a}=t.selection;if(t.selection instanceof $t&&t.selection.node.isBlock)return!n.parentOffset||!Xc(t.doc,n.pos)?!1:(r&&r(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let i=[],s,l,c=!1,u=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){c=n.end(p)==n.pos+(n.depth-p),u=n.start(p)==n.pos-(n.depth-p),l=s9(n.node(p-1).contentMatchAt(n.indexAfter(p-1))),i.unshift(c&&l?{type:l}:null),s=p;break}else{if(p==1)return!1;i.unshift(null)}let d=t.tr;(t.selection instanceof Yt||t.selection instanceof Os)&&d.deleteSelection();let f=d.mapping.map(n.pos),m=Xc(d.doc,f,i.length,i);if(m||(i[0]=l?{type:l}:null,m=Xc(d.doc,f,i.length,i)),!m)return!1;if(d.split(f,i.length,i),!c&&u&&n.node(s).type!=l){let p=d.mapping.map(n.before(s)),v=d.doc.resolve(p);l&&n.node(s-1).canReplaceWith(v.index(),v.index()+1,l)&&d.setNodeMarkup(d.mapping.map(n.before(s)),l)}return r&&r(d.scrollIntoView()),!0}}const Zze=Jze(),Xze=(e,t)=>{let{$from:r,to:n}=e.selection,a,i=r.sharedDepth(n);return i==0?!1:(a=r.before(i),t&&t(e.tr.setSelection($t.create(e.doc,a))),!0)};function e9e(e,t,r){let n=t.nodeBefore,a=t.nodeAfter,i=t.index();return!n||!a||!n.type.compatibleContent(a.type)?!1:!n.content.size&&t.parent.canReplace(i-1,i)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(i,i+1)||!(a.isTextblock||qd(e.doc,t.pos))?!1:(r&&r(e.tr.join(t.pos).scrollIntoView()),!0)}function hue(e,t,r,n){let a=t.nodeBefore,i=t.nodeAfter,s,l,c=a.type.spec.isolating||i.type.spec.isolating;if(!c&&e9e(e,t,r))return!0;let u=!c&&t.parent.canReplace(t.index(),t.index()+1);if(u&&(s=(l=a.contentMatchAt(a.childCount)).findWrapping(i.type))&&l.matchType(s[0]||i.type).validEnd){if(r){let p=t.pos+i.nodeSize,v=Ge.empty;for(let S=s.length-1;S>=0;S--)v=Ge.from(s[S].create(null,v));v=Ge.from(a.copy(v));let b=e.tr.step(new Ha(t.pos-1,p,t.pos,p,new pt(v,1,0),s.length,!0)),y=b.doc.resolve(p+2*s.length);y.nodeAfter&&y.nodeAfter.type==a.type&&qd(b.doc,y.pos)&&b.join(y.pos),r(b.scrollIntoView())}return!0}let d=i.type.spec.isolating||n>0&&c?null:lr.findFrom(t,1),f=d&&d.$from.blockRange(d.$to),m=f&&h0(f);if(m!=null&&m>=t.depth)return r&&r(e.tr.lift(f,m).scrollIntoView()),!0;if(u&&kg(i,"start",!0)&&kg(a,"end")){let p=a,v=[];for(;v.push(p),!p.isTextblock;)p=p.lastChild;let b=i,y=1;for(;!b.isTextblock;b=b.firstChild)y++;if(p.canReplace(p.childCount,p.childCount,b.content)){if(r){let S=Ge.empty;for(let N=v.length-1;N>=0;N--)S=Ge.from(v[N].copy(S));let _=e.tr.step(new Ha(t.pos-v.length,t.pos+i.nodeSize,t.pos+y,t.pos+i.nodeSize-y,new pt(S,v.length,0),0,!0));r(_.scrollIntoView())}return!0}}return!1}function mue(e){return function(t,r){let n=t.selection,a=e<0?n.$from:n.$to,i=a.depth;for(;a.node(i).isInline;){if(!i)return!1;i--}return a.node(i).isTextblock?(r&&r(t.tr.setSelection(Yt.create(t.doc,e<0?a.start(i):a.end(i)))),!0):!1}}const t9e=mue(-1),r9e=mue(1);function n9e(e,t=null){return function(r,n){let{$from:a,$to:i}=r.selection,s=a.blockRange(i),l=s&&t9(s,e,t);return l?(n&&n(r.tr.wrap(s,l).scrollIntoView()),!0):!1}}function pQ(e,t=null){return function(r,n){let a=!1;for(let i=0;i<r.selection.ranges.length&&!a;i++){let{$from:{pos:s},$to:{pos:l}}=r.selection.ranges[i];r.doc.nodesBetween(s,l,(c,u)=>{if(a)return!1;if(!(!c.isTextblock||c.hasMarkup(e,t)))if(c.type==e)a=!0;else{let d=r.doc.resolve(u),f=d.index();a=d.parent.canReplaceWith(f,f+1,e)}})}if(!a)return!1;if(n){let i=r.tr;for(let s=0;s<r.selection.ranges.length;s++){let{$from:{pos:l},$to:{pos:c}}=r.selection.ranges[s];i.setBlockType(l,c,e,t)}n(i.scrollIntoView())}return!0}}function o9(...e){return function(t,r,n){for(let a=0;a<e.length;a++)if(e[a](t,r,n))return!0;return!1}}o9(n9,aue,sue);o9(n9,lue,cue);o9(uue,due,fue,Zze);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function a9e(e,t=null){return function(r,n){let{$from:a,$to:i}=r.selection,s=a.blockRange(i);if(!s)return!1;let l=n?r.tr:null;return i9e(l,s,e,t)?(n&&n(l.scrollIntoView()),!0):!1}}function i9e(e,t,r,n=null){let a=!1,i=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(r)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let c=s.resolve(t.start-2);i=new oN(c,c,t.depth),t.endIndex<t.parent.childCount&&(t=new oN(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),a=!0}let l=t9(i,r,n,t);return l?(e&&s9e(e,t,l,a,r),!0):!1}function s9e(e,t,r,n,a){let i=Ge.empty;for(let d=r.length-1;d>=0;d--)i=Ge.from(r[d].type.create(r[d].attrs,i));e.step(new Ha(t.start-(n?2:0),t.end,t.start,t.end,new pt(i,0,0),r.length,!0));let s=0;for(let d=0;d<r.length;d++)r[d].type==a&&(s=d+1);let l=r.length-s,c=t.start+r.length-(n?2:0),u=t.parent;for(let d=t.startIndex,f=t.endIndex,m=!0;d<f;d++,m=!1)!m&&Xc(e.doc,c,l)&&(e.split(c,l),c+=2*l),c+=u.child(d).nodeSize;return e}function o9e(e){return function(t,r){let{$from:n,$to:a}=t.selection,i=n.blockRange(a,s=>s.childCount>0&&s.firstChild.type==e);return i?r?n.node(i.depth-1).type==e?l9e(t,r,e,i):c9e(t,r,i):!0:!1}}function l9e(e,t,r,n){let a=e.tr,i=n.end,s=n.$to.end(n.depth);i<s&&(a.step(new Ha(i-1,s,i,s,new pt(Ge.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new oN(a.doc.resolve(n.$from.pos),a.doc.resolve(s),n.depth));const l=h0(n);if(l==null)return!1;a.lift(n,l);let c=a.doc.resolve(a.mapping.map(i,-1)-1);return qd(a.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&a.join(c.pos),t(a.scrollIntoView()),!0}function c9e(e,t,r){let n=e.tr,a=r.parent;for(let p=r.end,v=r.endIndex-1,b=r.startIndex;v>b;v--)p-=a.child(v).nodeSize,n.delete(p-1,p+1);let i=n.doc.resolve(r.start),s=i.nodeAfter;if(n.mapping.map(r.end)!=r.start+i.nodeAfter.nodeSize)return!1;let l=r.startIndex==0,c=r.endIndex==a.childCount,u=i.node(-1),d=i.index(-1);if(!u.canReplace(d+(l?0:1),d+1,s.content.append(c?Ge.empty:Ge.from(a))))return!1;let f=i.pos,m=f+s.nodeSize;return n.step(new Ha(f-(l?1:0),m+(c?1:0),f+1,m-1,new pt((l?Ge.empty:Ge.from(a.copy(Ge.empty))).append(c?Ge.empty:Ge.from(a.copy(Ge.empty))),l?0:1,c?0:1),l?0:1)),t(n.scrollIntoView()),!0}function u9e(e){return function(t,r){let{$from:n,$to:a}=t.selection,i=n.blockRange(a,u=>u.childCount>0&&u.firstChild.type==e);if(!i)return!1;let s=i.startIndex;if(s==0)return!1;let l=i.parent,c=l.child(s-1);if(c.type!=e)return!1;if(r){let u=c.lastChild&&c.lastChild.type==l.type,d=Ge.from(u?e.create():null),f=new pt(Ge.from(e.create(null,Ge.from(l.type.create(null,d)))),u?3:1,0),m=i.start,p=i.end;r(t.tr.step(new Ha(m-(u?3:1),p,m,p,f,1,!0)).scrollIntoView())}return!0}}const ri=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},_g=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t};let vR=null;const Rc=function(e,t,r){let n=vR||(vR=document.createRange());return n.setEnd(e,r??e.nodeValue.length),n.setStart(e,t||0),n},d9e=function(){vR=null},jh=function(e,t,r,n){return r&&(gQ(e,t,r,n,-1)||gQ(e,t,r,n,1))},f9e=/^(img|br|input|textarea|hr)$/i;function gQ(e,t,r,n,a){for(var i;;){if(e==r&&t==n)return!0;if(t==(a<0?0:vo(e))){let s=e.parentNode;if(!s||s.nodeType!=1||Xx(e)||f9e.test(e.nodeName)||e.contentEditable=="false")return!1;t=ri(e)+(a<0?0:1),e=s}else if(e.nodeType==1){let s=e.childNodes[t+(a<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((i=s.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)t+=a;else return!1;else e=s,t=a<0?vo(e):0}else return!1}}function vo(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function h9e(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=vo(e)}else if(e.parentNode&&!Xx(e))t=ri(e),e=e.parentNode;else return null}}function m9e(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!Xx(e))t=ri(e)+1,e=e.parentNode;else return null}}function p9e(e,t,r){for(let n=t==0,a=t==vo(e);n||a;){if(e==r)return!0;let i=ri(e);if(e=e.parentNode,!e)return!1;n=n&&i==0,a=a&&i==vo(e)}}function Xx(e){let t;for(let r=e;r&&!(t=r.pmViewDesc);r=r.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const Qj=function(e){return e.focusNode&&jh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Uf(e,t){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=e,r.key=r.code=t,r}function g9e(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function v9e(e,t,r){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,r);if(n)return{node:n.offsetNode,offset:Math.min(vo(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,r);if(n)return{node:n.startContainer,offset:Math.min(vo(n.startContainer),n.startOffset)}}}const Ol=typeof navigator<"u"?navigator:null,vQ=typeof document<"u"?document:null,Wd=Ol&&Ol.userAgent||"",bR=/Edge\/(\d+)/.exec(Wd),pue=/MSIE \d/.exec(Wd),yR=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Wd),ns=!!(pue||yR||bR),jd=pue?document.documentMode:yR?+yR[1]:bR?+bR[1]:0,yo=!ns&&/gecko\/(\d+)/i.test(Wd);yo&&+(/Firefox\/(\d+)/.exec(Wd)||[0,0])[1];const xR=!ns&&/Chrome\/(\d+)/.exec(Wd),Ua=!!xR,gue=xR?+xR[1]:0,ci=!ns&&!!Ol&&/Apple Computer/.test(Ol.vendor),Ng=ci&&(/Mobile\/\w+/.test(Wd)||!!Ol&&Ol.maxTouchPoints>2),uo=Ng||(Ol?/Mac/.test(Ol.platform):!1),vue=Ol?/Win/.test(Ol.platform):!1,Hc=/Android \d/.test(Wd),e1=!!vQ&&"webkitFontSmoothing"in vQ.documentElement.style,b9e=e1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function y9e(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function pc(e,t){return typeof e=="number"?e:e[t]}function x9e(e){let t=e.getBoundingClientRect(),r=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*r,top:t.top,bottom:t.top+e.clientHeight*n}}function bQ(e,t,r){let n=e.someProp("scrollThreshold")||0,a=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let s=r||e.dom;s;){if(s.nodeType!=1){s=_g(s);continue}let l=s,c=l==i.body,u=c?y9e(i):x9e(l),d=0,f=0;if(t.top<u.top+pc(n,"top")?f=-(u.top-t.top+pc(a,"top")):t.bottom>u.bottom-pc(n,"bottom")&&(f=t.bottom-t.top>u.bottom-u.top?t.top+pc(a,"top")-u.top:t.bottom-u.bottom+pc(a,"bottom")),t.left<u.left+pc(n,"left")?d=-(u.left-t.left+pc(a,"left")):t.right>u.right-pc(n,"right")&&(d=t.right-u.right+pc(a,"right")),d||f)if(c)i.defaultView.scrollBy(d,f);else{let p=l.scrollLeft,v=l.scrollTop;f&&(l.scrollTop+=f),d&&(l.scrollLeft+=d);let b=l.scrollLeft-p,y=l.scrollTop-v;t={left:t.left-b,top:t.top-y,right:t.right-b,bottom:t.bottom-y}}let m=c?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(m))break;s=m=="absolute"?s.offsetParent:_g(s)}}function w9e(e){let t=e.dom.getBoundingClientRect(),r=Math.max(0,t.top),n,a;for(let i=(t.left+t.right)/2,s=r+1;s<Math.min(innerHeight,t.bottom);s+=5){let l=e.root.elementFromPoint(i,s);if(!l||l==e.dom||!e.dom.contains(l))continue;let c=l.getBoundingClientRect();if(c.top>=r-20){n=l,a=c.top;break}}return{refDOM:n,refTop:a,stack:bue(e.dom)}}function bue(e){let t=[],r=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=r);n=_g(n));return t}function S9e({refDOM:e,refTop:t,stack:r}){let n=e?e.getBoundingClientRect().top:0;yue(r,n==0?0:n-t)}function yue(e,t){for(let r=0;r<e.length;r++){let{dom:n,top:a,left:i}=e[r];n.scrollTop!=a+t&&(n.scrollTop=a+t),n.scrollLeft!=i&&(n.scrollLeft=i)}}let Xm=null;function k9e(e){if(e.setActive)return e.setActive();if(Xm)return e.focus(Xm);let t=bue(e);e.focus(Xm==null?{get preventScroll(){return Xm={preventScroll:!0},!0}}:void 0),Xm||(Xm=!1,yue(t,0))}function xue(e,t){let r,n=2e8,a,i=0,s=t.top,l=t.top,c,u;for(let d=e.firstChild,f=0;d;d=d.nextSibling,f++){let m;if(d.nodeType==1)m=d.getClientRects();else if(d.nodeType==3)m=Rc(d).getClientRects();else continue;for(let p=0;p<m.length;p++){let v=m[p];if(v.top<=s&&v.bottom>=l){s=Math.max(v.bottom,s),l=Math.min(v.top,l);let b=v.left>t.left?v.left-t.left:v.right<t.left?t.left-v.right:0;if(b<n){r=d,n=b,a=b&&r.nodeType==3?{left:v.right<t.left?v.right:v.left,top:t.top}:t,d.nodeType==1&&b&&(i=f+(t.left>=(v.left+v.right)/2?1:0));continue}}else v.top>t.top&&!c&&v.left<=t.left&&v.right>=t.left&&(c=d,u={left:Math.max(v.left,Math.min(v.right,t.left)),top:v.top});!r&&(t.left>=v.right&&t.top>=v.top||t.left>=v.left&&t.top>=v.bottom)&&(i=f+1)}}return!r&&c&&(r=c,a=u,n=0),r&&r.nodeType==3?_9e(r,a):!r||n&&r.nodeType==1?{node:e,offset:i}:xue(r,a)}function _9e(e,t){let r=e.nodeValue.length,n=document.createRange(),a;for(let i=0;i<r;i++){n.setEnd(e,i+1),n.setStart(e,i);let s=rd(n,1);if(s.top!=s.bottom&&l9(t,s)){a={node:e,offset:i+(t.left>=(s.left+s.right)/2?1:0)};break}}return n.detach(),a||{node:e,offset:0}}function l9(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function N9e(e,t){let r=e.parentNode;return r&&/^li$/i.test(r.nodeName)&&t.left<e.getBoundingClientRect().left?r:e}function C9e(e,t,r){let{node:n,offset:a}=xue(t,r),i=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();i=s.left!=s.right&&r.left>(s.left+s.right)/2?1:-1}return e.docView.posFromDOM(n,a,i)}function j9e(e,t,r,n){let a=-1;for(let i=t,s=!1;i!=e.dom;){let l=e.docView.nearestDesc(i,!0),c;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((c=l.dom.getBoundingClientRect()).width||c.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!s&&c.left>n.left||c.top>n.top?a=l.posBefore:(!s&&c.right<n.left||c.bottom<n.top)&&(a=l.posAfter),s=!0),!l.contentDOM&&a<0&&!l.node.isText))return(l.node.isBlock?n.top<(c.top+c.bottom)/2:n.left<(c.left+c.right)/2)?l.posBefore:l.posAfter;i=l.dom.parentNode}return a>-1?a:e.docView.posFromDOM(t,r,-1)}function wue(e,t,r){let n=e.childNodes.length;if(n&&r.top<r.bottom)for(let a=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-r.top)/(r.bottom-r.top))-2)),i=a;;){let s=e.childNodes[i];if(s.nodeType==1){let l=s.getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(l9(t,u))return wue(s,t,u)}}if((i=(i+1)%n)==a)break}return e}function E9e(e,t){let r=e.dom.ownerDocument,n,a=0,i=v9e(r,t.left,t.top);i&&({node:n,offset:a}=i);let s=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top),l;if(!s||!e.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=e.dom.getBoundingClientRect();if(!l9(t,u)||(s=wue(e.dom,t,u),!s))return null}if(ci)for(let u=s;n&&u;u=_g(u))u.draggable&&(n=void 0);if(s=N9e(s,t),n){if(yo&&n.nodeType==1&&(a=Math.min(a,n.childNodes.length),a<n.childNodes.length)){let d=n.childNodes[a],f;d.nodeName=="IMG"&&(f=d.getBoundingClientRect()).right<=t.left&&f.bottom>t.top&&a++}let u;e1&&a&&n.nodeType==1&&(u=n.childNodes[a-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=t.top&&a--,n==e.dom&&a==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?l=e.state.doc.content.size:(a==0||n.nodeType!=1||n.childNodes[a-1].nodeName!="BR")&&(l=j9e(e,n,a,t))}l==null&&(l=C9e(e,s,t));let c=e.docView.nearestDesc(s,!0);return{pos:l,inside:c?c.posAtStart-c.border:-1}}function yQ(e){return e.top<e.bottom||e.left<e.right}function rd(e,t){let r=e.getClientRects();if(r.length){let n=r[t<0?0:r.length-1];if(yQ(n))return n}return Array.prototype.find.call(r,yQ)||e.getBoundingClientRect()}const M9e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Sue(e,t,r){let{node:n,offset:a,atom:i}=e.docView.domFromPos(t,r<0?-1:1),s=e1||yo;if(n.nodeType==3)if(s&&(M9e.test(n.nodeValue)||(r<0?!a:a==n.nodeValue.length))){let c=rd(Rc(n,a,a),r);if(yo&&a&&/\s/.test(n.nodeValue[a-1])&&a<n.nodeValue.length){let u=rd(Rc(n,a-1,a-1),-1);if(u.top==c.top){let d=rd(Rc(n,a,a+1),-1);if(d.top!=c.top)return jv(d,d.left<u.left)}}return c}else{let c=a,u=a,d=r<0?1:-1;return r<0&&!a?(u++,d=-1):r>=0&&a==n.nodeValue.length?(c--,d=1):r<0?c--:u++,jv(rd(Rc(n,c,u),d),d<0)}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(i==null&&a&&(r<0||a==vo(n))){let c=n.childNodes[a-1];if(c.nodeType==1)return AD(c.getBoundingClientRect(),!1)}if(i==null&&a<vo(n)){let c=n.childNodes[a];if(c.nodeType==1)return AD(c.getBoundingClientRect(),!0)}return AD(n.getBoundingClientRect(),r>=0)}if(i==null&&a&&(r<0||a==vo(n))){let c=n.childNodes[a-1],u=c.nodeType==3?Rc(c,vo(c)-(s?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(u)return jv(rd(u,1),!1)}if(i==null&&a<vo(n)){let c=n.childNodes[a];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let u=c?c.nodeType==3?Rc(c,0,s?0:1):c.nodeType==1?c:null:null;if(u)return jv(rd(u,-1),!0)}return jv(rd(n.nodeType==3?Rc(n):n,-r),r>=0)}function jv(e,t){if(e.width==0)return e;let r=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:r,right:r}}function AD(e,t){if(e.height==0)return e;let r=t?e.top:e.bottom;return{top:r,bottom:r,left:e.left,right:e.right}}function kue(e,t,r){let n=e.state,a=e.root.activeElement;n!=t&&e.updateState(t),a!=e.dom&&e.focus();try{return r()}finally{n!=t&&e.updateState(n),a!=e.dom&&a&&a.focus()}}function T9e(e,t,r){let n=t.selection,a=r=="up"?n.$from:n.$to;return kue(e,t,()=>{let{node:i}=e.docView.domFromPos(a.pos,r=="up"?-1:1);for(;;){let l=e.docView.nearestDesc(i,!0);if(!l)break;if(l.node.isBlock){i=l.contentDOM||l.dom;break}i=l.dom.parentNode}let s=Sue(e,a.pos,1);for(let l=i.firstChild;l;l=l.nextSibling){let c;if(l.nodeType==1)c=l.getClientRects();else if(l.nodeType==3)c=Rc(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<c.length;u++){let d=c[u];if(d.bottom>d.top+1&&(r=="up"?s.top-d.top>(d.bottom-s.top)*2:d.bottom-s.bottom>(s.bottom-d.top)*2))return!1}}return!0})}const A9e=/[\u0590-\u08ac]/;function D9e(e,t,r){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let a=n.parentOffset,i=!a,s=a==n.parent.content.size,l=e.domSelection();return l?!A9e.test(n.parent.textContent)||!l.modify?r=="left"||r=="backward"?i:s:kue(e,t,()=>{let{focusNode:c,focusOffset:u,anchorNode:d,anchorOffset:f}=e.domSelectionRange(),m=l.caretBidiLevel;l.modify("move",r,"character");let p=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:v,focusOffset:b}=e.domSelectionRange(),y=v&&!p.contains(v.nodeType==1?v:v.parentNode)||c==v&&u==b;try{l.collapse(d,f),c&&(c!=d||u!=f)&&l.extend&&l.extend(c,u)}catch{}return m!=null&&(l.caretBidiLevel=m),y}):n.pos==n.start()||n.pos==n.end()}let xQ=null,wQ=null,SQ=!1;function L9e(e,t,r){return xQ==t&&wQ==r?SQ:(xQ=t,wQ=r,SQ=r=="up"||r=="down"?T9e(e,t,r):D9e(e,t,r))}const xo=0,kQ=1,Vf=2,Il=3;class t1{constructor(t,r,n,a){this.parent=t,this.children=r,this.dom=n,this.contentDOM=a,this.dirty=xo,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,r,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let r=0;r<this.children.length;r++)t+=this.children[r].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let r=0,n=this.posAtStart;;r++){let a=this.children[r];if(a==t)return n;n+=a.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,r,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let i,s;if(t==this.contentDOM)i=t.childNodes[r-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.previousSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(s)+s.size:this.posAtStart}else{let i,s;if(t==this.contentDOM)i=t.childNodes[r];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}let a;if(t==this.dom&&this.contentDOM)a=r>ri(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let i=t;;i=i.parentNode){if(i==this.dom){a=!1;break}if(i.previousSibling)break}if(a==null&&r==t.childNodes.length)for(let i=t;;i=i.parentNode){if(i==this.dom){a=!0;break}if(i.nextSibling)break}}return a??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,r=!1){for(let n=!0,a=t;a;a=a.parentNode){let i=this.getDesc(a),s;if(i&&(!r||i.node))if(n&&(s=i.nodeDOM)&&!(s.nodeType==1?s.contains(t.nodeType==1?t:t.parentNode):s==t))n=!1;else return i}}getDesc(t){let r=t.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(t,r,n){for(let a=t;a;a=a.parentNode){let i=this.getDesc(a);if(i)return i.localPosFromDOM(t,r,n)}return-1}descAt(t){for(let r=0,n=0;r<this.children.length;r++){let a=this.children[r],i=n+a.size;if(n==t&&i!=n){for(;!a.border&&a.children.length;)for(let s=0;s<a.children.length;s++){let l=a.children[s];if(l.size){a=l;break}}return a}if(t<i)return a.descAt(t-n-a.border);n=i}}domFromPos(t,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,a=0;for(let i=0;n<this.children.length;n++){let s=this.children[n],l=i+s.size;if(l>t||s instanceof Nue){a=t-i;break}i=l}if(a)return this.children[n].domFromPos(a-this.children[n].border,r);for(let i;n&&!(i=this.children[n-1]).size&&i instanceof _ue&&i.side>=0;n--);if(r<=0){let i,s=!0;for(;i=n?this.children[n-1]:null,!(!i||i.dom.parentNode==this.contentDOM);n--,s=!1);return i&&r&&s&&!i.border&&!i.domAtom?i.domFromPos(i.size,r):{node:this.contentDOM,offset:i?ri(i.dom)+1:0}}else{let i,s=!0;for(;i=n<this.children.length?this.children[n]:null,!(!i||i.dom.parentNode==this.contentDOM);n++,s=!1);return i&&s&&!i.border&&!i.domAtom?i.domFromPos(0,r):{node:this.contentDOM,offset:i?ri(i.dom):this.contentDOM.childNodes.length}}}parseRange(t,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let a=-1,i=-1;for(let s=n,l=0;;l++){let c=this.children[l],u=s+c.size;if(a==-1&&t<=u){let d=s+c.border;if(t>=d&&r<=u-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,r,d);t=s;for(let f=l;f>0;f--){let m=this.children[f-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){a=ri(m.dom)+1;break}t-=m.size}a==-1&&(a=0)}if(a>-1&&(u>r||l==this.children.length-1)){r=u;for(let d=l+1;d<this.children.length;d++){let f=this.children[d];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=ri(f.dom);break}r+=f.size}i==-1&&(i=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:t,to:r,fromOffset:a,toOffset:i}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[t<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(t)}domAfterPos(t){let{node:r,offset:n}=this.domFromPos(t,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+t);return r.childNodes[n]}setSelection(t,r,n,a=!1){let i=Math.min(t,r),s=Math.max(t,r);for(let p=0,v=0;p<this.children.length;p++){let b=this.children[p],y=v+b.size;if(i>v&&s<y)return b.setSelection(t-v-b.border,r-v-b.border,n,a);v=y}let l=this.domFromPos(t,t?-1:1),c=r==t?l:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),d=n.domSelectionRange(),f=!1;if((yo||ci)&&t==r){let{node:p,offset:v}=l;if(p.nodeType==3){if(f=!!(v&&p.nodeValue[v-1]==`
`),f&&v==p.nodeValue.length)for(let b=p,y;b;b=b.parentNode){if(y=b.nextSibling){y.nodeName=="BR"&&(l=c={node:y.parentNode,offset:ri(y)+1});break}let S=b.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let b=p.childNodes[v-1];f=b&&(b.nodeName=="BR"||b.contentEditable=="false")}}if(yo&&d.focusNode&&d.focusNode!=c.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(a=!0)}if(!(a||f&&ci)&&jh(l.node,l.offset,d.anchorNode,d.anchorOffset)&&jh(c.node,c.offset,d.focusNode,d.focusOffset))return;let m=!1;if((u.extend||t==r)&&!(f&&yo)){u.collapse(l.node,l.offset);try{t!=r&&u.extend(c.node,c.offset),m=!0}catch{}}if(!m){if(t>r){let v=l;l=c,c=v}let p=document.createRange();p.setEnd(c.node,c.offset),p.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,r){for(let n=0,a=0;a<this.children.length;a++){let i=this.children[a],s=n+i.size;if(n==s?t<=s&&r>=n:t<s&&r>n){let l=n+i.border,c=s-i.border;if(t>=l&&r<=c){this.dirty=t==n||r==s?Vf:kQ,t==l&&r==c&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Il:i.markDirty(t-l,r-l);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Vf:Il}n=s}this.dirty=Vf}markParentsDirty(){let t=1;for(let r=this.parent;r;r=r.parent,t++){let n=t==1?Vf:kQ;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class _ue extends t1{constructor(t,r,n,a){let i,s=r.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!i)return a;if(i.parent)return i.parent.posBeforeChild(i)})),!r.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=r,this.widget=r,i=this}matchesWidget(t){return this.dirty==xo&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let r=this.widget.spec.stopEvent;return r?r(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class O9e extends t1{constructor(t,r,n,a){super(t,[],r,null),this.textDOM=n,this.text=a}get size(){return this.text.length}localPosFromDOM(t,r){return t!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class Eh extends t1{constructor(t,r,n,a,i){super(t,[],n,a),this.mark=r,this.spec=i}static create(t,r,n,a){let i=a.nodeViews[r.type.name],s=i&&i(r,a,n);return(!s||!s.dom)&&(s=Zh.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new Eh(t,r,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Il||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Il&&this.mark.eq(t)}markDirty(t,r){if(super.markDirty(t,r),this.dirty!=xo){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=xo}}slice(t,r,n){let a=Eh.create(this.parent,this.mark,!0,n),i=this.children,s=this.size;r<s&&(i=SR(i,r,s,n)),t>0&&(i=SR(i,0,t,n));for(let l=0;l<i.length;l++)i[l].parent=a;return a.children=i,a}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ed extends t1{constructor(t,r,n,a,i,s,l,c,u){super(t,[],i,s),this.node=r,this.outerDeco=n,this.innerDeco=a,this.nodeDOM=l}static create(t,r,n,a,i,s){let l=i.nodeViews[r.type.name],c,u=l&&l(r,i,()=>{if(!c)return s;if(c.parent)return c.parent.posBeforeChild(c)},n,a),d=u&&u.dom,f=u&&u.contentDOM;if(r.isText){if(!d)d=document.createTextNode(r.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:f}=Zh.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!f&&!r.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),r.type.spec.draggable&&(d.draggable=!0));let m=d;return d=Eue(d,n,r),u?c=new I9e(t,r,n,a,d,f||null,m,u,i,s+1):r.isText?new Jj(t,r,n,a,d,m,i):new Ed(t,r,n,a,d,f||null,m,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Ge.empty)}return t}matchesNode(t,r,n){return this.dirty==xo&&t.eq(this.node)&&cN(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,r){let n=this.node.inlineContent,a=r,i=t.composing?this.localCompositionInfo(t,r):null,s=i&&i.pos>-1?i:null,l=i&&i.pos<0,c=new P9e(this,s&&s.node,t);$9e(this.node,this.innerDeco,(u,d,f)=>{u.spec.marks?c.syncToMarks(u.spec.marks,n,t,d):u.type.side>=0&&!f&&c.syncToMarks(d==this.node.childCount?hn.none:this.node.child(d).marks,n,t,d),c.placeWidget(u,t,a)},(u,d,f,m)=>{c.syncToMarks(u.marks,n,t,m);let p;c.findNodeMatch(u,d,f,m)||l&&t.state.selection.from>a&&t.state.selection.to<a+u.nodeSize&&(p=c.findIndexWithChild(i.node))>-1&&c.updateNodeAt(u,d,f,p,t)||c.updateNextNode(u,d,f,t,m,a)||c.addNode(u,d,f,t,a),a+=u.nodeSize}),c.syncToMarks([],n,t,0),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==Vf)&&(s&&this.protectLocalComposition(t,s),Cue(this.contentDOM,this.children,t),Ng&&F9e(this.dom))}localCompositionInfo(t,r){let{from:n,to:a}=t.state.selection;if(!(t.state.selection instanceof Yt)||n<r||a>r+this.node.content.size)return null;let i=t.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let s=i.nodeValue,l=U9e(this.node.content,s,n-r,a-r);return l<0?null:{node:i,pos:l,text:s}}else return{node:i,pos:-1,text:""}}protectLocalComposition(t,{node:r,pos:n,text:a}){if(this.getDesc(r))return;let i=r;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new O9e(this,i,r,a);t.input.compositionNodes.push(s),this.children=SR(this.children,n,n+a.length,t,s)}update(t,r,n,a){return this.dirty==Il||!t.sameMarkup(this.node)?!1:(this.updateInner(t,r,n,a),!0)}updateInner(t,r,n,a){this.updateOuterDeco(r),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(a,this.posAtStart),this.dirty=xo}updateOuterDeco(t){if(cN(t,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=jue(this.dom,this.nodeDOM,wR(this.outerDeco,this.node,r),wR(t,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function _Q(e,t,r,n,a){Eue(n,t,e);let i=new Ed(void 0,e,t,r,n,n,n,a,0);return i.contentDOM&&i.updateChildren(a,0),i}class Jj extends Ed{constructor(t,r,n,a,i,s,l){super(t,r,n,a,i,null,s,l,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,r,n,a){return this.dirty==Il||this.dirty!=xo&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=xo||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,a.trackWrites==this.nodeDOM&&(a.trackWrites=null)),this.node=t,this.dirty=xo,!0)}inParent(){let t=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,r,n){return t==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(t,r,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,r,n){let a=this.node.cut(t,r),i=document.createTextNode(a.text);return new Jj(this.parent,a,this.outerDeco,this.innerDeco,i,i,n)}markDirty(t,r){super.markDirty(t,r),this.dom!=this.nodeDOM&&(t==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=Il)}get domAtom(){return!1}isText(t){return this.node.text==t}}class Nue extends t1{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==xo&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class I9e extends Ed{constructor(t,r,n,a,i,s,l,c,u,d){super(t,r,n,a,i,s,l,u,d),this.spec=c}update(t,r,n,a){if(this.dirty==Il)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let i=this.spec.update(t,r,n);return i&&this.updateInner(t,r,n,a),i}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,r,n,a)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,r,n,a){this.spec.setSelection?this.spec.setSelection(t,r,n.root):super.setSelection(t,r,n,a)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Cue(e,t,r){let n=e.firstChild,a=!1;for(let i=0;i<t.length;i++){let s=t[i],l=s.dom;if(l.parentNode==e){for(;l!=n;)n=NQ(n),a=!0;n=n.nextSibling}else a=!0,e.insertBefore(l,n);if(s instanceof Eh){let c=n?n.previousSibling:e.lastChild;Cue(s.contentDOM,s.children,r),n=c?c.nextSibling:e.firstChild}}for(;n;)n=NQ(n),a=!0;a&&r.trackWrites==e&&(r.trackWrites=null)}const Pb=function(e){e&&(this.nodeName=e)};Pb.prototype=Object.create(null);const Yf=[new Pb];function wR(e,t,r){if(e.length==0)return Yf;let n=r?Yf[0]:new Pb,a=[n];for(let i=0;i<e.length;i++){let s=e[i].type.attrs;if(s){s.nodeName&&a.push(n=new Pb(s.nodeName));for(let l in s){let c=s[l];c!=null&&(r&&a.length==1&&a.push(n=new Pb(t.isInline?"span":"div")),l=="class"?n.class=(n.class?n.class+" ":"")+c:l=="style"?n.style=(n.style?n.style+";":"")+c:l!="nodeName"&&(n[l]=c))}}}return a}function jue(e,t,r,n){if(r==Yf&&n==Yf)return t;let a=t;for(let i=0;i<n.length;i++){let s=n[i],l=r[i];if(i){let c;l&&l.nodeName==s.nodeName&&a!=e&&(c=a.parentNode)&&c.nodeName.toLowerCase()==s.nodeName||(c=document.createElement(s.nodeName),c.pmIsDeco=!0,c.appendChild(a),l=Yf[0]),a=c}R9e(a,l||Yf[0],s)}return a}function R9e(e,t,r){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&e.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=t[n]&&e.setAttribute(n,r[n]);if(t.class!=r.class){let n=t.class?t.class.split(" ").filter(Boolean):[],a=r.class?r.class.split(" ").filter(Boolean):[];for(let i=0;i<n.length;i++)a.indexOf(n[i])==-1&&e.classList.remove(n[i]);for(let i=0;i<a.length;i++)n.indexOf(a[i])==-1&&e.classList.add(a[i]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=r.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,a;for(;a=n.exec(t.style);)e.style.removeProperty(a[1])}r.style&&(e.style.cssText+=r.style)}}function Eue(e,t,r){return jue(e,e,Yf,wR(t,r,e.nodeType!=1))}function cN(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].type.eq(t[r].type))return!1;return!0}function NQ(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class P9e{constructor(t,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=z9e(t.node.content,t)}destroyBetween(t,r){if(t!=r){for(let n=t;n<r;n++)this.top.children[n].destroy();this.top.children.splice(t,r-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,r,n,a){let i=0,s=this.stack.length>>1,l=Math.min(s,t.length);for(;i<l&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&t[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=xo,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<t.length;){this.stack.push(this.top,this.index+1);let c=-1,u=this.top.children.length;a<this.preMatch.index&&(u=Math.min(this.index+3,u));for(let d=this.index;d<u;d++){let f=this.top.children[d];if(f.matchesMark(t[s])&&!this.isLocked(f.dom)){c=d;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let d=Eh.create(this.top,t[s],r,n);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,s++}}findNodeMatch(t,r,n,a){let i=-1,s;if(a>=this.preMatch.index&&(s=this.preMatch.matches[a-this.preMatch.index]).parent==this.top&&s.matchesNode(t,r,n))i=this.top.children.indexOf(s,this.index);else for(let l=this.index,c=Math.min(this.top.children.length,l+5);l<c;l++){let u=this.top.children[l];if(u.matchesNode(t,r,n)&&!this.preMatch.matched.has(u)){i=l;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(t,r,n,a,i){let s=this.top.children[a];return s.dirty==Il&&s.dom==s.contentDOM&&(s.dirty=Vf),s.update(t,r,n,i)?(this.destroyBetween(this.index,a),this.index++,!0):!1}findIndexWithChild(t){for(;;){let r=t.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let a=this.index;a<this.top.children.length;a++)if(this.top.children[a]==n)return a}return-1}t=r}}updateNextNode(t,r,n,a,i,s){for(let l=this.index;l<this.top.children.length;l++){let c=this.top.children[l];if(c instanceof Ed){let u=this.preMatch.matched.get(c);if(u!=null&&u!=i)return!1;let d=c.dom,f,m=this.isLocked(d)&&!(t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&c.dirty!=Il&&cN(r,c.outerDeco));if(!m&&c.update(t,r,n,a))return this.destroyBetween(this.index,l),c.dom!=d&&(this.changed=!0),this.index++,!0;if(!m&&(f=this.recreateWrapper(c,t,r,n,a,s)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Vf,f.updateChildren(a,s+1),f.dirty=xo),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,r,n,a,i,s){if(t.dirty||r.isAtom||!t.children.length||!t.node.content.eq(r.content)||!cN(n,t.outerDeco)||!a.eq(t.innerDeco))return null;let l=Ed.create(this.top,r,n,a,i,s);if(l.contentDOM){l.children=t.children,t.children=[];for(let c of l.children)c.parent=l}return t.destroy(),l}addNode(t,r,n,a,i){let s=Ed.create(this.top,t,r,n,a,i);s.contentDOM&&s.updateChildren(a,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(t,r,n){let a=this.index<this.top.children.length?this.top.children[this.index]:null;if(a&&a.matchesWidget(t)&&(t==a.widget||!a.widget.type.toDOM.parentNode))this.index++;else{let i=new _ue(this.top,t,r,n);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],r=this.top;for(;t instanceof Eh;)r=t,t=r.children[r.children.length-1];(!t||!(t instanceof Jj)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((ci||Ua)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(t,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let a=new Nue(this.top,[],n,null);r!=this.top?r.children.push(a):r.children.splice(this.index++,0,a),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function z9e(e,t){let r=t,n=r.children.length,a=e.childCount,i=new Map,s=[];e:for(;a>0;){let l;for(;;)if(n){let u=r.children[n-1];if(u instanceof Eh)r=u,n=u.children.length;else{l=u,n--;break}}else{if(r==t)break e;n=r.parent.children.indexOf(r),r=r.parent}let c=l.node;if(c){if(c!=e.child(a-1))break;--a,i.set(l,a),s.push(l)}}return{index:a,matched:i,matches:s.reverse()}}function B9e(e,t){return e.type.side-t.type.side}function $9e(e,t,r,n){let a=t.locals(e),i=0;if(a.length==0){for(let u=0;u<e.childCount;u++){let d=e.child(u);n(d,a,t.forChild(i,d),u),i+=d.nodeSize}return}let s=0,l=[],c=null;for(let u=0;;){let d,f;for(;s<a.length&&a[s].to==i;){let y=a[s++];y.widget&&(d?(f||(f=[d])).push(y):d=y)}if(d)if(f){f.sort(B9e);for(let y=0;y<f.length;y++)r(f[y],u,!!c)}else r(d,u,!!c);let m,p;if(c)p=-1,m=c,c=null;else if(u<e.childCount)p=u,m=e.child(u++);else break;for(let y=0;y<l.length;y++)l[y].to<=i&&l.splice(y--,1);for(;s<a.length&&a[s].from<=i&&a[s].to>i;)l.push(a[s++]);let v=i+m.nodeSize;if(m.isText){let y=v;s<a.length&&a[s].from<y&&(y=a[s].from);for(let S=0;S<l.length;S++)l[S].to<y&&(y=l[S].to);y<v&&(c=m.cut(y-i),m=m.cut(0,y-i),v=y,p=-1)}else for(;s<a.length&&a[s].to<v;)s++;let b=m.isInline&&!m.isLeaf?l.filter(y=>!y.inline):l.slice();n(m,b,t.forChild(i,m),p),i=v}}function F9e(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function U9e(e,t,r,n){for(let a=0,i=0;a<e.childCount&&i<=n;){let s=e.child(a++),l=i;if(i+=s.nodeSize,!s.isText)continue;let c=s.text;for(;a<e.childCount;){let u=e.child(a++);if(i+=u.nodeSize,!u.isText)break;c+=u.text}if(i>=r){if(i>=n&&c.slice(n-t.length-l,n-l)==t)return n-t.length;let u=l<n?c.lastIndexOf(t,n-l-1):-1;if(u>=0&&u+t.length+l>=r)return l+u;if(r==n&&c.length>=n+t.length-l&&c.slice(n-l,n-l+t.length)==t)return n}}return-1}function SR(e,t,r,n,a){let i=[];for(let s=0,l=0;s<e.length;s++){let c=e[s],u=l,d=l+=c.size;u>=r||d<=t?i.push(c):(u<t&&i.push(c.slice(0,t-u,n)),a&&(i.push(a),a=void 0),d>r&&i.push(c.slice(r-u,c.size,n)))}return i}function c9(e,t=null){let r=e.domSelectionRange(),n=e.state.doc;if(!r.focusNode)return null;let a=e.docView.nearestDesc(r.focusNode),i=a&&a.size==0,s=e.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(s<0)return null;let l=n.resolve(s),c,u;if(Qj(r)){for(c=s;a&&!a.node;)a=a.parent;let f=a.node;if(a&&f.isAtom&&$t.isSelectable(f)&&a.parent&&!(f.isInline&&p9e(r.focusNode,r.focusOffset,a.dom))){let m=a.posBefore;u=new $t(s==m?l:n.resolve(m))}}else{if(r instanceof e.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let f=s,m=s;for(let p=0;p<r.rangeCount;p++){let v=r.getRangeAt(p);f=Math.min(f,e.docView.posFromDOM(v.startContainer,v.startOffset,1)),m=Math.max(m,e.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(f<0)return null;[c,s]=m==e.state.selection.anchor?[m,f]:[f,m],l=n.resolve(s)}else c=e.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(c<0)return null}let d=n.resolve(c);if(!u){let f=t=="pointer"||e.state.selection.head<l.pos&&!i?1:-1;u=u9(e,d,l,f)}return u}function Mue(e){return e.editable?e.hasFocus():Aue(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function eu(e,t=!1){let r=e.state.selection;if(Tue(e,r),!!Mue(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Ua){let n=e.domSelectionRange(),a=e.domObserver.currentSelection;if(n.anchorNode&&a.anchorNode&&jh(n.anchorNode,n.anchorOffset,a.anchorNode,a.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)q9e(e);else{let{anchor:n,head:a}=r,i,s;CQ&&!(r instanceof Yt)&&(r.$from.parent.inlineContent||(i=jQ(e,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(s=jQ(e,r.to))),e.docView.setSelection(n,a,e,t),CQ&&(i&&EQ(i),s&&EQ(s)),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&H9e(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const CQ=ci||Ua&&gue<63;function jQ(e,t){let{node:r,offset:n}=e.docView.domFromPos(t,0),a=n<r.childNodes.length?r.childNodes[n]:null,i=n?r.childNodes[n-1]:null;if(ci&&a&&a.contentEditable=="false")return DD(a);if((!a||a.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(a)return DD(a);if(i)return DD(i)}}function DD(e){return e.contentEditable="true",ci&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function EQ(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function H9e(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let r=e.domSelectionRange(),n=r.anchorNode,a=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=a)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!Mue(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function q9e(e){let t=e.domSelection();if(!t)return;let r=e.cursorWrapper.dom,n=r.nodeName=="IMG";n?t.collapse(r.parentNode,ri(r)+1):t.collapse(r,0),!n&&!e.state.selection.visible&&ns&&jd<=11&&(r.disabled=!0,r.disabled=!1)}function Tue(e,t){if(t instanceof $t){let r=e.docView.descAt(t.from);r!=e.lastSelectedViewDesc&&(MQ(e),r&&r.selectNode(),e.lastSelectedViewDesc=r)}else MQ(e)}function MQ(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function u9(e,t,r,n){return e.someProp("createSelectionBetween",a=>a(e,t,r))||Yt.between(t,r,n)}function TQ(e){return e.editable&&!e.hasFocus()?!1:Aue(e)}function Aue(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function W9e(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),r=e.domSelectionRange();return jh(t.node,t.offset,r.anchorNode,r.anchorOffset)}function kR(e,t){let{$anchor:r,$head:n}=e.selection,a=t>0?r.max(n):r.min(n),i=a.parent.inlineContent?a.depth?e.doc.resolve(t>0?a.after():a.before()):null:a;return i&&lr.findFrom(i,t)}function id(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function AQ(e,t,r){let n=e.state.selection;if(n instanceof Yt)if(r.indexOf("s")>-1){let{$head:a}=n,i=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=e.state.doc.resolve(a.pos+i.nodeSize*(t<0?-1:1));return id(e,new Yt(n.$anchor,s))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let a=kR(e.state,t);return a&&a instanceof $t?id(e,a):!1}else if(!(uo&&r.indexOf("m")>-1)){let a=n.$head,i=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter,s;if(!i||i.isText)return!1;let l=t<0?a.pos-i.nodeSize:a.pos;return i.isAtom||(s=e.docView.descAt(l))&&!s.contentDOM?$t.isSelectable(i)?id(e,new $t(t<0?e.state.doc.resolve(a.pos-i.nodeSize):a)):e1?id(e,new Yt(e.state.doc.resolve(t<0?l:l+i.nodeSize))):!1:!1}}else return!1;else{if(n instanceof $t&&n.node.isInline)return id(e,new Yt(t>0?n.$to:n.$from));{let a=kR(e.state,t);return a?id(e,a):!1}}}function uN(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function zb(e,t){let r=e.pmViewDesc;return r&&r.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function ep(e,t){return t<0?K9e(e):G9e(e)}function K9e(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let a,i,s=!1;for(yo&&r.nodeType==1&&n<uN(r)&&zb(r.childNodes[n],-1)&&(s=!0);;)if(n>0){if(r.nodeType!=1)break;{let l=r.childNodes[n-1];if(zb(l,-1))a=r,i=--n;else if(l.nodeType==3)r=l,n=r.nodeValue.length;else break}}else{if(Due(r))break;{let l=r.previousSibling;for(;l&&zb(l,-1);)a=r.parentNode,i=ri(l),l=l.previousSibling;if(l)r=l,n=uN(r);else{if(r=r.parentNode,r==e.dom)break;n=0}}}s?_R(e,r,n):a&&_R(e,a,i)}function G9e(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let a=uN(r),i,s;for(;;)if(n<a){if(r.nodeType!=1)break;let l=r.childNodes[n];if(zb(l,1))i=r,s=++n;else break}else{if(Due(r))break;{let l=r.nextSibling;for(;l&&zb(l,1);)i=l.parentNode,s=ri(l)+1,l=l.nextSibling;if(l)r=l,n=0,a=uN(r);else{if(r=r.parentNode,r==e.dom)break;n=a=0}}}i&&_R(e,i,s)}function Due(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function V9e(e,t){for(;e&&t==e.childNodes.length&&!Xx(e);)t=ri(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let r=e.childNodes[t];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=0}}function Y9e(e,t){for(;e&&!t&&!Xx(e);)t=ri(e),e=e.parentNode;for(;e&&t;){let r=e.childNodes[t-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=e.childNodes.length}}function _R(e,t,r){if(t.nodeType!=3){let i,s;(s=V9e(t,r))?(t=s,r=0):(i=Y9e(t,r))&&(t=i,r=i.nodeValue.length)}let n=e.domSelection();if(!n)return;if(Qj(n)){let i=document.createRange();i.setEnd(t,r),i.setStart(t,r),n.removeAllRanges(),n.addRange(i)}else n.extend&&n.extend(t,r);e.domObserver.setCurSelection();let{state:a}=e;setTimeout(()=>{e.state==a&&eu(e)},50)}function DQ(e,t){let r=e.state.doc.resolve(t);if(!(Ua||vue)&&r.parent.inlineContent){let a=e.coordsAtPos(t);if(t>r.start()){let i=e.coordsAtPos(t-1),s=(i.top+i.bottom)/2;if(s>a.top&&s<a.bottom&&Math.abs(i.left-a.left)>1)return i.left<a.left?"ltr":"rtl"}if(t<r.end()){let i=e.coordsAtPos(t+1),s=(i.top+i.bottom)/2;if(s>a.top&&s<a.bottom&&Math.abs(i.left-a.left)>1)return i.left>a.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function LQ(e,t,r){let n=e.state.selection;if(n instanceof Yt&&!n.empty||r.indexOf("s")>-1||uo&&r.indexOf("m")>-1)return!1;let{$from:a,$to:i}=n;if(!a.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let s=kR(e.state,t);if(s&&s instanceof $t)return id(e,s)}if(!a.parent.inlineContent){let s=t<0?a:i,l=n instanceof Os?lr.near(s,t):lr.findFrom(s,t);return l?id(e,l):!1}return!1}function OQ(e,t){if(!(e.state.selection instanceof Yt))return!0;let{$head:r,$anchor:n,empty:a}=e.state.selection;if(!r.sameParent(n))return!0;if(!a)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(i&&!i.isText){let s=e.state.tr;return t<0?s.delete(r.pos-i.nodeSize,r.pos):s.delete(r.pos,r.pos+i.nodeSize),e.dispatch(s),!0}return!1}function IQ(e,t,r){e.domObserver.stop(),t.contentEditable=r,e.domObserver.start()}function Q9e(e){if(!ci||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(t&&t.nodeType==1&&r==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;IQ(e,n,"true"),setTimeout(()=>IQ(e,n,"false"),20)}return!1}function J9e(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function Z9e(e,t){let r=t.keyCode,n=J9e(t);if(r==8||uo&&r==72&&n=="c")return OQ(e,-1)||ep(e,-1);if(r==46&&!t.shiftKey||uo&&r==68&&n=="c")return OQ(e,1)||ep(e,1);if(r==13||r==27)return!0;if(r==37||uo&&r==66&&n=="c"){let a=r==37?DQ(e,e.state.selection.from)=="ltr"?-1:1:-1;return AQ(e,a,n)||ep(e,a)}else if(r==39||uo&&r==70&&n=="c"){let a=r==39?DQ(e,e.state.selection.from)=="ltr"?1:-1:1;return AQ(e,a,n)||ep(e,a)}else{if(r==38||uo&&r==80&&n=="c")return LQ(e,-1,n)||ep(e,-1);if(r==40||uo&&r==78&&n=="c")return Q9e(e)||LQ(e,1,n)||ep(e,1);if(n==(uo?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function d9(e,t){e.someProp("transformCopied",p=>{t=p(t,e)});let r=[],{content:n,openStart:a,openEnd:i}=t;for(;a>1&&i>1&&n.childCount==1&&n.firstChild.childCount==1;){a--,i--;let p=n.firstChild;r.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let s=e.someProp("clipboardSerializer")||Zh.fromSchema(e.state.schema),l=zue(),c=l.createElement("div");c.appendChild(s.serializeFragment(n,{document:l}));let u=c.firstChild,d,f=0;for(;u&&u.nodeType==1&&(d=Pue[u.nodeName.toLowerCase()]);){for(let p=d.length-1;p>=0;p--){let v=l.createElement(d[p]);for(;c.firstChild;)v.appendChild(c.firstChild);c.appendChild(v),f++}u=c.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${a} ${i}${f?` -${f}`:""} ${JSON.stringify(r)}`);let m=e.someProp("clipboardTextSerializer",p=>p(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:c,text:m,slice:t}}function Lue(e,t,r,n,a){let i=a.parent.type.spec.code,s,l;if(!r&&!t)return null;let c=!!t&&(n||i||!r);if(c){if(e.someProp("transformPastedText",m=>{t=m(t,i||n,e)}),i)return l=new pt(Ge.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",m=>{l=m(l,e,!0)}),l;let f=e.someProp("clipboardTextParser",m=>m(t,a,n,e));if(f)l=f;else{let m=a.marks(),{schema:p}=e.state,v=Zh.fromSchema(p);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(b=>{let y=s.appendChild(document.createElement("p"));b&&y.appendChild(v.serializeNode(p.text(b,m)))})}}else e.someProp("transformPastedHTML",f=>{r=f(r,e)}),s=rBe(r),e1&&nBe(s);let u=s&&s.querySelector("[data-pm-slice]"),d=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let f=+d[3];f>0;f--){let m=s.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;s=m}if(l||(l=(e.someProp("clipboardParser")||e.someProp("domParser")||Cd.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(c||d),context:a,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!X9e.test(m.parentNode.nodeName)?{ignore:!0}:null}})),d)l=aBe(RQ(l,+d[1],+d[2]),d[4]);else if(l=pt.maxOpen(eBe(l.content,a),!0),l.openStart||l.openEnd){let f=0,m=0;for(let p=l.content.firstChild;f<l.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=l.content.lastChild;m<l.openEnd&&!p.type.spec.isolating;m++,p=p.lastChild);l=RQ(l,f,m)}return e.someProp("transformPasted",f=>{l=f(l,e,c)}),l}const X9e=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function eBe(e,t){if(e.childCount<2)return e;for(let r=t.depth;r>=0;r--){let a=t.node(r).contentMatchAt(t.index(r)),i,s=[];if(e.forEach(l=>{if(!s)return;let c=a.findWrapping(l.type),u;if(!c)return s=null;if(u=s.length&&i.length&&Iue(c,i,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=Rue(s[s.length-1],i.length));let d=Oue(l,c);s.push(d),a=a.matchType(d.type),i=c}}),s)return Ge.from(s)}return e}function Oue(e,t,r=0){for(let n=t.length-1;n>=r;n--)e=t[n].create(null,Ge.from(e));return e}function Iue(e,t,r,n,a){if(a<e.length&&a<t.length&&e[a]==t[a]){let i=Iue(e,t,r,n.lastChild,a+1);if(i)return n.copy(n.content.replaceChild(n.childCount-1,i));if(n.contentMatchAt(n.childCount).matchType(a==e.length-1?r.type:e[a+1]))return n.copy(n.content.append(Ge.from(Oue(r,e,a+1))))}}function Rue(e,t){if(t==0)return e;let r=e.content.replaceChild(e.childCount-1,Rue(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(Ge.empty,!0);return e.copy(r.append(n))}function NR(e,t,r,n,a,i){let s=t<0?e.firstChild:e.lastChild,l=s.content;return e.childCount>1&&(i=0),a<n-1&&(l=NR(l,t,r,n,a+1,i)),a>=r&&(l=t<0?s.contentMatchAt(0).fillBefore(l,i<=a).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(Ge.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(l))}function RQ(e,t,r){return t<e.openStart&&(e=new pt(NR(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),r<e.openEnd&&(e=new pt(NR(e.content,1,r,e.openEnd,0,0),e.openStart,r)),e}const Pue={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let PQ=null;function zue(){return PQ||(PQ=document.implementation.createHTMLDocument("title"))}let LD=null;function tBe(e){let t=window.trustedTypes;return t?(LD||(LD=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),LD.createHTML(e)):e}function rBe(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let r=zue().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),a;if((a=n&&Pue[n[1].toLowerCase()])&&(e=a.map(i=>"<"+i+">").join("")+e+a.map(i=>"</"+i+">").reverse().join("")),r.innerHTML=tBe(e),a)for(let i=0;i<a.length;i++)r=r.querySelector(a[i])||r;return r}function nBe(e){let t=e.querySelectorAll(Ua?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<t.length;r++){let n=t[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function aBe(e,t){if(!e.size)return e;let r=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:a,openStart:i,openEnd:s}=e;for(let l=n.length-2;l>=0;l-=2){let c=r.nodes[n[l]];if(!c||c.hasRequiredAttrs())break;a=Ge.from(c.create(n[l+1],a)),i++,s++}return new pt(a,i,s)}const zi={},Bi={},iBe={touchstart:!0,touchmove:!0};class sBe{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function oBe(e){for(let t in zi){let r=zi[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{cBe(e,n)&&!f9(e,n)&&(e.editable||!(n.type in Bi))&&r(e,n)},iBe[t]?{passive:!0}:void 0)}ci&&e.dom.addEventListener("input",()=>null),CR(e)}function xd(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function lBe(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function CR(e){e.someProp("handleDOMEvents",t=>{for(let r in t)e.input.eventHandlers[r]||e.dom.addEventListener(r,e.input.eventHandlers[r]=n=>f9(e,n))})}function f9(e,t){return e.someProp("handleDOMEvents",r=>{let n=r[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function cBe(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target;r!=e.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(t))return!1;return!0}function uBe(e,t){!f9(e,t)&&zi[t.type]&&(e.editable||!(t.type in Bi))&&zi[t.type](e,t)}Bi.keydown=(e,t)=>{let r=t;if(e.input.shiftKey=r.keyCode==16||r.shiftKey,!$ue(e,r)&&(e.input.lastKeyCode=r.keyCode,e.input.lastKeyCodeTime=Date.now(),!(Hc&&Ua&&r.keyCode==13)))if(r.keyCode!=229&&e.domObserver.forceFlush(),Ng&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",a=>a(e,Uf(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,r))||Z9e(e,r)?r.preventDefault():xd(e,"key")};Bi.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};Bi.keypress=(e,t)=>{let r=t;if($ue(e,r)||!r.charCode||r.ctrlKey&&!r.altKey||uo&&r.metaKey)return;if(e.someProp("handleKeyPress",a=>a(e,r))){r.preventDefault();return}let n=e.state.selection;if(!(n instanceof Yt)||!n.$from.sameParent(n.$to)){let a=String.fromCharCode(r.charCode),i=()=>e.state.tr.insertText(a).scrollIntoView();!/[\r\n]/.test(a)&&!e.someProp("handleTextInput",s=>s(e,n.$from.pos,n.$to.pos,a,i))&&e.dispatch(i()),r.preventDefault()}};function Zj(e){return{left:e.clientX,top:e.clientY}}function dBe(e,t){let r=t.x-e.clientX,n=t.y-e.clientY;return r*r+n*n<100}function h9(e,t,r,n,a){if(n==-1)return!1;let i=e.state.doc.resolve(n);for(let s=i.depth+1;s>0;s--)if(e.someProp(t,l=>s>i.depth?l(e,r,i.nodeAfter,i.before(s),a,!0):l(e,r,i.node(s),i.before(s),a,!1)))return!0;return!1}function $p(e,t,r){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);n.setMeta("pointer",!0),e.dispatch(n)}function fBe(e,t){if(t==-1)return!1;let r=e.state.doc.resolve(t),n=r.nodeAfter;return n&&n.isAtom&&$t.isSelectable(n)?($p(e,new $t(r)),!0):!1}function hBe(e,t){if(t==-1)return!1;let r=e.state.selection,n,a;r instanceof $t&&(n=r.node);let i=e.state.doc.resolve(t);for(let s=i.depth+1;s>0;s--){let l=s>i.depth?i.nodeAfter:i.node(s);if($t.isSelectable(l)){n&&r.$from.depth>0&&s>=r.$from.depth&&i.before(r.$from.depth+1)==r.$from.pos?a=i.before(r.$from.depth):a=i.before(s);break}}return a!=null?($p(e,$t.create(e.state.doc,a)),!0):!1}function mBe(e,t,r,n,a){return h9(e,"handleClickOn",t,r,n)||e.someProp("handleClick",i=>i(e,t,n))||(a?hBe(e,r):fBe(e,r))}function pBe(e,t,r,n){return h9(e,"handleDoubleClickOn",t,r,n)||e.someProp("handleDoubleClick",a=>a(e,t,n))}function gBe(e,t,r,n){return h9(e,"handleTripleClickOn",t,r,n)||e.someProp("handleTripleClick",a=>a(e,t,n))||vBe(e,r,n)}function vBe(e,t,r){if(r.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?($p(e,Yt.create(n,0,n.content.size)),!0):!1;let a=n.resolve(t);for(let i=a.depth+1;i>0;i--){let s=i>a.depth?a.nodeAfter:a.node(i),l=a.before(i);if(s.inlineContent)$p(e,Yt.create(n,l+1,l+1+s.content.size));else if($t.isSelectable(s))$p(e,$t.create(n,l));else continue;return!0}}function m9(e){return dN(e)}const Bue=uo?"metaKey":"ctrlKey";zi.mousedown=(e,t)=>{let r=t;e.input.shiftKey=r.shiftKey;let n=m9(e),a=Date.now(),i="singleClick";a-e.input.lastClick.time<500&&dBe(r,e.input.lastClick)&&!r[Bue]&&e.input.lastClick.button==r.button&&(e.input.lastClick.type=="singleClick"?i="doubleClick":e.input.lastClick.type=="doubleClick"&&(i="tripleClick")),e.input.lastClick={time:a,x:r.clientX,y:r.clientY,type:i,button:r.button};let s=e.posAtCoords(Zj(r));s&&(i=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new bBe(e,s,r,!!n)):(i=="doubleClick"?pBe:gBe)(e,s.pos,s.inside,r)?r.preventDefault():xd(e,"pointer"))};class bBe{constructor(t,r,n,a){this.view=t,this.pos=r,this.event=n,this.flushed=a,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Bue],this.allowDefault=n.shiftKey;let i,s;if(r.inside>-1)i=t.state.doc.nodeAt(r.inside),s=r.inside;else{let d=t.state.doc.resolve(r.pos);i=d.parent,s=d.depth?d.before():0}const l=a?null:n.target,c=l?t.docView.nearestDesc(l,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;let{selection:u}=t.state;(n.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||u instanceof $t&&u.from<=s&&u.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&yo&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),xd(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>eu(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(Zj(t))),this.updateAllowDefault(t),this.allowDefault||!r?xd(this.view,"pointer"):mBe(this.view,r.pos,r.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||ci&&this.mightDrag&&!this.mightDrag.node.isAtom||Ua&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?($p(this.view,lr.near(this.view.state.doc.resolve(r.pos))),t.preventDefault()):xd(this.view,"pointer")}move(t){this.updateAllowDefault(t),xd(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}zi.touchstart=e=>{e.input.lastTouch=Date.now(),m9(e),xd(e,"pointer")};zi.touchmove=e=>{e.input.lastTouch=Date.now(),xd(e,"pointer")};zi.contextmenu=e=>m9(e);function $ue(e,t){return e.composing?!0:ci&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}const yBe=Hc?5e3:-1;Bi.compositionstart=Bi.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,r=t.selection.$to;if(t.selection instanceof Yt&&(t.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||Ua&&vue&&xBe(e)))e.markCursor=e.state.storedMarks||r.marks(),dN(e,!0),e.markCursor=null;else if(dN(e,!t.selection.empty),yo&&t.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=e.domSelectionRange();for(let a=n.focusNode,i=n.focusOffset;a&&a.nodeType==1&&i!=0;){let s=i<0?a.lastChild:a.childNodes[i-1];if(!s)break;if(s.nodeType==3){let l=e.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else a=s,i=-1}}e.input.composing=!0}Fue(e,yBe)};function xBe(e){let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(!t||t.nodeType!=1||r>=t.childNodes.length)return!1;let n=t.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}Bi.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.badSafariComposition?e.domObserver.forceFlush():e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Fue(e,20))};function Fue(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>dN(e),t))}function Uue(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=SBe());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function wBe(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let r=h9e(t.focusNode,t.focusOffset),n=m9e(t.focusNode,t.focusOffset);if(r&&n&&r!=n){let a=n.pmViewDesc,i=e.domObserver.lastChangedTextNode;if(r==i||n==i)return i;if(!a||!a.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let s=r.pmViewDesc;if(!(!s||!s.isText(r.nodeValue)))return n}}return r||n}function SBe(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function dN(e,t=!1){if(!(Hc&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Uue(e),t||e.docView&&e.docView.dirty){let r=c9(e),n=e.state.selection;return r&&!r.eq(n)?e.dispatch(e.state.tr.setSelection(r)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function kBe(e,t){if(!e.dom.parentNode)return;let r=e.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),a=document.createRange();a.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(a),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),e.focus()},50)}const Vy=ns&&jd<15||Ng&&b9e<604;zi.copy=Bi.cut=(e,t)=>{let r=t,n=e.state.selection,a=r.type=="cut";if(n.empty)return;let i=Vy?null:r.clipboardData,s=n.content(),{dom:l,text:c}=d9(e,s);i?(r.preventDefault(),i.clearData(),i.setData("text/html",l.innerHTML),i.setData("text/plain",c)):kBe(e,l),a&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function _Be(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function NBe(e,t){if(!e.dom.parentNode)return;let r=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let a=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),r?Yy(e,n.value,null,a,t):Yy(e,n.textContent,n.innerHTML,a,t)},50)}function Yy(e,t,r,n,a){let i=Lue(e,t,r,n,e.state.selection.$from);if(e.someProp("handlePaste",c=>c(e,a,i||pt.empty)))return!0;if(!i)return!1;let s=_Be(i),l=s?e.state.tr.replaceSelectionWith(s,n):e.state.tr.replaceSelection(i);return e.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Hue(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let r=e.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}Bi.paste=(e,t)=>{let r=t;if(e.composing&&!Hc)return;let n=Vy?null:r.clipboardData,a=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&Yy(e,Hue(n),n.getData("text/html"),a,r)?r.preventDefault():NBe(e,r)};class que{constructor(t,r,n){this.slice=t,this.move=r,this.node=n}}const CBe=uo?"altKey":"ctrlKey";function Wue(e,t){let r=e.someProp("dragCopies",n=>!n(t));return r??!t[CBe]}zi.dragstart=(e,t)=>{let r=t,n=e.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let a=e.state.selection,i=a.empty?null:e.posAtCoords(Zj(r)),s;if(!(i&&i.pos>=a.from&&i.pos<=(a instanceof $t?a.to-1:a.to))){if(n&&n.mightDrag)s=$t.create(e.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let f=e.docView.nearestDesc(r.target,!0);f&&f.node.type.spec.draggable&&f!=e.docView&&(s=$t.create(e.state.doc,f.posBefore))}}let l=(s||e.state.selection).content(),{dom:c,text:u,slice:d}=d9(e,l);(!r.dataTransfer.files.length||!Ua||gue>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(Vy?"Text":"text/html",c.innerHTML),r.dataTransfer.effectAllowed="copyMove",Vy||r.dataTransfer.setData("text/plain",u),e.dragging=new que(d,Wue(e,r),s)};zi.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};Bi.dragover=Bi.dragenter=(e,t)=>t.preventDefault();Bi.drop=(e,t)=>{try{jBe(e,t,e.dragging)}finally{e.dragging=null}};function jBe(e,t,r){if(!t.dataTransfer)return;let n=e.posAtCoords(Zj(t));if(!n)return;let a=e.state.doc.resolve(n.pos),i=r&&r.slice;i?e.someProp("transformPasted",p=>{i=p(i,e,!1)}):i=Lue(e,Hue(t.dataTransfer),Vy?null:t.dataTransfer.getData("text/html"),!1,a);let s=!!(r&&Wue(e,t));if(e.someProp("handleDrop",p=>p(e,t,i||pt.empty,s))){t.preventDefault();return}if(!i)return;t.preventDefault();let l=i?Yce(e.state.doc,a.pos,i):a.pos;l==null&&(l=a.pos);let c=e.state.tr;if(s){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,i.content.firstChild):c.replaceRange(u,u,i),c.doc.eq(f))return;let m=c.doc.resolve(u);if(d&&$t.isSelectable(i.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new $t(m));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,b,y,S)=>p=S),c.setSelection(u9(e,m,c.doc.resolve(p)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}zi.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&eu(e)},20))};zi.blur=(e,t)=>{let r=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),r.relatedTarget&&e.dom.contains(r.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};zi.beforeinput=(e,t)=>{if(Ua&&Hc&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",i=>i(e,Uf(8,"Backspace")))))return;let{$cursor:a}=e.state.selection;a&&a.pos>0&&e.dispatch(e.state.tr.delete(a.pos-1,a.pos).scrollIntoView())},50)}};for(let e in Bi)zi[e]=Bi[e];function Qy(e,t){if(e==t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}class fN{constructor(t,r){this.toDOM=t,this.spec=r||sh,this.side=this.spec.side||0}map(t,r,n,a){let{pos:i,deleted:s}=t.mapResult(r.from+a,this.side<0?-1:1);return s?null:new ga(i-n,i-n,this)}valid(){return!0}eq(t){return this==t||t instanceof fN&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Qy(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Md{constructor(t,r){this.attrs=t,this.spec=r||sh}map(t,r,n,a){let i=t.map(r.from+a,this.spec.inclusiveStart?-1:1)-n,s=t.map(r.to+a,this.spec.inclusiveEnd?1:-1)-n;return i>=s?null:new ga(i,s,this)}valid(t,r){return r.from<r.to}eq(t){return this==t||t instanceof Md&&Qy(this.attrs,t.attrs)&&Qy(this.spec,t.spec)}static is(t){return t.type instanceof Md}destroy(){}}class p9{constructor(t,r){this.attrs=t,this.spec=r||sh}map(t,r,n,a){let i=t.mapResult(r.from+a,1);if(i.deleted)return null;let s=t.mapResult(r.to+a,-1);return s.deleted||s.pos<=i.pos?null:new ga(i.pos-n,s.pos-n,this)}valid(t,r){let{index:n,offset:a}=t.content.findIndex(r.from),i;return a==r.from&&!(i=t.child(n)).isText&&a+i.nodeSize==r.to}eq(t){return this==t||t instanceof p9&&Qy(this.attrs,t.attrs)&&Qy(this.spec,t.spec)}destroy(){}}class ga{constructor(t,r,n){this.from=t,this.to=r,this.type=n}copy(t,r){return new ga(t,r,this.type)}eq(t,r=0){return this.type.eq(t.type)&&this.from+r==t.from&&this.to+r==t.to}map(t,r,n){return this.type.map(t,this,r,n)}static widget(t,r,n){return new ga(t,t,new fN(r,n))}static inline(t,r,n,a){return new ga(t,r,new Md(n,a))}static node(t,r,n,a){return new ga(t,r,new p9(n,a))}get spec(){return this.type.spec}get inline(){return this.type instanceof Md}get widget(){return this.type instanceof fN}}const vp=[],sh={};class Jr{constructor(t,r){this.local=t.length?t:vp,this.children=r.length?r:vp}static create(t,r){return r.length?hN(r,t,0,sh):vi}find(t,r,n){let a=[];return this.findInner(t??0,r??1e9,a,0,n),a}findInner(t,r,n,a,i){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=r&&l.to>=t&&(!i||i(l.spec))&&n.push(l.copy(l.from+a,l.to+a))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<r&&this.children[s+1]>t){let l=this.children[s]+1;this.children[s+2].findInner(t-l,r-l,n,a+l,i)}}map(t,r,n){return this==vi||t.maps.length==0?this:this.mapInner(t,r,0,0,n||sh)}mapInner(t,r,n,a,i){let s;for(let l=0;l<this.local.length;l++){let c=this.local[l].map(t,n,a);c&&c.type.valid(r,c)?(s||(s=[])).push(c):i.onRemove&&i.onRemove(this.local[l].spec)}return this.children.length?EBe(this.children,s||[],t,r,n,a,i):s?new Jr(s.sort(oh),vp):vi}add(t,r){return r.length?this==vi?Jr.create(t,r):this.addInner(t,r,0):this}addInner(t,r,n){let a,i=0;t.forEach((l,c)=>{let u=c+n,d;if(d=Gue(r,l,u)){for(a||(a=this.children.slice());i<a.length&&a[i]<c;)i+=3;a[i]==c?a[i+2]=a[i+2].addInner(l,d,u+1):a.splice(i,0,c,c+l.nodeSize,hN(d,l,u+1,sh)),i+=3}});let s=Kue(i?Vue(r):r,-n);for(let l=0;l<s.length;l++)s[l].type.valid(t,s[l])||s.splice(l--,1);return new Jr(s.length?this.local.concat(s).sort(oh):this.local,a||this.children)}remove(t){return t.length==0||this==vi?this:this.removeInner(t,0)}removeInner(t,r){let n=this.children,a=this.local;for(let i=0;i<n.length;i+=3){let s,l=n[i]+r,c=n[i+1]+r;for(let d=0,f;d<t.length;d++)(f=t[d])&&f.from>l&&f.to<c&&(t[d]=null,(s||(s=[])).push(f));if(!s)continue;n==this.children&&(n=this.children.slice());let u=n[i+2].removeInner(s,l+1);u!=vi?n[i+2]=u:(n.splice(i,3),i-=3)}if(a.length){for(let i=0,s;i<t.length;i++)if(s=t[i])for(let l=0;l<a.length;l++)a[l].eq(s,r)&&(a==this.local&&(a=this.local.slice()),a.splice(l--,1))}return n==this.children&&a==this.local?this:a.length||n.length?new Jr(a,n):vi}forChild(t,r){if(this==vi)return this;if(r.isLeaf)return Jr.empty;let n,a;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=t){this.children[l]==t&&(n=this.children[l+2]);break}let i=t+1,s=i+r.content.size;for(let l=0;l<this.local.length;l++){let c=this.local[l];if(c.from<s&&c.to>i&&c.type instanceof Md){let u=Math.max(i,c.from)-i,d=Math.min(s,c.to)-i;u<d&&(a||(a=[])).push(c.copy(u,d))}}if(a){let l=new Jr(a.sort(oh),vp);return n?new dd([l,n]):l}return n||vi}eq(t){if(this==t)return!0;if(!(t instanceof Jr)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(t.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0}locals(t){return g9(this.localsInner(t))}localsInner(t){if(this==vi)return vp;if(t.inlineContent||!this.local.some(Md.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Md||r.push(this.local[n]);return r}forEachSet(t){t(this)}}Jr.empty=new Jr([],[]);Jr.removeOverlap=g9;const vi=Jr.empty;class dd{constructor(t){this.members=t}map(t,r){const n=this.members.map(a=>a.map(t,r,sh));return dd.from(n)}forChild(t,r){if(r.isLeaf)return Jr.empty;let n=[];for(let a=0;a<this.members.length;a++){let i=this.members[a].forChild(t,r);i!=vi&&(i instanceof dd?n=n.concat(i.members):n.push(i))}return dd.from(n)}eq(t){if(!(t instanceof dd)||t.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(t.members[r]))return!1;return!0}locals(t){let r,n=!0;for(let a=0;a<this.members.length;a++){let i=this.members[a].localsInner(t);if(i.length)if(!r)r=i;else{n&&(r=r.slice(),n=!1);for(let s=0;s<i.length;s++)r.push(i[s])}}return r?g9(n?r:r.sort(oh)):vp}static from(t){switch(t.length){case 0:return vi;case 1:return t[0];default:return new dd(t.every(r=>r instanceof Jr)?t:t.reduce((r,n)=>r.concat(n instanceof Jr?n:n.members),[]))}}forEachSet(t){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(t)}}function EBe(e,t,r,n,a,i,s){let l=e.slice();for(let u=0,d=i;u<r.maps.length;u++){let f=0;r.maps[u].forEach((m,p,v,b)=>{let y=b-v-(p-m);for(let S=0;S<l.length;S+=3){let _=l[S+1];if(_<0||m>_+d-f)continue;let N=l[S]+d-f;p>=N?l[S+1]=m<=N?-2:-1:m>=d&&y&&(l[S]+=y,l[S+1]+=y)}f+=y}),d=r.maps[u].map(d,-1)}let c=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){c=!0,l[u+1]=-1;continue}let d=r.map(e[u]+i),f=d-a;if(f<0||f>=n.content.size){c=!0;continue}let m=r.map(e[u+1]+i,-1),p=m-a,{index:v,offset:b}=n.content.findIndex(f),y=n.maybeChild(v);if(y&&b==f&&b+y.nodeSize==p){let S=l[u+2].mapInner(r,y,d+1,e[u]+i+1,s);S!=vi?(l[u]=f,l[u+1]=p,l[u+2]=S):(l[u+1]=-2,c=!0)}else c=!0}if(c){let u=MBe(l,e,t,r,a,i,s),d=hN(u,n,0,s);t=d.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,m=0;f<d.children.length;f+=3){let p=d.children[f];for(;m<l.length&&l[m]<p;)m+=3;l.splice(m,0,d.children[f],d.children[f+1],d.children[f+2])}}return new Jr(t.sort(oh),l)}function Kue(e,t){if(!t||!e.length)return e;let r=[];for(let n=0;n<e.length;n++){let a=e[n];r.push(new ga(a.from+t,a.to+t,a.type))}return r}function MBe(e,t,r,n,a,i,s){function l(c,u){for(let d=0;d<c.local.length;d++){let f=c.local[d].map(n,a,u);f?r.push(f):s.onRemove&&s.onRemove(c.local[d].spec)}for(let d=0;d<c.children.length;d+=3)l(c.children[d+2],c.children[d]+u+1)}for(let c=0;c<e.length;c+=3)e[c+1]==-1&&l(e[c+2],t[c]+i+1);return r}function Gue(e,t,r){if(t.isLeaf)return null;let n=r+t.nodeSize,a=null;for(let i=0,s;i<e.length;i++)(s=e[i])&&s.from>r&&s.to<n&&((a||(a=[])).push(s),e[i]=null);return a}function Vue(e){let t=[];for(let r=0;r<e.length;r++)e[r]!=null&&t.push(e[r]);return t}function hN(e,t,r,n){let a=[],i=!1;t.forEach((l,c)=>{let u=Gue(e,l,c+r);if(u){i=!0;let d=hN(u,l,r+c+1,n);d!=vi&&a.push(c,c+l.nodeSize,d)}});let s=Kue(i?Vue(e):e,-r).sort(oh);for(let l=0;l<s.length;l++)s[l].type.valid(t,s[l])||(n.onRemove&&n.onRemove(s[l].spec),s.splice(l--,1));return s.length||a.length?new Jr(s,a):vi}function oh(e,t){return e.from-t.from||e.to-t.to}function g9(e){let t=e;for(let r=0;r<t.length-1;r++){let n=t[r];if(n.from!=n.to)for(let a=r+1;a<t.length;a++){let i=t[a];if(i.from==n.from){i.to!=n.to&&(t==e&&(t=e.slice()),t[a]=i.copy(i.from,n.to),zQ(t,a+1,i.copy(n.to,i.to)));continue}else{i.from<n.to&&(t==e&&(t=e.slice()),t[r]=n.copy(n.from,i.from),zQ(t,a,n.copy(i.from,n.to)));break}}}return t}function zQ(e,t,r){for(;t<e.length&&oh(r,e[t])>0;)t++;e.splice(t,0,r)}function OD(e){let t=[];return e.someProp("decorations",r=>{let n=r(e.state);n&&n!=vi&&t.push(n)}),e.cursorWrapper&&t.push(Jr.create(e.state.doc,[e.cursorWrapper.deco])),dd.from(t)}const TBe={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},ABe=ns&&jd<=11;class DBe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class LBe{constructor(t,r){this.view=t,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new DBe,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let a=0;a<n.length;a++)this.queue.push(n[a]);ns&&jd<=11&&n.some(a=>a.type=="childList"&&a.removedNodes.length||a.type=="characterData"&&a.oldValue.length>a.target.nodeValue.length)?this.flushSoon():ci&&t.composing&&n.some(a=>a.type=="childList"&&a.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),ABe&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,TBe)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let r=0;r<t.length;r++)this.queue.push(t[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(TQ(this.view)){if(this.suppressingSelectionUpdates)return eu(this.view);if(ns&&jd<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&jh(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let r=new Set,n;for(let i=t.focusNode;i;i=_g(i))r.add(i);for(let i=t.anchorNode;i;i=_g(i))if(r.has(i)){n=i;break}let a=n&&this.view.docView.nearestDesc(n);if(a&&a.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=t.domSelectionRange(),a=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&TQ(t)&&!this.ignoreSelectionChange(n),i=-1,s=-1,l=!1,c=[];if(t.editable)for(let d=0;d<r.length;d++){let f=this.registerMutation(r[d],c);f&&(i=i<0?f.from:Math.min(f.from,i),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(l=!0))}if(yo&&c.length){let d=c.filter(f=>f.nodeName=="BR");if(d.length==2){let[f,m]=d;f.parentNode&&f.parentNode.parentNode==m.parentNode?m.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let m of d){let p=m.parentNode;p&&p.nodeName=="LI"&&(!f||RBe(t,f)!=p)&&m.remove()}}}else if((Ua||ci)&&c.some(d=>d.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let d of c)if(d.nodeName=="BR"&&d.parentNode){let f=d.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&d.parentNode.removeChild(d)}}let u=null;i<0&&a&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Qj(n)&&(u=c9(t))&&u.eq(lr.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,eu(t),this.currentSelection.set(n),t.scrollToSelection()):(i>-1||a)&&(i>-1&&(t.docView.markDirty(i,s),OBe(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,PBe(t,c)),this.handleDOMChange(i,s,l,c),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||eu(t),this.currentSelection.set(n))}registerMutation(t,r){if(r.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let f=t.addedNodes[d];r.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let a=t.previousSibling,i=t.nextSibling;if(ns&&jd<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:f,nextSibling:m}=t.addedNodes[d];(!f||Array.prototype.indexOf.call(t.addedNodes,f)<0)&&(a=f),(!m||Array.prototype.indexOf.call(t.addedNodes,m)<0)&&(i=m)}let s=a&&a.parentNode==t.target?ri(a)+1:0,l=n.localPosFromDOM(t.target,s,-1),c=i&&i.parentNode==t.target?ri(i):t.target.childNodes.length,u=n.localPosFromDOM(t.target,c,1);return{from:l,to:u}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let BQ=new WeakMap,$Q=!1;function OBe(e){if(!BQ.has(e)&&(BQ.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=yo,$Q)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),$Q=!0}}function FQ(e,t){let r=t.startContainer,n=t.startOffset,a=t.endContainer,i=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return jh(s.node,s.offset,a,i)&&([r,n,a,i]=[a,i,r,n]),{anchorNode:r,anchorOffset:n,focusNode:a,focusOffset:i}}function IBe(e,t){if(t.getComposedRanges){let a=t.getComposedRanges(e.root)[0];if(a)return FQ(e,a)}let r;function n(a){a.preventDefault(),a.stopImmediatePropagation(),r=a.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),r?FQ(e,r):null}function RBe(e,t){for(let r=t.parentNode;r&&r!=e.dom;r=r.parentNode){let n=e.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function PBe(e,t){var r;let{focusNode:n,focusOffset:a}=e.domSelectionRange();for(let i of t)if(((r=i.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let s=i.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let l=s;for(;;){let c=l.firstChild;if(!c||c.nodeType!=1||c.contentEditable=="false"||/^(BR|IMG)$/.test(c.nodeName))break;l=c}l.insertBefore(i,l.firstChild),n==i&&e.domSelection().collapse(i,a)}else i.parentNode.removeChild(i)}}function zBe(e,t,r){let{node:n,fromOffset:a,toOffset:i,from:s,to:l}=e.docView.parseRange(t,r),c=e.domSelectionRange(),u,d=c.anchorNode;if(d&&e.dom.contains(d.nodeType==1?d:d.parentNode)&&(u=[{node:d,offset:c.anchorOffset}],Qj(c)||u.push({node:c.focusNode,offset:c.focusOffset})),Ua&&e.input.lastKeyCode===8)for(let y=i;y>a;y--){let S=n.childNodes[y-1],_=S.pmViewDesc;if(S.nodeName=="BR"&&!_){i=y;break}if(!_||_.size)break}let f=e.state.doc,m=e.someProp("domParser")||Cd.fromSchema(e.state.schema),p=f.resolve(s),v=null,b=m.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:a,to:i,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:BBe,context:p});if(u&&u[0].pos!=null){let y=u[0].pos,S=u[1]&&u[1].pos;S==null&&(S=y),v={anchor:y+s,head:S+s}}return{doc:b,sel:v,from:s,to:l}}function BBe(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(ci&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(e.parentNode.lastChild==e||ci&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const $Be=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function FBe(e,t,r,n,a){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let T=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,O=c9(e,T);if(O&&!e.state.selection.eq(O)){if(Ua&&Hc&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",q=>q(e,Uf(13,"Enter"))))return;let R=e.state.tr.setSelection(O);T=="pointer"?R.setMeta("pointer",!0):T=="key"&&R.scrollIntoView(),i&&R.setMeta("composition",i),e.dispatch(R)}return}let s=e.state.doc.resolve(t),l=s.sharedDepth(r);t=s.before(l+1),r=e.state.doc.resolve(r).after(l+1);let c=e.state.selection,u=zBe(e,t,r),d=e.state.doc,f=d.slice(u.from,u.to),m,p;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(m=e.state.selection.to,p="end"):(m=e.state.selection.from,p="start"),e.input.lastKeyCode=null;let v=qBe(f.content,u.doc.content,u.from,m,p);if(v&&e.input.domChangeCount++,(Ng&&e.input.lastIOSEnter>Date.now()-225||Hc)&&a.some(T=>T.nodeType==1&&!$Be.test(T.nodeName))&&(!v||v.endA>=v.endB)&&e.someProp("handleKeyDown",T=>T(e,Uf(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!v)if(n&&c instanceof Yt&&!c.empty&&c.$head.sameParent(c.$anchor)&&!e.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))v={start:c.from,endA:c.to,endB:c.to};else{if(u.sel){let T=UQ(e,e.state.doc,u.sel);if(T&&!T.eq(e.state.selection)){let O=e.state.tr.setSelection(T);i&&O.setMeta("composition",i),e.dispatch(O)}}return}e.state.selection.from<e.state.selection.to&&v.start==v.endB&&e.state.selection instanceof Yt&&(v.start>e.state.selection.from&&v.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?v.start=e.state.selection.from:v.endA<e.state.selection.to&&v.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(v.endB+=e.state.selection.to-v.endA,v.endA=e.state.selection.to)),ns&&jd<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>u.from&&u.doc.textBetween(v.start-u.from-1,v.start-u.from+1)==" "&&(v.start--,v.endA--,v.endB--);let b=u.doc.resolveNoCache(v.start-u.from),y=u.doc.resolveNoCache(v.endB-u.from),S=d.resolve(v.start),_=b.sameParent(y)&&b.parent.inlineContent&&S.end()>=v.endA;if((Ng&&e.input.lastIOSEnter>Date.now()-225&&(!_||a.some(T=>T.nodeName=="DIV"||T.nodeName=="P"))||!_&&b.pos<u.doc.content.size&&(!b.sameParent(y)||!b.parent.inlineContent)&&b.pos<y.pos&&!/\S/.test(u.doc.textBetween(b.pos,y.pos,"","")))&&e.someProp("handleKeyDown",T=>T(e,Uf(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>v.start&&HBe(d,v.start,v.endA,b,y)&&e.someProp("handleKeyDown",T=>T(e,Uf(8,"Backspace")))){Hc&&Ua&&e.domObserver.suppressSelectionUpdates();return}Ua&&v.endB==v.start&&(e.input.lastChromeDelete=Date.now()),Hc&&!_&&b.start()!=y.start()&&y.parentOffset==0&&b.depth==y.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==v.endA&&(v.endB-=2,y=u.doc.resolveNoCache(v.endB-u.from),setTimeout(()=>{e.someProp("handleKeyDown",function(T){return T(e,Uf(13,"Enter"))})},20));let N=v.start,k=v.endA,j=T=>{let O=T||e.state.tr.replace(N,k,u.doc.slice(v.start-u.from,v.endB-u.from));if(u.sel){let R=UQ(e,O.doc,u.sel);R&&!(Ua&&e.composing&&R.empty&&(v.start!=v.endB||e.input.lastChromeDelete<Date.now()-100)&&(R.head==N||R.head==O.mapping.map(k)-1)||ns&&R.empty&&R.head==N)&&O.setSelection(R)}return i&&O.setMeta("composition",i),O.scrollIntoView()},E;if(_)if(b.pos==y.pos){ns&&jd<=11&&b.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>eu(e),20));let T=j(e.state.tr.delete(N,k)),O=d.resolve(v.start).marksAcross(d.resolve(v.endA));O&&T.ensureMarks(O),e.dispatch(T)}else if(v.endA==v.endB&&(E=UBe(b.parent.content.cut(b.parentOffset,y.parentOffset),S.parent.content.cut(S.parentOffset,v.endA-S.start())))){let T=j(e.state.tr);E.type=="add"?T.addMark(N,k,E.mark):T.removeMark(N,k,E.mark),e.dispatch(T)}else if(b.parent.child(b.index()).isText&&b.index()==y.index()-(y.textOffset?0:1)){let T=b.parent.textBetween(b.parentOffset,y.parentOffset),O=()=>j(e.state.tr.insertText(T,N,k));e.someProp("handleTextInput",R=>R(e,N,k,T,O))||e.dispatch(O())}else e.dispatch(j());else e.dispatch(j())}function UQ(e,t,r){return Math.max(r.anchor,r.head)>t.content.size?null:u9(e,t.resolve(r.anchor),t.resolve(r.head))}function UBe(e,t){let r=e.firstChild.marks,n=t.firstChild.marks,a=r,i=n,s,l,c;for(let d=0;d<n.length;d++)a=n[d].removeFromSet(a);for(let d=0;d<r.length;d++)i=r[d].removeFromSet(i);if(a.length==1&&i.length==0)l=a[0],s="add",c=d=>d.mark(l.addToSet(d.marks));else if(a.length==0&&i.length==1)l=i[0],s="remove",c=d=>d.mark(l.removeFromSet(d.marks));else return null;let u=[];for(let d=0;d<t.childCount;d++)u.push(c(t.child(d)));if(Ge.from(u).eq(e))return{mark:l,type:s}}function HBe(e,t,r,n,a){if(r-t<=a.pos-n.pos||ID(n,!0,!1)<a.pos)return!1;let i=e.resolve(t);if(!n.parent.isTextblock){let l=i.nodeAfter;return l!=null&&r==t+l.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=e.resolve(ID(i,!0,!0));return!s.parent.isTextblock||s.pos>r||ID(s,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function ID(e,t,r){let n=e.depth,a=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,a++,t=!1;if(r){let i=e.node(n).maybeChild(e.indexAfter(n));for(;i&&!i.isLeaf;)i=i.firstChild,a++}return a}function qBe(e,t,r,n,a){let i=e.findDiffStart(t,r);if(i==null)return null;let{a:s,b:l}=e.findDiffEnd(t,r+e.size,r+t.size);if(a=="end"){let c=Math.max(0,i-Math.min(s,l));n-=s+c-i}if(s<i&&e.size<t.size){let c=n<=i&&n>=s?i-n:0;i-=c,i&&i<t.size&&HQ(t.textBetween(i-1,i+1))&&(i+=c?1:-1),l=i+(l-s),s=i}else if(l<i){let c=n<=i&&n>=l?i-n:0;i-=c,i&&i<e.size&&HQ(e.textBetween(i-1,i+1))&&(i+=c?1:-1),s=i+(s-l),l=i}return{start:i,endA:s,endB:l}}function HQ(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),r=e.charCodeAt(1);return t>=56320&&t<=57343&&r>=55296&&r<=56319}class Yue{constructor(t,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new sBe,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(VQ),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=KQ(this),WQ(this),this.nodeViews=GQ(this),this.docView=_Q(this.state.doc,qQ(this),OD(this),this.dom,this),this.domObserver=new LBe(this,(n,a,i,s)=>FBe(this,n,a,i,s)),this.domObserver.start(),oBe(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let r in t)this._props[r]=t[r];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&CR(this);let r=this._props;this._props=t,t.plugins&&(t.plugins.forEach(VQ),this.directPlugins=t.plugins),this.updateStateInner(t.state,r)}setProps(t){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in t)r[n]=t[n];this.update(r)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,r){var n;let a=this.state,i=!1,s=!1;t.storedMarks&&this.composing&&(Uue(this),s=!0),this.state=t;let l=a.plugins!=t.plugins||this._props.plugins!=r.plugins;if(l||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let p=GQ(this);KBe(p,this.nodeViews)&&(this.nodeViews=p,i=!0)}(l||r.handleDOMEvents!=this._props.handleDOMEvents)&&CR(this),this.editable=KQ(this),WQ(this);let c=OD(this),u=qQ(this),d=a.plugins!=t.plugins&&!a.doc.eq(t.doc)?"reset":t.scrollToSelection>a.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(t.doc,u,c);(f||!t.selection.eq(a.selection))&&(s=!0);let m=d=="preserve"&&s&&this.dom.style.overflowAnchor==null&&w9e(this);if(s){this.domObserver.stop();let p=f&&(ns||Ua)&&!this.composing&&!a.selection.empty&&!t.selection.empty&&WBe(a.selection,t.selection);if(f){let v=Ua?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=wBe(this)),(i||!this.docView.update(t.doc,u,c,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=_Q(t.doc,u,c,this.dom,this)),v&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&W9e(this))?eu(this,p):(Tue(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(a),!((n=this.dragging)===null||n===void 0)&&n.node&&!a.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,a),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():m&&S9e(m)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof $t){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&bQ(this,r.getBoundingClientRect(),t)}else bQ(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,t)}}updateDraggedNode(t,r){let n=t.node,a=-1;if(this.state.doc.nodeAt(n.from)==n.node)a=n.from;else{let i=n.from+(this.state.doc.content.size-r.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==n.node&&(a=i)}this.dragging=new que(t.slice,t.move,a<0?void 0:$t.create(this.state.doc,a))}someProp(t,r){let n=this._props&&this._props[t],a;if(n!=null&&(a=r?r(n):n))return a;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[t];if(l!=null&&(a=r?r(l):l))return a}let i=this.state.plugins;if(i)for(let s=0;s<i.length;s++){let l=i[s].props[t];if(l!=null&&(a=r?r(l):l))return a}}hasFocus(){if(ns){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&k9e(this.dom),eu(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return t||document}updateRoot(){this._root=null}posAtCoords(t){return E9e(this,t)}coordsAtPos(t,r=1){return Sue(this,t,r)}domAtPos(t,r=0){return this.docView.domFromPos(t,r)}nodeDOM(t){let r=this.docView.descAt(t);return r?r.nodeDOM:null}posAtDOM(t,r,n=-1){let a=this.docView.posFromDOM(t,r,n);if(a==null)throw new RangeError("DOM position not inside the editor");return a}endOfTextblock(t,r){return L9e(this,r||this.state,t)}pasteHTML(t,r){return Yy(this,"",t,!1,r||new ClipboardEvent("paste"))}pasteText(t,r){return Yy(this,t,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(t){return d9(this,t)}destroy(){this.docView&&(lBe(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],OD(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,d9e())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return uBe(this,t)}domSelectionRange(){let t=this.domSelection();return t?ci&&this.root.nodeType===11&&g9e(this.dom.ownerDocument)==this.dom&&IBe(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Yue.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function qQ(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(e.state)),r)for(let n in r)n=="class"?t.class+=" "+r[n]:n=="style"?t.style=(t.style?t.style+";":"")+r[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(r[n]))}),t.translate||(t.translate="no"),[ga.node(0,e.state.doc.content.size,t)]}function WQ(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ga.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function KQ(e){return!e.someProp("editable",t=>t(e.state)===!1)}function WBe(e,t){let r=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(r)!=t.$anchor.start(r)}function GQ(e){let t=Object.create(null);function r(n){for(let a in n)Object.prototype.hasOwnProperty.call(t,a)||(t[a]=n[a])}return e.someProp("nodeViews",r),e.someProp("markViews",r),t}function KBe(e,t){let r=0,n=0;for(let a in e){if(e[a]!=t[a])return!0;r++}for(let a in t)n++;return r!=n}function VQ(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Id={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},mN={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},GBe=typeof navigator<"u"&&/Mac/.test(navigator.platform),VBe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ni=0;ni<10;ni++)Id[48+ni]=Id[96+ni]=String(ni);for(var ni=1;ni<=24;ni++)Id[ni+111]="F"+ni;for(var ni=65;ni<=90;ni++)Id[ni]=String.fromCharCode(ni+32),mN[ni]=String.fromCharCode(ni);for(var RD in Id)mN.hasOwnProperty(RD)||(mN[RD]=Id[RD]);function YBe(e){var t=GBe&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||VBe&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",r=!t&&e.key||(e.shiftKey?mN:Id)[e.keyCode]||e.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const QBe=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),JBe=typeof navigator<"u"&&/Win/.test(navigator.platform);function ZBe(e){let t=e.split(/-(?!$)/),r=t[t.length-1];r=="Space"&&(r=" ");let n,a,i,s;for(let l=0;l<t.length-1;l++){let c=t[l];if(/^(cmd|meta|m)$/i.test(c))s=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))a=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))QBe?s=!0:a=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),a&&(r="Ctrl-"+r),s&&(r="Meta-"+r),i&&(r="Shift-"+r),r}function XBe(e){let t=Object.create(null);for(let r in e)t[ZBe(r)]=e[r];return t}function PD(e,t,r=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),r&&t.shiftKey&&(e="Shift-"+e),e}function e$e(e){return new Ur({props:{handleKeyDown:Que(e)}})}function Que(e){let t=XBe(e);return function(r,n){let a=YBe(n),i,s=t[PD(a,n)];if(s&&s(r.state,r.dispatch,r))return!0;if(a.length==1&&a!=" "){if(n.shiftKey){let l=t[PD(a,n,!1)];if(l&&l(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(JBe&&n.ctrlKey&&n.altKey)&&(i=Id[n.keyCode])&&i!=a){let l=t[PD(i,n)];if(l&&l(r.state,r.dispatch,r))return!0}}return!1}}var t$e=Object.defineProperty,v9=(e,t)=>{for(var r in t)t$e(e,r,{get:t[r],enumerable:!0})};function Xj(e){const{state:t,transaction:r}=e;let{selection:n}=r,{doc:a}=r,{storedMarks:i}=r;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return n},get doc(){return a},get tr(){return n=r.selection,a=r.doc,i=r.storedMarks,r}}}var e2=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:n}=t,{tr:a}=r,i=this.buildProps(a);return Object.fromEntries(Object.entries(e).map(([s,l])=>[s,(...u)=>{const d=l(...u)(i);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(a),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:n,state:a}=this,{view:i}=n,s=[],l=!!e,c=e||a.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),s.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,m])=>[f,(...v)=>{const b=this.buildProps(c,t),y=m(...v)(b);return s.push(y),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,n=!1,a=e||r.tr,i=this.buildProps(a,n);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...i,dispatch:void 0})])),chain:()=>this.createChain(a,n)}}buildProps(e,t=!0){const{rawCommands:r,editor:n,state:a}=this,{view:i}=n,s={tr:e,editor:n,view:i,state:Xj({state:a,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(s)]))}};return s}},Jue={};v9(Jue,{blur:()=>r$e,clearContent:()=>n$e,clearNodes:()=>a$e,command:()=>i$e,createParagraphNear:()=>s$e,cut:()=>o$e,deleteCurrentNode:()=>l$e,deleteNode:()=>c$e,deleteRange:()=>u$e,deleteSelection:()=>d$e,enter:()=>f$e,exitCode:()=>h$e,extendMarkRange:()=>m$e,first:()=>p$e,focus:()=>v$e,forEach:()=>b$e,insertContent:()=>y$e,insertContentAt:()=>S$e,joinBackward:()=>N$e,joinDown:()=>_$e,joinForward:()=>C$e,joinItemBackward:()=>j$e,joinItemForward:()=>E$e,joinTextblockBackward:()=>M$e,joinTextblockForward:()=>T$e,joinUp:()=>k$e,keyboardShortcut:()=>D$e,lift:()=>L$e,liftEmptyBlock:()=>O$e,liftListItem:()=>I$e,newlineInCode:()=>R$e,resetAttributes:()=>P$e,scrollIntoView:()=>z$e,selectAll:()=>B$e,selectNodeBackward:()=>$$e,selectNodeForward:()=>F$e,selectParentNode:()=>U$e,selectTextblockEnd:()=>H$e,selectTextblockStart:()=>q$e,setContent:()=>W$e,setMark:()=>d8e,setMeta:()=>f8e,setNode:()=>h8e,setNodeSelection:()=>m8e,setTextDirection:()=>p8e,setTextSelection:()=>g8e,sinkListItem:()=>v8e,splitBlock:()=>b8e,splitListItem:()=>y8e,toggleList:()=>x8e,toggleMark:()=>w8e,toggleNode:()=>S8e,toggleWrap:()=>k8e,undoInputRule:()=>_8e,unsetAllMarks:()=>N8e,unsetMark:()=>C8e,unsetTextDirection:()=>j8e,updateAttributes:()=>E8e,wrapIn:()=>M8e,wrapInList:()=>T8e});var r$e=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var r;e.isDestroyed||(t.dom.blur(),(r=window?.getSelection())==null||r.removeAllRanges())}),!0),n$e=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),a$e=()=>({state:e,tr:t,dispatch:r})=>{const{selection:n}=t,{ranges:a}=n;return r&&a.forEach(({$from:i,$to:s})=>{e.doc.nodesBetween(i.pos,s.pos,(l,c)=>{if(l.type.isText)return;const{doc:u,mapping:d}=t,f=u.resolve(d.map(c)),m=u.resolve(d.map(c+l.nodeSize)),p=f.blockRange(m);if(!p)return;const v=h0(p);if(l.type.isTextblock){const{defaultType:b}=f.parent.contentMatchAt(f.index());t.setNodeMarkup(p.start,b)}(v||v===0)&&t.lift(p,v)})}),!0},i$e=e=>t=>e(t),s$e=()=>({state:e,dispatch:t})=>due(e,t),o$e=(e,t)=>({editor:r,tr:n})=>{const{state:a}=r,i=a.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);const s=n.mapping.map(t);return n.insert(s,i.content),n.setSelection(new Yt(n.doc.resolve(Math.max(s-1,0)))),!0},l$e=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,n=r.$anchor.node();if(n.content.size>0)return!1;const a=e.selection.$anchor;for(let i=a.depth;i>0;i-=1)if(a.node(i).type===n.type){if(t){const l=a.before(i),c=a.after(i);e.delete(l,c).scrollIntoView()}return!0}return!1};function ba(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var c$e=e=>({tr:t,state:r,dispatch:n})=>{const a=ba(e,r.schema),i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===a){if(n){const c=i.before(s),u=i.after(s);t.delete(c,u).scrollIntoView()}return!0}return!1},u$e=e=>({tr:t,dispatch:r})=>{const{from:n,to:a}=e;return r&&t.delete(n,a),!0},d$e=()=>({state:e,dispatch:t})=>n9(e,t),f$e=()=>({commands:e})=>e.keyboardShortcut("Enter"),h$e=()=>({state:e,dispatch:t})=>Qze(e,t);function b9(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function pN(e,t,r={strict:!0}){const n=Object.keys(t);return n.length?n.every(a=>r.strict?t[a]===e[a]:b9(t[a])?t[a].test(e[a]):t[a]===e[a]):!0}function Zue(e,t,r={}){return e.find(n=>n.type===t&&pN(Object.fromEntries(Object.keys(r).map(a=>[a,n.attrs[a]])),r))}function YQ(e,t,r={}){return!!Zue(e,t,r)}function y9(e,t,r){var n;if(!e||!t)return;let a=e.parent.childAfter(e.parentOffset);if((!a.node||!a.node.marks.some(d=>d.type===t))&&(a=e.parent.childBefore(e.parentOffset)),!a.node||!a.node.marks.some(d=>d.type===t)||(r=r||((n=a.node.marks[0])==null?void 0:n.attrs),!Zue([...a.node.marks],t,r)))return;let s=a.index,l=e.start()+a.offset,c=s+1,u=l+a.node.nodeSize;for(;s>0&&YQ([...e.parent.child(s-1).marks],t,r);)s-=1,l-=e.parent.child(s).nodeSize;for(;c<e.parent.childCount&&YQ([...e.parent.child(c).marks],t,r);)u+=e.parent.child(c).nodeSize,c+=1;return{from:l,to:u}}function gu(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var m$e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{const i=gu(e,n.schema),{doc:s,selection:l}=r,{$from:c,from:u,to:d}=l;if(a){const f=y9(c,i,t);if(f&&f.from<=u&&f.to>=d){const m=Yt.create(s,f.from,f.to);r.setSelection(m)}}return!0},p$e=e=>t=>{const r=typeof e=="function"?e(t):e;for(let n=0;n<r.length;n+=1)if(r[n](t))return!0;return!1};function Xue(e){return e instanceof Yt}function Qf(e=0,t=0,r=0){return Math.min(Math.max(e,t),r)}function ede(e,t=null){if(!t)return null;const r=lr.atStart(e),n=lr.atEnd(e);if(t==="start"||t===!0)return r;if(t==="end")return n;const a=r.from,i=n.to;return t==="all"?Yt.create(e,Qf(0,a,i),Qf(e.content.size,a,i)):Yt.create(e,Qf(t,a,i),Qf(t,a,i))}function QQ(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function gN(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function g$e(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var v$e=(e=null,t={})=>({editor:r,view:n,tr:a,dispatch:i})=>{t={scrollIntoView:!0,...t};const s=()=>{(gN()||QQ())&&n.dom.focus(),g$e()&&!gN()&&!QQ()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),t?.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(i&&e===null&&!Xue(r.state.selection))return s(),!0;const l=ede(a.doc,e)||r.state.selection,c=r.state.selection.eq(l);return i&&(c||a.setSelection(l),c&&a.storedMarks&&a.setStoredMarks(a.storedMarks),s()),!0},b$e=(e,t)=>r=>e.every((n,a)=>t(n,{...r,index:a})),y$e=(e,t)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},e,t),tde=e=>{const t=e.childNodes;for(let r=t.length-1;r>=0;r-=1){const n=t[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&tde(n)}return e};function uS(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,r=new window.DOMParser().parseFromString(t,"text/html").body;return tde(r)}function Jy(e,t,r){if(e instanceof Nd||e instanceof Ge)return e;r={slice:!0,parseOptions:{},...r};const n=typeof e=="object"&&e!==null,a=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return Ge.fromArray(e.map(l=>t.nodeFromJSON(l)));const s=t.nodeFromJSON(e);return r.errorOnInvalidContent&&s.check(),s}catch(i){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",i),Jy("",t,r)}if(a){if(r.errorOnInvalidContent){let s=!1,l="";const c=new zce({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?Cd.fromSchema(c).parseSlice(uS(e),r.parseOptions):Cd.fromSchema(c).parse(uS(e),r.parseOptions),r.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const i=Cd.fromSchema(t);return r.slice?i.parseSlice(uS(e),r.parseOptions).content:i.parse(uS(e),r.parseOptions)}return Jy("",t,r)}function x$e(e,t,r){const n=e.steps.length-1;if(n<t)return;const a=e.steps[n];if(!(a instanceof Fa||a instanceof Ha))return;const i=e.mapping.maps[n];let s=0;i.forEach((l,c,u,d)=>{s===0&&(s=d)}),e.setSelection(lr.near(e.doc.resolve(s),r))}var w$e=e=>!("type"in e),S$e=(e,t,r)=>({tr:n,dispatch:a,editor:i})=>{var s;if(a){r={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let l;const c=y=>{i.emit("contentError",{editor:i,error:y,disableCollaboration:()=>{"collaboration"in i.storage&&typeof i.storage.collaboration=="object"&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{Jy(t,i.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(y){c(y)}try{l=Jy(t,i.schema,{parseOptions:u,errorOnInvalidContent:(s=r.errorOnInvalidContent)!=null?s:i.options.enableContentCheck})}catch(y){return c(y),!1}let{from:d,to:f}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},m=!0,p=!0;if((w$e(l)?l:[l]).forEach(y=>{y.check(),m=m?y.isText&&y.marks.length===0:!1,p=p?y.isBlock:!1}),d===f&&p){const{parent:y}=n.doc.resolve(d);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(d-=1,f+=1)}let b;if(m){if(Array.isArray(t))b=t.map(y=>y.text||"").join("");else if(t instanceof Ge){let y="";t.forEach(S=>{S.text&&(y+=S.text)}),b=y}else typeof t=="object"&&t&&t.text?b=t.text:b=t;n.insertText(b,d,f)}else{b=l;const y=n.doc.resolve(d),S=y.node(),_=y.parentOffset===0,N=S.isText||S.isTextblock,k=S.content.size>0;_&&N&&k&&(d=Math.max(0,d-1)),n.replaceWith(d,f,b)}r.updateSelection&&x$e(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:d,text:b}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:d,text:b})}return!0},k$e=()=>({state:e,dispatch:t})=>Gze(e,t),_$e=()=>({state:e,dispatch:t})=>Vze(e,t),N$e=()=>({state:e,dispatch:t})=>aue(e,t),C$e=()=>({state:e,dispatch:t})=>lue(e,t),j$e=()=>({state:e,dispatch:t,tr:r})=>{try{const n=Gj(e.doc,e.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},E$e=()=>({state:e,dispatch:t,tr:r})=>{try{const n=Gj(e.doc,e.selection.$from.pos,1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},M$e=()=>({state:e,dispatch:t})=>Wze(e,t),T$e=()=>({state:e,dispatch:t})=>Kze(e,t);function rde(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function A$e(e){const t=e.split(/-(?!$)/);let r=t[t.length-1];r==="Space"&&(r=" ");let n,a,i,s;for(let l=0;l<t.length-1;l+=1){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))s=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))a=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))gN()||rde()?s=!0:a=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return n&&(r=`Alt-${r}`),a&&(r=`Ctrl-${r}`),s&&(r=`Meta-${r}`),i&&(r=`Shift-${r}`),r}var D$e=e=>({editor:t,view:r,tr:n,dispatch:a})=>{const i=A$e(e).split(/-(?!$)/),s=i.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),l=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,l))});return c?.steps.forEach(u=>{const d=u.map(n.mapping);d&&a&&n.maybeStep(d)}),!0};function Rd(e,t,r={}){const{from:n,to:a,empty:i}=e.selection,s=t?ba(t,e.schema):null,l=[];e.doc.nodesBetween(n,a,(f,m)=>{if(f.isText)return;const p=Math.max(n,m),v=Math.min(a,m+f.nodeSize);l.push({node:f,from:p,to:v})});const c=a-n,u=l.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>pN(f.node.attrs,r,{strict:!1}));return i?!!u.length:u.reduce((f,m)=>f+m.to-m.from,0)>=c}var L$e=(e,t={})=>({state:r,dispatch:n})=>{const a=ba(e,r.schema);return Rd(r,a,t)?Yze(r,n):!1},O$e=()=>({state:e,dispatch:t})=>fue(e,t),I$e=e=>({state:t,dispatch:r})=>{const n=ba(e,t.schema);return o9e(n)(t,r)},R$e=()=>({state:e,dispatch:t})=>uue(e,t);function t2(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function JQ(e,t){const r=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,a)=>(r.includes(a)||(n[a]=e[a]),n),{})}var P$e=(e,t)=>({tr:r,state:n,dispatch:a})=>{let i=null,s=null;const l=t2(typeof e=="string"?e:e.name,n.schema);if(!l)return!1;l==="node"&&(i=ba(e,n.schema)),l==="mark"&&(s=gu(e,n.schema));let c=!1;return r.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(d,f)=>{i&&i===d.type&&(c=!0,a&&r.setNodeMarkup(f,void 0,JQ(d.attrs,t))),s&&d.marks.length&&d.marks.forEach(m=>{s===m.type&&(c=!0,a&&r.addMark(f,f+d.nodeSize,s.create(JQ(m.attrs,t))))})})}),c},z$e=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),B$e=()=>({tr:e,dispatch:t})=>{if(t){const r=new Os(e.doc);e.setSelection(r)}return!0},$$e=()=>({state:e,dispatch:t})=>sue(e,t),F$e=()=>({state:e,dispatch:t})=>cue(e,t),U$e=()=>({state:e,dispatch:t})=>Xze(e,t),H$e=()=>({state:e,dispatch:t})=>r9e(e,t),q$e=()=>({state:e,dispatch:t})=>t9e(e,t);function jR(e,t,r={},n={}){return Jy(e,t,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var W$e=(e,{errorOnInvalidContent:t,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:a,tr:i,dispatch:s,commands:l})=>{const{doc:c}=i;if(n.preserveWhitespace!=="full"){const u=jR(e,a.schema,n,{errorOnInvalidContent:t??a.options.enableContentCheck});return s&&i.replaceWith(0,c.content.size,u).setMeta("preventUpdate",!r),!0}return s&&i.setMeta("preventUpdate",!r),l.insertContentAt({from:0,to:c.content.size},e,{parseOptions:n,errorOnInvalidContent:t??a.options.enableContentCheck})};function nde(e,t){const r=gu(t,e.schema),{from:n,to:a,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,a,c=>{s.push(...c.marks)});const l=s.find(c=>c.type.name===r.name);return l?{...l.attrs}:{}}function ade(e,t){const r=new eue(e);return t.forEach(n=>{n.steps.forEach(a=>{r.step(a)})}),r}function K$e(e){for(let t=0;t<e.edgeCount;t+=1){const{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function ER(e,t){const r=[];return e.descendants((n,a)=>{t(n)&&r.push({node:n,pos:a})}),r}function G$e(e,t,r){const n=[];return e.nodesBetween(t.from,t.to,(a,i)=>{r(a)&&n.push({node:a,pos:i})}),n}function V$e(e,t){for(let r=e.depth;r>0;r-=1){const n=e.node(r);if(t(n))return{pos:r>0?e.before(r):0,start:e.start(r),depth:r,node:n}}}function r2(e){return t=>V$e(t.$from,e)}function Lt(e,t,r){return e.config[t]===void 0&&e.parent?Lt(e.parent,t,r):typeof e.config[t]=="function"?e.config[t].bind({...r,parent:e.parent?Lt(e.parent,t,r):null}):e.config[t]}function x9(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},n=Lt(t,"addExtensions",r);return n?[t,...x9(n())]:t}).flat(10)}function w9(e,t){const r=Zh.fromSchema(t).serializeFragment(e),a=document.implementation.createHTMLDocument().createElement("div");return a.appendChild(r),a.innerHTML}function ide(e){return typeof e=="function"}function Wr(e,t=void 0,...r){return ide(e)?t?e.bind(t)(...r):e(...r):e}function Y$e(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Cg(e){const t=e.filter(a=>a.type==="extension"),r=e.filter(a=>a.type==="node"),n=e.filter(a=>a.type==="mark");return{baseExtensions:t,nodeExtensions:r,markExtensions:n}}function sde(e){const t=[],{nodeExtensions:r,markExtensions:n}=Cg(e),a=[...r,...n],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage,extensions:a},c=Lt(s,"addGlobalAttributes",l);if(!c)return;c().forEach(d=>{d.types.forEach(f=>{Object.entries(d.attributes).forEach(([m,p])=>{t.push({type:f,name:m,attribute:{...i,...p}})})})})}),a.forEach(s=>{const l={name:s.name,options:s.options,storage:s.storage},c=Lt(s,"addAttributes",l);if(!c)return;const u=c();Object.entries(u).forEach(([d,f])=>{const m={...i,...f};typeof m?.default=="function"&&(m.default=m.default()),m?.isRequired&&m?.default===void 0&&delete m.default,t.push({type:s.name,name:d,attribute:m})})}),t}function Jn(...e){return e.filter(t=>!!t).reduce((t,r)=>{const n={...t};return Object.entries(r).forEach(([a,i])=>{if(!n[a]){n[a]=i;return}if(a==="class"){const l=i?String(i).split(" "):[],c=n[a]?n[a].split(" "):[],u=l.filter(d=>!c.includes(d));n[a]=[...c,...u].join(" ")}else if(a==="style"){const l=i?i.split(";").map(d=>d.trim()).filter(Boolean):[],c=n[a]?n[a].split(";").map(d=>d.trim()).filter(Boolean):[],u=new Map;c.forEach(d=>{const[f,m]=d.split(":").map(p=>p.trim());u.set(f,m)}),l.forEach(d=>{const[f,m]=d.split(":").map(p=>p.trim());u.set(f,m)}),n[a]=Array.from(u.entries()).map(([d,f])=>`${d}: ${f}`).join("; ")}else n[a]=i}),n},{})}function Zy(e,t){return t.filter(r=>r.type===e.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(e.attrs)||{}:{[r.name]:e.attrs[r.name]}).reduce((r,n)=>Jn(r,n),{})}function Q$e(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function ZQ(e,t){return"style"in e?e:{...e,getAttrs:r=>{const n=e.getAttrs?e.getAttrs(r):e.attrs;if(n===!1)return!1;const a=t.reduce((i,s)=>{const l=s.attribute.parseHTML?s.attribute.parseHTML(r):Q$e(r.getAttribute(s.name));return l==null?i:{...i,[s.name]:l}},{});return{...n,...a}}}}function XQ(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>t==="attrs"&&Y$e(r)?!1:r!=null))}function eJ(e){var t,r;const n={};return!((t=e?.attribute)!=null&&t.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((r=e?.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function J$e(e,t){var r;const n=sde(e),{nodeExtensions:a,markExtensions:i}=Cg(e),s=(r=a.find(u=>Lt(u,"topNode")))==null?void 0:r.name,l=Object.fromEntries(a.map(u=>{const d=n.filter(S=>S.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:t},m=e.reduce((S,_)=>{const N=Lt(_,"extendNodeSchema",f);return{...S,...N?N(u):{}}},{}),p=XQ({...m,content:Wr(Lt(u,"content",f)),marks:Wr(Lt(u,"marks",f)),group:Wr(Lt(u,"group",f)),inline:Wr(Lt(u,"inline",f)),atom:Wr(Lt(u,"atom",f)),selectable:Wr(Lt(u,"selectable",f)),draggable:Wr(Lt(u,"draggable",f)),code:Wr(Lt(u,"code",f)),whitespace:Wr(Lt(u,"whitespace",f)),linebreakReplacement:Wr(Lt(u,"linebreakReplacement",f)),defining:Wr(Lt(u,"defining",f)),isolating:Wr(Lt(u,"isolating",f)),attrs:Object.fromEntries(d.map(eJ))}),v=Wr(Lt(u,"parseHTML",f));v&&(p.parseDOM=v.map(S=>ZQ(S,d)));const b=Lt(u,"renderHTML",f);b&&(p.toDOM=S=>b({node:S,HTMLAttributes:Zy(S,d)}));const y=Lt(u,"renderText",f);return y&&(p.toText=y),[u.name,p]})),c=Object.fromEntries(i.map(u=>{const d=n.filter(y=>y.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:t},m=e.reduce((y,S)=>{const _=Lt(S,"extendMarkSchema",f);return{...y,..._?_(u):{}}},{}),p=XQ({...m,inclusive:Wr(Lt(u,"inclusive",f)),excludes:Wr(Lt(u,"excludes",f)),group:Wr(Lt(u,"group",f)),spanning:Wr(Lt(u,"spanning",f)),code:Wr(Lt(u,"code",f)),attrs:Object.fromEntries(d.map(eJ))}),v=Wr(Lt(u,"parseHTML",f));v&&(p.parseDOM=v.map(y=>ZQ(y,d)));const b=Lt(u,"renderHTML",f);return b&&(p.toDOM=y=>b({mark:y,HTMLAttributes:Zy(y,d)})),[u.name,p]}));return new zce({topNode:s,nodes:l,marks:c})}function Z$e(e){const t=e.filter((r,n)=>e.indexOf(r)!==n);return Array.from(new Set(t))}function vN(e){return e.sort((r,n)=>{const a=Lt(r,"priority")||100,i=Lt(n,"priority")||100;return a>i?-1:a<i?1:0})}function ode(e){const t=vN(x9(e)),r=Z$e(t.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function lde(e,t,r){const{from:n,to:a}=t,{blockSeparator:i=`

`,textSerializers:s={}}=r||{};let l="";return e.nodesBetween(n,a,(c,u,d,f)=>{var m;c.isBlock&&u>n&&(l+=i);const p=s?.[c.type.name];if(p)return d&&(l+=p({node:c,pos:u,parent:d,index:f,range:t})),!1;c.isText&&(l+=(m=c?.text)==null?void 0:m.slice(Math.max(n,u)-u,a-u))}),l}function X$e(e,t){const r={from:0,to:e.content.size};return lde(e,r,t)}function cde(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,r])=>[t,r.spec.toText]))}function e8e(e,t){const r=ba(t,e.schema),{from:n,to:a}=e.selection,i=[];e.doc.nodesBetween(n,a,l=>{i.push(l)});const s=i.reverse().find(l=>l.type.name===r.name);return s?{...s.attrs}:{}}function ude(e,t){const r=t2(typeof t=="string"?t:t.name,e.schema);return r==="node"?e8e(e,t):r==="mark"?nde(e,t):{}}function t8e(e,t=JSON.stringify){const r={};return e.filter(n=>{const a=t(n);return Object.prototype.hasOwnProperty.call(r,a)?!1:r[a]=!0})}function r8e(e){const t=t8e(e);return t.length===1?t:t.filter((r,n)=>!t.filter((i,s)=>s!==n).some(i=>r.oldRange.from>=i.oldRange.from&&r.oldRange.to<=i.oldRange.to&&r.newRange.from>=i.newRange.from&&r.newRange.to<=i.newRange.to))}function dde(e){const{mapping:t,steps:r}=e,n=[];return t.maps.forEach((a,i)=>{const s=[];if(a.ranges.length)a.forEach((l,c)=>{s.push({from:l,to:c})});else{const{from:l,to:c}=r[i];if(l===void 0||c===void 0)return;s.push({from:l,to:c})}s.forEach(({from:l,to:c})=>{const u=t.slice(i).map(l,-1),d=t.slice(i).map(c),f=t.invert().map(u,-1),m=t.invert().map(d);n.push({oldRange:{from:f,to:m},newRange:{from:u,to:d}})})}),r8e(n)}function S9(e,t,r){const n=[];return e===t?r.resolve(e).marks().forEach(a=>{const i=r.resolve(e),s=y9(i,a.type);s&&n.push({mark:a,...s})}):r.nodesBetween(e,t,(a,i)=>{!a||a?.nodeSize===void 0||n.push(...a.marks.map(s=>({from:i,to:i+a.nodeSize,mark:s})))}),n}var n8e=(e,t,r,n=20)=>{const a=e.doc.resolve(r);let i=n,s=null;for(;i>0&&s===null;){const l=a.node(i);l?.type.name===t?s=l:i-=1}return[s,i]};function dS(e,t){return t.nodes[e]||t.marks[e]||null}function yk(e,t,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const a=e.find(i=>i.type===t&&i.name===n);return a?a.attribute.keepOnSplit:!1}))}var a8e=(e,t=500)=>{let r="";const n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(a,i,s,l)=>{var c,u;const d=((u=(c=a.type.spec).toText)==null?void 0:u.call(c,{node:a,pos:i,parent:s,index:l}))||a.textContent||"%leaf%";r+=a.isAtom&&!a.isText?d:d.slice(0,Math.max(0,n-i))}),r};function MR(e,t,r={}){const{empty:n,ranges:a}=e.selection,i=t?gu(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(f=>i?i.name===f.type.name:!0).find(f=>pN(f.attrs,r,{strict:!1}));let s=0;const l=[];if(a.forEach(({$from:f,$to:m})=>{const p=f.pos,v=m.pos;e.doc.nodesBetween(p,v,(b,y)=>{if(!b.isText&&!b.marks.length)return;const S=Math.max(p,y),_=Math.min(v,y+b.nodeSize),N=_-S;s+=N,l.push(...b.marks.map(k=>({mark:k,from:S,to:_})))})}),s===0)return!1;const c=l.filter(f=>i?i.name===f.mark.type.name:!0).filter(f=>pN(f.mark.attrs,r,{strict:!1})).reduce((f,m)=>f+m.to-m.from,0),u=l.filter(f=>i?f.mark.type!==i&&f.mark.type.excludes(i):!0).reduce((f,m)=>f+m.to-m.from,0);return(c>0?c+u:c)>=s}function i8e(e,t,r={}){if(!t)return Rd(e,null,r)||MR(e,null,r);const n=t2(t,e.schema);return n==="node"?Rd(e,t,r):n==="mark"?MR(e,t,r):!1}var s8e=(e,t)=>{const{$from:r,$to:n,$anchor:a}=e.selection;if(t){const i=r2(l=>l.type.name===t)(e.selection);if(!i)return!1;const s=e.doc.resolve(i.pos+1);return a.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},o8e=e=>{const{$from:t,$to:r}=e.selection;return!(t.parentOffset>0||t.pos!==r.pos)};function tJ(e,t){return Array.isArray(t)?t.some(r=>(typeof r=="string"?r:r.name)===e.name):t}function rJ(e,t){const{nodeExtensions:r}=Cg(t),n=r.find(s=>s.name===e);if(!n)return!1;const a={name:n.name,options:n.options,storage:n.storage},i=Wr(Lt(n,"group",a));return typeof i!="string"?!1:i.split(" ").includes("list")}function r1(e,{checkChildren:t=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let a=!0;return e.content.forEach(i=>{a!==!1&&(r1(i,{ignoreWhitespace:r,checkChildren:t})||(a=!1))}),a}return!1}function k9(e){return e instanceof $t}var fde=class hde{constructor(t){this.position=t}static fromJSON(t){return new hde(t.position)}toJSON(){return{position:this.position}}};function l8e(e,t){const r=t.mapping.mapResult(e.position);return{position:new fde(r.pos),mapResult:r}}function c8e(e){return new fde(e)}function u8e(e,t,r){var n;const{selection:a}=t;let i=null;if(Xue(a)&&(i=a.$cursor),i){const l=(n=e.storedMarks)!=null?n:i.marks();return i.parent.type.allowsMarkType(r)&&(!!r.isInSet(l)||!l.some(u=>u.type.excludes(r)))}const{ranges:s}=a;return s.some(({$from:l,$to:c})=>{let u=l.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(r):!1;return e.doc.nodesBetween(l.pos,c.pos,(d,f,m)=>{if(u)return!1;if(d.isInline){const p=!m||m.type.allowsMarkType(r),v=!!r.isInSet(d.marks)||!d.marks.some(b=>b.type.excludes(r));u=p&&v}return!u}),u})}var d8e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{const{selection:i}=r,{empty:s,ranges:l}=i,c=gu(e,n.schema);if(a)if(s){const u=nde(n,c);r.addStoredMark(c.create({...u,...t}))}else l.forEach(u=>{const d=u.$from.pos,f=u.$to.pos;n.doc.nodesBetween(d,f,(m,p)=>{const v=Math.max(p,d),b=Math.min(p+m.nodeSize,f);m.marks.find(S=>S.type===c)?m.marks.forEach(S=>{c===S.type&&r.addMark(v,b,c.create({...S.attrs,...t}))}):r.addMark(v,b,c.create(t))})});return u8e(n,r,c)},f8e=(e,t)=>({tr:r})=>(r.setMeta(e,t),!0),h8e=(e,t={})=>({state:r,dispatch:n,chain:a})=>{const i=ba(e,r.schema);let s;return r.selection.$anchor.sameParent(r.selection.$head)&&(s=r.selection.$anchor.parent.attrs),i.isTextblock?a().command(({commands:l})=>pQ(i,{...s,...t})(r)?!0:l.clearNodes()).command(({state:l})=>pQ(i,{...s,...t})(l,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},m8e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,a=Qf(e,0,n.content.size),i=$t.create(n,a);t.setSelection(i)}return!0},p8e=(e,t)=>({tr:r,state:n,dispatch:a})=>{const{selection:i}=n;let s,l;return typeof t=="number"?(s=t,l=t):t&&"from"in t&&"to"in t?(s=t.from,l=t.to):(s=i.from,l=i.to),a&&r.doc.nodesBetween(s,l,(c,u)=>{c.isText||r.setNodeMarkup(u,void 0,{...c.attrs,dir:e})}),!0},g8e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,{from:a,to:i}=typeof e=="number"?{from:e,to:e}:e,s=Yt.atStart(n).from,l=Yt.atEnd(n).to,c=Qf(a,s,l),u=Qf(i,s,l),d=Yt.create(n,c,u);t.setSelection(d)}return!0},v8e=e=>({state:t,dispatch:r})=>{const n=ba(e,t.schema);return u9e(n)(t,r)};function nJ(e,t){const r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(r){const n=r.filter(a=>t?.includes(a.type.name));e.tr.ensureMarks(n)}}var b8e=({keepMarks:e=!0}={})=>({tr:t,state:r,dispatch:n,editor:a})=>{const{selection:i,doc:s}=t,{$from:l,$to:c}=i,u=a.extensionManager.attributes,d=yk(u,l.node().type.name,l.node().attrs);if(i instanceof $t&&i.node.isBlock)return!l.parentOffset||!Xc(s,l.pos)?!1:(n&&(e&&nJ(r,a.extensionManager.splittableMarks),t.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const f=c.parentOffset===c.parent.content.size,m=l.depth===0?void 0:K$e(l.node(-1).contentMatchAt(l.indexAfter(-1)));let p=f&&m?[{type:m,attrs:d}]:void 0,v=Xc(t.doc,t.mapping.map(l.pos),1,p);if(!p&&!v&&Xc(t.doc,t.mapping.map(l.pos),1,m?[{type:m}]:void 0)&&(v=!0,p=m?[{type:m,attrs:d}]:void 0),n){if(v&&(i instanceof Yt&&t.deleteSelection(),t.split(t.mapping.map(l.pos),1,p),m&&!f&&!l.parentOffset&&l.parent.type!==m)){const b=t.mapping.map(l.before()),y=t.doc.resolve(b);l.node(-1).canReplaceWith(y.index(),y.index()+1,m)&&t.setNodeMarkup(t.mapping.map(l.before()),m)}e&&nJ(r,a.extensionManager.splittableMarks),t.scrollIntoView()}return v},y8e=(e,t={})=>({tr:r,state:n,dispatch:a,editor:i})=>{var s;const l=ba(e,n.schema),{$from:c,$to:u}=n.selection,d=n.selection.node;if(d&&d.isBlock||c.depth<2||!c.sameParent(u))return!1;const f=c.node(-1);if(f.type!==l)return!1;const m=i.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(a){let S=Ge.empty;const _=c.index(-1)?1:c.index(-2)?2:3;for(let O=c.depth-_;O>=c.depth-3;O-=1)S=Ge.from(c.node(O).copy(S));const N=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,k={...yk(m,c.node().type.name,c.node().attrs),...t},j=((s=l.contentMatch.defaultType)==null?void 0:s.createAndFill(k))||void 0;S=S.append(Ge.from(l.createAndFill(null,j)||void 0));const E=c.before(c.depth-(_-1));r.replace(E,c.after(-N),new pt(S,4-_,0));let T=-1;r.doc.nodesBetween(E,r.doc.content.size,(O,R)=>{if(T>-1)return!1;O.isTextblock&&O.content.size===0&&(T=R+1)}),T>-1&&r.setSelection(Yt.near(r.doc.resolve(T))),r.scrollIntoView()}return!0}const p=u.pos===c.end()?f.contentMatchAt(0).defaultType:null,v={...yk(m,f.type.name,f.attrs),...t},b={...yk(m,c.node().type.name,c.node().attrs),...t};r.delete(c.pos,u.pos);const y=p?[{type:l,attrs:v},{type:p,attrs:b}]:[{type:l,attrs:v}];if(!Xc(r.doc,c.pos,2))return!1;if(a){const{selection:S,storedMarks:_}=n,{splittableMarks:N}=i.extensionManager,k=_||S.$to.parentOffset&&S.$from.marks();if(r.split(c.pos,2,y).scrollIntoView(),!k||!a)return!0;const j=k.filter(E=>N.includes(E.type.name));r.ensureMarks(j)}return!0},zD=(e,t)=>{const r=r2(s=>s.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const a=e.doc.nodeAt(n);return r.node.type===a?.type&&qd(e.doc,r.pos)&&e.join(r.pos),!0},BD=(e,t)=>{const r=r2(s=>s.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const a=e.doc.nodeAt(n);return r.node.type===a?.type&&qd(e.doc,n)&&e.join(n),!0},x8e=(e,t,r,n={})=>({editor:a,tr:i,state:s,dispatch:l,chain:c,commands:u,can:d})=>{const{extensions:f,splittableMarks:m}=a.extensionManager,p=ba(e,s.schema),v=ba(t,s.schema),{selection:b,storedMarks:y}=s,{$from:S,$to:_}=b,N=S.blockRange(_),k=y||b.$to.parentOffset&&b.$from.marks();if(!N)return!1;const j=r2(E=>rJ(E.type.name,f))(b);if(N.depth>=1&&j&&N.depth-j.depth<=1){if(j.node.type===p)return u.liftListItem(v);if(rJ(j.node.type.name,f)&&p.validContent(j.node.content)&&l)return c().command(()=>(i.setNodeMarkup(j.pos,p),!0)).command(()=>zD(i,p)).command(()=>BD(i,p)).run()}return!r||!k||!l?c().command(()=>d().wrapInList(p,n)?!0:u.clearNodes()).wrapInList(p,n).command(()=>zD(i,p)).command(()=>BD(i,p)).run():c().command(()=>{const E=d().wrapInList(p,n),T=k.filter(O=>m.includes(O.type.name));return i.ensureMarks(T),E?!0:u.clearNodes()}).wrapInList(p,n).command(()=>zD(i,p)).command(()=>BD(i,p)).run()},w8e=(e,t={},r={})=>({state:n,commands:a})=>{const{extendEmptyMarkRange:i=!1}=r,s=gu(e,n.schema);return MR(n,s,t)?a.unsetMark(s,{extendEmptyMarkRange:i}):a.setMark(s,t)},S8e=(e,t,r={})=>({state:n,commands:a})=>{const i=ba(e,n.schema),s=ba(t,n.schema),l=Rd(n,i,r);let c;return n.selection.$anchor.sameParent(n.selection.$head)&&(c=n.selection.$anchor.parent.attrs),l?a.setNode(s,c):a.setNode(i,{...c,...r})},k8e=(e,t={})=>({state:r,commands:n})=>{const a=ba(e,r.schema);return Rd(r,a,t)?n.lift(a):n.wrapIn(a,t)},_8e=()=>({state:e,dispatch:t})=>{const r=e.plugins;for(let n=0;n<r.length;n+=1){const a=r[n];let i;if(a.spec.isInputRules&&(i=a.getState(e))){if(t){const s=e.tr,l=i.transform;for(let c=l.steps.length-1;c>=0;c-=1)s.step(l.steps[c].invert(l.docs[c]));if(i.text){const c=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,e.schema.text(i.text,c))}else s.delete(i.from,i.to)}return!0}}return!1},N8e=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,{empty:n,ranges:a}=r;return n||t&&a.forEach(i=>{e.removeMark(i.$from.pos,i.$to.pos)}),!0},C8e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{var i;const{extendEmptyMarkRange:s=!1}=t,{selection:l}=r,c=gu(e,n.schema),{$from:u,empty:d,ranges:f}=l;if(!a)return!0;if(d&&s){let{from:m,to:p}=l;const v=(i=u.marks().find(y=>y.type===c))==null?void 0:i.attrs,b=y9(u,c,v);b&&(m=b.from,p=b.to),r.removeMark(m,p,c)}else f.forEach(m=>{r.removeMark(m.$from.pos,m.$to.pos,c)});return r.removeStoredMark(c),!0},j8e=e=>({tr:t,state:r,dispatch:n})=>{const{selection:a}=r;let i,s;return typeof e=="number"?(i=e,s=e):e&&"from"in e&&"to"in e?(i=e.from,s=e.to):(i=a.from,s=a.to),n&&t.doc.nodesBetween(i,s,(l,c)=>{if(l.isText)return;const u={...l.attrs};delete u.dir,t.setNodeMarkup(c,void 0,u)}),!0},E8e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{let i=null,s=null;const l=t2(typeof e=="string"?e:e.name,n.schema);if(!l)return!1;l==="node"&&(i=ba(e,n.schema)),l==="mark"&&(s=gu(e,n.schema));let c=!1;return r.selection.ranges.forEach(u=>{const d=u.$from.pos,f=u.$to.pos;let m,p,v,b;r.selection.empty?n.doc.nodesBetween(d,f,(y,S)=>{i&&i===y.type&&(c=!0,v=Math.max(S,d),b=Math.min(S+y.nodeSize,f),m=S,p=y)}):n.doc.nodesBetween(d,f,(y,S)=>{S<d&&i&&i===y.type&&(c=!0,v=Math.max(S,d),b=Math.min(S+y.nodeSize,f),m=S,p=y),S>=d&&S<=f&&(i&&i===y.type&&(c=!0,a&&r.setNodeMarkup(S,void 0,{...y.attrs,...t})),s&&y.marks.length&&y.marks.forEach(_=>{if(s===_.type&&(c=!0,a)){const N=Math.max(S,d),k=Math.min(S+y.nodeSize,f);r.addMark(N,k,s.create({..._.attrs,...t}))}}))}),p&&(m!==void 0&&a&&r.setNodeMarkup(m,void 0,{...p.attrs,...t}),s&&p.marks.length&&p.marks.forEach(y=>{s===y.type&&a&&r.addMark(v,b,s.create({...y.attrs,...t}))}))}),c},M8e=(e,t={})=>({state:r,dispatch:n})=>{const a=ba(e,r.schema);return n9e(a,t)(r,n)},T8e=(e,t={})=>({state:r,dispatch:n})=>{const a=ba(e,r.schema);return a9e(a,t)(r,n)},A8e=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(n=>n.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){const r=(...n)=>{this.off(e,r),t.apply(this,n)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}},n2=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},D8e=(e,t)=>{if(b9(t))return t.exec(e);const r=t(e);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=e,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function fS(e){var t;const{editor:r,from:n,to:a,text:i,rules:s,plugin:l}=e,{view:c}=r;if(c.composing)return!1;const u=c.state.doc.resolve(n);if(u.parent.type.spec.code||(t=u.nodeBefore||u.nodeAfter)!=null&&t.marks.find(m=>m.type.spec.code))return!1;let d=!1;const f=a8e(u)+i;return s.forEach(m=>{if(d)return;const p=D8e(f,m.find);if(!p)return;const v=c.state.tr,b=Xj({state:c.state,transaction:v}),y={from:n-(p[0].length-i.length),to:a},{commands:S,chain:_,can:N}=new e2({editor:r,state:b});m.handler({state:b,range:y,match:p,commands:S,chain:_,can:N})===null||!v.steps.length||(m.undoable&&v.setMeta(l,{transform:v,from:n,to:a,text:i}),c.dispatch(v),d=!0)}),d}function L8e(e){const{editor:t,rules:r}=e,n=new Ur({state:{init(){return null},apply(a,i,s){const l=a.getMeta(n);if(l)return l;const c=a.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:d}=c;typeof d=="string"?d=d:d=w9(Ge.from(d),s.schema);const{from:f}=c,m=f+d.length;fS({editor:t,from:f,to:m,text:d,rules:r,plugin:n})}),a.selectionSet||a.docChanged?null:i}},props:{handleTextInput(a,i,s,l){return fS({editor:t,from:i,to:s,text:l,rules:r,plugin:n})},handleDOMEvents:{compositionend:a=>(setTimeout(()=>{const{$cursor:i}=a.state.selection;i&&fS({editor:t,from:i.pos,to:i.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(a,i){if(i.key!=="Enter")return!1;const{$cursor:s}=a.state.selection;return s?fS({editor:t,from:s.pos,to:s.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function O8e(e){return Object.prototype.toString.call(e).slice(8,-1)}function hS(e){return O8e(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function mde(e,t){const r={...e};return hS(e)&&hS(t)&&Object.keys(t).forEach(n=>{hS(t[n])&&hS(e[n])?r[n]=mde(e[n],t[n]):r[n]=t[n]}),r}var _9=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...Wr(Lt(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Wr(Lt(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>mde(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},Xh=class pde extends _9{constructor(){super(...arguments),this.type="mark"}static create(t={}){const r=typeof t=="function"?t():t;return new pde(r)}static handleExit({editor:t,mark:r}){const{tr:n}=t.state,a=t.state.selection.$from;if(a.pos===a.end()){const s=a.marks();if(!!!s.find(u=>u?.type.name===r.name))return!1;const c=s.find(u=>u?.type.name===r.name);return c&&n.removeStoredMark(c),n.insertText(" ",a.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function I8e(e){return typeof e=="number"}var R8e=class{constructor(e){this.find=e.find,this.handler=e.handler}},P8e=(e,t,r)=>{if(b9(t))return[...e.matchAll(t)];const n=t(e,r);return n?n.map(a=>{const i=[a.text];return i.index=a.index,i.input=e,i.data=a.data,a.replaceWith&&(a.text.includes(a.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(a.replaceWith)),i}):[]};function z8e(e){const{editor:t,state:r,from:n,to:a,rule:i,pasteEvent:s,dropEvent:l}=e,{commands:c,chain:u,can:d}=new e2({editor:t,state:r}),f=[];return r.doc.nodesBetween(n,a,(p,v)=>{var b,y,S,_,N;if((y=(b=p.type)==null?void 0:b.spec)!=null&&y.code||!(p.isText||p.isTextblock||p.isInline))return;const k=(N=(_=(S=p.content)==null?void 0:S.size)!=null?_:p.nodeSize)!=null?N:0,j=Math.max(n,v),E=Math.min(a,v+k);if(j>=E)return;const T=p.isText?p.text||"":p.textBetween(j-v,E-v,void 0,"");P8e(T,i.find,s).forEach(R=>{if(R.index===void 0)return;const q=j+R.index+1,$=q+R[0].length,L={from:r.tr.mapping.map(q),to:r.tr.mapping.map($)},A=i.handler({state:r,range:L,match:R,commands:c,chain:u,can:d,pasteEvent:s,dropEvent:l});f.push(A)})}),f.every(p=>p!==null)}var mS=null,B8e=e=>{var t;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=r.clipboardData)==null||t.setData("text/html",e),r};function $8e(e){const{editor:t,rules:r}=e;let n=null,a=!1,i=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const c=({state:d,from:f,to:m,rule:p,pasteEvt:v})=>{const b=d.tr,y=Xj({state:d,transaction:b});if(!(!z8e({editor:t,state:y,from:Math.max(f-1,0),to:m.b-1,rule:p,pasteEvent:v,dropEvent:l})||!b.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,b}};return r.map(d=>new Ur({view(f){const m=v=>{var b;n=(b=f.dom.parentElement)!=null&&b.contains(v.target)?f.dom.parentElement:null,n&&(mS=t)},p=()=>{mS&&(mS=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(f,m)=>{if(i=n===f.dom.parentElement,l=m,!i){const p=mS;p?.isEditable&&setTimeout(()=>{const v=p.state.selection;v&&p.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(f,m)=>{var p;const v=(p=m.clipboardData)==null?void 0:p.getData("text/html");return s=m,a=!!v?.includes("data-pm-slice"),!1}}},appendTransaction:(f,m,p)=>{const v=f[0],b=v.getMeta("uiEvent")==="paste"&&!a,y=v.getMeta("uiEvent")==="drop"&&!i,S=v.getMeta("applyPasteRules"),_=!!S;if(!b&&!y&&!_)return;if(_){let{text:j}=S;typeof j=="string"?j=j:j=w9(Ge.from(j),p.schema);const{from:E}=S,T=E+j.length,O=B8e(j);return c({rule:d,state:p,from:E,to:{b:T},pasteEvt:O})}const N=m.doc.content.findDiffStart(p.doc.content),k=m.doc.content.findDiffEnd(p.doc.content);if(!(!I8e(N)||!k||N===k.b))return c({rule:d,state:p,from:N,to:k,pasteEvt:s})}}))}var a2=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=ode(e),this.schema=J$e(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:dS(t.name,this.schema)},n=Lt(t,"addCommands",r);return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this;return vN([...this.extensions].reverse()).flatMap(n=>{const a={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:dS(n.name,this.schema)},i=[],s=Lt(n,"addKeyboardShortcuts",a);let l={};if(n.type==="mark"&&Lt(n,"exitable",a)&&(l.ArrowRight=()=>Xh.handleExit({editor:e,mark:n})),s){const m=Object.fromEntries(Object.entries(s()).map(([p,v])=>[p,()=>v({editor:e})]));l={...l,...m}}const c=e$e(l);i.push(c);const u=Lt(n,"addInputRules",a);if(tJ(n,e.options.enableInputRules)&&u){const m=u();if(m&&m.length){const p=L8e({editor:e,rules:m}),v=Array.isArray(p)?p:[p];i.push(...v)}}const d=Lt(n,"addPasteRules",a);if(tJ(n,e.options.enablePasteRules)&&d){const m=d();if(m&&m.length){const p=$8e({editor:e,rules:m});i.push(...p)}}const f=Lt(n,"addProseMirrorPlugins",a);if(f){const m=f();i.push(...m)}return i})}get attributes(){return sde(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Cg(this.extensions);return Object.fromEntries(t.filter(r=>!!Lt(r,"addNodeView")).map(r=>{const n=this.attributes.filter(c=>c.type===r.name),a={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:ba(r.name,this.schema)},i=Lt(r,"addNodeView",a);if(!i)return[];const s=i();if(!s)return[];const l=(c,u,d,f,m)=>{const p=Zy(c,n);return s({node:c,view:u,getPos:d,decorations:f,innerDecorations:m,editor:e,extension:r,HTMLAttributes:p})};return[r.name,l]}))}dispatchTransaction(e){const{editor:t}=this;return vN([...this.extensions].reverse()).reduceRight((n,a)=>{const i={name:a.name,options:a.options,storage:this.editor.extensionStorage[a.name],editor:t,type:dS(a.name,this.schema)},s=Lt(a,"dispatchTransaction",i);return s?l=>{s.call(i,{transaction:l,next:n})}:n},e)}get markViews(){const{editor:e}=this,{markExtensions:t}=Cg(this.extensions);return Object.fromEntries(t.filter(r=>!!Lt(r,"addMarkView")).map(r=>{const n=this.attributes.filter(l=>l.type===r.name),a={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:gu(r.name,this.schema)},i=Lt(r,"addMarkView",a);if(!i)return[];const s=(l,c,u)=>{const d=Zy(l,n);return i()({mark:l,view:c,inline:u,editor:e,extension:r,HTMLAttributes:d,updateAttributes:f=>{tFe(l,e,f)}})};return[r.name,s]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(t=>[t.name,t.storage])),e.forEach(t=>{var r;const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:dS(t.name,this.schema)};t.type==="mark"&&((r=Wr(Lt(t,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(t.name);const a=Lt(t,"onBeforeCreate",n),i=Lt(t,"onCreate",n),s=Lt(t,"onUpdate",n),l=Lt(t,"onSelectionUpdate",n),c=Lt(t,"onTransaction",n),u=Lt(t,"onFocus",n),d=Lt(t,"onBlur",n),f=Lt(t,"onDestroy",n);a&&this.editor.on("beforeCreate",a),i&&this.editor.on("create",i),s&&this.editor.on("update",s),l&&this.editor.on("selectionUpdate",l),c&&this.editor.on("transaction",c),u&&this.editor.on("focus",u),d&&this.editor.on("blur",d),f&&this.editor.on("destroy",f)})}};a2.resolve=ode;a2.sort=vN;a2.flatten=x9;var F8e={};v9(F8e,{ClipboardTextSerializer:()=>vde,Commands:()=>bde,Delete:()=>yde,Drop:()=>xde,Editable:()=>wde,FocusEvents:()=>kde,Keymap:()=>_de,Paste:()=>Nde,Tabindex:()=>Cde,TextDirection:()=>jde,focusEventsPluginKey:()=>Sde});var zr=class gde extends _9{constructor(){super(...arguments),this.type="extension"}static create(t={}){const r=typeof t=="function"?t():t;return new gde(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}},vde=zr.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ur({key:new Gr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:r}=e,{doc:n,selection:a}=t,{ranges:i}=a,s=Math.min(...i.map(d=>d.$from.pos)),l=Math.max(...i.map(d=>d.$to.pos)),c=cde(r);return lde(n,{from:s,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),bde=zr.create({name:"commands",addCommands(){return{...Jue}}}),yde=zr.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var r,n,a;const i=()=>{var s,l,c,u;if((u=(c=(l=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:l.filterTransaction)==null?void 0:c.call(l,e))!=null?u:e.getMeta("y-sync$"))return;const d=ade(e.before,[e,...t]);dde(d).forEach(p=>{d.mapping.mapResult(p.oldRange.from).deletedAfter&&d.mapping.mapResult(p.oldRange.to).deletedBefore&&d.before.nodesBetween(p.oldRange.from,p.oldRange.to,(v,b)=>{const y=b+v.nodeSize-2,S=p.oldRange.from<=b&&y<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:b,to:y,newFrom:d.mapping.map(b),newTo:d.mapping.map(y),deletedRange:p.oldRange,newRange:p.newRange,partial:!S,editor:this.editor,transaction:e,combinedTransform:d})})});const m=d.mapping;d.steps.forEach((p,v)=>{var b,y;if(p instanceof Wo){const S=m.slice(v).map(p.from,-1),_=m.slice(v).map(p.to),N=m.invert().map(S,-1),k=m.invert().map(_),j=(b=d.doc.nodeAt(S-1))==null?void 0:b.marks.some(T=>T.eq(p.mark)),E=(y=d.doc.nodeAt(_))==null?void 0:y.marks.some(T=>T.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:N,to:k},newRange:{from:S,to:_},partial:!!(E||j),editor:this.editor,transaction:e,combinedTransform:d})}})};(a=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||a?setTimeout(i,0):i()}}),xde=zr.create({name:"drop",addProseMirrorPlugins(){return[new Ur({key:new Gr("tiptapDrop"),props:{handleDrop:(e,t,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:r,moved:n})}}})]}}),wde=zr.create({name:"editable",addProseMirrorPlugins(){return[new Ur({key:new Gr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Sde=new Gr("focusEvents"),kde=zr.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Ur({key:Sde,props:{handleDOMEvents:{focus:(t,r)=>{e.isFocused=!0;const n=e.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,r)=>{e.isFocused=!1;const n=e.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),_de=zr.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:l})=>{const{selection:c,doc:u}=l,{empty:d,$anchor:f}=c,{pos:m,parent:p}=f,v=f.parent.isTextblock&&m>0?l.doc.resolve(m-1):f,b=v.parent.type.spec.isolating,y=f.pos-f.parentOffset,S=b&&v.parent.childCount===1?y===f.pos:lr.atStart(u).from===m;return!d||!p.type.isTextblock||p.textContent.length||!S||S&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},a={...n},i={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return gN()||rde()?i:a},addProseMirrorPlugins(){return[new Ur({key:new Gr("clearDocument"),appendTransaction:(e,t,r)=>{if(e.some(b=>b.getMeta("composition")))return;const n=e.some(b=>b.docChanged)&&!t.doc.eq(r.doc),a=e.some(b=>b.getMeta("preventClearDocument"));if(!n||a)return;const{empty:i,from:s,to:l}=t.selection,c=lr.atStart(t.doc).from,u=lr.atEnd(t.doc).to;if(i||!(s===c&&l===u)||!r1(r.doc))return;const m=r.tr,p=Xj({state:r,transaction:m}),{commands:v}=new e2({editor:this.editor,state:p});if(v.clearNodes(),!!m.steps.length)return m}})]}}),Nde=zr.create({name:"paste",addProseMirrorPlugins(){return[new Ur({key:new Gr("tiptapPaste"),props:{handlePaste:(e,t,r)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:r})}}})]}}),Cde=zr.create({name:"tabindex",addProseMirrorPlugins(){return[new Ur({key:new Gr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),jde=zr.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:e}=Cg(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const r=t.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new Ur({key:new Gr("textDirection"),props:{attributes:()=>{const e=this.options.direction;return e?{dir:e}:{}}}})]}}),U8e=class pb{constructor(t,r,n=!1,a=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=r,this.currentNode=a}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(t);return new pb(r,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new pb(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new pb(t,this.editor)}get children(){const t=[];return this.node.content.forEach((r,n)=>{const a=r.isBlock&&!r.isTextblock,i=r.isAtom&&!r.isText,s=r.isInline,l=this.pos+n+(i?0:1);if(l<0||l>this.resolvedPos.doc.nodeSize-2)return;const c=this.resolvedPos.doc.resolve(l);if(!a&&!s&&c.depth<=this.depth)return;const u=new pb(c,this.editor,a,a||s?r:null);a&&(u.actualDepth=this.depth+1),t.push(u)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,r={}){let n=null,a=this.parent;for(;a&&!n;){if(a.node.type.name===t)if(Object.keys(r).length>0){const i=a.node.attrs,s=Object.keys(r);for(let l=0;l<s.length;l+=1){const c=s[l];if(i[c]!==r[c])break}}else n=a;a=a.parent}return n}querySelector(t,r={}){return this.querySelectorAll(t,r,!0)[0]||null}querySelectorAll(t,r={},n=!1){let a=[];if(!this.children||this.children.length===0)return a;const i=Object.keys(r);return this.children.forEach(s=>{n&&a.length>0||(s.node.type.name===t&&i.every(c=>r[c]===s.node.attrs[c])&&a.push(s),!(n&&a.length>0)&&(a=a.concat(s.querySelectorAll(t,r,n))))}),a}setAttribute(t){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(r)}},H8e=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function q8e(e,t,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const a=document.createElement("style");return t&&a.setAttribute("nonce",t),a.setAttribute("data-tiptap-style",""),a.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(a),a}var W8e=class extends A8e{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:l8e,createMappablePosition:c8e},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:a,moved:i})=>this.options.onDrop(n,a,i)),this.on("paste",({event:n,slice:a})=>this.options.onPaste(n,a)),this.on("delete",this.options.onDelete);const t=this.createDoc(),r=ede(t,this.options.autofocus);this.editorState=Mp.create({doc:t,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=q8e(H8e,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const r=ide(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(a=>{const i=typeof a=="string"?`${a}$`:a.key;r=r.filter(s=>!s.key.startsWith(i))}),t.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[wde,vde.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),bde,kde,_de,Cde,xde,Nde,yde,jde.configure({direction:this.options.textDirection})].filter(a=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[a.name]!==!1:!0):[],...this.options.extensions].filter(a=>["extension","node","mark"].includes(a?.type));this.extensionManager=new a2(n,this)}createCommandManager(){this.commandManager=new e2({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=jR(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),e=jR(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){const{editorProps:t,enableExtensionDispatchTransaction:r}=this.options,n=t.dispatchTransaction||this.dispatchTransaction.bind(this),a=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new Yue(e,{...t,attributes:{role:"textbox",...t?.attributes},dispatchTransaction:a,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(u=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(u)});return}const{state:t,transactions:r}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),a=r.includes(e),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!a)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),l=s?.getMeta("focus"),c=s?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:s}),c&&this.emit("blur",{editor:this,event:c.event,transaction:s}),!(e.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||i.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:r.slice(1)})}getAttributes(e){return ude(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return i8e(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return w9(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return X$e(this.state.doc,{blockSeparator:t,textSerializers:{...cde(this.schema),...r}})}get isEmpty(){return r1(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new U8e(t,this)}get $doc(){return this.$pos(0)}};function jg(e){return new n2({find:e.find,handler:({state:t,range:r,match:n})=>{const a=Wr(e.getAttributes,void 0,n);if(a===!1||a===null)return null;const{tr:i}=t,s=n[n.length-1],l=n[0];if(s){const c=l.search(/\S/),u=r.from+l.indexOf(s),d=u+s.length;if(S9(r.from,r.to,t.doc).filter(p=>p.mark.type.excluded.find(b=>b===e.type&&b!==p.mark.type)).filter(p=>p.to>u).length)return null;d<r.to&&i.delete(d,r.to),u>r.from&&i.delete(r.from+c,u);const m=r.from+c+s.length;i.addMark(r.from+c,m,e.type.create(a||{})),i.removeStoredMark(e.type)}},undoable:e.undoable})}function K8e(e){return new n2({find:e.find,handler:({state:t,range:r,match:n})=>{const a=Wr(e.getAttributes,void 0,n)||{},{tr:i}=t,s=r.from;let l=r.to;const c=e.type.create(a);if(n[1]){const u=n[0].lastIndexOf(n[1]);let d=s+u;d>l?d=l:l=d+n[1].length;const f=n[0][n[0].length-1];i.insertText(f,s+n[0].length-1),i.replaceWith(d,l,c)}else if(n[0]){const u=e.type.isInline?s:s-1;i.insert(u,e.type.create(a)).delete(i.mapping.map(s),i.mapping.map(l))}i.scrollIntoView()},undoable:e.undoable})}function Xy(e){return new n2({find:e.find,handler:({state:t,range:r,match:n})=>{const a=t.doc.resolve(r.from),i=Wr(e.getAttributes,void 0,n)||{};if(!a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),e.type))return null;t.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,i)},undoable:e.undoable})}function Eg(e){return new n2({find:e.find,handler:({state:t,range:r,match:n,chain:a})=>{const i=Wr(e.getAttributes,void 0,n)||{},s=t.tr.delete(r.from,r.to),c=s.doc.resolve(r.from).blockRange(),u=c&&t9(c,e.type,i);if(!u)return null;if(s.wrap(c,u),e.keepMarks&&e.editor){const{selection:f,storedMarks:m}=t,{splittableMarks:p}=e.editor.extensionManager,v=m||f.$to.parentOffset&&f.$from.marks();if(v){const b=v.filter(y=>p.includes(y.type.name));s.ensureMarks(b)}}if(e.keepAttributes){const f=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";a().updateAttributes(f,i).run()}const d=s.doc.resolve(r.from-1).nodeBefore;d&&d.type===e.type&&qd(s.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(n,d))&&s.join(r.from-1)},undoable:e.undoable})}function G8e(e,t){const{selection:r}=e,{$from:n}=r;if(r instanceof $t){const i=n.index();return n.parent.canReplaceWith(i,i+1,t)}let a=n.depth;for(;a>=0;){const i=n.index(a);if(n.node(a).contentMatchAt(i).matchType(t))return!0;a-=1}return!1}function V8e(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var Y8e={};v9(Y8e,{createAtomBlockMarkdownSpec:()=>Q8e,createBlockMarkdownSpec:()=>J8e,createInlineMarkdownSpec:()=>eFe,parseAttributes:()=>N9,parseIndentedBlocks:()=>TR,renderNestedMarkdownContent:()=>j9,serializeAttributes:()=>C9});function N9(e){if(!e?.trim())return{};const t={},r=[],n=e.replace(/["']([^"']*)["']/g,u=>(r.push(u),`__QUOTED_${r.length-1}__`)),a=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(a){const u=a.map(d=>d.trim().slice(1));t.class=u.join(" ")}const i=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(t.id=i[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,u,d])=>{var f;const m=parseInt(((f=d.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),p=r[m];p&&(t[u]=p.slice(1,-1))});const c=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return c&&c.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(t[d]=!0)}),t}function C9(e){if(!e||Object.keys(e).length===0)return"";const t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?t.push(r):n!==!1&&n!=null&&t.push(`${r}="${String(n)}"`))}),t.join(" ")}function Q8e(e){const{nodeName:t,name:r,parseAttributes:n=N9,serializeAttributes:a=C9,defaultAttributes:i={},requiredAttributes:s=[],allowedAttributes:l}=e,c=r||t,u=d=>{if(!l)return d;const f={};return l.forEach(m=>{m in d&&(f[m]=d[m])}),f};return{parseMarkdown:(d,f)=>{const m={...i,...d.attributes};return f.createNode(t,m,[])},markdownTokenizer:{name:t,level:"block",start(d){var f;const m=new RegExp(`^:::${c}(?:\\s|$)`,"m"),p=(f=d.match(m))==null?void 0:f.index;return p!==void 0?p:-1},tokenize(d,f,m){const p=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=d.match(p);if(!v)return;const b=v[1]||"",y=n(b);if(!s.find(_=>!(_ in y)))return{type:t,raw:v[0],attributes:y}}},renderMarkdown:d=>{const f=u(d.attrs||{}),m=a(f),p=m?` {${m}}`:"";return`:::${c}${p} :::`}}}function J8e(e){const{nodeName:t,name:r,getContent:n,parseAttributes:a=N9,serializeAttributes:i=C9,defaultAttributes:s={},content:l="block",allowedAttributes:c}=e,u=r||t,d=f=>{if(!c)return f;const m={};return c.forEach(p=>{p in f&&(m[p]=f[p])}),m};return{parseMarkdown:(f,m)=>{let p;if(n){const b=n(f);p=typeof b=="string"?[{type:"text",text:b}]:b}else l==="block"?p=m.parseChildren(f.tokens||[]):p=m.parseInline(f.tokens||[]);const v={...s,...f.attributes};return m.createNode(t,v,p)},markdownTokenizer:{name:t,level:"block",start(f){var m;const p=new RegExp(`^:::${u}`,"m"),v=(m=f.match(p))==null?void 0:m.index;return v!==void 0?v:-1},tokenize(f,m,p){var v;const b=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),y=f.match(b);if(!y)return;const[S,_=""]=y,N=a(_);let k=1;const j=S.length;let E="";const T=/^:::([\w-]*)(\s.*)?/gm,O=f.slice(j);for(T.lastIndex=0;;){const R=T.exec(O);if(R===null)break;const q=R.index,$=R[1];if(!((v=R[2])!=null&&v.endsWith(":::"))){if($)k+=1;else if(k-=1,k===0){const L=O.slice(0,q);E=L.trim();const A=f.slice(0,j+q+R[0].length);let M=[];if(E)if(l==="block")for(M=p.blockTokens(L),M.forEach(z=>{z.text&&(!z.tokens||z.tokens.length===0)&&(z.tokens=p.inlineTokens(z.text))});M.length>0;){const z=M[M.length-1];if(z.type==="paragraph"&&(!z.text||z.text.trim()===""))M.pop();else break}else M=p.inlineTokens(E);return{type:t,raw:A,attributes:N,content:E,tokens:M}}}}}},renderMarkdown:(f,m)=>{const p=d(f.attrs||{}),v=i(p),b=v?` {${v}}`:"",y=m.renderChildren(f.content||[],`

`);return`:::${u}${b}

${y}

:::`}}}function Z8e(e){if(!e.trim())return{};const t={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(e);for(;n!==null;){const[,a,i,s]=n;t[a]=i||s,n=r.exec(e)}return t}function X8e(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,r])=>`${t}="${r}"`).join(" ")}function eFe(e){const{nodeName:t,name:r,getContent:n,parseAttributes:a=Z8e,serializeAttributes:i=X8e,defaultAttributes:s={},selfClosing:l=!1,allowedAttributes:c}=e,u=r||t,d=m=>{if(!c)return m;const p={};return c.forEach(v=>{const b=typeof v=="string"?v:v.name,y=typeof v=="string"?void 0:v.skipIfDefault;if(b in m){const S=m[b];if(y!==void 0&&S===y)return;p[b]=S}}),p},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(m,p)=>{const v={...s,...m.attributes};if(l)return p.createNode(t,v);const b=n?n(m):m.content||"";return b?p.createNode(t,v,[p.createTextNode(b)]):p.createNode(t,v,[])},markdownTokenizer:{name:t,level:"inline",start(m){const p=l?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),v=m.match(p),b=v?.index;return b!==void 0?b:-1},tokenize(m,p,v){const b=l?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),y=m.match(b);if(!y)return;let S="",_="";if(l){const[,k]=y;_=k}else{const[,k,j]=y;_=k,S=j||""}const N=a(_.trim());return{type:t,raw:y[0],content:S.trim(),attributes:N}}},renderMarkdown:m=>{let p="";n?p=n(m):m.content&&m.content.length>0&&(p=m.content.filter(S=>S.type==="text").map(S=>S.text).join(""));const v=d(m.attrs||{}),b=i(v),y=b?` ${b}`:"";return l?`[${u}${y}]`:`[${u}${y}]${p}[/${u}]`}}}function TR(e,t,r){var n,a,i,s;const l=e.split(`
`),c=[];let u="",d=0;const f=t.baseIndentSize||2;for(;d<l.length;){const m=l[d],p=m.match(t.itemPattern);if(!p){if(c.length>0)break;if(m.trim()===""){d+=1,u=`${u}${m}
`;continue}else return}const v=t.extractItemData(p),{indentLevel:b,mainContent:y}=v;u=`${u}${m}
`;const S=[y];for(d+=1;d<l.length;){const j=l[d];if(j.trim()===""){const T=l.slice(d+1).findIndex(q=>q.trim()!=="");if(T===-1)break;if((((a=(n=l[d+1+T].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:a.length)||0)>b){S.push(j),u=`${u}${j}
`,d+=1;continue}else break}if((((s=(i=j.match(/^(\s*)/))==null?void 0:i[1])==null?void 0:s.length)||0)>b)S.push(j),u=`${u}${j}
`,d+=1;else break}let _;const N=S.slice(1);if(N.length>0){const j=N.map(E=>E.slice(b+f)).join(`
`);j.trim()&&(t.customNestedParser?_=t.customNestedParser(j):_=r.blockTokens(j))}const k=t.createToken(v,_);c.push(k)}if(c.length!==0)return{items:c,raw:u}}function j9(e,t,r,n){if(!e||!Array.isArray(e.content))return"";const a=typeof r=="function"?r(n):r,[i,...s]=e.content,l=t.renderChildren([i]),c=[`${a}${l}`];return s&&s.length>0&&s.forEach(u=>{const d=t.renderChildren([u]);if(d){const f=d.split(`
`).map(m=>m?t.indent(m):"").join(`
`);c.push(f)}}),c.join(`
`)}function tFe(e,t,r={}){const{state:n}=t,{doc:a,tr:i}=n,s=e;a.descendants((l,c)=>{const u=i.mapping.map(c),d=i.mapping.map(c)+l.nodeSize;let f=null;if(l.marks.forEach(p=>{if(p!==s)return!1;f=p}),!f)return;let m=!1;if(Object.keys(r).forEach(p=>{r[p]!==f.attrs[p]&&(m=!0)}),m){const p=e.type.create({...e.attrs,...r});i.removeMark(u,d,e.type),i.addMark(u,d,p)}}),i.docChanged&&t.view.dispatch(i)}var $i=class Ede extends _9{constructor(){super(...arguments),this.type="node"}static create(t={}){const r=typeof t=="function"?t():t;return new Ede(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function Mh(e){return new R8e({find:e.find,handler:({state:t,range:r,match:n,pasteEvent:a})=>{const i=Wr(e.getAttributes,void 0,n,a);if(i===!1||i===null)return null;const{tr:s}=t,l=n[n.length-1],c=n[0];let u=r.to;if(l){const d=c.search(/\S/),f=r.from+c.indexOf(l),m=f+l.length;if(S9(r.from,r.to,t.doc).filter(v=>v.mark.type.excluded.find(y=>y===e.type&&y!==v.mark.type)).filter(v=>v.to>f).length)return null;m<r.to&&s.delete(m,r.to),f>r.from&&s.delete(r.from+d,f),u=r.from+d+l.length,s.addMark(r.from+d,u,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}var rFe=(...e)=>t=>{e.forEach(r=>{typeof r=="function"?r(t):r&&(r.current=t)})},nFe=({contentComponent:e})=>{const t=Zz.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return o.jsx(o.Fragment,{children:Object.values(t)})};function aFe(){const e=new Set;let t={};return{subscribe(r){return e.add(r),()=>{e.delete(r)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(r,n){t={...t,[r]:F1e.createPortal(n.reactElement,n.element,r)},e.forEach(a=>a())},removeRenderer(r){const n={...t};delete n[r],t=n,e.forEach(a=>a())}}}var iFe=class extends le.Component{constructor(e){var t;super(e),this.editorContentRef=le.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=e.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var e;const t=this.props.editor;if(t&&!t.isDestroyed&&((e=t.view.dom)!=null&&e.parentNode)){if(t.contentComponent)return;const r=this.editorContentRef.current;r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r}),t.contentComponent=aFe(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((e=t.view.dom)!=null&&e.parentNode))return;const r=document.createElement("div");r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r})}catch{}}}render(){const{editor:e,innerRef:t,...r}=this.props;return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:rFe(t,this.editorContentRef),...r}),e?.contentComponent&&o.jsx(nFe,{contentComponent:e.contentComponent})]})}},sFe=w.forwardRef((e,t)=>{const r=le.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return le.createElement(iFe,{key:r,innerRef:t,...e})}),oFe=le.memo(sFe),lFe=typeof window<"u"?w.useLayoutEffect:w.useEffect,cFe=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}};function uFe(e){var t;const[r]=w.useState(()=>new cFe(e.editor)),n=$1e.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,e.selector,(t=e.equalityFn)!=null?t:cle);return lFe(()=>r.watch(e.editor),[e.editor,r]),w.useDebugValue(n),n}var dFe=!1,AR=typeof window>"u",fFe=AR||!!(typeof window<"u"&&window.next),hFe=class Mde{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?AR||fFe?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...n)=>{var a,i;return(i=(a=this.options.current).onBeforeCreate)==null?void 0:i.call(a,...n)},onBlur:(...n)=>{var a,i;return(i=(a=this.options.current).onBlur)==null?void 0:i.call(a,...n)},onCreate:(...n)=>{var a,i;return(i=(a=this.options.current).onCreate)==null?void 0:i.call(a,...n)},onDestroy:(...n)=>{var a,i;return(i=(a=this.options.current).onDestroy)==null?void 0:i.call(a,...n)},onFocus:(...n)=>{var a,i;return(i=(a=this.options.current).onFocus)==null?void 0:i.call(a,...n)},onSelectionUpdate:(...n)=>{var a,i;return(i=(a=this.options.current).onSelectionUpdate)==null?void 0:i.call(a,...n)},onTransaction:(...n)=>{var a,i;return(i=(a=this.options.current).onTransaction)==null?void 0:i.call(a,...n)},onUpdate:(...n)=>{var a,i;return(i=(a=this.options.current).onUpdate)==null?void 0:i.call(a,...n)},onContentError:(...n)=>{var a,i;return(i=(a=this.options.current).onContentError)==null?void 0:i.call(a,...n)},onDrop:(...n)=>{var a,i;return(i=(a=this.options.current).onDrop)==null?void 0:i.call(a,...n)},onPaste:(...n)=>{var a,i;return(i=(a=this.options.current).onPaste)==null?void 0:i.call(a,...n)},onDelete:(...n)=>{var a,i;return(i=(a=this.options.current).onDelete)==null?void 0:i.call(a,...n)}};return new W8e(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,r){return Object.keys(t).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&t.extensions&&r.extensions?t.extensions.length!==r.extensions.length?!1:t.extensions.every((a,i)=>{var s;return a===((s=r.extensions)==null?void 0:s[i])}):t[n]===r[n])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?Mde.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((n,a)=>n===t[a]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function mFe(e={},t=[]){const r=w.useRef(e);r.current=e;const[n]=w.useState(()=>new hFe(r)),a=Zz.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return w.useDebugValue(a),w.useEffect(n.onRender(t)),uFe({editor:a,selector:({transactionNumber:i})=>e.shouldRerenderOnTransaction===!1||e.shouldRerenderOnTransaction===void 0?null:e.immediatelyRender&&i===0?0:i+1}),a}var pFe=w.createContext({editor:null});pFe.Consumer;var gFe=w.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),vFe=()=>w.useContext(gFe);le.forwardRef((e,t)=>{const{onDragStart:r}=vFe(),n=e.as||"div";return o.jsx(n,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...e.style}})});function aJ(e){return!!(typeof e=="function"&&e.prototype&&e.prototype.isReactComponent)}function iJ(e){return!!(typeof e=="object"&&e.$$typeof&&(e.$$typeof.toString()==="Symbol(react.forward_ref)"||e.$$typeof.description==="react.forward_ref"))}function bFe(e){return!!(typeof e=="object"&&e.$$typeof&&(e.$$typeof.toString()==="Symbol(react.memo)"||e.$$typeof.description==="react.memo"))}function yFe(e){if(aJ(e)||iJ(e))return!0;if(bFe(e)){const t=e.type;if(t)return aJ(t)||iJ(t)}return!1}function xFe(){try{if(w.version)return parseInt(w.version.split(".")[0],10)>=19}catch{}return!1}var E9=class{constructor(e,{editor:t,props:r={},as:n="div",className:a=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=t,this.props=r,this.element=document.createElement(n),this.element.classList.add("react-renderer"),a&&this.element.classList.add(...a.split(" ")),this.editor.isInitialized?pd.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var e;if(this.destroyed)return;const t=this.component,r=this.props,n=this.editor,a=xFe(),i=yFe(t),s={...r};s.ref&&!(a||i)&&delete s.ref,!s.ref&&(a||i)&&(s.ref=l=>{this.ref=l}),this.reactElement=o.jsx(t,{...s}),(e=n?.contentComponent)==null||e.setRenderer(this.id,this)}updateProps(e={}){this.destroyed||(this.props={...this.props,...e},this.render())}destroy(){var e;this.destroyed=!0;const t=this.editor;(e=t?.contentComponent)==null||e.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}};le.createContext({markViewContentRef:()=>{}});var bN=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);const{children:r,...n}=t??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,r]},wFe=/^\s*>\s$/,SFe=$i.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return bN("blockquote",{...Jn(this.options.HTMLAttributes,e),children:bN("slot",{})})},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const r=">",n=[];return e.content.forEach(a=>{const l=t.renderChildren([a]).split(`
`).map(c=>c.trim()===""?r:`${r} ${c}`);n.push(l.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Eg({find:wFe,type:this.type})]}}),kFe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,_Fe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,NFe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,CFe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,jFe=Xh.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return bN("strong",{...Jn(this.options.HTMLAttributes,e),children:bN("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[jg({find:kFe,type:this.type}),jg({find:NFe,type:this.type})]},addPasteRules(){return[Mh({find:_Fe,type:this.type}),Mh({find:CFe,type:this.type})]}}),EFe=/(^|[^`])`([^`]+)`(?!`)$/,MFe=/(^|[^`])`([^`]+)`(?!`)/g,TFe=Xh.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[jg({find:EFe,type:this.type})]},addPasteRules(){return[Mh({find:MFe,type:this.type})]}}),$D=4,AFe=/^```([a-z]+)?[\s\n]$/,DFe=/^~~~([a-z]+)?[\s\n]$/,LFe=$i.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:$D,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options;if(!r)return null;const i=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(s=>s.startsWith(r)).map(s=>s.replace(r,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",Jn(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var r;return((r=e.raw)==null?void 0:r.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var r;let n="";const a=((r=e.attrs)==null?void 0:r.language)||"";return e.content?n=[`\`\`\`${a}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${a}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=t.pos===1;return!e||t.parent.type.name!==this.name?!1:r||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:$D,{state:n}=e,{selection:a}=n,{$from:i,empty:s}=a;if(i.parent.type!==this.type)return!1;const l=" ".repeat(r);return s?e.commands.insertContent(l):e.commands.command(({tr:c})=>{const{from:u,to:d}=a,p=n.doc.textBetween(u,d,`
`,`
`).split(`
`).map(v=>l+v).join(`
`);return c.replaceWith(u,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:$D,{state:n}=e,{selection:a}=n,{$from:i,empty:s}=a;return i.parent.type!==this.type?!1:s?e.commands.command(({tr:l})=>{var c;const{pos:u}=i,d=i.start(),f=i.end(),p=n.doc.textBetween(d,f,`
`,`
`).split(`
`);let v=0,b=0;const y=u-d;for(let E=0;E<p.length;E+=1){if(b+p[E].length>=y){v=E;break}b+=p[E].length+1}const _=((c=p[v].match(/^ */))==null?void 0:c[0])||"",N=Math.min(_.length,r);if(N===0)return!0;let k=d;for(let E=0;E<v;E+=1)k+=p[E].length+1;return l.delete(k,k+N),u-k<=N&&l.setSelection(Yt.create(l.doc,k)),!0}):e.commands.command(({tr:l})=>{const{from:c,to:u}=a,m=n.doc.textBetween(c,u,`
`,`
`).split(`
`).map(p=>{var v;const b=((v=p.match(/^ */))==null?void 0:v[0])||"",y=Math.min(b.length,r);return p.slice(y)}).join(`
`);return l.replaceWith(c,u,n.schema.text(m)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:a}=r;if(!a||n.parent.type!==this.type)return!1;const i=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!i||!s?!1:e.chain().command(({tr:l})=>(l.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:a,empty:i}=r;if(!i||a.parent.type!==this.type||!(a.parentOffset===a.parent.nodeSize-2))return!1;const l=a.after();return l===void 0?!1:n.nodeAt(l)?e.commands.command(({tr:u})=>(u.setSelection(lr.near(n.resolve(l))),!0)):e.commands.exitCode()}}},addInputRules(){return[Xy({find:AFe,type:this.type,getAttributes:e=>({language:e[1]})}),Xy({find:DFe,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Ur({key:new Gr("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),a=n?JSON.parse(n):void 0,i=a?.mode;if(!r||!i)return!1;const{tr:s,schema:l}=e.state,c=l.text(r.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:i},c)),s.selection.$from.parent.type!==this.type&&s.setSelection(Yt.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),OFe=$i.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""}),IFe=$i.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",Jn(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:r,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:a,storedMarks:i}=r;if(a.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:l}=n.extensionManager,c=i||a.$to.parentOffset&&a.$from.marks();return t().insertContent({type:this.name}).command(({tr:u,dispatch:d})=>{if(d&&c&&s){const f=c.filter(m=>l.includes(m.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),RFe=$i.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Jn(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var r;const n=(r=e.attrs)!=null&&r.level?parseInt(e.attrs.level,10):1,a="#".repeat(n);return e.content?`${a} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>Xy({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),PFe=$i.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",Jn(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!G8e(t,t.schema.nodes[this.name]))return!1;const{selection:r}=t,{$to:n}=r,a=e();return k9(r)?a.insertContentAt(n.pos,{type:this.name}):a.insertContent({type:this.name}),a.command(({state:i,tr:s,dispatch:l})=>{if(l){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(Yt.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection($t.create(s.doc,c.pos)):s.setSelection(Yt.create(s.doc,c.pos));else{const d=i.schema.nodes[this.options.nextNodeType]||c.parent.type.contentMatch.defaultType,f=d?.create();f&&(s.insert(u,f),s.setSelection(Yt.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[K8e({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),zFe=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,BFe=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,$Fe=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,FFe=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,UFe=Xh.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Jn(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[jg({find:zFe,type:this.type}),jg({find:$Fe,type:this.type})]},addPasteRules(){return[Mh({find:BFe,type:this.type}),Mh({find:FFe,type:this.type})]}});const HFe="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",qFe="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",DR="numeric",LR="ascii",OR="alpha",Bb="asciinumeric",gb="alphanumeric",IR="domain",Tde="emoji",WFe="scheme",KFe="slashscheme",FD="whitespace";function GFe(e,t){return e in t||(t[e]=[]),t[e]}function Jf(e,t,r){t[DR]&&(t[Bb]=!0,t[gb]=!0),t[LR]&&(t[Bb]=!0,t[OR]=!0),t[Bb]&&(t[gb]=!0),t[OR]&&(t[gb]=!0),t[gb]&&(t[IR]=!0),t[Tde]&&(t[IR]=!0);for(const n in t){const a=GFe(n,r);a.indexOf(e)<0&&a.push(e)}}function VFe(e,t){const r={};for(const n in t)t[n].indexOf(e)>=0&&(r[n]=!0);return r}function Zi(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Zi.groups={};Zi.prototype={accepts(){return!!this.t},go(e){const t=this,r=t.j[e];if(r)return r;for(let n=0;n<t.jr.length;n++){const a=t.jr[n][0],i=t.jr[n][1];if(i&&a.test(e))return i}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,r,n){for(let a=0;a<e.length;a++)this.tt(e[a],t,r,n)},tr(e,t,r,n){n=n||Zi.groups;let a;return t&&t.j?a=t:(a=new Zi(t),r&&n&&Jf(t,r,n)),this.jr.push([e,a]),a},ts(e,t,r,n){let a=this;const i=e.length;if(!i)return a;for(let s=0;s<i-1;s++)a=a.tt(e[s]);return a.tt(e[i-1],t,r,n)},tt(e,t,r,n){n=n||Zi.groups;const a=this;if(t&&t.j)return a.j[e]=t,t;const i=t;let s,l=a.go(e);if(l?(s=new Zi,Object.assign(s.j,l.j),s.jr.push.apply(s.jr,l.jr),s.jd=l.jd,s.t=l.t):s=new Zi,i){if(n)if(s.t&&typeof s.t=="string"){const c=Object.assign(VFe(s.t,n),r);Jf(i,c,n)}else r&&Jf(i,r,n);s.t=i}return a.j[e]=s,s}};const dr=(e,t,r,n,a)=>e.ta(t,r,n,a),Hn=(e,t,r,n,a)=>e.tr(t,r,n,a),sJ=(e,t,r,n,a)=>e.ts(t,r,n,a),Ze=(e,t,r,n,a)=>e.tt(t,r,n,a),Dc="WORD",RR="UWORD",Ade="ASCIINUMERICAL",Dde="ALPHANUMERICAL",ex="LOCALHOST",PR="TLD",zR="UTLD",xk="SCHEME",bp="SLASH_SCHEME",M9="NUM",BR="WS",T9="NL",$b="OPENBRACE",Fb="CLOSEBRACE",yN="OPENBRACKET",xN="CLOSEBRACKET",wN="OPENPAREN",SN="CLOSEPAREN",kN="OPENANGLEBRACKET",_N="CLOSEANGLEBRACKET",NN="FULLWIDTHLEFTPAREN",CN="FULLWIDTHRIGHTPAREN",jN="LEFTCORNERBRACKET",EN="RIGHTCORNERBRACKET",MN="LEFTWHITECORNERBRACKET",TN="RIGHTWHITECORNERBRACKET",AN="FULLWIDTHLESSTHAN",DN="FULLWIDTHGREATERTHAN",LN="AMPERSAND",ON="APOSTROPHE",IN="ASTERISK",sd="AT",RN="BACKSLASH",PN="BACKTICK",zN="CARET",fd="COLON",A9="COMMA",BN="DOLLAR",pl="DOT",$N="EQUALS",D9="EXCLAMATION",co="HYPHEN",Ub="PERCENT",FN="PIPE",UN="PLUS",HN="POUND",Hb="QUERY",L9="QUOTE",Lde="FULLWIDTHMIDDLEDOT",O9="SEMI",gl="SLASH",qb="TILDE",qN="UNDERSCORE",Ode="EMOJI",WN="SYM";var Ide=Object.freeze({__proto__:null,ALPHANUMERICAL:Dde,AMPERSAND:LN,APOSTROPHE:ON,ASCIINUMERICAL:Ade,ASTERISK:IN,AT:sd,BACKSLASH:RN,BACKTICK:PN,CARET:zN,CLOSEANGLEBRACKET:_N,CLOSEBRACE:Fb,CLOSEBRACKET:xN,CLOSEPAREN:SN,COLON:fd,COMMA:A9,DOLLAR:BN,DOT:pl,EMOJI:Ode,EQUALS:$N,EXCLAMATION:D9,FULLWIDTHGREATERTHAN:DN,FULLWIDTHLEFTPAREN:NN,FULLWIDTHLESSTHAN:AN,FULLWIDTHMIDDLEDOT:Lde,FULLWIDTHRIGHTPAREN:CN,HYPHEN:co,LEFTCORNERBRACKET:jN,LEFTWHITECORNERBRACKET:MN,LOCALHOST:ex,NL:T9,NUM:M9,OPENANGLEBRACKET:kN,OPENBRACE:$b,OPENBRACKET:yN,OPENPAREN:wN,PERCENT:Ub,PIPE:FN,PLUS:UN,POUND:HN,QUERY:Hb,QUOTE:L9,RIGHTCORNERBRACKET:EN,RIGHTWHITECORNERBRACKET:TN,SCHEME:xk,SEMI:O9,SLASH:gl,SLASH_SCHEME:bp,SYM:WN,TILDE:qb,TLD:PR,UNDERSCORE:qN,UTLD:zR,UWORD:RR,WORD:Dc,WS:BR});const gc=/[a-z]/,Ev=/\p{L}/u,UD=/\p{Emoji}/u,vc=/\d/,HD=/\s/,oJ="\r",qD=`
`,YFe="",QFe="",WD="";let pS=null,gS=null;function JFe(e=[]){const t={};Zi.groups=t;const r=new Zi;pS==null&&(pS=lJ(HFe)),gS==null&&(gS=lJ(qFe)),Ze(r,"'",ON),Ze(r,"{",$b),Ze(r,"}",Fb),Ze(r,"[",yN),Ze(r,"]",xN),Ze(r,"(",wN),Ze(r,")",SN),Ze(r,"<",kN),Ze(r,">",_N),Ze(r,"",NN),Ze(r,"",CN),Ze(r,"",jN),Ze(r,"",EN),Ze(r,"",MN),Ze(r,"",TN),Ze(r,"",AN),Ze(r,"",DN),Ze(r,"&",LN),Ze(r,"*",IN),Ze(r,"@",sd),Ze(r,"`",PN),Ze(r,"^",zN),Ze(r,":",fd),Ze(r,",",A9),Ze(r,"$",BN),Ze(r,".",pl),Ze(r,"=",$N),Ze(r,"!",D9),Ze(r,"-",co),Ze(r,"%",Ub),Ze(r,"|",FN),Ze(r,"+",UN),Ze(r,"#",HN),Ze(r,"?",Hb),Ze(r,'"',L9),Ze(r,"/",gl),Ze(r,";",O9),Ze(r,"~",qb),Ze(r,"_",qN),Ze(r,"\\",RN),Ze(r,"",Lde);const n=Hn(r,vc,M9,{[DR]:!0});Hn(n,vc,n);const a=Hn(n,gc,Ade,{[Bb]:!0}),i=Hn(n,Ev,Dde,{[gb]:!0}),s=Hn(r,gc,Dc,{[LR]:!0});Hn(s,vc,a),Hn(s,gc,s),Hn(a,vc,a),Hn(a,gc,a);const l=Hn(r,Ev,RR,{[OR]:!0});Hn(l,gc),Hn(l,vc,i),Hn(l,Ev,l),Hn(i,vc,i),Hn(i,gc),Hn(i,Ev,i);const c=Ze(r,qD,T9,{[FD]:!0}),u=Ze(r,oJ,BR,{[FD]:!0}),d=Hn(r,HD,BR,{[FD]:!0});Ze(r,WD,d),Ze(u,qD,c),Ze(u,WD,d),Hn(u,HD,d),Ze(d,oJ),Ze(d,qD),Hn(d,HD,d),Ze(d,WD,d);const f=Hn(r,UD,Ode,{[Tde]:!0});Ze(f,"#"),Hn(f,UD,f),Ze(f,YFe,f);const m=Ze(f,QFe);Ze(m,"#"),Hn(m,UD,f);const p=[[gc,s],[vc,a]],v=[[gc,null],[Ev,l],[vc,i]];for(let b=0;b<pS.length;b++)Gu(r,pS[b],PR,Dc,p);for(let b=0;b<gS.length;b++)Gu(r,gS[b],zR,RR,v);Jf(PR,{tld:!0,ascii:!0},t),Jf(zR,{utld:!0,alpha:!0},t),Gu(r,"file",xk,Dc,p),Gu(r,"mailto",xk,Dc,p),Gu(r,"http",bp,Dc,p),Gu(r,"https",bp,Dc,p),Gu(r,"ftp",bp,Dc,p),Gu(r,"ftps",bp,Dc,p),Jf(xk,{scheme:!0,ascii:!0},t),Jf(bp,{slashscheme:!0,ascii:!0},t),e=e.sort((b,y)=>b[0]>y[0]?1:-1);for(let b=0;b<e.length;b++){const y=e[b][0],_=e[b][1]?{[WFe]:!0}:{[KFe]:!0};y.indexOf("-")>=0?_[IR]=!0:gc.test(y)?vc.test(y)?_[Bb]=!0:_[LR]=!0:_[DR]=!0,sJ(r,y,y,_)}return sJ(r,"localhost",ex,{ascii:!0}),r.jd=new Zi(WN),{start:r,tokens:Object.assign({groups:t},Ide)}}function Rde(e,t){const r=ZFe(t.replace(/[A-Z]/g,l=>l.toLowerCase())),n=r.length,a=[];let i=0,s=0;for(;s<n;){let l=e,c=null,u=0,d=null,f=-1,m=-1;for(;s<n&&(c=l.go(r[s]));)l=c,l.accepts()?(f=0,m=0,d=l):f>=0&&(f+=r[s].length,m++),u+=r[s].length,i+=r[s].length,s++;i-=f,s-=m,u-=f,a.push({t:d.t,v:t.slice(i-u,i),s:i-u,e:i})}return a}function ZFe(e){const t=[],r=e.length;let n=0;for(;n<r;){let a=e.charCodeAt(n),i,s=a<55296||a>56319||n+1===r||(i=e.charCodeAt(n+1))<56320||i>57343?e[n]:e.slice(n,n+2);t.push(s),n+=s.length}return t}function Gu(e,t,r,n,a){let i;const s=t.length;for(let l=0;l<s-1;l++){const c=t[l];e.j[c]?i=e.j[c]:(i=new Zi(n),i.jr=a.slice(),e.j[c]=i),e=i}return i=new Zi(r),i.jr=a.slice(),e.j[t[s-1]]=i,i}function lJ(e){const t=[],r=[];let n=0,a="0123456789";for(;n<e.length;){let i=0;for(;a.indexOf(e[n+i])>=0;)i++;if(i>0){t.push(r.join(""));for(let s=parseInt(e.substring(n,n+i),10);s>0;s--)r.pop();n+=i}else r.push(e[n]),n++}return t}const tx={defaultProtocol:"http",events:null,format:cJ,formatHref:cJ,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function I9(e,t=null){let r=Object.assign({},tx);e&&(r=Object.assign(r,e instanceof I9?e.o:e));const n=r.ignoreTags,a=[];for(let i=0;i<n.length;i++)a.push(n[i].toUpperCase());this.o=r,t&&(this.defaultRender=t),this.ignoreTags=a}I9.prototype={o:tx,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,r){const n=t!=null;let a=this.o[e];return a&&(typeof a=="object"?(a=r.t in a?a[r.t]:tx[e],typeof a=="function"&&n&&(a=a(t,r))):typeof a=="function"&&n&&(a=a(t,r.t,r)),a)},getObj(e,t,r){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,r.t,r)),n},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function cJ(e){return e}function Pde(e,t){this.t="token",this.v=e,this.tk=t}Pde.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),r=e.get("truncate",t,this),n=e.get("format",t,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=tx.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,r=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",r,this),a=e.get("tagName",r,t),i=this.toFormattedString(e),s={},l=e.get("className",r,t),c=e.get("target",r,t),u=e.get("rel",r,t),d=e.getObj("attributes",r,t),f=e.getObj("events",r,t);return s.href=n,l&&(s.class=l),c&&(s.target=c),u&&(s.rel=u),d&&Object.assign(s,d),{tagName:a,attributes:s,content:i,eventListeners:f}}};function i2(e,t){class r extends Pde{constructor(a,i){super(a,i),this.t=e}}for(const n in t)r.prototype[n]=t[n];return r.t=e,r}const uJ=i2("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),dJ=i2("text"),XFe=i2("nl"),vS=i2("url",{isLink:!0,toHref(e=tx.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==ex&&e[1].t===fd}}),ro=e=>new Zi(e);function eUe({groups:e}){const t=e.domain.concat([LN,IN,sd,RN,PN,zN,BN,$N,co,M9,Ub,FN,UN,HN,gl,WN,qb,qN]),r=[ON,fd,A9,pl,D9,Ub,Hb,L9,O9,kN,_N,$b,Fb,xN,yN,wN,SN,NN,CN,jN,EN,MN,TN,AN,DN],n=[LN,ON,IN,RN,PN,zN,BN,$N,co,$b,Fb,Ub,FN,UN,HN,Hb,gl,WN,qb,qN],a=ro(),i=Ze(a,qb);dr(i,n,i),dr(i,e.domain,i);const s=ro(),l=ro(),c=ro();dr(a,e.domain,s),dr(a,e.scheme,l),dr(a,e.slashscheme,c),dr(s,n,i),dr(s,e.domain,s);const u=Ze(s,sd);Ze(i,sd,u),Ze(l,sd,u),Ze(c,sd,u);const d=Ze(i,pl);dr(d,n,i),dr(d,e.domain,i);const f=ro();dr(u,e.domain,f),dr(f,e.domain,f);const m=Ze(f,pl);dr(m,e.domain,f);const p=ro(uJ);dr(m,e.tld,p),dr(m,e.utld,p),Ze(u,ex,p);const v=Ze(f,co);Ze(v,co,v),dr(v,e.domain,f),dr(p,e.domain,f),Ze(p,pl,m),Ze(p,co,v);const b=Ze(p,fd);dr(b,e.numeric,uJ);const y=Ze(s,co),S=Ze(s,pl);Ze(y,co,y),dr(y,e.domain,s),dr(S,n,i),dr(S,e.domain,s);const _=ro(vS);dr(S,e.tld,_),dr(S,e.utld,_),dr(_,e.domain,s),dr(_,n,i),Ze(_,pl,S),Ze(_,co,y),Ze(_,sd,u);const N=Ze(_,fd),k=ro(vS);dr(N,e.numeric,k);const j=ro(vS),E=ro();dr(j,t,j),dr(j,r,E),dr(E,t,j),dr(E,r,E),Ze(_,gl,j),Ze(k,gl,j);const T=Ze(l,fd),O=Ze(c,fd),R=Ze(O,gl),q=Ze(R,gl);dr(l,e.domain,s),Ze(l,pl,S),Ze(l,co,y),dr(c,e.domain,s),Ze(c,pl,S),Ze(c,co,y),dr(T,e.domain,j),Ze(T,gl,j),Ze(T,Hb,j),dr(q,e.domain,j),dr(q,t,j),Ze(q,gl,j);const $=[[$b,Fb],[yN,xN],[wN,SN],[kN,_N],[NN,CN],[jN,EN],[MN,TN],[AN,DN]];for(let L=0;L<$.length;L++){const[A,M]=$[L],z=Ze(j,A);Ze(E,A,z),Ze(z,M,j);const I=ro(vS);dr(z,t,I);const B=ro();dr(z,r),dr(I,t,I),dr(I,r,B),dr(B,t,I),dr(B,r,B),Ze(I,M,j),Ze(B,M,j)}return Ze(a,ex,_),Ze(a,T9,XFe),{start:a,tokens:Ide}}function tUe(e,t,r){let n=r.length,a=0,i=[],s=[];for(;a<n;){let l=e,c=null,u=null,d=0,f=null,m=-1;for(;a<n&&!(c=l.go(r[a].t));)s.push(r[a++]);for(;a<n&&(u=c||l.go(r[a].t));)c=null,l=u,l.accepts()?(m=0,f=l):m>=0&&m++,a++,d++;if(m<0)a-=d,a<n&&(s.push(r[a]),a++);else{s.length>0&&(i.push(KD(dJ,t,s)),s=[]),a-=m,d-=m;const p=f.t,v=r.slice(a-d,a);i.push(KD(p,t,v))}}return s.length>0&&i.push(KD(dJ,t,s)),i}function KD(e,t,r){const n=r[0].s,a=r[r.length-1].e,i=t.slice(n,a);return new e(i,r)}const rUe=typeof console<"u"&&console&&console.warn||(()=>{}),nUe="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",_n={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function aUe(){return Zi.groups={},_n.scanner=null,_n.parser=null,_n.tokenQueue=[],_n.pluginQueue=[],_n.customSchemes=[],_n.initialized=!1,_n}function fJ(e,t=!1){if(_n.initialized&&rUe(`linkifyjs: already initialized - will not register custom scheme "${e}" ${nUe}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);_n.customSchemes.push([e,t])}function iUe(){_n.scanner=JFe(_n.customSchemes);for(let e=0;e<_n.tokenQueue.length;e++)_n.tokenQueue[e][1]({scanner:_n.scanner});_n.parser=eUe(_n.scanner.tokens);for(let e=0;e<_n.pluginQueue.length;e++)_n.pluginQueue[e][1]({scanner:_n.scanner,parser:_n.parser});return _n.initialized=!0,_n}function R9(e){return _n.initialized||iUe(),tUe(_n.parser.start,e,Rde(_n.scanner.start,e))}R9.scan=Rde;function zde(e,t=null,r=null){if(t&&typeof t=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);r=t,t=null}const n=new I9(r),a=R9(e),i=[];for(let s=0;s<a.length;s++){const l=a[s];l.isLink&&(!t||l.t===t)&&n.check(l)&&i.push(l.toFormattedObject(n))}return i}var P9="[\0- -\u2029]",sUe=new RegExp(P9),oUe=new RegExp(`${P9}$`),lUe=new RegExp(P9,"g");function cUe(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function uUe(e){return new Ur({key:new Gr("autolink"),appendTransaction:(t,r,n)=>{const a=t.some(u=>u.docChanged)&&!r.doc.eq(n.doc),i=t.some(u=>u.getMeta("preventAutolink"));if(!a||i)return;const{tr:s}=n,l=ade(r.doc,[...t]);if(dde(l).forEach(({newRange:u})=>{const d=G$e(n.doc,u,p=>p.isTextblock);let f,m;if(d.length>1)f=d[0],m=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(d.length){const p=n.doc.textBetween(u.from,u.to," "," ");if(!oUe.test(p))return;f=d[0],m=n.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&m){const p=m.split(sUe).filter(Boolean);if(p.length<=0)return!1;const v=p[p.length-1],b=f.pos+m.lastIndexOf(v);if(!v)return!1;const y=R9(v).map(S=>S.toObject(e.defaultProtocol));if(!cUe(y))return!1;y.filter(S=>S.isLink).map(S=>({...S,from:b+S.start+1,to:b+S.end+1})).filter(S=>n.schema.marks.code?!n.doc.rangeHasMark(S.from,S.to,n.schema.marks.code):!0).filter(S=>e.validate(S.value)).filter(S=>e.shouldAutoLink(S.value)).forEach(S=>{S9(S.from,S.to,n.doc).some(_=>_.mark.type===e.type)||s.addMark(S.from,S.to,e.type.create({href:S.href}))})}}),!!s.steps.length)return s}})}function dUe(e){return new Ur({key:new Gr("handleClickLink"),props:{handleClick:(t,r,n)=>{var a,i;if(n.button!==0||!t.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{const c=n.target;if(!c)return!1;const u=e.editor.view.dom;s=c.closest("a"),s&&!u.contains(s)&&(s=null)}if(!s)return!1;let l=!1;if(e.enableClickSelection&&(l=e.editor.commands.extendMarkRange(e.type.name)),e.openOnClick){const c=ude(t.state,e.type.name),u=(a=s.href)!=null?a:c.href,d=(i=s.target)!=null?i:c.target;u&&(window.open(u,d),l=!0)}return l}}})}function fUe(e){return new Ur({key:new Gr("handlePasteLink"),props:{handlePaste:(t,r,n)=>{const{shouldAutoLink:a}=e,{state:i}=t,{selection:s}=i,{empty:l}=s;if(l)return!1;let c="";n.content.forEach(d=>{c+=d.textContent});const u=zde(c,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===c);return!c||!u||a!==void 0&&!a(u.value)?!1:e.editor.commands.setMark(e.type,{href:u.href})}}})}function gf(e,t){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{const a=typeof n=="string"?n:n.scheme;a&&r.push(a)}),!e||e.replace(lUe,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var Bde=Xh.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){fJ(e);return}fJ(e.scheme,e.optionalSlashes)})},onDestroy(){aUe()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!gf(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(e),r=/^[a-z][a-z0-9+.-]*:/i.test(e);if(t||r&&!e.includes("@"))return!0;const a=(e.includes("@")?e.split("@").pop():e).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(a)||!/\./.test(a))}}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:r=>!!gf(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!gf(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Jn(this.options.HTMLAttributes,e),0]:["a",Jn(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var r;const n=((r=e.attrs)==null?void 0:r.href)||"";return`[${t.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:r}=e;return this.options.isAllowedUri(r,{defaultValidate:n=>!!gf(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:r}=e||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!gf(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Mh({find:e=>{const t=[];if(e){const{protocols:r,defaultProtocol:n}=this.options,a=zde(e).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:s=>!!gf(s,r),protocols:r,defaultProtocol:n}));a.length&&a.forEach(i=>{this.options.shouldAutoLink(i.value)&&t.push({text:i.value,data:{href:i.href},index:i.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:r}=this.options;return this.options.autolink&&e.push(uUe({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:a=>!!gf(a,t),protocols:t,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),e.push(dUe({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(fUe({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),hUe=Bde,mUe=Object.defineProperty,pUe=(e,t)=>{for(var r in t)mUe(e,r,{get:t[r],enumerable:!0})},gUe="listItem",hJ="textStyle",mJ=/^\s*([-+*])\s$/,$de=$i.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(gUe,this.editor.getAttributes(hJ)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Eg({find:mJ,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Eg({find:mJ,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(hJ),editor:this.editor})),[e]}}),Fde=$i.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let r=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(a=>a.type==="paragraph"))r=t.parseChildren(e.tokens);else{const a=e.tokens[0];if(a&&a.type==="text"&&a.tokens&&a.tokens.length>0){if(r=[{type:"paragraph",content:t.parseInline(a.tokens)}],e.tokens.length>1){const s=e.tokens.slice(1),l=t.parseChildren(s);r.push(...l)}}else r=t.parseChildren(e.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(e,t,r)=>j9(e,t,n=>{var a,i;return n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${(((i=(a=n.meta)==null?void 0:a.parentAttrs)==null?void 0:i.start)||1)+n.index}. `:"- "},r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),vUe={};pUe(vUe,{findListItemPos:()=>n1,getNextListDepth:()=>z9,handleBackspace:()=>$R,handleDelete:()=>FR,hasListBefore:()=>Ude,hasListItemAfter:()=>bUe,hasListItemBefore:()=>Hde,listItemHasSubList:()=>qde,nextListIsDeeper:()=>Wde,nextListIsHigher:()=>Kde});var n1=(e,t)=>{const{$from:r}=t.selection,n=ba(e,t.schema);let a=null,i=r.depth,s=r.pos,l=null;for(;i>0&&l===null;)a=r.node(i),a.type===n?l=i:(i-=1,s-=1);return l===null?null:{$pos:t.doc.resolve(s),depth:l}},z9=(e,t)=>{const r=n1(e,t);if(!r)return!1;const[,n]=n8e(t,e,r.$pos.pos+4);return n},Ude=(e,t,r)=>{const{$anchor:n}=e.selection,a=Math.max(0,n.pos-2),i=e.doc.resolve(a).node();return!(!i||!r.includes(i.type.name))},Hde=(e,t)=>{var r;const{$anchor:n}=t.selection,a=t.doc.resolve(n.pos-2);return!(a.index()===0||((r=a.nodeBefore)==null?void 0:r.type.name)!==e)},qde=(e,t,r)=>{if(!r)return!1;const n=ba(e,t.schema);let a=!1;return r.descendants(i=>{i.type===n&&(a=!0)}),a},$R=(e,t,r)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!Rd(e.state,t)&&Ude(e.state,t,r)){const{$anchor:l}=e.state.selection,c=e.state.doc.resolve(l.before()-1),u=[];c.node().descendants((m,p)=>{m.type.name===t&&u.push({node:m,pos:p})});const d=u.at(-1);if(!d)return!1;const f=e.state.doc.resolve(c.start()+d.pos+1);return e.chain().cut({from:l.start()-1,to:l.end()+1},f.end()).joinForward().run()}if(!Rd(e.state,t)||!o8e(e.state))return!1;const n=n1(t,e.state);if(!n)return!1;const i=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=qde(t,e.state,i);return Hde(t,e.state)&&!s?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},Wde=(e,t)=>{const r=z9(e,t),n=n1(e,t);return!n||!r?!1:r>n.depth},Kde=(e,t)=>{const r=z9(e,t),n=n1(e,t);return!n||!r?!1:r<n.depth},FR=(e,t)=>{if(!Rd(e.state,t)||!s8e(e.state,t))return!1;const{selection:r}=e.state,{$from:n,$to:a}=r;return!r.empty&&n.sameParent(a)?!1:Wde(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():Kde(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},bUe=(e,t)=>{var r;const{$anchor:n}=t.selection,a=t.doc.resolve(n.pos-n.parentOffset-2);return!(a.index()===a.parent.childCount-1||((r=a.nodeAfter)==null?void 0:r.type.name)!==e)},Gde=zr.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&FR(e,r)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&FR(e,r)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&$R(e,r,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&$R(e,r,n)&&(t=!0)}),t}}}}),pJ=/^(\s*)(\d+)\.\s+(.*)$/,yUe=/^\s/;function xUe(e){const t=[];let r=0,n=0;for(;r<e.length;){const a=e[r],i=a.match(pJ);if(!i)break;const[,s,l,c]=i,u=s.length;let d=c,f=r+1;const m=[a];for(;f<e.length;){const p=e[f];if(p.match(pJ))break;if(p.trim()==="")m.push(p),d+=`
`,f+=1;else if(p.match(yUe))m.push(p),d+=`
${p.slice(u+2)}`,f+=1;else break}t.push({indent:u,number:parseInt(l,10),content:d.trim(),raw:m.join(`
`)}),n=f,r=f}return[t,n]}function Vde(e,t,r){var n;const a=[];let i=0;for(;i<e.length;){const s=e[i];if(s.indent===t){const l=s.content.split(`
`),c=((n=l[0])==null?void 0:n.trim())||"",u=[];c&&u.push({type:"paragraph",raw:c,tokens:r.inlineTokens(c)});const d=l.slice(1).join(`
`).trim();if(d){const p=r.blockTokens(d);u.push(...p)}let f=i+1;const m=[];for(;f<e.length&&e[f].indent>t;)m.push(e[f]),f+=1;if(m.length>0){const p=Math.min(...m.map(b=>b.indent)),v=Vde(m,p,r);u.push({type:"list",ordered:!0,start:m[0].number,items:v,raw:m.map(b=>b.raw).join(`
`)})}a.push({type:"list_item",raw:s.raw,tokens:u}),i=f}else i+=1}return a}function wUe(e,t){return e.map(r=>{if(r.type!=="list_item")return t.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(a=>{if(a.type==="paragraph"||a.type==="list"||a.type==="blockquote"||a.type==="code")n.push(...t.parseChildren([a]));else if(a.type==="text"&&a.tokens){const i=t.parseChildren([a]);n.push({type:"paragraph",content:i})}else{const i=t.parseChildren([a]);i.length>0&&n.push(...i)}}),{type:"listItem",content:n}})}var SUe="listItem",gJ="textStyle",vJ=/^(\d+)\.\s$/,Yde=$i.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...r}=e;return t===1?["ol",Jn(this.options.HTMLAttributes,r),0]:["ol",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];const r=e.start||1,n=e.items?wUe(e.items,t):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),r=t?.index;return r!==void 0?r:-1},tokenize:(e,t,r)=>{var n;const a=e.split(`
`),[i,s]=xUe(a);if(i.length===0)return;const l=Vde(i,0,r);return l.length===0?void 0:{type:"list",ordered:!0,start:((n=i[0])==null?void 0:n.number)||1,items:l,raw:a.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(SUe,this.editor.getAttributes(gJ)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Eg({find:vJ,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Eg({find:vJ,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(gJ)}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1],editor:this.editor})),[e]}}),kUe=/^\s*(\[([( |x])?\])\s$/,_Ue=$i.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",Jn(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const r=[];if(e.tokens&&e.tokens.length>0?r.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?r.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):r.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const n=t.parseChildren(e.nestedTokens);r.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},r)},renderMarkdown:(e,t)=>{var r;const a=`- [${(r=e.attrs)!=null&&r.checked?"x":" "}] `;return j9(e,t,a)},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:r,editor:n})=>{const a=document.createElement("li"),i=document.createElement("label"),s=document.createElement("span"),l=document.createElement("input"),c=document.createElement("div"),u=f=>{var m,p;l.ariaLabel=((p=(m=this.options.a11y)==null?void 0:m.checkboxLabel)==null?void 0:p.call(m,f,l.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};u(e),i.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",f=>f.preventDefault()),l.addEventListener("change",f=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:m}=f.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const v=r();if(typeof v!="number")return!1;const b=p.doc.nodeAt(v);return p.setNodeMarkup(v,void 0,{...b?.attrs,checked:m}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,m)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,m])=>{a.setAttribute(f,m)}),a.dataset.checked=e.attrs.checked,l.checked=e.attrs.checked,i.append(l,s),a.append(i,c),Object.entries(t).forEach(([f,m])=>{a.setAttribute(f,m)});let d=new Set(Object.keys(t));return{dom:a,contentDOM:c,update:f=>{if(f.type!==this.type)return!1;a.dataset.checked=f.attrs.checked,l.checked=f.attrs.checked,u(f);const m=n.extensionManager.attributes,p=Zy(f,m),v=new Set(Object.keys(p)),b=this.options.HTMLAttributes;return d.forEach(y=>{v.has(y)||(y in b?a.setAttribute(y,b[y]):a.removeAttribute(y))}),Object.entries(p).forEach(([y,S])=>{S==null?y in b?a.setAttribute(y,b[y]):a.removeAttribute(y):a.setAttribute(y,S)}),d=v,!0}}}},addInputRules(){return[Eg({find:kUe,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),NUe=$i.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",Jn(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const r=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return r!==void 0?r:-1},tokenize(e,t,r){const n=i=>{const s=TR(i,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,c)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:r.inlineTokens(l.mainContent),nestedTokens:c}),customNestedParser:n},r);return s?[{type:"taskList",raw:s.raw,items:s.items}]:r.blockTokens(i)},a=TR(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:i=>({indentLevel:i[1].length,mainContent:i[4],checked:i[3].toLowerCase()==="x"}),createToken:(i,s)=>({type:"taskItem",raw:"",mainContent:i.mainContent,indentLevel:i.indentLevel,checked:i.checked,text:i.mainContent,tokens:r.inlineTokens(i.mainContent),nestedTokens:s}),customNestedParser:n},r);if(a)return{type:"taskList",raw:a.raw,items:a.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});zr.create({name:"listKit",addExtensions(){const e=[];return this.options.bulletList!==!1&&e.push($de.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(Fde.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(Gde.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(Yde.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(_Ue.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(NUe.configure(this.options.taskList)),e}});var bJ="&nbsp;",CUe="",jUe=$i.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",Jn(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const r=e.tokens||[];if(r.length===1&&r[0].type==="image")return t.parseChildren([r[0]]);const n=t.parseInline(r);return n.length===1&&n[0].type==="text"&&(n[0].text===bJ||n[0].text===CUe)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,n)},renderMarkdown:(e,t)=>{if(!e)return"";const r=Array.isArray(e.content)?e.content:[];return r.length===0?bJ:t.renderChildren(r)},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),EUe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,MUe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,TUe=Xh.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[jg({find:EUe,type:this.type})]},addPasteRules(){return[Mh({find:MUe,type:this.type})]}}),AUe=$i.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),Qde=Xh.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",Jn(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,r){const a=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!a)return;const i=a[2].trim();return{type:"underline",raw:a[0],text:i,tokens:r.inlineTokens(i)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),DUe=Qde;function Jde(e={}){return new Ur({view(t){return new LUe(t,e)}})}class LUe{constructor(t,r){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(a=>{let i=s=>{this[a](s)};return t.dom.addEventListener(a,i),{name:a,handler:i}})}destroy(){this.handlers.forEach(({name:t,handler:r})=>this.editorView.dom.removeEventListener(t,r))}update(t,r){this.cursorPos!=null&&r.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),r=!t.parent.inlineContent,n,a=this.editorView.dom,i=a.getBoundingClientRect(),s=i.width/a.offsetWidth,l=i.height/a.offsetHeight;if(r){let f=t.nodeBefore,m=t.nodeAfter;if(f||m){let p=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(p){let v=p.getBoundingClientRect(),b=f?v.bottom:v.top;f&&m&&(b=(b+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let y=this.width/2*l;n={left:v.left,right:v.right,top:b-y,bottom:b+y}}}}if(!n){let f=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*s;n={left:f.left-m,right:f.left+m,top:f.top,bottom:f.bottom}}let c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,d;if(!c||c==document.body&&getComputedStyle(c).position=="static")u=-pageXOffset,d=-pageYOffset;else{let f=c.getBoundingClientRect(),m=f.width/c.offsetWidth,p=f.height/c.offsetHeight;u=f.left-c.scrollLeft*m,d=f.top-c.scrollTop*p}this.element.style.left=(n.left-u)/s+"px",this.element.style.top=(n.top-d)/l+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/l+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),a=n&&n.type.spec.disableDropCursor,i=typeof a=="function"?a(this.editorView,r,t):a;if(r&&!i){let s=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=Yce(this.editorView.state.doc,s,this.editorView.dragging.slice);l!=null&&(s=l)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class Gn extends lr{constructor(t){super(t,t)}map(t,r){let n=t.resolve(r.map(this.head));return Gn.valid(n)?new Gn(n):lr.near(n)}content(){return pt.empty}eq(t){return t instanceof Gn&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Gn(t.resolve(r.pos))}getBookmark(){return new B9(this.anchor)}static valid(t){let r=t.parent;if(r.isTextblock||!OUe(t)||!IUe(t))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let a=r.contentMatchAt(t.index()).defaultType;return a&&a.isTextblock}static findGapCursorFrom(t,r,n=!1){e:for(;;){if(!n&&Gn.valid(t))return t;let a=t.pos,i=null;for(let s=t.depth;;s--){let l=t.node(s);if(r>0?t.indexAfter(s)<l.childCount:t.index(s)>0){i=l.child(r>0?t.indexAfter(s):t.index(s)-1);break}else if(s==0)return null;a+=r;let c=t.doc.resolve(a);if(Gn.valid(c))return c}for(;;){let s=r>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!$t.isSelectable(i)){t=t.doc.resolve(a+i.nodeSize*r),n=!1;continue e}break}i=s,a+=r;let l=t.doc.resolve(a);if(Gn.valid(l))return l}return null}}}Gn.prototype.visible=!1;Gn.findFrom=Gn.findGapCursorFrom;lr.jsonID("gapcursor",Gn);class B9{constructor(t){this.pos=t}map(t){return new B9(t.map(this.pos))}resolve(t){let r=t.resolve(this.pos);return Gn.valid(r)?new Gn(r):lr.near(r)}}function Zde(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function OUe(e){for(let t=e.depth;t>=0;t--){let r=e.index(t),n=e.node(t);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let a=n.child(r-1);;a=a.lastChild){if(a.childCount==0&&!a.inlineContent||Zde(a.type))return!0;if(a.inlineContent)return!1}}return!0}function IUe(e){for(let t=e.depth;t>=0;t--){let r=e.indexAfter(t),n=e.node(t);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let a=n.child(r);;a=a.firstChild){if(a.childCount==0&&!a.inlineContent||Zde(a.type))return!0;if(a.inlineContent)return!1}}return!0}function Xde(){return new Ur({props:{decorations:BUe,createSelectionBetween(e,t,r){return t.pos==r.pos&&Gn.valid(r)?new Gn(r):null},handleClick:PUe,handleKeyDown:RUe,handleDOMEvents:{beforeinput:zUe}}})}const RUe=Que({ArrowLeft:bS("horiz",-1),ArrowRight:bS("horiz",1),ArrowUp:bS("vert",-1),ArrowDown:bS("vert",1)});function bS(e,t){const r=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,a,i){let s=n.selection,l=t>0?s.$to:s.$from,c=s.empty;if(s instanceof Yt){if(!i.endOfTextblock(r)||l.depth==0)return!1;c=!1,l=n.doc.resolve(t>0?l.after():l.before())}let u=Gn.findGapCursorFrom(l,t,c);return u?(a&&a(n.tr.setSelection(new Gn(u))),!0):!1}}function PUe(e,t,r){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!Gn.valid(n))return!1;let a=e.posAtCoords({left:r.clientX,top:r.clientY});return a&&a.inside>-1&&$t.isSelectable(e.state.doc.nodeAt(a.inside))?!1:(e.dispatch(e.state.tr.setSelection(new Gn(n))),!0)}function zUe(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof Gn))return!1;let{$from:r}=e.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let a=Ge.empty;for(let s=n.length-1;s>=0;s--)a=Ge.from(n[s].createAndFill(null,a));let i=e.state.tr.replace(r.pos,r.pos,new pt(a,0,0));return i.setSelection(Yt.near(i.doc.resolve(r.pos+1))),e.dispatch(i),!1}function BUe(e){if(!(e.selection instanceof Gn))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Jr.create(e.doc,[ga.widget(e.selection.head,t,{key:"gapcursor"})])}var KN=200,qa=function(){};qa.prototype.append=function(t){return t.length?(t=qa.from(t),!this.length&&t||t.length<KN&&this.leafAppend(t)||this.length<KN&&t.leafPrepend(this)||this.appendInner(t)):this};qa.prototype.prepend=function(t){return t.length?qa.from(t).append(this):this};qa.prototype.appendInner=function(t){return new $Ue(this,t)};qa.prototype.slice=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=this.length),t>=r?qa.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,r))};qa.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};qa.prototype.forEach=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(t,r,n,0):this.forEachInvertedInner(t,r,n,0)};qa.prototype.map=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var a=[];return this.forEach(function(i,s){return a.push(t(i,s))},r,n),a};qa.from=function(t){return t instanceof qa?t:t&&t.length?new efe(t):qa.empty};var efe=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(a,i){return a==0&&i==this.length?this:new t(this.values.slice(a,i))},t.prototype.getInner=function(a){return this.values[a]},t.prototype.forEachInner=function(a,i,s,l){for(var c=i;c<s;c++)if(a(this.values[c],l+c)===!1)return!1},t.prototype.forEachInvertedInner=function(a,i,s,l){for(var c=i-1;c>=s;c--)if(a(this.values[c],l+c)===!1)return!1},t.prototype.leafAppend=function(a){if(this.length+a.length<=KN)return new t(this.values.concat(a.flatten()))},t.prototype.leafPrepend=function(a){if(this.length+a.length<=KN)return new t(a.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(t.prototype,r),t})(qa);qa.empty=new efe([]);var $Ue=(function(e){function t(r,n){e.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,a,i,s){var l=this.left.length;if(a<l&&this.left.forEachInner(n,a,Math.min(i,l),s)===!1||i>l&&this.right.forEachInner(n,Math.max(a-l,0),Math.min(this.length,i)-l,s+l)===!1)return!1},t.prototype.forEachInvertedInner=function(n,a,i,s){var l=this.left.length;if(a>l&&this.right.forEachInvertedInner(n,a-l,Math.max(i,l)-l,s+l)===!1||i<l&&this.left.forEachInvertedInner(n,Math.min(a,l),i,s)===!1)return!1},t.prototype.sliceInner=function(n,a){if(n==0&&a==this.length)return this;var i=this.left.length;return a<=i?this.left.slice(n,a):n>=i?this.right.slice(n-i,a-i):this.left.slice(n,i).append(this.right.slice(0,a-i))},t.prototype.leafAppend=function(n){var a=this.right.leafAppend(n);if(a)return new t(this.left,a)},t.prototype.leafPrepend=function(n){var a=this.left.leafPrepend(n);if(a)return new t(a,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(qa);const FUe=500;class qo{constructor(t,r){this.items=t,this.eventCount=r}popEvent(t,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let a,i;r&&(a=this.remapping(n,this.items.length),i=a.maps.length);let s=t.tr,l,c,u=[],d=[];return this.items.forEach((f,m)=>{if(!f.step){a||(a=this.remapping(n,m+1),i=a.maps.length),i--,d.push(f);return}if(a){d.push(new vl(f.map));let p=f.step.map(a.slice(i)),v;p&&s.maybeStep(p).doc&&(v=s.mapping.maps[s.mapping.maps.length-1],u.push(new vl(v,void 0,void 0,u.length+d.length))),i--,v&&a.appendMap(v,i)}else s.maybeStep(f.step);if(f.selection)return l=a?f.selection.map(a.slice(i)):f.selection,c=new qo(this.items.slice(0,n).append(d.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:s,selection:l}}addTransform(t,r,n,a){let i=[],s=this.eventCount,l=this.items,c=!a&&l.length?l.get(l.length-1):null;for(let d=0;d<t.steps.length;d++){let f=t.steps[d].invert(t.docs[d]),m=new vl(t.mapping.maps[d],f,r),p;(p=c&&c.merge(m))&&(m=p,d?i.pop():l=l.slice(0,l.length-1)),i.push(m),r&&(s++,r=void 0),a||(c=m)}let u=s-n.depth;return u>HUe&&(l=UUe(l,u),s-=u),new qo(l.append(i),s)}remapping(t,r){let n=new Ky;return this.items.forEach((a,i)=>{let s=a.mirrorOffset!=null&&i-a.mirrorOffset>=t?n.maps.length-a.mirrorOffset:void 0;n.appendMap(a.map,s)},t,r),n}addMaps(t){return this.eventCount==0?this:new qo(this.items.append(t.map(r=>new vl(r))),this.eventCount)}rebased(t,r){if(!this.eventCount)return this;let n=[],a=Math.max(0,this.items.length-r),i=t.mapping,s=t.steps.length,l=this.eventCount;this.items.forEach(m=>{m.selection&&l--},a);let c=r;this.items.forEach(m=>{let p=i.getMirror(--c);if(p==null)return;s=Math.min(s,p);let v=i.maps[p];if(m.step){let b=t.steps[p].invert(t.docs[p]),y=m.selection&&m.selection.map(i.slice(c+1,p));y&&l++,n.push(new vl(v,b,y))}else n.push(new vl(v))},a);let u=[];for(let m=r;m<s;m++)u.push(new vl(i.maps[m]));let d=this.items.slice(0,a).append(u).append(n),f=new qo(d,l);return f.emptyItemCount()>FUe&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let t=0;return this.items.forEach(r=>{r.step||t++}),t}compress(t=this.items.length){let r=this.remapping(0,t),n=r.maps.length,a=[],i=0;return this.items.forEach((s,l)=>{if(l>=t)a.push(s),s.selection&&i++;else if(s.step){let c=s.step.map(r.slice(n)),u=c&&c.getMap();if(n--,u&&r.appendMap(u,n),c){let d=s.selection&&s.selection.map(r.slice(n));d&&i++;let f=new vl(u.invert(),c,d),m,p=a.length-1;(m=a.length&&a[p].merge(f))?a[p]=m:a.push(f)}}else s.map&&n--},this.items.length,0),new qo(qa.from(a.reverse()),i)}}qo.empty=new qo(qa.empty,0);function UUe(e,t){let r;return e.forEach((n,a)=>{if(n.selection&&t--==0)return r=a,!1}),e.slice(r)}class vl{constructor(t,r,n,a){this.map=t,this.step=r,this.selection=n,this.mirrorOffset=a}merge(t){if(this.step&&t.step&&!t.selection){let r=t.step.merge(this.step);if(r)return new vl(r.getMap().invert(),r,this.selection)}}}class od{constructor(t,r,n,a,i){this.done=t,this.undone=r,this.prevRanges=n,this.prevTime=a,this.prevComposition=i}}const HUe=20;function qUe(e,t,r,n){let a=r.getMeta(lh),i;if(a)return a.historyState;r.getMeta(GUe)&&(e=new od(e.done,e.undone,null,0,-1));let s=r.getMeta("appendedTransaction");if(r.steps.length==0)return e;if(s&&s.getMeta(lh))return s.getMeta(lh).redo?new od(e.done.addTransform(r,void 0,n,wk(t)),e.undone,yJ(r.mapping.maps),e.prevTime,e.prevComposition):new od(e.done,e.undone.addTransform(r,void 0,n,wk(t)),null,e.prevTime,e.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let l=r.getMeta("composition"),c=e.prevTime==0||!s&&e.prevComposition!=l&&(e.prevTime<(r.time||0)-n.newGroupDelay||!WUe(r,e.prevRanges)),u=s?GD(e.prevRanges,r.mapping):yJ(r.mapping.maps);return new od(e.done.addTransform(r,c?t.selection.getBookmark():void 0,n,wk(t)),qo.empty,u,r.time,l??e.prevComposition)}else return(i=r.getMeta("rebased"))?new od(e.done.rebased(r,i),e.undone.rebased(r,i),GD(e.prevRanges,r.mapping),e.prevTime,e.prevComposition):new od(e.done.addMaps(r.mapping.maps),e.undone.addMaps(r.mapping.maps),GD(e.prevRanges,r.mapping),e.prevTime,e.prevComposition)}function WUe(e,t){if(!t)return!1;if(!e.docChanged)return!0;let r=!1;return e.mapping.maps[0].forEach((n,a)=>{for(let i=0;i<t.length;i+=2)n<=t[i+1]&&a>=t[i]&&(r=!0)}),r}function yJ(e){let t=[];for(let r=e.length-1;r>=0&&t.length==0;r--)e[r].forEach((n,a,i,s)=>t.push(i,s));return t}function GD(e,t){if(!e)return null;let r=[];for(let n=0;n<e.length;n+=2){let a=t.map(e[n],1),i=t.map(e[n+1],-1);a<=i&&r.push(a,i)}return r}function KUe(e,t,r){let n=wk(t),a=lh.get(t).spec.config,i=(r?e.undone:e.done).popEvent(t,n);if(!i)return null;let s=i.selection.resolve(i.transform.doc),l=(r?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),a,n),c=new od(r?l:i.remaining,r?i.remaining:l,null,0,-1);return i.transform.setSelection(s).setMeta(lh,{redo:r,historyState:c})}let VD=!1,xJ=null;function wk(e){let t=e.plugins;if(xJ!=t){VD=!1,xJ=t;for(let r=0;r<t.length;r++)if(t[r].spec.historyPreserveItems){VD=!0;break}}return VD}const lh=new Gr("history"),GUe=new Gr("closeHistory");function tfe(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Ur({key:lh,state:{init(){return new od(qo.empty,qo.empty,null,0,-1)},apply(t,r,n){return qUe(r,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,r){let n=r.inputType,a=n=="historyUndo"?$9:n=="historyRedo"?F9:null;return!a||!t.editable?!1:(r.preventDefault(),a(t.state,t.dispatch))}}}})}function rfe(e,t){return(r,n)=>{let a=lh.getState(r);if(!a||(e?a.undone:a.done).eventCount==0)return!1;if(n){let i=KUe(a,r,e);i&&n(t?i.scrollIntoView():i)}return!0}}const $9=rfe(!1,!0),F9=rfe(!0,!0);zr.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){const n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{const t=e?.node||this.editor.state.doc,r=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let e=!1;return[new Ur({key:new Gr("characterCount"),appendTransaction:(t,r,n)=>{if(e)return;const a=this.options.limit;if(a==null||a===0){e=!0;return}const i=this.storage.characters({node:n.doc});if(i>a){const s=i-a,l=0,c=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${a} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(l,c);return e=!0,u}e=!0},filterTransaction:(t,r)=>{const n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;const a=this.storage.characters({node:r.doc}),i=this.storage.characters({node:t.doc});if(i<=n||a>n&&i>n&&i<=a)return!0;if(a>n&&i>n&&i>a||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,c=i-n,u=l-c,d=l;return t.deleteRange(u,d),!(this.storage.characters({node:t.doc})>n)}})]}});var VUe=zr.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Jde(this.options)]}});zr.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Ur({key:new Gr("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:a}=t,i=[];if(!r||!n)return Jr.create(e,[]);let s=0;this.options.mode==="deepest"&&e.descendants((c,u)=>{if(c.isText)return;if(!(a>=u&&a<=u+c.nodeSize-1))return!1;s+=1});let l=0;return e.descendants((c,u)=>{if(c.isText||!(a>=u&&a<=u+c.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&s-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";i.push(ga.node(u,u+c.nodeSize,{class:this.options.className}))}),Jr.create(e,i)}}})]}});var YUe=zr.create({name:"gapCursor",addProseMirrorPlugins(){return[Xde()]},extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Wr(Lt(e,"allowGapCursor",r)))!=null?t:null}}});zr.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ur({key:new Gr("placeholder"),props:{decorations:({doc:e,selection:t})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,a=[];if(!r)return null;const i=this.editor.isEmpty;return e.descendants((s,l)=>{const c=n>=l&&n<=l+s.nodeSize,u=!s.isLeaf&&r1(s);if((c||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];i&&d.push(this.options.emptyEditorClass);const f=ga.node(l,l+s.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:l,hasAnchor:c}):this.options.placeholder});a.push(f)}return this.options.includeChildren}),Jr.create(e,a)}}})]}});zr.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Ur({key:new Gr("selection"),props:{decorations(r){return r.selection.empty||e.isFocused||!e.isEditable||k9(r.selection)||e.view.dragging?null:Jr.create(r.doc,[ga.inline(r.selection.from,r.selection.to,{class:t.className})])}}})]}});function wJ({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}var QUe=zr.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Gr(this.name),r=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,a])=>a).filter(a=>(this.options.notAfter||[]).concat(r).includes(a.name));return[new Ur({key:t,appendTransaction:(a,i,s)=>{const{doc:l,tr:c,schema:u}=s,d=t.getState(s),f=l.content.size,m=u.nodes[r];if(d)return c.insert(f,m.create())},state:{init:(a,i)=>{const s=i.tr.doc.lastChild;return!wJ({node:s,types:n})},apply:(a,i)=>{if(!a.docChanged||a.getMeta("__uniqueIDTransaction"))return i;const s=a.doc.lastChild;return!wJ({node:s,types:n})}}})]}}),JUe=zr.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>$9(e,t),redo:()=>({state:e,dispatch:t})=>F9(e,t)}},addProseMirrorPlugins(){return[tfe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),ZUe=zr.create({name:"starterKit",addExtensions(){var e,t,r,n;const a=[];return this.options.bold!==!1&&a.push(jFe.configure(this.options.bold)),this.options.blockquote!==!1&&a.push(SFe.configure(this.options.blockquote)),this.options.bulletList!==!1&&a.push($de.configure(this.options.bulletList)),this.options.code!==!1&&a.push(TFe.configure(this.options.code)),this.options.codeBlock!==!1&&a.push(LFe.configure(this.options.codeBlock)),this.options.document!==!1&&a.push(OFe.configure(this.options.document)),this.options.dropcursor!==!1&&a.push(VUe.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&a.push(YUe.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&a.push(IFe.configure(this.options.hardBreak)),this.options.heading!==!1&&a.push(RFe.configure(this.options.heading)),this.options.undoRedo!==!1&&a.push(JUe.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&a.push(PFe.configure(this.options.horizontalRule)),this.options.italic!==!1&&a.push(UFe.configure(this.options.italic)),this.options.listItem!==!1&&a.push(Fde.configure(this.options.listItem)),this.options.listKeymap!==!1&&a.push(Gde.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&a.push(Bde.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&a.push(Yde.configure(this.options.orderedList)),this.options.paragraph!==!1&&a.push(jUe.configure(this.options.paragraph)),this.options.strike!==!1&&a.push(TUe.configure(this.options.strike)),this.options.text!==!1&&a.push(AUe.configure(this.options.text)),this.options.underline!==!1&&a.push(Qde.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&a.push(QUe.configure((n=this.options)==null?void 0:n.trailingNode)),a}}),XUe=ZUe;zr.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){const n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{const t=e?.node||this.editor.state.doc,r=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let e=!1;return[new Ur({key:new Gr("characterCount"),appendTransaction:(t,r,n)=>{if(e)return;const a=this.options.limit;if(a==null||a===0){e=!0;return}const i=this.storage.characters({node:n.doc});if(i>a){const s=i-a,l=0,c=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${a} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(l,c);return e=!0,u}e=!0},filterTransaction:(t,r)=>{const n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;const a=this.storage.characters({node:r.doc}),i=this.storage.characters({node:t.doc});if(i<=n||a>n&&i>n&&i<=a)return!0;if(a>n&&i>n&&i>a||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,c=i-n,u=l-c,d=l;return t.deleteRange(u,d),!(this.storage.characters({node:t.doc})>n)}})]}});zr.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Jde(this.options)]}});zr.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Ur({key:new Gr("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:a}=t,i=[];if(!r||!n)return Jr.create(e,[]);let s=0;this.options.mode==="deepest"&&e.descendants((c,u)=>{if(c.isText)return;if(!(a>=u&&a<=u+c.nodeSize-1))return!1;s+=1});let l=0;return e.descendants((c,u)=>{if(c.isText||!(a>=u&&a<=u+c.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&s-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";i.push(ga.node(u,u+c.nodeSize,{class:this.options.className}))}),Jr.create(e,i)}}})]}});zr.create({name:"gapCursor",addProseMirrorPlugins(){return[Xde()]},extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Wr(Lt(e,"allowGapCursor",r)))!=null?t:null}}});var SJ="placeholder";function eHe(e){return e.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var tHe=zr.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:SJ,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const e=this.options.dataAttribute?`data-${eHe(this.options.dataAttribute)}`:`data-${SJ}`;return[new Ur({key:new Gr("placeholder"),props:{decorations:({doc:t,selection:r})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:a}=r,i=[];if(!n)return null;const s=this.editor.isEmpty;return t.descendants((l,c)=>{const u=a>=c&&a<=c+l.nodeSize,d=!l.isLeaf&&r1(l);if((u||!this.options.showOnlyCurrent)&&d){const f=[this.options.emptyNodeClass];s&&f.push(this.options.emptyEditorClass);const m=ga.node(c,c+l.nodeSize,{class:f.join(" "),[e]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:c,hasAnchor:u}):this.options.placeholder});i.push(m)}return this.options.includeChildren}),Jr.create(t,i)}}})]}});zr.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Ur({key:new Gr("selection"),props:{decorations(r){return r.selection.empty||e.isFocused||!e.isEditable||k9(r.selection)||e.view.dragging?null:Jr.create(r.doc,[ga.inline(r.selection.from,r.selection.to,{class:t.className})])}}})]}});function kJ({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}zr.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Gr(this.name),r=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,a])=>a).filter(a=>(this.options.notAfter||[]).concat(r).includes(a.name));return[new Ur({key:t,appendTransaction:(a,i,s)=>{const{doc:l,tr:c,schema:u}=s,d=t.getState(s),f=l.content.size,m=u.nodes[r];if(d)return c.insert(f,m.create())},state:{init:(a,i)=>{const s=i.tr.doc.lastChild;return!kJ({node:s,types:n})},apply:(a,i)=>{if(!a.docChanged||a.getMeta("__uniqueIDTransaction"))return i;const s=a.doc.lastChild;return!kJ({node:s,types:n})}}})]}});zr.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>$9(e,t),redo:()=>({state:e,dispatch:t})=>F9(e,t)}},addProseMirrorPlugins(){return[tfe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}});var rHe=tHe,YD=4,nHe=/^```([a-z]+)?[\s\n]$/,aHe=/^~~~([a-z]+)?[\s\n]$/,iHe=$i.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:YD,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options;if(!r)return null;const i=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(s=>s.startsWith(r)).map(s=>s.replace(r,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",Jn(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var r;return((r=e.raw)==null?void 0:r.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var r;let n="";const a=((r=e.attrs)==null?void 0:r.language)||"";return e.content?n=[`\`\`\`${a}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${a}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=t.pos===1;return!e||t.parent.type.name!==this.name?!1:r||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:YD,{state:n}=e,{selection:a}=n,{$from:i,empty:s}=a;if(i.parent.type!==this.type)return!1;const l=" ".repeat(r);return s?e.commands.insertContent(l):e.commands.command(({tr:c})=>{const{from:u,to:d}=a,p=n.doc.textBetween(u,d,`
`,`
`).split(`
`).map(v=>l+v).join(`
`);return c.replaceWith(u,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:YD,{state:n}=e,{selection:a}=n,{$from:i,empty:s}=a;return i.parent.type!==this.type?!1:s?e.commands.command(({tr:l})=>{var c;const{pos:u}=i,d=i.start(),f=i.end(),p=n.doc.textBetween(d,f,`
`,`
`).split(`
`);let v=0,b=0;const y=u-d;for(let E=0;E<p.length;E+=1){if(b+p[E].length>=y){v=E;break}b+=p[E].length+1}const _=((c=p[v].match(/^ */))==null?void 0:c[0])||"",N=Math.min(_.length,r);if(N===0)return!0;let k=d;for(let E=0;E<v;E+=1)k+=p[E].length+1;return l.delete(k,k+N),u-k<=N&&l.setSelection(Yt.create(l.doc,k)),!0}):e.commands.command(({tr:l})=>{const{from:c,to:u}=a,m=n.doc.textBetween(c,u,`
`,`
`).split(`
`).map(p=>{var v;const b=((v=p.match(/^ */))==null?void 0:v[0])||"",y=Math.min(b.length,r);return p.slice(y)}).join(`
`);return l.replaceWith(c,u,n.schema.text(m)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:a}=r;if(!a||n.parent.type!==this.type)return!1;const i=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!i||!s?!1:e.chain().command(({tr:l})=>(l.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:a,empty:i}=r;if(!i||a.parent.type!==this.type||!(a.parentOffset===a.parent.nodeSize-2))return!1;const l=a.after();return l===void 0?!1:n.nodeAt(l)?e.commands.command(({tr:u})=>(u.setSelection(lr.near(n.resolve(l))),!0)):e.commands.exitCode()}}},addInputRules(){return[Xy({find:nHe,type:this.type,getAttributes:e=>({language:e[1]})}),Xy({find:aHe,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Ur({key:new Gr("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),a=n?JSON.parse(n):void 0,i=a?.mode;if(!r||!i)return!1;const{tr:s,schema:l}=e.state,c=l.text(r.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:i},c)),s.selection.$from.parent.type!==this.type&&s.setSelection(Yt.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),sHe=iHe,QD,_J;function oHe(){if(_J)return QD;_J=1;function e(he){return he instanceof Map?he.clear=he.delete=he.set=function(){throw new Error("map is read-only")}:he instanceof Set&&(he.add=he.clear=he.delete=function(){throw new Error("set is read-only")}),Object.freeze(he),Object.getOwnPropertyNames(he).forEach(De=>{const Ue=he[De],ut=typeof Ue;(ut==="object"||ut==="function")&&!Object.isFrozen(Ue)&&e(Ue)}),he}class t{constructor(De){De.data===void 0&&(De.data={}),this.data=De.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function r(he){return he.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function n(he,...De){const Ue=Object.create(null);for(const ut in he)Ue[ut]=he[ut];return De.forEach(function(ut){for(const St in ut)Ue[St]=ut[St]}),Ue}const a="</span>",i=he=>!!he.scope,s=(he,{prefix:De})=>{if(he.startsWith("language:"))return he.replace("language:","language-");if(he.includes(".")){const Ue=he.split(".");return[`${De}${Ue.shift()}`,...Ue.map((ut,St)=>`${ut}${"_".repeat(St+1)}`)].join(" ")}return`${De}${he}`};class l{constructor(De,Ue){this.buffer="",this.classPrefix=Ue.classPrefix,De.walk(this)}addText(De){this.buffer+=r(De)}openNode(De){if(!i(De))return;const Ue=s(De.scope,{prefix:this.classPrefix});this.span(Ue)}closeNode(De){i(De)&&(this.buffer+=a)}value(){return this.buffer}span(De){this.buffer+=`<span class="${De}">`}}const c=(he={})=>{const De={children:[]};return Object.assign(De,he),De};class u{constructor(){this.rootNode=c(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(De){this.top.children.push(De)}openNode(De){const Ue=c({scope:De});this.add(Ue),this.stack.push(Ue)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(De){return this.constructor._walk(De,this.rootNode)}static _walk(De,Ue){return typeof Ue=="string"?De.addText(Ue):Ue.children&&(De.openNode(Ue),Ue.children.forEach(ut=>this._walk(De,ut)),De.closeNode(Ue)),De}static _collapse(De){typeof De!="string"&&De.children&&(De.children.every(Ue=>typeof Ue=="string")?De.children=[De.children.join("")]:De.children.forEach(Ue=>{u._collapse(Ue)}))}}class d extends u{constructor(De){super(),this.options=De}addText(De){De!==""&&this.add(De)}startScope(De){this.openNode(De)}endScope(){this.closeNode()}__addSublanguage(De,Ue){const ut=De.root;Ue&&(ut.scope=`language:${Ue}`),this.add(ut)}toHTML(){return new l(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function f(he){return he?typeof he=="string"?he:he.source:null}function m(he){return b("(?=",he,")")}function p(he){return b("(?:",he,")*")}function v(he){return b("(?:",he,")?")}function b(...he){return he.map(Ue=>f(Ue)).join("")}function y(he){const De=he[he.length-1];return typeof De=="object"&&De.constructor===Object?(he.splice(he.length-1,1),De):{}}function S(...he){return"("+(y(he).capture?"":"?:")+he.map(ut=>f(ut)).join("|")+")"}function _(he){return new RegExp(he.toString()+"|").exec("").length-1}function N(he,De){const Ue=he&&he.exec(De);return Ue&&Ue.index===0}const k=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function j(he,{joinWith:De}){let Ue=0;return he.map(ut=>{Ue+=1;const St=Ue;let jt=f(ut),Je="";for(;jt.length>0;){const Xe=k.exec(jt);if(!Xe){Je+=jt;break}Je+=jt.substring(0,Xe.index),jt=jt.substring(Xe.index+Xe[0].length),Xe[0][0]==="\\"&&Xe[1]?Je+="\\"+String(Number(Xe[1])+St):(Je+=Xe[0],Xe[0]==="("&&Ue++)}return Je}).map(ut=>`(${ut})`).join(De)}const E=/\b\B/,T="[a-zA-Z]\\w*",O="[a-zA-Z_]\\w*",R="\\b\\d+(\\.\\d+)?",q="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",$="\\b(0b[01]+)",L="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",A=(he={})=>{const De=/^#![ ]*\//;return he.binary&&(he.begin=b(De,/.*\b/,he.binary,/\b.*/)),n({scope:"meta",begin:De,end:/$/,relevance:0,"on:begin":(Ue,ut)=>{Ue.index!==0&&ut.ignoreMatch()}},he)},M={begin:"\\\\[\\s\\S]",relevance:0},z={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[M]},I={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[M]},B={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},F=function(he,De,Ue={}){const ut=n({scope:"comment",begin:he,end:De,contains:[]},Ue);ut.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const St=S("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return ut.contains.push({begin:b(/[ ]+/,"(",St,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),ut},U=F("//","$"),V=F("/\\*","\\*/"),K=F("#","$"),G={scope:"number",begin:R,relevance:0},J={scope:"number",begin:q,relevance:0},ee={scope:"number",begin:$,relevance:0},Y={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[M,{begin:/\[/,end:/\]/,relevance:0,contains:[M]}]},ie={scope:"title",begin:T,relevance:0},fe={scope:"title",begin:O,relevance:0},me={begin:"\\.\\s*"+O,relevance:0};var oe=Object.freeze({__proto__:null,APOS_STRING_MODE:z,BACKSLASH_ESCAPE:M,BINARY_NUMBER_MODE:ee,BINARY_NUMBER_RE:$,COMMENT:F,C_BLOCK_COMMENT_MODE:V,C_LINE_COMMENT_MODE:U,C_NUMBER_MODE:J,C_NUMBER_RE:q,END_SAME_AS_BEGIN:function(he){return Object.assign(he,{"on:begin":(De,Ue)=>{Ue.data._beginMatch=De[1]},"on:end":(De,Ue)=>{Ue.data._beginMatch!==De[1]&&Ue.ignoreMatch()}})},HASH_COMMENT_MODE:K,IDENT_RE:T,MATCH_NOTHING_RE:E,METHOD_GUARD:me,NUMBER_MODE:G,NUMBER_RE:R,PHRASAL_WORDS_MODE:B,QUOTE_STRING_MODE:I,REGEXP_MODE:Y,RE_STARTERS_RE:L,SHEBANG:A,TITLE_MODE:ie,UNDERSCORE_IDENT_RE:O,UNDERSCORE_TITLE_MODE:fe});function ce(he,De){he.input[he.index-1]==="."&&De.ignoreMatch()}function Z(he,De){he.className!==void 0&&(he.scope=he.className,delete he.className)}function ue(he,De){De&&he.beginKeywords&&(he.begin="\\b("+he.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",he.__beforeBegin=ce,he.keywords=he.keywords||he.beginKeywords,delete he.beginKeywords,he.relevance===void 0&&(he.relevance=0))}function H(he,De){Array.isArray(he.illegal)&&(he.illegal=S(...he.illegal))}function ge(he,De){if(he.match){if(he.begin||he.end)throw new Error("begin & end are not supported with match");he.begin=he.match,delete he.match}}function de(he,De){he.relevance===void 0&&(he.relevance=1)}const re=(he,De)=>{if(!he.beforeMatch)return;if(he.starts)throw new Error("beforeMatch cannot be used with starts");const Ue=Object.assign({},he);Object.keys(he).forEach(ut=>{delete he[ut]}),he.keywords=Ue.keywords,he.begin=b(Ue.beforeMatch,m(Ue.begin)),he.starts={relevance:0,contains:[Object.assign(Ue,{endsParent:!0})]},he.relevance=0,delete Ue.beforeMatch},ne=["of","and","for","in","not","or","if","then","parent","list","value"],pe="keyword";function ke(he,De,Ue=pe){const ut=Object.create(null);return typeof he=="string"?St(Ue,he.split(" ")):Array.isArray(he)?St(Ue,he):Object.keys(he).forEach(function(jt){Object.assign(ut,ke(he[jt],De,jt))}),ut;function St(jt,Je){De&&(Je=Je.map(Xe=>Xe.toLowerCase())),Je.forEach(function(Xe){const it=Xe.split("|");ut[it[0]]=[jt,we(it[0],it[1])]})}}function we(he,De){return De?Number(De):ve(he)?0:1}function ve(he){return ne.includes(he.toLowerCase())}const Le={},Ae=he=>{console.error(he)},Re=(he,...De)=>{console.log(`WARN: ${he}`,...De)},Ye=(he,De)=>{Le[`${he}/${De}`]||(console.log(`Deprecated as of ${he}. ${De}`),Le[`${he}/${De}`]=!0)},mt=new Error;function ot(he,De,{key:Ue}){let ut=0;const St=he[Ue],jt={},Je={};for(let Xe=1;Xe<=De.length;Xe++)Je[Xe+ut]=St[Xe],jt[Xe+ut]=!0,ut+=_(De[Xe-1]);he[Ue]=Je,he[Ue]._emit=jt,he[Ue]._multi=!0}function Ot(he){if(Array.isArray(he.begin)){if(he.skip||he.excludeBegin||he.returnBegin)throw Ae("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),mt;if(typeof he.beginScope!="object"||he.beginScope===null)throw Ae("beginScope must be object"),mt;ot(he,he.begin,{key:"beginScope"}),he.begin=j(he.begin,{joinWith:""})}}function rt(he){if(Array.isArray(he.end)){if(he.skip||he.excludeEnd||he.returnEnd)throw Ae("skip, excludeEnd, returnEnd not compatible with endScope: {}"),mt;if(typeof he.endScope!="object"||he.endScope===null)throw Ae("endScope must be object"),mt;ot(he,he.end,{key:"endScope"}),he.end=j(he.end,{joinWith:""})}}function ze(he){he.scope&&typeof he.scope=="object"&&he.scope!==null&&(he.beginScope=he.scope,delete he.scope)}function bt(he){ze(he),typeof he.beginScope=="string"&&(he.beginScope={_wrap:he.beginScope}),typeof he.endScope=="string"&&(he.endScope={_wrap:he.endScope}),Ot(he),rt(he)}function tt(he){function De(Je,Xe){return new RegExp(f(Je),"m"+(he.case_insensitive?"i":"")+(he.unicodeRegex?"u":"")+(Xe?"g":""))}class Ue{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(Xe,it){it.position=this.position++,this.matchIndexes[this.matchAt]=it,this.regexes.push([it,Xe]),this.matchAt+=_(Xe)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const Xe=this.regexes.map(it=>it[1]);this.matcherRe=De(j(Xe,{joinWith:"|"}),!0),this.lastIndex=0}exec(Xe){this.matcherRe.lastIndex=this.lastIndex;const it=this.matcherRe.exec(Xe);if(!it)return null;const Xt=it.findIndex((Oe,Ke)=>Ke>0&&Oe!==void 0),X=this.matchIndexes[Xt];return it.splice(0,Xt),Object.assign(it,X)}}class ut{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(Xe){if(this.multiRegexes[Xe])return this.multiRegexes[Xe];const it=new Ue;return this.rules.slice(Xe).forEach(([Xt,X])=>it.addRule(Xt,X)),it.compile(),this.multiRegexes[Xe]=it,it}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(Xe,it){this.rules.push([Xe,it]),it.type==="begin"&&this.count++}exec(Xe){const it=this.getMatcher(this.regexIndex);it.lastIndex=this.lastIndex;let Xt=it.exec(Xe);if(this.resumingScanAtSamePosition()&&!(Xt&&Xt.index===this.lastIndex)){const X=this.getMatcher(0);X.lastIndex=this.lastIndex+1,Xt=X.exec(Xe)}return Xt&&(this.regexIndex+=Xt.position+1,this.regexIndex===this.count&&this.considerAll()),Xt}}function St(Je){const Xe=new ut;return Je.contains.forEach(it=>Xe.addRule(it.begin,{rule:it,type:"begin"})),Je.terminatorEnd&&Xe.addRule(Je.terminatorEnd,{type:"end"}),Je.illegal&&Xe.addRule(Je.illegal,{type:"illegal"}),Xe}function jt(Je,Xe){const it=Je;if(Je.isCompiled)return it;[Z,ge,bt,re].forEach(X=>X(Je,Xe)),he.compilerExtensions.forEach(X=>X(Je,Xe)),Je.__beforeBegin=null,[ue,H,de].forEach(X=>X(Je,Xe)),Je.isCompiled=!0;let Xt=null;return typeof Je.keywords=="object"&&Je.keywords.$pattern&&(Je.keywords=Object.assign({},Je.keywords),Xt=Je.keywords.$pattern,delete Je.keywords.$pattern),Xt=Xt||/\w+/,Je.keywords&&(Je.keywords=ke(Je.keywords,he.case_insensitive)),it.keywordPatternRe=De(Xt,!0),Xe&&(Je.begin||(Je.begin=/\B|\b/),it.beginRe=De(it.begin),!Je.end&&!Je.endsWithParent&&(Je.end=/\B|\b/),Je.end&&(it.endRe=De(it.end)),it.terminatorEnd=f(it.end)||"",Je.endsWithParent&&Xe.terminatorEnd&&(it.terminatorEnd+=(Je.end?"|":"")+Xe.terminatorEnd)),Je.illegal&&(it.illegalRe=De(Je.illegal)),Je.contains||(Je.contains=[]),Je.contains=[].concat(...Je.contains.map(function(X){return We(X==="self"?Je:X)})),Je.contains.forEach(function(X){jt(X,it)}),Je.starts&&jt(Je.starts,Xe),it.matcher=St(it),it}if(he.compilerExtensions||(he.compilerExtensions=[]),he.contains&&he.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return he.classNameAliases=n(he.classNameAliases||{}),jt(he)}function _e(he){return he?he.endsWithParent||_e(he.starts):!1}function We(he){return he.variants&&!he.cachedVariants&&(he.cachedVariants=he.variants.map(function(De){return n(he,{variants:null},De)})),he.cachedVariants?he.cachedVariants:_e(he)?n(he,{starts:he.starts?n(he.starts):null}):Object.isFrozen(he)?n(he):he}var Ve="11.11.1";class Mt extends Error{constructor(De,Ue){super(De),this.name="HTMLInjectionError",this.html=Ue}}const kt=r,er=n,mr=Symbol("nomatch"),Zt=7,Wt=function(he){const De=Object.create(null),Ue=Object.create(null),ut=[];let St=!0;const jt="Could not find the language '{}', did you forget to load/include a language module?",Je={disableAutodetect:!0,name:"Plain text",contains:[]};let Xe={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:d};function it(Qe){return Xe.noHighlightRe.test(Qe)}function Xt(Qe){let Et=Qe.className+" ";Et+=Qe.parentNode?Qe.parentNode.className:"";const sr=Xe.languageDetectRe.exec(Et);if(sr){const Br=ct(sr[1]);return Br||(Re(jt.replace("{}",sr[1])),Re("Falling back to no-highlight mode for this block.",Qe)),Br?sr[1]:"no-highlight"}return Et.split(/\s+/).find(Br=>it(Br)||ct(Br))}function X(Qe,Et,sr){let Br="",On="";typeof Et=="object"?(Br=Qe,sr=Et.ignoreIllegals,On=Et.language):(Ye("10.7.0","highlight(lang, code, ...args) has been deprecated."),Ye("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),On=Qe,Br=Et),sr===void 0&&(sr=!0);const Aa={code:Br,language:On};Kl("before:highlight",Aa);const ki=Aa.result?Aa.result:Oe(Aa.language,Aa.code,sr);return ki.code=Aa.code,Kl("after:highlight",ki),ki}function Oe(Qe,Et,sr,Br){const On=Object.create(null);function Aa(at,_t){return at.keywords[_t]}function ki(){if(!Kt.keywords){ia.addText(Vr);return}let at=0;Kt.keywordPatternRe.lastIndex=0;let _t=Kt.keywordPatternRe.exec(Vr),nr="";for(;_t;){nr+=Vr.substring(at,_t.index);const yr=aa.case_insensitive?_t[0].toLowerCase():_t[0],In=Aa(Kt,yr);if(In){const[qs,E0]=In;if(ia.addText(nr),nr="",On[yr]=(On[yr]||0)+1,On[yr]<=Zt&&(Su+=E0),qs.startsWith("_"))nr+=_t[0];else{const P1=aa.classNameAliases[qs]||qs;_i(_t[0],P1)}}else nr+=_t[0];at=Kt.keywordPatternRe.lastIndex,_t=Kt.keywordPatternRe.exec(Vr)}nr+=Vr.substring(at),ia.addText(nr)}function di(){if(Vr==="")return;let at=null;if(typeof Kt.subLanguage=="string"){if(!De[Kt.subLanguage]){ia.addText(Vr);return}at=Oe(Kt.subLanguage,Vr,!0,R1[Kt.subLanguage]),R1[Kt.subLanguage]=at._top}else at=be(Vr,Kt.subLanguage.length?Kt.subLanguage:null);Kt.relevance>0&&(Su+=at.relevance),ia.__addSublanguage(at._emitter,at.language)}function nn(){Kt.subLanguage!=null?di():ki(),Vr=""}function _i(at,_t){at!==""&&(ia.startScope(_t),ia.addText(at),ia.endScope())}function vm(at,_t){let nr=1;const yr=_t.length-1;for(;nr<=yr;){if(!at._emit[nr]){nr++;continue}const In=aa.classNameAliases[at[nr]]||at[nr],qs=_t[nr];In?_i(qs,In):(Vr=qs,ki(),Vr=""),nr++}}function Gl(at,_t){return at.scope&&typeof at.scope=="string"&&ia.openNode(aa.classNameAliases[at.scope]||at.scope),at.beginScope&&(at.beginScope._wrap?(_i(Vr,aa.classNameAliases[at.beginScope._wrap]||at.beginScope._wrap),Vr=""):at.beginScope._multi&&(vm(at.beginScope,_t),Vr="")),Kt=Object.create(at,{parent:{value:Kt}}),Kt}function Yd(at,_t,nr){let yr=N(at.endRe,nr);if(yr){if(at["on:end"]){const In=new t(at);at["on:end"](_t,In),In.isMatchIgnored&&(yr=!1)}if(yr){for(;at.endsParent&&at.parent;)at=at.parent;return at}}if(at.endsWithParent)return Yd(at.parent,_t,nr)}function Vl(at){return Kt.matcher.regexIndex===0?(Vr+=at[0],1):(ku=!0,0)}function C0(at){const _t=at[0],nr=at.rule,yr=new t(nr),In=[nr.__beforeBegin,nr["on:begin"]];for(const qs of In)if(qs&&(qs(at,yr),yr.isMatchIgnored))return Vl(_t);return nr.skip?Vr+=_t:(nr.excludeBegin&&(Vr+=_t),nn(),!nr.returnBegin&&!nr.excludeBegin&&(Vr=_t)),Gl(nr,at),nr.returnBegin?0:_t.length}function fi(at){const _t=at[0],nr=Et.substring(at.index),yr=Yd(Kt,at,nr);if(!yr)return mr;const In=Kt;Kt.endScope&&Kt.endScope._wrap?(nn(),_i(_t,Kt.endScope._wrap)):Kt.endScope&&Kt.endScope._multi?(nn(),vm(Kt.endScope,at)):In.skip?Vr+=_t:(In.returnEnd||In.excludeEnd||(Vr+=_t),nn(),In.excludeEnd&&(Vr=_t));do Kt.scope&&ia.closeNode(),!Kt.skip&&!Kt.subLanguage&&(Su+=Kt.relevance),Kt=Kt.parent;while(Kt!==yr.parent);return yr.starts&&Gl(yr.starts,at),In.returnEnd?0:_t.length}function Yl(){const at=[];for(let _t=Kt;_t!==aa;_t=_t.parent)_t.scope&&at.unshift(_t.scope);at.forEach(_t=>ia.openNode(_t))}let Ql={};function wu(at,_t){const nr=_t&&_t[0];if(Vr+=at,nr==null)return nn(),0;if(Ql.type==="begin"&&_t.type==="end"&&Ql.index===_t.index&&nr===""){if(Vr+=Et.slice(_t.index,_t.index+1),!St){const yr=new Error(`0 width match regex (${Qe})`);throw yr.languageName=Qe,yr.badRule=Ql.rule,yr}return 1}if(Ql=_t,_t.type==="begin")return C0(_t);if(_t.type==="illegal"&&!sr){const yr=new Error('Illegal lexeme "'+nr+'" for mode "'+(Kt.scope||"<unnamed>")+'"');throw yr.mode=Kt,yr}else if(_t.type==="end"){const yr=fi(_t);if(yr!==mr)return yr}if(_t.type==="illegal"&&nr==="")return Vr+=`
`,1;if(j0>1e5&&j0>_t.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Vr+=nr,nr.length}const aa=ct(Qe);if(!aa)throw Ae(jt.replace("{}",Qe)),new Error('Unknown language: "'+Qe+'"');const I1=tt(aa);let bm="",Kt=Br||I1;const R1={},ia=new Xe.__emitter(Xe);Yl();let Vr="",Su=0,Jl=0,j0=0,ku=!1;try{if(aa.__emitTokens)aa.__emitTokens(Et,ia);else{for(Kt.matcher.considerAll();;){j0++,ku?ku=!1:Kt.matcher.considerAll(),Kt.matcher.lastIndex=Jl;const at=Kt.matcher.exec(Et);if(!at)break;const _t=Et.substring(Jl,at.index),nr=wu(_t,at);Jl=at.index+nr}wu(Et.substring(Jl))}return ia.finalize(),bm=ia.toHTML(),{language:Qe,value:bm,relevance:Su,illegal:!1,_emitter:ia,_top:Kt}}catch(at){if(at.message&&at.message.includes("Illegal"))return{language:Qe,value:kt(Et),illegal:!0,relevance:0,_illegalBy:{message:at.message,index:Jl,context:Et.slice(Jl-100,Jl+100),mode:at.mode,resultSoFar:bm},_emitter:ia};if(St)return{language:Qe,value:kt(Et),illegal:!1,relevance:0,errorRaised:at,_emitter:ia,_top:Kt};throw at}}function Ke(Qe){const Et={value:kt(Qe),illegal:!1,relevance:0,_top:Je,_emitter:new Xe.__emitter(Xe)};return Et._emitter.addText(Qe),Et}function be(Qe,Et){Et=Et||Xe.languages||Object.keys(De);const sr=Ke(Qe),Br=Et.filter(ct).filter(rr).map(nn=>Oe(nn,Qe,!1));Br.unshift(sr);const On=Br.sort((nn,_i)=>{if(nn.relevance!==_i.relevance)return _i.relevance-nn.relevance;if(nn.language&&_i.language){if(ct(nn.language).supersetOf===_i.language)return 1;if(ct(_i.language).supersetOf===nn.language)return-1}return 0}),[Aa,ki]=On,di=Aa;return di.secondBest=ki,di}function W(Qe,Et,sr){const Br=Et&&Ue[Et]||sr;Qe.classList.add("hljs"),Qe.classList.add(`language-${Br}`)}function se(Qe){let Et=null;const sr=Xt(Qe);if(it(sr))return;if(Kl("before:highlightElement",{el:Qe,language:sr}),Qe.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",Qe);return}if(Qe.children.length>0&&(Xe.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(Qe)),Xe.throwUnescapedHTML))throw new Mt("One of your code blocks includes unescaped HTML.",Qe.innerHTML);Et=Qe;const Br=Et.textContent,On=sr?X(Br,{language:sr,ignoreIllegals:!0}):be(Br);Qe.innerHTML=On.value,Qe.dataset.highlighted="yes",W(Qe,sr,On.language),Qe.result={language:On.language,re:On.relevance,relevance:On.relevance},On.secondBest&&(Qe.secondBest={language:On.secondBest.language,relevance:On.secondBest.relevance}),Kl("after:highlightElement",{el:Qe,result:On,text:Br})}function xe(Qe){Xe=er(Xe,Qe)}const Ce=()=>{Tt(),Ye("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function dt(){Tt(),Ye("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let st=!1;function Tt(){function Qe(){Tt()}if(document.readyState==="loading"){st||window.addEventListener("DOMContentLoaded",Qe,!1),st=!0;return}document.querySelectorAll(Xe.cssSelector).forEach(se)}function Ft(Qe,Et){let sr=null;try{sr=Et(he)}catch(Br){if(Ae("Language definition for '{}' could not be registered.".replace("{}",Qe)),St)Ae(Br);else throw Br;sr=Je}sr.name||(sr.name=Qe),De[Qe]=sr,sr.rawDefinition=Et.bind(null,he),sr.aliases&&Ht(sr.aliases,{languageName:Qe})}function lt(Qe){delete De[Qe];for(const Et of Object.keys(Ue))Ue[Et]===Qe&&delete Ue[Et]}function Pt(){return Object.keys(De)}function ct(Qe){return Qe=(Qe||"").toLowerCase(),De[Qe]||De[Ue[Qe]]}function Ht(Qe,{languageName:Et}){typeof Qe=="string"&&(Qe=[Qe]),Qe.forEach(sr=>{Ue[sr.toLowerCase()]=Et})}function rr(Qe){const Et=ct(Qe);return Et&&!Et.disableAutodetect}function Dr(Qe){Qe["before:highlightBlock"]&&!Qe["before:highlightElement"]&&(Qe["before:highlightElement"]=Et=>{Qe["before:highlightBlock"](Object.assign({block:Et.el},Et))}),Qe["after:highlightBlock"]&&!Qe["after:highlightElement"]&&(Qe["after:highlightElement"]=Et=>{Qe["after:highlightBlock"](Object.assign({block:Et.el},Et))})}function vn(Qe){Dr(Qe),ut.push(Qe)}function gm(Qe){const Et=ut.indexOf(Qe);Et!==-1&&ut.splice(Et,1)}function Kl(Qe,Et){const sr=Qe;ut.forEach(function(Br){Br[sr]&&Br[sr](Et)})}function Mo(Qe){return Ye("10.7.0","highlightBlock will be removed entirely in v12.0"),Ye("10.7.0","Please use highlightElement now."),se(Qe)}Object.assign(he,{highlight:X,highlightAuto:be,highlightAll:Tt,highlightElement:se,highlightBlock:Mo,configure:xe,initHighlighting:Ce,initHighlightingOnLoad:dt,registerLanguage:Ft,unregisterLanguage:lt,listLanguages:Pt,getLanguage:ct,registerAliases:Ht,autoDetection:rr,inherit:er,addPlugin:vn,removePlugin:gm}),he.debugMode=function(){St=!1},he.safeMode=function(){St=!0},he.versionString=Ve,he.regex={concat:b,lookahead:m,either:S,optional:v,anyNumberOfTimes:p};for(const Qe in oe)typeof oe[Qe]=="object"&&e(oe[Qe]);return Object.assign(he,oe),he},Rt=Wt({});return Rt.newInstance=()=>Wt({}),QD=Rt,Rt.HighlightJS=Rt,Rt.default=Rt,QD}var lHe=oHe();const nfe=Fr(lHe);function afe(e,t=[]){return e.flatMap(r=>{const n=[...t,...r.properties?r.properties.className:[]];return r.children?afe(r.children,n):{text:r.value,classes:n}})}function NJ(e){return e.value||e.children||[]}function cHe(e){return!!nfe.getLanguage(e)}function CJ({doc:e,name:t,lowlight:r,defaultLanguage:n}){const a=[];return ER(e,i=>i.type.name===t).forEach(i=>{var s;let l=i.pos+1;const c=i.node.attrs.language||n,u=r.listLanguages(),d=c&&(u.includes(c)||cHe(c)||(s=r.registered)!=null&&s.call(r,c))?NJ(r.highlight(c,i.node.textContent)):NJ(r.highlightAuto(i.node.textContent));afe(d).forEach(f=>{const m=l+f.text.length;if(f.classes.length){const p=ga.inline(l,m,{class:f.classes.join(" ")});a.push(p)}l=m})}),Jr.create(e,a)}function uHe(e){return typeof e=="function"}function dHe({name:e,lowlight:t,defaultLanguage:r}){if(!["highlight","highlightAuto","listLanguages"].every(a=>uHe(t[a])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const n=new Ur({key:new Gr("lowlight"),state:{init:(a,{doc:i})=>CJ({doc:i,name:e,lowlight:t,defaultLanguage:r}),apply:(a,i,s,l)=>{const c=s.selection.$head.parent.type.name,u=l.selection.$head.parent.type.name,d=ER(s.doc,m=>m.type.name===e),f=ER(l.doc,m=>m.type.name===e);return a.docChanged&&([c,u].includes(e)||f.length!==d.length||a.steps.some(m=>m.from!==void 0&&m.to!==void 0&&d.some(p=>p.pos>=m.from&&p.pos+p.node.nodeSize<=m.to)))?CJ({doc:a.doc,name:e,lowlight:t,defaultLanguage:r}):i.map(a.mapping,a.doc)}},props:{decorations(a){return n.getState(a)}}});return n}var fHe=sHe.extend({addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),lowlight:{},languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}},addProseMirrorPlugins(){var e;return[...((e=this.parent)==null?void 0:e.call(this))||[],dHe({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}}),hHe=fHe;function mHe(e){const t=e.regex,r=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",s="(?!struct)("+n+"|"+t.optional(a)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",l={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},d={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},f={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},r,e.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:t.optional(a)+e.IDENT_RE,relevance:0},p=t.optional(a)+e.IDENT_RE+"\\s*\\(",v=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],b=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],y=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],S=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],k={type:b,keyword:v,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:y},j={className:"function.dispatch",relevance:0,keywords:{_hint:S},begin:t.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,e.IDENT_RE,t.lookahead(/(<[^<>]+>|)\s*\(/))},E=[j,f,l,r,e.C_BLOCK_COMMENT_MODE,d,u],T={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:k,contains:E.concat([{begin:/\(/,end:/\)/,keywords:k,contains:E.concat(["self"]),relevance:0}]),relevance:0},O={className:"function",begin:"("+s+"[\\*&\\s]+)+"+p,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:k,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:k,relevance:0},{begin:p,returnBegin:!0,contains:[m],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[u,d]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:[r,e.C_BLOCK_COMMENT_MODE,u,d,l,{begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:["self",r,e.C_BLOCK_COMMENT_MODE,u,d,l]}]},l,r,e.C_BLOCK_COMMENT_MODE,f]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:k,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(T,O,j,E,[f,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:k,contains:["self",l]},{begin:e.IDENT_RE+"::",keywords:k},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function pHe(e){const t={type:["boolean","byte","word","String"],built_in:["KeyboardController","MouseController","SoftwareSerial","EthernetServer","EthernetClient","LiquidCrystal","RobotControl","GSMVoiceCall","EthernetUDP","EsploraTFT","HttpClient","RobotMotor","WiFiClient","GSMScanner","FileSystem","Scheduler","GSMServer","YunClient","YunServer","IPAddress","GSMClient","GSMModem","Keyboard","Ethernet","Console","GSMBand","Esplora","Stepper","Process","WiFiUDP","GSM_SMS","Mailbox","USBHost","Firmata","PImage","Client","Server","GSMPIN","FileIO","Bridge","Serial","EEPROM","Stream","Mouse","Audio","Servo","File","Task","GPRS","WiFi","Wire","TFT","GSM","SPI","SD"],_hints:["setup","loop","runShellCommandAsynchronously","analogWriteResolution","retrieveCallingNumber","printFirmwareVersion","analogReadResolution","sendDigitalPortPair","noListenOnLocalhost","readJoystickButton","setFirmwareVersion","readJoystickSwitch","scrollDisplayRight","getVoiceCallStatus","scrollDisplayLeft","writeMicroseconds","delayMicroseconds","beginTransmission","getSignalStrength","runAsynchronously","getAsynchronously","listenOnLocalhost","getCurrentCarrier","readAccelerometer","messageAvailable","sendDigitalPorts","lineFollowConfig","countryNameWrite","runShellCommand","readStringUntil","rewindDirectory","readTemperature","setClockDivider","readLightSensor","endTransmission","analogReference","detachInterrupt","countryNameRead","attachInterrupt","encryptionType","readBytesUntil","robotNameWrite","readMicrophone","robotNameRead","cityNameWrite","userNameWrite","readJoystickY","readJoystickX","mouseReleased","openNextFile","scanNetworks","noInterrupts","digitalWrite","beginSpeaker","mousePressed","isActionDone","mouseDragged","displayLogos","noAutoscroll","addParameter","remoteNumber","getModifiers","keyboardRead","userNameRead","waitContinue","processInput","parseCommand","printVersion","readNetworks","writeMessage","blinkVersion","cityNameRead","readMessage","setDataMode","parsePacket","isListening","setBitOrder","beginPacket","isDirectory","motorsWrite","drawCompass","digitalRead","clearScreen","serialEvent","rightToLeft","setTextSize","leftToRight","requestFrom","keyReleased","compassRead","analogWrite","interrupts","WiFiServer","disconnect","playMelody","parseFloat","autoscroll","getPINUsed","setPINUsed","setTimeout","sendAnalog","readSlider","analogRead","beginWrite","createChar","motorsStop","keyPressed","tempoWrite","readButton","subnetMask","debugPrint","macAddress","writeGreen","randomSeed","attachGPRS","readString","sendString","remotePort","releaseAll","mouseMoved","background","getXChange","getYChange","answerCall","getResult","voiceCall","endPacket","constrain","getSocket","writeJSON","getButton","available","connected","findUntil","readBytes","exitValue","readGreen","writeBlue","startLoop","IPAddress","isPressed","sendSysex","pauseMode","gatewayIP","setCursor","getOemKey","tuneWrite","noDisplay","loadImage","switchPIN","onRequest","onReceive","changePIN","playFile","noBuffer","parseInt","overflow","checkPIN","knobRead","beginTFT","bitClear","updateIR","bitWrite","position","writeRGB","highByte","writeRed","setSpeed","readBlue","noStroke","remoteIP","transfer","shutdown","hangCall","beginSMS","endWrite","attached","maintain","noCursor","checkReg","checkPUK","shiftOut","isValid","shiftIn","pulseIn","connect","println","localIP","pinMode","getIMEI","display","noBlink","process","getBand","running","beginSD","drawBMP","lowByte","setBand","release","bitRead","prepare","pointTo","readRed","setMode","noFill","remove","listen","stroke","detach","attach","noTone","exists","buffer","height","bitSet","circle","config","cursor","random","IRread","setDNS","endSMS","getKey","micros","millis","begin","print","write","ready","flush","width","isPIN","blink","clear","press","mkdir","rmdir","close","point","yield","image","BSSID","click","delay","read","text","move","peek","beep","rect","line","open","seek","fill","size","turn","stop","home","find","step","tone","sqrt","RSSI","SSID","end","bit","tan","cos","sin","pow","map","abs","max","min","get","run","put"],literal:["DIGITAL_MESSAGE","FIRMATA_STRING","ANALOG_MESSAGE","REPORT_DIGITAL","REPORT_ANALOG","INPUT_PULLUP","SET_PIN_MODE","INTERNAL2V56","SYSTEM_RESET","LED_BUILTIN","INTERNAL1V1","SYSEX_START","INTERNAL","EXTERNAL","DEFAULT","OUTPUT","INPUT","HIGH","LOW"]},r=mHe(e),n=r.keywords;return n.type=[...n.type,...t.type],n.literal=[...n.literal,...t.literal],n.built_in=[...n.built_in,...t.built_in],n._hints=t._hints,r.name="Arduino",r.aliases=["ino"],r.supersetOf="cpp",r}function gHe(e){const t=e.regex,r={},n={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[r]}]};Object.assign(r,{className:"variable",variants:[{begin:t.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},n]});const a={className:"subst",begin:/\$\(/,end:/\)/,contains:[e.BACKSLASH_ESCAPE]},i=e.inherit(e.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),s={begin:/<<-?\s*(?=\w+)/,starts:{contains:[e.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},l={className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,r,a]};a.contains.push(l);const c={match:/\\"/},u={className:"string",begin:/'/,end:/'/},d={match:/\\'/},f={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},e.NUMBER_MODE,r]},m=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],p=e.SHEBANG({binary:`(${m.join("|")})`,relevance:10}),v={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:!0,contains:[e.inherit(e.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},b=["if","then","else","elif","fi","time","for","while","until","in","do","done","case","esac","coproc","function","select"],y=["true","false"],S={match:/(\/[a-z._-]+)+/},_=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],N=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias"],k=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],j=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:b,literal:y,built_in:[..._,...N,"set","shopt",...k,...j]},contains:[p,e.SHEBANG(),v,f,i,s,S,l,c,u,d,r]}}function vHe(e){const t=e.regex,r=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",s="("+n+"|"+t.optional(a)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",l={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},d={className:"number",variants:[{match:/\b(0b[01']+)/},{match:/(-?)\b([\d']+(\.[\d']*)?|\.[\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)/},{match:/(-?)\b(0[xX][a-fA-F0-9]+(?:'[a-fA-F0-9]+)*(?:\.[a-fA-F0-9]*(?:'[a-fA-F0-9]*)*)?(?:[pP][-+]?[0-9]+)?(l|L)?(u|U)?)/},{match:/(-?)\b\d+(?:'\d+)*(?:\.\d*(?:'\d*)*)?(?:[eE][-+]?\d+)?/}],relevance:0},f={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},r,e.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:t.optional(a)+e.IDENT_RE,relevance:0},p=t.optional(a)+e.IDENT_RE+"\\s*\\(",y={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},S=[f,l,r,e.C_BLOCK_COMMENT_MODE,d,u],_={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:y,contains:S.concat([{begin:/\(/,end:/\)/,keywords:y,contains:S.concat(["self"]),relevance:0}]),relevance:0},N={begin:"("+s+"[\\*&\\s]+)+"+p,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:y,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:y,relevance:0},{begin:p,returnBegin:!0,contains:[e.inherit(m,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:y,relevance:0,contains:[r,e.C_BLOCK_COMMENT_MODE,u,d,l,{begin:/\(/,end:/\)/,keywords:y,relevance:0,contains:["self",r,e.C_BLOCK_COMMENT_MODE,u,d,l]}]},l,r,e.C_BLOCK_COMMENT_MODE,f]};return{name:"C",aliases:["h"],keywords:y,disableAutodetect:!0,illegal:"</",contains:[].concat(_,N,S,[f,{begin:e.IDENT_RE+"::",keywords:y},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},e.TITLE_MODE]}]),exports:{preprocessor:f,strings:u,keywords:y}}}function bHe(e){const t=e.regex,r=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",s="(?!struct)("+n+"|"+t.optional(a)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",l={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},d={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},f={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},r,e.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:t.optional(a)+e.IDENT_RE,relevance:0},p=t.optional(a)+e.IDENT_RE+"\\s*\\(",v=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],b=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],y=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],S=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],k={type:b,keyword:v,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:y},j={className:"function.dispatch",relevance:0,keywords:{_hint:S},begin:t.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,e.IDENT_RE,t.lookahead(/(<[^<>]+>|)\s*\(/))},E=[j,f,l,r,e.C_BLOCK_COMMENT_MODE,d,u],T={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:k,contains:E.concat([{begin:/\(/,end:/\)/,keywords:k,contains:E.concat(["self"]),relevance:0}]),relevance:0},O={className:"function",begin:"("+s+"[\\*&\\s]+)+"+p,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:k,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:k,relevance:0},{begin:p,returnBegin:!0,contains:[m],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[u,d]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:[r,e.C_BLOCK_COMMENT_MODE,u,d,l,{begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:["self",r,e.C_BLOCK_COMMENT_MODE,u,d,l]}]},l,r,e.C_BLOCK_COMMENT_MODE,f]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:k,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(T,O,j,E,[f,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:k,contains:["self",l]},{begin:e.IDENT_RE+"::",keywords:k},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function yHe(e){const t=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],r=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],n=["default","false","null","true"],a=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],i=["add","alias","and","ascending","args","async","await","by","descending","dynamic","equals","file","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","record","remove","required","scoped","select","set","unmanaged","value|0","var","when","where","with","yield"],s={keyword:a.concat(i),built_in:t,literal:n},l=e.inherit(e.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),c={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},u={className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},d={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},f=e.inherit(d,{illegal:/\n/}),m={className:"subst",begin:/\{/,end:/\}/,keywords:s},p=e.inherit(m,{illegal:/\n/}),v={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},e.BACKSLASH_ESCAPE,p]},b={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},m]},y=e.inherit(b,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},p]});m.contains=[b,v,d,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,c,e.C_BLOCK_COMMENT_MODE],p.contains=[y,v,f,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,c,e.inherit(e.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const S={variants:[u,b,v,d,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},_={begin:"<",end:">",contains:[{beginKeywords:"in out"},l]},N=e.IDENT_RE+"(<"+e.IDENT_RE+"(\\s*,\\s*"+e.IDENT_RE+")*>)?(\\[\\])?",k={begin:"@"+e.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:s,illegal:/::/,contains:[e.COMMENT("///","$",{returnBegin:!0,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},S,c,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},l,_,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[l,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[l,_,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:!0,end:"\\]",excludeEnd:!0,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+N+"\\s+)+"+e.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,end:/\s*[{;=]/,excludeEnd:!0,keywords:s,contains:[{beginKeywords:r.join(" "),relevance:0},{begin:e.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,contains:[e.TITLE_MODE,_],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:s,relevance:0,contains:[S,c,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},k]}}const xHe=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),wHe=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],SHe=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],kHe=[...wHe,...SHe],_He=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),NHe=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),CHe=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),jHe=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function EHe(e){const t=e.regex,r=xHe(e),n={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},a="and or not only",i=/@-?\w[\w]*(-\w+)*/,s="[a-zA-Z-][a-zA-Z0-9_-]*",l=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:!0,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[r.BLOCK_COMMENT,n,r.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+s,relevance:0},r.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+NHe.join("|")+")"},{begin:":(:)?("+CHe.join("|")+")"}]},r.CSS_VARIABLE,{className:"attribute",begin:"\\b("+jHe.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[r.BLOCK_COMMENT,r.HEXCOLOR,r.IMPORTANT,r.CSS_NUMBER_MODE,...l,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...l,{className:"string",begin:/[^)]/,endsWithParent:!0,excludeEnd:!0}]},r.FUNCTION_DISPATCH]},{begin:t.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:i},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:a,attribute:_He.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...l,r.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+kHe.join("|")+")\\b"}]}}function MHe(e){const t=e.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:t.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:t.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}function THe(e){const i={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:i,illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[e.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:i,illegal:/["']/}]}]}}function AHe(e){const t=e.regex,r=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:!0,disableAutodetect:!1,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[e.HASH_COMMENT_MODE,e.QUOTE_STRING_MODE,e.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:!0,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:!0},{scope:"symbol",begin:t.concat(r,t.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}function DHe(e){const t=e.regex,r={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:e.NUMBER_RE}]},n=e.COMMENT();n.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const a={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},i={className:"literal",begin:/\bon|off|true|false|yes|no\b/},s={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},l={begin:/\[/,end:/\]/,contains:[n,i,a,s,r,"self"],relevance:0},c=/[A-Za-z0-9_-]+/,u=/"(\\"|[^"])*"/,d=/'[^']*'/,f=t.either(c,u,d),m=t.concat(f,"(\\s*\\.\\s*",f,")*",t.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:!0,illegal:/\S/,contains:[n,{className:"section",begin:/\[+/,end:/\]+/},{begin:m,className:"attr",starts:{end:/$/,contains:[n,l,i,a,s,r]}}]}}var yp="[0-9](_*[0-9])*",yS=`\\.(${yp})`,xS="[0-9a-fA-F](_*[0-9a-fA-F])*",jJ={className:"number",variants:[{begin:`(\\b(${yp})((${yS})|\\.)?|(${yS}))[eE][+-]?(${yp})[fFdD]?\\b`},{begin:`\\b(${yp})((${yS})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${yS})[fFdD]?\\b`},{begin:`\\b(${yp})[fFdD]\\b`},{begin:`\\b0[xX]((${xS})\\.?|(${xS})?\\.(${xS}))[pP][+-]?(${yp})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${xS})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function ife(e,t,r){return r===-1?"":e.replace(t,n=>ife(e,t,r-1))}function LHe(e){const t=e.regex,r="[-a-zA-Z_$][-a-zA-Z_$0-9]*",n=r+ife("(?:<"+r+"~~~(?:\\s*,\\s*"+r+"~~~)*>)?",/~~~/g,2),c={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto","when"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},u={className:"meta",begin:"@"+r,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},d={className:"params",begin:/\(/,end:/\)/,keywords:c,relevance:0,contains:[e.C_BLOCK_COMMENT_MODE],endsParent:!0};return{name:"Java",aliases:["jsp"],keywords:c,illegal:/<\/|#/,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[e.BACKSLASH_ESCAPE]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,r],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[t.concat(/(?!else)/,r),/\s+/,r,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,r],className:{1:"keyword",3:"title.class"},contains:[d,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+n+"\\s+)",e.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:c,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:c,relevance:0,contains:[u,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,jJ,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},jJ,u]}}const EJ="[A-Za-z$_][0-9A-Za-z$_]*",OHe=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],IHe=["true","false","null","undefined","NaN","Infinity"],sfe=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],ofe=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],lfe=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],RHe=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],PHe=[].concat(lfe,sfe,ofe);function zHe(e){const t=e.regex,r=(F,{after:U})=>{const V="</"+F[0].slice(1);return F.input.indexOf(V,U)!==-1},n=EJ,a={begin:"<>",end:"</>"},i=/<[A-Za-z0-9\\._:-]+\s*\/>/,s={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(F,U)=>{const V=F[0].length+F.index,K=F.input[V];if(K==="<"||K===","){U.ignoreMatch();return}K===">"&&(r(F,{after:V})||U.ignoreMatch());let G;const J=F.input.substring(V);if(G=J.match(/^\s*=/)){U.ignoreMatch();return}if((G=J.match(/^\s+extends\s+/))&&G.index===0){U.ignoreMatch();return}}},l={$pattern:EJ,keyword:OHe,literal:IHe,built_in:PHe,"variable.language":RHe},c="[0-9](_?[0-9])*",u=`\\.(${c})`,d="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",f={className:"number",variants:[{begin:`(\\b(${d})((${u})|\\.)?|(${u}))[eE][+-]?(${c})\\b`},{begin:`\\b(${d})\\b((${u})\\b|\\.)?|(${u})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:l,contains:[]},p={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},v={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"css"}},b={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"graphql"}},y={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,m]},_={className:"comment",variants:[e.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:n+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]},N=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,{match:/\$\d+/},f];m.contains=N.concat({begin:/\{/,end:/\}/,keywords:l,contains:["self"].concat(N)});const k=[].concat(_,m.contains),j=k.concat([{begin:/(\s*)\(/,end:/\)/,keywords:l,contains:["self"].concat(k)}]),E={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j},T={variants:[{match:[/class/,/\s+/,n,/\s+/,/extends/,/\s+/,t.concat(n,"(",t.concat(/\./,n),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,n],scope:{1:"keyword",3:"title.class"}}]},O={relevance:0,match:t.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...sfe,...ofe]}},R={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},q={variants:[{match:[/function/,/\s+/,n,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[E],illegal:/%/},$={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function L(F){return t.concat("(?!",F.join("|"),")")}const A={match:t.concat(/\b/,L([...lfe,"super","import"].map(F=>`${F}\\s*\\(`)),n,t.lookahead(/\s*\(/)),className:"title.function",relevance:0},M={begin:t.concat(/\./,t.lookahead(t.concat(n,/(?![0-9A-Za-z$_(])/))),end:n,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},z={match:[/get|set/,/\s+/,n,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},E]},I="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+e.UNDERSCORE_IDENT_RE+")\\s*=>",B={match:[/const|var|let/,/\s+/,n,/\s*/,/=\s*/,/(async\s*)?/,t.lookahead(I)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[E]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:l,exports:{PARAMS_CONTAINS:j,CLASS_REFERENCE:O},illegal:/#(?![$_A-z])/,contains:[e.SHEBANG({label:"shebang",binary:"node",relevance:5}),R,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,_,{match:/\$\d+/},f,O,{scope:"attr",match:n+t.lookahead(":"),relevance:0},B,{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[_,e.REGEXP_MODE,{className:"function",begin:I,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:a.begin,end:a.end},{match:i},{begin:s.begin,"on:begin":s.isTrulyOpeningTag,end:s.end}],subLanguage:"xml",contains:[{begin:s.begin,end:s.end,skip:!0,contains:["self"]}]}]},q,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+e.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[E,e.inherit(e.TITLE_MODE,{begin:n,className:"title.function"})]},{match:/\.\.\./,relevance:0},M,{match:"\\$"+n,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[E]},A,$,T,z,{match:/\$[(.]/}]}}function BHe(e){const t={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},r={match:/[{}[\],:]/,className:"punctuation",relevance:0},n=["true","false","null"],a={scope:"literal",beginKeywords:n.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:n},contains:[t,r,e.QUOTE_STRING_MODE,a,e.C_NUMBER_MODE,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}var xp="[0-9](_*[0-9])*",wS=`\\.(${xp})`,SS="[0-9a-fA-F](_*[0-9a-fA-F])*",$He={className:"number",variants:[{begin:`(\\b(${xp})((${wS})|\\.)?|(${wS}))[eE][+-]?(${xp})[fFdD]?\\b`},{begin:`\\b(${xp})((${wS})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${wS})[fFdD]?\\b`},{begin:`\\b(${xp})[fFdD]\\b`},{begin:`\\b0[xX]((${SS})\\.?|(${SS})?\\.(${SS}))[pP][+-]?(${xp})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${SS})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function FHe(e){const t={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},r={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},n={className:"symbol",begin:e.UNDERSCORE_IDENT_RE+"@"},a={className:"subst",begin:/\$\{/,end:/\}/,contains:[e.C_NUMBER_MODE]},i={className:"variable",begin:"\\$"+e.UNDERSCORE_IDENT_RE},s={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[i,a]},{begin:"'",end:"'",illegal:/\n/,contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,i,a]}]};a.contains.push(s);const l={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+e.UNDERSCORE_IDENT_RE+")?"},c={className:"meta",begin:"@"+e.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[e.inherit(s,{className:"string"}),"self"]}]},u=$He,d=e.COMMENT("/\\*","\\*/",{contains:[e.C_BLOCK_COMMENT_MODE]}),f={variants:[{className:"type",begin:e.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},m=f;return m.variants[1].contains=[f],f.variants[1].contains=[m],{name:"Kotlin",aliases:["kt","kts"],keywords:t,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),e.C_LINE_COMMENT_MODE,d,r,n,l,c,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:!0,excludeEnd:!0,keywords:t,relevance:5,contains:[{begin:e.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,relevance:0,contains:[e.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:t,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:!0,contains:[f,e.C_LINE_COMMENT_MODE,d],relevance:0},e.C_LINE_COMMENT_MODE,d,l,c,s,e.C_NUMBER_MODE]},d]},{begin:[/class|interface|trait/,/\s+/,e.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:!0,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},e.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:!0,returnEnd:!0},l,c]},s,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},u]}}const UHe=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),HHe=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],qHe=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],WHe=[...HHe,...qHe],KHe=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),cfe=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),ufe=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),GHe=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse(),VHe=cfe.concat(ufe).sort().reverse();function YHe(e){const t=UHe(e),r=VHe,n="and or not only",a="[\\w-]+",i="("+a+"|@\\{"+a+"\\})",s=[],l=[],c=function(N){return{className:"string",begin:"~?"+N+".*?"+N}},u=function(N,k,j){return{className:N,begin:k,relevance:j}},d={$pattern:/[a-z-]+/,keyword:n,attribute:KHe.join(" ")},f={begin:"\\(",end:"\\)",contains:l,keywords:d,relevance:0};l.push(e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,c("'"),c('"'),t.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:!0}},t.HEXCOLOR,f,u("variable","@@?"+a,10),u("variable","@\\{"+a+"\\}"),u("built_in","~?`[^`]*?`"),{className:"attribute",begin:a+"\\s*:",end:":",returnBegin:!0,excludeEnd:!0},t.IMPORTANT,{beginKeywords:"and not"},t.FUNCTION_DISPATCH);const m=l.concat({begin:/\{/,end:/\}/,contains:s}),p={beginKeywords:"when",endsWithParent:!0,contains:[{beginKeywords:"and not"}].concat(l)},v={begin:i+"\\s*:",returnBegin:!0,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},t.CSS_VARIABLE,{className:"attribute",begin:"\\b("+GHe.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:!0,illegal:"[<=$]",relevance:0,contains:l}}]},b={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:d,returnEnd:!0,contains:l,relevance:0}},y={className:"variable",variants:[{begin:"@"+a+"\\s*:",relevance:15},{begin:"@"+a}],starts:{end:"[;}]",returnEnd:!0,contains:m}},S={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:i,end:/\{/}],returnBegin:!0,returnEnd:!0,illegal:`[<='$"]`,relevance:0,contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,p,u("keyword","all\\b"),u("variable","@\\{"+a+"\\}"),{begin:"\\b("+WHe.join("|")+")\\b",className:"selector-tag"},t.CSS_NUMBER_MODE,u("selector-tag",i,0),u("selector-id","#"+i),u("selector-class","\\."+i,0),u("selector-tag","&",0),t.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+cfe.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+ufe.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:m},{begin:"!important"},t.FUNCTION_DISPATCH]},_={begin:a+`:(:)?(${r.join("|")})`,returnBegin:!0,contains:[S]};return s.push(e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,b,y,_,v,S,p,t.FUNCTION_DISPATCH),{name:"Less",case_insensitive:!0,illegal:`[=>'/<($"]`,contains:s}}function QHe(e){const t="\\[=*\\[",r="\\]=*\\]",n={begin:t,end:r,contains:["self"]},a=[e.COMMENT("--(?!"+t+")","$"),e.COMMENT("--"+t,r,{contains:[n],relevance:10})];return{name:"Lua",aliases:["pluto"],keywords:{$pattern:e.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:a.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[e.inherit(e.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:!0,contains:a}].concat(a)},e.C_NUMBER_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{className:"string",begin:t,end:r,contains:[n],relevance:5}])}}function JHe(e){const t={className:"variable",variants:[{begin:"\\$\\("+e.UNDERSCORE_IDENT_RE+"\\)",contains:[e.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},r={className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,t]},n={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[t,r]},a={begin:"^"+e.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},i={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},s={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[t]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[e.HASH_COMMENT_MODE,t,r,n,a,i,s]}}function ZHe(e){const t=e.regex,r={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},n={begin:"^[-\\*]{3,}",end:"$"},a={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},i={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},s={begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]},l=/[A-Za-z][A-Za-z0-9+.-]*/,c={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:t.concat(/\[.+?\]\(/,l,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:!0,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}]},u={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},d={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},f=e.inherit(u,{contains:[]}),m=e.inherit(d,{contains:[]});u.contains.push(m),d.contains.push(f);let p=[r,c];return[u,d,f,m].forEach(S=>{S.contains=S.contains.concat(p)}),p=p.concat(u,d),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:p},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:p}]}]},r,i,u,d,{className:"quote",begin:"^>\\s+",contains:p,end:"$"},a,n,c,s,{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}function XHe(e){const t={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},r=/[a-zA-Z@][a-zA-Z0-9_]*/,l={"variable.language":["this","super"],$pattern:r,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},c={$pattern:r,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:l,illegal:"</",contains:[t,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.C_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(e.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:!0,keywords:c,contains:[e.UNDERSCORE_TITLE_MODE]},{begin:"\\."+e.UNDERSCORE_IDENT_RE,relevance:0}]}}function eqe(e){const t=e.regex,r=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","class","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","field","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","method","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],n=/[dualxmsipngr]{0,12}/,a={$pattern:/[\w.]+/,keyword:r.join(" ")},i={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:a},s={begin:/->\{/,end:/\}/},l={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},c={scope:"variable",variants:[{begin:/\$\d/},{begin:t.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[l]},u={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},d=[e.BACKSLASH_ESCAPE,i,c],f=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],m=(b,y,S="\\1")=>{const _=S==="\\1"?S:t.concat(S,y);return t.concat(t.concat("(?:",b,")"),y,/(?:\\.|[^\\\/])*?/,_,/(?:\\.|[^\\\/])*?/,S,n)},p=(b,y,S)=>t.concat(t.concat("(?:",b,")"),y,/(?:\\.|[^\\\/])*?/,S,n),v=[c,e.HASH_COMMENT_MODE,e.COMMENT(/^=\w/,/=cut/,{endsWithParent:!0}),s,{className:"string",contains:d,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},u,{begin:"(\\/\\/|"+e.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[e.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:m("s|tr|y",t.either(...f,{capture:!0}))},{begin:m("s|tr|y","\\(","\\)")},{begin:m("s|tr|y","\\[","\\]")},{begin:m("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:p("(?:m|qr)?",/\//,/\//)},{begin:p("m|qr",t.either(...f,{capture:!0}),/\1/)},{begin:p("m|qr",/\(/,/\)/)},{begin:p("m|qr",/\[/,/\]/)},{begin:p("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE,l]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE,l,u]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return i.contains=v,s.contains=v,{name:"Perl",aliases:["pl","pm"],keywords:a,contains:v}}function tqe(e){const t=e.regex,r=/(?![A-Za-z0-9])(?![$])/,n=t.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,r),a=t.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,r),i=t.concat(/[A-Z]+/,r),s={scope:"variable",match:"\\$+"+n},l={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},c={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},u=e.inherit(e.APOS_STRING_MODE,{illegal:null}),d=e.inherit(e.QUOTE_STRING_MODE,{illegal:null,contains:e.QUOTE_STRING_MODE.contains.concat(c)}),f={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:e.QUOTE_STRING_MODE.contains.concat(c),"on:begin":(M,z)=>{z.data._beginMatch=M[1]||M[2]},"on:end":(M,z)=>{z.data._beginMatch!==M[1]&&z.ignoreMatch()}},m=e.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),p=`[ 	
]`,v={scope:"string",variants:[d,u,f,m]},b={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},y=["false","null","true"],S=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],_=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],k={keyword:S,literal:(M=>{const z=[];return M.forEach(I=>{z.push(I),I.toLowerCase()===I?z.push(I.toUpperCase()):z.push(I.toLowerCase())}),z})(y),built_in:_},j=M=>M.map(z=>z.replace(/\|\d+$/,"")),E={variants:[{match:[/new/,t.concat(p,"+"),t.concat("(?!",j(_).join("\\b|"),"\\b)"),a],scope:{1:"keyword",4:"title.class"}}]},T=t.concat(n,"\\b(?!\\()"),O={variants:[{match:[t.concat(/::/,t.lookahead(/(?!class\b)/)),T],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[a,t.concat(/::/,t.lookahead(/(?!class\b)/)),T],scope:{1:"title.class",3:"variable.constant"}},{match:[a,t.concat("::",t.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[a,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},R={scope:"attr",match:t.concat(n,t.lookahead(":"),t.lookahead(/(?!::)/))},q={relevance:0,begin:/\(/,end:/\)/,keywords:k,contains:[R,s,O,e.C_BLOCK_COMMENT_MODE,v,b,E]},$={relevance:0,match:[/\b/,t.concat("(?!fn\\b|function\\b|",j(S).join("\\b|"),"|",j(_).join("\\b|"),"\\b)"),n,t.concat(p,"*"),t.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[q]};q.contains.push($);const L=[R,O,e.C_BLOCK_COMMENT_MODE,v,b,E],A={begin:t.concat(/#\[\s*\\?/,t.either(a,i)),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:y,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:y,keyword:["new","array"]},contains:["self",...L]},...L,{scope:"meta",variants:[{match:a},{match:i}]}]};return{case_insensitive:!1,keywords:k,contains:[A,e.HASH_COMMENT_MODE,e.COMMENT("//","$"),e.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:e.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:!0}]}},l,{scope:"variable.language",match:/\$this\b/},s,$,O,{match:[/const/,/\s/,n],scope:{1:"keyword",3:"variable.constant"}},E,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:!0,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},e.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:!0},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0,keywords:k,contains:["self",A,s,O,e.C_BLOCK_COMMENT_MODE,v,b]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:!0,contains:[{beginKeywords:"extends implements"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[e.inherit(e.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},e.UNDERSCORE_TITLE_MODE]},v,b]}}function rqe(e){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},e.inherit(e.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),e.inherit(e.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]}]}}function nqe(e){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:!0}}function aqe(e){const t=e.regex,r=/[\p{XID_Start}_]\p{XID_Continue}*/u,n=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],l={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:n,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},u={className:"subst",begin:/\{/,end:/\}/,keywords:l,illegal:/#/},d={begin:/\{\{/,relevance:0},f={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,c,d,u]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,c,d,u]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[e.BACKSLASH_ESCAPE,d,u]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,d,u]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},m="[0-9](_?[0-9])*",p=`(\\b(${m}))?\\.(${m})|\\b(${m})\\.`,v=`\\b|${n.join("|")}`,b={className:"number",relevance:0,variants:[{begin:`(\\b(${m})|(${p}))[eE][+-]?(${m})[jJ]?(?=${v})`},{begin:`(${p})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${v})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${v})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${v})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${v})`},{begin:`\\b(${m})[jJ](?=${v})`}]},y={className:"comment",begin:t.lookahead(/# type:/),end:/$/,keywords:l,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},S={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:["self",c,b,f,e.HASH_COMMENT_MODE]}]};return u.contains=[f,b,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:l,illegal:/(<\/|\?)|=>/,contains:[c,b,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},f,y,e.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,r],scope:{1:"keyword",3:"title.function"},contains:[S]},{variants:[{match:[/\bclass/,/\s+/,r,/\s*/,/\(\s*/,r,/\s*\)/]},{match:[/\bclass/,/\s+/,r]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[b,S,f]}]}}function iqe(e){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}function sqe(e){const t=e.regex,r=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,n=t.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),a=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,i=t.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:r,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[e.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:t.lookahead(t.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:!0}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:r},{match:/`(?:\\.|[^`\\])+`/}],endsParent:!0}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),e.HASH_COMMENT_MODE,{scope:"string",contains:[e.BACKSLASH_ESCAPE],variants:[e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[a,n]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,n]},{scope:{1:"punctuation",2:"number"},match:[i,n]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,n]}]},{scope:{3:"operator"},match:[r,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:a},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:i},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}function oqe(e){const t=e.regex,r="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",n=t.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),a=t.concat(n,/(::\w+)*/),s={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},l={className:"doctag",begin:"@[A-Za-z]+"},c={begin:"#<",end:">"},u=[e.COMMENT("#","$",{contains:[l]}),e.COMMENT("^=begin","^=end",{contains:[l],relevance:10}),e.COMMENT("^__END__",e.MATCH_NOTHING_RE)],d={className:"subst",begin:/#\{/,end:/\}/,keywords:s},f={className:"string",contains:[e.BACKSLASH_ESCAPE,d],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:t.concat(/<<[-~]?'?/,t.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[e.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[e.BACKSLASH_ESCAPE,d]})]}]},m="[1-9](_?[0-9])*|0",p="[0-9](_?[0-9])*",v={className:"number",relevance:0,variants:[{begin:`\\b(${m})(\\.(${p}))?([eE][+-]?(${p})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},b={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:!0,endsParent:!0,keywords:s}]},E=[f,{variants:[{match:[/class\s+/,a,/\s+<\s+/,a]},{match:[/\b(class|module)\s+/,a]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:s},{match:[/(include|extend)\s+/,a],scope:{2:"title.class"},keywords:s},{relevance:0,match:[a,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:n,scope:"title.class"},{match:[/def/,/\s+/,r],scope:{1:"keyword",3:"title.function"},contains:[b]},{begin:e.IDENT_RE+"::"},{className:"symbol",begin:e.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[f,{begin:r}],relevance:0},v,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|(?!=)/,end:/\|/,excludeBegin:!0,excludeEnd:!0,relevance:0,keywords:s},{begin:"("+e.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[e.BACKSLASH_ESCAPE,d],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(c,u),relevance:0}].concat(c,u);d.contains=E,b.contains=E;const q=[{begin:/^\s*=>/,starts:{end:"$",contains:E}},{className:"meta.prompt",begin:"^("+"[>?]>"+"|"+"[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]"+"|"+"(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>"+")(?=[ ])",starts:{end:"$",keywords:s,contains:E}}];return u.unshift(c),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:s,illegal:/\/\*/,contains:[e.SHEBANG({binary:"ruby"})].concat(q).concat(u).concat(E)}}function lqe(e){const t=e.regex,r=/(r#)?/,n=t.concat(r,e.UNDERSCORE_IDENT_RE),a=t.concat(r,e.IDENT_RE),i={className:"title.function.invoke",relevance:0,begin:t.concat(/\b/,/(?!let|for|while|if|else|match\b)/,a,t.lookahead(/\s*\(/))},s="([ui](8|16|32|64|128|size)|f(32|64))?",l=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],c=["true","false","Some","None","Ok","Err"],u=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],d=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:e.IDENT_RE+"!?",type:d,keyword:l,literal:c,built_in:u},illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.COMMENT("/\\*","\\*/",{contains:["self"]}),e.inherit(e.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*(?!')/},{scope:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'/,end:/'/,contains:[{scope:"char.escape",match:/\\('|\w|x\w{2}|u\w{4}|U\w{8})/}]}]},{className:"number",variants:[{begin:"\\b0b([01_]+)"+s},{begin:"\\b0o([0-7_]+)"+s},{begin:"\\b0x([A-Fa-f0-9_]+)"+s},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+s}],relevance:0},{begin:[/fn/,/\s+/,n],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,n],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,n,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,n],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,n],className:{1:"keyword",3:"title.class"}},{begin:e.IDENT_RE+"::",keywords:{keyword:"Self",built_in:u,type:d}},{className:"punctuation",begin:"->"},i]}}const cqe=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),uqe=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],dqe=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],fqe=[...uqe,...dqe],hqe=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),mqe=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),pqe=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),gqe=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function vqe(e){const t=cqe(e),r=pqe,n=mqe,a="@[a-z-]+",i="and or not only",l={className:"variable",begin:"(\\$"+"[a-zA-Z-][a-zA-Z0-9_-]*"+")\\b",relevance:0};return{name:"SCSS",case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,t.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},t.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+fqe.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+n.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+r.join("|")+")"},l,{begin:/\(/,end:/\)/,contains:[t.CSS_NUMBER_MODE]},t.CSS_VARIABLE,{className:"attribute",begin:"\\b("+gqe.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[t.BLOCK_COMMENT,l,t.HEXCOLOR,t.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t.IMPORTANT,t.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:a,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:!0,keywords:{$pattern:/[a-z-]+/,keyword:i,attribute:hqe.join(" ")},contains:[{begin:a,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},l,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t.HEXCOLOR,t.CSS_NUMBER_MODE]},t.FUNCTION_DISPATCH]}}function bqe(e){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}function yqe(e){const t=e.regex,r=e.COMMENT("--","$"),n={scope:"string",variants:[{begin:/'/,end:/'/,contains:[{match:/''/}]}]},a={begin:/"/,end:/"/,contains:[{match:/""/}]},i=["true","false","unknown"],s=["double precision","large object","with timezone","without timezone"],l=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],c=["add","asc","collation","desc","final","first","last","view"],u=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],d=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],f=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],m=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],p=d,v=[...u,...c].filter(j=>!d.includes(j)),b={scope:"variable",match:/@[a-z0-9][a-z0-9_]*/},y={scope:"operator",match:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},S={match:t.concat(/\b/,t.either(...p),/\s*\(/),relevance:0,keywords:{built_in:p}};function _(j){return t.concat(/\b/,t.either(...j.map(E=>E.replace(/\s+/,"\\s+"))),/\b/)}const N={scope:"keyword",match:_(m),relevance:0};function k(j,{exceptions:E,when:T}={}){const O=T;return E=E||[],j.map(R=>R.match(/\|\d+$/)||E.includes(R)?R:O(R)?`${R}|0`:R)}return{name:"SQL",case_insensitive:!0,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:k(v,{when:j=>j.length<3}),literal:i,type:l,built_in:f},contains:[{scope:"type",match:_(s)},N,S,b,n,a,e.C_NUMBER_MODE,e.C_BLOCK_COMMENT_MODE,r,y]}}function dfe(e){return e?typeof e=="string"?e:e.source:null}function Mv(e){return cn("(?=",e,")")}function cn(...e){return e.map(r=>dfe(r)).join("")}function xqe(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function Mi(...e){return"("+(xqe(e).capture?"":"?:")+e.map(n=>dfe(n)).join("|")+")"}const U9=e=>cn(/\b/,e,/\w$/.test(e)?/\b/:/\B/),wqe=["Protocol","Type"].map(U9),MJ=["init","self"].map(U9),Sqe=["Any","Self"],JD=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],TJ=["false","nil","true"],kqe=["assignment","associativity","higherThan","left","lowerThan","none","right"],_qe=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],AJ=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],ffe=Mi(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),hfe=Mi(ffe,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),ZD=cn(ffe,hfe,"*"),mfe=Mi(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),GN=Mi(mfe,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),hl=cn(mfe,GN,"*"),kS=cn(/[A-Z]/,GN,"*"),Nqe=["attached","autoclosure",cn(/convention\(/,Mi("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",cn(/objc\(/,hl,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],Cqe=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function jqe(e){const t={match:/\s+/,relevance:0},r=e.COMMENT("/\\*","\\*/",{contains:["self"]}),n=[e.C_LINE_COMMENT_MODE,r],a={match:[/\./,Mi(...wqe,...MJ)],className:{2:"keyword"}},i={match:cn(/\./,Mi(...JD)),relevance:0},s=JD.filter(de=>typeof de=="string").concat(["_|0"]),l=JD.filter(de=>typeof de!="string").concat(Sqe).map(U9),c={variants:[{className:"keyword",match:Mi(...l,...MJ)}]},u={$pattern:Mi(/\b\w+/,/#\w+/),keyword:s.concat(_qe),literal:TJ},d=[a,i,c],f={match:cn(/\./,Mi(...AJ)),relevance:0},m={className:"built_in",match:cn(/\b/,Mi(...AJ),/(?=\()/)},p=[f,m],v={match:/->/,relevance:0},b={className:"operator",relevance:0,variants:[{match:ZD},{match:`\\.(\\.|${hfe})+`}]},y=[v,b],S="([0-9]_*)+",_="([0-9a-fA-F]_*)+",N={className:"number",relevance:0,variants:[{match:`\\b(${S})(\\.(${S}))?([eE][+-]?(${S}))?\\b`},{match:`\\b0x(${_})(\\.(${_}))?([pP][+-]?(${S}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},k=(de="")=>({className:"subst",variants:[{match:cn(/\\/,de,/[0\\tnr"']/)},{match:cn(/\\/,de,/u\{[0-9a-fA-F]{1,8}\}/)}]}),j=(de="")=>({className:"subst",match:cn(/\\/,de,/[\t ]*(?:[\r\n]|\r\n)/)}),E=(de="")=>({className:"subst",label:"interpol",begin:cn(/\\/,de,/\(/),end:/\)/}),T=(de="")=>({begin:cn(de,/"""/),end:cn(/"""/,de),contains:[k(de),j(de),E(de)]}),O=(de="")=>({begin:cn(de,/"/),end:cn(/"/,de),contains:[k(de),E(de)]}),R={className:"string",variants:[T(),T("#"),T("##"),T("###"),O(),O("#"),O("##"),O("###")]},q=[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}],$={begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:q},L=de=>{const re=cn(de,/\//),ne=cn(/\//,de);return{begin:re,end:ne,contains:[...q,{scope:"comment",begin:`#(?!.*${ne})`,end:/$/}]}},A={scope:"regexp",variants:[L("###"),L("##"),L("#"),$]},M={match:cn(/`/,hl,/`/)},z={className:"variable",match:/\$\d+/},I={className:"variable",match:`\\$${GN}+`},B=[M,z,I],F={match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:Cqe,contains:[...y,N,R]}]}},U={scope:"keyword",match:cn(/@/,Mi(...Nqe),Mv(Mi(/\(/,/\s+/)))},V={scope:"meta",match:cn(/@/,hl)},K=[F,U,V],G={match:Mv(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:cn(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,GN,"+")},{className:"type",match:kS,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:cn(/\s+&\s+/,Mv(kS)),relevance:0}]},J={begin:/</,end:/>/,keywords:u,contains:[...n,...d,...K,v,G]};G.contains.push(J);const ee={match:cn(hl,/\s*:/),keywords:"_|0",relevance:0},Y={begin:/\(/,end:/\)/,relevance:0,keywords:u,contains:["self",ee,...n,A,...d,...p,...y,N,R,...B,...K,G]},ie={begin:/</,end:/>/,keywords:"repeat each",contains:[...n,G]},fe={begin:Mi(Mv(cn(hl,/\s*:/)),Mv(cn(hl,/\s+/,hl,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:hl}]},me={begin:/\(/,end:/\)/,keywords:u,contains:[fe,...n,...d,...y,N,R,...K,G,Y],endsParent:!0,illegal:/["']/},te={match:[/(func|macro)/,/\s+/,Mi(M.match,hl,ZD)],className:{1:"keyword",3:"title.function"},contains:[ie,me,t],illegal:[/\[/,/%/]},oe={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[ie,me,t],illegal:/\[|%/},ce={match:[/operator/,/\s+/,ZD],className:{1:"keyword",3:"title"}},Z={begin:[/precedencegroup/,/\s+/,kS],className:{1:"keyword",3:"title"},contains:[G],keywords:[...kqe,...TJ],end:/}/},ue={match:[/class\b/,/\s+/,/func\b/,/\s+/,/\b[A-Za-z_][A-Za-z0-9_]*\b/],scope:{1:"keyword",3:"keyword",5:"title.function"}},H={match:[/class\b/,/\s+/,/var\b/],scope:{1:"keyword",3:"keyword"}},ge={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,hl,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:u,contains:[ie,...d,{begin:/:/,end:/\{/,keywords:u,contains:[{scope:"title.class.inherited",match:kS},...d],relevance:0}]};for(const de of R.variants){const re=de.contains.find(pe=>pe.label==="interpol");re.keywords=u;const ne=[...d,...p,...y,N,R,...B];re.contains=[...ne,{begin:/\(/,end:/\)/,contains:["self",...ne]}]}return{name:"Swift",keywords:u,contains:[...n,te,oe,ue,H,ge,ce,Z,{beginKeywords:"import",end:/$/,contains:[...n],relevance:0},A,...d,...p,...y,N,R,...B,...K,G,Y]}}const VN="[A-Za-z$_][0-9A-Za-z$_]*",pfe=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],gfe=["true","false","null","undefined","NaN","Infinity"],vfe=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],bfe=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],yfe=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],xfe=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],wfe=[].concat(yfe,vfe,bfe);function Eqe(e){const t=e.regex,r=(F,{after:U})=>{const V="</"+F[0].slice(1);return F.input.indexOf(V,U)!==-1},n=VN,a={begin:"<>",end:"</>"},i=/<[A-Za-z0-9\\._:-]+\s*\/>/,s={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(F,U)=>{const V=F[0].length+F.index,K=F.input[V];if(K==="<"||K===","){U.ignoreMatch();return}K===">"&&(r(F,{after:V})||U.ignoreMatch());let G;const J=F.input.substring(V);if(G=J.match(/^\s*=/)){U.ignoreMatch();return}if((G=J.match(/^\s+extends\s+/))&&G.index===0){U.ignoreMatch();return}}},l={$pattern:VN,keyword:pfe,literal:gfe,built_in:wfe,"variable.language":xfe},c="[0-9](_?[0-9])*",u=`\\.(${c})`,d="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",f={className:"number",variants:[{begin:`(\\b(${d})((${u})|\\.)?|(${u}))[eE][+-]?(${c})\\b`},{begin:`\\b(${d})\\b((${u})\\b|\\.)?|(${u})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:l,contains:[]},p={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},v={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"css"}},b={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"graphql"}},y={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,m]},_={className:"comment",variants:[e.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:n+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]},N=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,{match:/\$\d+/},f];m.contains=N.concat({begin:/\{/,end:/\}/,keywords:l,contains:["self"].concat(N)});const k=[].concat(_,m.contains),j=k.concat([{begin:/(\s*)\(/,end:/\)/,keywords:l,contains:["self"].concat(k)}]),E={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j},T={variants:[{match:[/class/,/\s+/,n,/\s+/,/extends/,/\s+/,t.concat(n,"(",t.concat(/\./,n),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,n],scope:{1:"keyword",3:"title.class"}}]},O={relevance:0,match:t.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...vfe,...bfe]}},R={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},q={variants:[{match:[/function/,/\s+/,n,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[E],illegal:/%/},$={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function L(F){return t.concat("(?!",F.join("|"),")")}const A={match:t.concat(/\b/,L([...yfe,"super","import"].map(F=>`${F}\\s*\\(`)),n,t.lookahead(/\s*\(/)),className:"title.function",relevance:0},M={begin:t.concat(/\./,t.lookahead(t.concat(n,/(?![0-9A-Za-z$_(])/))),end:n,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},z={match:[/get|set/,/\s+/,n,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},E]},I="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+e.UNDERSCORE_IDENT_RE+")\\s*=>",B={match:[/const|var|let/,/\s+/,n,/\s*/,/=\s*/,/(async\s*)?/,t.lookahead(I)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[E]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:l,exports:{PARAMS_CONTAINS:j,CLASS_REFERENCE:O},illegal:/#(?![$_A-z])/,contains:[e.SHEBANG({label:"shebang",binary:"node",relevance:5}),R,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,_,{match:/\$\d+/},f,O,{scope:"attr",match:n+t.lookahead(":"),relevance:0},B,{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[_,e.REGEXP_MODE,{className:"function",begin:I,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:a.begin,end:a.end},{match:i},{begin:s.begin,"on:begin":s.isTrulyOpeningTag,end:s.end}],subLanguage:"xml",contains:[{begin:s.begin,end:s.end,skip:!0,contains:["self"]}]}]},q,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+e.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[E,e.inherit(e.TITLE_MODE,{begin:n,className:"title.function"})]},{match:/\.\.\./,relevance:0},M,{match:"\\$"+n,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[E]},A,$,T,z,{match:/\$[(.]/}]}}function Mqe(e){const t=e.regex,r=Eqe(e),n=VN,a=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],i={begin:[/namespace/,/\s+/,e.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},s={beginKeywords:"interface",end:/\{/,excludeEnd:!0,keywords:{keyword:"interface extends",built_in:a},contains:[r.exports.CLASS_REFERENCE]},l={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},c=["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"],u={$pattern:VN,keyword:pfe.concat(c),literal:gfe,built_in:wfe.concat(a),"variable.language":xfe},d={className:"meta",begin:"@"+n},f=(b,y,S)=>{const _=b.contains.findIndex(N=>N.label===y);if(_===-1)throw new Error("can not find mode to replace");b.contains.splice(_,1,S)};Object.assign(r.keywords,u),r.exports.PARAMS_CONTAINS.push(d);const m=r.contains.find(b=>b.scope==="attr"),p=Object.assign({},m,{match:t.concat(n,t.lookahead(/\s*\?:/))});r.exports.PARAMS_CONTAINS.push([r.exports.CLASS_REFERENCE,m,p]),r.contains=r.contains.concat([d,i,s,p]),f(r,"shebang",e.SHEBANG()),f(r,"use_strict",l);const v=r.contains.find(b=>b.label==="func.def");return v.relevance=0,Object.assign(r,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),r}function Tqe(e){const t=e.regex,r={className:"string",begin:/"(""|[^/n])"C\b/},n={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},a=/\d{1,2}\/\d{1,2}\/\d{4}/,i=/\d{4}-\d{1,2}-\d{1,2}/,s=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,l=/\d{1,2}(:\d{1,2}){1,2}/,c={className:"literal",variants:[{begin:t.concat(/# */,t.either(i,a),/ *#/)},{begin:t.concat(/# */,l,/ *#/)},{begin:t.concat(/# */,s,/ *#/)},{begin:t.concat(/# */,t.either(i,a),/ +/,t.either(s,l),/ *#/)}]},u={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},d={className:"label",begin:/^\w+:/},f=e.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),m=e.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:!0,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[r,n,c,u,d,f,m,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[m]}]}}function Aqe(e){e.regex;const t=e.COMMENT(/\(;/,/;\)/);t.contains.push("self");const r=e.COMMENT(/;;/,/$/),n=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],a={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},i={className:"variable",begin:/\$[\w_]+/},s={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},l={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},c={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},u={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:n},contains:[r,t,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},i,s,a,e.QUOTE_STRING_MODE,c,u,l]}}function Dqe(e){const t=e.regex,r=t.concat(/[\p{L}_]/u,t.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),n=/[\p{L}0-9._:-]+/u,a={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},i={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},s=e.inherit(i,{begin:/\(/,end:/\)/}),l=e.inherit(e.APOS_STRING_MODE,{className:"string"}),c=e.inherit(e.QUOTE_STRING_MODE,{className:"string"}),u={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:n,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[a]},{begin:/'/,end:/'/,contains:[a]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[i,c,l,s,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[i,s,c,l]}]}]},e.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},a,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[c]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[u],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[u],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:t.concat(/</,t.lookahead(t.concat(r,t.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:r,relevance:0,starts:u}]},{className:"tag",begin:t.concat(/<\//,t.lookahead(t.concat(r,/>/))),contains:[{className:"name",begin:r,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}function Lqe(e){const t="true false yes no null",r="[\\w#;/?:@&=+$,.~*'()[\\]]+",n={className:"attr",variants:[{begin:/[\w*@][\w*@ :()\./-]*:(?=[ \t]|$)/},{begin:/"[\w*@][\w*@ :()\./-]*":(?=[ \t]|$)/},{begin:/'[\w*@][\w*@ :()\./-]*':(?=[ \t]|$)/}]},a={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},i={className:"string",relevance:0,begin:/'/,end:/'/,contains:[{match:/''/,scope:"char.escape",relevance:0}]},s={className:"string",relevance:0,variants:[{begin:/"/,end:/"/},{begin:/\S+/}],contains:[e.BACKSLASH_ESCAPE,a]},l=e.inherit(s,{variants:[{begin:/'/,end:/'/,contains:[{begin:/''/,relevance:0}]},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),m={className:"number",begin:"\\b"+"[0-9]{4}(-[0-9][0-9]){0,2}"+"([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?"+"(\\.[0-9]*)?"+"([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?"+"\\b"},p={end:",",endsWithParent:!0,excludeEnd:!0,keywords:t,relevance:0},v={begin:/\{/,end:/\}/,contains:[p],illegal:"\\n",relevance:0},b={begin:"\\[",end:"\\]",contains:[p],illegal:"\\n",relevance:0},y=[n,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!\\w+!"+r},{className:"type",begin:"!<"+r+">"},{className:"type",begin:"!"+r},{className:"type",begin:"!!"+r},{className:"meta",begin:"&"+e.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+e.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},e.HASH_COMMENT_MODE,{beginKeywords:t,keywords:{literal:t}},m,{className:"number",begin:e.C_NUMBER_RE+"\\b",relevance:0},v,b,i,s],S=[...y];return S.pop(),S.push(l),p.contains=S,{name:"YAML",case_insensitive:!0,aliases:["yml"],contains:y}}const Oqe={arduino:pHe,bash:gHe,c:vHe,cpp:bHe,csharp:yHe,css:EHe,diff:MHe,go:THe,graphql:AHe,ini:DHe,java:LHe,javascript:zHe,json:BHe,kotlin:FHe,less:YHe,lua:QHe,makefile:JHe,markdown:ZHe,objectivec:XHe,perl:eqe,php:tqe,"php-template":rqe,plaintext:nqe,python:aqe,"python-repl":iqe,r:sqe,ruby:oqe,rust:lqe,scss:vqe,shell:bqe,sql:yqe,swift:jqe,typescript:Mqe,vbnet:Tqe,wasm:Aqe,xml:Dqe,yaml:Lqe},DJ={},Iqe="hljs-";function Rqe(e){const t=nfe.newInstance();return e&&i(e),{highlight:r,highlightAuto:n,listLanguages:a,register:i,registerAlias:s,registered:l};function r(c,u,d){const f=d||DJ,m=typeof f.prefix=="string"?f.prefix:Iqe;if(!t.getLanguage(c))throw new Error("Unknown language: `"+c+"` is not registered");t.configure({__emitter:Pqe,classPrefix:m});const p=t.highlight(u,{ignoreIllegals:!0,language:c});if(p.errorRaised)throw new Error("Could not highlight with `Highlight.js`",{cause:p.errorRaised});const v=p._emitter.root,b=v.data;return b.language=p.language,b.relevance=p.relevance,v}function n(c,u){const f=(u||DJ).subset||a();let m=-1,p=0,v;for(;++m<f.length;){const b=f[m];if(!t.getLanguage(b))continue;const y=r(b,c,u);y.data&&y.data.relevance!==void 0&&y.data.relevance>p&&(p=y.data.relevance,v=y)}return v||{type:"root",children:[],data:{language:void 0,relevance:p}}}function a(){return t.listLanguages()}function i(c,u){if(typeof c=="string")t.registerLanguage(c,u);else{let d;for(d in c)Object.hasOwn(c,d)&&t.registerLanguage(d,c[d])}}function s(c,u){if(typeof c=="string")t.registerAliases(typeof u=="string"?u:[...u],{languageName:c});else{let d;for(d in c)if(Object.hasOwn(c,d)){const f=c[d];t.registerAliases(typeof f=="string"?f:[...f],{languageName:d})}}}function l(c){return!!t.getLanguage(c)}}class Pqe{constructor(t){this.options=t,this.root={type:"root",children:[],data:{language:void 0,relevance:0}},this.stack=[this.root]}addText(t){if(t==="")return;const r=this.stack[this.stack.length-1],n=r.children[r.children.length-1];n&&n.type==="text"?n.value+=t:r.children.push({type:"text",value:t})}startScope(t){this.openNode(String(t))}endScope(){this.closeNode()}__addSublanguage(t,r){const n=this.stack[this.stack.length-1],a=t.root.children;r?n.children.push({type:"element",tagName:"span",properties:{className:[r]},children:a}):n.children.push(...a)}openNode(t){const r=this,n=t.split(".").map(function(s,l){return l?s+"_".repeat(l):r.options.classPrefix+s}),a=this.stack[this.stack.length-1],i={type:"element",tagName:"span",properties:{className:n},children:[]};a.children.push(i),this.stack.push(i)}closeNode(){this.stack.pop()}finalize(){}toHTML(){return""}}function zqe(e){var t;const{char:r,allowSpaces:n,allowToIncludeChar:a,allowedPrefixes:i,startOfLine:s,$position:l}=e,c=n&&!a,u=V8e(r),d=new RegExp(`\\s${u}$`),f=s?"^":"",m=a?"":u,p=c?new RegExp(`${f}${u}.*?(?=\\s${m}|$)`,"gm"):new RegExp(`${f}(?:^)?${u}[^\\s${m}]*`,"gm"),v=((t=l.nodeBefore)==null?void 0:t.isText)&&l.nodeBefore.text;if(!v)return null;const b=l.pos-v.length,y=Array.from(v.matchAll(p)).pop();if(!y||y.input===void 0||y.index===void 0)return null;const S=y.input.slice(Math.max(0,y.index-1),y.index),_=new RegExp(`^[${i?.join("")}\0]?$`).test(S);if(i!==null&&!_)return null;const N=b+y.index;let k=N+y[0].length;return c&&d.test(v.slice(k-1,k+1))&&(y[0]+=" ",k+=1),N<l.pos&&k>=l.pos?{range:{from:N,to:k},query:y[0].slice(r.length),text:y[0]}:null}var Bqe=new Gr("suggestion");function $qe({pluginKey:e=Bqe,editor:t,char:r="@",allowSpaces:n=!1,allowToIncludeChar:a=!1,allowedPrefixes:i=[" "],startOfLine:s=!1,decorationTag:l="span",decorationClass:c="suggestion",decorationContent:u="",decorationEmptyClass:d="is-empty",command:f=()=>null,items:m=()=>[],render:p=()=>({}),allow:v=()=>!0,findSuggestionMatch:b=zqe,shouldShow:y}){let S;const _=p?.(),N=()=>{const T=t.state.selection.$anchor.pos,O=t.view.coordsAtPos(T),{top:R,right:q,bottom:$,left:L}=O;try{return new DOMRect(L,R,q-L,$-R)}catch{return null}},k=(T,O)=>O?()=>{const R=e.getState(t.state),q=R?.decorationId,$=T.dom.querySelector(`[data-decoration-id="${q}"]`);return $?.getBoundingClientRect()||null}:N;function j(T,O){var R;try{const $=e.getState(T.state),L=$?.decorationId?T.dom.querySelector(`[data-decoration-id="${$.decorationId}"]`):null,A={editor:t,range:$?.range||{from:0,to:0},query:$?.query||null,text:$?.text||null,items:[],command:M=>f({editor:t,range:$?.range||{from:0,to:0},props:M}),decorationNode:L,clientRect:k(T,L)};(R=_?.onExit)==null||R.call(_,A)}catch{}const q=T.state.tr.setMeta(O,{exit:!0});T.dispatch(q)}const E=new Ur({key:e,view(){return{update:async(T,O)=>{var R,q,$,L,A,M,z;const I=(R=this.key)==null?void 0:R.getState(O),B=(q=this.key)==null?void 0:q.getState(T.state),F=I.active&&B.active&&I.range.from!==B.range.from,U=!I.active&&B.active,V=I.active&&!B.active,K=!U&&!V&&I.query!==B.query,G=U||F&&K,J=K||F,ee=V||F&&K;if(!G&&!J&&!ee)return;const Y=ee&&!G?I:B,ie=T.dom.querySelector(`[data-decoration-id="${Y.decorationId}"]`);S={editor:t,range:Y.range,query:Y.query,text:Y.text,items:[],command:fe=>f({editor:t,range:Y.range,props:fe}),decorationNode:ie,clientRect:k(T,ie)},G&&(($=_?.onBeforeStart)==null||$.call(_,S)),J&&((L=_?.onBeforeUpdate)==null||L.call(_,S)),(J||G)&&(S.items=await m({editor:t,query:Y.query})),ee&&((A=_?.onExit)==null||A.call(_,S)),J&&((M=_?.onUpdate)==null||M.call(_,S)),G&&((z=_?.onStart)==null||z.call(_,S))},destroy:()=>{var T;S&&((T=_?.onExit)==null||T.call(_,S))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(T,O,R,q){const{isEditable:$}=t,{composing:L}=t.view,{selection:A}=T,{empty:M,from:z}=A,I={...O},B=T.getMeta(e);if(B&&B.exit)return I.active=!1,I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null,I;if(I.composing=L,$&&(M||t.view.composing)){(z<O.range.from||z>O.range.to)&&!L&&!O.composing&&(I.active=!1);const F=b({char:r,allowSpaces:n,allowToIncludeChar:a,allowedPrefixes:i,startOfLine:s,$position:A.$from}),U=`id_${Math.floor(Math.random()*4294967295)}`;F&&v({editor:t,state:q,range:F.range,isActive:O.active})&&(!y||y({editor:t,range:F.range,query:F.query,text:F.text,transaction:T}))?(I.active=!0,I.decorationId=O.decorationId?O.decorationId:U,I.range=F.range,I.query=F.query,I.text=F.text):I.active=!1}else I.active=!1;return I.active||(I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null),I}},props:{handleKeyDown(T,O){var R,q,$,L;const{active:A,range:M}=E.getState(T.state);if(!A)return!1;if(O.key==="Escape"||O.key==="Esc"){const I=E.getState(T.state),B=(R=S?.decorationNode)!=null?R:null,F=B??(I?.decorationId?T.dom.querySelector(`[data-decoration-id="${I.decorationId}"]`):null);if(((q=_?.onKeyDown)==null?void 0:q.call(_,{view:T,event:O,range:I.range}))||!1)return!0;const V={editor:t,range:I.range,query:I.query,text:I.text,items:[],command:K=>f({editor:t,range:I.range,props:K}),decorationNode:F,clientRect:F?()=>F.getBoundingClientRect()||null:null};return($=_?.onExit)==null||$.call(_,V),j(T,e),!0}return((L=_?.onKeyDown)==null?void 0:L.call(_,{view:T,event:O,range:M}))||!1},decorations(T){const{active:O,range:R,decorationId:q,query:$}=E.getState(T);if(!O)return null;const L=!$?.length,A=[c];return L&&A.push(d),Jr.create(T.doc,[ga.inline(R.from,R.to,{nodeName:l,class:A.join(" "),"data-decoration-id":q,"data-decoration-content":u})])}}});return E}var H9=$qe,as="top",_o="bottom",No="right",is="left",q9="auto",a1=[as,_o,No,is],Mg="start",rx="end",Fqe="clippingParents",Sfe="viewport",Tv="popper",Uqe="reference",LJ=a1.reduce(function(e,t){return e.concat([t+"-"+Mg,t+"-"+rx])},[]),kfe=[].concat(a1,[q9]).reduce(function(e,t){return e.concat([t,t+"-"+Mg,t+"-"+rx])},[]),Hqe="beforeRead",qqe="read",Wqe="afterRead",Kqe="beforeMain",Gqe="main",Vqe="afterMain",Yqe="beforeWrite",Qqe="write",Jqe="afterWrite",Zqe=[Hqe,qqe,Wqe,Kqe,Gqe,Vqe,Yqe,Qqe,Jqe];function Rl(e){return e?(e.nodeName||"").toLowerCase():null}function Ps(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Th(e){var t=Ps(e).Element;return e instanceof t||e instanceof Element}function wo(e){var t=Ps(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function W9(e){if(typeof ShadowRoot>"u")return!1;var t=Ps(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Xqe(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var n=t.styles[r]||{},a=t.attributes[r]||{},i=t.elements[r];!wo(i)||!Rl(i)||(Object.assign(i.style,n),Object.keys(a).forEach(function(s){var l=a[s];l===!1?i.removeAttribute(s):i.setAttribute(s,l===!0?"":l)}))})}function e7e(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(n){var a=t.elements[n],i=t.attributes[n]||{},s=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:r[n]),l=s.reduce(function(c,u){return c[u]="",c},{});!wo(a)||!Rl(a)||(Object.assign(a.style,l),Object.keys(i).forEach(function(c){a.removeAttribute(c)}))})}}const _fe={name:"applyStyles",enabled:!0,phase:"write",fn:Xqe,effect:e7e,requires:["computeStyles"]};function Nl(e){return e.split("-")[0]}var ch=Math.max,YN=Math.min,Tg=Math.round;function UR(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Nfe(){return!/^((?!chrome|android).)*safari/i.test(UR())}function Ag(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,i=1;t&&wo(e)&&(a=e.offsetWidth>0&&Tg(n.width)/e.offsetWidth||1,i=e.offsetHeight>0&&Tg(n.height)/e.offsetHeight||1);var s=Th(e)?Ps(e):window,l=s.visualViewport,c=!Nfe()&&r,u=(n.left+(c&&l?l.offsetLeft:0))/a,d=(n.top+(c&&l?l.offsetTop:0))/i,f=n.width/a,m=n.height/i;return{width:f,height:m,top:d,right:u+f,bottom:d+m,left:u,x:u,y:d}}function K9(e){var t=Ag(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Cfe(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&W9(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ou(e){return Ps(e).getComputedStyle(e)}function t7e(e){return["table","td","th"].indexOf(Rl(e))>=0}function Kd(e){return((Th(e)?e.ownerDocument:e.document)||window.document).documentElement}function s2(e){return Rl(e)==="html"?e:e.assignedSlot||e.parentNode||(W9(e)?e.host:null)||Kd(e)}function OJ(e){return!wo(e)||ou(e).position==="fixed"?null:e.offsetParent}function r7e(e){var t=/firefox/i.test(UR()),r=/Trident/i.test(UR());if(r&&wo(e)){var n=ou(e);if(n.position==="fixed")return null}var a=s2(e);for(W9(a)&&(a=a.host);wo(a)&&["html","body"].indexOf(Rl(a))<0;){var i=ou(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function i1(e){for(var t=Ps(e),r=OJ(e);r&&t7e(r)&&ou(r).position==="static";)r=OJ(r);return r&&(Rl(r)==="html"||Rl(r)==="body"&&ou(r).position==="static")?t:r||r7e(e)||t}function G9(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Wb(e,t,r){return ch(e,YN(t,r))}function n7e(e,t,r){var n=Wb(e,t,r);return n>r?r:n}function jfe(){return{top:0,right:0,bottom:0,left:0}}function Efe(e){return Object.assign({},jfe(),e)}function Mfe(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var a7e=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,Efe(typeof t!="number"?t:Mfe(t,a1))};function i7e(e){var t,r=e.state,n=e.name,a=e.options,i=r.elements.arrow,s=r.modifiersData.popperOffsets,l=Nl(r.placement),c=G9(l),u=[is,No].indexOf(l)>=0,d=u?"height":"width";if(!(!i||!s)){var f=a7e(a.padding,r),m=K9(i),p=c==="y"?as:is,v=c==="y"?_o:No,b=r.rects.reference[d]+r.rects.reference[c]-s[c]-r.rects.popper[d],y=s[c]-r.rects.reference[c],S=i1(i),_=S?c==="y"?S.clientHeight||0:S.clientWidth||0:0,N=b/2-y/2,k=f[p],j=_-m[d]-f[v],E=_/2-m[d]/2+N,T=Wb(k,E,j),O=c;r.modifiersData[n]=(t={},t[O]=T,t.centerOffset=T-E,t)}}function s7e(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||Cfe(t.elements.popper,a)&&(t.elements.arrow=a))}const o7e={name:"arrow",enabled:!0,phase:"main",fn:i7e,effect:s7e,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Dg(e){return e.split("-")[1]}var l7e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function c7e(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:Tg(r*a)/a||0,y:Tg(n*a)/a||0}}function IJ(e){var t,r=e.popper,n=e.popperRect,a=e.placement,i=e.variation,s=e.offsets,l=e.position,c=e.gpuAcceleration,u=e.adaptive,d=e.roundOffsets,f=e.isFixed,m=s.x,p=m===void 0?0:m,v=s.y,b=v===void 0?0:v,y=typeof d=="function"?d({x:p,y:b}):{x:p,y:b};p=y.x,b=y.y;var S=s.hasOwnProperty("x"),_=s.hasOwnProperty("y"),N=is,k=as,j=window;if(u){var E=i1(r),T="clientHeight",O="clientWidth";if(E===Ps(r)&&(E=Kd(r),ou(E).position!=="static"&&l==="absolute"&&(T="scrollHeight",O="scrollWidth")),E=E,a===as||(a===is||a===No)&&i===rx){k=_o;var R=f&&E===j&&j.visualViewport?j.visualViewport.height:E[T];b-=R-n.height,b*=c?1:-1}if(a===is||(a===as||a===_o)&&i===rx){N=No;var q=f&&E===j&&j.visualViewport?j.visualViewport.width:E[O];p-=q-n.width,p*=c?1:-1}}var $=Object.assign({position:l},u&&l7e),L=d===!0?c7e({x:p,y:b},Ps(r)):{x:p,y:b};if(p=L.x,b=L.y,c){var A;return Object.assign({},$,(A={},A[k]=_?"0":"",A[N]=S?"0":"",A.transform=(j.devicePixelRatio||1)<=1?"translate("+p+"px, "+b+"px)":"translate3d("+p+"px, "+b+"px, 0)",A))}return Object.assign({},$,(t={},t[k]=_?b+"px":"",t[N]=S?p+"px":"",t.transform="",t))}function u7e(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,i=r.adaptive,s=i===void 0?!0:i,l=r.roundOffsets,c=l===void 0?!0:l,u={placement:Nl(t.placement),variation:Dg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,IJ(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,IJ(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const d7e={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:u7e,data:{}};var _S={passive:!0};function f7e(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,i=a===void 0?!0:a,s=n.resize,l=s===void 0?!0:s,c=Ps(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&u.forEach(function(d){d.addEventListener("scroll",r.update,_S)}),l&&c.addEventListener("resize",r.update,_S),function(){i&&u.forEach(function(d){d.removeEventListener("scroll",r.update,_S)}),l&&c.removeEventListener("resize",r.update,_S)}}const h7e={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:f7e,data:{}};var m7e={left:"right",right:"left",bottom:"top",top:"bottom"};function Sk(e){return e.replace(/left|right|bottom|top/g,function(t){return m7e[t]})}var p7e={start:"end",end:"start"};function RJ(e){return e.replace(/start|end/g,function(t){return p7e[t]})}function V9(e){var t=Ps(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function Y9(e){return Ag(Kd(e)).left+V9(e).scrollLeft}function g7e(e,t){var r=Ps(e),n=Kd(e),a=r.visualViewport,i=n.clientWidth,s=n.clientHeight,l=0,c=0;if(a){i=a.width,s=a.height;var u=Nfe();(u||!u&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:s,x:l+Y9(e),y:c}}function v7e(e){var t,r=Kd(e),n=V9(e),a=(t=e.ownerDocument)==null?void 0:t.body,i=ch(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),s=ch(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-n.scrollLeft+Y9(e),c=-n.scrollTop;return ou(a||r).direction==="rtl"&&(l+=ch(r.clientWidth,a?a.clientWidth:0)-i),{width:i,height:s,x:l,y:c}}function Q9(e){var t=ou(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function Tfe(e){return["html","body","#document"].indexOf(Rl(e))>=0?e.ownerDocument.body:wo(e)&&Q9(e)?e:Tfe(s2(e))}function Kb(e,t){var r;t===void 0&&(t=[]);var n=Tfe(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),i=Ps(n),s=a?[i].concat(i.visualViewport||[],Q9(n)?n:[]):n,l=t.concat(s);return a?l:l.concat(Kb(s2(s)))}function HR(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function b7e(e,t){var r=Ag(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function PJ(e,t,r){return t===Sfe?HR(g7e(e,r)):Th(t)?b7e(t,r):HR(v7e(Kd(e)))}function y7e(e){var t=Kb(s2(e)),r=["absolute","fixed"].indexOf(ou(e).position)>=0,n=r&&wo(e)?i1(e):e;return Th(n)?t.filter(function(a){return Th(a)&&Cfe(a,n)&&Rl(a)!=="body"}):[]}function x7e(e,t,r,n){var a=t==="clippingParents"?y7e(e):[].concat(t),i=[].concat(a,[r]),s=i[0],l=i.reduce(function(c,u){var d=PJ(e,u,n);return c.top=ch(d.top,c.top),c.right=YN(d.right,c.right),c.bottom=YN(d.bottom,c.bottom),c.left=ch(d.left,c.left),c},PJ(e,s,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Afe(e){var t=e.reference,r=e.element,n=e.placement,a=n?Nl(n):null,i=n?Dg(n):null,s=t.x+t.width/2-r.width/2,l=t.y+t.height/2-r.height/2,c;switch(a){case as:c={x:s,y:t.y-r.height};break;case _o:c={x:s,y:t.y+t.height};break;case No:c={x:t.x+t.width,y:l};break;case is:c={x:t.x-r.width,y:l};break;default:c={x:t.x,y:t.y}}var u=a?G9(a):null;if(u!=null){var d=u==="y"?"height":"width";switch(i){case Mg:c[u]=c[u]-(t[d]/2-r[d]/2);break;case rx:c[u]=c[u]+(t[d]/2-r[d]/2);break}}return c}function nx(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,i=r.strategy,s=i===void 0?e.strategy:i,l=r.boundary,c=l===void 0?Fqe:l,u=r.rootBoundary,d=u===void 0?Sfe:u,f=r.elementContext,m=f===void 0?Tv:f,p=r.altBoundary,v=p===void 0?!1:p,b=r.padding,y=b===void 0?0:b,S=Efe(typeof y!="number"?y:Mfe(y,a1)),_=m===Tv?Uqe:Tv,N=e.rects.popper,k=e.elements[v?_:m],j=x7e(Th(k)?k:k.contextElement||Kd(e.elements.popper),c,d,s),E=Ag(e.elements.reference),T=Afe({reference:E,element:N,placement:a}),O=HR(Object.assign({},N,T)),R=m===Tv?O:E,q={top:j.top-R.top+S.top,bottom:R.bottom-j.bottom+S.bottom,left:j.left-R.left+S.left,right:R.right-j.right+S.right},$=e.modifiersData.offset;if(m===Tv&&$){var L=$[a];Object.keys(q).forEach(function(A){var M=[No,_o].indexOf(A)>=0?1:-1,z=[as,_o].indexOf(A)>=0?"y":"x";q[A]+=L[z]*M})}return q}function w7e(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,i=r.rootBoundary,s=r.padding,l=r.flipVariations,c=r.allowedAutoPlacements,u=c===void 0?kfe:c,d=Dg(n),f=d?l?LJ:LJ.filter(function(v){return Dg(v)===d}):a1,m=f.filter(function(v){return u.indexOf(v)>=0});m.length===0&&(m=f);var p=m.reduce(function(v,b){return v[b]=nx(e,{placement:b,boundary:a,rootBoundary:i,padding:s})[Nl(b)],v},{});return Object.keys(p).sort(function(v,b){return p[v]-p[b]})}function S7e(e){if(Nl(e)===q9)return[];var t=Sk(e);return[RJ(e),t,RJ(t)]}function k7e(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,i=a===void 0?!0:a,s=r.altAxis,l=s===void 0?!0:s,c=r.fallbackPlacements,u=r.padding,d=r.boundary,f=r.rootBoundary,m=r.altBoundary,p=r.flipVariations,v=p===void 0?!0:p,b=r.allowedAutoPlacements,y=t.options.placement,S=Nl(y),_=S===y,N=c||(_||!v?[Sk(y)]:S7e(y)),k=[y].concat(N).reduce(function(ee,Y){return ee.concat(Nl(Y)===q9?w7e(t,{placement:Y,boundary:d,rootBoundary:f,padding:u,flipVariations:v,allowedAutoPlacements:b}):Y)},[]),j=t.rects.reference,E=t.rects.popper,T=new Map,O=!0,R=k[0],q=0;q<k.length;q++){var $=k[q],L=Nl($),A=Dg($)===Mg,M=[as,_o].indexOf(L)>=0,z=M?"width":"height",I=nx(t,{placement:$,boundary:d,rootBoundary:f,altBoundary:m,padding:u}),B=M?A?No:is:A?_o:as;j[z]>E[z]&&(B=Sk(B));var F=Sk(B),U=[];if(i&&U.push(I[L]<=0),l&&U.push(I[B]<=0,I[F]<=0),U.every(function(ee){return ee})){R=$,O=!1;break}T.set($,U)}if(O)for(var V=v?3:1,K=function(Y){var ie=k.find(function(fe){var me=T.get(fe);if(me)return me.slice(0,Y).every(function(te){return te})});if(ie)return R=ie,"break"},G=V;G>0;G--){var J=K(G);if(J==="break")break}t.placement!==R&&(t.modifiersData[n]._skip=!0,t.placement=R,t.reset=!0)}}const _7e={name:"flip",enabled:!0,phase:"main",fn:k7e,requiresIfExists:["offset"],data:{_skip:!1}};function zJ(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function BJ(e){return[as,No,_o,is].some(function(t){return e[t]>=0})}function N7e(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,i=t.modifiersData.preventOverflow,s=nx(t,{elementContext:"reference"}),l=nx(t,{altBoundary:!0}),c=zJ(s,n),u=zJ(l,a,i),d=BJ(c),f=BJ(u);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:d,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":f})}const C7e={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:N7e};function j7e(e,t,r){var n=Nl(e),a=[is,as].indexOf(n)>=0?-1:1,i=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,s=i[0],l=i[1];return s=s||0,l=(l||0)*a,[is,No].indexOf(n)>=0?{x:l,y:s}:{x:s,y:l}}function E7e(e){var t=e.state,r=e.options,n=e.name,a=r.offset,i=a===void 0?[0,0]:a,s=kfe.reduce(function(d,f){return d[f]=j7e(f,t.rects,i),d},{}),l=s[t.placement],c=l.x,u=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=s}const M7e={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:E7e};function T7e(e){var t=e.state,r=e.name;t.modifiersData[r]=Afe({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const A7e={name:"popperOffsets",enabled:!0,phase:"read",fn:T7e,data:{}};function D7e(e){return e==="x"?"y":"x"}function L7e(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,i=a===void 0?!0:a,s=r.altAxis,l=s===void 0?!1:s,c=r.boundary,u=r.rootBoundary,d=r.altBoundary,f=r.padding,m=r.tether,p=m===void 0?!0:m,v=r.tetherOffset,b=v===void 0?0:v,y=nx(t,{boundary:c,rootBoundary:u,padding:f,altBoundary:d}),S=Nl(t.placement),_=Dg(t.placement),N=!_,k=G9(S),j=D7e(k),E=t.modifiersData.popperOffsets,T=t.rects.reference,O=t.rects.popper,R=typeof b=="function"?b(Object.assign({},t.rects,{placement:t.placement})):b,q=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),$=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,L={x:0,y:0};if(E){if(i){var A,M=k==="y"?as:is,z=k==="y"?_o:No,I=k==="y"?"height":"width",B=E[k],F=B+y[M],U=B-y[z],V=p?-O[I]/2:0,K=_===Mg?T[I]:O[I],G=_===Mg?-O[I]:-T[I],J=t.elements.arrow,ee=p&&J?K9(J):{width:0,height:0},Y=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:jfe(),ie=Y[M],fe=Y[z],me=Wb(0,T[I],ee[I]),te=N?T[I]/2-V-me-ie-q.mainAxis:K-me-ie-q.mainAxis,oe=N?-T[I]/2+V+me+fe+q.mainAxis:G+me+fe+q.mainAxis,ce=t.elements.arrow&&i1(t.elements.arrow),Z=ce?k==="y"?ce.clientTop||0:ce.clientLeft||0:0,ue=(A=$?.[k])!=null?A:0,H=B+te-ue-Z,ge=B+oe-ue,de=Wb(p?YN(F,H):F,B,p?ch(U,ge):U);E[k]=de,L[k]=de-B}if(l){var re,ne=k==="x"?as:is,pe=k==="x"?_o:No,ke=E[j],we=j==="y"?"height":"width",ve=ke+y[ne],Le=ke-y[pe],Ae=[as,is].indexOf(S)!==-1,Re=(re=$?.[j])!=null?re:0,Ye=Ae?ve:ke-T[we]-O[we]-Re+q.altAxis,mt=Ae?ke+T[we]+O[we]-Re-q.altAxis:Le,ot=p&&Ae?n7e(Ye,ke,mt):Wb(p?Ye:ve,ke,p?mt:Le);E[j]=ot,L[j]=ot-ke}t.modifiersData[n]=L}}const O7e={name:"preventOverflow",enabled:!0,phase:"main",fn:L7e,requiresIfExists:["offset"]};function I7e(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function R7e(e){return e===Ps(e)||!wo(e)?V9(e):I7e(e)}function P7e(e){var t=e.getBoundingClientRect(),r=Tg(t.width)/e.offsetWidth||1,n=Tg(t.height)/e.offsetHeight||1;return r!==1||n!==1}function z7e(e,t,r){r===void 0&&(r=!1);var n=wo(t),a=wo(t)&&P7e(t),i=Kd(t),s=Ag(e,a,r),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Rl(t)!=="body"||Q9(i))&&(l=R7e(t)),wo(t)?(c=Ag(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=Y9(i))),{x:s.left+l.scrollLeft-c.x,y:s.top+l.scrollTop-c.y,width:s.width,height:s.height}}function B7e(e){var t=new Map,r=new Set,n=[];e.forEach(function(i){t.set(i.name,i)});function a(i){r.add(i.name);var s=[].concat(i.requires||[],i.requiresIfExists||[]);s.forEach(function(l){if(!r.has(l)){var c=t.get(l);c&&a(c)}}),n.push(i)}return e.forEach(function(i){r.has(i.name)||a(i)}),n}function $7e(e){var t=B7e(e);return Zqe.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function F7e(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function U7e(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var $J={placement:"bottom",modifiers:[],strategy:"absolute"};function FJ(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function H7e(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,i=a===void 0?$J:a;return function(l,c,u){u===void 0&&(u=i);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},$J,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},f=[],m=!1,p={state:d,setOptions:function(S){var _=typeof S=="function"?S(d.options):S;b(),d.options=Object.assign({},i,d.options,_),d.scrollParents={reference:Th(l)?Kb(l):l.contextElement?Kb(l.contextElement):[],popper:Kb(c)};var N=$7e(U7e([].concat(n,d.options.modifiers)));return d.orderedModifiers=N.filter(function(k){return k.enabled}),v(),p.update()},forceUpdate:function(){if(!m){var S=d.elements,_=S.reference,N=S.popper;if(FJ(_,N)){d.rects={reference:z7e(_,i1(N),d.options.strategy==="fixed"),popper:K9(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(q){return d.modifiersData[q.name]=Object.assign({},q.data)});for(var k=0;k<d.orderedModifiers.length;k++){if(d.reset===!0){d.reset=!1,k=-1;continue}var j=d.orderedModifiers[k],E=j.fn,T=j.options,O=T===void 0?{}:T,R=j.name;typeof E=="function"&&(d=E({state:d,options:O,name:R,instance:p})||d)}}}},update:F7e(function(){return new Promise(function(y){p.forceUpdate(),y(d)})}),destroy:function(){b(),m=!0}};if(!FJ(l,c))return p;p.setOptions(u).then(function(y){!m&&u.onFirstUpdate&&u.onFirstUpdate(y)});function v(){d.orderedModifiers.forEach(function(y){var S=y.name,_=y.options,N=_===void 0?{}:_,k=y.effect;if(typeof k=="function"){var j=k({state:d,name:S,instance:p,options:N}),E=function(){};f.push(j||E)}})}function b(){f.forEach(function(y){return y()}),f=[]}return p}}var q7e=[h7e,A7e,d7e,_fe,M7e,_7e,O7e,o7e,C7e],W7e=H7e({defaultModifiers:q7e}),K7e="tippy-box",Dfe="tippy-content",G7e="tippy-backdrop",Lfe="tippy-arrow",Ofe="tippy-svg-arrow",Pf={passive:!0,capture:!0},Ife=function(){return document.body};function XD(e,t,r){if(Array.isArray(e)){var n=e[t];return n??(Array.isArray(r)?r[t]:r)}return e}function J9(e,t){var r={}.toString.call(e);return r.indexOf("[object")===0&&r.indexOf(t+"]")>-1}function Rfe(e,t){return typeof e=="function"?e.apply(void 0,t):e}function UJ(e,t){if(t===0)return e;var r;return function(n){clearTimeout(r),r=setTimeout(function(){e(n)},t)}}function V7e(e){return e.split(/\s+/).filter(Boolean)}function wp(e){return[].concat(e)}function HJ(e,t){e.indexOf(t)===-1&&e.push(t)}function Y7e(e){return e.filter(function(t,r){return e.indexOf(t)===r})}function Q7e(e){return e.split("-")[0]}function QN(e){return[].slice.call(e)}function qJ(e){return Object.keys(e).reduce(function(t,r){return e[r]!==void 0&&(t[r]=e[r]),t},{})}function Gb(){return document.createElement("div")}function o2(e){return["Element","Fragment"].some(function(t){return J9(e,t)})}function J7e(e){return J9(e,"NodeList")}function Z7e(e){return J9(e,"MouseEvent")}function X7e(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function eWe(e){return o2(e)?[e]:J7e(e)?QN(e):Array.isArray(e)?e:QN(document.querySelectorAll(e))}function eL(e,t){e.forEach(function(r){r&&(r.style.transitionDuration=t+"ms")})}function WJ(e,t){e.forEach(function(r){r&&r.setAttribute("data-state",t)})}function tWe(e){var t,r=wp(e),n=r[0];return n!=null&&(t=n.ownerDocument)!=null&&t.body?n.ownerDocument:document}function rWe(e,t){var r=t.clientX,n=t.clientY;return e.every(function(a){var i=a.popperRect,s=a.popperState,l=a.props,c=l.interactiveBorder,u=Q7e(s.placement),d=s.modifiersData.offset;if(!d)return!0;var f=u==="bottom"?d.top.y:0,m=u==="top"?d.bottom.y:0,p=u==="right"?d.left.x:0,v=u==="left"?d.right.x:0,b=i.top-n+f>c,y=n-i.bottom-m>c,S=i.left-r+p>c,_=r-i.right-v>c;return b||y||S||_})}function tL(e,t,r){var n=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(a){e[n](a,r)})}function KJ(e,t){for(var r=t;r;){var n;if(e.contains(r))return!0;r=r.getRootNode==null||(n=r.getRootNode())==null?void 0:n.host}return!1}var bl={isTouch:!1},GJ=0;function nWe(){bl.isTouch||(bl.isTouch=!0,window.performance&&document.addEventListener("mousemove",Pfe))}function Pfe(){var e=performance.now();e-GJ<20&&(bl.isTouch=!1,document.removeEventListener("mousemove",Pfe)),GJ=e}function aWe(){var e=document.activeElement;if(X7e(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function iWe(){document.addEventListener("touchstart",nWe,Pf),window.addEventListener("blur",aWe)}var sWe=typeof window<"u"&&typeof document<"u",oWe=sWe?!!window.msCrypto:!1,lWe={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},cWe={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ko=Object.assign({appendTo:Ife,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},lWe,cWe),uWe=Object.keys(Ko),dWe=function(t){var r=Object.keys(t);r.forEach(function(n){Ko[n]=t[n]})};function zfe(e){var t=e.plugins||[],r=t.reduce(function(n,a){var i=a.name,s=a.defaultValue;if(i){var l;n[i]=e[i]!==void 0?e[i]:(l=Ko[i])!=null?l:s}return n},{});return Object.assign({},e,r)}function fWe(e,t){var r=t?Object.keys(zfe(Object.assign({},Ko,{plugins:t}))):uWe,n=r.reduce(function(a,i){var s=(e.getAttribute("data-tippy-"+i)||"").trim();if(!s)return a;if(i==="content")a[i]=s;else try{a[i]=JSON.parse(s)}catch{a[i]=s}return a},{});return n}function VJ(e,t){var r=Object.assign({},t,{content:Rfe(t.content,[e])},t.ignoreAttributes?{}:fWe(e,t.plugins));return r.aria=Object.assign({},Ko.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?t.interactive:r.aria.expanded,content:r.aria.content==="auto"?t.interactive?null:"describedby":r.aria.content},r}var hWe=function(){return"innerHTML"};function qR(e,t){e[hWe()]=t}function YJ(e){var t=Gb();return e===!0?t.className=Lfe:(t.className=Ofe,o2(e)?t.appendChild(e):qR(t,e)),t}function QJ(e,t){o2(t.content)?(qR(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?qR(e,t.content):e.textContent=t.content)}function WR(e){var t=e.firstElementChild,r=QN(t.children);return{box:t,content:r.find(function(n){return n.classList.contains(Dfe)}),arrow:r.find(function(n){return n.classList.contains(Lfe)||n.classList.contains(Ofe)}),backdrop:r.find(function(n){return n.classList.contains(G7e)})}}function Bfe(e){var t=Gb(),r=Gb();r.className=K7e,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Gb();n.className=Dfe,n.setAttribute("data-state","hidden"),QJ(n,e.props),t.appendChild(r),r.appendChild(n),a(e.props,e.props);function a(i,s){var l=WR(t),c=l.box,u=l.content,d=l.arrow;s.theme?c.setAttribute("data-theme",s.theme):c.removeAttribute("data-theme"),typeof s.animation=="string"?c.setAttribute("data-animation",s.animation):c.removeAttribute("data-animation"),s.inertia?c.setAttribute("data-inertia",""):c.removeAttribute("data-inertia"),c.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?c.setAttribute("role",s.role):c.removeAttribute("role"),(i.content!==s.content||i.allowHTML!==s.allowHTML)&&QJ(u,e.props),s.arrow?d?i.arrow!==s.arrow&&(c.removeChild(d),c.appendChild(YJ(s.arrow))):c.appendChild(YJ(s.arrow)):d&&c.removeChild(d)}return{popper:t,onUpdate:a}}Bfe.$$tippy=!0;var mWe=1,NS=[],rL=[];function pWe(e,t){var r=VJ(e,Object.assign({},Ko,zfe(qJ(t)))),n,a,i,s=!1,l=!1,c=!1,u=!1,d,f,m,p=[],v=UJ(H,r.interactiveDebounce),b,y=mWe++,S=null,_=Y7e(r.plugins),N={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},k={id:y,reference:e,popper:Gb(),popperInstance:S,props:r,state:N,plugins:_,clearDelayTimeouts:Ye,setProps:mt,setContent:ot,show:Ot,hide:rt,hideWithInteractivity:ze,enable:Ae,disable:Re,unmount:bt,destroy:tt};if(!r.render)return k;var j=r.render(k),E=j.popper,T=j.onUpdate;E.setAttribute("data-tippy-root",""),E.id="tippy-"+k.id,k.popper=E,e._tippy=k,E._tippy=k;var O=_.map(function(_e){return _e.fn(k)}),R=e.hasAttribute("aria-expanded");return ce(),V(),B(),F("onCreate",[k]),r.showOnCreate&&ve(),E.addEventListener("mouseenter",function(){k.props.interactive&&k.state.isVisible&&k.clearDelayTimeouts()}),E.addEventListener("mouseleave",function(){k.props.interactive&&k.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",v)}),k;function q(){var _e=k.props.touch;return Array.isArray(_e)?_e:[_e,0]}function $(){return q()[0]==="hold"}function L(){var _e;return!!((_e=k.props.render)!=null&&_e.$$tippy)}function A(){return b||e}function M(){var _e=A().parentNode;return _e?tWe(_e):document}function z(){return WR(E)}function I(_e){return k.state.isMounted&&!k.state.isVisible||bl.isTouch||d&&d.type==="focus"?0:XD(k.props.delay,_e?0:1,Ko.delay)}function B(_e){_e===void 0&&(_e=!1),E.style.pointerEvents=k.props.interactive&&!_e?"":"none",E.style.zIndex=""+k.props.zIndex}function F(_e,We,Ve){if(Ve===void 0&&(Ve=!0),O.forEach(function(kt){kt[_e]&&kt[_e].apply(kt,We)}),Ve){var Mt;(Mt=k.props)[_e].apply(Mt,We)}}function U(){var _e=k.props.aria;if(_e.content){var We="aria-"+_e.content,Ve=E.id,Mt=wp(k.props.triggerTarget||e);Mt.forEach(function(kt){var er=kt.getAttribute(We);if(k.state.isVisible)kt.setAttribute(We,er?er+" "+Ve:Ve);else{var mr=er&&er.replace(Ve,"").trim();mr?kt.setAttribute(We,mr):kt.removeAttribute(We)}})}}function V(){if(!(R||!k.props.aria.expanded)){var _e=wp(k.props.triggerTarget||e);_e.forEach(function(We){k.props.interactive?We.setAttribute("aria-expanded",k.state.isVisible&&We===A()?"true":"false"):We.removeAttribute("aria-expanded")})}}function K(){M().removeEventListener("mousemove",v),NS=NS.filter(function(_e){return _e!==v})}function G(_e){if(!(bl.isTouch&&(c||_e.type==="mousedown"))){var We=_e.composedPath&&_e.composedPath()[0]||_e.target;if(!(k.props.interactive&&KJ(E,We))){if(wp(k.props.triggerTarget||e).some(function(Ve){return KJ(Ve,We)})){if(bl.isTouch||k.state.isVisible&&k.props.trigger.indexOf("click")>=0)return}else F("onClickOutside",[k,_e]);k.props.hideOnClick===!0&&(k.clearDelayTimeouts(),k.hide(),l=!0,setTimeout(function(){l=!1}),k.state.isMounted||ie())}}}function J(){c=!0}function ee(){c=!1}function Y(){var _e=M();_e.addEventListener("mousedown",G,!0),_e.addEventListener("touchend",G,Pf),_e.addEventListener("touchstart",ee,Pf),_e.addEventListener("touchmove",J,Pf)}function ie(){var _e=M();_e.removeEventListener("mousedown",G,!0),_e.removeEventListener("touchend",G,Pf),_e.removeEventListener("touchstart",ee,Pf),_e.removeEventListener("touchmove",J,Pf)}function fe(_e,We){te(_e,function(){!k.state.isVisible&&E.parentNode&&E.parentNode.contains(E)&&We()})}function me(_e,We){te(_e,We)}function te(_e,We){var Ve=z().box;function Mt(kt){kt.target===Ve&&(tL(Ve,"remove",Mt),We())}if(_e===0)return We();tL(Ve,"remove",f),tL(Ve,"add",Mt),f=Mt}function oe(_e,We,Ve){Ve===void 0&&(Ve=!1);var Mt=wp(k.props.triggerTarget||e);Mt.forEach(function(kt){kt.addEventListener(_e,We,Ve),p.push({node:kt,eventType:_e,handler:We,options:Ve})})}function ce(){$()&&(oe("touchstart",ue,{passive:!0}),oe("touchend",ge,{passive:!0})),V7e(k.props.trigger).forEach(function(_e){if(_e!=="manual")switch(oe(_e,ue),_e){case"mouseenter":oe("mouseleave",ge);break;case"focus":oe(oWe?"focusout":"blur",de);break;case"focusin":oe("focusout",de);break}})}function Z(){p.forEach(function(_e){var We=_e.node,Ve=_e.eventType,Mt=_e.handler,kt=_e.options;We.removeEventListener(Ve,Mt,kt)}),p=[]}function ue(_e){var We,Ve=!1;if(!(!k.state.isEnabled||re(_e)||l)){var Mt=((We=d)==null?void 0:We.type)==="focus";d=_e,b=_e.currentTarget,V(),!k.state.isVisible&&Z7e(_e)&&NS.forEach(function(kt){return kt(_e)}),_e.type==="click"&&(k.props.trigger.indexOf("mouseenter")<0||s)&&k.props.hideOnClick!==!1&&k.state.isVisible?Ve=!0:ve(_e),_e.type==="click"&&(s=!Ve),Ve&&!Mt&&Le(_e)}}function H(_e){var We=_e.target,Ve=A().contains(We)||E.contains(We);if(!(_e.type==="mousemove"&&Ve)){var Mt=we().concat(E).map(function(kt){var er,mr=kt._tippy,Zt=(er=mr.popperInstance)==null?void 0:er.state;return Zt?{popperRect:kt.getBoundingClientRect(),popperState:Zt,props:r}:null}).filter(Boolean);rWe(Mt,_e)&&(K(),Le(_e))}}function ge(_e){var We=re(_e)||k.props.trigger.indexOf("click")>=0&&s;if(!We){if(k.props.interactive){k.hideWithInteractivity(_e);return}Le(_e)}}function de(_e){k.props.trigger.indexOf("focusin")<0&&_e.target!==A()||k.props.interactive&&_e.relatedTarget&&E.contains(_e.relatedTarget)||Le(_e)}function re(_e){return bl.isTouch?$()!==_e.type.indexOf("touch")>=0:!1}function ne(){pe();var _e=k.props,We=_e.popperOptions,Ve=_e.placement,Mt=_e.offset,kt=_e.getReferenceClientRect,er=_e.moveTransition,mr=L()?WR(E).arrow:null,Zt=kt?{getBoundingClientRect:kt,contextElement:kt.contextElement||A()}:e,Wt={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(De){var Ue=De.state;if(L()){var ut=z(),St=ut.box;["placement","reference-hidden","escaped"].forEach(function(jt){jt==="placement"?St.setAttribute("data-placement",Ue.placement):Ue.attributes.popper["data-popper-"+jt]?St.setAttribute("data-"+jt,""):St.removeAttribute("data-"+jt)}),Ue.attributes.popper={}}}},Rt=[{name:"offset",options:{offset:Mt}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!er}},Wt];L()&&mr&&Rt.push({name:"arrow",options:{element:mr,padding:3}}),Rt.push.apply(Rt,We?.modifiers||[]),k.popperInstance=W7e(Zt,E,Object.assign({},We,{placement:Ve,onFirstUpdate:m,modifiers:Rt}))}function pe(){k.popperInstance&&(k.popperInstance.destroy(),k.popperInstance=null)}function ke(){var _e=k.props.appendTo,We,Ve=A();k.props.interactive&&_e===Ife||_e==="parent"?We=Ve.parentNode:We=Rfe(_e,[Ve]),We.contains(E)||We.appendChild(E),k.state.isMounted=!0,ne()}function we(){return QN(E.querySelectorAll("[data-tippy-root]"))}function ve(_e){k.clearDelayTimeouts(),_e&&F("onTrigger",[k,_e]),Y();var We=I(!0),Ve=q(),Mt=Ve[0],kt=Ve[1];bl.isTouch&&Mt==="hold"&&kt&&(We=kt),We?n=setTimeout(function(){k.show()},We):k.show()}function Le(_e){if(k.clearDelayTimeouts(),F("onUntrigger",[k,_e]),!k.state.isVisible){ie();return}if(!(k.props.trigger.indexOf("mouseenter")>=0&&k.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(_e.type)>=0&&s)){var We=I(!1);We?a=setTimeout(function(){k.state.isVisible&&k.hide()},We):i=requestAnimationFrame(function(){k.hide()})}}function Ae(){k.state.isEnabled=!0}function Re(){k.hide(),k.state.isEnabled=!1}function Ye(){clearTimeout(n),clearTimeout(a),cancelAnimationFrame(i)}function mt(_e){if(!k.state.isDestroyed){F("onBeforeUpdate",[k,_e]),Z();var We=k.props,Ve=VJ(e,Object.assign({},We,qJ(_e),{ignoreAttributes:!0}));k.props=Ve,ce(),We.interactiveDebounce!==Ve.interactiveDebounce&&(K(),v=UJ(H,Ve.interactiveDebounce)),We.triggerTarget&&!Ve.triggerTarget?wp(We.triggerTarget).forEach(function(Mt){Mt.removeAttribute("aria-expanded")}):Ve.triggerTarget&&e.removeAttribute("aria-expanded"),V(),B(),T&&T(We,Ve),k.popperInstance&&(ne(),we().forEach(function(Mt){requestAnimationFrame(Mt._tippy.popperInstance.forceUpdate)})),F("onAfterUpdate",[k,_e])}}function ot(_e){k.setProps({content:_e})}function Ot(){var _e=k.state.isVisible,We=k.state.isDestroyed,Ve=!k.state.isEnabled,Mt=bl.isTouch&&!k.props.touch,kt=XD(k.props.duration,0,Ko.duration);if(!(_e||We||Ve||Mt)&&!A().hasAttribute("disabled")&&(F("onShow",[k],!1),k.props.onShow(k)!==!1)){if(k.state.isVisible=!0,L()&&(E.style.visibility="visible"),B(),Y(),k.state.isMounted||(E.style.transition="none"),L()){var er=z(),mr=er.box,Zt=er.content;eL([mr,Zt],0)}m=function(){var Rt;if(!(!k.state.isVisible||u)){if(u=!0,E.offsetHeight,E.style.transition=k.props.moveTransition,L()&&k.props.animation){var he=z(),De=he.box,Ue=he.content;eL([De,Ue],kt),WJ([De,Ue],"visible")}U(),V(),HJ(rL,k),(Rt=k.popperInstance)==null||Rt.forceUpdate(),F("onMount",[k]),k.props.animation&&L()&&me(kt,function(){k.state.isShown=!0,F("onShown",[k])})}},ke()}}function rt(){var _e=!k.state.isVisible,We=k.state.isDestroyed,Ve=!k.state.isEnabled,Mt=XD(k.props.duration,1,Ko.duration);if(!(_e||We||Ve)&&(F("onHide",[k],!1),k.props.onHide(k)!==!1)){if(k.state.isVisible=!1,k.state.isShown=!1,u=!1,s=!1,L()&&(E.style.visibility="hidden"),K(),ie(),B(!0),L()){var kt=z(),er=kt.box,mr=kt.content;k.props.animation&&(eL([er,mr],Mt),WJ([er,mr],"hidden"))}U(),V(),k.props.animation?L()&&fe(Mt,k.unmount):k.unmount()}}function ze(_e){M().addEventListener("mousemove",v),HJ(NS,v),v(_e)}function bt(){k.state.isVisible&&k.hide(),k.state.isMounted&&(pe(),we().forEach(function(_e){_e._tippy.unmount()}),E.parentNode&&E.parentNode.removeChild(E),rL=rL.filter(function(_e){return _e!==k}),k.state.isMounted=!1,F("onHidden",[k]))}function tt(){k.state.isDestroyed||(k.clearDelayTimeouts(),k.unmount(),Z(),delete e._tippy,k.state.isDestroyed=!0,F("onDestroy",[k]))}}function em(e,t){t===void 0&&(t={});var r=Ko.plugins.concat(t.plugins||[]);iWe();var n=Object.assign({},t,{plugins:r}),a=eWe(e),i=a.reduce(function(s,l){var c=l&&pWe(l,n);return c&&s.push(c),s},[]);return o2(e)?i[0]:i}em.defaultProps=Ko;em.setDefaultProps=dWe;em.currentInput=bl;Object.assign({},_fe,{effect:function(t){var r=t.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow)}});em.setDefaultProps({render:Bfe});const gWe=e=>[{id:"bold",title:"Bold",description:"Make text bold",icon:o.jsx(_O,{className:"w-4 h-4"}),category:"formatting",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleBold().run()}},{id:"italic",title:"Italic",description:"Make text italic",icon:o.jsx(NO,{className:"w-4 h-4"}),category:"formatting",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleItalic().run()}},{id:"code",title:"Inline Code",description:"Format as inline code",icon:o.jsx(Kp,{className:"w-4 h-4"}),category:"formatting",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleCode().run()}},{id:"codeblock",title:"Code Block",description:"Insert a code block",icon:o.jsx(Bs,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleCodeBlock().run()}},{id:"quote",title:"Quote",description:"Insert a block quote",icon:o.jsx(Rae,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleBlockquote().run()}},{id:"bullet",title:"Bullet List",description:"Create a simple bullet list",icon:o.jsx(Wp,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleBulletList().run()}},{id:"numbered",title:"Numbered List",description:"Create a numbered list",icon:o.jsx(Pae,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleOrderedList().run()}},{id:"emoji",title:"Emoji",description:"Insert an emoji",icon:o.jsx(twe,{className:"w-4 h-4"}),category:"media",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).run(),e?.onEmojiInsert&&e.onEmojiInsert()}},{id:"task",title:"Task",description:"Reference a task",icon:o.jsx(Tl,{className:"w-4 h-4"}),category:"embeds",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).run(),e?.onTaskEmbed&&e.onTaskEmbed()}},{id:"doc",title:"Document",description:"Reference a document",icon:o.jsx(rn,{className:"w-4 h-4"}),category:"embeds",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).run(),e?.onDocumentEmbed&&e.onDocumentEmbed()}}];function vWe(e,t){if(!e)return t;const r=e.toLowerCase();return t.filter(n=>{const a=n.title.toLowerCase().includes(r),i=n.description.toLowerCase().includes(r),s=n.id.toLowerCase().includes(r);return a||i||s})}function bWe(e){const t={formatting:[],blocks:[],media:[],embeds:[]};for(const r of e)t[r.category]&&t[r.category].push(r);return t}const yWe={formatting:"Formatting",blocks:"Blocks",media:"Media",embeds:"Embeds"},$fe=w.forwardRef(({items:e,command:t},r)=>{const[n,a]=w.useState(0);w.useEffect(()=>{a(0)},[e]);const i=w.useCallback(c=>{const u=e[c];u&&t(u)},[e,t]);if(w.useImperativeHandle(r,()=>({onKeyDown:({event:c})=>c.key==="ArrowUp"?(a(u=>u<=0?e.length-1:u-1),!0):c.key==="ArrowDown"?(a(u=>u>=e.length-1?0:u+1),!0):c.key==="Enter"?(i(n),!0):c.key==="Escape"})),!e.length)return o.jsx("div",{"data-testid":"message-slash-command-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[240px]",children:o.jsx("div",{className:"text-sm text-gray-500",children:"No matching commands"})});const s=bWe(e);let l=0;return o.jsx("div",{"data-testid":"message-slash-command-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-1 min-w-[240px] max-h-[300px] overflow-y-auto",children:Object.entries(s).map(([c,u])=>u.length===0?null:o.jsxs("div",{"data-testid":`message-slash-category-${c}`,children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:yWe[c]}),u.map(d=>{const f=l++,m=f===n;return o.jsxs("button",{"data-testid":`message-slash-item-${d.id}`,className:`w-full flex items-start gap-3 px-3 py-2 rounded text-left transition-colors ${m?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:p=>{p.preventDefault(),p.stopPropagation(),i(f)},onMouseDown:p=>{p.preventDefault()},onMouseEnter:()=>a(f),children:[o.jsx("div",{className:`mt-0.5 flex-shrink-0 ${m?"text-blue-600":"text-gray-400"}`,children:d.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium",children:d.title}),o.jsx("div",{className:"text-xs text-gray-500 truncate",children:d.description})]})]},d.id)})]},c))})});$fe.displayName="MessageSlashCommandMenu";function xWe(e){return{char:"/",startOfLine:!1,items:({query:t})=>{const r=gWe(e);return vWe(t,r)},render:()=>{let t=null,r=null;return{onStart:n=>{t=new E9($fe,{props:{items:n.items,command:n.command},editor:n.editor}),n.clientRect&&(r=em(document.body,{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"top-start",animation:"fade",zIndex:9999}))},onUpdate:n=>{t&&t.updateProps({items:n.items,command:n.command}),r&&n.clientRect&&r.setProps({getReferenceClientRect:n.clientRect})},onKeyDown:n=>n.event.key==="Escape"?(r?.hide(),!0):t?.ref?t.ref.onKeyDown(n):!1,onExit:()=>{r?.destroy(),t?.destroy()}}},command:({editor:t,range:r,props:n})=>{n.action({editor:t,range:r})}}}const wWe=new Gr("messageSlashCommands"),SWe=zr.create({name:"messageSlashCommands",addOptions(){return{embedCallbacks:void 0}},addProseMirrorPlugins(){return[H9({editor:this.editor,pluginKey:wWe,...xWe(this.options.embedCallbacks)})]}}),Ffe=w.forwardRef(({items:e,command:t,isLoading:r=!1,query:n=""},a)=>{const[i,s]=w.useState(0);w.useEffect(()=>{s(0)},[e]);const l=w.useCallback(f=>{const m=e[f];m&&t(m)},[e,t]);if(w.useImperativeHandle(a,()=>({onKeyDown:({event:f})=>f.key==="ArrowUp"?(s(m=>m<=0?e.length-1:m-1),!0):f.key==="ArrowDown"?(s(m=>m>=e.length-1?0:m+1),!0):f.key==="Enter"?(e.length>0&&l(i),!0):f.key==="Escape"})),r)return o.jsx("div",{"data-testid":"hash-autocomplete-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[280px]",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),o.jsx("span",{children:"Searching..."})]})});if(!e.length)return o.jsx("div",{"data-testid":"hash-autocomplete-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[280px]",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx(br,{className:"w-4 h-4"}),o.jsx("span",{children:n?`No results for "${n}"`:"Type to search tasks and documents"})]})});const c=e.filter(f=>f.type==="task"),u=e.filter(f=>f.type==="document");let d=0;return o.jsxs("div",{"data-testid":"hash-autocomplete-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-1 min-w-[280px] max-h-[300px] overflow-y-auto",children:[c.length>0&&o.jsxs("div",{"data-testid":"hash-autocomplete-tasks",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Tasks"}),c.map(f=>{const m=d++,p=m===i;return o.jsxs("button",{"data-testid":`hash-item-task-${f.id}`,className:`w-full flex items-start gap-3 px-3 py-2 rounded text-left transition-colors ${p?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:v=>{v.preventDefault(),v.stopPropagation(),l(m)},onMouseDown:v=>{v.preventDefault()},onMouseEnter:()=>s(m),children:[o.jsx("div",{className:`mt-0.5 flex-shrink-0 ${p?"text-blue-600":"text-gray-400"}`,children:f.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:f.title}),f.subtitle&&o.jsx("div",{className:"text-xs text-gray-500 truncate",children:f.subtitle})]})]},`task-${f.id}`)})]}),u.length>0&&o.jsxs("div",{"data-testid":"hash-autocomplete-documents",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Documents"}),u.map(f=>{const m=d++,p=m===i;return o.jsxs("button",{"data-testid":`hash-item-doc-${f.id}`,className:`w-full flex items-start gap-3 px-3 py-2 rounded text-left transition-colors ${p?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:v=>{v.preventDefault(),v.stopPropagation(),l(m)},onMouseDown:v=>{v.preventDefault()},onMouseEnter:()=>s(m),children:[o.jsx("div",{className:`mt-0.5 flex-shrink-0 ${p?"text-blue-600":"text-gray-400"}`,children:f.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:f.title}),f.subtitle&&o.jsx("div",{className:"text-xs text-gray-500 truncate",children:f.subtitle})]})]},`doc-${f.id}`)})]})]})});Ffe.displayName="HashAutocompleteMenu";async function JJ(e){return[]}function kWe(e){let t=[],r=!1,n="",a=null;return{char:"#",startOfLine:!1,allowSpaces:!1,items:async({query:i})=>{n=i,a&&a.abort(),a=new AbortController,r=!0;try{if(await new Promise(l=>setTimeout(l,150)),a.signal.aborted)return t;const s=await e(i);return t=s,r=!1,s}catch{return r=!1,t=[],[]}},render:()=>{let i=null,s=null;return{onStart:l=>{i=new E9(Ffe,{props:{items:l.items,command:l.command,isLoading:r,query:n},editor:l.editor}),l.clientRect&&(s=em(document.body,{getReferenceClientRect:l.clientRect,appendTo:()=>document.body,content:i.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"top-start",animation:"fade",zIndex:9999}))},onUpdate:l=>{i&&i.updateProps({items:l.items,command:l.command,isLoading:r,query:n}),s&&l.clientRect&&s.setProps({getReferenceClientRect:l.clientRect})},onKeyDown:l=>l.event.key==="Escape"?(s?.hide(),!0):i?.ref?i.ref.onKeyDown(l):!1,onExit:()=>{s?.destroy(),i?.destroy(),a?.abort()}}},command:({editor:i,range:s,props:l})=>{const c=`![[${l.type}:${l.id}]]`;i.chain().focus().deleteRange(s).insertContent(c+" ").run()}}}const _We=new Gr("hashAutocomplete"),NWe=zr.create({name:"hashAutocomplete",addOptions(){return{fetchElements:JJ}},addProseMirrorPlugins(){return[H9({editor:this.editor,pluginKey:_We,...kWe(this.options.fetchElements||JJ)})]}});function CWe(e="/api"){return async t=>{const r=[];try{const[n,a]=await Promise.all([fetch(`${e}/tasks?search=${encodeURIComponent(t)}&limit=5`),fetch(`${e}/documents?search=${encodeURIComponent(t)}&limit=5`)]);if(n.ok){const i=await n.json(),s=i.items||i;for(const l of s.slice(0,5))r.push({id:l.id,type:"task",title:l.title,subtitle:l.status?`Status: ${l.status}`:void 0,icon:o.jsx(Tl,{className:"w-4 h-4"})})}if(a.ok){const i=await a.json(),s=i.items||i;for(const l of s.slice(0,5))r.push({id:l.id,type:"document",title:l.title,subtitle:l.contentType||"Document",icon:o.jsx(rn,{className:"w-4 h-4"})})}}catch(n){console.error("Error fetching elements for autocomplete:",n)}return r}}const jWe=$i.create({name:"mention",group:"inline",inline:!0,selectable:!0,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-mention-id"),renderHTML:e=>e.id?{"data-mention-id":e.id}:{}},name:{default:null,parseHTML:e=>e.getAttribute("data-mention-name"),renderHTML:e=>e.name?{"data-mention-name":e.name}:{}},entityType:{default:"human",parseHTML:e=>e.getAttribute("data-entity-type"),renderHTML:e=>e.entityType?{"data-entity-type":e.entityType}:{}}}},parseHTML(){return[{tag:"span[data-mention-id]"}]},renderHTML({node:e,HTMLAttributes:t}){return["a",Jn(t,{class:"mention-chip",href:`/entities?selected=${e.attrs.id}`}),`@${e.attrs.name}`]},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:t})=>{let r=!1;const{selection:n}=t,{empty:a,anchor:i}=n;return a?(t.doc.nodesBetween(i-1,i,(s,l)=>{if(s.type.name===this.name)return r=!0,e.insertText("",l,l+s.nodeSize),!1}),r):!1})}}});function EWe(e,t){if(!e)return t.slice(0,10);const r=e.toLowerCase(),n=[],a=new Set;for(const i of t)i.name.toLowerCase()===r&&!a.has(i.id)&&(a.add(i.id),n.push(i));for(const i of t)i.name.toLowerCase().startsWith(r)&&!a.has(i.id)&&(a.add(i.id),n.push(i));for(const i of t)i.name.toLowerCase().includes(r)&&!a.has(i.id)&&(a.add(i.id),n.push(i));return n.slice(0,10)}function MWe(e){switch(e){case"agent":return o.jsx(Xr,{className:"w-4 h-4"});case"system":return o.jsx(li,{className:"w-4 h-4"});case"human":default:return o.jsx(Zr,{className:"w-4 h-4"})}}function TWe(e){switch(e){case"agent":return"Agent";case"system":return"System";case"human":default:return"Human"}}const Ufe=w.forwardRef(({items:e,command:t},r)=>{const[n,a]=w.useState(0);w.useEffect(()=>{a(0)},[e]);const i=w.useCallback(s=>{const l=e[s];l&&t(l)},[e,t]);return w.useImperativeHandle(r,()=>({onKeyDown:({event:s})=>s.key==="ArrowUp"?(a(l=>l<=0?e.length-1:l-1),!0):s.key==="ArrowDown"?(a(l=>l>=e.length-1?0:l+1),!0):s.key==="Enter"?(i(n),!0):s.key==="Escape"})),e.length?o.jsx("div",{"data-testid":"mention-autocomplete-menu",className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-1 min-w-[220px] max-h-[280px] overflow-y-auto",children:e.map((s,l)=>{const c=l===n;return o.jsxs("button",{"data-testid":`mention-item-${s.name}`,className:`w-full flex items-center gap-3 px-3 py-2 rounded text-left transition-colors ${c?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),i(l)},onMouseDown:u=>{u.preventDefault()},onMouseEnter:()=>a(l),children:[o.jsx("span",{className:`flex items-center justify-center w-8 h-8 rounded-full ${s.entityType==="agent"?"bg-purple-100 text-purple-600 dark:bg-purple-900/50 dark:text-purple-400":s.entityType==="system"?"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400":"bg-blue-100 text-blue-600 dark:bg-blue-900/50 dark:text-blue-400"}`,children:MWe(s.entityType)}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"font-medium truncate",children:["@",s.name]}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:TWe(s.entityType)})]})]},s.id)})}):o.jsx("div",{"data-testid":"mention-autocomplete-menu",className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[200px]",children:o.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No matching entities"})})});Ufe.displayName="MentionMenu";function AWe(e){return{char:"@",startOfLine:!1,allowSpaces:!1,items:({query:t})=>{const r=e.getEntities();return EWe(t,r)},render:()=>{let t=null,r=null;return{onStart:n=>{t=new E9(Ufe,{props:{items:n.items,command:n.command},editor:n.editor}),n.clientRect&&(r=em(document.body,{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start",animation:"fade",zIndex:9999}))},onUpdate:n=>{t&&t.updateProps({items:n.items,command:n.command}),r&&n.clientRect&&r.setProps({getReferenceClientRect:n.clientRect})},onKeyDown:n=>n.event.key==="Escape"?(r?.hide(),!0):t?.ref?t.ref.onKeyDown(n):!1,onExit:()=>{r?.destroy(),t?.destroy()}}},command:({editor:t,range:r,props:n})=>{t.chain().focus().deleteRange(r).insertContent([{type:"mention",attrs:{id:n.id,name:n.name,entityType:n.entityType}},{type:"text",text:" "}]).run()}}}const DWe=new Gr("mentionSuggestion"),LWe=zr.create({name:"mentionAutocomplete",addOptions(){return{getEntities:()=>[]}},addProseMirrorPlugins(){return[H9({editor:this.editor,pluginKey:DWe,...AWe(this.options)})]}});function Hfe(e){const t=e.trim();return t?/^https?:\/\//i.test(t)||/^mailto:/i.test(t)?t:`https://${t}`:""}function OWe(e){try{const t=Hfe(e);return t?(new URL(t),!0):!1}catch{return!1}}function IWe({editor:e,onClose:t,anchorRect:r}){const n=e.isActive("link"),a=n&&e.getAttributes("link").href||"",[i,s]=w.useState(a),l=w.useRef(null),c=w.useRef(null);w.useEffect(()=>{const p=setTimeout(()=>{l.current?.focus(),l.current?.select()},50);return()=>clearTimeout(p)},[]),w.useEffect(()=>{function p(v){c.current&&!c.current.contains(v.target)&&t()}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[t]);const u=w.useCallback(()=>{const p=Hfe(i);if(!p||!OWe(i)){n&&e.chain().focus().unsetLink().run(),t();return}e.chain().focus().setLink({href:p}).run(),t()},[e,i,n,t]),d=w.useCallback(()=>{e.chain().focus().unsetLink().run(),t()},[e,t]),f=w.useCallback(p=>{p.key==="Enter"?(p.preventDefault(),u()):p.key==="Escape"&&(p.preventDefault(),t())},[u,t]),m={};return r&&(m.position="fixed",m.top=`${r.bottom+4}px`,m.left=`${r.left}px`,m.zIndex=50),o.jsxs("div",{ref:c,"data-testid":"link-popover",className:"bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex items-center gap-2 min-w-[320px]",style:m,children:[o.jsx("input",{ref:l,type:"text",value:i,onChange:p=>s(p.target.value),onKeyDown:f,placeholder:"Enter URL (e.g., https://example.com)","data-testid":"link-popover-input",className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("button",{type:"button",onClick:u,disabled:!i.trim(),"data-testid":"link-popover-apply",title:"Apply link",className:"px-2 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:n?"Update":"Apply"}),n&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",onClick:d,"data-testid":"link-popover-remove",title:"Remove link",className:"p-1 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:o.jsx(rwe,{className:"w-4 h-4"})}),o.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",title:"Open link in new tab","data-testid":"link-popover-open",className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:o.jsx(Sl,{className:"w-4 h-4"})})]})]})}function RWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e}function KR(e,t){return Array(t+1).join(e)}function qfe(e){return e.replace(/^\n*/,"")}function Wfe(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}function Kfe(e){return Wfe(qfe(e))}var PWe=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function Z9(e){return X9(e,PWe)}var Gfe=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function Vfe(e){return X9(e,Gfe)}function zWe(e){return Qfe(e,Gfe)}var Yfe=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function BWe(e){return X9(e,Yfe)}function $We(e){return Qfe(e,Yfe)}function X9(e,t){return t.indexOf(e.nodeName)>=0}function Qfe(e,t){return e.getElementsByTagName&&t.some(function(r){return e.getElementsByTagName(r).length})}var wi={};wi.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}};wi.lineBreak={filter:"br",replacement:function(e,t,r){return r.br+`
`}};wi.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,r){var n=Number(t.nodeName.charAt(1));if(r.headingStyle==="setext"&&n<3){var a=KR(n===1?"=":"-",e.length);return`

`+e+`
`+a+`

`}else return`

`+KR("#",n)+" "+e+`

`}};wi.blockquote={filter:"blockquote",replacement:function(e){return e=Kfe(e).replace(/^/gm,"> "),`

`+e+`

`}};wi.list={filter:["ul","ol"],replacement:function(e,t){var r=t.parentNode;return r.nodeName==="LI"&&r.lastElementChild===t?`
`+e:`

`+e+`

`}};wi.listItem={filter:"li",replacement:function(e,t,r){var n=r.bulletListMarker+"   ",a=t.parentNode;if(a.nodeName==="OL"){var i=a.getAttribute("start"),s=Array.prototype.indexOf.call(a.children,t);n=(i?Number(i)+s:s+1)+".  "}var l=/\n$/.test(e);return e=Kfe(e)+(l?`
`:""),e=e.replace(/\n/gm,`
`+" ".repeat(n.length)),n+e+(t.nextSibling?`
`:"")}};wi.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};wi.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){for(var n=t.firstChild.getAttribute("class")||"",a=(n.match(/language-(\S+)/)||[null,""])[1],i=t.firstChild.textContent,s=r.fence.charAt(0),l=3,c=new RegExp("^"+s+"{3,}","gm"),u;u=c.exec(i);)u[0].length>=l&&(l=u[0].length+1);var d=KR(s,l);return`

`+d+a+`
`+i.replace(/\n$/,"")+`
`+d+`

`}};wi.horizontalRule={filter:"hr",replacement:function(e,t,r){return`

`+r.hr+`

`}};wi.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var r=t.getAttribute("href");r&&(r=r.replace(/([()])/g,"\\$1"));var n=JN(t.getAttribute("title"));return n&&(n=' "'+n.replace(/"/g,'\\"')+'"'),"["+e+"]("+r+n+")"}};wi.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,r){var n=t.getAttribute("href"),a=JN(t.getAttribute("title"));a&&(a=' "'+a+'"');var i,s;switch(r.linkReferenceStyle){case"collapsed":i="["+e+"][]",s="["+e+"]: "+n+a;break;case"shortcut":i="["+e+"]",s="["+e+"]: "+n+a;break;default:var l=this.references.length+1;i="["+e+"]["+l+"]",s="["+l+"]: "+n+a}return this.references.push(s),i},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};wi.emphasis={filter:["em","i"],replacement:function(e,t,r){return e.trim()?r.emDelimiter+e+r.emDelimiter:""}};wi.strong={filter:["strong","b"],replacement:function(e,t,r){return e.trim()?r.strongDelimiter+e+r.strongDelimiter:""}};wi.code={filter:function(e){var t=e.previousSibling||e.nextSibling,r=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!r},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",r="`",n=e.match(/`+/gm)||[];n.indexOf(r)!==-1;)r=r+"`";return r+t+e+t+r}};wi.image={filter:"img",replacement:function(e,t){var r=JN(t.getAttribute("alt")),n=t.getAttribute("src")||"",a=JN(t.getAttribute("title")),i=a?' "'+a+'"':"";return n?"!["+r+"]("+n+i+")":""}};function JN(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function Jfe(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}Jfe.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=nL(this.array,e,this.options))||(t=nL(this._keep,e,this.options))||(t=nL(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function nL(e,t,r){for(var n=0;n<e.length;n++){var a=e[n];if(FWe(a,t,r))return a}}function FWe(e,t,r){var n=e.filter;if(typeof n=="string"){if(n===t.nodeName.toLowerCase())return!0}else if(Array.isArray(n)){if(n.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof n=="function"){if(n.call(e,t,r))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function UWe(e){var t=e.element,r=e.isBlock,n=e.isVoid,a=e.isPre||function(f){return f.nodeName==="PRE"};if(!(!t.firstChild||a(t))){for(var i=null,s=!1,l=null,c=ZJ(l,t,a);c!==t;){if(c.nodeType===3||c.nodeType===4){var u=c.data.replace(/[ \r\n\t]+/g," ");if((!i||/ $/.test(i.data))&&!s&&u[0]===" "&&(u=u.substr(1)),!u){c=aL(c);continue}c.data=u,i=c}else if(c.nodeType===1)r(c)||c.nodeName==="BR"?(i&&(i.data=i.data.replace(/ $/,"")),i=null,s=!1):n(c)||a(c)?(i=null,s=!0):i&&(s=!1);else{c=aL(c);continue}var d=ZJ(l,c,a);l=c,c=d}i&&(i.data=i.data.replace(/ $/,""),i.data||aL(i))}}function aL(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function ZJ(e,t,r){return e&&e.parentNode===t||r(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var eB=typeof window<"u"?window:{};function HWe(){var e=eB.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function qWe(){var e=function(){};return WWe()?e.prototype.parseFromString=function(t){var r=new window.ActiveXObject("htmlfile");return r.designMode="on",r.open(),r.write(t),r.close(),r}:e.prototype.parseFromString=function(t){var r=document.implementation.createHTMLDocument("");return r.open(),r.write(t),r.close(),r},e}function WWe(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{eB.ActiveXObject&&(e=!0)}return e}var KWe=HWe()?eB.DOMParser:qWe();function GWe(e,t){var r;if(typeof e=="string"){var n=VWe().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");r=n.getElementById("turndown-root")}else r=e.cloneNode(!0);return UWe({element:r,isBlock:Z9,isVoid:Vfe,isPre:t.preformattedCode?YWe:null}),r}var iL;function VWe(){return iL=iL||new KWe,iL}function YWe(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function QWe(e,t){return e.isBlock=Z9(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=JWe(e),e.flankingWhitespace=ZWe(e,t),e}function JWe(e){return!Vfe(e)&&!BWe(e)&&/^\s*$/i.test(e.textContent)&&!zWe(e)&&!$We(e)}function ZWe(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var r=XWe(e.textContent);return r.leadingAscii&&XJ("left",e,t)&&(r.leading=r.leadingNonAscii),r.trailingAscii&&XJ("right",e,t)&&(r.trailing=r.trailingNonAscii),{leading:r.leading,trailing:r.trailing}}function XWe(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function XJ(e,t,r){var n,a,i;return e==="left"?(n=t.previousSibling,a=/ $/):(n=t.nextSibling,a=/^ /),n&&(n.nodeType===3?i=a.test(n.nodeValue):r.preformattedCode&&n.nodeName==="CODE"?i=!1:n.nodeType===1&&!Z9(n)&&(i=a.test(n.textContent))),i}var eKe=Array.prototype.reduce,tKe=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function ax(e){if(!(this instanceof ax))return new ax(e);var t={rules:wi,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(r,n){return n.isBlock?`

`:""},keepReplacement:function(r,n){return n.isBlock?`

`+n.outerHTML+`

`:n.outerHTML},defaultReplacement:function(r,n){return n.isBlock?`

`+r+`

`:r}};this.options=RWe({},t,e),this.rules=new Jfe(this.options)}ax.prototype={turndown:function(e){if(!aKe(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=Zfe.call(this,new GWe(e,this.options));return rKe.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return tKe.reduce(function(t,r){return t.replace(r[0],r[1])},e)}};function Zfe(e){var t=this;return eKe.call(e.childNodes,function(r,n){n=new QWe(n,t.options);var a="";return n.nodeType===3?a=n.isCode?n.nodeValue:t.escape(n.nodeValue):n.nodeType===1&&(a=nKe.call(t,n)),Xfe(r,a)},"")}function rKe(e){var t=this;return this.rules.forEach(function(r){typeof r.append=="function"&&(e=Xfe(e,r.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function nKe(e){var t=this.rules.forNode(e),r=Zfe.call(this,e),n=e.flankingWhitespace;return(n.leading||n.trailing)&&(r=r.trim()),n.leading+t.replacement(r,e,this.options)+n.trailing}function Xfe(e,t){var r=Wfe(e),n=qfe(t),a=Math.max(e.length-r.length,t.length-n.length),i=`

`.substring(0,a);return r+i+n}function aKe(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}function tB(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var tm=tB();function ehe(e){tm=e}var Vb={exec:()=>null};function Pr(e,t=""){let r=typeof e=="string"?e:e.source,n={replace:(a,i)=>{let s=typeof i=="string"?i:i.source;return s=s.replace(Oi.caret,"$1"),r=r.replace(a,s),n},getRegex:()=>new RegExp(r,t)};return n}var iKe=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Oi={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},sKe=/^(?:[ \t]*(?:\n|$))+/,oKe=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,lKe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,s1=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,cKe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,rB=/(?:[*+-]|\d{1,9}[.)])/,the=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,rhe=Pr(the).replace(/bull/g,rB).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),uKe=Pr(the).replace(/bull/g,rB).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),nB=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,dKe=/^[^\n]+/,aB=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,fKe=Pr(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",aB).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),hKe=Pr(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,rB).getRegex(),l2="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",iB=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,mKe=Pr("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",iB).replace("tag",l2).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),nhe=Pr(nB).replace("hr",s1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",l2).getRegex(),pKe=Pr(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",nhe).getRegex(),sB={blockquote:pKe,code:oKe,def:fKe,fences:lKe,heading:cKe,hr:s1,html:mKe,lheading:rhe,list:hKe,newline:sKe,paragraph:nhe,table:Vb,text:dKe},eZ=Pr("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",s1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",l2).getRegex(),gKe={...sB,lheading:uKe,table:eZ,paragraph:Pr(nB).replace("hr",s1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",eZ).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",l2).getRegex()},vKe={...sB,html:Pr(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",iB).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Vb,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Pr(nB).replace("hr",s1).replace("heading",` *#{1,6} *[^
]`).replace("lheading",rhe).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},bKe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yKe=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ahe=/^( {2,}|\\)\n(?!\s*$)/,xKe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,c2=/[\p{P}\p{S}]/u,oB=/[\s\p{P}\p{S}]/u,ihe=/[^\s\p{P}\p{S}]/u,wKe=Pr(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,oB).getRegex(),she=/(?!~)[\p{P}\p{S}]/u,SKe=/(?!~)[\s\p{P}\p{S}]/u,kKe=/(?:[^\s\p{P}\p{S}]|~)/u,_Ke=Pr(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",iKe?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),ohe=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,NKe=Pr(ohe,"u").replace(/punct/g,c2).getRegex(),CKe=Pr(ohe,"u").replace(/punct/g,she).getRegex(),lhe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",jKe=Pr(lhe,"gu").replace(/notPunctSpace/g,ihe).replace(/punctSpace/g,oB).replace(/punct/g,c2).getRegex(),EKe=Pr(lhe,"gu").replace(/notPunctSpace/g,kKe).replace(/punctSpace/g,SKe).replace(/punct/g,she).getRegex(),MKe=Pr("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ihe).replace(/punctSpace/g,oB).replace(/punct/g,c2).getRegex(),TKe=Pr(/\\(punct)/,"gu").replace(/punct/g,c2).getRegex(),AKe=Pr(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),DKe=Pr(iB).replace("(?:-->|$)","-->").getRegex(),LKe=Pr("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",DKe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ZN=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,OKe=Pr(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ZN).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),che=Pr(/^!?\[(label)\]\[(ref)\]/).replace("label",ZN).replace("ref",aB).getRegex(),uhe=Pr(/^!?\[(ref)\](?:\[\])?/).replace("ref",aB).getRegex(),IKe=Pr("reflink|nolink(?!\\()","g").replace("reflink",che).replace("nolink",uhe).getRegex(),tZ=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,lB={_backpedal:Vb,anyPunctuation:TKe,autolink:AKe,blockSkip:_Ke,br:ahe,code:yKe,del:Vb,emStrongLDelim:NKe,emStrongRDelimAst:jKe,emStrongRDelimUnd:MKe,escape:bKe,link:OKe,nolink:uhe,punctuation:wKe,reflink:che,reflinkSearch:IKe,tag:LKe,text:xKe,url:Vb},RKe={...lB,link:Pr(/^!?\[(label)\]\((.*?)\)/).replace("label",ZN).getRegex(),reflink:Pr(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ZN).getRegex()},GR={...lB,emStrongRDelimAst:EKe,emStrongLDelim:CKe,url:Pr(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",tZ).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Pr(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",tZ).getRegex()},PKe={...GR,br:Pr(ahe).replace("{2,}","*").getRegex(),text:Pr(GR.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},CS={normal:sB,gfm:gKe,pedantic:vKe},Av={normal:lB,gfm:GR,breaks:PKe,pedantic:RKe},zKe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rZ=e=>zKe[e];function Lc(e,t){if(t){if(Oi.escapeTest.test(e))return e.replace(Oi.escapeReplace,rZ)}else if(Oi.escapeTestNoEncode.test(e))return e.replace(Oi.escapeReplaceNoEncode,rZ);return e}function nZ(e){try{e=encodeURI(e).replace(Oi.percentDecode,"%")}catch{return null}return e}function aZ(e,t){let r=e.replace(Oi.findPipe,(i,s,l)=>{let c=!1,u=s;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),n=r.split(Oi.splitPipe),a=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;a<n.length;a++)n[a]=n[a].trim().replace(Oi.slashPipe,"|");return n}function Dv(e,t,r){let n=e.length;if(n===0)return"";let a=0;for(;a<n&&e.charAt(n-a-1)===t;)a++;return e.slice(0,n-a)}function BKe(e,t){if(e.indexOf(t[1])===-1)return-1;let r=0;for(let n=0;n<e.length;n++)if(e[n]==="\\")n++;else if(e[n]===t[0])r++;else if(e[n]===t[1]&&(r--,r<0))return n;return r>0?-2:-1}function iZ(e,t,r,n,a){let i=t.href,s=t.title||null,l=e[1].replace(a.other.outputLinkReplace,"$1");n.state.inLink=!0;let c={type:e[0].charAt(0)==="!"?"image":"link",raw:r,href:i,title:s,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,c}function $Ke(e,t,r){let n=e.match(r.other.indentCodeCompensation);if(n===null)return t;let a=n[1];return t.split(`
`).map(i=>{let s=i.match(r.other.beginningSpace);if(s===null)return i;let[l]=s;return l.length>=a.length?i.slice(a.length):i}).join(`
`)}var XN=class{constructor(e){xt(this,"options");xt(this,"rules");xt(this,"lexer");this.options=e||tm}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Dv(r,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let r=t[0],n=$Ke(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){let n=Dv(r,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(r=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Dv(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let r=Dv(t[0],`
`).split(`
`),n="",a="",i=[];for(;r.length>0;){let s=!1,l=[],c;for(c=0;c<r.length;c++)if(this.rules.other.blockquoteStart.test(r[c]))l.push(r[c]),s=!0;else if(!s)l.push(r[c]);else break;r=r.slice(c);let u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${u}`:u,a=a?`${a}
${d}`:d;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,i,!0),this.lexer.state.top=f,r.length===0)break;let m=i.at(-1);if(m?.type==="code")break;if(m?.type==="blockquote"){let p=m,v=p.raw+`
`+r.join(`
`),b=this.blockquote(v);i[i.length-1]=b,n=n.substring(0,n.length-p.raw.length)+b.raw,a=a.substring(0,a.length-p.text.length)+b.text;break}else if(m?.type==="list"){let p=m,v=p.raw+`
`+r.join(`
`),b=this.list(v);i[i.length-1]=b,n=n.substring(0,n.length-m.raw.length)+b.raw,a=a.substring(0,a.length-p.raw.length)+b.raw,r=v.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:i,text:a}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim(),n=r.length>1,a={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=n?r:"[*+-]");let i=this.rules.other.listItemRegex(r),s=!1;for(;e;){let c=!1,u="",d="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),m=e.split(`
`,1)[0],p=!f.trim(),v=0;if(this.options.pedantic?(v=2,d=f.trimStart()):p?v=t[1].length+1:(v=t[2].search(this.rules.other.nonSpaceChar),v=v>4?1:v,d=f.slice(v),v+=t[1].length),p&&this.rules.other.blankLine.test(m)&&(u+=m+`
`,e=e.substring(m.length+1),c=!0),!c){let b=this.rules.other.nextBulletRegex(v),y=this.rules.other.hrRegex(v),S=this.rules.other.fencesBeginRegex(v),_=this.rules.other.headingBeginRegex(v),N=this.rules.other.htmlBeginRegex(v);for(;e;){let k=e.split(`
`,1)[0],j;if(m=k,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),j=m):j=m.replace(this.rules.other.tabCharGlobal,"    "),S.test(m)||_.test(m)||N.test(m)||b.test(m)||y.test(m))break;if(j.search(this.rules.other.nonSpaceChar)>=v||!m.trim())d+=`
`+j.slice(v);else{if(p||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(f)||_.test(f)||y.test(f))break;d+=`
`+m}!p&&!m.trim()&&(p=!0),u+=k+`
`,e=e.substring(k.length+1),f=j.slice(v)}}a.loose||(s?a.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(s=!0)),a.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(d),loose:!1,text:d,tokens:[]}),a.raw+=u}let l=a.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let c of a.items){if(this.lexer.state.top=!1,c.tokens=this.lexer.blockTokens(c.text,[]),c.task){if(c.text=c.text.replace(this.rules.other.listReplaceTask,""),c.tokens[0]?.type==="text"||c.tokens[0]?.type==="paragraph"){c.tokens[0].raw=c.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),c.tokens[0].text=c.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let d=this.lexer.inlineQueue.length-1;d>=0;d--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[d].src)){this.lexer.inlineQueue[d].src=this.lexer.inlineQueue[d].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(c.raw);if(u){let d={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};c.checked=d.checked,a.loose?c.tokens[0]&&["paragraph","text"].includes(c.tokens[0].type)&&"tokens"in c.tokens[0]&&c.tokens[0].tokens?(c.tokens[0].raw=d.raw+c.tokens[0].raw,c.tokens[0].text=d.raw+c.tokens[0].text,c.tokens[0].tokens.unshift(d)):c.tokens.unshift({type:"paragraph",raw:d.raw,text:d.raw,tokens:[d]}):c.tokens.unshift(d)}}if(!a.loose){let u=c.tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));a.loose=d}}if(a.loose)for(let c of a.items){c.loose=!0;for(let u of c.tokens)u.type==="text"&&(u.type="paragraph")}return a}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:n,title:a}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let r=aZ(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),a=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===n.length){for(let s of n)this.rules.other.tableAlignRight.test(s)?i.align.push("right"):this.rules.other.tableAlignCenter.test(s)?i.align.push("center"):this.rules.other.tableAlignLeft.test(s)?i.align.push("left"):i.align.push(null);for(let s=0;s<r.length;s++)i.header.push({text:r[s],tokens:this.lexer.inline(r[s]),header:!0,align:i.align[s]});for(let s of a)i.rows.push(aZ(s,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let i=Dv(r.slice(0,-1),"\\");if((r.length-i.length)%2===0)return}else{let i=BKe(t[2],"()");if(i===-2)return;if(i>-1){let s=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,s).trim(),t[3]=""}}let n=t[2],a="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(n);i&&(n=i[1],a=i[3])}else a=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?n=n.slice(1):n=n.slice(1,-1)),iZ(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let n=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=t[n.toLowerCase()];if(!a){let i=r[0].charAt(0);return{type:"text",raw:i,text:i}}return iZ(r,a,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!(!n||n[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!r||this.rules.inline.punctuation.exec(r))){let a=[...n[0]].length-1,i,s,l=a,c=0,u=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+a);(n=u.exec(t))!=null;){if(i=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!i)continue;if(s=[...i].length,n[3]||n[4]){l+=s;continue}else if((n[5]||n[6])&&a%3&&!((a+s)%3)){c+=s;continue}if(l-=s,l>0)continue;s=Math.min(s,s+l+c);let d=[...n[0]][0].length,f=e.slice(0,a+n.index+d+s);if(Math.min(a,s)%2){let p=f.slice(1,-1);return{type:"em",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}let m=f.slice(2,-2);return{type:"strong",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(r),a=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return n&&a&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let r,n;return t[2]==="@"?(r=t[1],n="mailto:"+r):(r=t[1],n=r),{type:"link",raw:t[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let r,n;if(t[2]==="@")r=t[0],n="mailto:"+r;else{let a;do a=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(a!==t[0]);r=t[0],t[1]==="www."?n="http://"+t[0]:n=t[0]}return{type:"link",raw:t[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let r=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:r}}}},$o=class VR{constructor(t){xt(this,"tokens");xt(this,"options");xt(this,"state");xt(this,"inlineQueue");xt(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||tm,this.options.tokenizer=this.options.tokenizer||new XN,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Oi,block:CS.normal,inline:Av.normal};this.options.pedantic?(r.block=CS.pedantic,r.inline=Av.pedantic):this.options.gfm&&(r.block=CS.gfm,this.options.breaks?r.inline=Av.breaks:r.inline=Av.gfm),this.tokenizer.rules=r}static get rules(){return{block:CS,inline:Av}}static lex(t,r){return new VR(r).lex(t)}static lexInline(t,r){return new VR(r).inlineTokens(t)}lex(t){t=t.replace(Oi.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let n=this.inlineQueue[r];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,r=[],n=!1){for(this.options.pedantic&&(t=t.replace(Oi.tabCharGlobal,"    ").replace(Oi.spaceLine,""));t;){let a;if(this.options.extensions?.block?.some(s=>(a=s.call({lexer:this},t,r))?(t=t.substring(a.raw.length),r.push(a),!0):!1))continue;if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length);let s=r.at(-1);a.raw.length===1&&s!==void 0?s.raw+=`
`:r.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length);let s=r.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+a.raw,s.text+=`
`+a.text,this.inlineQueue.at(-1).src=s.text):r.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length);let s=r.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+a.raw,s.text+=`
`+a.raw,this.inlineQueue.at(-1).src=s.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title},r.push(a));continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),r.push(a);continue}let i=t;if(this.options.extensions?.startBlock){let s=1/0,l=t.slice(1),c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(s=Math.min(s,c))}),s<1/0&&s>=0&&(i=t.substring(0,s+1))}if(this.state.top&&(a=this.tokenizer.paragraph(i))){let s=r.at(-1);n&&s?.type==="paragraph"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+a.raw,s.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):r.push(a),n=i.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length);let s=r.at(-1);s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+a.raw,s.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):r.push(a);continue}if(t){let s="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let n=t,a=null;if(this.tokens.links){let c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,a.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(a=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)i=a[2]?a[2].length:0,n=n.slice(0,a.index+i)+"["+"a".repeat(a[0].length-i-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);n=this.options.hooks?.emStrongMask?.call({lexer:this},n)??n;let s=!1,l="";for(;t;){s||(l=""),s=!1;let c;if(this.options.extensions?.inline?.some(d=>(c=d.call({lexer:this},t,r))?(t=t.substring(c.raw.length),r.push(c),!0):!1))continue;if(c=this.tokenizer.escape(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.tag(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.link(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(c.raw.length);let d=r.at(-1);c.type==="text"&&d?.type==="text"?(d.raw+=c.raw,d.text+=c.text):r.push(c);continue}if(c=this.tokenizer.emStrong(t,n,l)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.codespan(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.br(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.del(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.autolink(t)){t=t.substring(c.raw.length),r.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(t))){t=t.substring(c.raw.length),r.push(c);continue}let u=t;if(this.options.extensions?.startInline){let d=1/0,f=t.slice(1),m;this.options.extensions.startInline.forEach(p=>{m=p.call({lexer:this},f),typeof m=="number"&&m>=0&&(d=Math.min(d,m))}),d<1/0&&d>=0&&(u=t.substring(0,d+1))}if(c=this.tokenizer.inlineText(u)){t=t.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(l=c.raw.slice(-1)),s=!0;let d=r.at(-1);d?.type==="text"?(d.raw+=c.raw,d.text+=c.text):r.push(c);continue}if(t){let d="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return r}},eC=class{constructor(e){xt(this,"options");xt(this,"parser");this.options=e||tm}space(e){return""}code({text:e,lang:t,escaped:r}){let n=(t||"").match(Oi.notSpaceStart)?.[0],a=e.replace(Oi.endingNewline,"")+`
`;return n?'<pre><code class="language-'+Lc(n)+'">'+(r?a:Lc(a,!0))+`</code></pre>
`:"<pre><code>"+(r?a:Lc(a,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,r=e.start,n="";for(let s=0;s<e.items.length;s++){let l=e.items[s];n+=this.listitem(l)}let a=t?"ol":"ul",i=t&&r!==1?' start="'+r+'"':"";return"<"+a+i+`>
`+n+"</"+a+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let a=0;a<e.header.length;a++)r+=this.tablecell(e.header[a]);t+=this.tablerow({text:r});let n="";for(let a=0;a<e.rows.length;a++){let i=e.rows[a];r="";for(let s=0;s<i.length;s++)r+=this.tablecell(i[s]);n+=this.tablerow({text:r})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Lc(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){let n=this.parser.parseInline(r),a=nZ(e);if(a===null)return n;e=a;let i='<a href="'+e+'"';return t&&(i+=' title="'+Lc(t)+'"'),i+=">"+n+"</a>",i}image({href:e,title:t,text:r,tokens:n}){n&&(r=this.parser.parseInline(n,this.parser.textRenderer));let a=nZ(e);if(a===null)return Lc(r);e=a;let i=`<img src="${e}" alt="${r}"`;return t&&(i+=` title="${Lc(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Lc(e.text)}},cB=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Fo=class YR{constructor(t){xt(this,"options");xt(this,"renderer");xt(this,"textRenderer");this.options=t||tm,this.options.renderer=this.options.renderer||new eC,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new cB}static parse(t,r){return new YR(r).parse(t)}static parseInline(t,r){return new YR(r).parseInline(t)}parse(t){let r="";for(let n=0;n<t.length;n++){let a=t[n];if(this.options.extensions?.renderers?.[a.type]){let s=a,l=this.options.extensions.renderers[s.type].call({parser:this},s);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(s.type)){r+=l||"";continue}}let i=a;switch(i.type){case"space":{r+=this.renderer.space(i);break}case"hr":{r+=this.renderer.hr(i);break}case"heading":{r+=this.renderer.heading(i);break}case"code":{r+=this.renderer.code(i);break}case"table":{r+=this.renderer.table(i);break}case"blockquote":{r+=this.renderer.blockquote(i);break}case"list":{r+=this.renderer.list(i);break}case"checkbox":{r+=this.renderer.checkbox(i);break}case"html":{r+=this.renderer.html(i);break}case"def":{r+=this.renderer.def(i);break}case"paragraph":{r+=this.renderer.paragraph(i);break}case"text":{r+=this.renderer.text(i);break}default:{let s='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(s),"";throw new Error(s)}}}return r}parseInline(t,r=this.renderer){let n="";for(let a=0;a<t.length;a++){let i=t[a];if(this.options.extensions?.renderers?.[i.type]){let l=this.options.extensions.renderers[i.type].call({parser:this},i);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){n+=l||"";continue}}let s=i;switch(s.type){case"escape":{n+=r.text(s);break}case"html":{n+=r.html(s);break}case"link":{n+=r.link(s);break}case"image":{n+=r.image(s);break}case"checkbox":{n+=r.checkbox(s);break}case"strong":{n+=r.strong(s);break}case"em":{n+=r.em(s);break}case"codespan":{n+=r.codespan(s);break}case"br":{n+=r.br(s);break}case"del":{n+=r.del(s);break}case"text":{n+=r.text(s);break}default:{let l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}},fk,vb=(fk=class{constructor(t){xt(this,"options");xt(this,"block");this.options=t||tm}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?$o.lex:$o.lexInline}provideParser(){return this.block?Fo.parse:Fo.parseInline}},xt(fk,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),xt(fk,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),fk),FKe=class{constructor(...t){xt(this,"defaults",tB());xt(this,"options",this.setOptions);xt(this,"parse",this.parseMarkdown(!0));xt(this,"parseInline",this.parseMarkdown(!1));xt(this,"Parser",Fo);xt(this,"Renderer",eC);xt(this,"TextRenderer",cB);xt(this,"Lexer",$o);xt(this,"Tokenizer",XN);xt(this,"Hooks",vb);this.use(...t)}walkTokens(t,r){let n=[];for(let a of t)switch(n=n.concat(r.call(this,a)),a.type){case"table":{let i=a;for(let s of i.header)n=n.concat(this.walkTokens(s.tokens,r));for(let s of i.rows)for(let l of s)n=n.concat(this.walkTokens(l.tokens,r));break}case"list":{let i=a;n=n.concat(this.walkTokens(i.items,r));break}default:{let i=a;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(s=>{let l=i[s].flat(1/0);n=n.concat(this.walkTokens(l,r))}):i.tokens&&(n=n.concat(this.walkTokens(i.tokens,r)))}}return n}use(...t){let r=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let a={...n};if(a.async=this.defaults.async||a.async||!1,n.extensions&&(n.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let s=r.renderers[i.name];s?r.renderers[i.name]=function(...l){let c=i.renderer.apply(this,l);return c===!1&&(c=s.apply(this,l)),c}:r.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=r[i.level];s?s.unshift(i.tokenizer):r[i.level]=[i.tokenizer],i.start&&(i.level==="block"?r.startBlock?r.startBlock.push(i.start):r.startBlock=[i.start]:i.level==="inline"&&(r.startInline?r.startInline.push(i.start):r.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(r.childTokens[i.name]=i.childTokens)}),a.extensions=r),n.renderer){let i=this.defaults.renderer||new eC(this.defaults);for(let s in n.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let l=s,c=n.renderer[l],u=i[l];i[l]=(...d)=>{let f=c.apply(i,d);return f===!1&&(f=u.apply(i,d)),f||""}}a.renderer=i}if(n.tokenizer){let i=this.defaults.tokenizer||new XN(this.defaults);for(let s in n.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let l=s,c=n.tokenizer[l],u=i[l];i[l]=(...d)=>{let f=c.apply(i,d);return f===!1&&(f=u.apply(i,d)),f}}a.tokenizer=i}if(n.hooks){let i=this.defaults.hooks||new vb;for(let s in n.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let l=s,c=n.hooks[l],u=i[l];vb.passThroughHooks.has(s)?i[l]=d=>{if(this.defaults.async&&vb.passThroughHooksRespectAsync.has(s))return(async()=>{let m=await c.call(i,d);return u.call(i,m)})();let f=c.call(i,d);return u.call(i,f)}:i[l]=(...d)=>{if(this.defaults.async)return(async()=>{let m=await c.apply(i,d);return m===!1&&(m=await u.apply(i,d)),m})();let f=c.apply(i,d);return f===!1&&(f=u.apply(i,d)),f}}a.hooks=i}if(n.walkTokens){let i=this.defaults.walkTokens,s=n.walkTokens;a.walkTokens=function(l){let c=[];return c.push(s.call(this,l)),i&&(c=c.concat(i.call(this,l))),c}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,r){return $o.lex(t,r??this.defaults)}parser(t,r){return Fo.parse(t,r??this.defaults)}parseMarkdown(t){return(r,n)=>{let a={...n},i={...this.defaults,...a},s=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let l=i.hooks?await i.hooks.preprocess(r):r,c=await(i.hooks?await i.hooks.provideLexer():t?$o.lex:$o.lexInline)(l,i),u=i.hooks?await i.hooks.processAllTokens(c):c;i.walkTokens&&await Promise.all(this.walkTokens(u,i.walkTokens));let d=await(i.hooks?await i.hooks.provideParser():t?Fo.parse:Fo.parseInline)(u,i);return i.hooks?await i.hooks.postprocess(d):d})().catch(s);try{i.hooks&&(r=i.hooks.preprocess(r));let l=(i.hooks?i.hooks.provideLexer():t?$o.lex:$o.lexInline)(r,i);i.hooks&&(l=i.hooks.processAllTokens(l)),i.walkTokens&&this.walkTokens(l,i.walkTokens);let c=(i.hooks?i.hooks.provideParser():t?Fo.parse:Fo.parseInline)(l,i);return i.hooks&&(c=i.hooks.postprocess(c)),c}catch(l){return s(l)}}}onError(t,r){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Lc(n.message+"",!0)+"</pre>";return r?Promise.resolve(a):a}if(r)return Promise.reject(n);throw n}}},Ah=new FKe;function Ar(e,t){return Ah.parse(e,t)}Ar.options=Ar.setOptions=function(e){return Ah.setOptions(e),Ar.defaults=Ah.defaults,ehe(Ar.defaults),Ar};Ar.getDefaults=tB;Ar.defaults=tm;Ar.use=function(...e){return Ah.use(...e),Ar.defaults=Ah.defaults,ehe(Ar.defaults),Ar};Ar.walkTokens=function(e,t){return Ah.walkTokens(e,t)};Ar.parseInline=Ah.parseInline;Ar.Parser=Fo;Ar.parser=Fo.parse;Ar.Renderer=eC;Ar.TextRenderer=cB;Ar.Lexer=$o;Ar.lexer=$o.lex;Ar.Tokenizer=XN;Ar.Hooks=vb;Ar.parse=Ar;Ar.options;Ar.setOptions;Ar.use;Ar.walkTokens;Ar.parseInline;Fo.parse;$o.lex;const rm=new ax({headingStyle:"atx",codeBlockStyle:"fenced",bulletListMarker:"-",emDelimiter:"_",strongDelimiter:"**"});rm.addRule("highlight",{filter:"mark",replacement:function(e){return"=="+e+"=="}});rm.addRule("strikethrough",{filter:function(e){return e.nodeName==="S"||e.nodeName==="DEL"},replacement:function(e){return"~~"+e+"~~"}});rm.addRule("taskEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="taskEmbed"},replacement:function(e,t){const r=t.getAttribute("data-task-id");return r?`![[task:${r}]]`:""}});rm.addRule("documentEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="documentEmbed"},replacement:function(e,t){const r=t.getAttribute("data-document-id");return r?`![[doc:${r}]]`:""}});rm.addRule("mention",{filter:function(e){return e.nodeName==="A"&&e.hasAttribute("data-mention-id")},replacement:function(e,t){const r=t.getAttribute("data-mention-name");return r?`@${r}`:""}});rm.addRule("textAlign",{filter:function(e){if(!["P","H1","H2","H3","H4","H5","H6"].includes(e.nodeName))return!1;const t=e.getAttribute("style")||"";return/text-align:\s*(center|right|justify)/i.test(t)},replacement:function(e,t){const n=(t.getAttribute("style")||"").match(/text-align:\s*(center|right|justify)/i);if(!n)return e;const a=n[1].toLowerCase(),i=t.nodeName.toLowerCase();return i.startsWith("h")?`<${i} style="text-align: ${a}">${e}</${i}>

`:`<p style="text-align: ${a}">${e}</p>

`}});Ar.setOptions({gfm:!0,breaks:!0});function UKe(e){if(!e||e==="<p></p>")return"";let t=rm.turndown(e);return t=t.replace(/\n{3,}/g,`

`),t}function HKe(e){if(!e)return"<p></p>";let t=e;return t=t.replace(/!\[\[task:([\w-]+)\]\]/g,'<div data-type="taskEmbed" data-task-id="$1"></div>'),t=t.replace(/!\[\[doc:([\w-]+)\]\]/g,'<div data-type="documentEmbed" data-document-id="$1"></div>'),t=t.replace(/==([^=]+)==/g,"<mark>$1</mark>"),t=t.replace(/~~([^~]+)~~/g,"<s>$1</s>"),Ar.parse(t,{async:!1})}function qKe(e,t){return e?HKe(e):"<p></p>"}function WKe(e,t){return!e||e==="<p></p>"?"":UKe(e)}const KKe=Rqe(Oqe),GKe=typeof navigator<"u"&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Vu=GKe?"":"Ctrl";function jS({onClick:e,isActive:t=!1,disabled:r=!1,title:n,children:a,testId:i,buttonRef:s}){return o.jsx("button",{ref:s,type:"button",onClick:e,disabled:r,title:n,"data-testid":i,className:`p-1.5 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${t?"bg-gray-200 text-blue-600":"text-gray-500"}`,children:a})}function VKe(){return o.jsx("div",{className:"w-px h-5 bg-gray-200 mx-0.5"})}const dhe=w.forwardRef(function({content:t,onChange:r,onSubmit:n,placeholder:a="Message...",disabled:i=!1,maxHeight:s=200,minHeight:l=60,channelName:c,onImagePaste:u,embedCallbacks:d,mentionEntities:f=[]},m){const[p,v]=w.useState(!1),[b,y]=w.useState(!1),[S,_]=w.useState(null),N=w.useRef(null),k=w.useRef(null),j=w.useRef(f);j.current=f;const E=w.useCallback(()=>j.current,[]),T=w.useCallback(()=>t?qKe(t):"<p></p>",[t]),O=w.useCallback(()=>{N.current?_(N.current.getBoundingClientRect()):k.current&&_(k.current.getBoundingClientRect()),v(!0),y(!0)},[]),R=mFe({extensions:[XUe.configure({codeBlock:!1,heading:!1,dropcursor:!1,gapcursor:!1}),DUe,hUe.configure({openOnClick:!1,autolink:!0,linkOnPaste:!0,HTMLAttributes:{class:"message-link",rel:"noopener noreferrer",target:"_blank"}}),rHe.configure({placeholder:c?`Message ${c}...`:a}),hHe.configure({lowlight:KKe}),SWe.configure({embedCallbacks:d}),NWe.configure({fetchElements:CWe()}),jWe,LWe.configure({getEntities:E})],content:T(),editable:!i,onUpdate:({editor:$})=>{const L=$.getHTML(),A=WKe(L);r(A)},editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none min-h-[40px] px-3 py-2","data-testid":"message-input",style:`max-height: ${s-40}px; overflow-y: auto;`},handleKeyDown:($,L)=>{if(L.key==="k"&&(L.metaKey||L.ctrlKey)&&!L.shiftKey)return L.preventDefault(),O(),!0;if(L.key==="Enter"&&!L.shiftKey&&!L.metaKey&&!L.ctrlKey){const A=R?.isActive("bulletList")||R?.isActive("orderedList"),M=R?.isActive("codeBlock"),z=document.querySelector('[data-testid="message-slash-command-menu"]'),I=document.querySelector('[data-testid="hash-autocomplete-menu"]'),B=document.querySelector('[data-testid="mention-autocomplete-menu"]');if(z||I||B)return!1;if(!A&&!M)return L.preventDefault(),n(),!0}return!1},handlePaste:($,L)=>{const A=L.clipboardData?.items;if(!A||!u)return!1;for(const M of A)if(M.type.startsWith("image/")){const z=M.getAsFile();if(z)return L.preventDefault(),u(z),!0}return!1}}});if(w.useImperativeHandle(m,()=>({focus:()=>R?.commands.focus(),clear:()=>{R?.commands.clearContent(),R?.commands.focus()},isEmpty:()=>R?R.getText().trim().length===0:!0})),w.useEffect(()=>{if(R&&!R.isFocused){const $=R.getText().trim();t===""&&$!==""&&R.commands.clearContent()}},[R,t]),w.useEffect(()=>{R&&R.setEditable(!i)},[R,i]),w.useEffect(()=>{R&&c&&R.commands.focus()},[R,c]),!R)return o.jsx("div",{"data-testid":"message-rich-composer-loading",className:"px-3 py-2 text-gray-400 text-sm",children:"Loading editor..."});const q=[{id:"bold",icon:o.jsx(_O,{className:"w-4 h-4"}),title:`Bold (${Vu}B)`,action:()=>R.chain().focus().toggleBold().run(),isActive:R.isActive("bold")},{id:"italic",icon:o.jsx(NO,{className:"w-4 h-4"}),title:`Italic (${Vu}I)`,action:()=>R.chain().focus().toggleItalic().run(),isActive:R.isActive("italic")},{id:"underline",icon:o.jsx(nwe,{className:"w-4 h-4"}),title:`Underline (${Vu}U)`,action:()=>R.chain().focus().toggleUnderline().run(),isActive:R.isActive("underline")},{id:"strike",icon:o.jsx(awe,{className:"w-4 h-4"}),title:"Strikethrough",action:()=>R.chain().focus().toggleStrike().run(),isActive:R.isActive("strike")},{id:"divider1",type:"divider"},{id:"code",icon:o.jsx(Kp,{className:"w-4 h-4"}),title:`Inline Code (${Vu}E)`,action:()=>R.chain().focus().toggleCode().run(),isActive:R.isActive("code")},{id:"codeBlock",icon:o.jsx(Bs,{className:"w-4 h-4"}),title:"Code Block",action:()=>R.chain().focus().toggleCodeBlock().run(),isActive:R.isActive("codeBlock")},{id:"divider2",type:"divider"},{id:"bulletList",icon:o.jsx(Wp,{className:"w-4 h-4"}),title:"Bullet List",action:()=>R.chain().focus().toggleBulletList().run(),isActive:R.isActive("bulletList")},{id:"orderedList",icon:o.jsx(Pae,{className:"w-4 h-4"}),title:"Numbered List",action:()=>R.chain().focus().toggleOrderedList().run(),isActive:R.isActive("orderedList")},{id:"divider3",type:"divider"},{id:"blockquote",icon:o.jsx(Rae,{className:"w-4 h-4"}),title:"Block Quote",action:()=>R.chain().focus().toggleBlockquote().run(),isActive:R.isActive("blockquote")},{id:"divider4",type:"divider"},{id:"link",icon:o.jsx(Ox,{className:"w-4 h-4"}),title:`Link (${Vu}K)`,action:()=>O(),isActive:R.isActive("link"),ref:N}];return o.jsxs("div",{ref:k,"data-testid":"message-rich-composer",className:`border border-gray-300 rounded-lg bg-white transition-all ${i?"opacity-50":""}`,style:{minHeight:`${l}px`},children:[o.jsx("div",{className:"message-rich-editor",style:{maxHeight:`${s-(p?40:0)}px`,overflow:"auto"},children:o.jsx(oFe,{editor:R})}),o.jsxs("div",{className:"flex items-center justify-between border-t border-gray-100 px-2 py-1 bg-gray-50 rounded-b-lg",children:[o.jsx("div",{className:"flex items-center gap-0.5",children:p?o.jsx(o.Fragment,{children:q.map($=>$.type==="divider"?o.jsx(VKe,{},$.id):o.jsx(jS,{onClick:$.action,isActive:$.isActive,disabled:i,title:$.title,testId:`message-toolbar-${$.id}`,buttonRef:$.ref,children:$.icon},$.id))}):o.jsxs(o.Fragment,{children:[o.jsx(jS,{onClick:()=>R.chain().focus().toggleBold().run(),isActive:R.isActive("bold"),disabled:i,title:`Bold (${Vu}B)`,testId:"message-toolbar-bold",children:o.jsx(_O,{className:"w-4 h-4"})}),o.jsx(jS,{onClick:()=>R.chain().focus().toggleItalic().run(),isActive:R.isActive("italic"),disabled:i,title:`Italic (${Vu}I)`,testId:"message-toolbar-italic",children:o.jsx(NO,{className:"w-4 h-4"})}),o.jsx(jS,{onClick:()=>R.chain().focus().toggleCode().run(),isActive:R.isActive("code"),disabled:i,title:`Inline Code (${Vu}E)`,testId:"message-toolbar-code",children:o.jsx(Kp,{className:"w-4 h-4"})})]})}),o.jsx("button",{type:"button",onClick:()=>v(!p),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:p?"Hide formatting options":"Show more formatting options","data-testid":"message-toolbar-toggle",children:p?o.jsx(cr,{className:"w-4 h-4"}):o.jsx(Xg,{className:"w-4 h-4"})})]}),b&&o.jsx(IWe,{editor:R,onClose:()=>y(!1),anchorRect:S})]})});function YKe({isOpen:e,onClose:t,onAttach:r}){const[n,a]=w.useState("upload"),[i,s]=w.useState(!1),[l,c]=w.useState(!1),[u,d]=w.useState(null),[f,m]=w.useState(null),p=w.useRef(null),[v,b]=w.useState([]),[y,S]=w.useState(!1),[_,N]=w.useState(""),[k,j]=w.useState(null),E=w.useCallback(()=>{a("upload"),s(!1),c(!1),d(null),m(null),N(""),j(null)},[]),T=w.useCallback(()=>{E(),t()},[t,E]),O=w.useCallback(async()=>{S(!0),d(null);try{const F=await fetch("/api/uploads");if(!F.ok)throw new Error("Failed to load images");const U=await F.json();b(U.files||[])}catch(F){d(F.message)}finally{S(!1)}},[]);w.useEffect(()=>{e&&n==="library"&&O()},[e,n,O]);const R=w.useMemo(()=>{if(!_.trim())return v;const F=_.toLowerCase();return v.filter(U=>U.filename.toLowerCase().includes(F))},[v,_]),q=async F=>{if(!["image/jpeg","image/png","image/gif","image/webp"].includes(F.type))return d(`Invalid file type: ${F.type}. Allowed: JPEG, PNG, GIF, WebP`),null;if(F.size>10*1024*1024)return d(`File too large: ${(F.size/(1024*1024)).toFixed(2)}MB. Maximum: 10MB`),null;c(!0),d(null);try{const V=new FormData;V.append("file",F);const K=await fetch("/api/uploads",{method:"POST",body:V});if(!K.ok){const J=await K.json().catch(()=>({}));throw new Error(J.error?.message||`Upload failed: ${K.status}`)}return(await K.json()).url}catch(V){return d(V.message),null}finally{c(!1)}},$=w.useCallback(async F=>{if(!["image/jpeg","image/png","image/gif","image/webp"].includes(F.type)){d(`Invalid file type: ${F.type}. Allowed: JPEG, PNG, GIF, WebP`);return}const V=URL.createObjectURL(F);m({url:V,file:F}),d(null)},[]),L=w.useCallback(F=>{const U=F.target.files?.[0];U&&$(U)},[$]),A=w.useCallback(F=>{F.preventDefault(),s(!1);const U=F.dataTransfer.files[0];U&&U.type.startsWith("image/")?$(U):d("Please drop an image file")},[$]),M=w.useCallback(F=>{F.preventDefault(),s(!0)},[]),z=w.useCallback(F=>{F.preventDefault(),s(!1)},[]),I=w.useCallback(async()=>{if(n==="library"){if(!k){d("Please select an image");return}r(k.url),T()}else if(f?.file){const F=await q(f.file);F&&(r(F),T())}},[n,f,k,r,T]),B=F=>F<1024?`${F} B`:F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/(1024*1024)).toFixed(2)} MB`;return o.jsx(yie,{open:e,onOpenChange:F=>!F&&T(),children:o.jsxs($6,{children:[o.jsx(tj,{className:"fixed inset-0 bg-black/50 z-50"}),o.jsxs(rj,{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-900 rounded-lg shadow-xl p-6 z-50 ${n==="library"?"w-full max-w-3xl max-h-[80vh] overflow-hidden flex flex-col":"w-full max-w-md"}`,"data-testid":"message-image-attachment-modal",children:[o.jsx(nj,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Attach Image"}),o.jsxs("div",{className:"flex gap-2 mb-4",children:[o.jsxs("button",{onClick:()=>{a("upload"),d(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="upload"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,"data-testid":"message-image-upload-tab",children:[o.jsx(zae,{className:"w-4 h-4"}),"Upload"]}),o.jsxs("button",{onClick:()=>{a("library"),d(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="library"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,"data-testid":"message-image-library-tab",children:[o.jsx(Bae,{className:"w-4 h-4"}),"Library"]})]}),n==="upload"&&o.jsxs("div",{className:"space-y-4",children:[f?o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:f.url,alt:"Preview",className:"w-full h-48 object-contain bg-gray-100 dark:bg-gray-800 rounded-lg","data-testid":"message-image-preview"}),o.jsx("button",{onClick:()=>m(null),className:"absolute top-2 right-2 p-1 bg-white dark:bg-gray-700 rounded-full shadow hover:bg-gray-100 dark:hover:bg-gray-600",title:"Remove","data-testid":"message-image-preview-remove",children:o.jsx(wt,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}):o.jsxs("div",{onClick:()=>p.current?.click(),onDrop:A,onDragOver:M,onDragLeave:z,className:`flex flex-col items-center justify-center h-48 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${i?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,"data-testid":"message-image-drop-zone",children:[o.jsx(iy,{className:"w-12 h-12 text-gray-400 mb-3"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Drop an image here or click to browse"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"JPEG, PNG, GIF, WebP up to 10MB"})]}),o.jsx("input",{ref:p,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:L,className:"hidden","data-testid":"message-image-file-input"})]}),n==="library"&&o.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[o.jsxs("div",{className:"relative mb-4",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:_,onChange:F=>N(F.target.value),placeholder:"Search images...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500","data-testid":"message-library-search-input"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto min-h-[200px] max-h-[300px]",children:y?o.jsx("div",{className:"flex items-center justify-center h-48",children:o.jsx($e,{className:"w-8 h-8 animate-spin text-gray-400"})}):R.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500 dark:text-gray-400",children:[o.jsx(iy,{className:"w-12 h-12 mb-3 opacity-50"}),v.length===0?o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-sm font-medium",children:"No images uploaded yet"}),o.jsx("p",{className:"text-xs mt-1",children:"Upload images to see them here"})]}):o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-sm font-medium",children:"No images match your search"}),o.jsx("p",{className:"text-xs mt-1",children:"Try a different search term"})]})]}):o.jsx("div",{className:"grid grid-cols-3 gap-3","data-testid":"message-library-image-grid",children:R.map(F=>o.jsxs("div",{className:`relative group rounded-lg overflow-hidden border-2 transition-all cursor-pointer ${k?.filename===F.filename?"border-blue-500 ring-2 ring-blue-500/30":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>j(F),"data-testid":`message-library-image-${F.filename}`,children:[o.jsx("img",{src:F.url,alt:F.filename,className:"w-full h-24 object-cover bg-gray-100 dark:bg-gray-800"}),k?.filename===F.filename&&o.jsx("div",{className:"absolute top-2 left-2 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:o.jsx(Vn,{className:"w-3 h-3 text-white"})}),o.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-2",children:[o.jsx("p",{className:"text-white text-xs truncate",children:F.filename}),o.jsx("p",{className:"text-white/75 text-[10px]",children:B(F.size)})]})]},F.filename))})}),k&&o.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:k.url,alt:k.filename,className:"w-12 h-12 object-cover rounded bg-gray-100 dark:bg-gray-800"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:k.filename}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:B(k.size)})]})]})})]}),u&&o.jsxs("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-600 dark:text-red-400 flex items-center gap-2","data-testid":"message-image-error",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),u]}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{onClick:T,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","data-testid":"message-image-cancel-button",children:"Cancel"}),o.jsx("button",{onClick:I,disabled:l||n==="upload"&&!f||n==="library"&&!k,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors","data-testid":"message-image-insert-button",children:l?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):"Attach Image"})]}),o.jsx(F6,{asChild:!0,children:o.jsx("button",{className:"absolute top-4 right-4 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded","aria-label":"Close",children:o.jsx(wt,{className:"w-5 h-5"})})})]})]})})}function QKe(){const e=ht();return Ct({mutationFn:async({channelId:t,actor:r})=>{const n=await fetch(`/api/channels/${t}?actor=${encodeURIComponent(r)}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to delete channel")}return n.json()},onSuccess:(t,{channelId:r})=>{e.invalidateQueries({queryKey:["channels"]}),e.invalidateQueries({queryKey:["channels",r]}),e.invalidateQueries({queryKey:["channels",r,"messages"]}),e.invalidateQueries({queryKey:["channels",r,"members"]})}})}const sL={agent:{icon:Xr,text:"text-purple-700",darkText:"dark:text-purple-300"},human:{icon:Zr,text:"text-blue-700",darkText:"dark:text-blue-300"},system:{icon:Od,text:"text-gray-700",darkText:"dark:text-gray-300"}};function JKe(e){const t=e?.startsWith("el-");return gt({queryKey:["entities","byRef",e],queryFn:async()=>{if(!e)return null;if(t){const r=await fetch(`/api/entities/${e}`);if(!r.ok){if(r.status===404)return null;throw new Error("Failed to fetch entity")}return r.json()}else{const r=await fetch(`/api/entities?search=${encodeURIComponent(e)}&limit=100`);if(!r.ok)throw new Error("Failed to fetch entity");return(await r.json()).items.find(i=>i.name.toLowerCase()===e.toLowerCase())??null}},enabled:!!e,staleTime:3e4})}function ZKe({entityRef:e,children:t,className:r="",showPreview:n=!0,showIcon:a=!1,"data-testid":i}){const{data:s,isLoading:l}=JKe(e),c=t??s?.name??e,u=s&&sL[s.entityType]||sL.system,d=u.icon;return l?o.jsxs("span",{className:`inline-flex items-center gap-1 text-gray-400 ${r}`,children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),e]}):o.jsxs("span",{className:`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium ${r}`,"data-testid":i||`entity-link-${e}`,title:s?`${s.name} (${s.entityType})`:e,children:[a&&o.jsx(d,{className:`w-3.5 h-3.5 ${u.text} ${u.darkText}`}),c]})}function XKe(e){return gt({queryKey:["channels",e,"members"],queryFn:async()=>{const t=await fetch(`/api/channels/${e}/members?hydrate=true`);if(!t.ok)throw new Error("Failed to fetch channel members");return t.json()}})}function eGe(){return gt({queryKey:["entities"],queryFn:async()=>{const e=await fetch("/api/entities");if(!e.ok)throw new Error("Failed to fetch entities");const t=await e.json();return t.items||t}})}function tGe(){const e=ht();return Ct({mutationFn:async({channelId:t,entityId:r,actor:n})=>{const a=await fetch(`/api/channels/${t}/members`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entityId:r,actor:n})});if(!a.ok){const i=await a.json();throw new Error(i.error?.message||"Failed to add member")}return a.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"members"]}),e.invalidateQueries({queryKey:["channels",r.channelId]}),e.invalidateQueries({queryKey:["channels"]})}})}function rGe(){const e=ht();return Ct({mutationFn:async({channelId:t,entityId:r,actor:n})=>{const a=await fetch(`/api/channels/${t}/members/${r}?actor=${encodeURIComponent(n)}`,{method:"DELETE"});if(!a.ok){const i=await a.json();throw new Error(i.error?.message||"Failed to remove member")}return a.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"members"]}),e.invalidateQueries({queryKey:["channels",r.channelId]}),e.invalidateQueries({queryKey:["channels"]})}})}function nGe(){const e=ht();return Ct({mutationFn:async({channelId:t,actor:r})=>{const n=await fetch(`/api/channels/${t}/leave`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({actor:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to leave channel")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"members"]}),e.invalidateQueries({queryKey:["channels",r.channelId]}),e.invalidateQueries({queryKey:["channels"]})}})}function aGe({name:e,entityType:t}){const r={human:"bg-blue-100 text-blue-600",agent:"bg-purple-100 text-purple-600",system:"bg-gray-100 text-gray-600"},n=r[t||"system"]||r.system;return o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${n}`,children:o.jsx("span",{className:"text-sm font-medium",children:e.slice(0,2).toUpperCase()})})}function iGe({member:e,isCreator:t,canModify:r,canRemove:n,onRemove:a,isRemoving:i}){const[s,l]=w.useState(!1),c="entityType"in e?e.entityType:void 0,u="notFound"in e&&e.notFound,d=()=>{l(!0)},f=()=>{l(!1),a()};return o.jsxs("div",{"data-testid":`member-${e.id}`,className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 group relative transition-colors",children:[o.jsx(aGe,{name:e.name,entityType:c}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[u?o.jsx("span",{className:"text-sm font-medium truncate text-gray-400 dark:text-gray-500 italic",children:e.name}):o.jsx(ZKe,{entityRef:e.id,className:"text-sm font-medium truncate","data-testid":`member-link-${e.id}`,children:e.name}),t&&o.jsx("span",{title:"Channel creator",children:o.jsx(Px,{className:"w-4 h-4 text-amber-500 flex-shrink-0"})})]}),c&&!u&&o.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:c}),u&&o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Entity not found"})]}),r&&n&&!s&&o.jsx("button",{onClick:d,disabled:i,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",title:"Remove member","data-testid":`remove-member-${e.id}`,children:i?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx($ae,{className:"w-4 h-4"})}),s&&o.jsxs("div",{className:"flex items-center gap-1","data-testid":`confirm-remove-${e.id}`,children:[o.jsx("button",{onClick:f,disabled:i,className:"px-2 py-1 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded disabled:opacity-50","data-testid":`confirm-remove-yes-${e.id}`,children:i?o.jsx($e,{className:"w-3 h-3 animate-spin"}):"Remove"}),o.jsx("button",{onClick:()=>l(!1),className:"px-2 py-1 text-xs font-medium text-gray-600 hover:bg-gray-100 rounded","data-testid":`confirm-remove-cancel-${e.id}`,children:"Cancel"})]})]})}function sGe({channelId:e,currentMembers:t,currentOperator:r,onSuccess:n}){const[a,i]=w.useState(""),{data:s}=eGe(),l=tGe(),c=s?.filter(d=>!t.includes(d.id)),u=async()=>{if(a)try{await l.mutateAsync({channelId:e,entityId:a,actor:r}),i(""),n()}catch{}};return o.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Member"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:a,onChange:d=>i(d.target.value),className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","data-testid":"add-member-select",children:[o.jsx("option",{value:"",children:"Select entity..."}),c?.map(d=>o.jsxs("option",{value:d.id,children:[d.name," (",d.entityType,")"]},d.id))]}),o.jsxs("button",{onClick:u,disabled:!a||l.isPending,className:"px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1","data-testid":"add-member-button",children:[l.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(Fae,{className:"w-4 h-4"}),"Add"]})]}),l.isError&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[o.jsx(Bt,{className:"w-4 h-4"}),l.error.message]}),c?.length===0&&o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"No more entities available to add"})]})}function oGe({channel:e,currentOperator:t,onClose:r,onChannelDeleted:n}){const[a,i]=w.useState(null),[s,l]=w.useState(!1),{data:c,isLoading:u,error:d}=XKe(e.id),f=rGe(),m=nGe(),p=QKe(),v=e.channelType==="direct",b=!v&&c?.permissions.modifyMembers.includes(t),y=e.members.includes(t),S=!v&&(e.createdBy===t||b),_=async j=>{i(j);try{await f.mutateAsync({channelId:e.id,entityId:j,actor:t})}catch{}finally{i(null)}},N=async()=>{if(confirm("Are you sure you want to leave this channel?"))try{await m.mutateAsync({channelId:e.id,actor:t}),r()}catch{}},k=async()=>{try{await p.mutateAsync({channelId:e.id,actor:t}),l(!1),r(),n?.()}catch{}};return o.jsxs("div",{"data-testid":"channel-members-panel",className:"fixed inset-y-0 right-0 w-80 bg-white dark:bg-[var(--color-bg-secondary)] shadow-xl border-l border-gray-200 dark:border-[var(--color-border)] flex flex-col z-50 animate-slide-in-right",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ii,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),o.jsx("h3",{className:"font-medium text-gray-900 dark:text-[var(--color-text)]",children:"Members"}),c&&o.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",c.members.length,")"]})]}),o.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors","data-testid":"close-members-panel",children:o.jsx(wt,{className:"w-5 h-5"})})]}),v&&o.jsx("div",{className:"px-4 py-3 bg-amber-50 border-b border-amber-100",children:o.jsx("p",{className:"text-sm text-amber-800",children:"Direct message channels have fixed membership and cannot be modified."})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:u?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500",children:[o.jsx($e,{className:"w-5 h-5 animate-spin mr-2"}),"Loading members..."]}):d?o.jsxs("div",{className:"flex items-center justify-center py-8 text-red-500",children:[o.jsx(Bt,{className:"w-5 h-5 mr-2"}),"Failed to load members"]}):o.jsx("div",{"data-testid":"members-list",children:c?.members.map(j=>o.jsx(iGe,{member:j,isCreator:j.id===e.createdBy,canModify:!!b,canRemove:j.id!==t&&j.id!==e.createdBy,onRemove:()=>_(j.id),isRemoving:a===j.id},j.id))})}),b&&o.jsx(sGe,{channelId:e.id,currentMembers:e.members,currentOperator:t,onSuccess:()=>{}}),!v&&y&&o.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-[var(--color-border)]",children:[o.jsxs("button",{onClick:N,disabled:m.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors disabled:opacity-50","data-testid":"leave-channel-button",children:[m.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(iwe,{className:"w-4 h-4"}),"Leave Channel"]}),m.isError&&o.jsx("p",{className:"mt-2 text-sm text-red-600 text-center",children:m.error.message})]}),S&&o.jsx("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-[var(--color-border)]",children:o.jsxs("button",{onClick:()=>l(!0),disabled:p.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors disabled:opacity-50","data-testid":"delete-channel-button",children:[p.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(Sr,{className:"w-4 h-4"}),"Delete Channel"]})}),s&&o.jsxs("div",{className:"fixed inset-0 z-[60]",onClick:()=>l(!1),"data-testid":"delete-channel-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm mx-4",onClick:j=>j.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Channel"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsxs("div",{className:"px-5 py-4",children:[o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-3",children:"All messages and data in this channel will be permanently deleted."}),o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-md border border-[var(--color-border)]",children:[o.jsxs("p",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.name,children:["#",e.name]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono mt-1",children:e.id})]})]}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>l(!1),disabled:p.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"delete-channel-cancel",children:"Cancel"}),o.jsxs("button",{onClick:k,disabled:p.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"delete-channel-confirm",children:[p.isPending&&o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Delete"]})]}),p.isError&&o.jsx("div",{className:"px-5 py-3 border-t border-[var(--color-border)]",children:o.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[o.jsx(Bt,{className:"w-4 h-4"}),p.error.message]})})]})})]})]})}function lGe(){return gt({queryKey:["entities"],queryFn:async()=>{const e=await fetch("/api/entities");if(!e.ok)throw new Error("Failed to fetch entities");const t=await e.json();return t.items||t}})}function cGe(){const e=ht();return Ct({mutationFn:async t=>{const r=await fetch("/api/channels",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to create channel")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["channels"]}),e.invalidateQueries({queryKey:["stats"]})}})}function sZ({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=w.useState("group"),[i,s]=w.useState(""),[l,c]=w.useState("private"),[u,d]=w.useState("invite-only"),[f,m]=w.useState([]),[p,v]=w.useState(""),[b,y]=w.useState(""),[S,_]=w.useState([]),N=w.useRef(null),k=cGe(),{data:j}=lGe(),{currentUser:E}=nl();w.useEffect(()=>{e&&N.current&&N.current.focus()},[e]),w.useEffect(()=>{e||(a("group"),s(""),c("private"),d("invite-only"),m([]),v(""),y(""),_([]),k.reset())},[e]);const T=async M=>{if(M.preventDefault(),!E)return;let z;if(n==="group"){if(!i.trim())return;z={channelType:"group",name:i.trim().replace(/\s+/g,"-").toLowerCase(),createdBy:E.id,visibility:l,joinPolicy:u,...f.length>0&&{members:f},...S.length>0&&{tags:S}}}else{if(!p||!b||p===b)return;z={channelType:"direct",createdBy:E.id,entityA:p,entityB:b,...S.length>0&&{tags:S}}}try{const I=await k.mutateAsync(z);r?.(I),t()}catch{}},O=M=>{M.key==="Escape"&&t()},R=M=>{m(z=>z.includes(M)?z.filter(I=>I!==M):[...z,M])},q=i.trim()&&E,L=n==="group"?q:p&&b&&p!==b&&E,A=o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors touch-target","data-testid":"create-channel-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:T,disabled:k.isPending||!L,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"create-channel-submit-button",children:k.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_r,{className:"w-4 h-4"}),"Create"]})})]});return o.jsx(Bx,{open:e,onClose:t,title:"Create Channel",icon:o.jsx(qp,{className:"w-5 h-5 text-blue-500"}),size:"md","data-testid":"create-channel-modal",footer:A,children:o.jsxs("form",{onSubmit:T,className:"p-4",onKeyDown:O,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Channel Type"}),o.jsxs("div",{className:"flex gap-2","data-testid":"create-channel-type-toggle",children:[o.jsxs("button",{type:"button",onClick:()=>a("group"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg border transition-colors touch-target ${n==="group"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,"data-testid":"create-channel-type-group",children:[o.jsx(qp,{className:"w-4 h-4"}),"Group"]}),o.jsxs("button",{type:"button",onClick:()=>a("direct"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg border transition-colors touch-target ${n==="direct"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,"data-testid":"create-channel-type-direct",children:[o.jsx(Ii,{className:"w-4 h-4"}),"Direct"]})]})]}),n==="group"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"channel-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:N,id:"channel-name",type:"text",value:i,onChange:M=>s(M.target.value),placeholder:"Enter channel name...",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-name-input",required:!0,maxLength:100}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Alphanumeric, hyphens, underscores only"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"channel-visibility",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Visibility"}),o.jsxs("select",{id:"channel-visibility",value:l,onChange:M=>c(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-visibility-select",children:[o.jsx("option",{value:"private",children:"Private - Only members can see"}),o.jsx("option",{value:"public",children:"Public - Anyone can see"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"channel-join-policy",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Join Policy"}),o.jsxs("select",{id:"channel-join-policy",value:u,onChange:M=>d(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-join-policy-select",children:[o.jsx("option",{value:"invite-only",children:"Invite Only"}),o.jsx("option",{value:"open",children:"Open - Anyone can join"}),o.jsx("option",{value:"request",children:"Request - Approval required"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Members ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsxs("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg max-h-32 overflow-y-auto bg-white dark:bg-gray-800","data-testid":"create-channel-members-list",children:[j?.filter(M=>M.id!==E?.id).map(M=>o.jsxs("label",{className:"flex items-center gap-2 px-3 py-2.5 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer touch-target",children:[o.jsx("input",{type:"checkbox",checked:f.includes(M.id),onChange:()=>R(M.id),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 w-5 h-5"}),o.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[M.name," (",M.entityType,")"]})]},M.id)),(!j||j.length<=1)&&o.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No other entities available"})]}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Creator is automatically added"})]})]}),n==="direct"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"channel-entity-a",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["First Entity ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{id:"channel-entity-a",value:p,onChange:M=>v(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-entity-a-select",required:!0,children:[o.jsx("option",{value:"",children:"Select entity..."}),j?.map(M=>o.jsxs("option",{value:M.id,children:[M.name," (",M.entityType,")"]},M.id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"channel-entity-b",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Second Entity ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{id:"channel-entity-b",value:b,onChange:M=>y(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-entity-b-select",required:!0,children:[o.jsx("option",{value:"",children:"Select entity..."}),j?.filter(M=>M.id!==p).map(M=>o.jsxs("option",{value:M.id,children:[M.name," (",M.entityType,")"]},M.id))]}),p&&b&&p===b&&o.jsx("p",{className:"mt-1 text-xs text-red-500",children:"Entities must be different"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tags ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsx(aj,{tags:S,onChange:_,placeholder:"Type and press comma to add tags","data-testid":"create-channel-tags-input"})]}),k.isError&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-400","data-testid":"create-channel-error",children:k.error?.message||"Failed to create channel"})]})})}const ix={"nav.activity":{keys:"G A",path:"/activity",description:"Go to Activity",category:"navigation"},"nav.tasks":{keys:"G T",path:"/tasks",description:"Go to Tasks",category:"navigation"},"nav.agents":{keys:"G E",path:"/agents",description:"Go to Agents",category:"navigation"},"nav.workspaces":{keys:"G W",path:"/workspaces",description:"Go to Workspaces",category:"navigation"},"nav.workflows":{keys:"G F",path:"/workflows",description:"Go to Workflows",category:"navigation"},"nav.metrics":{keys:"G M",path:"/metrics",description:"Go to Metrics",category:"navigation"},"nav.settings":{keys:"G S",path:"/settings",description:"Go to Settings",category:"navigation"},"nav.inbox":{keys:"G I",path:"/inbox",description:"Go to Inbox",category:"navigation"},"nav.messages":{keys:"G C",path:"/messages",description:"Go to Messages",category:"navigation"},"nav.documents":{keys:"G D",path:"/documents",description:"Go to Documents",category:"navigation"},"nav.plans":{keys:"G P",path:"/plans",description:"Go to Plans",category:"navigation"},"nav.mergeRequests":{keys:"G R",path:"/merge-requests",description:"Go to Merge Requests",category:"navigation"},"action.commandPalette":{keys:"Cmd+K",description:"Open Command Palette",category:"actions"},"action.toggleSidebar":{keys:"Cmd+B",description:"Toggle Sidebar",category:"actions"},"action.toggleDirector":{keys:"Cmd+D",description:"Toggle Director Panel",category:"actions"},"action.toggleDirectorMaximize":{keys:"Cmd+Shift+D",description:"Maximize/Restore Director Panel",category:"actions"},"action.createTask":{keys:"C T",path:"/tasks?action=create",description:"Create Task",category:"actions"},"action.createBacklogTask":{keys:"C B",path:"/tasks?backlog=true",description:"Create Backlog Task",category:"actions"},"action.createAgent":{keys:"C A",path:"/agents?action=create",description:"Create Agent",category:"actions"},"action.createPlan":{keys:"C P",path:"/plans?action=create",description:"Create Plan",category:"actions"},"action.createDocument":{keys:"C D",path:"/documents?action=create",description:"Create Document",category:"actions"},"action.createWorkflow":{keys:"C W",path:"/workflows?action=create",description:"Create Template",category:"actions"},"action.addPane":{keys:"A P",path:"/workspaces?action=addPane",description:"Add Pane",category:"actions"},"action.refreshActivity":{keys:"R A",description:"Refresh Activity",category:"actions"},"action.quickFileOpen":{keys:"Cmd+P",description:"Quick File Open",category:"actions"}};function Pl(e){return Jz(e,ix)}function nm(e){return e.replace(/Cmd\+/gi,"").replace(/Ctrl\+/gi,"").replace(/Alt\+/gi,"").replace(/Shift\+/gi,"").replace(/\s+/g," ")}const oZ=[{id:"overview",label:"Overview",defaultExpanded:!0,items:[{to:"/activity",icon:Hh,label:"Activity",testId:"nav-activity",actionId:"nav.activity"},{to:"/inbox",icon:rs,label:"Inbox",testId:"nav-inbox",search:{message:void 0},actionId:"nav.inbox"},{to:"/editor",icon:Bs,label:"Editor",testId:"nav-editor",actionId:"nav.editor"}]},{id:"work",label:"Work",defaultExpanded:!0,items:[{to:"/tasks",icon:Tl,label:"Tasks",testId:"nav-tasks",actionId:"nav.tasks"},{to:"/merge-requests",icon:Ri,label:"Merge Requests",testId:"nav-merge-requests",actionId:"nav.mergeRequests"},{to:"/plans",icon:tu,label:"Plans",testId:"nav-plans",actionId:"nav.plans"},{to:"/workflows",icon:vh,label:"Workflows",testId:"nav-workflows",actionId:"nav.workflows"}]},{id:"orchestration",label:"Orchestration",defaultExpanded:!0,items:[{to:"/agents",icon:Ii,label:"Agents",testId:"nav-agents",actionId:"nav.agents"},{to:"/workspaces",icon:bh,label:"Workspaces",testId:"nav-workspaces",actionId:"nav.workspaces"}]},{id:"collaborate",label:"Collaborate",defaultExpanded:!0,items:[{to:"/messages",icon:ss,label:"Messages",testId:"nav-messages",search:{channel:void 0,message:void 0},actionId:"nav.messages"},{to:"/documents",icon:rn,label:"Documents",testId:"nav-documents",search:{selected:void 0,library:void 0},actionId:"nav.documents"}]},{id:"analytics",label:"Analytics",defaultExpanded:!0,items:[{to:"/metrics",icon:GC,label:"Metrics",testId:"nav-metrics",actionId:"nav.metrics"}]}],uGe=[{to:"/settings",icon:li,label:"Settings",testId:"nav-settings",actionId:"nav.settings"}];function lZ({collapsed:e=!1,onToggle:t,isMobileDrawer:r=!1}){const a=UC().location.pathname;Jx();const[i,s]=w.useState(()=>new Set(oZ.filter(p=>p.defaultExpanded).map(p=>p.id))),l=w.useCallback(p=>{s(v=>{const b=new Set(v);return b.has(p)?b.delete(p):b.add(p),b})},[]),c=p=>a===p||a.startsWith(p+"/"),u=(p,v=!1)=>{const b=c(p.to),y=p.icon;return o.jsxs(Aae,{to:p.to,search:p.search,"data-testid":p.testId,className:`
          group relative flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md
          transition-all duration-150 ease-out
          ${v&&!e?"ml-3":""}
          ${b?"bg-[var(--color-sidebar-item-active)] text-[var(--color-sidebar-item-text-active)]":"text-[var(--color-sidebar-item-text)] hover:bg-[var(--color-sidebar-item-hover)] hover:text-[var(--color-text)]"}
          ${e?"justify-center px-2":""}
        `,title:e?p.label:void 0,children:[b&&!e&&o.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-5 bg-[var(--color-primary)] rounded-r-full","data-testid":"active-indicator"}),o.jsx("div",{className:"relative flex-shrink-0",children:o.jsx(y,{className:`w-4 h-4 ${b?"text-[var(--color-sidebar-item-text-active)]":"text-[var(--color-text-tertiary)] group-hover:text-[var(--color-text-secondary)]"}`})}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"flex-1 truncate",children:p.label}),p.actionId&&o.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)] font-mono tracking-wide opacity-0 group-hover:opacity-100 transition-opacity",children:nm(Pl(p.actionId))})]})]},p.to)},d=p=>{const v=i.has(p.id),b=p.items.some(S=>c(S.to)),y=p.icon;return e?o.jsx("div",{className:"space-y-0.5",children:p.items.map(S=>u(S,!1))},p.id):o.jsxs("div",{className:"mb-2","data-testid":`nav-section-${p.id}`,children:[o.jsxs("button",{onClick:()=>l(p.id),className:`
            w-full flex items-center gap-2 px-3 py-1.5 text-xs font-semibold uppercase tracking-wider
            text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]
            transition-colors duration-150 rounded-md hover:bg-[var(--color-sidebar-item-hover)]
            ${b?"text-[var(--color-text-secondary)]":""}
          `,"data-testid":`section-toggle-${p.id}`,children:[y&&o.jsx(y,{className:"w-3.5 h-3.5"}),o.jsx("span",{className:"flex-1 text-left",children:p.label}),o.jsx(cr,{className:`w-3.5 h-3.5 transition-transform duration-200 ${v?"":"-rotate-90"}`})]}),o.jsx("div",{className:`
            mt-1 space-y-0.5 overflow-hidden transition-all duration-200 ease-out
            ${v?"max-h-96 opacity-100":"max-h-0 opacity-0"}
          `,children:p.items.map(S=>u(S,!0))})]},p.id)},f=e&&!r,m=!e||r;return o.jsxs("aside",{className:`
        flex flex-col bg-[var(--color-sidebar-bg)]
        transition-all duration-200 ease-out
        ${r?"w-full h-full border-none":"border-r border-[var(--color-sidebar-border)]"}
        ${!r&&e?"w-16":r?"":"w-60"}
      `,"data-testid":"sidebar",children:[o.jsxs("div",{className:`flex items-center justify-between h-14 px-4 border-b border-[var(--color-sidebar-border)] ${r?"pr-12":""}`,children:[m&&o.jsxs("div",{className:"flex items-center gap-2.5 ml-1",children:[o.jsx("img",{src:"/logo.png",alt:"",className:"w-7 h-7 object-contain"}),o.jsx("span",{className:"text-xl font-semibold tracking-wide text-[var(--color-text)]",style:{fontFamily:"'Space Grotesk', ui-sans-serif, system-ui, sans-serif"},children:"stoneforge"})]}),f&&o.jsx("img",{src:"/logo.png",alt:"Stoneforge",className:"w-7 h-7 object-contain mx-auto"}),m&&!r&&o.jsx("button",{onClick:t,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-sidebar-item-hover)] transition-colors duration-150","aria-label":"Collapse sidebar","aria-expanded":"true","data-testid":"sidebar-toggle",children:o.jsx(Fl,{className:"w-4 h-4"})})]}),o.jsx("nav",{className:"flex-1 px-2 py-3 overflow-y-auto scrollbar-thin scrollbar-thumb-[var(--color-border)] scrollbar-track-transparent",children:oZ.map(d)}),o.jsx("div",{className:"px-2 py-3 border-t border-[var(--color-sidebar-border)] space-y-0.5",children:uGe.map(p=>u(p,!1))}),f&&!r&&o.jsx("div",{className:"px-2 py-3 border-t border-[var(--color-sidebar-border)]",children:o.jsx(Cn,{content:"Expand sidebar",shortcut:"B",side:"right",children:o.jsx("button",{onClick:t,className:"w-full flex items-center justify-center p-2 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-sidebar-item-hover)] transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:ring-offset-1 focus:ring-offset-[var(--color-sidebar-bg)]","aria-label":"Expand sidebar","aria-expanded":"false","data-testid":"sidebar-expand-button",children:o.jsx(swe,{className:"w-5 h-5"})})})}),m&&!r&&o.jsxs("div",{className:"px-4 py-2 text-[10px] text-[var(--color-text-muted)] border-t border-[var(--color-sidebar-border)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-[var(--color-surface-hover)] text-[var(--color-text-tertiary)] font-mono",children:"K"})," ","for commands"]})]})}/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var fhe=Object.defineProperty,dGe=Object.getOwnPropertyDescriptor,fGe=(e,t)=>{for(var r in t)fhe(e,r,{get:t[r],enumerable:!0})},Zn=(e,t,r,n)=>{for(var a=n>1?void 0:n?dGe(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(a=(n?s(t,r,a):s(a))||a);return n&&a&&fhe(t,r,a),a},ft=(e,t)=>(r,n)=>t(r,n,e),cZ="Terminal input",QR={get:()=>cZ,set:e=>cZ=e},uZ="Too much output to announce, navigate to rows manually to read",JR={get:()=>uZ,set:e=>uZ=e};function hGe(e){return e.replace(/\r?\n/g,"\r")}function mGe(e,t){return t?"\x1B[200~"+e+"\x1B[201~":e}function pGe(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()}function gGe(e,t,r,n){if(e.stopPropagation(),e.clipboardData){let a=e.clipboardData.getData("text/plain");hhe(a,t,r,n)}}function hhe(e,t,r,n){e=hGe(e),e=mGe(e,r.decPrivateModes.bracketedPasteMode&&n.rawOptions.ignoreBracketedPasteMode!==!0),r.triggerDataEvent(e,!0),t.value=""}function mhe(e,t,r){let n=r.getBoundingClientRect(),a=e.clientX-n.left-10,i=e.clientY-n.top-10;t.style.width="20px",t.style.height="20px",t.style.left=`${a}px`,t.style.top=`${i}px`,t.style.zIndex="1000",t.focus()}function dZ(e,t,r,n,a){mhe(e,t,r),a&&n.rightClickSelect(e),t.value=n.selectionText,t.select()}function ld(e){return e>65535?(e-=65536,String.fromCharCode((e>>10)+55296)+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)}function u2(e,t=0,r=e.length){let n="";for(let a=t;a<r;++a){let i=e[a];i>65535?(i-=65536,n+=String.fromCharCode((i>>10)+55296)+String.fromCharCode(i%1024+56320)):n+=String.fromCharCode(i)}return n}var vGe=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,t){let r=e.length;if(!r)return 0;let n=0,a=0;if(this._interim){let i=e.charCodeAt(a++);56320<=i&&i<=57343?t[n++]=(this._interim-55296)*1024+i-56320+65536:(t[n++]=this._interim,t[n++]=i),this._interim=0}for(let i=a;i<r;++i){let s=e.charCodeAt(i);if(55296<=s&&s<=56319){if(++i>=r)return this._interim=s,n;let l=e.charCodeAt(i);56320<=l&&l<=57343?t[n++]=(s-55296)*1024+l-56320+65536:(t[n++]=s,t[n++]=l);continue}s!==65279&&(t[n++]=s)}return n}},bGe=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,t){let r=e.length;if(!r)return 0;let n=0,a,i,s,l,c=0,u=0;if(this.interim[0]){let m=!1,p=this.interim[0];p&=(p&224)===192?31:(p&240)===224?15:7;let v=0,b;for(;(b=this.interim[++v]&63)&&v<4;)p<<=6,p|=b;let y=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,S=y-v;for(;u<S;){if(u>=r)return 0;if(b=e[u++],(b&192)!==128){u--,m=!0;break}else this.interim[v++]=b,p<<=6,p|=b&63}m||(y===2?p<128?u--:t[n++]=p:y===3?p<2048||p>=55296&&p<=57343||p===65279||(t[n++]=p):p<65536||p>1114111||(t[n++]=p)),this.interim.fill(0)}let d=r-4,f=u;for(;f<r;){for(;f<d&&!((a=e[f])&128)&&!((i=e[f+1])&128)&&!((s=e[f+2])&128)&&!((l=e[f+3])&128);)t[n++]=a,t[n++]=i,t[n++]=s,t[n++]=l,f+=4;if(a=e[f++],a<128)t[n++]=a;else if((a&224)===192){if(f>=r)return this.interim[0]=a,n;if(i=e[f++],(i&192)!==128){f--;continue}if(c=(a&31)<<6|i&63,c<128){f--;continue}t[n++]=c}else if((a&240)===224){if(f>=r)return this.interim[0]=a,n;if(i=e[f++],(i&192)!==128){f--;continue}if(f>=r)return this.interim[0]=a,this.interim[1]=i,n;if(s=e[f++],(s&192)!==128){f--;continue}if(c=(a&15)<<12|(i&63)<<6|s&63,c<2048||c>=55296&&c<=57343||c===65279)continue;t[n++]=c}else if((a&248)===240){if(f>=r)return this.interim[0]=a,n;if(i=e[f++],(i&192)!==128){f--;continue}if(f>=r)return this.interim[0]=a,this.interim[1]=i,n;if(s=e[f++],(s&192)!==128){f--;continue}if(f>=r)return this.interim[0]=a,this.interim[1]=i,this.interim[2]=s,n;if(l=e[f++],(l&192)!==128){f--;continue}if(c=(a&7)<<18|(i&63)<<12|(s&63)<<6|l&63,c<65536||c>1114111)continue;t[n++]=c}}return n}},phe="",wd=" ",o1=class ghe{constructor(){this.fg=0,this.bg=0,this.extended=new tC}static toColorRGB(t){return[t>>>16&255,t>>>8&255,t&255]}static fromColorRGB(t){return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255}clone(){let t=new ghe;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}isInverse(){return this.fg&67108864}isBold(){return this.fg&134217728}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:this.fg&268435456}isBlink(){return this.fg&536870912}isInvisible(){return this.fg&1073741824}isItalic(){return this.bg&67108864}isDim(){return this.bg&134217728}isStrikethrough(){return this.fg&2147483648}isProtected(){return this.bg&536870912}isOverline(){return this.bg&1073741824}getFgColorMode(){return this.fg&50331648}getBgColorMode(){return this.bg&50331648}isFgRGB(){return(this.fg&50331648)===50331648}isBgRGB(){return(this.bg&50331648)===50331648}isFgPalette(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432}isBgPalette(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432}isFgDefault(){return(this.fg&50331648)===0}isBgDefault(){return(this.bg&50331648)===0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}}getBgColor(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}}hasExtendedAttrs(){return this.bg&268435456}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(this.bg&268435456&&~this.extended.underlineColor)switch(this.extended.underlineColor&50331648){case 16777216:case 33554432:return this.extended.underlineColor&255;case 50331648:return this.extended.underlineColor&16777215;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return this.bg&268435456&&~this.extended.underlineColor?this.extended.underlineColor&50331648:this.getFgColorMode()}isUnderlineColorRGB(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===50331648:this.isFgRGB()}isUnderlineColorPalette(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===16777216||(this.extended.underlineColor&50331648)===33554432:this.isFgPalette()}isUnderlineColorDefault(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===0:this.isFgDefault()}getUnderlineStyle(){return this.fg&268435456?this.bg&268435456?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}},tC=class vhe{constructor(t=0,r=0){this._ext=0,this._urlId=0,this._ext=t,this._urlId=r}get ext(){return this._urlId?this._ext&-469762049|this.underlineStyle<<26:this._ext}set ext(t){this._ext=t}get underlineStyle(){return this._urlId?5:(this._ext&469762048)>>26}set underlineStyle(t){this._ext&=-469762049,this._ext|=t<<26&469762048}get underlineColor(){return this._ext&67108863}set underlineColor(t){this._ext&=-67108864,this._ext|=t&67108863}get urlId(){return this._urlId}set urlId(t){this._urlId=t}get underlineVariantOffset(){let t=(this._ext&3758096384)>>29;return t<0?t^4294967288:t}set underlineVariantOffset(t){this._ext&=536870911,this._ext|=t<<29&3758096384}clone(){return new vhe(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}},So=class bhe extends o1{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new tC,this.combinedData=""}static fromCharData(t){let r=new bhe;return r.setFromCharData(t),r}isCombined(){return this.content&2097152}getWidth(){return this.content>>22}getChars(){return this.content&2097152?this.combinedData:this.content&2097151?ld(this.content&2097151):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151}setFromCharData(t){this.fg=t[0],this.bg=0;let r=!1;if(t[1].length>2)r=!0;else if(t[1].length===2){let n=t[1].charCodeAt(0);if(55296<=n&&n<=56319){let a=t[1].charCodeAt(1);56320<=a&&a<=57343?this.content=(n-55296)*1024+a-56320+65536|t[2]<<22:r=!0}else r=!0}else this.content=t[1].charCodeAt(0)|t[2]<<22;r&&(this.combinedData=t[1],this.content=2097152|t[2]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},fZ="di$target",ZR="di$dependencies",oL=new Map;function yGe(e){return e[ZR]||[]}function Ka(e){if(oL.has(e))return oL.get(e);let t=function(r,n,a){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");xGe(t,r,a)};return t._id=e,oL.set(e,t),t}function xGe(e,t,r){t[fZ]===t?t[ZR].push({id:e,index:r}):(t[ZR]=[{id:e,index:r}],t[fZ]=t)}var Fi=Ka("BufferService"),yhe=Ka("CoreMouseService"),am=Ka("CoreService"),wGe=Ka("CharsetService"),uB=Ka("InstantiationService"),xhe=Ka("LogService"),Ui=Ka("OptionsService"),whe=Ka("OscLinkService"),SGe=Ka("UnicodeService"),l1=Ka("DecorationService"),XR=class{constructor(t,r,n){this._bufferService=t,this._optionsService=r,this._oscLinkService=n}provideLinks(t,r){let n=this._bufferService.buffer.lines.get(t-1);if(!n){r(void 0);return}let a=[],i=this._optionsService.rawOptions.linkHandler,s=new So,l=n.getTrimmedLength(),c=-1,u=-1,d=!1;for(let f=0;f<l;f++)if(!(u===-1&&!n.hasContent(f))){if(n.loadCell(f,s),s.hasExtendedAttrs()&&s.extended.urlId)if(u===-1){u=f,c=s.extended.urlId;continue}else d=s.extended.urlId!==c;else u!==-1&&(d=!0);if(d||u!==-1&&f===l-1){let m=this._oscLinkService.getLinkData(c)?.uri;if(m){let p={start:{x:u+1,y:t},end:{x:f+(!d&&f===l-1?1:0),y:t}},v=!1;if(!i?.allowNonHttpProtocols)try{let b=new URL(m);["http:","https:"].includes(b.protocol)||(v=!0)}catch{v=!0}v||a.push({text:m,range:p,activate:(b,y)=>i?i.activate(b,y,p):kGe(b,y),hover:(b,y)=>i?.hover?.(b,y,p),leave:(b,y)=>i?.leave?.(b,y,p)})}d=!1,s.hasExtendedAttrs()&&s.extended.urlId?(u=f,c=s.extended.urlId):(u=-1,c=-1)}}r(a)}};XR=Zn([ft(0,Fi),ft(1,Ui),ft(2,whe)],XR);function kGe(e,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){let r=window.open();if(r){try{r.opener=null}catch{}r.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}var d2=Ka("CharSizeService"),vu=Ka("CoreBrowserService"),dB=Ka("MouseService"),bu=Ka("RenderService"),_Ge=Ka("SelectionService"),She=Ka("CharacterJoinerService"),m0=Ka("ThemeService"),khe=Ka("LinkProviderService"),NGe=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?hZ.isErrorNoTelemetry(e)?new hZ(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},CGe=new NGe;function kk(e){jGe(e)||CGe.onUnexpectedError(e)}var eP="Canceled";function jGe(e){return e instanceof EGe?!0:e instanceof Error&&e.name===eP&&e.message===eP}var EGe=class extends Error{constructor(){super(eP),this.name=this.message}};function MGe(e){return new Error(`Illegal argument: ${e}`)}var hZ=class tP extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof tP)return t;let r=new tP;return r.message=t.message,r.stack=t.stack,r}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},rP=class _he extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,_he.prototype)}};function gs(e,t=0){return e[e.length-(1+t)]}var TGe;(e=>{function t(i){return i<0}e.isLessThan=t;function r(i){return i<=0}e.isLessThanOrEqual=r;function n(i){return i>0}e.isGreaterThan=n;function a(i){return i===0}e.isNeitherLessOrGreaterThan=a,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(TGe||(TGe={}));function AGe(e,t){let r=this,n=!1,a;return function(){return n||(n=!0,t||(a=e.apply(r,arguments))),a}}var Nhe;(e=>{function t(k){return k&&typeof k=="object"&&typeof k[Symbol.iterator]=="function"}e.is=t;let r=Object.freeze([]);function n(){return r}e.empty=n;function*a(k){yield k}e.single=a;function i(k){return t(k)?k:a(k)}e.wrap=i;function s(k){return k||r}e.from=s;function*l(k){for(let j=k.length-1;j>=0;j--)yield k[j]}e.reverse=l;function c(k){return!k||k[Symbol.iterator]().next().done===!0}e.isEmpty=c;function u(k){return k[Symbol.iterator]().next().value}e.first=u;function d(k,j){let E=0;for(let T of k)if(j(T,E++))return!0;return!1}e.some=d;function f(k,j){for(let E of k)if(j(E))return E}e.find=f;function*m(k,j){for(let E of k)j(E)&&(yield E)}e.filter=m;function*p(k,j){let E=0;for(let T of k)yield j(T,E++)}e.map=p;function*v(k,j){let E=0;for(let T of k)yield*j(T,E++)}e.flatMap=v;function*b(...k){for(let j of k)yield*j}e.concat=b;function y(k,j,E){let T=E;for(let O of k)T=j(T,O);return T}e.reduce=y;function*S(k,j,E=k.length){for(j<0&&(j+=k.length),E<0?E+=k.length:E>k.length&&(E=k.length);j<E;j++)yield k[j]}e.slice=S;function _(k,j=Number.POSITIVE_INFINITY){let E=[];if(j===0)return[E,k];let T=k[Symbol.iterator]();for(let O=0;O<j;O++){let R=T.next();if(R.done)return[E,e.empty()];E.push(R.value)}return[E,{[Symbol.iterator](){return T}}]}e.consume=_;async function N(k){let j=[];for await(let E of k)j.push(E);return Promise.resolve(j)}e.asyncToArray=N})(Nhe||(Nhe={}));function Dh(e){if(Nhe.is(e)){let t=[];for(let r of e)if(r)try{r.dispose()}catch(n){t.push(n)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function DGe(...e){return Mn(()=>Dh(e))}function Mn(e){return{dispose:AGe(()=>{e()})}}var Che=class jhe{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Dh(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?jhe.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),void 0)}};Che.DISABLE_DISPOSED_WARNING=!1;var Td=Che,hr=class{constructor(){this._store=new Td,this._store}dispose(){this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}};hr.None=Object.freeze({dispose(){}});var Lg=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t}},qc=typeof window=="object"?window:globalThis,nP=class aP{constructor(t){this.element=t,this.next=aP.Undefined,this.prev=aP.Undefined}};nP.Undefined=new nP(void 0);var Rn=nP,mZ=class{constructor(){this._first=Rn.Undefined,this._last=Rn.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Rn.Undefined}clear(){let t=this._first;for(;t!==Rn.Undefined;){let r=t.next;t.prev=Rn.Undefined,t.next=Rn.Undefined,t=r}this._first=Rn.Undefined,this._last=Rn.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,r){let n=new Rn(t);if(this._first===Rn.Undefined)this._first=n,this._last=n;else if(r){let i=this._last;this._last=n,n.prev=i,i.next=n}else{let i=this._first;this._first=n,n.next=i,i.prev=n}this._size+=1;let a=!1;return()=>{a||(a=!0,this._remove(n))}}shift(){if(this._first!==Rn.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==Rn.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==Rn.Undefined&&t.next!==Rn.Undefined){let r=t.prev;r.next=t.next,t.next.prev=r}else t.prev===Rn.Undefined&&t.next===Rn.Undefined?(this._first=Rn.Undefined,this._last=Rn.Undefined):t.next===Rn.Undefined?(this._last=this._last.prev,this._last.next=Rn.Undefined):t.prev===Rn.Undefined&&(this._first=this._first.next,this._first.prev=Rn.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==Rn.Undefined;)yield t.element,t=t.next}},LGe=globalThis.performance&&typeof globalThis.performance.now=="function",OGe=class Ehe{static create(t){return new Ehe(t)}constructor(t){this._now=LGe&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},ii;(e=>{e.None=()=>hr.None;function t(L,A){return f(L,()=>{},0,void 0,!0,void 0,A)}e.defer=t;function r(L){return(A,M=null,z)=>{let I=!1,B;return B=L(F=>{if(!I)return B?B.dispose():I=!0,A.call(M,F)},null,z),I&&B.dispose(),B}}e.once=r;function n(L,A,M){return u((z,I=null,B)=>L(F=>z.call(I,A(F)),null,B),M)}e.map=n;function a(L,A,M){return u((z,I=null,B)=>L(F=>{A(F),z.call(I,F)},null,B),M)}e.forEach=a;function i(L,A,M){return u((z,I=null,B)=>L(F=>A(F)&&z.call(I,F),null,B),M)}e.filter=i;function s(L){return L}e.signal=s;function l(...L){return(A,M=null,z)=>{let I=DGe(...L.map(B=>B(F=>A.call(M,F))));return d(I,z)}}e.any=l;function c(L,A,M,z){let I=M;return n(L,B=>(I=A(I,B),I),z)}e.reduce=c;function u(L,A){let M,z={onWillAddFirstListener(){M=L(I.fire,I)},onDidRemoveLastListener(){M?.dispose()}},I=new nt(z);return A?.add(I),I.event}function d(L,A){return A instanceof Array?A.push(L):A&&A.add(L),L}function f(L,A,M=100,z=!1,I=!1,B,F){let U,V,K,G=0,J,ee={leakWarningThreshold:B,onWillAddFirstListener(){U=L(ie=>{G++,V=A(V,ie),z&&!K&&(Y.fire(V),V=void 0),J=()=>{let fe=V;V=void 0,K=void 0,(!z||G>1)&&Y.fire(fe),G=0},typeof M=="number"?(clearTimeout(K),K=setTimeout(J,M)):K===void 0&&(K=0,queueMicrotask(J))})},onWillRemoveListener(){I&&G>0&&J?.()},onDidRemoveLastListener(){J=void 0,U.dispose()}},Y=new nt(ee);return F?.add(Y),Y.event}e.debounce=f;function m(L,A=0,M){return e.debounce(L,(z,I)=>z?(z.push(I),z):[I],A,void 0,!0,void 0,M)}e.accumulate=m;function p(L,A=(z,I)=>z===I,M){let z=!0,I;return i(L,B=>{let F=z||!A(B,I);return z=!1,I=B,F},M)}e.latch=p;function v(L,A,M){return[e.filter(L,A,M),e.filter(L,z=>!A(z),M)]}e.split=v;function b(L,A=!1,M=[],z){let I=M.slice(),B=L(V=>{I?I.push(V):U.fire(V)});z&&z.add(B);let F=()=>{I?.forEach(V=>U.fire(V)),I=null},U=new nt({onWillAddFirstListener(){B||(B=L(V=>U.fire(V)),z&&z.add(B))},onDidAddFirstListener(){I&&(A?setTimeout(F):F())},onDidRemoveLastListener(){B&&B.dispose(),B=null}});return z&&z.add(U),U.event}e.buffer=b;function y(L,A){return(M,z,I)=>{let B=A(new _);return L(function(F){let U=B.evaluate(F);U!==S&&M.call(z,U)},void 0,I)}}e.chain=y;let S=Symbol("HaltChainable");class _{constructor(){this.steps=[]}map(A){return this.steps.push(A),this}forEach(A){return this.steps.push(M=>(A(M),M)),this}filter(A){return this.steps.push(M=>A(M)?M:S),this}reduce(A,M){let z=M;return this.steps.push(I=>(z=A(z,I),z)),this}latch(A=(M,z)=>M===z){let M=!0,z;return this.steps.push(I=>{let B=M||!A(I,z);return M=!1,z=I,B?I:S}),this}evaluate(A){for(let M of this.steps)if(A=M(A),A===S)break;return A}}function N(L,A,M=z=>z){let z=(...U)=>F.fire(M(...U)),I=()=>L.on(A,z),B=()=>L.removeListener(A,z),F=new nt({onWillAddFirstListener:I,onDidRemoveLastListener:B});return F.event}e.fromNodeEventEmitter=N;function k(L,A,M=z=>z){let z=(...U)=>F.fire(M(...U)),I=()=>L.addEventListener(A,z),B=()=>L.removeEventListener(A,z),F=new nt({onWillAddFirstListener:I,onDidRemoveLastListener:B});return F.event}e.fromDOMEventEmitter=k;function j(L){return new Promise(A=>r(L)(A))}e.toPromise=j;function E(L){let A=new nt;return L.then(M=>{A.fire(M)},()=>{A.fire(void 0)}).finally(()=>{A.dispose()}),A.event}e.fromPromise=E;function T(L,A){return L(M=>A.fire(M))}e.forward=T;function O(L,A,M){return A(M),L(z=>A(z))}e.runAndSubscribe=O;class R{constructor(A,M){this._observable=A,this._counter=0,this._hasChanged=!1;let z={onWillAddFirstListener:()=>{A.addObserver(this)},onDidRemoveLastListener:()=>{A.removeObserver(this)}};this.emitter=new nt(z),M&&M.add(this.emitter)}beginUpdate(A){this._counter++}handlePossibleChange(A){}handleChange(A,M){this._hasChanged=!0}endUpdate(A){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function q(L,A){return new R(L,A).emitter.event}e.fromObservable=q;function $(L){return(A,M,z)=>{let I=0,B=!1,F={beginUpdate(){I++},endUpdate(){I--,I===0&&(L.reportChanges(),B&&(B=!1,A.call(M)))},handlePossibleChange(){},handleChange(){B=!0}};L.addObserver(F),L.reportChanges();let U={dispose(){L.removeObserver(F)}};return z instanceof Td?z.add(U):Array.isArray(z)&&z.push(U),U}}e.fromObservableLight=$})(ii||(ii={}));var iP=class sP{constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${sP._idPool++}`,sP.all.add(this)}start(t){this._stopWatch=new OGe,this.listenerCount=t}stop(){if(this._stopWatch){let t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}};iP.all=new Set,iP._idPool=0;var IGe=iP,RGe=-1,Mhe=class The{constructor(t,r,n=(The._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t,this.threshold=r,this.name=n,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(t,r){let n=this.threshold;if(n<=0||r<n)return;this._stacks||(this._stacks=new Map);let a=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,a+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[i,s]=this.getMostFrequentStack(),l=`[${this.name}] potential listener LEAK detected, having ${r} listeners already. MOST frequent listener (${s}):`;console.warn(l),console.warn(i);let c=new BGe(l,i);this._errorHandler(c)}return()=>{let i=this._stacks.get(t.value)||0;this._stacks.set(t.value,i-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,r=0;for(let[n,a]of this._stacks)(!t||r<a)&&(t=[n,a],r=a);return t}};Mhe._idPool=1;var PGe=Mhe,zGe=class Ahe{constructor(t){this.value=t}static create(){let t=new Error;return new Ahe(t.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},BGe=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},$Ge=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},FGe=0,lL=class{constructor(t){this.value=t,this.id=FGe++}},UGe=2,HGe,nt=class{constructor(t){this._size=0,this._options=t,this._leakageMon=this._options?.leakWarningThreshold?new PGe(t?.onListenerError??kk,this._options?.leakWarningThreshold??RGe):void 0,this._perfMon=this._options?._profName?new IGe(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??(this._event=(t,r,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let c=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],u=new $Ge(`${l}. HINT: Stack shows most frequent listener (${c[1]}-times)`,c[0]);return(this._options?.onListenerError||kk)(u),hr.None}if(this._disposed)return hr.None;r&&(t=t.bind(r));let a=new lL(t),i;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(a.stack=zGe.create(),i=this._leakageMon.check(a.stack,this._size+1)),this._listeners?this._listeners instanceof lL?(this._deliveryQueue??(this._deliveryQueue=new qGe),this._listeners=[this._listeners,a]):this._listeners.push(a):(this._options?.onWillAddFirstListener?.(this),this._listeners=a,this._options?.onDidAddFirstListener?.(this)),this._size++;let s=Mn(()=>{i?.(),this._removeListener(a)});return n instanceof Td?n.add(s):Array.isArray(n)&&n.push(s),s}),this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let r=this._listeners,n=r.indexOf(t);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[n]=void 0;let a=this._deliveryQueue.current===this;if(this._size*UGe<=r.length){let i=0;for(let s=0;s<r.length;s++)r[s]?r[i++]=r[s]:a&&(this._deliveryQueue.end--,i<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=i}}_deliver(t,r){if(!t)return;let n=this._options?.onListenerError||kk;if(!n){t.value(r);return}try{t.value(r)}catch(a){n(a)}}_deliverQueue(t){let r=t.current._listeners;for(;t.i<t.end;)this._deliver(r[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof lL)this._deliver(this._listeners,t);else{let r=this._deliveryQueue;r.enqueue(this,t,this._listeners.length),this._deliverQueue(r)}this._perfMon?.stop()}hasListeners(){return this._size>0}},qGe=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,r){this.i=0,this.end=r,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},oP=class{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new nt,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new nt,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}getZoomLevel(t){return this.mapWindowIdToZoomLevel.get(this.getWindowId(t))??0}setZoomLevel(t,r){if(this.getZoomLevel(r)===t)return;let n=this.getWindowId(r);this.mapWindowIdToZoomLevel.set(n,t),this._onDidChangeZoomLevel.fire(n)}getZoomFactor(t){return this.mapWindowIdToZoomFactor.get(this.getWindowId(t))??1}setZoomFactor(t,r){this.mapWindowIdToZoomFactor.set(this.getWindowId(r),t)}setFullscreen(t,r){if(this.isFullscreen(r)===t)return;let n=this.getWindowId(r);this.mapWindowIdToFullScreen.set(n,t),this._onDidChangeFullscreen.fire(n)}isFullscreen(t){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(t))}getWindowId(t){return t.vscodeWindowId}};oP.INSTANCE=new oP;var fB=oP;function WGe(e,t,r){typeof t=="string"&&(t=e.matchMedia(t)),t.addEventListener("change",r)}fB.INSTANCE.onDidChangeZoomLevel;function KGe(e){return fB.INSTANCE.getZoomFactor(e)}fB.INSTANCE.onDidChangeFullscreen;var p0=typeof navigator=="object"?navigator.userAgent:"",lP=p0.indexOf("Firefox")>=0,GGe=p0.indexOf("AppleWebKit")>=0,hB=p0.indexOf("Chrome")>=0,VGe=!hB&&p0.indexOf("Safari")>=0;p0.indexOf("Electron/")>=0;p0.indexOf("Android")>=0;var cL=!1;if(typeof qc.matchMedia=="function"){let e=qc.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),t=qc.matchMedia("(display-mode: fullscreen)");cL=e.matches,WGe(qc,e,({matches:r})=>{cL&&t.matches||(cL=r)})}var Tp="en",cP=!1,uP=!1,_k=!1,Dhe=!1,ES,Nk=Tp,pZ=Tp,YGe,Oc,uh=globalThis,ks;typeof uh.vscode<"u"&&typeof uh.vscode.process<"u"?ks=uh.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(ks=process);var QGe=typeof ks?.versions?.electron=="string",JGe=QGe&&ks?.type==="renderer";if(typeof ks=="object"){cP=ks.platform==="win32",uP=ks.platform==="darwin",_k=ks.platform==="linux",_k&&ks.env.SNAP&&ks.env.SNAP_REVISION,ks.env.CI||ks.env.BUILD_ARTIFACTSTAGINGDIRECTORY,ES=Tp,Nk=Tp;let e=ks.env.VSCODE_NLS_CONFIG;if(e)try{let t=JSON.parse(e);ES=t.userLocale,pZ=t.osLocale,Nk=t.resolvedLanguage||Tp,YGe=t.languagePack?.translationsConfigFile}catch{}Dhe=!0}else typeof navigator=="object"&&!JGe?(Oc=navigator.userAgent,cP=Oc.indexOf("Windows")>=0,uP=Oc.indexOf("Macintosh")>=0,(Oc.indexOf("Macintosh")>=0||Oc.indexOf("iPad")>=0||Oc.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_k=Oc.indexOf("Linux")>=0,Oc?.indexOf("Mobi")>=0,Nk=globalThis._VSCODE_NLS_LANGUAGE||Tp,ES=navigator.language.toLowerCase(),pZ=ES):console.error("Unable to resolve platform.");var Lhe=cP,Cl=uP,ZGe=_k,gZ=Dhe,zl=Oc,Yu=Nk,XGe;(e=>{function t(){return Yu}e.value=t;function r(){return Yu.length===2?Yu==="en":Yu.length>=3?Yu[0]==="e"&&Yu[1]==="n"&&Yu[2]==="-":!1}e.isDefaultVariant=r;function n(){return Yu==="en"}e.isDefault=n})(XGe||(XGe={}));var eVe=typeof uh.postMessage=="function"&&!uh.importScripts;(()=>{if(eVe){let e=[];uh.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,a=e.length;n<a;n++){let i=e[n];if(i.id===r.data.vscodeScheduleAsyncWork){e.splice(n,1),i.callback();return}}});let t=0;return r=>{let n=++t;e.push({id:n,callback:r}),uh.postMessage({vscodeScheduleAsyncWork:n},"*")}}return e=>setTimeout(e)})();var tVe=!!(zl&&zl.indexOf("Chrome")>=0);zl&&zl.indexOf("Firefox")>=0;!tVe&&zl&&zl.indexOf("Safari")>=0;zl&&zl.indexOf("Edg/")>=0;zl&&zl.indexOf("Android")>=0;var tp=typeof navigator=="object"?navigator:{};gZ||document.queryCommandSupported&&document.queryCommandSupported("copy")||tp&&tp.clipboard&&tp.clipboard.writeText,gZ||tp&&tp.clipboard&&tp.clipboard.readText;var mB=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},uL=new mB,vZ=new mB,bZ=new mB,rVe=new Array(230),Ohe;(e=>{function t(l){return uL.keyCodeToStr(l)}e.toString=t;function r(l){return uL.strToKeyCode(l)}e.fromString=r;function n(l){return vZ.keyCodeToStr(l)}e.toUserSettingsUS=n;function a(l){return bZ.keyCodeToStr(l)}e.toUserSettingsGeneral=a;function i(l){return vZ.strToKeyCode(l)||bZ.strToKeyCode(l)}e.fromUserSettings=i;function s(l){if(l>=98&&l<=113)return null;switch(l){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return uL.keyCodeToStr(l)}e.toElectronAccelerator=s})(Ohe||(Ohe={}));var nVe=class Ihe{constructor(t,r,n,a,i){this.ctrlKey=t,this.shiftKey=r,this.altKey=n,this.metaKey=a,this.keyCode=i}equals(t){return t instanceof Ihe&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){let t=this.ctrlKey?"1":"0",r=this.shiftKey?"1":"0",n=this.altKey?"1":"0",a=this.metaKey?"1":"0";return`K${t}${r}${n}${a}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new aVe([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},aVe=class{constructor(e){if(e.length===0)throw MGe("chords");this.chords=e}getHashCode(){let e="";for(let t=0,r=this.chords.length;t<r;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};function iVe(e){if(e.charCode){let r=String.fromCharCode(e.charCode).toUpperCase();return Ohe.fromString(r)}let t=e.keyCode;if(t===3)return 7;if(lP)switch(t){case 59:return 85;case 60:if(ZGe)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Cl)return 57;break}else if(GGe&&(Cl&&t===93||!Cl&&t===92))return 57;return rVe[t]||0}var sVe=Cl?256:2048,oVe=512,lVe=1024,cVe=Cl?2048:256,yZ=class{constructor(t){this._standardKeyboardEventBrand=!0;let r=t;this.browserEvent=r,this.target=r.target,this.ctrlKey=r.ctrlKey,this.shiftKey=r.shiftKey,this.altKey=r.altKey,this.metaKey=r.metaKey,this.altGraphKey=r.getModifierState?.("AltGraph"),this.keyCode=iVe(r),this.code=r.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let r=0;return this.ctrlKey&&(r|=sVe),this.altKey&&(r|=oVe),this.shiftKey&&(r|=lVe),this.metaKey&&(r|=cVe),r|=t,r}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new nVe(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}},xZ=new WeakMap;function uVe(e){if(!e.parent||e.parent===e)return null;try{let t=e.location,r=e.parent.location;if(t.origin!=="null"&&r.origin!=="null"&&t.origin!==r.origin)return null}catch{return null}return e.parent}var dVe=class{static getSameOriginWindowChain(e){let t=xZ.get(e);if(!t){t=[],xZ.set(e,t);let r=e,n;do n=uVe(r),n?t.push({window:new WeakRef(r),iframeElement:r.frameElement||null}):t.push({window:new WeakRef(r),iframeElement:null}),r=n;while(r)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let r=0,n=0,a=this.getSameOriginWindowChain(e);for(let i of a){let s=i.window.deref();if(r+=s?.scrollY??0,n+=s?.scrollX??0,s===t||!i.iframeElement)break;let l=i.iframeElement.getBoundingClientRect();r+=l.top,n+=l.left}return{top:r,left:n}}},MS=class{constructor(t,r){this.timestamp=Date.now(),this.browserEvent=r,this.leftButton=r.button===0,this.middleButton=r.button===1,this.rightButton=r.button===2,this.buttons=r.buttons,this.target=r.target,this.detail=r.detail||1,r.type==="dblclick"&&(this.detail=2),this.ctrlKey=r.ctrlKey,this.shiftKey=r.shiftKey,this.altKey=r.altKey,this.metaKey=r.metaKey,typeof r.pageX=="number"?(this.posx=r.pageX,this.posy=r.pageY):(this.posx=r.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=r.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=dVe.getPositionOfChildWindowRelativeToAncestorWindow(t,r.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}},wZ=class{constructor(e,t=0,r=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=r,this.deltaX=t;let n=!1;if(hB){let a=navigator.userAgent.match(/Chrome\/(\d+)/);n=(a?parseInt(a[1]):123)<=122}if(e){let a=e,i=e,s=e.view?.devicePixelRatio||1;if(typeof a.wheelDeltaY<"u")n?this.deltaY=a.wheelDeltaY/(120*s):this.deltaY=a.wheelDeltaY/120;else if(typeof i.VERTICAL_AXIS<"u"&&i.axis===i.VERTICAL_AXIS)this.deltaY=-i.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?lP&&!Cl?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof a.wheelDeltaX<"u")VGe&&Lhe?this.deltaX=-(a.wheelDeltaX/120):n?this.deltaX=a.wheelDeltaX/(120*s):this.deltaX=a.wheelDeltaX/120;else if(typeof i.HORIZONTAL_AXIS<"u"&&i.axis===i.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?lP&&!Cl?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*s):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}},Rhe=Object.freeze(function(e,t){let r=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(r)}}}),fVe;(e=>{function t(r){return r===e.None||r===e.Cancelled||r instanceof hVe?!0:!r||typeof r!="object"?!1:typeof r.isCancellationRequested=="boolean"&&typeof r.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ii.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Rhe})})(fVe||(fVe={}));var hVe=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Rhe:(this._emitter||(this._emitter=new nt),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},pB=class{constructor(t,r){this._isDisposed=!1,this._token=-1,typeof t=="function"&&typeof r=="number"&&this.setIfNotSet(t,r)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,r){if(this._isDisposed)throw new rP("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},r)}setIfNotSet(t,r){if(this._isDisposed)throw new rP("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},r))}},mVe=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,r=globalThis){if(this.isDisposed)throw new rP("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let n=r.setInterval(()=>{e()},t);this.disposable=Mn(()=>{r.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},pVe;(e=>{async function t(n){let a,i=await Promise.all(n.map(s=>s.then(l=>l,l=>{a||(a=l)})));if(typeof a<"u")throw a;return i}e.settled=t;function r(n){return new Promise(async(a,i)=>{try{await n(a,i)}catch(s){i(s)}})}e.withAsyncBody=r})(pVe||(pVe={}));var SZ=class oo{static fromArray(t){return new oo(r=>{r.emitMany(t)})}static fromPromise(t){return new oo(async r=>{r.emitMany(await t)})}static fromPromises(t){return new oo(async r=>{await Promise.all(t.map(async n=>r.emitOne(await n)))})}static merge(t){return new oo(async r=>{await Promise.all(t.map(async n=>{for await(let a of n)r.emitOne(a)}))})}constructor(t,r){this._state=0,this._results=[],this._error=null,this._onReturn=r,this._onStateChanged=new nt,queueMicrotask(async()=>{let n={emitOne:a=>this.emitOne(a),emitMany:a=>this.emitMany(a),reject:a=>this.reject(a)};try{await Promise.resolve(t(n)),this.resolve()}catch(a){this.reject(a)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await ii.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,r){return new oo(async n=>{for await(let a of t)n.emitOne(r(a))})}map(t){return oo.map(this,t)}static filter(t,r){return new oo(async n=>{for await(let a of t)r(a)&&n.emitOne(a)})}filter(t){return oo.filter(this,t)}static coalesce(t){return oo.filter(t,r=>!!r)}coalesce(){return oo.coalesce(this)}static async toPromise(t){let r=[];for await(let n of t)r.push(n);return r}toPromise(){return oo.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}};SZ.EMPTY=SZ.fromArray([]);var{getWindow:wl,getWindowId:gVe,onDidRegisterWindow:vVe}=(function(){let e=new Map,t={window:qc,disposables:new Td};e.set(qc.vscodeWindowId,t);let r=new nt,n=new nt,a=new nt;function i(s,l){return(typeof s=="number"?e.get(s):void 0)??(l?t:void 0)}return{onDidRegisterWindow:r.event,onWillUnregisterWindow:a.event,onDidUnregisterWindow:n.event,registerWindow(s){if(e.has(s.vscodeWindowId))return hr.None;let l=new Td,c={window:s,disposables:l.add(new Td)};return e.set(s.vscodeWindowId,c),l.add(Mn(()=>{e.delete(s.vscodeWindowId),n.fire(s)})),l.add(Qt(s,Oa.BEFORE_UNLOAD,()=>{a.fire(s)})),r.fire(c),l},getWindows(){return e.values()},getWindowsCount(){return e.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return e.has(s)},getWindowById:i,getWindow(s){let l=s;if(l?.ownerDocument?.defaultView)return l.ownerDocument.defaultView.window;let c=s;return c?.view?c.view.window:qc},getDocument(s){return wl(s).document}}})(),bVe=class{constructor(e,t,r,n){this._node=e,this._type=t,this._handler=r,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Qt(e,t,r,n){return new bVe(e,t,r,n)}var kZ=function(e,t,r,n){return Qt(e,t,r,n)},gB,yVe=class extends mVe{constructor(e){super(),this.defaultTarget=e&&wl(e)}cancelAndSet(e,t,r){return super.cancelAndSet(e,t,r??this.defaultTarget)}},_Z=class{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){kk(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let e=new Map,t=new Map,r=new Map,n=new Map,a=i=>{r.set(i,!1);let s=e.get(i)??[];for(t.set(i,s),e.set(i,[]),n.set(i,!0);s.length>0;)s.sort(_Z.sort),s.shift().execute();n.set(i,!1)};gB=(i,s,l=0)=>{let c=gVe(i),u=new _Z(s,l),d=e.get(c);return d||(d=[],e.set(c,d)),d.push(u),r.get(c)||(r.set(c,!0),i.requestAnimationFrame(()=>a(c))),u}})();function xVe(e){let t=e.getBoundingClientRect(),r=wl(e);return{left:t.left+r.scrollX,top:t.top+r.scrollY,width:t.width,height:t.height}}var Oa={CLICK:"click",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",BLUR:"blur",INPUT:"input"},wVe=class{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){let t=Ji(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=Ji(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=Ji(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=Ji(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=Ji(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=Ji(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=Ji(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=Ji(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=Ji(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=Ji(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=Ji(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=Ji(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=Ji(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=Ji(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function Ji(e){return typeof e=="number"?`${e}px`:e}function Yb(e){return new wVe(e)}var Phe=class{constructor(){this._hooks=new Td,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let r=this._onStopCallback;this._onStopCallback=null,e&&r&&r(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,r,n,a){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=a;let i=e;try{e.setPointerCapture(t),this._hooks.add(Mn(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{i=wl(e)}this._hooks.add(Qt(i,Oa.POINTER_MOVE,s=>{if(s.buttons!==r){this.stopMonitoring(!0);return}s.preventDefault(),this._pointerMoveCallback(s)})),this._hooks.add(Qt(i,Oa.POINTER_UP,s=>this.stopMonitoring(!0)))}};function SVe(e,t,r){let n=null,a=null;if(typeof r.value=="function"?(n="value",a=r.value,a.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof r.get=="function"&&(n="get",a=r.get),!a)throw new Error("not supported");let i=`$memoize$${t}`;r[n]=function(...s){return this.hasOwnProperty(i)||Object.defineProperty(this,i,{configurable:!1,enumerable:!1,writable:!1,value:a.apply(this,s)}),this[i]}}var ml;(e=>(e.Tap="-xterm-gesturetap",e.Change="-xterm-gesturechange",e.Start="-xterm-gesturestart",e.End="-xterm-gesturesend",e.Contextmenu="-xterm-gesturecontextmenu"))(ml||(ml={}));var bb=class mi extends hr{constructor(){super(),this.dispatched=!1,this.targets=new mZ,this.ignoreTargets=new mZ,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(ii.runAndSubscribe(vVe,({window:t,disposables:r})=>{r.add(Qt(t.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),r.add(Qt(t.document,"touchend",n=>this.onTouchEnd(t,n))),r.add(Qt(t.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:qc,disposables:this._store}))}static addTarget(t){if(!mi.isTouchDevice())return hr.None;mi.INSTANCE||(mi.INSTANCE=new mi);let r=mi.INSTANCE.targets.push(t);return Mn(r)}static ignoreTarget(t){if(!mi.isTouchDevice())return hr.None;mi.INSTANCE||(mi.INSTANCE=new mi);let r=mi.INSTANCE.ignoreTargets.push(t);return Mn(r)}static isTouchDevice(){return"ontouchstart"in qc||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(t){let r=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,a=t.targetTouches.length;n<a;n++){let i=t.targetTouches.item(n);this.activeTouches[i.identifier]={id:i.identifier,initialTarget:i.target,initialTimeStamp:r,initialPageX:i.pageX,initialPageY:i.pageY,rollingTimestamps:[r],rollingPageX:[i.pageX],rollingPageY:[i.pageY]};let s=this.newGestureEvent(ml.Start,i.target);s.pageX=i.pageX,s.pageY=i.pageY,this.dispatchEvent(s)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}onTouchEnd(t,r){let n=Date.now(),a=Object.keys(this.activeTouches).length;for(let i=0,s=r.changedTouches.length;i<s;i++){let l=r.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(l.identifier))){console.warn("move of an UNKNOWN touch",l);continue}let c=this.activeTouches[l.identifier],u=Date.now()-c.initialTimeStamp;if(u<mi.HOLD_DELAY&&Math.abs(c.initialPageX-gs(c.rollingPageX))<30&&Math.abs(c.initialPageY-gs(c.rollingPageY))<30){let d=this.newGestureEvent(ml.Tap,c.initialTarget);d.pageX=gs(c.rollingPageX),d.pageY=gs(c.rollingPageY),this.dispatchEvent(d)}else if(u>=mi.HOLD_DELAY&&Math.abs(c.initialPageX-gs(c.rollingPageX))<30&&Math.abs(c.initialPageY-gs(c.rollingPageY))<30){let d=this.newGestureEvent(ml.Contextmenu,c.initialTarget);d.pageX=gs(c.rollingPageX),d.pageY=gs(c.rollingPageY),this.dispatchEvent(d)}else if(a===1){let d=gs(c.rollingPageX),f=gs(c.rollingPageY),m=gs(c.rollingTimestamps)-c.rollingTimestamps[0],p=d-c.rollingPageX[0],v=f-c.rollingPageY[0],b=[...this.targets].filter(y=>c.initialTarget instanceof Node&&y.contains(c.initialTarget));this.inertia(t,b,n,Math.abs(p)/m,p>0?1:-1,d,Math.abs(v)/m,v>0?1:-1,f)}this.dispatchEvent(this.newGestureEvent(ml.End,c.initialTarget)),delete this.activeTouches[l.identifier]}this.dispatched&&(r.preventDefault(),r.stopPropagation(),this.dispatched=!1)}newGestureEvent(t,r){let n=document.createEvent("CustomEvent");return n.initEvent(t,!1,!0),n.initialTarget=r,n.tapCount=0,n}dispatchEvent(t){if(t.type===ml.Tap){let r=new Date().getTime(),n=0;r-this._lastSetTapCountTime>mi.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=r,t.tapCount=n}else(t.type===ml.Change||t.type===ml.Contextmenu)&&(this._lastSetTapCountTime=0);if(t.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(t.initialTarget))return;let r=[];for(let n of this.targets)if(n.contains(t.initialTarget)){let a=0,i=t.initialTarget;for(;i&&i!==n;)a++,i=i.parentElement;r.push([a,n])}r.sort((n,a)=>n[0]-a[0]);for(let[n,a]of r)a.dispatchEvent(t),this.dispatched=!0}}inertia(t,r,n,a,i,s,l,c,u){this.handle=gB(t,()=>{let d=Date.now(),f=d-n,m=0,p=0,v=!0;a+=mi.SCROLL_FRICTION*f,l+=mi.SCROLL_FRICTION*f,a>0&&(v=!1,m=i*a*f),l>0&&(v=!1,p=c*l*f);let b=this.newGestureEvent(ml.Change);b.translationX=m,b.translationY=p,r.forEach(y=>y.dispatchEvent(b)),v||this.inertia(t,r,d,a,i,s+m,l,c,u+p)})}onTouchMove(t){let r=Date.now();for(let n=0,a=t.changedTouches.length;n<a;n++){let i=t.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(i.identifier))){console.warn("end of an UNKNOWN touch",i);continue}let s=this.activeTouches[i.identifier],l=this.newGestureEvent(ml.Change,s.initialTarget);l.translationX=i.pageX-gs(s.rollingPageX),l.translationY=i.pageY-gs(s.rollingPageY),l.pageX=i.pageX,l.pageY=i.pageY,this.dispatchEvent(l),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(i.pageX),s.rollingPageY.push(i.pageY),s.rollingTimestamps.push(r)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}};bb.SCROLL_FRICTION=-.005,bb.HOLD_DELAY=700,bb.CLEAR_TAP_COUNT_TIME=400,Zn([SVe],bb,"isTouchDevice",1);var kVe=bb,vB=class extends hr{onclick(t,r){this._register(Qt(t,Oa.CLICK,n=>r(new MS(wl(t),n))))}onmousedown(t,r){this._register(Qt(t,Oa.MOUSE_DOWN,n=>r(new MS(wl(t),n))))}onmouseover(t,r){this._register(Qt(t,Oa.MOUSE_OVER,n=>r(new MS(wl(t),n))))}onmouseleave(t,r){this._register(Qt(t,Oa.MOUSE_LEAVE,n=>r(new MS(wl(t),n))))}onkeydown(t,r){this._register(Qt(t,Oa.KEY_DOWN,n=>r(new yZ(n))))}onkeyup(t,r){this._register(Qt(t,Oa.KEY_UP,n=>r(new yZ(n))))}oninput(t,r){this._register(Qt(t,Oa.INPUT,r))}onblur(t,r){this._register(Qt(t,Oa.BLUR,r))}onfocus(t,r){this._register(Qt(t,Oa.FOCUS,r))}onchange(t,r){this._register(Qt(t,Oa.CHANGE,r))}ignoreGesture(t){return kVe.ignoreTarget(t)}},NZ=11,_Ve=class extends vB{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.style.position="absolute",this.domNode.style.width=NZ+"px",this.domNode.style.height=NZ+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new Phe),this._register(kZ(this.bgDomNode,Oa.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(kZ(this.domNode,Oa.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new yVe),this._pointerdownScheduleRepeatTimer=this._register(new pB)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,wl(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}},NVe=class dP{constructor(t,r,n,a,i,s,l){this._forceIntegerValues=t,this._scrollStateBrand=void 0,this._forceIntegerValues&&(r=r|0,n=n|0,a=a|0,i=i|0,s=s|0,l=l|0),this.rawScrollLeft=a,this.rawScrollTop=l,r<0&&(r=0),a+r>n&&(a=n-r),a<0&&(a=0),i<0&&(i=0),l+i>s&&(l=s-i),l<0&&(l=0),this.width=r,this.scrollWidth=n,this.scrollLeft=a,this.height=i,this.scrollHeight=s,this.scrollTop=l}equals(t){return this.rawScrollLeft===t.rawScrollLeft&&this.rawScrollTop===t.rawScrollTop&&this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop}withScrollDimensions(t,r){return new dP(this._forceIntegerValues,typeof t.width<"u"?t.width:this.width,typeof t.scrollWidth<"u"?t.scrollWidth:this.scrollWidth,r?this.rawScrollLeft:this.scrollLeft,typeof t.height<"u"?t.height:this.height,typeof t.scrollHeight<"u"?t.scrollHeight:this.scrollHeight,r?this.rawScrollTop:this.scrollTop)}withScrollPosition(t){return new dP(this._forceIntegerValues,this.width,this.scrollWidth,typeof t.scrollLeft<"u"?t.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof t.scrollTop<"u"?t.scrollTop:this.rawScrollTop)}createScrollEvent(t,r){let n=this.width!==t.width,a=this.scrollWidth!==t.scrollWidth,i=this.scrollLeft!==t.scrollLeft,s=this.height!==t.height,l=this.scrollHeight!==t.scrollHeight,c=this.scrollTop!==t.scrollTop;return{inSmoothScrolling:r,oldWidth:t.width,oldScrollWidth:t.scrollWidth,oldScrollLeft:t.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:t.height,oldScrollHeight:t.scrollHeight,oldScrollTop:t.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:a,scrollLeftChanged:i,heightChanged:s,scrollHeightChanged:l,scrollTopChanged:c}}},CVe=class extends hr{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new nt),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new NVe(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let r=this._state.withScrollDimensions(e,t);this._setState(r,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let r=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===r.scrollLeft&&this._smoothScrolling.to.scrollTop===r.scrollTop)return;let n;t?n=new jZ(this._smoothScrolling.from,r,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,r,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{let r=this._state.withScrollPosition(e);this._smoothScrolling=jZ.start(this._state,r,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let r=this._state;r.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(r,t)))}},CZ=class{constructor(e,t,r){this.scrollLeft=e,this.scrollTop=t,this.isDone=r}};function dL(e,t){let r=t-e;return function(n){return e+r*MVe(n)}}function jVe(e,t,r){return function(n){return n<r?e(n/r):t((n-r)/(1-r))}}var jZ=class fP{constructor(t,r,n,a){this.from=t,this.to=r,this.duration=a,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(t,r,n){if(Math.abs(t-r)>2.5*n){let a,i;return t<r?(a=t+.75*n,i=r-.75*n):(a=t-.75*n,i=r+.75*n),jVe(dL(t,a),dL(i,r),.33)}return dL(t,r)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(t){this.to=t.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(t){let r=(t-this.startTime)/this.duration;if(r<1){let n=this.scrollLeft(r),a=this.scrollTop(r);return new CZ(n,a,!1)}return new CZ(this.to.scrollLeft,this.to.scrollTop,!0)}combine(t,r,n){return fP.start(t,r,n)}static start(t,r,n){n=n+10;let a=Date.now()-10;return new fP(t,r,a,n)}};function EVe(e){return Math.pow(e,3)}function MVe(e){return 1-EVe(1-e)}var TVe=class extends hr{constructor(e,t,r){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=r,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new pB)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}},AVe=140,zhe=class extends vB{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new TVe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Phe),this._shouldRender=!0,this.domNode=Yb(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Qt(this.domNode.domNode,Oa.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new _Ve(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,r,n){this.slider=Yb(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof r=="number"&&this.slider.setWidth(r),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Qt(this.slider.domNode,Oa.POINTER_DOWN,a=>{a.button===0&&(a.preventDefault(),this._sliderPointerDown(a))})),this.onclick(this.slider.domNode,a=>{a.leftButton&&a.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,r=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),a=this._sliderPointerPosition(e);r<=a&&a<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,r;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,r=e.offsetY;else{let a=xVe(this.domNode.domNode);t=e.pageX-a.left,r=e.pageY-a.top}let n=this._pointerDownRelativePosition(t,r);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),r=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,a=>{let i=this._sliderOrthogonalPointerPosition(a),s=Math.abs(i-r);if(Lhe&&s>AVe){this._setDesiredScrollPositionNow(n.getScrollPosition());return}let l=this._sliderPointerPosition(a)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(l))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}},Bhe=class hP{constructor(t,r,n,a,i,s){this._scrollbarSize=Math.round(r),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(t),this._visibleSize=a,this._scrollSize=i,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new hP(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(t){let r=Math.round(t);return this._visibleSize!==r?(this._visibleSize=r,this._refreshComputedValues(),!0):!1}setScrollSize(t){let r=Math.round(t);return this._scrollSize!==r?(this._scrollSize=r,this._refreshComputedValues(),!0):!1}setScrollPosition(t){let r=Math.round(t);return this._scrollPosition!==r?(this._scrollPosition=r,this._refreshComputedValues(),!0):!1}setScrollbarSize(t){this._scrollbarSize=Math.round(t)}setOppositeScrollbarSize(t){this._oppositeScrollbarSize=Math.round(t)}static _computeValues(t,r,n,a,i){let s=Math.max(0,n-t),l=Math.max(0,s-2*r),c=a>0&&a>n;if(!c)return{computedAvailableSize:Math.round(s),computedIsNeeded:c,computedSliderSize:Math.round(l),computedSliderRatio:0,computedSliderPosition:0};let u=Math.round(Math.max(20,Math.floor(n*l/a))),d=(l-u)/(a-n),f=i*d;return{computedAvailableSize:Math.round(s),computedIsNeeded:c,computedSliderSize:Math.round(u),computedSliderRatio:d,computedSliderPosition:Math.round(f)}}_refreshComputedValues(){let t=hP._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=t.computedAvailableSize,this._computedIsNeeded=t.computedIsNeeded,this._computedSliderSize=t.computedSliderSize,this._computedSliderRatio=t.computedSliderRatio,this._computedSliderPosition=t.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(t){if(!this._computedIsNeeded)return 0;let r=t-this._arrowSize-this._computedSliderSize/2;return Math.round(r/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(t){if(!this._computedIsNeeded)return 0;let r=t-this._arrowSize,n=this._scrollPosition;return r<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(t){if(!this._computedIsNeeded)return 0;let r=this._computedSliderPosition+t;return Math.round(r/this._computedSliderRatio)}},DVe=class extends zhe{constructor(e,t,r){let n=e.getScrollDimensions(),a=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:r,scrollbarState:new Bhe(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,a.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}},LVe=class extends zhe{constructor(e,t,r){let n=e.getScrollDimensions(),a=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:r,scrollbarState:new Bhe(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,a.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}},OVe=500,EZ=50,IVe=class{constructor(e,t,r){this.timestamp=e,this.deltaX=t,this.deltaY=r,this.score=0}},mP=class{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let t=1,r=0,n=1,a=this._rear;do{let i=a===this._front?t:Math.pow(2,-n);if(t-=i,r+=this._memory[a].score*i,a===this._front)break;a=(this._capacity+a-1)%this._capacity,n++}while(!0);return r<=.5}acceptStandardWheelEvent(t){if(hB){let r=wl(t.browserEvent),n=KGe(r);this.accept(Date.now(),t.deltaX*n,t.deltaY*n)}else this.accept(Date.now(),t.deltaX,t.deltaY)}accept(t,r,n){let a=null,i=new IVe(t,r,n);this._front===-1&&this._rear===-1?(this._memory[0]=i,this._front=0,this._rear=0):(a=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=i),i.score=this._computeScore(i,a)}_computeScore(t,r){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(t.deltaX)||!this._isAlmostInt(t.deltaY))&&(n+=.25),r){let a=Math.abs(t.deltaX),i=Math.abs(t.deltaY),s=Math.abs(r.deltaX),l=Math.abs(r.deltaY),c=Math.max(Math.min(a,s),1),u=Math.max(Math.min(i,l),1),d=Math.max(a,s),f=Math.max(i,l);d%c===0&&f%u===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(t){return Math.abs(Math.round(t)-t)<.01}};mP.INSTANCE=new mP;var RVe=mP,PVe=class extends vB{constructor(e,t,r){super(),this._onScroll=this._register(new nt),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new nt),this.onWillScroll=this._onWillScroll.event,this._options=BVe(t),this._scrollable=r,this._register(this._scrollable.onScroll(a=>{this._onWillScroll.fire(a),this._onDidScroll(a),this._onScroll.fire(a)}));let n={onMouseWheel:a=>this._onMouseWheel(a),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new LVe(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new DVe(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Yb(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Yb(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Yb(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,a=>this._onMouseOver(a)),this.onmouseleave(this._listenOnDomNode,a=>this._onMouseLeave(a)),this._hideTimeout=this._register(new pB),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=Dh(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Cl&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new wZ(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Dh(this._mouseWheelToDispose),e)){let t=r=>{this._onMouseWheel(new wZ(r))};this._mouseWheelToDispose.push(Qt(this._listenOnDomNode,Oa.MOUSE_WHEEL,t,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=RVe.INSTANCE;t.acceptStandardWheelEvent(e);let r=!1;if(e.deltaY||e.deltaX){let a=e.deltaY*this._options.mouseWheelScrollSensitivity,i=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&i+a===0?i=a=0:Math.abs(a)>=Math.abs(i)?i=0:a=0),this._options.flipAxes&&([a,i]=[i,a]);let s=!Cl&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||s)&&!i&&(i=a,a=0),e.browserEvent&&e.browserEvent.altKey&&(i=i*this._options.fastScrollSensitivity,a=a*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),c={};if(a){let u=EZ*a,d=l.scrollTop-(u<0?Math.floor(u):Math.ceil(u));this._verticalScrollbar.writeScrollPosition(c,d)}if(i){let u=EZ*i,d=l.scrollLeft-(u<0?Math.floor(u):Math.ceil(u));this._horizontalScrollbar.writeScrollPosition(c,d)}c=this._scrollable.validateScrollPosition(c),(l.scrollLeft!==c.scrollLeft||l.scrollTop!==c.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(c):this._scrollable.setScrollPositionNow(c),r=!0)}let n=r;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,r=e.scrollLeft>0,n=r?" left":"",a=t?" top":"",i=r||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${a}`),this._topLeftShadowDomNode.setClassName(`shadow${i}${a}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),OVe)}},zVe=class extends PVe{constructor(e,t,r){super(e,t,r)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function BVe(e){let t={lazyRender:typeof e.lazyRender<"u"?e.lazyRender:!1,className:typeof e.className<"u"?e.className:"",useShadows:typeof e.useShadows<"u"?e.useShadows:!0,handleMouseWheel:typeof e.handleMouseWheel<"u"?e.handleMouseWheel:!0,flipAxes:typeof e.flipAxes<"u"?e.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof e.consumeMouseWheelIfScrollbarIsNeeded<"u"?e.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof e.alwaysConsumeMouseWheel<"u"?e.alwaysConsumeMouseWheel:!1,scrollYToX:typeof e.scrollYToX<"u"?e.scrollYToX:!1,mouseWheelScrollSensitivity:typeof e.mouseWheelScrollSensitivity<"u"?e.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof e.fastScrollSensitivity<"u"?e.fastScrollSensitivity:5,scrollPredominantAxis:typeof e.scrollPredominantAxis<"u"?e.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof e.mouseWheelSmoothScroll<"u"?e.mouseWheelSmoothScroll:!0,arrowSize:typeof e.arrowSize<"u"?e.arrowSize:11,listenOnDomNode:typeof e.listenOnDomNode<"u"?e.listenOnDomNode:null,horizontal:typeof e.horizontal<"u"?e.horizontal:1,horizontalScrollbarSize:typeof e.horizontalScrollbarSize<"u"?e.horizontalScrollbarSize:10,horizontalSliderSize:typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:0,horizontalHasArrows:typeof e.horizontalHasArrows<"u"?e.horizontalHasArrows:!1,vertical:typeof e.vertical<"u"?e.vertical:1,verticalScrollbarSize:typeof e.verticalScrollbarSize<"u"?e.verticalScrollbarSize:10,verticalHasArrows:typeof e.verticalHasArrows<"u"?e.verticalHasArrows:!1,verticalSliderSize:typeof e.verticalSliderSize<"u"?e.verticalSliderSize:0,scrollByPage:typeof e.scrollByPage<"u"?e.scrollByPage:!1};return t.horizontalSliderSize=typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=typeof e.verticalSliderSize<"u"?e.verticalSliderSize:t.verticalScrollbarSize,Cl&&(t.className+=" mac"),t}var pP=class extends hr{constructor(t,r,n,a,i,s,l,c){super(),this._bufferService=n,this._optionsService=l,this._renderService=c,this._onRequestScrollLines=this._register(new nt),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;let u=this._register(new CVe({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:d=>gB(a.window,d)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",()=>{u.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)})),this._scrollableElement=this._register(new zVe(r,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},u)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],()=>this._scrollableElement.updateOptions(this._getChangeOptions()))),this._register(i.onProtocolChange(d=>{this._scrollableElement.updateOptions({handleMouseWheel:!(d&16)})})),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(ii.runAndSubscribe(s.onChangeColors,()=>{this._scrollableElement.getDomNode().style.backgroundColor=s.colors.background.css})),t.appendChild(this._scrollableElement.getDomNode()),this._register(Mn(()=>this._scrollableElement.getDomNode().remove())),this._styleElement=a.mainDocument.createElement("style"),r.appendChild(this._styleElement),this._register(Mn(()=>this._styleElement.remove())),this._register(ii.runAndSubscribe(s.onChangeColors,()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${s.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${s.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${s.colors.scrollbarSliderActiveBackground.css};`,"}"].join(`
`)})),this._register(this._bufferService.onResize(()=>this.queueSync())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._latestYDisp=void 0,this.queueSync()})),this._register(this._bufferService.onScroll(()=>this._sync())),this._register(this._scrollableElement.onScroll(d=>this._handleScroll(d)))}scrollLines(t){let r=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:r.scrollTop+t*this._renderService.dimensions.css.cell.height})}scrollToLine(t,r){r&&(this._latestYDisp=t),this._scrollableElement.setScrollPosition({reuseAnimation:!r,scrollTop:t*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}queueSync(t){t!==void 0&&(this._latestYDisp=t),this._queuedAnimationFrame===void 0&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback(()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)}))}_sync(t=this._bufferService.buffer.ydisp){!this._renderService||this._isSyncing||(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,t!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:t*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(t){if(!this._renderService||this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;let r=Math.round(t.scrollTop/this._renderService.dimensions.css.cell.height),n=r-this._bufferService.buffer.ydisp;n!==0&&(this._latestYDisp=r,this._onRequestScrollLines.fire(n)),this._isHandlingScroll=!1}};pP=Zn([ft(2,Fi),ft(3,vu),ft(4,yhe),ft(5,m0),ft(6,Ui),ft(7,bu)],pP);var gP=class extends hr{constructor(t,r,n,a,i){super(),this._screenElement=t,this._bufferService=r,this._coreBrowserService=n,this._decorationService=a,this._renderService=i,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this._register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this._register(this._decorationService.onDecorationRemoved(s=>this._removeDecoration(s))),this._register(Mn(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){let r=this._coreBrowserService.mainDocument.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",t?.options?.layer==="top"),r.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,r.style.top=`${(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height}px`,r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let n=t.options.x??0;return n&&n>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(t,r),r}_refreshStyle(t){let r=t.marker.line-this._bufferService.buffers.active.ydisp;if(r<0||r>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let n=this._decorationElements.get(t);n||(n=this._createElement(t),t.element=n,this._decorationElements.set(t,n),this._container.appendChild(n),t.onDispose(()=>{this._decorationElements.delete(t),n.remove()})),n.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(n.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,n.style.top=`${r*this._renderService.dimensions.css.cell.height}px`,n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),t.onRenderEmitter.fire(n)}}_refreshXPosition(t,r=t.element){if(!r)return;let n=t.options.x??0;(t.options.anchor||"left")==="right"?r.style.right=n?`${n*this._renderService.dimensions.css.cell.width}px`:"":r.style.left=n?`${n*this._renderService.dimensions.css.cell.width}px`:""}_removeDecoration(t){this._decorationElements.get(t)?.remove(),this._decorationElements.delete(t),t.dispose()}};gP=Zn([ft(1,Fi),ft(2,vu),ft(3,l1),ft(4,bu)],gP);var $Ve=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(let t of this._zones)if(t.color===e.options.overviewRulerOptions.color&&t.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(t,e.marker.line))return;if(this._lineAdjacentToZone(t,e.marker.line,e.options.overviewRulerOptions.position)){this._addLineToZone(t,e.marker.line);return}}if(this._zonePoolIndex<this._zonePool.length){this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,this._zones.push(this._zonePool[this._zonePoolIndex++]);return}this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}_lineAdjacentToZone(e,t,r){return t>=e.startBufferLine-this._linePadding[r||"full"]&&t<=e.endBufferLine+this._linePadding[r||"full"]}_addLineToZone(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}},ul={full:0,left:0,center:0,right:0},Qu={full:0,left:0,center:0,right:0},Lv={full:0,left:0,center:0,right:0},rC=class extends hr{constructor(t,r,n,a,i,s,l,c){super(),this._viewportElement=t,this._screenElement=r,this._bufferService=n,this._decorationService=a,this._renderService=i,this._optionsService=s,this._themeService=l,this._coreBrowserService=c,this._colorZoneStore=new $Ve,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register(Mn(()=>this._canvas?.remove()));let u=this._canvas.getContext("2d");if(u)this._ctx=u;else throw new Error("Ctx cannot be null");this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this._register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0))),this._register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this._register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})),this._register(this._renderService.onRender(()=>{(!this._containerHeight||this._containerHeight!==this._screenElement.clientHeight)&&(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",()=>this._queueRefresh(!0))),this._register(this._themeService.onChangeColors(()=>this._queueRefresh())),this._queueRefresh(!0)}get _width(){return this._optionsService.options.overviewRuler?.width||0}_refreshDrawConstants(){let t=Math.floor((this._canvas.width-1)/3),r=Math.ceil((this._canvas.width-1)/3);Qu.full=this._canvas.width,Qu.left=t,Qu.center=r,Qu.right=t,this._refreshDrawHeightConstants(),Lv.full=1,Lv.left=1,Lv.center=1+Qu.left,Lv.right=1+Qu.left+Qu.center}_refreshDrawHeightConstants(){ul.full=Math.round(2*this._coreBrowserService.dpr);let t=this._canvas.height/this._bufferService.buffer.lines.length,r=Math.round(Math.max(Math.min(t,12),6)*this._coreBrowserService.dpr);ul.left=r,ul.center=r,ul.right=r}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*ul.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*ul.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*ul.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*ul.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let r of this._decorationService.decorations)this._colorZoneStore.addDecoration(r);this._ctx.lineWidth=1,this._renderRulerOutline();let t=this._colorZoneStore.zones;for(let r of t)r.position!=="full"&&this._renderColorZone(r);for(let r of t)r.position==="full"&&this._renderColorZone(r);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(t){this._ctx.fillStyle=t.color,this._ctx.fillRect(Lv[t.position||"full"],Math.round((this._canvas.height-1)*(t.startBufferLine/this._bufferService.buffers.active.lines.length)-ul[t.position||"full"]/2),Qu[t.position||"full"],Math.round((this._canvas.height-1)*((t.endBufferLine-t.startBufferLine)/this._bufferService.buffers.active.lines.length)+ul[t.position||"full"]))}_queueRefresh(t,r){this._shouldUpdateDimensions=t||this._shouldUpdateDimensions,this._shouldUpdateAnchor=r||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};rC=Zn([ft(2,Fi),ft(3,l1),ft(4,bu),ft(5,Ui),ft(6,m0),ft(7,vu)],rC);var qe;(e=>(e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="\x07",e.BS="\b",e.HT="	",e.LF=`
`,e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="\x1B",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""))(qe||(qe={}));var Ck;(e=>(e.PAD="",e.HOP="",e.BPH="",e.NBH="",e.IND="",e.NEL="",e.SSA="",e.ESA="",e.HTS="",e.HTJ="",e.VTS="",e.PLD="",e.PLU="",e.RI="",e.SS2="",e.SS3="",e.DCS="",e.PU1="",e.PU2="",e.STS="",e.CCH="",e.MW="",e.SPA="",e.EPA="",e.SOS="",e.SGCI="",e.SCI="",e.CSI="",e.ST="",e.OSC="",e.PM="",e.APC=""))(Ck||(Ck={}));var $he;(e=>e.ST=`${qe.ESC}\\`)($he||($he={}));var vP=class{constructor(e,t,r,n,a,i){this._textarea=e,this._compositionView=t,this._bufferService=r,this._optionsService=n,this._coreService=a,this._renderService=i,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(e.keyCode===20||e.keyCode===229||e.keyCode===16||e.keyCode===17||e.keyCode===18)return!1;this._finalizeComposition(!1)}return e.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){let t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){this._isSendingComposition=!1;let r;t.start+=this._dataAlreadySent.length,this._isComposing?r=this._textarea.value.substring(t.start,this._compositionPosition.start):r=this._textarea.value.substring(t.start),r.length>0&&this._coreService.triggerDataEvent(r,!0)}},0)}else{this._isSendingComposition=!1;let t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){let e=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let t=this._textarea.value,r=t.replace(e,"");this._dataAlreadySent=r,t.length>e.length?this._coreService.triggerDataEvent(r,!0):t.length<e.length?this._coreService.triggerDataEvent(`${qe.DEL}`,!0):t.length===e.length&&t!==e&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.css.cell.height,n=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,a=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=a+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let i=this._compositionView.getBoundingClientRect();this._textarea.style.left=a+"px",this._textarea.style.top=n+"px",this._textarea.style.width=Math.max(i.width,1)+"px",this._textarea.style.height=Math.max(i.height,1)+"px",this._textarea.style.lineHeight=i.height+"px"}e||setTimeout(()=>this.updateCompositionElements(!0),0)}}};vP=Zn([ft(2,Fi),ft(3,Ui),ft(4,am),ft(5,bu)],vP);var Ra=0,Pa=0,za=0,qn=0,MZ={css:"#00000000",rgba:0},ha;(e=>{function t(a,i,s,l){return l!==void 0?`#${vf(a)}${vf(i)}${vf(s)}${vf(l)}`:`#${vf(a)}${vf(i)}${vf(s)}`}e.toCss=t;function r(a,i,s,l=255){return(a<<24|i<<16|s<<8|l)>>>0}e.toRgba=r;function n(a,i,s,l){return{css:e.toCss(a,i,s,l),rgba:e.toRgba(a,i,s,l)}}e.toColor=n})(ha||(ha={}));var kn;(e=>{function t(c,u){if(qn=(u.rgba&255)/255,qn===1)return{css:u.css,rgba:u.rgba};let d=u.rgba>>24&255,f=u.rgba>>16&255,m=u.rgba>>8&255,p=c.rgba>>24&255,v=c.rgba>>16&255,b=c.rgba>>8&255;Ra=p+Math.round((d-p)*qn),Pa=v+Math.round((f-v)*qn),za=b+Math.round((m-b)*qn);let y=ha.toCss(Ra,Pa,za),S=ha.toRgba(Ra,Pa,za);return{css:y,rgba:S}}e.blend=t;function r(c){return(c.rgba&255)===255}e.isOpaque=r;function n(c,u,d){let f=jk.ensureContrastRatio(c.rgba,u.rgba,d);if(f)return ha.toColor(f>>24&255,f>>16&255,f>>8&255)}e.ensureContrastRatio=n;function a(c){let u=(c.rgba|255)>>>0;return[Ra,Pa,za]=jk.toChannels(u),{css:ha.toCss(Ra,Pa,za),rgba:u}}e.opaque=a;function i(c,u){return qn=Math.round(u*255),[Ra,Pa,za]=jk.toChannels(c.rgba),{css:ha.toCss(Ra,Pa,za,qn),rgba:ha.toRgba(Ra,Pa,za,qn)}}e.opacity=i;function s(c,u){return qn=c.rgba&255,i(c,qn*u/255)}e.multiplyOpacity=s;function l(c){return[c.rgba>>24&255,c.rgba>>16&255,c.rgba>>8&255]}e.toColorRGB=l})(kn||(kn={}));var zn;(e=>{let t,r;try{let a=document.createElement("canvas");a.width=1,a.height=1;let i=a.getContext("2d",{willReadFrequently:!0});i&&(t=i,t.globalCompositeOperation="copy",r=t.createLinearGradient(0,0,1,1))}catch{}function n(a){if(a.match(/#[\da-f]{3,8}/i))switch(a.length){case 4:return Ra=parseInt(a.slice(1,2).repeat(2),16),Pa=parseInt(a.slice(2,3).repeat(2),16),za=parseInt(a.slice(3,4).repeat(2),16),ha.toColor(Ra,Pa,za);case 5:return Ra=parseInt(a.slice(1,2).repeat(2),16),Pa=parseInt(a.slice(2,3).repeat(2),16),za=parseInt(a.slice(3,4).repeat(2),16),qn=parseInt(a.slice(4,5).repeat(2),16),ha.toColor(Ra,Pa,za,qn);case 7:return{css:a,rgba:(parseInt(a.slice(1),16)<<8|255)>>>0};case 9:return{css:a,rgba:parseInt(a.slice(1),16)>>>0}}let i=a.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(i)return Ra=parseInt(i[1]),Pa=parseInt(i[2]),za=parseInt(i[3]),qn=Math.round((i[5]===void 0?1:parseFloat(i[5]))*255),ha.toColor(Ra,Pa,za,qn);if(!t||!r)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=r,t.fillStyle=a,typeof t.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),[Ra,Pa,za,qn]=t.getImageData(0,0,1,1).data,qn!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:ha.toRgba(Ra,Pa,za,qn),css:a}}e.toColor=n})(zn||(zn={}));var Ei;(e=>{function t(n){return r(n>>16&255,n>>8&255,n&255)}e.relativeLuminance=t;function r(n,a,i){let s=n/255,l=a/255,c=i/255,u=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),d=l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4),f=c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4);return u*.2126+d*.7152+f*.0722}e.relativeLuminance2=r})(Ei||(Ei={}));var jk;(e=>{function t(s,l){if(qn=(l&255)/255,qn===1)return l;let c=l>>24&255,u=l>>16&255,d=l>>8&255,f=s>>24&255,m=s>>16&255,p=s>>8&255;return Ra=f+Math.round((c-f)*qn),Pa=m+Math.round((u-m)*qn),za=p+Math.round((d-p)*qn),ha.toRgba(Ra,Pa,za)}e.blend=t;function r(s,l,c){let u=Ei.relativeLuminance(s>>8),d=Ei.relativeLuminance(l>>8);if(bc(u,d)<c){if(d<u){let p=n(s,l,c),v=bc(u,Ei.relativeLuminance(p>>8));if(v<c){let b=a(s,l,c),y=bc(u,Ei.relativeLuminance(b>>8));return v>y?p:b}return p}let f=a(s,l,c),m=bc(u,Ei.relativeLuminance(f>>8));if(m<c){let p=n(s,l,c),v=bc(u,Ei.relativeLuminance(p>>8));return m>v?f:p}return f}}e.ensureContrastRatio=r;function n(s,l,c){let u=s>>24&255,d=s>>16&255,f=s>>8&255,m=l>>24&255,p=l>>16&255,v=l>>8&255,b=bc(Ei.relativeLuminance2(m,p,v),Ei.relativeLuminance2(u,d,f));for(;b<c&&(m>0||p>0||v>0);)m-=Math.max(0,Math.ceil(m*.1)),p-=Math.max(0,Math.ceil(p*.1)),v-=Math.max(0,Math.ceil(v*.1)),b=bc(Ei.relativeLuminance2(m,p,v),Ei.relativeLuminance2(u,d,f));return(m<<24|p<<16|v<<8|255)>>>0}e.reduceLuminance=n;function a(s,l,c){let u=s>>24&255,d=s>>16&255,f=s>>8&255,m=l>>24&255,p=l>>16&255,v=l>>8&255,b=bc(Ei.relativeLuminance2(m,p,v),Ei.relativeLuminance2(u,d,f));for(;b<c&&(m<255||p<255||v<255);)m=Math.min(255,m+Math.ceil((255-m)*.1)),p=Math.min(255,p+Math.ceil((255-p)*.1)),v=Math.min(255,v+Math.ceil((255-v)*.1)),b=bc(Ei.relativeLuminance2(m,p,v),Ei.relativeLuminance2(u,d,f));return(m<<24|p<<16|v<<8|255)>>>0}e.increaseLuminance=a;function i(s){return[s>>24&255,s>>16&255,s>>8&255,s&255]}e.toChannels=i})(jk||(jk={}));function vf(e){let t=e.toString(16);return t.length<2?"0"+t:t}function bc(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}var FVe=class extends o1{constructor(e,t,r){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=t,this._width=r}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},nC=class{constructor(t){this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new So}register(t){let r={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(r),r.id}deregister(t){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===t)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(t){if(this._characterJoiners.length===0)return[];let r=this._bufferService.buffer.lines.get(t);if(!r||r.length===0)return[];let n=[],a=r.translateToString(!0),i=0,s=0,l=0,c=r.getFg(0),u=r.getBg(0);for(let d=0;d<r.getTrimmedLength();d++)if(r.loadCell(d,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==c||this._workCell.bg!==u){if(d-i>1){let f=this._getJoinedRanges(a,l,s,r,i);for(let m=0;m<f.length;m++)n.push(f[m])}i=d,l=s,c=this._workCell.fg,u=this._workCell.bg}s+=this._workCell.getChars().length||wd.length}if(this._bufferService.cols-i>1){let d=this._getJoinedRanges(a,l,s,r,i);for(let f=0;f<d.length;f++)n.push(d[f])}return n}_getJoinedRanges(t,r,n,a,i){let s=t.substring(r,n),l=[];try{l=this._characterJoiners[0].handler(s)}catch(c){console.error(c)}for(let c=1;c<this._characterJoiners.length;c++)try{let u=this._characterJoiners[c].handler(s);for(let d=0;d<u.length;d++)nC._mergeRanges(l,u[d])}catch(u){console.error(u)}return this._stringRangesToCellRanges(l,a,i),l}_stringRangesToCellRanges(t,r,n){let a=0,i=!1,s=0,l=t[a];if(l){for(let c=n;c<this._bufferService.cols;c++){let u=r.getWidth(c),d=r.getString(c).length||wd.length;if(u!==0){if(!i&&l[0]<=s&&(l[0]=c,i=!0),l[1]<=s){if(l[1]=c,l=t[++a],!l)break;l[0]<=s?(l[0]=c,i=!0):i=!1}s+=d}}l&&(l[1]=this._bufferService.cols)}}static _mergeRanges(t,r){let n=!1;for(let a=0;a<t.length;a++){let i=t[a];if(n){if(r[1]<=i[0])return t[a-1][1]=r[1],t;if(r[1]<=i[1])return t[a-1][1]=Math.max(r[1],i[1]),t.splice(a,1),t;t.splice(a,1),a--}else{if(r[1]<=i[0])return t.splice(a,0,r),t;if(r[1]<=i[1])return i[0]=Math.min(r[0],i[0]),t;r[0]<i[1]&&(i[0]=Math.min(r[0],i[0]),n=!0);continue}}return n?t[t.length-1][1]=r[1]:t.push(r),t}};nC=Zn([ft(0,Fi)],nC);function UVe(e){return 57508<=e&&e<=57558}function HVe(e){return 9472<=e&&e<=9631}function qVe(e){return UVe(e)||HVe(e)}function WVe(){return{css:{canvas:TS(),cell:TS()},device:{canvas:TS(),cell:TS(),char:{width:0,height:0,left:0,top:0}}}}function TS(){return{width:0,height:0}}var bP=class{constructor(e,t,r,n,a,i,s){this._document=e,this._characterJoinerService=t,this._optionsService=r,this._coreBrowserService=n,this._coreService=a,this._decorationService=i,this._themeService=s,this._workCell=new So,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(e,t,r){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=r}createRow(e,t,r,n,a,i,s,l,c,u,d){let f=[],m=this._characterJoinerService.getJoinedCharacters(t),p=this._themeService.colors,v=e.getNoBgTrimmedLength();r&&v<i+1&&(v=i+1);let b,y=0,S="",_=0,N=0,k=0,j=0,E=!1,T=0,O=!1,R=0,q=0,$=[],L=u!==-1&&d!==-1;for(let A=0;A<v;A++){e.loadCell(A,this._workCell);let M=this._workCell.getWidth();if(M===0)continue;let z=!1,I=A>=q,B=A,F=this._workCell;if(m.length>0&&A===m[0][0]&&I){let ue=m.shift(),H=this._isCellInSelection(ue[0],t);for(_=ue[0]+1;_<ue[1];_++)I&&(I=H===this._isCellInSelection(_,t));I&&(I=!r||i<ue[0]||i>=ue[1]),I?(z=!0,F=new FVe(this._workCell,e.translateToString(!0,ue[0],ue[1]),ue[1]-ue[0]),B=ue[1]-1,M=F.getWidth()):q=ue[1]}let U=this._isCellInSelection(A,t),V=r&&A===i,K=L&&A>=u&&A<=d,G=!1;this._decorationService.forEachDecorationAtCell(A,t,void 0,ue=>{G=!0});let J=F.getChars()||wd;if(J===" "&&(F.isUnderline()||F.isOverline())&&(J=""),R=M*l-c.get(J,F.isBold(),F.isItalic()),!b)b=this._document.createElement("span");else if(y&&(U&&O||!U&&!O&&F.bg===N)&&(U&&O&&p.selectionForeground||F.fg===k)&&F.extended.ext===j&&K===E&&R===T&&!V&&!z&&!G&&I){F.isInvisible()?S+=wd:S+=J,y++;continue}else y&&(b.textContent=S),b=this._document.createElement("span"),y=0,S="";if(N=F.bg,k=F.fg,j=F.extended.ext,E=K,T=R,O=U,z&&i>=A&&i<=B&&(i=A),!this._coreService.isCursorHidden&&V&&this._coreService.isCursorInitialized){if($.push("xterm-cursor"),this._coreBrowserService.isFocused)s&&$.push("xterm-cursor-blink"),$.push(n==="bar"?"xterm-cursor-bar":n==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(a)switch(a){case"outline":$.push("xterm-cursor-outline");break;case"block":$.push("xterm-cursor-block");break;case"bar":$.push("xterm-cursor-bar");break;case"underline":$.push("xterm-cursor-underline");break}}if(F.isBold()&&$.push("xterm-bold"),F.isItalic()&&$.push("xterm-italic"),F.isDim()&&$.push("xterm-dim"),F.isInvisible()?S=wd:S=F.getChars()||wd,F.isUnderline()&&($.push(`xterm-underline-${F.extended.underlineStyle}`),S===" "&&(S=""),!F.isUnderlineColorDefault()))if(F.isUnderlineColorRGB())b.style.textDecorationColor=`rgb(${o1.toColorRGB(F.getUnderlineColor()).join(",")})`;else{let ue=F.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&F.isBold()&&ue<8&&(ue+=8),b.style.textDecorationColor=p.ansi[ue].css}F.isOverline()&&($.push("xterm-overline"),S===" "&&(S="")),F.isStrikethrough()&&$.push("xterm-strikethrough"),K&&(b.style.textDecoration="underline");let ee=F.getFgColor(),Y=F.getFgColorMode(),ie=F.getBgColor(),fe=F.getBgColorMode(),me=!!F.isInverse();if(me){let ue=ee;ee=ie,ie=ue;let H=Y;Y=fe,fe=H}let te,oe,ce=!1;this._decorationService.forEachDecorationAtCell(A,t,void 0,ue=>{ue.options.layer!=="top"&&ce||(ue.backgroundColorRGB&&(fe=50331648,ie=ue.backgroundColorRGB.rgba>>8&16777215,te=ue.backgroundColorRGB),ue.foregroundColorRGB&&(Y=50331648,ee=ue.foregroundColorRGB.rgba>>8&16777215,oe=ue.foregroundColorRGB),ce=ue.options.layer==="top")}),!ce&&U&&(te=this._coreBrowserService.isFocused?p.selectionBackgroundOpaque:p.selectionInactiveBackgroundOpaque,ie=te.rgba>>8&16777215,fe=50331648,ce=!0,p.selectionForeground&&(Y=50331648,ee=p.selectionForeground.rgba>>8&16777215,oe=p.selectionForeground)),ce&&$.push("xterm-decoration-top");let Z;switch(fe){case 16777216:case 33554432:Z=p.ansi[ie],$.push(`xterm-bg-${ie}`);break;case 50331648:Z=ha.toColor(ie>>16,ie>>8&255,ie&255),this._addStyle(b,`background-color:#${TZ((ie>>>0).toString(16),"0",6)}`);break;case 0:default:me?(Z=p.foreground,$.push("xterm-bg-257")):Z=p.background}switch(te||F.isDim()&&(te=kn.multiplyOpacity(Z,.5)),Y){case 16777216:case 33554432:F.isBold()&&ee<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ee+=8),this._applyMinimumContrast(b,Z,p.ansi[ee],F,te,void 0)||$.push(`xterm-fg-${ee}`);break;case 50331648:let ue=ha.toColor(ee>>16&255,ee>>8&255,ee&255);this._applyMinimumContrast(b,Z,ue,F,te,oe)||this._addStyle(b,`color:#${TZ(ee.toString(16),"0",6)}`);break;case 0:default:this._applyMinimumContrast(b,Z,p.foreground,F,te,oe)||me&&$.push("xterm-fg-257")}$.length&&(b.className=$.join(" "),$.length=0),!V&&!z&&!G&&I?y++:b.textContent=S,R!==this.defaultSpacing&&(b.style.letterSpacing=`${R}px`),f.push(b),A=B}return b&&y&&(b.textContent=S),f}_applyMinimumContrast(e,t,r,n,a,i){if(this._optionsService.rawOptions.minimumContrastRatio===1||qVe(n.getCode()))return!1;let s=this._getContrastCache(n),l;if(!a&&!i&&(l=s.getColor(t.rgba,r.rgba)),l===void 0){let c=this._optionsService.rawOptions.minimumContrastRatio/(n.isDim()?2:1);l=kn.ensureContrastRatio(a||t,i||r,c),s.setColor((a||t).rgba,(i||r).rgba,l??null)}return l?(this._addStyle(e,`color:${l.css}`),!0):!1}_getContrastCache(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(e,t){e.setAttribute("style",`${e.getAttribute("style")||""}${t};`)}_isCellInSelection(e,t){let r=this._selectionStart,n=this._selectionEnd;return!r||!n?!1:this._columnSelectMode?r[0]<=n[0]?e>=r[0]&&t>=r[1]&&e<n[0]&&t<=n[1]:e<r[0]&&t>=r[1]&&e>=n[0]&&t<=n[1]:t>r[1]&&t<n[1]||r[1]===n[1]&&t===r[1]&&e>=r[0]&&e<n[0]||r[1]<n[1]&&t===n[1]&&e<n[0]||r[1]<n[1]&&t===r[1]&&e>=r[0]}};bP=Zn([ft(1,She),ft(2,Ui),ft(3,vu),ft(4,am),ft(5,l1),ft(6,m0)],bP);function TZ(e,t,r){for(;e.length<r;)e=t+e;return e}var KVe=class{constructor(e,t){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=e.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let r=e.createElement("span");r.classList.add("xterm-char-measure-element");let n=e.createElement("span");n.classList.add("xterm-char-measure-element"),n.style.fontWeight="bold";let a=e.createElement("span");a.classList.add("xterm-char-measure-element"),a.style.fontStyle="italic";let i=e.createElement("span");i.classList.add("xterm-char-measure-element"),i.style.fontWeight="bold",i.style.fontStyle="italic",this._measureElements=[r,n,a,i],this._container.appendChild(r),this._container.appendChild(n),this._container.appendChild(a),this._container.appendChild(i),t.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(e,t,r,n){e===this._font&&t===this._fontSize&&r===this._weight&&n===this._weightBold||(this._font=e,this._fontSize=t,this._weight=r,this._weightBold=n,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${r}`,this._measureElements[1].style.fontWeight=`${n}`,this._measureElements[2].style.fontWeight=`${r}`,this._measureElements[3].style.fontWeight=`${n}`,this.clear())}get(e,t,r){let n=0;if(!t&&!r&&e.length===1&&(n=e.charCodeAt(0))<256){if(this._flat[n]!==-9999)return this._flat[n];let s=this._measure(e,0);return s>0&&(this._flat[n]=s),s}let a=e;t&&(a+="B"),r&&(a+="I");let i=this._holey.get(a);if(i===void 0){let s=0;t&&(s|=1),r&&(s|=2),i=this._measure(e,s),i>0&&this._holey.set(a,i)}return i}_measure(e,t){let r=this._measureElements[t];return r.textContent=e.repeat(32),r.offsetWidth/32}},GVe=class{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(e,t,r,n=!1){if(this.selectionStart=t,this.selectionEnd=r,!t||!r||t[0]===r[0]&&t[1]===r[1]){this.clear();return}let a=e.buffers.active.ydisp,i=t[1]-a,s=r[1]-a,l=Math.max(i,0),c=Math.min(s,e.rows-1);if(l>=e.rows||c<0){this.clear();return}this.hasSelection=!0,this.columnSelectMode=n,this.viewportStartRow=i,this.viewportEndRow=s,this.viewportCappedStartRow=l,this.viewportCappedEndRow=c,this.startCol=t[0],this.endCol=r[0]}isCellSelected(e,t,r){return this.hasSelection?(r-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&r>=this.viewportCappedStartRow&&t<this.endCol&&r<=this.viewportCappedEndRow:t<this.startCol&&r>=this.viewportCappedStartRow&&t>=this.endCol&&r<=this.viewportCappedEndRow:r>this.viewportStartRow&&r<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&r===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&r===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&r===this.viewportStartRow&&t>=this.startCol):!1}};function VVe(){return new GVe}var fL="xterm-dom-renderer-owner-",no="xterm-rows",AS="xterm-fg-",AZ="xterm-bg-",Ov="xterm-focus",DS="xterm-selection",YVe=1,yP=class extends hr{constructor(e,t,r,n,a,i,s,l,c,u,d,f,m,p){super(),this._terminal=e,this._document=t,this._element=r,this._screenElement=n,this._viewportElement=a,this._helperContainer=i,this._linkifier2=s,this._charSizeService=c,this._optionsService=u,this._bufferService=d,this._coreService=f,this._coreBrowserService=m,this._themeService=p,this._terminalClass=YVe++,this._rowElements=[],this._selectionRenderModel=VVe(),this.onRequestRedraw=this._register(new nt).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(no),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(DS),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=WVe(),this._updateDimensions(),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._themeService.onChangeColors(v=>this._injectCss(v))),this._injectCss(this._themeService.colors),this._rowFactory=l.createInstance(bP,document),this._element.classList.add(fL+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline(v=>this._handleLinkHover(v))),this._register(this._linkifier2.onHideLinkUnderline(v=>this._handleLinkLeave(v))),this._register(Mn(()=>{this._element.classList.remove(fL+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new KVe(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let r of this._rowElements)r.style.width=`${this.dimensions.css.canvas.width}px`,r.style.height=`${this.dimensions.css.cell.height}px`,r.style.lineHeight=`${this.dimensions.css.cell.height}px`,r.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let t=`${this._terminalSelector} .${no} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=t,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let t=`${this._terminalSelector} .${no} { pointer-events: none; color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;t+=`${this._terminalSelector} .${no} .xterm-dim { color: ${kn.multiplyOpacity(e.foreground,.5).css};}`,t+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let r=`blink_underline_${this._terminalClass}`,n=`blink_bar_${this._terminalClass}`,a=`blink_block_${this._terminalClass}`;t+=`@keyframes ${r} { 50% {  border-bottom-style: hidden; }}`,t+=`@keyframes ${n} { 50% {  box-shadow: none; }}`,t+=`@keyframes ${a} { 0% {  background-color: ${e.cursor.css};  color: ${e.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${e.cursor.css}; }}`,t+=`${this._terminalSelector} .${no}.${Ov} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${r} 1s step-end infinite;}${this._terminalSelector} .${no}.${Ov} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${n} 1s step-end infinite;}${this._terminalSelector} .${no}.${Ov} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${a} 1s step-end infinite;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-block { background-color: ${e.cursor.css}; color: ${e.cursorAccent.css};}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${e.cursor.css} !important; color: ${e.cursorAccent.css} !important;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${e.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,t+=`${this._terminalSelector} .${DS} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${DS} div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .${DS} div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(let[i,s]of e.ansi.entries())t+=`${this._terminalSelector} .${AS}${i} { color: ${s.css}; }${this._terminalSelector} .${AS}${i}.xterm-dim { color: ${kn.multiplyOpacity(s,.5).css}; }${this._terminalSelector} .${AZ}${i} { background-color: ${s.css}; }`;t+=`${this._terminalSelector} .${AS}257 { color: ${kn.opaque(e.background).css}; }${this._terminalSelector} .${AS}257.xterm-dim { color: ${kn.multiplyOpacity(kn.opaque(e.background),.5).css}; }${this._terminalSelector} .${AZ}257 { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=t}_setDefaultSpacing(){let e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${e}px`,this._rowFactory.defaultSpacing=e}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(e,t){for(let r=this._rowElements.length;r<=t;r++){let n=this._document.createElement("div");this._rowContainer.appendChild(n),this._rowElements.push(n)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,t){this._refreshRowElements(e,t),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(Ov),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(Ov),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(e,t,r){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,r),this.renderRows(0,this._bufferService.rows-1),!e||!t||(this._selectionRenderModel.update(this._terminal,e,t,r),!this._selectionRenderModel.hasSelection))return;let n=this._selectionRenderModel.viewportStartRow,a=this._selectionRenderModel.viewportEndRow,i=this._selectionRenderModel.viewportCappedStartRow,s=this._selectionRenderModel.viewportCappedEndRow,l=this._document.createDocumentFragment();if(r){let c=e[0]>t[0];l.appendChild(this._createSelectionElement(i,c?t[0]:e[0],c?e[0]:t[0],s-i+1))}else{let c=n===i?e[0]:0,u=i===a?t[0]:this._bufferService.cols;l.appendChild(this._createSelectionElement(i,c,u));let d=s-i-1;if(l.appendChild(this._createSelectionElement(i+1,0,this._bufferService.cols,d)),i!==s){let f=a===s?t[0]:this._bufferService.cols;l.appendChild(this._createSelectionElement(s,0,f))}}this._selectionContainer.appendChild(l)}_createSelectionElement(e,t,r,n=1){let a=this._document.createElement("div"),i=t*this.dimensions.css.cell.width,s=this.dimensions.css.cell.width*(r-t);return i+s>this.dimensions.css.canvas.width&&(s=this.dimensions.css.canvas.width-i),a.style.height=`${n*this.dimensions.css.cell.height}px`,a.style.top=`${e*this.dimensions.css.cell.height}px`,a.style.left=`${i}px`,a.style.width=`${s}px`,a}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let e of this._rowElements)e.replaceChildren()}renderRows(e,t){let r=this._bufferService.buffer,n=r.ybase+r.y,a=Math.min(r.x,this._bufferService.cols-1),i=this._coreService.decPrivateModes.cursorBlink??this._optionsService.rawOptions.cursorBlink,s=this._coreService.decPrivateModes.cursorStyle??this._optionsService.rawOptions.cursorStyle,l=this._optionsService.rawOptions.cursorInactiveStyle;for(let c=e;c<=t;c++){let u=c+r.ydisp,d=this._rowElements[c],f=r.lines.get(u);if(!d||!f)break;d.replaceChildren(...this._rowFactory.createRow(f,u,u===n,s,l,a,i,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${fL}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,t,r,n,a,i){r<0&&(e=0),n<0&&(t=0);let s=this._bufferService.rows-1;r=Math.max(Math.min(r,s),0),n=Math.max(Math.min(n,s),0),a=Math.min(a,this._bufferService.cols);let l=this._bufferService.buffer,c=l.ybase+l.y,u=Math.min(l.x,a-1),d=this._optionsService.rawOptions.cursorBlink,f=this._optionsService.rawOptions.cursorStyle,m=this._optionsService.rawOptions.cursorInactiveStyle;for(let p=r;p<=n;++p){let v=p+l.ydisp,b=this._rowElements[p],y=l.lines.get(v);if(!b||!y)break;b.replaceChildren(...this._rowFactory.createRow(y,v,v===c,f,m,u,d,this.dimensions.css.cell.width,this._widthCache,i?p===r?e:0:-1,i?(p===n?t:a)-1:-1))}}};yP=Zn([ft(7,uB),ft(8,d2),ft(9,Ui),ft(10,Fi),ft(11,am),ft(12,vu),ft(13,m0)],yP);var xP=class extends hr{constructor(e,t,r){super(),this._optionsService=r,this.width=0,this.height=0,this._onCharSizeChange=this._register(new nt),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new JVe(this._optionsService))}catch{this._measureStrategy=this._register(new QVe(e,t,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let e=this._measureStrategy.measure();(e.width!==this.width||e.height!==this.height)&&(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};xP=Zn([ft(2,Ui)],xP);var Fhe=class extends hr{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(e,t){e!==void 0&&e>0&&t!==void 0&&t>0&&(this._result.width=e,this._result.height=t)}},QVe=class extends Fhe{constructor(e,t,r){super(),this._document=e,this._parentElement=t,this._optionsService=r,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}},JVe=class extends Fhe{constructor(e){super(),this._optionsService=e,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let t=this._ctx.measureText("W");if(!("width"in t&&"fontBoundingBoxAscent"in t&&"fontBoundingBoxDescent"in t))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}},ZVe=class extends hr{constructor(e,t,r){super(),this._textarea=e,this._window=t,this.mainDocument=r,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new XVe(this._window)),this._onDprChange=this._register(new nt),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new nt),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange(n=>this._screenDprMonitor.setWindow(n))),this._register(ii.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register(Qt(this._textarea,"focus",()=>this._isFocused=!0)),this._register(Qt(this._textarea,"blur",()=>this._isFocused=!1))}get window(){return this._window}set window(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}},XVe=class extends hr{constructor(e){super(),this._parentWindow=e,this._windowResizeListener=this._register(new Lg),this._onDprChange=this._register(new nt),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register(Mn(()=>this.clearListener()))}setWindow(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=Qt(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}},eYe=class extends hr{constructor(){super(),this.linkProviders=[],this._register(Mn(()=>this.linkProviders.length=0))}registerLinkProvider(e){return this.linkProviders.push(e),{dispose:()=>{let t=this.linkProviders.indexOf(e);t!==-1&&this.linkProviders.splice(t,1)}}}};function bB(e,t,r){let n=r.getBoundingClientRect(),a=e.getComputedStyle(r),i=parseInt(a.getPropertyValue("padding-left")),s=parseInt(a.getPropertyValue("padding-top"));return[t.clientX-n.left-i,t.clientY-n.top-s]}function tYe(e,t,r,n,a,i,s,l,c){if(!i)return;let u=bB(e,t,r);if(u)return u[0]=Math.ceil((u[0]+(c?s/2:0))/s),u[1]=Math.ceil(u[1]/l),u[0]=Math.min(Math.max(u[0],1),n+(c?1:0)),u[1]=Math.min(Math.max(u[1],1),a),u}var wP=class{constructor(e,t){this._renderService=e,this._charSizeService=t}getCoords(e,t,r,n,a){return tYe(window,e,t,r,n,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,a)}getMouseReportCoords(e,t){let r=bB(window,e,t);if(this._charSizeService.hasValidSize)return r[0]=Math.min(Math.max(r[0],0),this._renderService.dimensions.css.canvas.width-1),r[1]=Math.min(Math.max(r[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}};wP=Zn([ft(0,bu),ft(1,d2)],wP);var rYe=class{constructor(e,t){this._renderCallback=e,this._coreBrowserService=t,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(e,t,r){this._rowCount=r,e=e!==void 0?e:0,t=t!==void 0?t:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,t):t,!this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0){this._runRefreshCallbacks();return}let e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}},Uhe={};fGe(Uhe,{getSafariVersion:()=>aYe,isChromeOS:()=>Khe,isFirefox:()=>Hhe,isIpad:()=>iYe,isIphone:()=>sYe,isLegacyEdge:()=>nYe,isLinux:()=>yB,isMac:()=>aC,isNode:()=>f2,isSafari:()=>qhe,isWindows:()=>Whe});var f2=typeof process<"u"&&"title"in process,c1=f2?"node":navigator.userAgent,u1=f2?"node":navigator.platform,Hhe=c1.includes("Firefox"),nYe=c1.includes("Edge"),qhe=/^((?!chrome|android).)*safari/i.test(c1);function aYe(){if(!qhe)return 0;let e=c1.match(/Version\/(\d+)/);return e===null||e.length<2?0:parseInt(e[1])}var aC=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u1),iYe=u1==="iPad",sYe=u1==="iPhone",Whe=["Windows","Win16","Win32","WinCE"].includes(u1),yB=u1.indexOf("Linux")>=0,Khe=/\bCrOS\b/.test(c1),Ghe=class{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,r=0,n=e.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(t=performance.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,performance.now()-t),r=Math.max(t,r),a=e.timeRemaining(),r*1.5>a){n-t<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),this._start();return}n=a}this.clear()}},oYe=class extends Ghe{_requestCallback(t){return setTimeout(()=>t(this._createDeadline(16)))}_cancelCallback(t){clearTimeout(t)}_createDeadline(t){let r=performance.now()+t;return{timeRemaining:()=>Math.max(0,r-performance.now())}}},lYe=class extends Ghe{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}},iC=!f2&&"requestIdleCallback"in window?lYe:oYe,cYe=class{constructor(){this._queue=new iC}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}},SP=class extends hr{constructor(e,t,r,n,a,i,s,l,c){super(),this._rowCount=e,this._optionsService=r,this._charSizeService=n,this._coreService=a,this._coreBrowserService=l,this._renderer=this._register(new Lg),this._pausedResizeTask=new cYe,this._observerDisposable=this._register(new Lg),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new nt),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new nt),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new nt),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new nt),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new rYe((u,d)=>this._renderRows(u,d),this._coreBrowserService),this._register(this._renderDebouncer),this._syncOutputHandler=new uYe(this._coreBrowserService,this._coreService,()=>this._fullRefresh()),this._register(Mn(()=>this._syncOutputHandler.dispose())),this._register(this._coreBrowserService.onDprChange(()=>this.handleDevicePixelRatioChange())),this._register(s.onResize(()=>this._fullRefresh())),this._register(s.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this._register(i.onDecorationRegistered(()=>this._fullRefresh())),this._register(i.onDecorationRemoved(()=>this._fullRefresh())),this._register(this._optionsService.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(s.cols,s.rows),this._fullRefresh()})),this._register(this._optionsService.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(s.buffer.y,s.buffer.y,!0))),this._register(c.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(this._coreBrowserService.window,t),this._register(this._coreBrowserService.onWindowChange(u=>this._registerIntersectionObserver(u,t)))}get dimensions(){return this._renderer.value.dimensions}_registerIntersectionObserver(e,t){if("IntersectionObserver"in e){let r=new e.IntersectionObserver(n=>this._handleIntersectionChange(n[n.length-1]),{threshold:0});r.observe(t),this._observerDisposable.value=Mn(()=>r.disconnect())}}_handleIntersectionChange(e){this._isPaused=e.isIntersecting===void 0?e.intersectionRatio===0:!e.isIntersecting,!this._isPaused&&!this._charSizeService.hasValidSize&&this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,t,r=!1){if(this._isPaused){this._needsFullRefresh=!0;return}if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,t);return}let n=this._syncOutputHandler.flush();n&&(e=Math.min(e,n.start),t=Math.max(t,n.end)),r||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount)}_renderRows(e,t){if(this._renderer.value){if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,t);return}e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0}}resize(e,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw(t=>this.refreshRows(t.start,t.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,t){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(e,t)):this._renderer.value.handleResize(e,t),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,t,r){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=r,this._renderer.value?.handleSelectionChanged(e,t,r)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};SP=Zn([ft(2,Ui),ft(3,d2),ft(4,am),ft(5,l1),ft(6,Fi),ft(7,vu),ft(8,m0)],SP);var uYe=class{constructor(e,t,r){this._coreBrowserService=e,this._coreService=t,this._onTimeout=r,this._start=0,this._end=0,this._isBuffering=!1}bufferRows(e,t){this._isBuffering?(this._start=Math.min(this._start,e),this._end=Math.max(this._end,t)):(this._start=e,this._end=t,this._isBuffering=!0),this._timeout===void 0&&(this._timeout=this._coreBrowserService.window.setTimeout(()=>{this._timeout=void 0,this._coreService.decPrivateModes.synchronizedOutput=!1,this._onTimeout()},1e3))}flush(){if(this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0),!this._isBuffering)return;let e={start:this._start,end:this._end};return this._isBuffering=!1,e}dispose(){this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0)}};function dYe(e,t,r,n){let a=r.buffer.x,i=r.buffer.y;if(!r.buffer.hasScrollback)return mYe(a,i,e,t,r,n)+h2(i,t,r,n)+pYe(a,i,e,t,r,n);let s;if(i===t)return s=a>e?"D":"C",ox(Math.abs(a-e),sx(s,n));s=i>t?"D":"C";let l=Math.abs(i-t),c=hYe(i>t?e:a,r)+(l-1)*r.cols+1+fYe(i>t?a:e);return ox(c,sx(s,n))}function fYe(e,t){return e-1}function hYe(e,t){return t.cols-e}function mYe(e,t,r,n,a,i){return h2(t,n,a,i).length===0?"":ox(Yhe(e,t,e,t-Lh(t,a),!1,a).length,sx("D",i))}function h2(e,t,r,n){let a=e-Lh(e,r),i=t-Lh(t,r),s=Math.abs(a-i)-gYe(e,t,r);return ox(s,sx(Vhe(e,t),n))}function pYe(e,t,r,n,a,i){let s;h2(t,n,a,i).length>0?s=n-Lh(n,a):s=t;let l=n,c=vYe(e,t,r,n,a,i);return ox(Yhe(e,s,r,l,c==="C",a).length,sx(c,i))}function gYe(e,t,r){let n=0,a=e-Lh(e,r),i=t-Lh(t,r);for(let s=0;s<Math.abs(a-i);s++){let l=Vhe(e,t)==="A"?-1:1;r.buffer.lines.get(a+l*s)?.isWrapped&&n++}return n}function Lh(e,t){let r=0,n=t.buffer.lines.get(e),a=n?.isWrapped;for(;a&&e>=0&&e<t.rows;)r++,n=t.buffer.lines.get(--e),a=n?.isWrapped;return r}function vYe(e,t,r,n,a,i){let s;return h2(r,n,a,i).length>0?s=n-Lh(n,a):s=t,e<r&&s<=n||e>=r&&s<n?"C":"D"}function Vhe(e,t){return e>t?"A":"B"}function Yhe(e,t,r,n,a,i){let s=e,l=t,c="";for(;(s!==r||l!==n)&&l>=0&&l<i.buffer.lines.length;)s+=a?1:-1,a&&s>i.cols-1?(c+=i.buffer.translateBufferLineToString(l,!1,e,s),s=0,e=0,l++):!a&&s<0&&(c+=i.buffer.translateBufferLineToString(l,!1,0,e+1),s=i.cols-1,e=s,l--);return c+i.buffer.translateBufferLineToString(l,!1,e,s)}function sx(e,t){let r=t?"O":"[";return qe.ESC+r+e}function ox(e,t){e=Math.floor(e);let r="";for(let n=0;n<e;n++)r+=t;return r}var bYe=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols===0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let e=this.selectionStart,t=this.selectionEnd;return!e||!t?!1:e[1]>t[1]||e[1]===t[1]&&e[0]>t[0]}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}};function DZ(e,t){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}var hL=50,yYe=15,xYe=50,wYe=500,SYe="",kYe=new RegExp(SYe,"g"),kP=class extends hr{constructor(e,t,r,n,a,i,s,l,c){super(),this._element=e,this._screenElement=t,this._linkifier=r,this._bufferService=n,this._coreService=a,this._mouseService=i,this._optionsService=s,this._renderService=l,this._coreBrowserService=c,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new So,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new nt),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new nt),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new nt),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new nt),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=u=>this._handleMouseMove(u),this._mouseUpListener=u=>this._handleMouseUp(u),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(u=>this._handleTrim(u)),this._register(this._bufferService.buffers.onBufferActivate(u=>this._handleBufferActivate(u))),this.enable(),this._model=new bYe(this._bufferService),this._activeSelectionMode=0,this._register(Mn(()=>{this._removeMouseDownListeners()})),this._register(this._bufferService.onResize(u=>{u.rowsChanged&&this.clearSelection()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!e||!t?!1:e[0]!==t[0]||e[1]!==t[1]}get selectionText(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";let r=this._bufferService.buffer,n=[];if(this._activeSelectionMode===3){if(e[0]===t[0])return"";let a=e[0]<t[0]?e[0]:t[0],i=e[0]<t[0]?t[0]:e[0];for(let s=e[1];s<=t[1];s++){let l=r.translateBufferLineToString(s,!0,a,i);n.push(l)}}else{let a=e[1]===t[1]?t[0]:void 0;n.push(r.translateBufferLineToString(e[1],!0,e[0],a));for(let i=e[1]+1;i<=t[1]-1;i++){let s=r.lines.get(i),l=r.translateBufferLineToString(i,!0);s?.isWrapped?n[n.length-1]+=l:n.push(l)}if(e[1]!==t[1]){let i=r.lines.get(t[1]),s=r.translateBufferLineToString(t[1],!0,0,t[0]);i&&i.isWrapped?n[n.length-1]+=s:n.push(s)}}return n.map(a=>a.replace(kYe," ")).join(Whe?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),yB&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(e){let t=this._getMouseBufferCoords(e),r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!r||!n||!t?!1:this._areCoordsInSelection(t,r,n)}isCellInSelection(e,t){let r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!r||!n?!1:this._areCoordsInSelection([e,t],r,n)}_areCoordsInSelection(e,t,r){return e[1]>t[1]&&e[1]<r[1]||t[1]===r[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<r[0]||t[1]<r[1]&&e[1]===r[1]&&e[0]<r[0]||t[1]<r[1]&&e[1]===t[1]&&e[0]>=t[0]}_selectWordAtCursor(e,t){let r=this._linkifier.currentLink?.link?.range;if(r)return this._model.selectionStart=[r.start.x-1,r.start.y-1],this._model.selectionStartLength=DZ(r,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let n=this._getMouseBufferCoords(e);return n?(this._selectWordAt(n,t),this._model.selectionEnd=void 0,!0):!1}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){let t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}_getMouseEventScrollAmount(e){let t=bB(this._coreBrowserService.window,e,this._screenElement)[1],r=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=r?0:(t>r&&(t-=r),t=Math.min(Math.max(t,-hL),hL),t/=hL,t/Math.abs(t)+Math.round(t*(yYe-1)))}shouldForceSelection(e){return aC?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,!(e.button===2&&this.hasSelection)&&e.button===0){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):e.detail===1?this._handleSingleClick(e):e.detail===2?this._handleDoubleClick(e):e.detail===3&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),xYe)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&t.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){let t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}shouldColumnSelect(e){return e.altKey&&!(aC&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;let t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let r=this._bufferService.buffer;if(this._model.selectionEnd[1]<r.lines.length){let n=r.lines.get(this._model.selectionEnd[1]);n&&n.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}(!t||t[0]!==this._model.selectionEnd[0]||t[1]!==this._model.selectionEnd[1])&&this.refresh(!0)}_dragScroll(){if(!(!this._model.selectionEnd||!this._model.selectionStart)&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let e=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){let t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<wYe&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let r=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(r&&r[0]!==void 0&&r[1]!==void 0){let n=dYe(r[0]-1,r[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(n,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,r=!!e&&!!t&&(e[0]!==t[0]||e[1]!==t[1]);if(!r){this._oldHasSelection&&this._fireOnSelectionChange(e,t,r);return}!e||!t||(!this._oldSelectionStart||!this._oldSelectionEnd||e[0]!==this._oldSelectionStart[0]||e[1]!==this._oldSelectionStart[1]||t[0]!==this._oldSelectionEnd[0]||t[1]!==this._oldSelectionEnd[1])&&this._fireOnSelectionChange(e,t,r)}_fireOnSelectionChange(e,t,r){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=r,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(t=>this._handleTrim(t))}_convertViewportColToCharacterIndex(e,t){let r=t;for(let n=0;t>=n;n++){let a=e.loadCell(n,this._workCell).getChars().length;this._workCell.getWidth()===0?r--:a>1&&t!==n&&(r+=a-1)}return r}setSelection(e,t,r){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=r,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,t,r=!0,n=!0){if(e[0]>=this._bufferService.cols)return;let a=this._bufferService.buffer,i=a.lines.get(e[1]);if(!i)return;let s=a.translateBufferLineToString(e[1],!1),l=this._convertViewportColToCharacterIndex(i,e[0]),c=l,u=e[0]-l,d=0,f=0,m=0,p=0;if(s.charAt(l)===" "){for(;l>0&&s.charAt(l-1)===" ";)l--;for(;c<s.length&&s.charAt(c+1)===" ";)c++}else{let y=e[0],S=e[0];i.getWidth(y)===0&&(d++,y--),i.getWidth(S)===2&&(f++,S++);let _=i.getString(S).length;for(_>1&&(p+=_-1,c+=_-1);y>0&&l>0&&!this._isCharWordSeparator(i.loadCell(y-1,this._workCell));){i.loadCell(y-1,this._workCell);let N=this._workCell.getChars().length;this._workCell.getWidth()===0?(d++,y--):N>1&&(m+=N-1,l-=N-1),l--,y--}for(;S<i.length&&c+1<s.length&&!this._isCharWordSeparator(i.loadCell(S+1,this._workCell));){i.loadCell(S+1,this._workCell);let N=this._workCell.getChars().length;this._workCell.getWidth()===2?(f++,S++):N>1&&(p+=N-1,c+=N-1),c++,S++}}c++;let v=l+u-d+m,b=Math.min(this._bufferService.cols,c-l+d+f-m-p);if(!(!t&&s.slice(l,c).trim()==="")){if(r&&v===0&&i.getCodePoint(0)!==32){let y=a.lines.get(e[1]-1);if(y&&i.isWrapped&&y.getCodePoint(this._bufferService.cols-1)!==32){let S=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(S){let _=this._bufferService.cols-S.start;v-=_,b+=_}}}if(n&&v+b===this._bufferService.cols&&i.getCodePoint(this._bufferService.cols-1)!==32){let y=a.lines.get(e[1]+1);if(y?.isWrapped&&y.getCodePoint(0)!==32){let S=this._getWordAt([0,e[1]+1],!1,!1,!0);S&&(b+=S.length)}}return{start:v,length:b}}}_selectWordAt(e,t){let r=this._getWordAt(e,t);if(r){for(;r.start<0;)r.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[r.start,e[1]],this._model.selectionStartLength=r.length}}_selectToWordAt(e){let t=this._getWordAt(e,!0);if(t){let r=e[1];for(;t.start<0;)t.start+=this._bufferService.cols,r--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,r++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,r]}}_isCharWordSeparator(e){return e.getWidth()===0?!1:this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){let t=this._bufferService.buffer.getWrappedRangeForLine(e),r={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=DZ(r,this._bufferService.cols)}};kP=Zn([ft(3,Fi),ft(4,am),ft(5,dB),ft(6,Ui),ft(7,bu),ft(8,vu)],kP);var LZ=class{constructor(){this._data={}}set(e,t,r){this._data[e]||(this._data[e]={}),this._data[e][t]=r}get(e,t){return this._data[e]?this._data[e][t]:void 0}clear(){this._data={}}},OZ=class{constructor(){this._color=new LZ,this._css=new LZ}setCss(e,t,r){this._css.set(e,t,r)}getCss(e,t){return this._css.get(e,t)}setColor(e,t,r){this._color.set(e,t,r)}getColor(e,t){return this._color.get(e,t)}clear(){this._color.clear(),this._css.clear()}},Sa=Object.freeze((()=>{let e=[zn.toColor("#2e3436"),zn.toColor("#cc0000"),zn.toColor("#4e9a06"),zn.toColor("#c4a000"),zn.toColor("#3465a4"),zn.toColor("#75507b"),zn.toColor("#06989a"),zn.toColor("#d3d7cf"),zn.toColor("#555753"),zn.toColor("#ef2929"),zn.toColor("#8ae234"),zn.toColor("#fce94f"),zn.toColor("#729fcf"),zn.toColor("#ad7fa8"),zn.toColor("#34e2e2"),zn.toColor("#eeeeec")],t=[0,95,135,175,215,255];for(let r=0;r<216;r++){let n=t[r/36%6|0],a=t[r/6%6|0],i=t[r%6];e.push({css:ha.toCss(n,a,i),rgba:ha.toRgba(n,a,i)})}for(let r=0;r<24;r++){let n=8+r*10;e.push({css:ha.toCss(n,n,n),rgba:ha.toRgba(n,n,n)})}return e})()),zf=zn.toColor("#ffffff"),yb=zn.toColor("#000000"),IZ=zn.toColor("#ffffff"),RZ=yb,Iv={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},_Ye=zf,_P=class extends hr{constructor(e){super(),this._optionsService=e,this._contrastCache=new OZ,this._halfContrastCache=new OZ,this._onChangeColors=this._register(new nt),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:zf,background:yb,cursor:IZ,cursorAccent:RZ,selectionForeground:void 0,selectionBackgroundTransparent:Iv,selectionBackgroundOpaque:kn.blend(yb,Iv),selectionInactiveBackgroundTransparent:Iv,selectionInactiveBackgroundOpaque:kn.blend(yb,Iv),scrollbarSliderBackground:kn.opacity(zf,.2),scrollbarSliderHoverBackground:kn.opacity(zf,.4),scrollbarSliderActiveBackground:kn.opacity(zf,.5),overviewRulerBorder:zf,ansi:Sa.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this._register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(e={}){let t=this._colors;if(t.foreground=ln(e.foreground,zf),t.background=ln(e.background,yb),t.cursor=kn.blend(t.background,ln(e.cursor,IZ)),t.cursorAccent=kn.blend(t.background,ln(e.cursorAccent,RZ)),t.selectionBackgroundTransparent=ln(e.selectionBackground,Iv),t.selectionBackgroundOpaque=kn.blend(t.background,t.selectionBackgroundTransparent),t.selectionInactiveBackgroundTransparent=ln(e.selectionInactiveBackground,t.selectionBackgroundTransparent),t.selectionInactiveBackgroundOpaque=kn.blend(t.background,t.selectionInactiveBackgroundTransparent),t.selectionForeground=e.selectionForeground?ln(e.selectionForeground,MZ):void 0,t.selectionForeground===MZ&&(t.selectionForeground=void 0),kn.isOpaque(t.selectionBackgroundTransparent)&&(t.selectionBackgroundTransparent=kn.opacity(t.selectionBackgroundTransparent,.3)),kn.isOpaque(t.selectionInactiveBackgroundTransparent)&&(t.selectionInactiveBackgroundTransparent=kn.opacity(t.selectionInactiveBackgroundTransparent,.3)),t.scrollbarSliderBackground=ln(e.scrollbarSliderBackground,kn.opacity(t.foreground,.2)),t.scrollbarSliderHoverBackground=ln(e.scrollbarSliderHoverBackground,kn.opacity(t.foreground,.4)),t.scrollbarSliderActiveBackground=ln(e.scrollbarSliderActiveBackground,kn.opacity(t.foreground,.5)),t.overviewRulerBorder=ln(e.overviewRulerBorder,_Ye),t.ansi=Sa.slice(),t.ansi[0]=ln(e.black,Sa[0]),t.ansi[1]=ln(e.red,Sa[1]),t.ansi[2]=ln(e.green,Sa[2]),t.ansi[3]=ln(e.yellow,Sa[3]),t.ansi[4]=ln(e.blue,Sa[4]),t.ansi[5]=ln(e.magenta,Sa[5]),t.ansi[6]=ln(e.cyan,Sa[6]),t.ansi[7]=ln(e.white,Sa[7]),t.ansi[8]=ln(e.brightBlack,Sa[8]),t.ansi[9]=ln(e.brightRed,Sa[9]),t.ansi[10]=ln(e.brightGreen,Sa[10]),t.ansi[11]=ln(e.brightYellow,Sa[11]),t.ansi[12]=ln(e.brightBlue,Sa[12]),t.ansi[13]=ln(e.brightMagenta,Sa[13]),t.ansi[14]=ln(e.brightCyan,Sa[14]),t.ansi[15]=ln(e.brightWhite,Sa[15]),e.extendedAnsi){let r=Math.min(t.ansi.length-16,e.extendedAnsi.length);for(let n=0;n<r;n++)t.ansi[n+16]=ln(e.extendedAnsi[n],Sa[n+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(e===void 0){for(let t=0;t<this._restoreColors.ansi.length;++t)this._colors.ansi[t]=this._restoreColors.ansi[t];return}switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};_P=Zn([ft(0,Ui)],_P);function ln(e,t){if(e!==void 0)try{return zn.toColor(e)}catch{}return t}var NYe=class{constructor(...e){this._entries=new Map;for(let[t,r]of e)this.set(t,r)}set(e,t){let r=this._entries.get(e);return this._entries.set(e,t),r}forEach(e){for(let[t,r]of this._entries.entries())e(t,r)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}},CYe=class{constructor(){this._services=new NYe,this._services.set(uB,this)}setService(e,t){this._services.set(e,t)}getService(e){return this._services.get(e)}createInstance(e,...t){let r=yGe(e).sort((i,s)=>i.index-s.index),n=[];for(let i of r){let s=this._services.get(i.id);if(!s)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${i.id._id}.`);n.push(s)}let a=r.length>0?r[0].index:t.length;if(t.length!==a)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${t.length} static arguments`);return new e(...t,...n)}},jYe={trace:0,debug:1,info:2,warn:3,error:4,off:5},EYe="xterm.js: ",NP=class extends hr{constructor(e){super(),this._optionsService=e,this._logLevel=5,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}get logLevel(){return this._logLevel}_updateLogLevel(){this._logLevel=jYe[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let t=0;t<e.length;t++)typeof e[t]=="function"&&(e[t]=e[t]())}_log(e,t,r){this._evalLazyOptionalParams(r),e.call(console,(this._optionsService.options.logger?"":EYe)+t,...r)}trace(e,...t){this._logLevel<=0&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,e,t)}debug(e,...t){this._logLevel<=1&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,e,t)}info(e,...t){this._logLevel<=2&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,e,t)}warn(e,...t){this._logLevel<=3&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,e,t)}error(e,...t){this._logLevel<=4&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,e,t)}};NP=Zn([ft(0,Ui)],NP);var PZ=class extends hr{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this._register(new nt),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new nt),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new nt),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;let t=new Array(e);for(let r=0;r<Math.min(e,this.length);r++)t[r]=this._array[this._getCyclicIndex(r)];this._array=t,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,t){this._array[this._getCyclicIndex(e)]=t}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,t,...r){if(t){for(let n=e;n<this._length-t;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(let n=this._length-1;n>=e;n--)this._array[this._getCyclicIndex(n+r.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<r.length;n++)this._array[this._getCyclicIndex(e+n)]=r[n];if(r.length&&this.onInsertEmitter.fire({index:e,amount:r.length}),this._length+r.length>this._maxLength){let n=this._length+r.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=r.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,t,r){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+r<0)throw new Error("Cannot shift elements in list beyond index 0");if(r>0){for(let a=t-1;a>=0;a--)this.set(e+a+r,this.get(e+a));let n=e+t+r-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<t;n++)this.set(e+n+r,this.get(e+n))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}},fr=3,fa=Object.freeze(new o1),LS=0,mL=2,xb=class Qhe{constructor(t,r,n=!1){this.isWrapped=n,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(t*fr);let a=r||So.fromCharData([0,phe,1,0]);for(let i=0;i<t;++i)this.setCell(i,a);this.length=t}get(t){let r=this._data[t*fr+0],n=r&2097151;return[this._data[t*fr+1],r&2097152?this._combined[t]:n?ld(n):"",r>>22,r&2097152?this._combined[t].charCodeAt(this._combined[t].length-1):n]}set(t,r){this._data[t*fr+1]=r[0],r[1].length>1?(this._combined[t]=r[1],this._data[t*fr+0]=t|2097152|r[2]<<22):this._data[t*fr+0]=r[1].charCodeAt(0)|r[2]<<22}getWidth(t){return this._data[t*fr+0]>>22}hasWidth(t){return this._data[t*fr+0]&12582912}getFg(t){return this._data[t*fr+1]}getBg(t){return this._data[t*fr+2]}hasContent(t){return this._data[t*fr+0]&4194303}getCodePoint(t){let r=this._data[t*fr+0];return r&2097152?this._combined[t].charCodeAt(this._combined[t].length-1):r&2097151}isCombined(t){return this._data[t*fr+0]&2097152}getString(t){let r=this._data[t*fr+0];return r&2097152?this._combined[t]:r&2097151?ld(r&2097151):""}isProtected(t){return this._data[t*fr+2]&536870912}loadCell(t,r){return LS=t*fr,r.content=this._data[LS+0],r.fg=this._data[LS+1],r.bg=this._data[LS+2],r.content&2097152&&(r.combinedData=this._combined[t]),r.bg&268435456&&(r.extended=this._extendedAttrs[t]),r}setCell(t,r){r.content&2097152&&(this._combined[t]=r.combinedData),r.bg&268435456&&(this._extendedAttrs[t]=r.extended),this._data[t*fr+0]=r.content,this._data[t*fr+1]=r.fg,this._data[t*fr+2]=r.bg}setCellFromCodepoint(t,r,n,a){a.bg&268435456&&(this._extendedAttrs[t]=a.extended),this._data[t*fr+0]=r|n<<22,this._data[t*fr+1]=a.fg,this._data[t*fr+2]=a.bg}addCodepointToCell(t,r,n){let a=this._data[t*fr+0];a&2097152?this._combined[t]+=ld(r):a&2097151?(this._combined[t]=ld(a&2097151)+ld(r),a&=-2097152,a|=2097152):a=r|1<<22,n&&(a&=-12582913,a|=n<<22),this._data[t*fr+0]=a}insertCells(t,r,n){if(t%=this.length,t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,n),r<this.length-t){let a=new So;for(let i=this.length-t-r-1;i>=0;--i)this.setCell(t+r+i,this.loadCell(t+i,a));for(let i=0;i<r;++i)this.setCell(t+i,n)}else for(let a=t;a<this.length;++a)this.setCell(a,n);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,n)}deleteCells(t,r,n){if(t%=this.length,r<this.length-t){let a=new So;for(let i=0;i<this.length-t-r;++i)this.setCell(t+i,this.loadCell(t+r+i,a));for(let i=this.length-r;i<this.length;++i)this.setCell(i,n)}else for(let a=t;a<this.length;++a)this.setCell(a,n);t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,n),this.getWidth(t)===0&&!this.hasContent(t)&&this.setCellFromCodepoint(t,0,1,n)}replaceCells(t,r,n,a=!1){if(a){for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodepoint(t-1,0,1,n),r<this.length&&this.getWidth(r-1)===2&&!this.isProtected(r)&&this.setCellFromCodepoint(r,0,1,n);t<r&&t<this.length;)this.isProtected(t)||this.setCell(t,n),t++;return}for(t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,n),r<this.length&&this.getWidth(r-1)===2&&this.setCellFromCodepoint(r,0,1,n);t<r&&t<this.length;)this.setCell(t++,n)}resize(t,r){if(t===this.length)return this._data.length*4*mL<this._data.buffer.byteLength;let n=t*fr;if(t>this.length){if(this._data.buffer.byteLength>=n*4)this._data=new Uint32Array(this._data.buffer,0,n);else{let a=new Uint32Array(n);a.set(this._data),this._data=a}for(let a=this.length;a<t;++a)this.setCell(a,r)}else{this._data=this._data.subarray(0,n);let a=Object.keys(this._combined);for(let s=0;s<a.length;s++){let l=parseInt(a[s],10);l>=t&&delete this._combined[l]}let i=Object.keys(this._extendedAttrs);for(let s=0;s<i.length;s++){let l=parseInt(i[s],10);l>=t&&delete this._extendedAttrs[l]}}return this.length=t,n*4*mL<this._data.buffer.byteLength}cleanupMemory(){if(this._data.length*4*mL<this._data.buffer.byteLength){let t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,r=!1){if(r){for(let n=0;n<this.length;++n)this.isProtected(n)||this.setCell(n,t);return}this._combined={},this._extendedAttrs={};for(let n=0;n<this.length;++n)this.setCell(n,t)}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(let r in t._combined)this._combined[r]=t._combined[r];this._extendedAttrs={};for(let r in t._extendedAttrs)this._extendedAttrs[r]=t._extendedAttrs[r];this.isWrapped=t.isWrapped}clone(){let t=new Qhe(0);t._data=new Uint32Array(this._data),t.length=this.length;for(let r in this._combined)t._combined[r]=this._combined[r];for(let r in this._extendedAttrs)t._extendedAttrs[r]=this._extendedAttrs[r];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(this._data[t*fr+0]&4194303)return t+(this._data[t*fr+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(this._data[t*fr+0]&4194303||this._data[t*fr+2]&50331648)return t+(this._data[t*fr+0]>>22);return 0}copyCellsFrom(t,r,n,a,i){let s=t._data;if(i)for(let c=a-1;c>=0;c--){for(let u=0;u<fr;u++)this._data[(n+c)*fr+u]=s[(r+c)*fr+u];s[(r+c)*fr+2]&268435456&&(this._extendedAttrs[n+c]=t._extendedAttrs[r+c])}else for(let c=0;c<a;c++){for(let u=0;u<fr;u++)this._data[(n+c)*fr+u]=s[(r+c)*fr+u];s[(r+c)*fr+2]&268435456&&(this._extendedAttrs[n+c]=t._extendedAttrs[r+c])}let l=Object.keys(t._combined);for(let c=0;c<l.length;c++){let u=parseInt(l[c],10);u>=r&&(this._combined[u-r+n]=t._combined[u])}}translateToString(t,r,n,a){r=r??0,n=n??this.length,t&&(n=Math.min(n,this.getTrimmedLength())),a&&(a.length=0);let i="";for(;r<n;){let s=this._data[r*fr+0],l=s&2097151,c=s&2097152?this._combined[r]:l?ld(l):wd;if(i+=c,a)for(let u=0;u<c.length;++u)a.push(r);r+=s>>22||1}return a&&a.push(r),i}};function MYe(e,t,r,n,a,i){let s=[];for(let l=0;l<e.length-1;l++){let c=l,u=e.get(++c);if(!u.isWrapped)continue;let d=[e.get(l)];for(;c<e.length&&u.isWrapped;)d.push(u),u=e.get(++c);if(!i&&n>=l&&n<c){l+=d.length-1;continue}let f=0,m=lx(d,f,t),p=1,v=0;for(;p<d.length;){let y=lx(d,p,t),S=y-v,_=r-m,N=Math.min(S,_);d[f].copyCellsFrom(d[p],v,m,N,!1),m+=N,m===r&&(f++,m=0),v+=N,v===y&&(p++,v=0),m===0&&f!==0&&d[f-1].getWidth(r-1)===2&&(d[f].copyCellsFrom(d[f-1],r-1,m++,1,!1),d[f-1].setCell(r-1,a))}d[f].replaceCells(m,r,a);let b=0;for(let y=d.length-1;y>0&&(y>f||d[y].getTrimmedLength()===0);y--)b++;b>0&&(s.push(l+d.length-b),s.push(b)),l+=d.length-1}return s}function TYe(e,t){let r=[],n=0,a=t[n],i=0;for(let s=0;s<e.length;s++)if(a===s){let l=t[++n];e.onDeleteEmitter.fire({index:s-i,amount:l}),s+=l-1,i+=l,a=t[++n]}else r.push(s);return{layout:r,countRemoved:i}}function AYe(e,t){let r=[];for(let n=0;n<t.length;n++)r.push(e.get(t[n]));for(let n=0;n<r.length;n++)e.set(n,r[n]);e.length=t.length}function DYe(e,t,r){let n=[],a=e.map((c,u)=>lx(e,u,t)).reduce((c,u)=>c+u),i=0,s=0,l=0;for(;l<a;){if(a-l<r){n.push(a-l);break}i+=r;let c=lx(e,s,t);i>c&&(i-=c,s++);let u=e[s].getWidth(i-1)===2;u&&i--;let d=u?r-1:r;n.push(d),l+=d}return n}function lx(e,t,r){if(t===e.length-1)return e[t].getTrimmedLength();let n=!e[t].hasContent(r-1)&&e[t].getWidth(r-1)===1,a=e[t+1].getWidth(0)===2;return n&&a?r-1:r}var Jhe=class Zhe{constructor(t){this.line=t,this.isDisposed=!1,this._disposables=[],this._id=Zhe._nextId++,this._onDispose=this.register(new nt),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),Dh(this._disposables),this._disposables.length=0)}register(t){return this._disposables.push(t),t}};Jhe._nextId=1;var LYe=Jhe,Ea={},Bf=Ea.B;Ea[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""};Ea.A={"#":""};Ea.B=void 0;Ea[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""};Ea.C=Ea[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};Ea.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};Ea.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""};Ea.E=Ea[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""};Ea.H=Ea[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""};var zZ=4294967295,BZ=class{constructor(e,t,r){this._hasScrollback=e,this._optionsService=t,this._bufferService=r,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=fa.clone(),this.savedCharset=Bf,this.markers=[],this._nullCell=So.fromCharData([0,phe,1,0]),this._whitespaceCell=So.fromCharData([0,wd,1,32]),this._isClearing=!1,this._memoryCleanupQueue=new iC,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new PZ(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new tC),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new tC),this._whitespaceCell}getBlankLine(e,t){return new xb(this._bufferService.cols,this.getNullCell(e),t)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;let t=e+this._optionsService.rawOptions.scrollback;return t>zZ?zZ:t}fillViewportRows(e){if(this.lines.length===0){e===void 0&&(e=fa);let t=this._rows;for(;t--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new PZ(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,t){let r=this.getNullCell(fa),n=0,a=this._getCorrectBufferLength(t);if(a>this.lines.maxLength&&(this.lines.maxLength=a),this.lines.length>0){if(this._cols<e)for(let s=0;s<this.lines.length;s++)n+=+this.lines.get(s).resize(e,r);let i=0;if(this._rows<t)for(let s=this._rows;s<t;s++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new xb(e,r)):this.ybase>0&&this.lines.length<=this.ybase+this.y+i+1?(this.ybase--,i++,this.ydisp>0&&this.ydisp--):this.lines.push(new xb(e,r)));else for(let s=this._rows;s>t;s--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(a<this.lines.maxLength){let s=this.lines.length-a;s>0&&(this.lines.trimStart(s),this.ybase=Math.max(this.ybase-s,0),this.ydisp=Math.max(this.ydisp-s,0),this.savedY=Math.max(this.savedY-s,0)),this.lines.maxLength=a}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),i&&(this.y+=i),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(let i=0;i<this.lines.length;i++)n+=+this.lines.get(i).resize(e,r);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),n>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let t=0;for(;this._memoryCleanupPosition<this.lines.length;)if(t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),t>100)return!0;return e}get _isReflowEnabled(){let e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&e.backend==="conpty"&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}_reflowLarger(e,t){let r=this._optionsService.rawOptions.reflowCursorLine,n=MYe(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(fa),r);if(n.length>0){let a=TYe(this.lines,n);AYe(this.lines,a.layout),this._reflowLargerAdjustViewport(e,t,a.countRemoved)}}_reflowLargerAdjustViewport(e,t,r){let n=this.getNullCell(fa),a=r;for(;a-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new xb(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-r,0)}_reflowSmaller(e,t){let r=this._optionsService.rawOptions.reflowCursorLine,n=this.getNullCell(fa),a=[],i=0;for(let s=this.lines.length-1;s>=0;s--){let l=this.lines.get(s);if(!l||!l.isWrapped&&l.getTrimmedLength()<=e)continue;let c=[l];for(;l.isWrapped&&s>0;)l=this.lines.get(--s),c.unshift(l);if(!r){let N=this.ybase+this.y;if(N>=s&&N<s+c.length)continue}let u=c[c.length-1].getTrimmedLength(),d=DYe(c,this._cols,e),f=d.length-c.length,m;this.ybase===0&&this.y!==this.lines.length-1?m=Math.max(0,this.y-this.lines.maxLength+f):m=Math.max(0,this.lines.length-this.lines.maxLength+f);let p=[];for(let N=0;N<f;N++){let k=this.getBlankLine(fa,!0);p.push(k)}p.length>0&&(a.push({start:s+c.length+i,newLines:p}),i+=p.length),c.push(...p);let v=d.length-1,b=d[v];b===0&&(v--,b=d[v]);let y=c.length-f-1,S=u;for(;y>=0;){let N=Math.min(S,b);if(c[v]===void 0)break;if(c[v].copyCellsFrom(c[y],S-N,b-N,N,!0),b-=N,b===0&&(v--,b=d[v]),S-=N,S===0){y--;let k=Math.max(y,0);S=lx(c,k,this._cols)}}for(let N=0;N<c.length;N++)d[N]<e&&c[N].setCell(d[N],n);let _=f-m;for(;_-- >0;)this.ybase===0?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+i)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+f,this.ybase+t-1)}if(a.length>0){let s=[],l=[];for(let b=0;b<this.lines.length;b++)l.push(this.lines.get(b));let c=this.lines.length,u=c-1,d=0,f=a[d];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+i);let m=0;for(let b=Math.min(this.lines.maxLength-1,c+i-1);b>=0;b--)if(f&&f.start>u+m){for(let y=f.newLines.length-1;y>=0;y--)this.lines.set(b--,f.newLines[y]);b++,s.push({index:u+1,amount:f.newLines.length}),m+=f.newLines.length,f=a[++d]}else this.lines.set(b,l[u--]);let p=0;for(let b=s.length-1;b>=0;b--)s[b].index+=p,this.lines.onInsertEmitter.fire(s[b]),p+=s[b].amount;let v=Math.max(0,c+i-this.lines.maxLength);v>0&&this.lines.onTrimEmitter.fire(v)}}translateBufferLineToString(e,t,r=0,n){let a=this.lines.get(e);return a?a.translateToString(t,r,n):""}getWrappedRangeForLine(e){let t=e,r=e;for(;t>0&&this.lines.get(t).isWrapped;)t--;for(;r+1<this.lines.length&&this.lines.get(r+1).isWrapped;)r++;return{first:t,last:r}}setupTabStops(e){for(e!=null?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(e==null&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(e==null&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose();this.markers.length=0,this._isClearing=!1}addMarker(e){let t=new LYe(e);return this.markers.push(t),t.register(this.lines.onTrim(r=>{t.line-=r,t.line<0&&t.dispose()})),t.register(this.lines.onInsert(r=>{t.line>=r.index&&(t.line+=r.amount)})),t.register(this.lines.onDelete(r=>{t.line>=r.index&&t.line<r.index+r.amount&&t.dispose(),t.line>r.index&&(t.line-=r.amount)})),t.register(t.onDispose(()=>this._removeMarker(t))),t}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}},OYe=class extends hr{constructor(e,t){super(),this._optionsService=e,this._bufferService=t,this._onBufferActivate=this._register(new nt),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new BZ(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new BZ(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}},Xhe=2,eme=1,CP=class extends hr{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this._register(new nt),this.onResize=this._onResize.event,this._onScroll=this._register(new nt),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,Xhe),this.rows=Math.max(e.rawOptions.rows||0,eme),this.buffers=this._register(new OYe(e,this)),this._register(this.buffers.onBufferActivate(t=>{this._onScroll.fire(t.activeBuffer.ydisp)}))}get buffer(){return this.buffers.active}resize(e,t){let r=this.cols!==e,n=this.rows!==t;this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t,colsChanged:r,rowsChanged:n})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,t=!1){let r=this.buffer,n;n=this._cachedBlankLine,(!n||n.length!==this.cols||n.getFg(0)!==e.fg||n.getBg(0)!==e.bg)&&(n=r.getBlankLine(e,t),this._cachedBlankLine=n),n.isWrapped=t;let a=r.ybase+r.scrollTop,i=r.ybase+r.scrollBottom;if(r.scrollTop===0){let s=r.lines.isFull;i===r.lines.length-1?s?r.lines.recycle().copyFrom(n):r.lines.push(n.clone()):r.lines.splice(i+1,0,n.clone()),s?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{let s=i-a+1;r.lines.shiftElements(a+1,s-1,-1),r.lines.set(i,n.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(e,t){let r=this.buffer;if(e<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else e+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);let n=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+e,r.ybase),0),n!==r.ydisp&&(t||this._onScroll.fire(r.ydisp))}};CP=Zn([ft(0,Ui)],CP);var rp={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnEraseInDisplay:!1,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},reflowCursorLine:!1,rescaleOverlappingGlyphs:!1,rightClickSelectsWord:aC,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}},IYe=["normal","bold","100","200","300","400","500","600","700","800","900"],RYe=class extends hr{constructor(e){super(),this._onOptionChange=this._register(new nt),this.onOptionChange=this._onOptionChange.event;let t={...rp};for(let r in e)if(r in t)try{let n=e[r];t[r]=this._sanitizeAndValidateOption(r,n)}catch(n){console.error(n)}this.rawOptions=t,this.options={...t},this._setupOptions(),this._register(Mn(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(e,t){return this.onOptionChange(r=>{r===e&&t(this.rawOptions[e])})}onMultipleOptionChange(e,t){return this.onOptionChange(r=>{e.indexOf(r)!==-1&&t()})}_setupOptions(){let e=r=>{if(!(r in rp))throw new Error(`No option with key "${r}"`);return this.rawOptions[r]},t=(r,n)=>{if(!(r in rp))throw new Error(`No option with key "${r}"`);n=this._sanitizeAndValidateOption(r,n),this.rawOptions[r]!==n&&(this.rawOptions[r]=n,this._onOptionChange.fire(r))};for(let r in this.rawOptions){let n={get:e.bind(this,r),set:t.bind(this,r)};Object.defineProperty(this.options,r,n)}}_sanitizeAndValidateOption(e,t){switch(e){case"cursorStyle":if(t||(t=rp[e]),!PYe(t))throw new Error(`"${t}" is not a valid value for ${e}`);break;case"wordSeparator":t||(t=rp[e]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=IYe.includes(t)?t:rp[e];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${e} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(t*10)/10));break;case"scrollback":if(t=Math.min(t,4294967295),t<0)throw new Error(`${e} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${e} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{};break}return t}};function PYe(e){return e==="block"||e==="underline"||e==="bar"}function wb(e,t=5){if(typeof e!="object")return e;let r=Array.isArray(e)?[]:{};for(let n in e)r[n]=t<=1?e[n]:e[n]&&wb(e[n],t-1);return r}var $Z=Object.freeze({insertMode:!1}),FZ=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,cursorBlink:void 0,cursorStyle:void 0,origin:!1,reverseWraparound:!1,sendFocus:!1,synchronizedOutput:!1,wraparound:!0}),jP=class extends hr{constructor(e,t,r){super(),this._bufferService=e,this._logService=t,this._optionsService=r,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new nt),this.onData=this._onData.event,this._onUserInput=this._register(new nt),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new nt),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new nt),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=wb($Z),this.decPrivateModes=wb(FZ)}reset(){this.modes=wb($Z),this.decPrivateModes=wb(FZ)}triggerDataEvent(e,t=!1){if(this._optionsService.rawOptions.disableStdin)return;let r=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&r.ybase!==r.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`),this._logService.trace("sending data (codes)",()=>e.split("").map(n=>n.charCodeAt(0))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`),this._logService.trace("sending binary (codes)",()=>e.split("").map(t=>t.charCodeAt(0))),this._onBinary.fire(e))}};jP=Zn([ft(0,Fi),ft(1,xhe),ft(2,Ui)],jP);var UZ={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>e.button===4||e.action!==1?!1:(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>e.action!==32},DRAG:{events:23,restrict:e=>!(e.action===32&&e.button===3)},ANY:{events:31,restrict:e=>!0}};function pL(e,t){let r=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return e.button===4?(r|=64,r|=e.action):(r|=e.button&3,e.button&4&&(r|=64),e.button&8&&(r|=128),e.action===32?r|=32:e.action===0&&!t&&(r|=3)),r}var gL=String.fromCharCode,HZ={DEFAULT:e=>{let t=[pL(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":`\x1B[M${gL(t[0])}${gL(t[1])}${gL(t[2])}`},SGR:e=>{let t=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${pL(e,!0)};${e.col};${e.row}${t}`},SGR_PIXELS:e=>{let t=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${pL(e,!0)};${e.x};${e.y}${t}`}},EP=class extends hr{constructor(e,t,r){super(),this._bufferService=e,this._coreService=t,this._optionsService=r,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._wheelPartialScroll=0,this._onProtocolChange=this._register(new nt),this.onProtocolChange=this._onProtocolChange.event;for(let n of Object.keys(UZ))this.addProtocol(n,UZ[n]);for(let n of Object.keys(HZ))this.addEncoding(n,HZ[n]);this.reset()}addProtocol(e,t){this._protocols[e]=t}addEncoding(e,t){this._encodings[e]=t}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null,this._wheelPartialScroll=0}consumeWheelEvent(e,t,r){if(e.deltaY===0||e.shiftKey||t===void 0||r===void 0)return 0;let n=t/r,a=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(a/=n+0,Math.abs(e.deltaY)<50&&(a*=.3),this._wheelPartialScroll+=a,a=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(a*=this._bufferService.rows),a}_applyScrollModifier(e,t){return t.altKey||t.ctrlKey||t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows||e.button===4&&e.action===32||e.button===3&&e.action!==32||e.button!==4&&(e.action===2||e.action===3)||(e.col++,e.row++,e.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,e,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(e))return!1;let t=this._encodings[this._activeEncoding](e);return t&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(e&1),up:!!(e&2),drag:!!(e&4),move:!!(e&8),wheel:!!(e&16)}}_equalEvents(e,t,r){if(r){if(e.x!==t.x||e.y!==t.y)return!1}else if(e.col!==t.col||e.row!==t.row)return!1;return!(e.button!==t.button||e.action!==t.action||e.ctrl!==t.ctrl||e.alt!==t.alt||e.shift!==t.shift)}};EP=Zn([ft(0,Fi),ft(1,am),ft(2,Ui)],EP);var vL=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],zYe=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],ka;function BYe(e,t){let r=0,n=t.length-1,a;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=r;)if(a=r+n>>1,e>t[a][1])r=a+1;else if(e<t[a][0])n=a-1;else return!0;return!1}var $Ye=class{constructor(){if(this.version="6",!ka){ka=new Uint8Array(65536),ka.fill(1),ka[0]=0,ka.fill(0,1,32),ka.fill(0,127,160),ka.fill(2,4352,4448),ka[9001]=2,ka[9002]=2,ka.fill(2,11904,42192),ka[12351]=1,ka.fill(2,44032,55204),ka.fill(2,63744,64256),ka.fill(2,65040,65050),ka.fill(2,65072,65136),ka.fill(2,65280,65377),ka.fill(2,65504,65511);for(let e=0;e<vL.length;++e)ka.fill(0,vL[e][0],vL[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?ka[e]:BYe(e,zYe)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,t){let r=this.wcwidth(e),n=r===0&&t!==0;if(n){let a=Zf.extractWidth(t);a===0?n=!1:a>r&&(r=a)}return Zf.createPropertyValue(0,r,n)}},Zf=class Ek{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new nt,this.onChange=this._onChange.event;let t=new $Ye;this.register(t),this._active=t.version,this._activeProvider=t}static extractShouldJoin(t){return(t&1)!==0}static extractWidth(t){return t>>1&3}static extractCharKind(t){return t>>3}static createPropertyValue(t,r,n=!1){return(t&16777215)<<3|(r&3)<<1|(n?1:0)}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(t){if(!this._providers[t])throw new Error(`unknown Unicode version "${t}"`);this._active=t,this._activeProvider=this._providers[t],this._onChange.fire(t)}register(t){this._providers[t.version]=t}wcwidth(t){return this._activeProvider.wcwidth(t)}getStringCellWidth(t){let r=0,n=0,a=t.length;for(let i=0;i<a;++i){let s=t.charCodeAt(i);if(55296<=s&&s<=56319){if(++i>=a)return r+this.wcwidth(s);let u=t.charCodeAt(i);56320<=u&&u<=57343?s=(s-55296)*1024+u-56320+65536:r+=this.wcwidth(u)}let l=this.charProperties(s,n),c=Ek.extractWidth(l);Ek.extractShouldJoin(l)&&(c-=Ek.extractWidth(n)),r+=c,n=l}return r}charProperties(t,r){return this._activeProvider.charProperties(t,r)}},FYe=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}};function qZ(e){let t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1)?.get(e.cols-1),r=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);r&&t&&(r.isWrapped=t[3]!==0&&t[3]!==32)}var Rv=2147483647,UYe=256,tme=class MP{constructor(t=32,r=32){if(this.maxLength=t,this.maxSubParamsLength=r,r>UYe)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(t),this.length=0,this._subParams=new Int32Array(r),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(t),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(t){let r=new MP;if(!t.length)return r;for(let n=Array.isArray(t[0])?1:0;n<t.length;++n){let a=t[n];if(Array.isArray(a))for(let i=0;i<a.length;++i)r.addSubParam(a[i]);else r.addParam(a)}return r}clone(){let t=new MP(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t}toArray(){let t=[];for(let r=0;r<this.length;++r){t.push(this.params[r]);let n=this._subParamsIdx[r]>>8,a=this._subParamsIdx[r]&255;a-n>0&&t.push(Array.prototype.slice.call(this._subParams,n,a))}return t}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(t){if(this._digitIsSub=!1,this.length>=this.maxLength){this._rejectDigits=!0;return}if(t<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=t>Rv?Rv:t}addSubParam(t){if(this._digitIsSub=!0,!!this.length){if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength){this._rejectSubDigits=!0;return}if(t<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=t>Rv?Rv:t,this._subParamsIdx[this.length-1]++}}hasSubParams(t){return(this._subParamsIdx[t]&255)-(this._subParamsIdx[t]>>8)>0}getSubParams(t){let r=this._subParamsIdx[t]>>8,n=this._subParamsIdx[t]&255;return n-r>0?this._subParams.subarray(r,n):null}getSubParamsAll(){let t={};for(let r=0;r<this.length;++r){let n=this._subParamsIdx[r]>>8,a=this._subParamsIdx[r]&255;a-n>0&&(t[r]=this._subParams.slice(n,a))}return t}addDigit(t){let r;if(this._rejectDigits||!(r=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let n=this._digitIsSub?this._subParams:this.params,a=n[r-1];n[r-1]=~a?Math.min(a*10+t,Rv):t}},Pv=[],HYe=class{constructor(){this._state=0,this._active=Pv,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,t){this._handlers[e]===void 0&&(this._handlers[e]=[]);let r=this._handlers[e];return r.push(t),{dispose:()=>{let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=Pv}reset(){if(this._state===2)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=Pv,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||Pv,!this._active.length)this._handlerFb(this._id,"START");else for(let e=this._active.length-1;e>=0;e--)this._active[e].start()}_put(e,t,r){if(!this._active.length)this._handlerFb(this._id,"PUT",u2(e,t,r));else for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,r)}start(){this.reset(),this._state=1}put(e,t,r){if(this._state!==3){if(this._state===1)for(;t<r;){let n=e[t++];if(n===59){this._state=2,this._start();break}if(n<48||57<n){this._state=3;return}this._id===-1&&(this._id=0),this._id=this._id*10+n-48}this._state===2&&r-t>0&&this._put(e,t,r)}}end(e,t=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),!this._active.length)this._handlerFb(this._id,"END",e);else{let r=!1,n=this._active.length-1,a=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=t,a=this._stack.fallThrough,this._stack.paused=!1),!a&&r===!1){for(;n>=0&&(r=this._active[n].end(e),r!==!0);n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if(r=this._active[n].end(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}this._active=Pv,this._id=-1,this._state=0}}},vs=class{constructor(t){this._handler=t,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(t,r,n){this._hitLimit||(this._data+=u2(t,r,n),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}end(t){let r=!1;if(this._hitLimit)r=!1;else if(t&&(r=this._handler(this._data),r instanceof Promise))return r.then(n=>(this._data="",this._hitLimit=!1,n));return this._data="",this._hitLimit=!1,r}},zv=[],qYe=class{constructor(){this._handlers=Object.create(null),this._active=zv,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=zv}registerHandler(e,t){this._handlers[e]===void 0&&(this._handlers[e]=[]);let r=this._handlers[e];return r.push(t),{dispose:()=>{let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=zv,this._ident=0}hook(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||zv,!this._active.length)this._handlerFb(this._ident,"HOOK",t);else for(let r=this._active.length-1;r>=0;r--)this._active[r].hook(t)}put(e,t,r){if(!this._active.length)this._handlerFb(this._ident,"PUT",u2(e,t,r));else for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,r)}unhook(e,t=!0){if(!this._active.length)this._handlerFb(this._ident,"UNHOOK",e);else{let r=!1,n=this._active.length-1,a=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=t,a=this._stack.fallThrough,this._stack.paused=!1),!a&&r===!1){for(;n>=0&&(r=this._active[n].unhook(e),r!==!0);n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if(r=this._active[n].unhook(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}this._active=zv,this._ident=0}},Sb=new tme;Sb.addParam(0);var WZ=class{constructor(e){this._handler=e,this._data="",this._params=Sb,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():Sb,this._data="",this._hitLimit=!1}put(e,t,r){this._hitLimit||(this._data+=u2(e,t,r),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}unhook(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data,this._params),t instanceof Promise))return t.then(r=>(this._params=Sb,this._data="",this._hitLimit=!1,r));return this._params=Sb,this._data="",this._hitLimit=!1,t}},WYe=class{constructor(e){this.table=new Uint8Array(e)}setDefault(e,t){this.table.fill(e<<4|t)}add(e,t,r,n){this.table[t<<8|e]=r<<4|n}addMany(e,t,r,n){for(let a=0;a<e.length;a++)this.table[t<<8|e[a]]=r<<4|n}},fo=160,KYe=(function(){let e=new WYe(4095),t=Array.apply(null,Array(256)).map((l,c)=>c),r=(l,c)=>t.slice(l,c),n=r(32,127),a=r(0,24);a.push(25),a.push.apply(a,r(28,32));let i=r(0,14),s;e.setDefault(1,0),e.addMany(n,0,2,0);for(s in i)e.addMany([24,26,153,154],s,3,0),e.addMany(r(128,144),s,3,0),e.addMany(r(144,152),s,3,0),e.add(156,s,0,0),e.add(27,s,11,1),e.add(157,s,4,8),e.addMany([152,158,159],s,0,7),e.add(155,s,11,3),e.add(144,s,11,9);return e.addMany(a,0,3,0),e.addMany(a,1,3,1),e.add(127,1,0,1),e.addMany(a,8,0,8),e.addMany(a,3,3,3),e.add(127,3,0,3),e.addMany(a,4,3,4),e.add(127,4,0,4),e.addMany(a,6,3,6),e.addMany(a,5,3,5),e.add(127,5,0,5),e.addMany(a,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(n,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(r(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(n,7,0,7),e.addMany(a,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(r(64,127),3,7,0),e.addMany(r(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(r(48,60),4,8,4),e.addMany(r(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(r(32,64),6,0,6),e.add(127,6,0,6),e.addMany(r(64,127),6,0,0),e.addMany(r(32,48),3,9,5),e.addMany(r(32,48),5,9,5),e.addMany(r(48,64),5,0,6),e.addMany(r(64,127),5,7,0),e.addMany(r(32,48),4,9,5),e.addMany(r(32,48),1,9,2),e.addMany(r(32,48),2,9,2),e.addMany(r(48,127),2,10,0),e.addMany(r(48,80),1,10,0),e.addMany(r(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(r(96,127),1,10,0),e.add(80,1,11,9),e.addMany(a,9,0,9),e.add(127,9,0,9),e.addMany(r(28,32),9,0,9),e.addMany(r(32,48),9,9,12),e.addMany(r(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(a,11,0,11),e.addMany(r(32,128),11,0,11),e.addMany(r(28,32),11,0,11),e.addMany(a,10,0,10),e.add(127,10,0,10),e.addMany(r(28,32),10,0,10),e.addMany(r(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(r(32,48),10,9,12),e.addMany(a,12,0,12),e.add(127,12,0,12),e.addMany(r(28,32),12,0,12),e.addMany(r(32,48),12,9,12),e.addMany(r(48,64),12,0,11),e.addMany(r(64,127),12,12,13),e.addMany(r(64,127),10,12,13),e.addMany(r(64,127),9,12,13),e.addMany(a,13,13,13),e.addMany(n,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(fo,0,2,0),e.add(fo,8,5,8),e.add(fo,6,0,6),e.add(fo,11,0,11),e.add(fo,13,13,13),e})(),GYe=class extends hr{constructor(e=KYe){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new tme,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(t,r,n)=>{},this._executeHandlerFb=t=>{},this._csiHandlerFb=(t,r)=>{},this._escHandlerFb=t=>{},this._errorHandlerFb=t=>t,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register(Mn(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this._register(new HYe),this._dcsParser=this._register(new qYe),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(e,t=[64,126]){let r=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=e.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let a=0;a<e.intermediates.length;++a){let i=e.intermediates.charCodeAt(a);if(32>i||i>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=i}}if(e.final.length!==1)throw new Error("final must be a single byte");let n=e.final.charCodeAt(0);if(t[0]>n||n>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return r<<=8,r|=n,r}identToString(e){let t=[];for(;e;)t.push(String.fromCharCode(e&255)),e>>=8;return t.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,t){let r=this._identifier(e,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);let n=this._escHandlers[r];return n.push(t),{dispose:()=>{let a=n.indexOf(t);a!==-1&&n.splice(a,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,t){this._executeHandlers[e.charCodeAt(0)]=t}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,t){let r=this._identifier(e);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);let n=this._csiHandlers[r];return n.push(t),{dispose:()=>{let a=n.indexOf(t);a!==-1&&n.splice(a,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,t){return this._oscParser.registerHandler(e,t)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,t,r,n,a){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=r,this._parseStack.transition=n,this._parseStack.chunkPos=a}parse(e,t,r){let n=0,a=0,i=0,s;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,i=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let l=this._parseStack.handlers,c=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&c>-1){for(;c>=0&&(s=l[c](this._params),s!==!0);c--)if(s instanceof Promise)return this._parseStack.handlerPos=c,s}this._parseStack.handlers=[];break;case 4:if(r===!1&&c>-1){for(;c>=0&&(s=l[c](),s!==!0);c--)if(s instanceof Promise)return this._parseStack.handlerPos=c,s}this._parseStack.handlers=[];break;case 6:if(n=e[this._parseStack.chunkPos],s=this._dcsParser.unhook(n!==24&&n!==26,r),s)return s;n===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(n=e[this._parseStack.chunkPos],s=this._oscParser.end(n!==24&&n!==26,r),s)return s;n===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break}this._parseStack.state=0,i=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=this._parseStack.transition&15}for(let l=i;l<t;++l){switch(n=e[l],a=this._transitions.table[this.currentState<<8|(n<160?n:fo)],a>>4){case 2:for(let m=l+1;;++m){if(m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}if(++m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}if(++m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}if(++m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}}break;case 3:this._executeHandlers[n]?this._executeHandlers[n]():this._executeHandlerFb(n),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:l,code:n,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let c=this._csiHandlers[this._collect<<8|n],u=c?c.length-1:-1;for(;u>=0&&(s=c[u](this._params),s!==!0);u--)if(s instanceof Promise)return this._preserveStack(3,c,u,a,l),s;u<0&&this._csiHandlerFb(this._collect<<8|n,this._params),this.precedingJoinState=0;break;case 8:do switch(n){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(n-48)}while(++l<t&&(n=e[l])>47&&n<60);l--;break;case 9:this._collect<<=8,this._collect|=n;break;case 10:let d=this._escHandlers[this._collect<<8|n],f=d?d.length-1:-1;for(;f>=0&&(s=d[f](),s!==!0);f--)if(s instanceof Promise)return this._preserveStack(4,d,f,a,l),s;f<0&&this._escHandlerFb(this._collect<<8|n),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|n,this._params);break;case 13:for(let m=l+1;;++m)if(m>=t||(n=e[m])===24||n===26||n===27||n>127&&n<fo){this._dcsParser.put(e,l,m),l=m-1;break}break;case 14:if(s=this._dcsParser.unhook(n!==24&&n!==26),s)return this._preserveStack(6,[],0,a,l),s;n===27&&(a|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let m=l+1;;m++)if(m>=t||(n=e[m])<32||n>127&&n<fo){this._oscParser.put(e,l,m),l=m-1;break}break;case 6:if(s=this._oscParser.end(n!==24&&n!==26),s)return this._preserveStack(5,[],0,a,l),s;n===27&&(a|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break}this.currentState=a&15}}},VYe=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,YYe=/^[\da-f]+$/;function KZ(e){if(!e)return;let t=e.toLowerCase();if(t.indexOf("rgb:")===0){t=t.slice(4);let r=VYe.exec(t);if(r){let n=r[1]?15:r[4]?255:r[7]?4095:65535;return[Math.round(parseInt(r[1]||r[4]||r[7]||r[10],16)/n*255),Math.round(parseInt(r[2]||r[5]||r[8]||r[11],16)/n*255),Math.round(parseInt(r[3]||r[6]||r[9]||r[12],16)/n*255)]}}else if(t.indexOf("#")===0&&(t=t.slice(1),YYe.exec(t)&&[3,6,9,12].includes(t.length))){let r=t.length/3,n=[0,0,0];for(let a=0;a<3;++a){let i=parseInt(t.slice(r*a,r*a+r),16);n[a]=r===1?i<<4:r===2?i:r===3?i>>4:i>>8}return n}}function bL(e,t){let r=e.toString(16),n=r.length<2?"0"+r:r;switch(t){case 4:return r[0];case 8:return n;case 12:return(n+n).slice(0,3);default:return n+n}}function QYe(e,t=16){let[r,n,a]=e;return`rgb:${bL(r,t)}/${bL(n,t)}/${bL(a,t)}`}var JYe={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Ju=131072,GZ=10;function VZ(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}var YZ=5e3,QZ=0,ZYe=class extends hr{constructor(e,t,r,n,a,i,s,l,c=new GYe){super(),this._bufferService=e,this._charsetService=t,this._coreService=r,this._logService=n,this._optionsService=a,this._oscLinkService=i,this._coreMouseService=s,this._unicodeService=l,this._parser=c,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new vGe,this._utf8Decoder=new bGe,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=fa.clone(),this._eraseAttrDataInternal=fa.clone(),this._onRequestBell=this._register(new nt),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new nt),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new nt),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new nt),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new nt),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new nt),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new nt),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new nt),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new nt),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new nt),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new nt),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new nt),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new nt),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new TP(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate(u=>this._activeBuffer=u.activeBuffer)),this._parser.setCsiHandlerFallback((u,d)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(u),params:d.toArray()})}),this._parser.setEscHandlerFallback(u=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(u)})}),this._parser.setExecuteHandlerFallback(u=>{this._logService.debug("Unknown EXECUTE code: ",{code:u})}),this._parser.setOscHandlerFallback((u,d,f)=>{this._logService.debug("Unknown OSC code: ",{identifier:u,action:d,data:f})}),this._parser.setDcsHandlerFallback((u,d,f)=>{d==="HOOK"&&(f=f.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(u),action:d,payload:f})}),this._parser.setPrintHandler((u,d,f)=>this.print(u,d,f)),this._parser.registerCsiHandler({final:"@"},u=>this.insertChars(u)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},u=>this.scrollLeft(u)),this._parser.registerCsiHandler({final:"A"},u=>this.cursorUp(u)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},u=>this.scrollRight(u)),this._parser.registerCsiHandler({final:"B"},u=>this.cursorDown(u)),this._parser.registerCsiHandler({final:"C"},u=>this.cursorForward(u)),this._parser.registerCsiHandler({final:"D"},u=>this.cursorBackward(u)),this._parser.registerCsiHandler({final:"E"},u=>this.cursorNextLine(u)),this._parser.registerCsiHandler({final:"F"},u=>this.cursorPrecedingLine(u)),this._parser.registerCsiHandler({final:"G"},u=>this.cursorCharAbsolute(u)),this._parser.registerCsiHandler({final:"H"},u=>this.cursorPosition(u)),this._parser.registerCsiHandler({final:"I"},u=>this.cursorForwardTab(u)),this._parser.registerCsiHandler({final:"J"},u=>this.eraseInDisplay(u,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},u=>this.eraseInDisplay(u,!0)),this._parser.registerCsiHandler({final:"K"},u=>this.eraseInLine(u,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},u=>this.eraseInLine(u,!0)),this._parser.registerCsiHandler({final:"L"},u=>this.insertLines(u)),this._parser.registerCsiHandler({final:"M"},u=>this.deleteLines(u)),this._parser.registerCsiHandler({final:"P"},u=>this.deleteChars(u)),this._parser.registerCsiHandler({final:"S"},u=>this.scrollUp(u)),this._parser.registerCsiHandler({final:"T"},u=>this.scrollDown(u)),this._parser.registerCsiHandler({final:"X"},u=>this.eraseChars(u)),this._parser.registerCsiHandler({final:"Z"},u=>this.cursorBackwardTab(u)),this._parser.registerCsiHandler({final:"`"},u=>this.charPosAbsolute(u)),this._parser.registerCsiHandler({final:"a"},u=>this.hPositionRelative(u)),this._parser.registerCsiHandler({final:"b"},u=>this.repeatPrecedingCharacter(u)),this._parser.registerCsiHandler({final:"c"},u=>this.sendDeviceAttributesPrimary(u)),this._parser.registerCsiHandler({prefix:">",final:"c"},u=>this.sendDeviceAttributesSecondary(u)),this._parser.registerCsiHandler({final:"d"},u=>this.linePosAbsolute(u)),this._parser.registerCsiHandler({final:"e"},u=>this.vPositionRelative(u)),this._parser.registerCsiHandler({final:"f"},u=>this.hVPosition(u)),this._parser.registerCsiHandler({final:"g"},u=>this.tabClear(u)),this._parser.registerCsiHandler({final:"h"},u=>this.setMode(u)),this._parser.registerCsiHandler({prefix:"?",final:"h"},u=>this.setModePrivate(u)),this._parser.registerCsiHandler({final:"l"},u=>this.resetMode(u)),this._parser.registerCsiHandler({prefix:"?",final:"l"},u=>this.resetModePrivate(u)),this._parser.registerCsiHandler({final:"m"},u=>this.charAttributes(u)),this._parser.registerCsiHandler({final:"n"},u=>this.deviceStatus(u)),this._parser.registerCsiHandler({prefix:"?",final:"n"},u=>this.deviceStatusPrivate(u)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},u=>this.softReset(u)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},u=>this.setCursorStyle(u)),this._parser.registerCsiHandler({final:"r"},u=>this.setScrollRegion(u)),this._parser.registerCsiHandler({final:"s"},u=>this.saveCursor(u)),this._parser.registerCsiHandler({final:"t"},u=>this.windowOptions(u)),this._parser.registerCsiHandler({final:"u"},u=>this.restoreCursor(u)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},u=>this.insertColumns(u)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},u=>this.deleteColumns(u)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},u=>this.selectProtected(u)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},u=>this.requestMode(u,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},u=>this.requestMode(u,!1)),this._parser.setExecuteHandler(qe.BEL,()=>this.bell()),this._parser.setExecuteHandler(qe.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(qe.BS,()=>this.backspace()),this._parser.setExecuteHandler(qe.HT,()=>this.tab()),this._parser.setExecuteHandler(qe.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(qe.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(Ck.IND,()=>this.index()),this._parser.setExecuteHandler(Ck.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(Ck.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new vs(u=>(this.setTitle(u),this.setIconName(u),!0))),this._parser.registerOscHandler(1,new vs(u=>this.setIconName(u))),this._parser.registerOscHandler(2,new vs(u=>this.setTitle(u))),this._parser.registerOscHandler(4,new vs(u=>this.setOrReportIndexedColor(u))),this._parser.registerOscHandler(8,new vs(u=>this.setHyperlink(u))),this._parser.registerOscHandler(10,new vs(u=>this.setOrReportFgColor(u))),this._parser.registerOscHandler(11,new vs(u=>this.setOrReportBgColor(u))),this._parser.registerOscHandler(12,new vs(u=>this.setOrReportCursorColor(u))),this._parser.registerOscHandler(104,new vs(u=>this.restoreIndexedColor(u))),this._parser.registerOscHandler(110,new vs(u=>this.restoreFgColor(u))),this._parser.registerOscHandler(111,new vs(u=>this.restoreBgColor(u))),this._parser.registerOscHandler(112,new vs(u=>this.restoreCursorColor(u))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let u in Ea)this._parser.registerEscHandler({intermediates:"(",final:u},()=>this.selectCharset("("+u)),this._parser.registerEscHandler({intermediates:")",final:u},()=>this.selectCharset(")"+u)),this._parser.registerEscHandler({intermediates:"*",final:u},()=>this.selectCharset("*"+u)),this._parser.registerEscHandler({intermediates:"+",final:u},()=>this.selectCharset("+"+u)),this._parser.registerEscHandler({intermediates:"-",final:u},()=>this.selectCharset("-"+u)),this._parser.registerEscHandler({intermediates:".",final:u},()=>this.selectCharset("."+u)),this._parser.registerEscHandler({intermediates:"/",final:u},()=>this.selectCharset("/"+u));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(u=>(this._logService.error("Parsing error: ",u),u)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new WZ((u,d)=>this.requestStatusString(u,d)))}getAttrData(){return this._curAttrData}_preserveStack(e,t,r,n){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=r,this._parseStack.position=n}_logSlowResolvingAsync(e){this._logService.logLevel<=3&&Promise.race([e,new Promise((t,r)=>setTimeout(()=>r("#SLOW_TIMEOUT"),YZ))]).catch(t=>{if(t!=="#SLOW_TIMEOUT")throw t;console.warn(`async parser handler taking longer than ${YZ} ms`)})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,t){let r,n=this._activeBuffer.x,a=this._activeBuffer.y,i=0,s=this._parseStack.paused;if(s){if(r=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(r),r;n=this._parseStack.cursorStartX,a=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>Ju&&(i=this._parseStack.position+Ju)}if(this._logService.logLevel<=1&&this._logService.debug(`parsing data ${typeof e=="string"?` "${e}"`:` "${Array.prototype.map.call(e,u=>String.fromCharCode(u)).join("")}"`}`),this._logService.logLevel===0&&this._logService.trace("parsing data (codes)",typeof e=="string"?e.split("").map(u=>u.charCodeAt(0)):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<Ju&&(this._parseBuffer=new Uint32Array(Math.min(e.length,Ju))),s||this._dirtyRowTracker.clearRange(),e.length>Ju)for(let u=i;u<e.length;u+=Ju){let d=u+Ju<e.length?u+Ju:e.length,f=typeof e=="string"?this._stringDecoder.decode(e.substring(u,d),this._parseBuffer):this._utf8Decoder.decode(e.subarray(u,d),this._parseBuffer);if(r=this._parser.parse(this._parseBuffer,f))return this._preserveStack(n,a,f,u),this._logSlowResolvingAsync(r),r}else if(!s){let u=typeof e=="string"?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(r=this._parser.parse(this._parseBuffer,u))return this._preserveStack(n,a,u,0),this._logSlowResolvingAsync(r),r}(this._activeBuffer.x!==n||this._activeBuffer.y!==a)&&this._onCursorMove.fire();let l=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),c=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);c<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(c,this._bufferService.rows-1),end:Math.min(l,this._bufferService.rows-1)})}print(e,t,r){let n,a,i=this._charsetService.charset,s=this._optionsService.rawOptions.screenReaderMode,l=this._bufferService.cols,c=this._coreService.decPrivateModes.wraparound,u=this._coreService.modes.insertMode,d=this._curAttrData,f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&r-t>0&&f.getWidth(this._activeBuffer.x-1)===2&&f.setCellFromCodepoint(this._activeBuffer.x-1,0,1,d);let m=this._parser.precedingJoinState;for(let p=t;p<r;++p){if(n=e[p],n<127&&i){let S=i[String.fromCharCode(n)];S&&(n=S.charCodeAt(0))}let v=this._unicodeService.charProperties(n,m);a=Zf.extractWidth(v);let b=Zf.extractShouldJoin(v),y=b?Zf.extractWidth(m):0;if(m=v,s&&this._onA11yChar.fire(ld(n)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+a-y>l){if(c){let S=f,_=this._activeBuffer.x-y;for(this._activeBuffer.x=y,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),y>0&&f instanceof xb&&f.copyCellsFrom(S,_,0,y,!1);_<l;)S.setCellFromCodepoint(_++,0,1,d)}else if(this._activeBuffer.x=l-1,a===2)continue}if(b&&this._activeBuffer.x){let S=f.getWidth(this._activeBuffer.x-1)?1:2;f.addCodepointToCell(this._activeBuffer.x-S,n,a);for(let _=a-y;--_>=0;)f.setCellFromCodepoint(this._activeBuffer.x++,0,0,d);continue}if(u&&(f.insertCells(this._activeBuffer.x,a-y,this._activeBuffer.getNullCell(d)),f.getWidth(l-1)===2&&f.setCellFromCodepoint(l-1,0,1,d)),f.setCellFromCodepoint(this._activeBuffer.x++,n,a,d),a>0)for(;--a;)f.setCellFromCodepoint(this._activeBuffer.x++,0,0,d)}this._parser.precedingJoinState=m,this._activeBuffer.x<l&&r-t>0&&f.getWidth(this._activeBuffer.x)===0&&!f.hasContent(this._activeBuffer.x)&&f.setCellFromCodepoint(this._activeBuffer.x,0,1,d),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,t){return e.final==="t"&&!e.prefix&&!e.intermediates?this._parser.registerCsiHandler(e,r=>VZ(r.params[0],this._optionsService.rawOptions.windowOptions)?t(r):!0):this._parser.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._parser.registerDcsHandler(e,new WZ(t))}registerEscHandler(e,t){return this._parser.registerEscHandler(e,t)}registerOscHandler(e,t){return this._parser.registerOscHandler(e,new vs(t))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}cursorUp(e){let t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){let t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){let t=e.params[0];return t===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:t===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){let t=e.params[0];return t===1&&(this._curAttrData.bg|=536870912),(t===2||t===0)&&(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,t,r,n=!1,a=!1){let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.replaceCells(t,r,this._activeBuffer.getNullCell(this._eraseAttrData()),a),n&&(i.isWrapped=!1)}_resetBufferLine(e,t=!1){let r=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);r&&(r.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),r.isWrapped=!1)}eraseInDisplay(e,t=!1){this._restrictCursor(this._bufferService.cols);let r;switch(e.params[0]){case 0:for(r=this._activeBuffer.y,this._dirtyRowTracker.markDirty(r),this._eraseInBufferLine(r++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,t);r<this._bufferService.rows;r++)this._resetBufferLine(r,t);this._dirtyRowTracker.markDirty(r);break;case 1:for(r=this._activeBuffer.y,this._dirtyRowTracker.markDirty(r),this._eraseInBufferLine(r,0,this._activeBuffer.x+1,!0,t),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(r+1).isWrapped=!1);r--;)this._resetBufferLine(r,t);this._dirtyRowTracker.markDirty(0);break;case 2:if(this._optionsService.rawOptions.scrollOnEraseInDisplay){for(r=this._bufferService.rows,this._dirtyRowTracker.markRangeDirty(0,r-1);r--&&!this._activeBuffer.lines.get(this._activeBuffer.ybase+r)?.getTrimmedLength(););for(;r>=0;r--)this._bufferService.scroll(this._eraseAttrData())}else{for(r=this._bufferService.rows,this._dirtyRowTracker.markDirty(r-1);r--;)this._resetBufferLine(r,t);this._dirtyRowTracker.markDirty(0)}break;case 3:let n=this._activeBuffer.lines.length-this._bufferService.rows;n>0&&(this._activeBuffer.lines.trimStart(n),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-n,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-n,0),this._onScroll.fire(0));break}return!0}eraseInLine(e,t=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t);break}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let r=this._activeBuffer.ybase+this._activeBuffer.y,n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,a=this._bufferService.rows-1+this._activeBuffer.ybase-n+1;for(;t--;)this._activeBuffer.lines.splice(a-1,1),this._activeBuffer.lines.splice(r,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let r=this._activeBuffer.ybase+this._activeBuffer.y,n;for(n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-n;t--;)this._activeBuffer.lines.splice(r,1),this._activeBuffer.lines.splice(n,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(fa));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){let t=this._parser.precedingJoinState;if(!t)return!0;let r=e.params[0]||1,n=Zf.extractWidth(t),a=this._activeBuffer.x-n,i=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(a),s=new Uint32Array(i.length*r),l=0;for(let u=0;u<i.length;){let d=i.codePointAt(u)||0;s[l++]=d,u+=d>65535?2:1}let c=l;for(let u=1;u<r;++u)s.copyWithin(c,0,l),c+=l;return this.print(s,0,c),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(qe.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(qe.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(qe.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(qe.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(qe.ESC+"[>83;40003;0c")),!0}_is(e){return(this._optionsService.rawOptions.termName+"").indexOf(e)===0}setMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0;break}return!0}setModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,Bf),this._charsetService.setgCharset(1,Bf),this._charsetService.setgCharset(2,Bf),this._charsetService.setgCharset(3,Bf);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!0;break}return!0}resetMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1;break}return!0}resetModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),e.params[t]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!1,this._onRequestRefreshRows.fire(void 0);break}return!0}requestMode(e,t){(b=>(b[b.NOT_RECOGNIZED=0]="NOT_RECOGNIZED",b[b.SET=1]="SET",b[b.RESET=2]="RESET",b[b.PERMANENTLY_SET=3]="PERMANENTLY_SET",b[b.PERMANENTLY_RESET=4]="PERMANENTLY_RESET"))(void 0||(r={}));let n=this._coreService.decPrivateModes,{activeProtocol:a,activeEncoding:i}=this._coreMouseService,s=this._coreService,{buffers:l,cols:c}=this._bufferService,{active:u,alt:d}=l,f=this._optionsService.rawOptions,m=(b,y)=>(s.triggerDataEvent(`${qe.ESC}[${t?"":"?"}${b};${y}$y`),!0),p=b=>b?1:2,v=e.params[0];return t?v===2?m(v,4):v===4?m(v,p(s.modes.insertMode)):v===12?m(v,3):v===20?m(v,p(f.convertEol)):m(v,0):v===1?m(v,p(n.applicationCursorKeys)):v===3?m(v,f.windowOptions.setWinLines?c===80?2:c===132?1:0:0):v===6?m(v,p(n.origin)):v===7?m(v,p(n.wraparound)):v===8?m(v,3):v===9?m(v,p(a==="X10")):v===12?m(v,p(f.cursorBlink)):v===25?m(v,p(!s.isCursorHidden)):v===45?m(v,p(n.reverseWraparound)):v===66?m(v,p(n.applicationKeypad)):v===67?m(v,4):v===1e3?m(v,p(a==="VT200")):v===1002?m(v,p(a==="DRAG")):v===1003?m(v,p(a==="ANY")):v===1004?m(v,p(n.sendFocus)):v===1005?m(v,4):v===1006?m(v,p(i==="SGR")):v===1015?m(v,4):v===1016?m(v,p(i==="SGR_PIXELS")):v===1048?m(v,1):v===47||v===1047||v===1049?m(v,p(u===d)):v===2004?m(v,p(n.bracketedPasteMode)):v===2026?m(v,p(n.synchronizedOutput)):m(v,0)}_updateAttrColor(e,t,r,n,a){return t===2?(e|=50331648,e&=-16777216,e|=o1.fromColorRGB([r,n,a])):t===5&&(e&=-50331904,e|=33554432|r&255),e}_extractColor(e,t,r){let n=[0,0,-1,0,0,0],a=0,i=0;do{if(n[i+a]=e.params[t+i],e.hasSubParams(t+i)){let s=e.getSubParams(t+i),l=0;do n[1]===5&&(a=1),n[i+l+1+a]=s[l];while(++l<s.length&&l+i+1+a<n.length);break}if(n[1]===5&&i+a>=2||n[1]===2&&i+a>=5)break;n[1]&&(a=1)}while(++i+t<e.length&&i+a<n.length);for(let s=2;s<n.length;++s)n[s]===-1&&(n[s]=0);switch(n[0]){case 38:r.fg=this._updateAttrColor(r.fg,n[1],n[3],n[4],n[5]);break;case 48:r.bg=this._updateAttrColor(r.bg,n[1],n[3],n[4],n[5]);break;case 58:r.extended=r.extended.clone(),r.extended.underlineColor=this._updateAttrColor(r.extended.underlineColor,n[1],n[3],n[4],n[5])}return i}_processUnderline(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,e===0&&(t.fg&=-268435457),t.updateExtended()}_processSGR0(e){e.fg=fa.fg,e.bg=fa.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(e.length===1&&e.params[0]===0)return this._processSGR0(this._curAttrData),!0;let t=e.length,r,n=this._curAttrData;for(let a=0;a<t;a++)r=e.params[a],r>=30&&r<=37?(n.fg&=-50331904,n.fg|=16777216|r-30):r>=40&&r<=47?(n.bg&=-50331904,n.bg|=16777216|r-40):r>=90&&r<=97?(n.fg&=-50331904,n.fg|=16777216|r-90|8):r>=100&&r<=107?(n.bg&=-50331904,n.bg|=16777216|r-100|8):r===0?this._processSGR0(n):r===1?n.fg|=134217728:r===3?n.bg|=67108864:r===4?(n.fg|=268435456,this._processUnderline(e.hasSubParams(a)?e.getSubParams(a)[0]:1,n)):r===5?n.fg|=536870912:r===7?n.fg|=67108864:r===8?n.fg|=1073741824:r===9?n.fg|=2147483648:r===2?n.bg|=134217728:r===21?this._processUnderline(2,n):r===22?(n.fg&=-134217729,n.bg&=-134217729):r===23?n.bg&=-67108865:r===24?(n.fg&=-268435457,this._processUnderline(0,n)):r===25?n.fg&=-536870913:r===27?n.fg&=-67108865:r===28?n.fg&=-1073741825:r===29?n.fg&=2147483647:r===39?(n.fg&=-67108864,n.fg|=fa.fg&16777215):r===49?(n.bg&=-67108864,n.bg|=fa.bg&16777215):r===38||r===48||r===58?a+=this._extractColor(e,a,n):r===53?n.bg|=1073741824:r===55?n.bg&=-1073741825:r===59?(n.extended=n.extended.clone(),n.extended.underlineColor=-1,n.updateExtended()):r===100?(n.fg&=-67108864,n.fg|=fa.fg&16777215,n.bg&=-67108864,n.bg|=fa.bg&16777215):this._logService.debug("Unknown SGR attribute: %d.",r);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${qe.ESC}[0n`);break;case 6:let t=this._activeBuffer.y+1,r=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${qe.ESC}[${t};${r}R`);break}return!0}deviceStatusPrivate(e){switch(e.params[0]){case 6:let t=this._activeBuffer.y+1,r=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${qe.ESC}[?${t};${r}R`);break}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=fa.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){let t=e.length===0?1:e.params[0];if(t===0)this._coreService.decPrivateModes.cursorStyle=void 0,this._coreService.decPrivateModes.cursorBlink=void 0;else{switch(t){case 1:case 2:this._coreService.decPrivateModes.cursorStyle="block";break;case 3:case 4:this._coreService.decPrivateModes.cursorStyle="underline";break;case 5:case 6:this._coreService.decPrivateModes.cursorStyle="bar";break}let r=t%2===1;this._coreService.decPrivateModes.cursorBlink=r}return!0}setScrollRegion(e){let t=e.params[0]||1,r;return(e.length<2||(r=e.params[1])>this._bufferService.rows||r===0)&&(r=this._bufferService.rows),r>t&&(this._activeBuffer.scrollTop=t-1,this._activeBuffer.scrollBottom=r-1,this._setCursor(0,0)),!0}windowOptions(e){if(!VZ(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;let t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:t!==2&&this._onRequestWindowsOptionsReport.fire(0);break;case 16:this._onRequestWindowsOptionsReport.fire(1);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${qe.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:(t===0||t===2)&&(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>GZ&&this._windowTitleStack.shift()),(t===0||t===1)&&(this._iconNameStack.push(this._iconName),this._iconNameStack.length>GZ&&this._iconNameStack.shift());break;case 23:(t===0||t===2)&&this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),(t===0||t===1)&&this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop());break}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){let t=[],r=e.split(";");for(;r.length>1;){let n=r.shift(),a=r.shift();if(/^\d+$/.exec(n)){let i=parseInt(n);if(JZ(i))if(a==="?")t.push({type:0,index:i});else{let s=KZ(a);s&&t.push({type:1,index:i,color:s})}}}return t.length&&this._onColor.fire(t),!0}setHyperlink(e){let t=e.indexOf(";");if(t===-1)return!0;let r=e.slice(0,t).trim(),n=e.slice(t+1);return n?this._createHyperlink(r,n):r.trim()?!1:this._finishHyperlink()}_createHyperlink(e,t){this._getCurrentLinkId()&&this._finishHyperlink();let r=e.split(":"),n,a=r.findIndex(i=>i.startsWith("id="));return a!==-1&&(n=r[a].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:n,uri:t}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,t){let r=e.split(";");for(let n=0;n<r.length&&!(t>=this._specialColors.length);++n,++t)if(r[n]==="?")this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{let a=KZ(r[n]);a&&this._onColor.fire([{type:1,index:this._specialColors[t],color:a}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;let t=[],r=e.split(";");for(let n=0;n<r.length;++n)if(/^\d+$/.exec(r[n])){let a=parseInt(r[n]);JZ(a)&&t.push({type:2,index:a})}return t.length&&this._onColor.fire(t),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,Bf),!0}selectCharset(e){return e.length!==2?(this.selectDefaultCharset(),!0):(e[0]==="/"||this._charsetService.setgCharset(JYe[e[0]],Ea[e[1]]||Bf),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=fa.clone(),this._eraseAttrDataInternal=fa.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=this._curAttrData.bg&67108863,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){let e=new So;e.content=1<<22|69,e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let t=0;t<this._bufferService.rows;++t){let r=this._activeBuffer.ybase+this._activeBuffer.y+t,n=this._activeBuffer.lines.get(r);n&&(n.fill(e),n.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,t){let r=s=>(this._coreService.triggerDataEvent(`${qe.ESC}${s}${qe.ESC}\\`),!0),n=this._bufferService.buffer,a=this._optionsService.rawOptions;return r(e==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:e==='"p'?'P1$r61;1"p':e==="r"?`P1$r${n.scrollTop+1};${n.scrollBottom+1}r`:e==="m"?"P1$r0m":e===" q"?`P1$r${{block:2,underline:4,bar:6}[a.cursorStyle]-(a.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}},TP=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,t){e>t&&(QZ=e,e=t,t=QZ),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};TP=Zn([ft(0,Fi)],TP);function JZ(e){return 0<=e&&e<256}var XYe=5e7,ZZ=12,eQe=50,tQe=class extends hr{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new nt),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,t){if(t!==void 0&&this._syncCalls>t){this._syncCalls=0;return}if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;this._isSyncWriting=!0;let r;for(;r=this._writeBuffer.shift();){this._action(r);let n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,t){if(this._pendingData>XYe)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput){this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),this._innerWrite();return}setTimeout(()=>this._innerWrite())}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}_innerWrite(e=0,t=!0){let r=e||performance.now();for(;this._writeBuffer.length>this._bufferOffset;){let n=this._writeBuffer[this._bufferOffset],a=this._action(n,t);if(a){let s=l=>performance.now()-r>=ZZ?setTimeout(()=>this._innerWrite(0,l)):this._innerWrite(r,l);a.catch(l=>(queueMicrotask(()=>{throw l}),Promise.resolve(!1))).then(s);return}let i=this._callbacks[this._bufferOffset];if(i&&i(),this._bufferOffset++,this._pendingData-=n.length,performance.now()-r>=ZZ)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>eQe&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}},AP=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){let t=this._bufferService.buffer;if(e.id===void 0){let l=t.addMarker(t.ybase+t.y),c={data:e,id:this._nextId++,lines:[l]};return l.onDispose(()=>this._removeMarkerFromLink(c,l)),this._dataByLinkId.set(c.id,c),c.id}let r=e,n=this._getEntryIdKey(r),a=this._entriesWithId.get(n);if(a)return this.addLineToLink(a.id,t.ybase+t.y),a.id;let i=t.addMarker(t.ybase+t.y),s={id:this._nextId++,key:this._getEntryIdKey(r),data:r,lines:[i]};return i.onDispose(()=>this._removeMarkerFromLink(s,i)),this._entriesWithId.set(s.key,s),this._dataByLinkId.set(s.id,s),s.id}addLineToLink(e,t){let r=this._dataByLinkId.get(e);if(r&&r.lines.every(n=>n.line!==t)){let n=this._bufferService.buffer.addMarker(t);r.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(r,n))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,t){let r=e.lines.indexOf(t);r!==-1&&(e.lines.splice(r,1),e.lines.length===0&&(e.data.id!==void 0&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};AP=Zn([ft(0,Fi)],AP);var XZ=!1,rQe=class extends hr{constructor(e){super(),this._windowsWrappingHeuristics=this._register(new Lg),this._onBinary=this._register(new nt),this.onBinary=this._onBinary.event,this._onData=this._register(new nt),this.onData=this._onData.event,this._onLineFeed=this._register(new nt),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new nt),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new nt),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new nt),this._instantiationService=new CYe,this.optionsService=this._register(new RYe(e)),this._instantiationService.setService(Ui,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(CP)),this._instantiationService.setService(Fi,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(NP)),this._instantiationService.setService(xhe,this._logService),this.coreService=this._register(this._instantiationService.createInstance(jP)),this._instantiationService.setService(am,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(EP)),this._instantiationService.setService(yhe,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(Zf)),this._instantiationService.setService(SGe,this.unicodeService),this._charsetService=this._instantiationService.createInstance(FYe),this._instantiationService.setService(wGe,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(AP),this._instantiationService.setService(whe,this._oscLinkService),this._inputHandler=this._register(new ZYe(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(ii.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(ii.forward(this._bufferService.onResize,this._onResize)),this._register(ii.forward(this.coreService.onData,this._onData)),this._register(ii.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom(!0))),this._register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this._register(this._bufferService.onScroll(()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this._register(new tQe((t,r)=>this._inputHandler.parse(t,r))),this._register(ii.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new nt),this._onScroll.event(e=>{this._onScrollApi?.fire(e.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(let t in e)this.optionsService.options[t]=e[t]}write(e,t){this._writeBuffer.write(e,t)}writeSync(e,t){this._logService.logLevel<=3&&!XZ&&(this._logService.warn("writeSync is unreliable and will be removed soon."),XZ=!0),this._writeBuffer.writeSync(e,t)}input(e,t=!0){this.coreService.triggerDataEvent(e,t)}resize(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,Xhe),t=Math.max(t,eme),this._bufferService.resize(e,t))}scroll(e,t=!1){this._bufferService.scroll(e,t)}scrollLines(e,t){this._bufferService.scrollLines(e,t)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let t=e-this._bufferService.buffer.ydisp;t!==0&&this.scrollLines(t)}registerEscHandler(e,t){return this._inputHandler.registerEscHandler(e,t)}registerDcsHandler(e,t){return this._inputHandler.registerDcsHandler(e,t)}registerCsiHandler(e,t){return this._inputHandler.registerCsiHandler(e,t)}registerOscHandler(e,t){return this._inputHandler.registerOscHandler(e,t)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let e=!1,t=this.optionsService.rawOptions.windowsPty;t&&t.buildNumber!==void 0&&t.buildNumber!==void 0?e=t.backend==="conpty"&&t.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let e=[];e.push(this.onLineFeed(qZ.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},()=>(qZ(this._bufferService),!1))),this._windowsWrappingHeuristics.value=Mn(()=>{for(let t of e)t.dispose()})}}},nQe={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function aQe(e,t,r,n){let a={type:0,cancel:!1,key:void 0},i=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:e.key==="UIKeyInputUpArrow"?t?a.key=qe.ESC+"OA":a.key=qe.ESC+"[A":e.key==="UIKeyInputLeftArrow"?t?a.key=qe.ESC+"OD":a.key=qe.ESC+"[D":e.key==="UIKeyInputRightArrow"?t?a.key=qe.ESC+"OC":a.key=qe.ESC+"[C":e.key==="UIKeyInputDownArrow"&&(t?a.key=qe.ESC+"OB":a.key=qe.ESC+"[B");break;case 8:a.key=e.ctrlKey?"\b":qe.DEL,e.altKey&&(a.key=qe.ESC+a.key);break;case 9:if(e.shiftKey){a.key=qe.ESC+"[Z";break}a.key=qe.HT,a.cancel=!0;break;case 13:a.key=e.altKey?qe.ESC+qe.CR:qe.CR,a.cancel=!0;break;case 27:a.key=qe.ESC,e.altKey&&(a.key=qe.ESC+qe.ESC),a.cancel=!0;break;case 37:if(e.metaKey)break;i?a.key=qe.ESC+"[1;"+(i+1)+"D":t?a.key=qe.ESC+"OD":a.key=qe.ESC+"[D";break;case 39:if(e.metaKey)break;i?a.key=qe.ESC+"[1;"+(i+1)+"C":t?a.key=qe.ESC+"OC":a.key=qe.ESC+"[C";break;case 38:if(e.metaKey)break;i?a.key=qe.ESC+"[1;"+(i+1)+"A":t?a.key=qe.ESC+"OA":a.key=qe.ESC+"[A";break;case 40:if(e.metaKey)break;i?a.key=qe.ESC+"[1;"+(i+1)+"B":t?a.key=qe.ESC+"OB":a.key=qe.ESC+"[B";break;case 45:!e.shiftKey&&!e.ctrlKey&&(a.key=qe.ESC+"[2~");break;case 46:i?a.key=qe.ESC+"[3;"+(i+1)+"~":a.key=qe.ESC+"[3~";break;case 36:i?a.key=qe.ESC+"[1;"+(i+1)+"H":t?a.key=qe.ESC+"OH":a.key=qe.ESC+"[H";break;case 35:i?a.key=qe.ESC+"[1;"+(i+1)+"F":t?a.key=qe.ESC+"OF":a.key=qe.ESC+"[F";break;case 33:e.shiftKey?a.type=2:e.ctrlKey?a.key=qe.ESC+"[5;"+(i+1)+"~":a.key=qe.ESC+"[5~";break;case 34:e.shiftKey?a.type=3:e.ctrlKey?a.key=qe.ESC+"[6;"+(i+1)+"~":a.key=qe.ESC+"[6~";break;case 112:i?a.key=qe.ESC+"[1;"+(i+1)+"P":a.key=qe.ESC+"OP";break;case 113:i?a.key=qe.ESC+"[1;"+(i+1)+"Q":a.key=qe.ESC+"OQ";break;case 114:i?a.key=qe.ESC+"[1;"+(i+1)+"R":a.key=qe.ESC+"OR";break;case 115:i?a.key=qe.ESC+"[1;"+(i+1)+"S":a.key=qe.ESC+"OS";break;case 116:i?a.key=qe.ESC+"[15;"+(i+1)+"~":a.key=qe.ESC+"[15~";break;case 117:i?a.key=qe.ESC+"[17;"+(i+1)+"~":a.key=qe.ESC+"[17~";break;case 118:i?a.key=qe.ESC+"[18;"+(i+1)+"~":a.key=qe.ESC+"[18~";break;case 119:i?a.key=qe.ESC+"[19;"+(i+1)+"~":a.key=qe.ESC+"[19~";break;case 120:i?a.key=qe.ESC+"[20;"+(i+1)+"~":a.key=qe.ESC+"[20~";break;case 121:i?a.key=qe.ESC+"[21;"+(i+1)+"~":a.key=qe.ESC+"[21~";break;case 122:i?a.key=qe.ESC+"[23;"+(i+1)+"~":a.key=qe.ESC+"[23~";break;case 123:i?a.key=qe.ESC+"[24;"+(i+1)+"~":a.key=qe.ESC+"[24~";break;default:if(e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey)e.keyCode>=65&&e.keyCode<=90?a.key=String.fromCharCode(e.keyCode-64):e.keyCode===32?a.key=qe.NUL:e.keyCode>=51&&e.keyCode<=55?a.key=String.fromCharCode(e.keyCode-51+27):e.keyCode===56?a.key=qe.DEL:e.keyCode===219?a.key=qe.ESC:e.keyCode===220?a.key=qe.FS:e.keyCode===221&&(a.key=qe.GS);else if((!r||n)&&e.altKey&&!e.metaKey){let s=nQe[e.keyCode]?.[e.shiftKey?1:0];if(s)a.key=qe.ESC+s;else if(e.keyCode>=65&&e.keyCode<=90){let l=e.ctrlKey?e.keyCode-64:e.keyCode+32,c=String.fromCharCode(l);e.shiftKey&&(c=c.toUpperCase()),a.key=qe.ESC+c}else if(e.keyCode===32)a.key=qe.ESC+(e.ctrlKey?qe.NUL:" ");else if(e.key==="Dead"&&e.code.startsWith("Key")){let l=e.code.slice(3,4);e.shiftKey||(l=l.toLowerCase()),a.key=qe.ESC+l,a.cancel=!0}}else r&&!e.altKey&&!e.ctrlKey&&!e.shiftKey&&e.metaKey?e.keyCode===65&&(a.type=1):e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&e.key.length===1?a.key=e.key:e.key&&e.ctrlKey&&(e.key==="_"&&(a.key=qe.US),e.key==="@"&&(a.key=qe.NUL));break}return a}var ta=0,iQe=class{constructor(e){this._getKey=e,this._array=[],this._insertedValues=[],this._flushInsertedTask=new iC,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new iC,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(e){this._flushCleanupDeleted(),this._insertedValues.length===0&&this._flushInsertedTask.enqueue(()=>this._flushInserted()),this._insertedValues.push(e)}_flushInserted(){let e=this._insertedValues.sort((a,i)=>this._getKey(a)-this._getKey(i)),t=0,r=0,n=new Array(this._array.length+this._insertedValues.length);for(let a=0;a<n.length;a++)r>=this._array.length||this._getKey(e[t])<=this._getKey(this._array[r])?(n[a]=e[t],t++):n[a]=this._array[r++];this._array=n,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(e){if(this._flushCleanupInserted(),this._array.length===0)return!1;let t=this._getKey(e);if(t===void 0||(ta=this._search(t),ta===-1)||this._getKey(this._array[ta])!==t)return!1;do if(this._array[ta]===e)return this._deletedIndices.length===0&&this._flushDeletedTask.enqueue(()=>this._flushDeleted()),this._deletedIndices.push(ta),!0;while(++ta<this._array.length&&this._getKey(this._array[ta])===t);return!1}_flushDeleted(){this._isFlushingDeleted=!0;let e=this._deletedIndices.sort((a,i)=>a-i),t=0,r=new Array(this._array.length-e.length),n=0;for(let a=0;a<this._array.length;a++)e[t]===a?t++:r[n++]=this._array[a];this._array=r,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(e){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(ta=this._search(e),!(ta<0||ta>=this._array.length)&&this._getKey(this._array[ta])===e))do yield this._array[ta];while(++ta<this._array.length&&this._getKey(this._array[ta])===e)}forEachByKey(e,t){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(ta=this._search(e),!(ta<0||ta>=this._array.length)&&this._getKey(this._array[ta])===e))do t(this._array[ta]);while(++ta<this._array.length&&this._getKey(this._array[ta])===e)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(e){let t=0,r=this._array.length-1;for(;r>=t;){let n=t+r>>1,a=this._getKey(this._array[n]);if(a>e)r=n-1;else if(a<e)t=n+1;else{for(;n>0&&this._getKey(this._array[n-1])===e;)n--;return n}}return t}},yL=0,eX=0,sQe=class extends hr{constructor(){super(),this._decorations=new iQe(e=>e?.marker.line),this._onDecorationRegistered=this._register(new nt),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new nt),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register(Mn(()=>this.reset()))}get decorations(){return this._decorations.values()}registerDecoration(e){if(e.marker.isDisposed)return;let t=new oQe(e);if(t){let r=t.marker.onDispose(()=>t.dispose()),n=t.onDispose(()=>{n.dispose(),t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),r.dispose())});this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(let e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,t,r){let n=0,a=0;for(let i of this._decorations.getKeyIterator(t))n=i.options.x??0,a=n+(i.options.width??1),e>=n&&e<a&&(!r||(i.options.layer??"bottom")===r)&&(yield i)}forEachDecorationAtCell(e,t,r,n){this._decorations.forEachByKey(t,a=>{yL=a.options.x??0,eX=yL+(a.options.width??1),e>=yL&&e<eX&&(!r||(a.options.layer??"bottom")===r)&&n(a)})}},oQe=class extends Td{constructor(e){super(),this.options=e,this.onRenderEmitter=this.add(new nt),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new nt),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=zn.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=zn.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}},lQe=1e3,cQe=class{constructor(e,t=lQe){this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,t,r){this._rowCount=r,e=e!==void 0?e:0,t=t!==void 0?t:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,t):t;let n=performance.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){let a=n-this._lastRefreshMs,i=this._debounceThresholdMS-a;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=performance.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},i)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}},tX=20,sC=class extends hr{constructor(t,r,n,a){super(),this._terminal=t,this._coreBrowserService=n,this._renderService=a,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";let i=this._coreBrowserService.mainDocument;this._accessibilityContainer=i.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=i.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let s=0;s<this._terminal.rows;s++)this._rowElements[s]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[s]);if(this._topBoundaryFocusListener=s=>this._handleBoundaryFocus(s,0),this._bottomBoundaryFocusListener=s=>this._handleBoundaryFocus(s,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=i.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new cQe(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize(s=>this._handleResize(s.rows))),this._register(this._terminal.onRender(s=>this._refreshRows(s.start,s.end))),this._register(this._terminal.onScroll(()=>this._refreshRows())),this._register(this._terminal.onA11yChar(s=>this._handleChar(s))),this._register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this._register(this._terminal.onA11yTab(s=>this._handleTab(s))),this._register(this._terminal.onKey(s=>this._handleKey(s.key))),this._register(this._terminal.onBlur(()=>this._clearLiveRegion())),this._register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._register(Qt(i,"selectionchange",()=>this._handleSelectionChange())),this._register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRowsDimensions(),this._refreshRows(),this._register(Mn(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(t){for(let r=0;r<t;r++)this._handleChar(" ")}_handleChar(t){this._liveRegionLineCount<tX+1&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==t&&(this._charsToAnnounce+=t):this._charsToAnnounce+=t,t===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===tX+1&&(this._liveRegion.textContent+=JR.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(t){this._clearLiveRegion(),/\p{Control}/u.test(t)||this._charsToConsume.push(t)}_refreshRows(t,r){this._liveRegionDebouncer.refresh(t,r,this._terminal.rows)}_renderRows(t,r){let n=this._terminal.buffer,a=n.lines.length.toString();for(let i=t;i<=r;i++){let s=n.lines.get(n.ydisp+i),l=[],c=s?.translateToString(!0,void 0,void 0,l)||"",u=(n.ydisp+i+1).toString(),d=this._rowElements[i];d&&(c.length===0?(d.textContent="",this._rowColumns.set(d,[0,1])):(d.textContent=c,this._rowColumns.set(d,l)),d.setAttribute("aria-posinset",u),d.setAttribute("aria-setsize",a),this._alignRowWidth(d))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(t,r){let n=t.target,a=this._rowElements[r===0?1:this._rowElements.length-2],i=n.getAttribute("aria-posinset"),s=r===0?"1":`${this._terminal.buffer.lines.length}`;if(i===s||t.relatedTarget!==a)return;let l,c;if(r===0?(l=n,c=this._rowElements.pop(),this._rowContainer.removeChild(c)):(l=this._rowElements.shift(),c=n,this._rowContainer.removeChild(l)),l.removeEventListener("focus",this._topBoundaryFocusListener),c.removeEventListener("focus",this._bottomBoundaryFocusListener),r===0){let u=this._createAccessibilityTreeNode();this._rowElements.unshift(u),this._rowContainer.insertAdjacentElement("afterbegin",u)}else{let u=this._createAccessibilityTreeNode();this._rowElements.push(u),this._rowContainer.appendChild(u)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(r===0?-1:1),this._rowElements[r===0?1:this._rowElements.length-2].focus(),t.preventDefault(),t.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let t=this._coreBrowserService.mainDocument.getSelection();if(!t)return;if(t.isCollapsed){this._rowContainer.contains(t.anchorNode)&&this._terminal.clearSelection();return}if(!t.anchorNode||!t.focusNode){console.error("anchorNode and/or focusNode are null");return}let r={node:t.anchorNode,offset:t.anchorOffset},n={node:t.focusNode,offset:t.focusOffset};if((r.node.compareDocumentPosition(n.node)&Node.DOCUMENT_POSITION_PRECEDING||r.node===n.node&&r.offset>n.offset)&&([r,n]=[n,r]),r.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(r={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(r.node))return;let a=this._rowElements.slice(-1)[0];if(n.node.compareDocumentPosition(a)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(n={node:a,offset:a.textContent?.length??0}),!this._rowContainer.contains(n.node))return;let i=({node:c,offset:u})=>{let d=c instanceof Text?c.parentNode:c,f=parseInt(d?.getAttribute("aria-posinset"),10)-1;if(isNaN(f))return console.warn("row is invalid. Race condition?"),null;let m=this._rowColumns.get(d);if(!m)return console.warn("columns is null. Race condition?"),null;let p=u<m.length?m[u]:m.slice(-1)[0]+1;return p>=this._terminal.cols&&(++f,p=0),{row:f,column:p}},s=i(r),l=i(n);if(!(!s||!l)){if(s.row>l.row||s.row===l.row&&s.column>=l.column)throw new Error("invalid range");this._terminal.select(s.column,s.row,(l.row-s.row)*this._terminal.cols-s.column+l.column)}}_handleResize(t){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let r=this._rowContainer.children.length;r<this._terminal.rows;r++)this._rowElements[r]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[r]);for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let t=this._coreBrowserService.mainDocument.createElement("div");return t.setAttribute("role","listitem"),t.tabIndex=-1,this._refreshRowDimensions(t),t}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let t=0;t<this._terminal.rows;t++)this._refreshRowDimensions(this._rowElements[t]),this._alignRowWidth(this._rowElements[t])}}_refreshRowDimensions(t){t.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(t){t.style.transform="";let r=t.getBoundingClientRect().width,n=this._rowColumns.get(t)?.slice(-1)?.[0];if(!n)return;let a=n*this._renderService.dimensions.css.cell.width;t.style.transform=`scaleX(${a/r})`}};sC=Zn([ft(1,uB),ft(2,vu),ft(3,bu)],sC);var DP=class extends hr{constructor(e,t,r,n,a){super(),this._element=e,this._mouseService=t,this._renderService=r,this._bufferService=n,this._linkProviderService=a,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new nt),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new nt),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register(Mn(()=>{Dh(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this._register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this._register(Qt(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this._register(Qt(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register(Qt(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register(Qt(this._element,"mouseup",this._handleMouseUp.bind(this)))}get currentLink(){return this._currentLink}_handleMouseMove(e){this._lastMouseEvent=e;let t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;let r=e.composedPath();for(let n=0;n<r.length;n++){let a=r[n];if(a.classList.contains("xterm"))break;if(a.classList.contains("xterm-hover"))return}(!this._lastBufferCell||t.x!==this._lastBufferCell.x||t.y!==this._lastBufferCell.y)&&(this._handleHover(t),this._lastBufferCell=t)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized){this._clearCurrentLink(),this._askForLink(e,!1),this._wasResized=!1;return}this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,t){(!this._activeProviderReplies||!t)&&(this._activeProviderReplies?.forEach(n=>{n?.forEach(a=>{a.link.dispose&&a.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let r=!1;for(let[n,a]of this._linkProviderService.linkProviders.entries())t?this._activeProviderReplies?.get(n)&&(r=this._checkLinkProviderResult(n,e,r)):a.provideLinks(e.y,i=>{if(this._isMouseOut)return;let s=i?.map(l=>({link:l}));this._activeProviderReplies?.set(n,s),r=this._checkLinkProviderResult(n,e,r),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,t){let r=new Set;for(let n=0;n<t.size;n++){let a=t.get(n);if(a)for(let i=0;i<a.length;i++){let s=a[i],l=s.link.range.start.y<e?0:s.link.range.start.x,c=s.link.range.end.y>e?this._bufferService.cols:s.link.range.end.x;for(let u=l;u<=c;u++){if(r.has(u)){a.splice(i--,1);break}r.add(u)}}}}_checkLinkProviderResult(e,t,r){if(!this._activeProviderReplies)return r;let n=this._activeProviderReplies.get(e),a=!1;for(let i=0;i<e;i++)(!this._activeProviderReplies.has(i)||this._activeProviderReplies.get(i))&&(a=!0);if(!a&&n){let i=n.find(s=>this._linkAtPosition(s.link,t));i&&(r=!0,this._handleNewLink(i))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!r)for(let i=0;i<this._activeProviderReplies.size;i++){let s=this._activeProviderReplies.get(i)?.find(l=>this._linkAtPosition(l.link,t));if(s){r=!0,this._handleNewLink(s);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._currentLink)return;let t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink&&uQe(this._mouseDownLink.link,this._currentLink.link)&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,t){!this._currentLink||!this._lastMouseEvent||(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,Dh(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(e){if(!this._lastMouseEvent)return;let t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(e.link,t)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0?!0:e.link.decorations.underline,pointerCursor:e.link.decorations===void 0?!0:e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:r=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",r))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:r=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,r))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(r=>{if(!this._currentLink)return;let n=r.start===0?0:r.start+1+this._bufferService.buffer.ydisp,a=this._bufferService.buffer.ydisp+1+r.end;if(this._currentLink.link.range.start.y>=n&&this._currentLink.link.range.end.y<=a&&(this._clearCurrentLink(n,a),this._lastMouseEvent)){let i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._askForLink(i,!1)}})))}_linkHover(e,t,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(r,t.text)}_fireUnderlineEvent(e,t){let r=e.range,n=this._bufferService.buffer.ydisp,a=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-n-1,r.end.x,r.end.y-n-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(a)}_linkLeave(e,t,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(r,t.text)}_linkAtPosition(e,t){let r=e.range.start.y*this._bufferService.cols+e.range.start.x,n=e.range.end.y*this._bufferService.cols+e.range.end.x,a=t.y*this._bufferService.cols+t.x;return r<=a&&a<=n}_positionFromMouseEvent(e,t,r){let n=r.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(n)return{x:n[0],y:n[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,t,r,n,a){return{x1:e,y1:t,x2:r,y2:n,cols:this._bufferService.cols,fg:a}}};DP=Zn([ft(1,dB),ft(2,bu),ft(3,Fi),ft(4,khe)],DP);function uQe(e,t){return e.text===t.text&&e.range.start.x===t.range.start.x&&e.range.start.y===t.range.start.y&&e.range.end.x===t.range.end.x&&e.range.end.y===t.range.end.y}var dQe=class extends rQe{constructor(e={}){super(e),this._linkifier=this._register(new Lg),this.browser=Uhe,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new Lg),this._onCursorMove=this._register(new nt),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new nt),this.onKey=this._onKey.event,this._onRender=this._register(new nt),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new nt),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new nt),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new nt),this.onBell=this._onBell.event,this._onFocus=this._register(new nt),this._onBlur=this._register(new nt),this._onA11yCharEmitter=this._register(new nt),this._onA11yTabEmitter=this._register(new nt),this._onWillOpen=this._register(new nt),this._setup(),this._decorationService=this._instantiationService.createInstance(sQe),this._instantiationService.setService(l1,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(eYe),this._instantiationService.setService(khe,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(XR)),this._register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this._register(this._inputHandler.onRequestRefreshRows(t=>this.refresh(t?.start??0,t?.end??this.rows-1))),this._register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this._register(this._inputHandler.onRequestReset(()=>this.reset())),this._register(this._inputHandler.onRequestWindowsOptionsReport(t=>this._reportWindowsOptions(t))),this._register(this._inputHandler.onColor(t=>this._handleColorEvent(t))),this._register(ii.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(ii.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(ii.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(ii.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize(t=>this._afterResize(t.cols,t.rows))),this._register(Mn(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(e){if(this._themeService)for(let t of e){let r,n="";switch(t.index){case 256:r="foreground",n="10";break;case 257:r="background",n="11";break;case 258:r="cursor",n="12";break;default:r="ansi",n="4;"+t.index}switch(t.type){case 0:let a=kn.toColorRGB(r==="ansi"?this._themeService.colors.ansi[t.index]:this._themeService.colors[r]);this.coreService.triggerDataEvent(`${qe.ESC}]${n};${QYe(a)}${$he.ST}`);break;case 1:if(r==="ansi")this._themeService.modifyColors(i=>i.ansi[t.index]=ha.toColor(...t.color));else{let i=r;this._themeService.modifyColors(s=>s[i]=ha.toColor(...t.color))}break;case 2:this._themeService.restoreColor(t.index);break}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(sC,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(qe.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(qe.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(!t)return;let r=Math.min(this.buffer.x,this.cols-1),n=this._renderService.dimensions.css.cell.height,a=t.getWidth(r),i=this._renderService.dimensions.css.cell.width*a,s=this.buffer.y*this._renderService.dimensions.css.cell.height,l=r*this._renderService.dimensions.css.cell.width;this.textarea.style.left=l+"px",this.textarea.style.top=s+"px",this.textarea.style.width=i+"px",this.textarea.style.height=n+"px",this.textarea.style.lineHeight=n+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register(Qt(this.element,"copy",t=>{this.hasSelection()&&pGe(t,this._selectionService)}));let e=t=>gGe(t,this.textarea,this.coreService,this.optionsService);this._register(Qt(this.textarea,"paste",e)),this._register(Qt(this.element,"paste",e)),Hhe?this._register(Qt(this.element,"mousedown",t=>{t.button===2&&dZ(t,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this._register(Qt(this.element,"contextmenu",t=>{dZ(t,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),yB&&this._register(Qt(this.element,"auxclick",t=>{t.button===1&&mhe(t,this.textarea,this.screenElement)}))}_bindKeys(){this._register(Qt(this.textarea,"keyup",e=>this._keyUp(e),!0)),this._register(Qt(this.textarea,"keydown",e=>this._keyDown(e),!0)),this._register(Qt(this.textarea,"keypress",e=>this._keyPress(e),!0)),this._register(Qt(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this._register(Qt(this.textarea,"compositionupdate",e=>this._compositionHelper.compositionupdate(e))),this._register(Qt(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this._register(Qt(this.textarea,"input",e=>this._inputEvent(e),!0)),this._register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(e){if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService){this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);return}this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);let t=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),t.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register(Qt(this.screenElement,"mousemove",a=>this.updateCursorStyle(a))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),t.appendChild(this.screenElement);let r=this.textarea=this._document.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",QR.get()),Khe||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._register(this.optionsService.onSpecificOptionChange("disableStdin",()=>r.readOnly=this.optionsService.rawOptions.disableStdin)),this.textarea.readOnly=this.optionsService.rawOptions.disableStdin,this._coreBrowserService=this._register(this._instantiationService.createInstance(ZVe,this.textarea,e.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(vu,this._coreBrowserService),this._register(Qt(this.textarea,"focus",a=>this._handleTextAreaFocus(a))),this._register(Qt(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(xP,this._document,this._helperContainer),this._instantiationService.setService(d2,this._charSizeService),this._themeService=this._instantiationService.createInstance(_P),this._instantiationService.setService(m0,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(nC),this._instantiationService.setService(She,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(SP,this.rows,this.screenElement)),this._instantiationService.setService(bu,this._renderService),this._register(this._renderService.onRenderedViewportChange(a=>this._onRender.fire(a))),this.onResize(a=>this._renderService.resize(a.cols,a.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(vP,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(wP),this._instantiationService.setService(dB,this._mouseService);let n=this._linkifier.value=this._register(this._instantiationService.createInstance(DP,this.screenElement));this.element.appendChild(t);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this._register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this._register(this.onBlur(()=>this._renderService.handleBlur())),this._register(this.onFocus(()=>this._renderService.handleFocus())),this._viewport=this._register(this._instantiationService.createInstance(pP,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines(a=>{super.scrollLines(a,!1),this.refresh(0,this.rows-1)})),this._selectionService=this._register(this._instantiationService.createInstance(kP,this.element,this.screenElement,n)),this._instantiationService.setService(_Ge,this._selectionService),this._register(this._selectionService.onRequestScrollLines(a=>this.scrollLines(a.amount,a.suppressScrollEvent))),this._register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this._register(this._selectionService.onRequestRedraw(a=>this._renderService.handleSelectionChanged(a.start,a.end,a.columnSelectMode))),this._register(this._selectionService.onLinuxMouseSelection(a=>{this.textarea.value=a,this.textarea.focus(),this.textarea.select()})),this._register(ii.any(this._onScroll.event,this._inputHandler.onScroll)(()=>{this._selectionService.refresh(),this._viewport?.queueSync()})),this._register(this._instantiationService.createInstance(gP,this.screenElement)),this._register(Qt(this.element,"mousedown",a=>this._selectionService.handleMouseDown(a))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(sC,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",a=>this._handleScreenReaderModeOptionChange(a))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(rC,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",a=>{!this._overviewRulerRenderer&&a&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(rC,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(yP,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let e=this,t=this.element;function r(i){let s=e._mouseService.getMouseReportCoords(i,e.screenElement);if(!s)return!1;let l,c;switch(i.overrideType||i.type){case"mousemove":c=32,i.buttons===void 0?(l=3,i.button!==void 0&&(l=i.button<3?i.button:3)):l=i.buttons&1?0:i.buttons&4?1:i.buttons&2?2:3;break;case"mouseup":c=0,l=i.button<3?i.button:3;break;case"mousedown":c=1,l=i.button<3?i.button:3;break;case"wheel":if(e._customWheelEventHandler&&e._customWheelEventHandler(i)===!1)return!1;let u=i.deltaY;if(u===0||e.coreMouseService.consumeWheelEvent(i,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return!1;c=u<0?0:1,l=4;break;default:return!1}return c===void 0||l===void 0||l>4?!1:e.coreMouseService.triggerMouseEvent({col:s.col,row:s.row,x:s.x,y:s.y,button:l,action:c,ctrl:i.ctrlKey,alt:i.altKey,shift:i.shiftKey})}let n={mouseup:null,wheel:null,mousedrag:null,mousemove:null},a={mouseup:i=>(r(i),i.buttons||(this._document.removeEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.removeEventListener("mousemove",n.mousedrag)),this.cancel(i)),wheel:i=>(r(i),this.cancel(i,!0)),mousedrag:i=>{i.buttons&&r(i)},mousemove:i=>{i.buttons||r(i)}};this._register(this.coreMouseService.onProtocolChange(i=>{i?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(i)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),i&8?n.mousemove||(t.addEventListener("mousemove",a.mousemove),n.mousemove=a.mousemove):(t.removeEventListener("mousemove",n.mousemove),n.mousemove=null),i&16?n.wheel||(t.addEventListener("wheel",a.wheel,{passive:!1}),n.wheel=a.wheel):(t.removeEventListener("wheel",n.wheel),n.wheel=null),i&2?n.mouseup||(n.mouseup=a.mouseup):(this._document.removeEventListener("mouseup",n.mouseup),n.mouseup=null),i&4?n.mousedrag||(n.mousedrag=a.mousedrag):(this._document.removeEventListener("mousemove",n.mousedrag),n.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register(Qt(t,"mousedown",i=>{if(i.preventDefault(),this.focus(),!(!this.coreMouseService.areMouseEventsActive||this._selectionService.shouldForceSelection(i)))return r(i),n.mouseup&&this._document.addEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.addEventListener("mousemove",n.mousedrag),this.cancel(i)})),this._register(Qt(t,"wheel",i=>{if(!n.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(i)===!1)return!1;if(!this.buffer.hasScrollback){if(i.deltaY===0)return!1;if(e.coreMouseService.consumeWheelEvent(i,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return this.cancel(i,!0);let s=qe.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(i.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(s,!0),this.cancel(i,!0)}}},{passive:!1}))}refresh(e,t){this._renderService?.refreshRows(e,t)}updateCursorStyle(e){this._selectionService?.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,t){this._viewport?this._viewport.scrollLines(e):super.scrollLines(e,t),this.refresh(0,this.rows-1)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){e&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let t=e-this._bufferService.buffer.ydisp;t!==0&&this.scrollLines(t)}paste(e){hhe(e,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}attachCustomWheelEventHandler(e){this._customWheelEventHandler=e}registerLinkProvider(e){return this._linkProviderService.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return this._selectionService?this._selectionService.hasSelection:!1}select(e,t,r){this._selectionService.setSelection(e,t,r)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(!(!this._selectionService||!this._selectionService.hasSelection))return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(e,t){this._selectionService?.selectLines(e,t)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;let t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;!t&&(e.key==="Dead"||e.key==="AltGraph")&&(this._unprocessedDeadKey=!0);let r=aQe(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),r.type===3||r.type===2){let n=this.rows-1;return this.scrollLines(r.type===2?-n:n),this.cancel(e,!0)}if(r.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,e)||(r.cancel&&this.cancel(e,!0),!r.key)||e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.key.length===1&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)return!0;if(this._unprocessedDeadKey)return this._unprocessedDeadKey=!1,!0;if((r.key===qe.ETX||r.key===qe.CR)&&(this.textarea.value=""),this._onKey.fire({key:r.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(r.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey)return this.cancel(e,!0);this._keyDownHandled=!0}_isThirdLevelShift(e,t){let r=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return t.type==="keypress"?r:r&&(!t.keyCode||t.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,!(this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)&&(fQe(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let t;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(e.which===null||e.which===void 0)t=e.keyCode;else if(e.which!==0&&e.charCode!==0)t=e.which;else return!1;return!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)?!1:(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,!0)}_inputEvent(e){if(e.data&&e.inputType==="insertText"&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}resize(e,t){if(e===this.cols&&t===this.rows){this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure();return}super.resize(e,t)}_afterResize(e,t){this._charSizeService?.measure()}clear(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(fa));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let e=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=e,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(qe.ESC+"[I"):this.coreService.triggerDataEvent(qe.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case 0:let t=this._renderService.dimensions.css.canvas.width.toFixed(0),r=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${qe.ESC}[4;${r};${t}t`);break;case 1:let n=this._renderService.dimensions.css.cell.width.toFixed(0),a=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${qe.ESC}[6;${a};${n}t`);break}}cancel(e,t){if(!(!this.options.cancelEvents&&!t))return e.preventDefault(),e.stopPropagation(),!1}};function fQe(e){return e.keyCode===16||e.keyCode===17||e.keyCode===18}var hQe=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,t){let r={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(r),t.dispose=()=>this._wrappedAddonDispose(r),t.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let t=-1;for(let r=0;r<this._addons.length;r++)if(this._addons[r]===e){t=r;break}if(t===-1)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},mQe=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new So)}translateToString(e,t,r){return this._line.translateToString(e,t,r)}},rX=class{constructor(e,t){this._buffer=e,this.type=t}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){let t=this._buffer.lines.get(e);if(t)return new mQe(t)}getNullCell(){return new So}},pQe=class extends hr{constructor(e){super(),this._core=e,this._onBufferChange=this._register(new nt),this.onBufferChange=this._onBufferChange.event,this._normal=new rX(this._core.buffers.normal,"normal"),this._alternate=new rX(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}},gQe=class{constructor(e){this._core=e}registerCsiHandler(e,t){return this._core.registerCsiHandler(e,r=>t(r.toArray()))}addCsiHandler(e,t){return this.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._core.registerDcsHandler(e,(r,n)=>t(r,n.toArray()))}addDcsHandler(e,t){return this.registerDcsHandler(e,t)}registerEscHandler(e,t){return this._core.registerEscHandler(e,t)}addEscHandler(e,t){return this.registerEscHandler(e,t)}registerOscHandler(e,t){return this._core.registerOscHandler(e,t)}addOscHandler(e,t){return this.registerOscHandler(e,t)}},vQe=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}},bQe=["cols","rows"],dl=0,yQe=class extends hr{constructor(e){super(),this._core=this._register(new dQe(e)),this._addonManager=this._register(new hQe),this._publicOptions={...this._core.options};let t=n=>this._core.options[n],r=(n,a)=>{this._checkReadonlyOptions(n),this._core.options[n]=a};for(let n in this._core.options){let a={get:t.bind(this,n),set:r.bind(this,n)};Object.defineProperty(this._publicOptions,n,a)}}_checkReadonlyOptions(e){if(bQe.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new gQe(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new vQe(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new pQe(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any";break}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,synchronizedOutputMode:e.synchronizedOutput,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(let t in e)this._publicOptions[t]=e[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(e,t=!0){this._core.input(e,t)}resize(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}attachCustomWheelEventHandler(e){this._core.attachCustomWheelEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.registerMarker(e)}registerDecoration(e){return this._checkProposedApi(),this._verifyPositiveIntegers(e.x??0,e.width??0,e.height??0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,t,r){this._verifyIntegers(e,t,r),this._core.select(e,t,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}dispose(){super.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,t){this._core.write(e,t)}writeln(e,t){this._core.write(e),this._core.write(`\r
`,t)}paste(e){this._core.paste(e)}refresh(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){this._addonManager.loadAddon(this,e)}static get strings(){return{get promptLabel(){return QR.get()},set promptLabel(e){QR.set(e)},get tooMuchOutput(){return JR.get()},set tooMuchOutput(e){JR.set(e)}}}_verifyIntegers(...e){for(dl of e)if(dl===1/0||isNaN(dl)||dl%1!==0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(dl of e)if(dl&&(dl===1/0||isNaN(dl)||dl%1!==0||dl<0))throw new Error("This API only accepts positive integers")}};/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var xQe=2,wQe=1,SQe=class{activate(e){this._terminal=e}dispose(){}fit(){let e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;let t=this._terminal._core;(this._terminal.rows!==e.rows||this._terminal.cols!==e.cols)&&(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let e=this._terminal._core._renderService.dimensions;if(e.css.cell.width===0||e.css.cell.height===0)return;let t=this._terminal.options.scrollback===0?0:this._terminal.options.overviewRuler?.width||14,r=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(r.getPropertyValue("height")),a=Math.max(0,parseInt(r.getPropertyValue("width"))),i=window.getComputedStyle(this._terminal.element),s={top:parseInt(i.getPropertyValue("padding-top")),bottom:parseInt(i.getPropertyValue("padding-bottom")),right:parseInt(i.getPropertyValue("padding-right")),left:parseInt(i.getPropertyValue("padding-left"))},l=s.top+s.bottom,c=s.right+s.left,u=n-l,d=a-c-t;return{cols:Math.max(xQe,Math.floor(d/e.css.cell.width)),rows:Math.max(wQe,Math.floor(u/e.css.cell.height))}}};/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var kQe=class{constructor(e,t,r,n={}){this._terminal=e,this._regex=t,this._handler=r,this._options=n}provideLinks(e,t){let r=NQe.computeLink(e,this._regex,this._terminal,this._handler);t(this._addCallbacks(r))}_addCallbacks(e){return e.map(t=>(t.leave=this._options.leave,t.hover=(r,n)=>{if(this._options.hover){let{range:a}=t;this._options.hover(r,n,a)}},t))}};function _Qe(e){try{let t=new URL(e),r=t.password&&t.username?`${t.protocol}//${t.username}:${t.password}@${t.host}`:t.username?`${t.protocol}//${t.username}@${t.host}`:`${t.protocol}//${t.host}`;return e.toLocaleLowerCase().startsWith(r.toLocaleLowerCase())}catch{return!1}}var NQe=class Mk{static computeLink(t,r,n,a){let i=new RegExp(r.source,(r.flags||"")+"g"),[s,l]=Mk._getWindowedLineStrings(t-1,n),c=s.join(""),u,d=[];for(;u=i.exec(c);){let f=u[0];if(!_Qe(f))continue;let[m,p]=Mk._mapStrIdx(n,l,0,u.index),[v,b]=Mk._mapStrIdx(n,m,p,f.length);if(m===-1||p===-1||v===-1||b===-1)continue;let y={start:{x:p+1,y:m+1},end:{x:b,y:v+1}};d.push({range:y,text:f,activate:a})}return d}static _getWindowedLineStrings(t,r){let n,a=t,i=t,s=0,l="",c=[];if(n=r.buffer.active.getLine(t)){let u=n.translateToString(!0);if(n.isWrapped&&u[0]!==" "){for(s=0;(n=r.buffer.active.getLine(--a))&&s<2048&&(l=n.translateToString(!0),s+=l.length,c.push(l),!(!n.isWrapped||l.indexOf(" ")!==-1)););c.reverse()}for(c.push(u),s=0;(n=r.buffer.active.getLine(++i))&&n.isWrapped&&s<2048&&(l=n.translateToString(!0),s+=l.length,c.push(l),l.indexOf(" ")===-1););}return[c,a]}static _mapStrIdx(t,r,n,a){let i=t.buffer.active,s=i.getNullCell(),l=n;for(;a;){let c=i.getLine(r);if(!c)return[-1,-1];for(let u=l;u<c.length;++u){c.getCell(u,s);let d=s.getChars();if(s.getWidth()&&(a-=d.length||1,u===c.length-1&&d==="")){let f=i.getLine(r+1);f&&f.isWrapped&&(f.getCell(0,s),s.getWidth()===2&&(a+=1))}if(a<0)return[r,u]}r++,l=0}return[r,l]}},CQe=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function jQe(e,t){let r=window.open();if(r){try{r.opener=null}catch{}r.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}var EQe=class{constructor(e=jQe,t={}){this._handler=e,this._options=t}activate(e){this._terminal=e;let t=this._options,r=t.urlRegex||CQe;this._linkProvider=this._terminal.registerLinkProvider(new kQe(this._terminal,r,this._handler,t))}dispose(){this._linkProvider?.dispose()}};const MQe={background:"#1a1a1a",foreground:"#e0e0e0",cursor:"#e0e0e0",cursorAccent:"#1a1a1a",selectionBackground:"#404040",selectionForeground:"#ffffff",black:"#1a1a1a",red:"#ff5555",green:"#50fa7b",yellow:"#f1fa8c",blue:"#6272a4",magenta:"#ff79c6",cyan:"#8be9fd",white:"#e0e0e0",brightBlack:"#555555",brightRed:"#ff6e6e",brightGreen:"#69ff94",brightYellow:"#ffffa5",brightBlue:"#d6acff",brightMagenta:"#ff92df",brightCyan:"#a4ffff",brightWhite:"#ffffff"},TQe={background:"#ffffff",foreground:"#333333",cursor:"#333333",cursorAccent:"#ffffff",selectionBackground:"#add6ff",selectionForeground:"#000000",black:"#000000",red:"#cd3131",green:"#00bc00",yellow:"#949800",blue:"#0451a5",magenta:"#bc05bc",cyan:"#0598bc",white:"#555555",brightBlack:"#666666",brightRed:"#cd3131",brightGreen:"#14ce14",brightYellow:"#b5ba00",brightBlue:"#0451a5",brightMagenta:"#bc05bc",brightCyan:"#0598bc",brightWhite:"#a5a5a5"},AQe=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`,DQe=window.location.origin,xB=w.forwardRef(function({agentId:t,wsUrl:r=AQe,apiUrl:n=DQe,onStatusChange:a,onConnected:i,onData:s,theme:l="dark",fontSize:c=13,fontFamily:u='"JetBrains Mono", "Fira Code", Consolas, "Liberation Mono", Menlo, Courier, monospace',autoFit:d=!0,interactive:f=!0,autoFocus:m=!1,controlsResize:p=!0,enableFileDrop:v,"data-testid":b="xterminal"},y){const S=w.useRef(null),_=w.useRef(null),N=w.useRef(null),k=w.useRef(null),[j,E]=w.useState("disconnected"),[T,O]=w.useState(!1),[R,q]=w.useState(!1),$=w.useRef(0),L=5,A=w.useRef(null),M=w.useRef(!1),z=w.useRef(null),I=w.useRef(!1),B=v??f,F=w.useRef(a),U=w.useRef(i);w.useEffect(()=>{F.current=a,U.current=i},[a,i]);const V=w.useCallback(re=>{E(re),F.current?.(re)},[]),K=w.useCallback(re=>{k.current?.readyState===WebSocket.OPEN&&k.current.send(JSON.stringify({type:"input",input:re}))},[]);w.useEffect(()=>{if(!S.current||_.current)return;const re=new yQe({theme:l==="dark"?MQe:TQe,fontSize:c,fontFamily:u,cursorBlink:!0,cursorStyle:"block",scrollback:1e4,allowProposedApi:!0,convertEol:!0,disableStdin:!f}),ne=new SQe,pe=new EQe;return re.loadAddon(ne),re.loadAddon(pe),re.open(S.current),d&&ne.fit(),f&&re.onData(ke=>{K(ke),s?.(ke)}),_.current=re,N.current=ne,m&&f&&setTimeout(()=>re.focus(),100),()=>{re.dispose(),_.current=null,N.current=null}},[l,c,u,d,f,m,K,s]),w.useEffect(()=>{if(!d||!S.current||!N.current)return;let re=null;const ne=()=>{if(p&&k.current?.readyState===WebSocket.OPEN&&N.current){const we=N.current.proposeDimensions();if(we){const ve=z.current;if(ve&&ve.cols===we.cols&&ve.rows===we.rows)return;z.current={cols:we.cols,rows:we.rows},k.current.send(JSON.stringify({type:"resize",cols:we.cols,rows:we.rows}))}}},pe=()=>{try{N.current?.fit(),re&&clearTimeout(re),re=setTimeout(ne,150)}catch{}},ke=new ResizeObserver(pe);return ke.observe(S.current),()=>{ke.disconnect(),re&&clearTimeout(re)}},[d,p]),w.useEffect(()=>{if(!t){V("disconnected");return}M.current=!1,A.current=null,z.current=null,I.current=!1;let re=!1;const ne=()=>{V("connecting");const we=new WebSocket(r);k.current=we,we.onopen=()=>{$.current=0,we.send(JSON.stringify({type:"subscribe",agentId:t}))},we.onmessage=ve=>{try{const Le=JSON.parse(ve.data);switch(Le.type){case"subscribed":if(V("connected"),U.current?.(),M.current=!0,p&&Le.hasSession&&N.current&&_.current){const Ae=N.current.proposeDimensions();Ae&&k.current?.readyState===WebSocket.OPEN&&(z.current={cols:Ae.cols,rows:Ae.rows},k.current.send(JSON.stringify({type:"resize",cols:Ae.cols,rows:Ae.rows})))}break;case"pty-data":Le.data&&_.current?.write(Le.data);break;case"event":Le.event&&pe(Le.event);break;case"error":_.current?.writeln(`\x1B[31m  Error: ${Le.error}\x1B[0m`);break;case"exit":_.current?.writeln("\x1B[90m  Session ended\x1B[0m"),A.current=null;break;case"pong":break;case"session-started":{const Ae=Le.sessionId;if(Ae&&Ae===A.current)break;if(A.current=Ae??null,z.current=null,_.current?.clear(),p&&Le.isInteractive&&N.current&&_.current){const Re=N.current.proposeDimensions();Re&&k.current?.readyState===WebSocket.OPEN&&(z.current={cols:Re.cols,rows:Re.rows},k.current.send(JSON.stringify({type:"resize",cols:Re.cols,rows:Re.rows})))}break}}}catch(Le){console.error("[XTerminal] Error parsing message:",Le)}},we.onerror=()=>{V("error"),_.current?.writeln("\x1B[31m  WebSocket error\x1B[0m")},we.onclose=()=>{if(I.current){I.current=!1;return}if(!re)if($.current<L){$.current++;const ve=Math.min(1e3*Math.pow(2,$.current),3e4);_.current?.writeln(`\x1B[33m  Reconnecting in ${ve/1e3}s (attempt ${$.current}/${L})...\x1B[0m`),setTimeout(()=>{re||ne()},ve)}else V("error"),_.current?.writeln("\x1B[31m  Connection lost. Max reconnect attempts reached.\x1B[0m")}},pe=we=>{const ve=_.current;if(ve)switch(we.type){case"assistant":we.content&&ve.write(we.content);break;case"tool_use":ve.writeln(`\x1B[36m[Tool: ${we.data?.name??"unknown"}]\x1B[0m`);break;case"tool_result":we.output&&ve.writeln(`\x1B[90m${we.output}\x1B[0m`);break;case"system":we.content&&ve.writeln(`\x1B[33m[System] ${we.content}\x1B[0m`);break;case"error":ve.writeln(`\x1B[31m[Error] ${we.content??"Unknown error"}\x1B[0m`);break}};ne();const ke=setInterval(()=>{k.current?.readyState===WebSocket.OPEN&&k.current.send(JSON.stringify({type:"ping"}))},3e4);return()=>{re=!0,clearInterval(ke),k.current&&(I.current=!0,k.current.close(),k.current=null)}},[t,r,V]);const G=w.useCallback(re=>{_.current?.write(re)},[]),J=w.useCallback(re=>{_.current?.writeln(re)},[]),ee=w.useCallback(()=>{_.current?.clear()},[]),Y=w.useCallback(()=>{_.current?.focus()},[]),ie=w.useCallback(()=>{N.current?.fit()},[]),fe=w.useCallback(()=>{if(!N.current||!_.current)return;const re=_.current;re.clearTextureAtlas();const ne=N.current.proposeDimensions();if(!ne)return;const pe=ne.cols,ke=ne.rows;if(p&&k.current?.readyState===WebSocket.OPEN){const we=Math.max(1,pe-2),ve=Math.max(1,ke-1);re.resize(we,ve),k.current.send(JSON.stringify({type:"resize",cols:we,rows:ve}))}setTimeout(()=>{if(!_.current||!N.current)return;if(N.current.fit(),p&&k.current?.readyState===WebSocket.OPEN){const ve=N.current.proposeDimensions();ve&&(z.current={cols:ve.cols,rows:ve.rows},k.current.send(JSON.stringify({type:"resize",cols:ve.cols,rows:ve.rows})))}const we=_.current.rows;_.current.refresh(0,we-1)},100)},[p]),me=w.useCallback(re=>{K(re)},[K]),te=w.useCallback(()=>{if(!N.current)return null;const re=N.current.proposeDimensions();return re?{cols:re.cols,rows:re.rows}:null},[]);w.useImperativeHandle(y,()=>({refresh:fe,write:G,writeln:J,clear:ee,focus:Y,fit:ie,sendInput:me,getDimensions:te}),[fe,G,J,ee,Y,ie,me,te]),w.useEffect(()=>(window.__xterminal={write:G,writeln:J,clear:ee,focus:Y,fit:ie,sendInput:me,getStatus:()=>j},()=>{delete window.__xterminal}),[G,J,ee,Y,ie,me,j]);const oe=w.useCallback(()=>{f&&_.current?.focus()},[f]),ce=w.useCallback(async re=>{try{const ne=await re.arrayBuffer(),pe=btoa(new Uint8Array(ne).reduce((ve,Le)=>ve+String.fromCharCode(Le),"")),ke=await fetch(`${n}/api/terminal/upload`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:re.name,data:pe})});if(!ke.ok){const ve=await ke.json().catch(()=>({}));throw new Error(ve.error?.message||`Upload failed: ${ke.status}`)}return(await ke.json()).path}catch(ne){return console.error("[XTerminal] File upload failed:",ne),_.current?.writeln(`\x1B[31m  File upload failed: ${ne instanceof Error?ne.message:"Unknown error"}\x1B[0m`),null}},[n]),Z=w.useCallback(re=>{const ne=Array.from(re.dataTransfer.types);return ne.includes("application/x-workspace-pane")?!1:ne.includes("Files")&&!ne.includes("text/plain")},[]),ue=w.useCallback(async re=>{if(!Z(re)||(re.preventDefault(),re.stopPropagation(),O(!1),!B||!f))return;const ne=Array.from(re.dataTransfer.files);if(ne.length===0)return;q(!0),_.current?.writeln(`\x1B[90m  Uploading ${ne.length} file(s)...\x1B[0m`);const pe=[];for(const ke of ne){const we=await ce(ke);we&&pe.push(we)}if(q(!1),pe.length>0){const ke=pe.join(" ")+" ";K(ke),_.current?.writeln(`\x1B[32m  ${pe.length} file(s) uploaded and path(s) inserted\x1B[0m`)}},[B,f,ce,K,Z]),H=w.useCallback(re=>{if(!Z(re)){re.preventDefault();return}re.preventDefault(),re.stopPropagation(),B&&f&&O(!0)},[B,f,Z]),ge=w.useCallback(re=>{if(!Z(re)){re.preventDefault();return}re.preventDefault(),re.stopPropagation(),B&&f&&O(!0)},[B,f,Z]),de=w.useCallback(re=>{if(!Z(re))return;re.preventDefault(),re.stopPropagation();const ne=S.current?.getBoundingClientRect();if(ne){const{clientX:pe,clientY:ke}=re;(pe<ne.left||pe>=ne.right||ke<ne.top||ke>=ne.bottom)&&O(!1)}},[Z]);return o.jsxs("div",{ref:S,"data-testid":b,"data-status":j,"data-drag-over":T,className:"relative w-full h-full overflow-hidden cursor-text",style:{minHeight:"200px"},onClick:oe,onDrop:ue,onDragOver:H,onDragEnter:ge,onDragLeave:de,children:[T&&B&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-primary)]/20 border-2 border-dashed border-[var(--color-primary)] rounded-lg pointer-events-none","data-testid":"file-drop-overlay",children:o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 rounded-lg bg-[var(--color-bg)]/90 shadow-lg",children:[o.jsx("svg",{className:"w-10 h-10 text-[var(--color-primary)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Drop files to upload"}),o.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"File paths will be inserted at cursor"})]})}),R&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-bg)]/50 pointer-events-none","data-testid":"upload-progress-overlay",children:o.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-[var(--color-bg)] shadow-lg border border-[var(--color-border)]",children:[o.jsxs("svg",{className:"w-5 h-5 text-[var(--color-primary)] animate-spin",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Uploading..."})]})})]})}),LQe="/api";async function ui(e,t){const r=await fetch(`${LQe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function d1(e){return gt({queryKey:["agents",e],queryFn:()=>ui(e?`/agents?role=${e}`:"/agents")})}function wB(){return gt({queryKey:["providers"],queryFn:()=>ui("/providers"),staleTime:6e4})}function SB(e){return gt({queryKey:["provider-models",e],queryFn:()=>ui(`/providers/${e}/models`),enabled:!!e,staleTime:6e4})}function rme(e){return gt({queryKey:["agent",e],queryFn:()=>ui(`/agents/${e}`),enabled:!!e})}function kB(e){return gt({queryKey:["agent-status",e],queryFn:()=>ui(`/agents/${e}/status`),enabled:!!e,refetchInterval:5e3})}function m2(e){const t=new URLSearchParams;e?.agentId&&t.set("agentId",e.agentId),e?.role&&t.set("role",e.role),e?.status&&t.set("status",e.status);const r=t.toString(),n=r?`/sessions?${r}`:"/sessions";return gt({queryKey:["sessions",e],queryFn:()=>ui(n),refetchInterval:1e4})}async function nme(e){return ui(`/sessions/${e}/messages`)}function g0(){const{data:e,isLoading:t,error:r,refetch:n}=d1();return{...w.useMemo(()=>{const i=e?.agents??[],s=i.find(f=>f.metadata?.agent?.agentRole==="director"),l=i.filter(f=>f.metadata?.agent?.agentRole==="worker"),c=i.filter(f=>f.metadata?.agent?.agentRole==="steward"),u=l.filter(f=>{const m=f.metadata?.agent;return m?.agentRole==="worker"&&m?.workerMode==="ephemeral"}),d=l.filter(f=>{const m=f.metadata?.agent;return m?.agentRole==="worker"&&m?.workerMode==="persistent"});return{director:s,workers:l,ephemeralWorkers:u,persistentWorkers:d,stewards:c,allAgents:i}},[e?.agents]),isLoading:t,error:r,refetch:n}}function ame(){const{director:e,isLoading:t,error:r,refetch:n}=g0(),{data:a,isLoading:i,error:s}=kB(e?.id),l=w.useMemo(()=>(a?.recentHistory??[]).find(d=>!!d.providerSessionId)??null,[a?.recentHistory]),c=l!==null;return{director:e,hasActiveSession:a?.hasActiveSession??!1,activeSession:a?.activeSession??null,recentHistory:a?.recentHistory??[],lastResumableSession:l,hasResumableSession:c,isLoading:t||i,error:r||s,refetch:n}}function OQe(){const e=ht();return Ct({mutationFn:async t=>ui("/agents",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["agents"]})}})}function p2(){const e=ht();return Ct({mutationFn:async({agentId:t,taskId:r,initialPrompt:n,initialMessage:a,interactive:i,cols:s,rows:l})=>ui(`/agents/${t}/start`,{method:"POST",body:JSON.stringify({taskId:r,initialPrompt:n,initialMessage:a,interactive:i,cols:s,rows:l})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function f1(){const e=ht();return Ct({mutationFn:async({agentId:t,graceful:r})=>ui(`/agents/${t}/stop`,{method:"POST",body:JSON.stringify({graceful:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]})}})}function IQe(){const e=ht();return Ct({mutationFn:async({agentId:t})=>ui(`/agents/${t}/interrupt`,{method:"POST"}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]})}})}function _B(){const e=ht();return Ct({mutationFn:async({agentId:t,providerSessionId:r,resumePrompt:n})=>ui(`/agents/${t}/resume`,{method:"POST",body:JSON.stringify({providerSessionId:r,resumePrompt:n})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]})}})}function RQe(){const e=ht();return Ct({mutationFn:async({agentId:t,name:r})=>ui(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({name:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function PQe(){const e=ht();return Ct({mutationFn:async({agentId:t,provider:r})=>ui(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({provider:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function zQe(){const e=ht();return Ct({mutationFn:async({agentId:t,model:r})=>ui(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({model:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function BQe(){const e=ht();return Ct({mutationFn:async({agentId:t})=>ui(`/agents/${t}`,{method:"DELETE"}),onSuccess:()=>{e.invalidateQueries({queryKey:["agents"]})}})}function ime(){return gt({queryKey:["operators"],queryFn:()=>ui("/entities?entityType=human&limit=100")})}const $Qe="/api";async function g2(e,t){const r=await fetch(`${$Qe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function sme(e,t="all"){const r=()=>{switch(t){case"unread":return"unread";case"archived":return"archived";case"all":default:return"unread,read"}};return gt({queryKey:["agent-inbox",e,t],queryFn:()=>g2(`/entities/${e}/inbox?limit=50&hydrate=true&status=${r()}`),enabled:!!e,staleTime:3e4,refetchInterval:3e4})}function NB(e){return gt({queryKey:["agent-inbox-count",e],queryFn:()=>g2(`/entities/${e}/inbox/count`),enabled:!!e,refetchInterval:3e4,staleTime:15e3})}function FQe(e){const t=ht();return Ct({mutationFn:async({itemId:r,status:n})=>g2(`/inbox/${r}`,{method:"PATCH",body:JSON.stringify({status:n})}),onSuccess:()=>{t.invalidateQueries({queryKey:["agent-inbox",e]}),t.invalidateQueries({queryKey:["agent-inbox-count",e]})}})}function ome(e){const t=ht();return Ct({mutationFn:async()=>g2(`/entities/${e}/inbox/mark-all-read`,{method:"POST"}),onSuccess:()=>{t.invalidateQueries({queryKey:["agent-inbox",e]}),t.invalidateQueries({queryKey:["agent-inbox-count",e]})}})}function lme(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"now":a<60?`${a}m`:i<24?`${i}h`:s<7?`${s}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function UQe(e){return new Date(e).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}function HQe(){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/events`}function v2(e={}){const{channels:t=["*"],onEvent:r,onStateChange:n,autoInvalidate:a=!0}=e,i=ht(),l={url:w.useMemo(()=>HQe(),[]),channels:t,onEvent:r,onStateChange:n,autoInvalidate:a,queryClient:i,getQueryKeysForEvent:mce},c=r6e(l);return{connectionState:c.connectionState,lastEvent:c.lastEvent}}const qQe=/(?<![a-zA-Z0-9])@(?:\*\*|__)?(?:_|\*)?(`)?([a-zA-Z][a-zA-Z0-9_-]*)(`)?(?:\*|_)?(?:\*\*|__)?/g,WQe=/!\[([^\]]*)\]\(([^)]+)\)/g,KQe=/\\?\[([^\]\\]+)\\?\]\(([^)]+)\)/g;function GQe(e){return e[2]}function cme(e){return e.replace(/\\([[\](){}*_`~#>+\-.!|])/g,"$1")}function xL(e){let t=cme(e);return t=t.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),t=t.replace(/__([^_]+)__/g,"<strong>$1</strong>"),t=t.replace(/(?<![a-zA-Z0-9])\*([^*]+)\*(?![a-zA-Z0-9])/g,"<em>$1</em>"),t=t.replace(/(?<![a-zA-Z0-9])_([^_]+)_(?![a-zA-Z0-9])/g,"<em>$1</em>"),t=t.replace(/`([^`]+)`/g,'<code class="bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-sm font-mono">$1</code>'),t=t.replace(/~~([^~]+)~~/g,"<del>$1</del>"),t}function wL(e,t){const r=[];let n=0;const a=new RegExp(qQe.source,"g");let i;for(;(i=a.exec(e))!==null;){if(i.index>n){const l=e.slice(n,i.index),c=xL(l);r.push(o.jsx("span",{dangerouslySetInnerHTML:{__html:c}},`${t}-text-${n}`))}const s=GQe(i);r.push(o.jsxs("span",{className:"text-blue-600 font-medium","data-mention":s,title:`@${s}`,children:["@",s]},`${t}-mention-${i.index}`)),n=i.index+i[0].length}if(n<e.length){const s=e.slice(n),l=xL(s);r.push(o.jsx("span",{dangerouslySetInnerHTML:{__html:l}},`${t}-text-${n}`))}if(r.length===0){const s=xL(e);return[o.jsx("span",{dangerouslySetInnerHTML:{__html:s}},`${t}-text-0`)]}return r}function SL(e,t){const r=cme(e),n=[];let a=0;const i=new RegExp(KQe.source,"g");let s;for(;(s=i.exec(r))!==null;){if(s.index>a){const u=r.slice(a,s.index);n.push(...wL(u,`${t}-before-${s.index}`))}const l=s[1],c=s[2];n.push(o.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:l},`${t}-link-${s.index}`)),a=s.index+s[0].length}if(a<r.length){const l=r.slice(a);n.push(...wL(l,`${t}-after-${a}`))}return n.length>0?n:wL(r,t)}function ume(e){if(!e)return null;const t=[];let r=0;const n=new RegExp(WQe.source,"g");let a;for(;(a=n.exec(e))!==null;){if(a.index>r){const l=e.slice(r,a.index);t.push(o.jsx("span",{children:SL(l,`text-${r}`)},`text-${r}`))}const i=a[1]||"Image",s=a[2];t.push(o.jsx("div",{className:"my-2 block clear-both",children:o.jsx("img",{src:s,alt:i,className:"max-w-full max-h-80 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:opacity-90 transition-opacity block",onClick:()=>window.open(s,"_blank"),onLoad:l=>{const c=l.currentTarget;c.style.display="block"},"data-testid":`message-image-${a.index}`})},`image-${a.index}`)),r=a.index+a[0].length}if(r<e.length){const i=e.slice(r);t.push(o.jsx("span",{children:SL(i,`text-${r}`)},`text-${r}`))}return t.length===0?o.jsx("span",{children:SL(e,"content")}):o.jsx(o.Fragment,{children:t})}function VQe(e,t){if(!t.trim())return o.jsx(o.Fragment,{children:e});const r=e.toLowerCase(),n=t.toLowerCase(),a=r.indexOf(n);if(a===-1)return o.jsx(o.Fragment,{children:e});const i=e.slice(0,a),s=e.slice(a,a+t.length),l=e.slice(a+t.length);return o.jsxs(o.Fragment,{children:[i,o.jsx("mark",{className:"bg-yellow-200 text-gray-900 rounded-sm px-0.5","data-testid":"search-highlight",children:s}),l]})}function YQe({directorId:e,hasActiveSession:t,onSendCommand:r,"data-testid":n="pending-messages-queue"}){v2({channels:e?[`inbox:${e}`]:[],autoInvalidate:!0});const{data:a,isLoading:i,error:s,refetch:l}=sme(e,"unread"),c=ome(e??""),u=w.useMemo(()=>a?.items?a.items.filter(p=>p.status==="unread"):[],[a?.items]),d=w.useCallback(()=>{if(!t){console.warn("Cannot process messages: Director has no active session");return}r?.("Check your inbox and process the pending messages"),setTimeout(()=>{r?.("\r")},200)},[t,r]),f=w.useCallback(p=>{if(!t){console.warn("Cannot process message: Director has no active session");return}const v=`Process inbox item ${p}  read it with \`sf show ${p}\` and handle it. Do not process other inbox messages.`;r?.(v),setTimeout(()=>{r?.("\r")},200)},[t,r]),m=w.useCallback(async()=>{if(e)try{await c.mutateAsync()}catch(p){console.error("Failed to mark all messages as read:",p)}},[e,c]);return e?i?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4","data-testid":n,children:[o.jsx(jr,{className:"w-6 h-6 text-[var(--color-text-muted)] animate-spin"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-2",children:"Loading messages..."})]}):s?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center","data-testid":n,children:[o.jsx("p",{className:"text-sm text-[var(--color-danger)]",children:"Failed to load messages"}),o.jsx("button",{onClick:()=>l(),className:"mt-2 text-xs text-[var(--color-primary)] hover:underline",children:"Retry"})]}):o.jsxs("div",{className:"flex flex-col h-full","data-testid":n,children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-bg-secondary)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(VC,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Pending Messages"}),u.length>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded-full bg-[var(--color-primary)] text-white",children:u.length})]}),o.jsx("div",{className:"flex items-center gap-1",children:u.length>0&&o.jsxs(o.Fragment,{children:[o.jsx(Cn,{content:"Mark all as read",side:"bottom",children:o.jsx("button",{onClick:m,disabled:c.isPending,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Mark all as read","data-testid":"mark-all-read-btn",children:c.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(YC,{className:"w-4 h-4"})})}),o.jsx(Cn,{content:t?"Process messages":"Start director session first",side:"bottom",children:o.jsxs("button",{onClick:d,disabled:!t,className:"flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium bg-[var(--color-primary)] text-white hover:bg-[var(--color-primary-hover)] transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Process messages","data-testid":"process-messages-btn",children:[o.jsx(QC,{className:"w-3.5 h-3.5"}),"Process"]})})]})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:u.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[o.jsx(rs,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No pending messages"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:"Messages will appear here when received"})]}):o.jsx("ul",{className:"divide-y divide-[var(--color-border)]","data-testid":"messages-list",children:u.map(p=>o.jsx(QQe,{item:p,hasActiveSession:t,onProcessSingle:f},p.id))})})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center","data-testid":n,children:[o.jsx(rs,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No Director agent"})]})}function QQe({item:e,hasActiveSession:t,onProcessSingle:r}){const n=e.sender?.name??e.message?.sender??"Unknown",a=e.message?.contentPreview??e.message?.fullContent??"",i=e.createdAt,s=e.channel?.name,l=e.sourceType,c=w.useCallback(()=>{r(e.id)},[e.id,r]);return o.jsx("li",{className:"px-3 py-2.5 hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":"message-item",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full bg-[var(--color-primary)]/10 flex items-center justify-center",children:o.jsx(Zr,{className:"w-4 h-4 text-[var(--color-primary)]"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:n}),s&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)] truncate",children:["#",s]}),l==="mention"&&o.jsx("span",{className:"px-1 py-0.5 text-[10px] font-medium rounded bg-blue-500/20 text-blue-400",children:"@mention"}),o.jsxs("div",{className:"flex items-center gap-1 ml-auto flex-shrink-0",children:[o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)] flex items-center gap-1",children:[o.jsx(tn,{className:"w-3 h-3"}),lme(i)]}),o.jsx(Cn,{content:t?"Process this message":"Start director session first",side:"left",children:o.jsx("button",{onClick:c,disabled:!t,className:"flex items-center gap-1 ml-1 px-1.5 py-0.5 rounded-md text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary)]/10 transition-colors duration-150 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":`Process message ${e.id}`,"data-testid":"process-single-message-btn",children:o.jsx(en,{className:"w-3 h-3"})})})]})]}),o.jsx("div",{className:"text-sm text-[var(--color-text-secondary)] line-clamp-2",children:ume(a)})]})]})})}const nX=280,aX=800,iX=384,sX="orchestrator-director-panel-width";function JQe({collapsed:e=!1,onToggle:t,isMaximized:r=!1,onToggleMaximize:n}){const[a,i]=w.useState("disconnected"),[s,l]=w.useState(!1),{director:c,hasActiveSession:u,hasResumableSession:d,lastResumableSession:f,isLoading:m,error:p}=ame(),v=p2(),b=f1(),y=_B(),[S,_]=w.useState(null),N=w.useRef(null),{data:k}=NB(c?.id??null),[j,E]=w.useState(()=>{if(typeof window>"u")return iX;const Y=localStorage.getItem(sX);if(Y){const ie=parseInt(Y,10);if(!isNaN(ie)&&ie>=nX&&ie<=aX)return ie}return iX}),[T,O]=w.useState(!1),R=w.useRef(null);w.useEffect(()=>{localStorage.setItem(sX,String(j))},[j]);const q=w.useCallback(Y=>{Y.preventDefault(),O(!0),R.current={startX:Y.clientX,startWidth:j}},[j]);w.useEffect(()=>{if(!T)return;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const Y=fe=>{if(!R.current)return;const me=R.current.startX-fe.clientX,te=Math.min(aX,Math.max(nX,R.current.startWidth+me));E(te)},ie=()=>{O(!1),R.current=null};return document.addEventListener("mousemove",Y),document.addEventListener("mouseup",ie),()=>{document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",ie),document.body.style.cursor="",document.body.style.userSelect=""}},[T]);const L=p||a==="error"?"error":m||a==="connecting"?"connecting":c?u&&a==="connected"?"running":"idle":"no-director",A={idle:"text-[var(--color-text-tertiary)]",running:"text-[var(--color-success)]",error:"text-[var(--color-danger)]",connecting:"text-[var(--color-warning)]","no-director":"text-[var(--color-text-muted)]"}[L],M={idle:"Idle",running:"Running",error:"Error",connecting:"Connecting...","no-director":"No Director"}[L],z=w.useCallback(async()=>{if(c?.id){_(null);try{const Y=N.current?.getDimensions();await v.mutateAsync({agentId:c.id,...Y&&{cols:Y.cols,rows:Y.rows}})}catch(Y){console.error("Failed to start director session:",Y)}}},[c?.id,v]),I=w.useCallback(async()=>{if(!(!c?.id||!f?.providerSessionId)){_(null);try{await y.mutateAsync({agentId:c.id,providerSessionId:f.providerSessionId})}catch(Y){console.error("Failed to resume director session:",Y),_(Y instanceof Error?Y.message:"Resume failed")}}},[c?.id,f?.providerSessionId,y]),B=w.useCallback(async()=>{if(c?.id)try{await b.mutateAsync({agentId:c.id,graceful:!0})}catch(Y){console.error("Failed to stop director session:",Y)}},[c?.id,b]),F=w.useCallback(async()=>{if(c?.id)try{await b.mutateAsync({agentId:c.id,graceful:!0});const Y=N.current?.getDimensions();await v.mutateAsync({agentId:c.id,...Y&&{cols:Y.cols,rows:Y.rows}})}catch(Y){console.error("Failed to restart director session:",Y)}},[c?.id,b,v]),U=w.useCallback(Y=>{i(Y)},[]);w.useEffect(()=>{if(a==="connected"){const Y=setTimeout(()=>{N.current?.refresh()},300);return()=>clearTimeout(Y)}},[a]),w.useEffect(()=>{if(a==="connected"){const Y=setTimeout(()=>{N.current?.refresh()},100);return()=>clearTimeout(Y)}},[r,a]);const V=w.useCallback(()=>{N.current&&(N.current.sendInput("Use your sift-backlog skill"),setTimeout(()=>{N.current?.sendInput("\r")},200))},[]),K=w.useCallback(()=>{l(Y=>!Y)},[]),G=w.useCallback(Y=>{N.current?.sendInput(Y)},[]),J=k?.count??0,ee=w.useCallback(()=>{r&&n&&n(),t?.()},[r,n,t]);return e?o.jsx("aside",{className:"flex flex-col items-center py-3 w-12 border-l border-[var(--color-border)] bg-[var(--color-bg-secondary)]","data-testid":"director-panel-collapsed",children:o.jsx(Cn,{content:"Open Director Panel",side:"left",children:o.jsxs("button",{onClick:t,className:"relative p-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":"Open Director Panel","data-testid":"director-panel-expand",children:[o.jsx(na,{className:"w-5 h-5"}),o.jsx(nu,{className:`absolute -top-0.5 -right-0.5 w-2.5 h-2.5 fill-current ${A}`}),J>0&&o.jsx("span",{className:"absolute -bottom-1 -right-1 flex items-center justify-center min-w-[16px] h-4 px-1 text-[10px] font-bold rounded-full bg-[var(--color-primary)] text-white","data-testid":"director-panel-collapsed-unread-badge",children:J>99?"99+":J})]})})}):o.jsxs("aside",{className:`
        relative flex flex-col border-l border-[var(--color-border)] bg-[var(--color-bg-secondary)]
        ${r?"fixed inset-0 z-50 border-l-0":""}
      `,style:r?void 0:{width:`${j}px`},"data-testid":"director-panel",children:[!r&&o.jsx("div",{className:`
            absolute left-0 top-0 bottom-0 w-1 cursor-col-resize z-10
            hover:bg-[var(--color-primary)] hover:opacity-50
            transition-colors duration-150
            ${T?"bg-[var(--color-primary)] opacity-50":""}
          `,onMouseDown:q,"data-testid":"director-panel-resize-handle"}),o.jsxs("div",{className:"flex items-center justify-between h-14 px-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(na,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Director"}),o.jsxs("span",{className:`flex items-center gap-1 text-xs ${A}`,children:[o.jsx(nu,{className:"w-2 h-2 fill-current"}),M]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[u&&o.jsx(Cn,{content:"Sift Backlog",side:"bottom",children:o.jsx("button",{onClick:V,className:"p-1.5 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":"Sift Backlog","data-testid":"director-sift-backlog",children:o.jsx(owe,{className:"w-4 h-4"})})}),c&&o.jsx(Cn,{content:s?"Hide pending messages":"Show pending messages",side:"bottom",children:o.jsxs("button",{onClick:K,className:`relative p-1.5 rounded-md transition-colors duration-150 ${s?"text-[var(--color-primary)] bg-[var(--color-primary)]/10":"text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,"aria-label":s?"Hide pending messages":"Show pending messages","data-testid":"toggle-messages-queue",children:[o.jsx(VC,{className:"w-4 h-4"}),J>0&&o.jsx("span",{className:"absolute -top-1 -right-1 flex items-center justify-center min-w-[16px] h-4 px-1 text-[10px] font-bold rounded-full bg-[var(--color-primary)] text-white",children:J>99?"99+":J})]})}),c&&o.jsx(o.Fragment,{children:u?o.jsxs(o.Fragment,{children:[o.jsx(Cn,{content:"Restart Director Session",side:"bottom",children:o.jsx("button",{onClick:F,disabled:b.isPending||v.isPending,className:"p-1.5 rounded-md text-[var(--color-warning)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Restart Director Session","data-testid":"director-restart-session",children:b.isPending||v.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(Rs,{className:"w-4 h-4"})})}),o.jsx(Cn,{content:"Stop Director Session",side:"bottom",children:o.jsx("button",{onClick:B,disabled:b.isPending,className:"p-1.5 rounded-md text-[var(--color-danger)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Stop Director Session","data-testid":"director-stop-session",children:b.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(uu,{className:"w-4 h-4"})})})]}):o.jsx(Cn,{content:"Start Director Session",side:"bottom",children:o.jsx("button",{onClick:z,disabled:v.isPending,className:"p-1.5 rounded-md text-[var(--color-success)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Start Director Session","data-testid":"director-start-session",children:v.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(en,{className:"w-4 h-4"})})})}),o.jsx(Cn,{content:r?"Restore Panel":"Maximize Panel",side:"bottom",children:o.jsx("button",{onClick:n,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":r?"Restore Panel":"Maximize Panel","data-testid":"director-panel-maximize",children:r?o.jsx(D6,{className:"w-4 h-4"}):o.jsx(JC,{className:"w-4 h-4"})})}),o.jsx(Cn,{content:"Collapse Panel",side:"left",children:o.jsx("button",{onClick:ee,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":"Collapse Director Panel","data-testid":"director-panel-collapse",children:o.jsx(lwe,{className:"w-4 h-4"})})})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s&&o.jsx("div",{className:"border-b border-[var(--color-border)] bg-[var(--color-bg)] overflow-hidden",style:{height:"280px",minHeight:"200px"},"data-testid":"pending-messages-container",children:o.jsx(YQe,{directorId:c?.id??null,hasActiveSession:u,onSendCommand:G})}),o.jsx("div",{className:"flex-1 p-2 overflow-hidden","data-testid":"director-terminal-container",children:o.jsxs("div",{className:"h-full rounded-lg bg-[#1a1a1a] border border-[var(--color-border)] flex flex-col overflow-hidden",children:[o.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)] bg-[#252525]",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${u?"bg-green-500":"bg-red-500 opacity-50"}`}),o.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500 opacity-50"}),o.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500 opacity-50"})]}),o.jsx("span",{className:"text-xs text-gray-400 font-mono",children:c?.name??"director"})]})}),o.jsx("div",{className:"flex-1 overflow-hidden relative",children:L==="no-director"||m&&!c?o.jsx("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:m?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2 animate-spin"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Loading..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No Director agent found"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:"Register a Director agent to use this terminal"})]})}):L==="error"&&p?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-danger)]",children:"Connection Error"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:p.message})]}):o.jsxs(o.Fragment,{children:[o.jsx(xB,{ref:N,agentId:c?.id,onStatusChange:U,theme:"dark",fontSize:12,autoFit:!0,interactive:!0,autoFocus:!0,controlsResize:!0,"data-testid":"director-xterminal"}),c&&(!u||b.isPending)&&o.jsx("div",{className:`
                      absolute inset-0 z-10
                      flex flex-col items-center justify-center
                      bg-[#1a1a1a]/95 backdrop-blur-sm
                    `,"data-testid":"director-idle-overlay",children:b.isPending?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-5",children:[o.jsx("div",{className:"absolute inset-0 bg-amber-500/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                            relative p-3 rounded-xl
                            bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                            border border-[#333]
                            shadow-lg
                          `,children:o.jsx(jr,{className:"w-8 h-8 text-amber-400 animate-spin"})})]}),o.jsxs("div",{className:"text-center mb-5",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-1",children:"Shutting Down"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-xs px-4",children:"Gracefully stopping the session..."})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"0ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"150ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"300ms"}})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-5",children:[o.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                            relative p-3 rounded-xl
                            bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                            border border-[#333]
                            shadow-lg
                          `,children:o.jsx(Uae,{className:"w-8 h-8 text-[var(--color-text-muted)]"})})]}),o.jsxs("div",{className:"text-center mb-5",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-1",children:"Director Idle"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-xs px-4",children:d?"Resume your previous session or start fresh.":"Start a session to interact with the Director agent."})]}),S&&o.jsx("div",{className:"mb-3 px-3 py-2 rounded-md bg-red-500/10 border border-red-500/20 text-xs text-red-400 max-w-xs text-center",children:S}),d?o.jsxs("div",{className:"flex flex-col items-center gap-3",children:[o.jsx("button",{onClick:I,disabled:y.isPending||v.isPending,className:`
                                inline-flex items-center gap-2
                                px-5 py-2 rounded-lg
                                bg-gradient-to-r from-green-600 to-green-500
                                hover:from-green-500 hover:to-green-400
                                text-white font-medium text-sm
                                shadow-lg shadow-green-500/25
                                transition-all duration-200
                                hover:scale-105 hover:shadow-green-500/40
                                disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                                focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                              `,"data-testid":"director-overlay-resume-btn",children:y.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-4 h-4 animate-spin"}),"Resuming..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Rs,{className:"w-4 h-4"}),"Resume Session"]})}),o.jsx("button",{onClick:z,disabled:v.isPending||y.isPending,className:`
                                inline-flex items-center gap-2
                                px-4 py-1.5 rounded-md
                                border border-[#444] hover:border-[#555]
                                text-[var(--color-text-secondary)] text-xs
                                hover:text-[var(--color-text)]
                                transition-all duration-200
                                disabled:opacity-50 disabled:cursor-not-allowed
                                focus:outline-none focus:ring-2 focus:ring-[#444]/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                              `,"data-testid":"director-overlay-new-session-btn",children:v.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3 h-3 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-3 h-3"}),"New Session"]})}),o.jsx("p",{className:"text-[10px] text-[var(--color-text-tertiary)] mt-1",children:"Resume picks up where your last session left off"})]}):o.jsx("button",{onClick:z,disabled:v.isPending,className:`
                              inline-flex items-center gap-2
                              px-5 py-2 rounded-lg
                              bg-gradient-to-r from-green-600 to-green-500
                              hover:from-green-500 hover:to-green-400
                              text-white font-medium text-sm
                              shadow-lg shadow-green-500/25
                              transition-all duration-200
                              hover:scale-105 hover:shadow-green-500/40
                              disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                              focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                            `,"data-testid":"director-overlay-start-btn",children:v.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-4 h-4 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-4 h-4"}),"Start Session"]})})]})})]})})]})})]})]})}const ZQe="/api";async function Hi(e,t){const r=await fetch(`${ZQe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function b2(e){const t=new URLSearchParams;e?.status&&e.status!=="all"&&t.set("status",e.status),e?.assignment&&e.assignment!=="all"&&t.set("assignment",e.assignment),e?.assignee&&t.set("assignee",e.assignee),e?.priority&&t.set("priority",String(e.priority)),e?.taskType&&t.set("taskType",e.taskType),e?.ephemeral!==void 0&&t.set("ephemeral",String(e.ephemeral)),e?.page&&t.set("page",String(e.page)),e?.limit&&t.set("limit",String(e.limit));const r=t.toString(),n=r?`/tasks?${r}`:"/tasks";return gt({queryKey:["tasks",e],queryFn:()=>Hi(n),refetchInterval:1e4})}function XQe(e){return gt({queryKey:["task",e],queryFn:()=>Hi(`/tasks/${e}`),enabled:!!e})}function h1(){const{data:e,isLoading:t,error:r,refetch:n}=b2(),a=e?.tasks??[],i=a.filter(p=>p.status==="backlog"),s=a.filter(p=>!p.assignee&&(p.status==="open"||p.status==="blocked"||p.status==="deferred")),l=a.filter(p=>p.assignee&&p.status!=="backlog"&&p.status!=="closed"&&p.status!=="tombstone"),c=a.filter(p=>p.status==="in_progress"),u=a.filter(p=>p.status==="blocked"),d=a.filter(p=>p.status==="closed"),f=a.filter(p=>{if(p.status==="review")return!0;const v=p.metadata?.orchestrator;return p.status==="closed"&&v?.mergeStatus&&v.mergeStatus!=="merged"}),m=a.filter(p=>{const v=p.metadata?.orchestrator;return p.status==="closed"&&v?.mergeStatus==="merged"});return{backlog:i,unassigned:s,assigned:l,inProgress:c,blocked:u,closed:d,awaitingMerge:f,merged:m,allTasks:a,total:e?.total??a.length,isLoading:t,error:r,refetch:n}}function dme(){const e=ht();return Ct({mutationFn:async t=>Hi("/tasks",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function fme(){const e=ht();return Ct({mutationFn:async({taskId:t,...r})=>Hi(`/tasks/${t}`,{method:"PATCH",body:JSON.stringify(r)}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function hme(){const e=ht();return Ct({mutationFn:async({taskId:t})=>Hi(`/tasks/${t}/start`,{method:"POST"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function mme(){const e=ht();return Ct({mutationFn:async({taskId:t,closeReason:r})=>Hi(`/tasks/${t}/complete`,{method:"POST",body:JSON.stringify({closeReason:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function pme(){const e=ht();return Ct({mutationFn:async({taskId:t,message:r})=>Hi(`/tasks/${t}/reopen`,{method:"POST",body:JSON.stringify({message:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function eJe(){const e=ht();return Ct({mutationFn:async({taskId:t})=>Hi(`/tasks/${t}/reset`,{method:"POST"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function tJe(){const e=ht();return Ct({mutationFn:async({taskId:t,mergeStatus:r})=>Hi(`/tasks/${t}/merge-status`,{method:"PATCH",body:JSON.stringify({mergeStatus:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function gme(){const e=ht();return Ct({mutationFn:async({taskId:t,reason:r})=>Hi(`/tasks/${t}`,{method:"DELETE",body:JSON.stringify({reason:r})}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function rJe(){const e=ht();return Ct({mutationFn:async({ids:t})=>Hi("/tasks/bulk-delete",{method:"POST",body:JSON.stringify({ids:t})}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function nJe(e){return gt({queryKey:["tasks",e,"attachments"],queryFn:()=>Hi(`/tasks/${e}/attachments`),enabled:!!e})}function aJe(){const e=ht();return Ct({mutationFn:async({taskId:t,documentId:r})=>Hi(`/tasks/${t}/attachments`,{method:"POST",body:JSON.stringify({documentId:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"attachments"]})}})}function iJe(){const e=ht();return Ct({mutationFn:async({taskId:t,documentId:r})=>Hi(`/tasks/${t}/attachments/${r}`,{method:"DELETE"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"attachments"]})}})}function sJe(e){return gt({queryKey:["documents","search",e],queryFn:async()=>{const r=(await Hi("/documents")).items||[];if(e?.trim()){const n=e.toLowerCase();return r.filter(a=>a.title?.toLowerCase().includes(n)||a.id.toLowerCase().includes(n))}return r}})}const oJe="/api";async function CB(e,t){const r=await fetch(`${oJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function lJe(e){return gt({queryKey:["tasks",e,"dependency-tasks"],queryFn:()=>CB(`/tasks/${e}/dependency-tasks`),enabled:!!e})}function cJe(){const e=ht();return Ct({mutationFn:async({taskId:t,blockerId:r,type:n})=>CB(`/tasks/${t}/dependencies`,{method:"POST",body:JSON.stringify({blockerId:r,type:n})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"dependency-tasks"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function uJe(){const e=ht();return Ct({mutationFn:async({taskId:t,blockerId:r})=>CB(`/tasks/${t}/dependencies/${r}`,{method:"DELETE"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"dependency-tasks"]}),e.invalidateQueries({queryKey:["tasks"]})}})}const vme="",Tk={all:["activity"],list:e=>[...Tk.all,"list",e],infinite:e=>[...Tk.all,"infinite",e],detail:e=>[...Tk.all,"detail",e]};async function dJe(e){const t=new URLSearchParams;if(e?.category&&e.category!=="all"){const i={tasks:"task",agents:"entity",sessions:"entity",workflows:"workflow"}[e.category];i&&t.set("elementType",i)}e?.elementId&&t.set("elementId",e.elementId),e?.elementType&&t.set("elementType",Array.isArray(e.elementType)?e.elementType.join(","):e.elementType),e?.eventType&&t.set("eventType",Array.isArray(e.eventType)?e.eventType.join(","):e.eventType),e?.actor&&t.set("actor",e.actor),e?.after&&t.set("after",e.after),e?.before&&t.set("before",e.before),e?.limit&&t.set("limit",String(e.limit)),e?.offset&&t.set("offset",String(e.offset));const r=`${vme}/api/events${t.toString()?`?${t}`:""}`,n=await fetch(r);if(!n.ok){const a=await n.json().catch(()=>({error:{message:n.statusText}}));throw new Error(a.error?.message||"Failed to fetch activity")}return n.json()}function fJe(e){const t=e?.limit||20;return U1e({queryKey:Tk.infinite(e),queryFn:async({pageParam:r=0})=>dJe({...e,limit:t,offset:r}),initialPageParam:0,getNextPageParam:(r,n)=>r.hasMore?n.reduce((i,s)=>i+s.events.length,0):void 0})}function jB(e="all"){const[t,r]=w.useState(!1),[n,a]=w.useState([]),i=w.useRef(null),s=w.useRef(null),l=w.useCallback(()=>{i.current&&i.current.close();const u=`${vme}/api/events/stream${e!=="all"?`?category=${e}`:""}`,d=new EventSource(u);i.current=d,d.onopen=()=>{r(!0),s.current&&clearTimeout(s.current)},d.onerror=()=>{r(!1),d.close(),s.current=setTimeout(l,5e3)},d.addEventListener("connected",()=>{r(!0)}),d.addEventListener("session_event",f=>{try{const m=JSON.parse(f.data);a(p=>[m,...p].slice(0,100))}catch{console.error("Failed to parse session event:",f.data)}}),d.addEventListener("heartbeat",()=>{})},[e]),c=w.useCallback(()=>{i.current&&(i.current.close(),i.current=null),s.current&&clearTimeout(s.current),r(!1)},[]);return w.useEffect(()=>(l(),()=>c()),[l,c]),w.useEffect(()=>{a([])},[e]),{isConnected:t,sessionEvents:n,connect:l,disconnect:c,clearSessionEvents:()=>a([])}}function hJe(e){return{created:"var(--color-success)",updated:"var(--color-primary)",closed:"var(--color-text-secondary)",reopened:"var(--color-warning)",deleted:"var(--color-error)",dependency_added:"var(--color-info)",dependency_removed:"var(--color-text-secondary)",tag_added:"var(--color-info)",tag_removed:"var(--color-text-secondary)",member_added:"var(--color-success)",member_removed:"var(--color-warning)",auto_blocked:"var(--color-error)",auto_unblocked:"var(--color-success)"}[e]||"var(--color-text-secondary)"}function EB(e){const t=Date.now(),r=new Date(e).getTime(),n=t-r,a=Math.floor(n/1e3),i=Math.floor(a/60),s=Math.floor(i/60),l=Math.floor(s/24);return a<60?"just now":i<60?`${i}m ago`:s<24?`${s}h ago`:l<7?`${l}d ago`:new Date(e).toLocaleDateString()}const mJe="",oX={sessionEvents:!0,errors:!0,sound:!1,toastDuration:5e3},bme="orchestrator-notifications",yme="orchestrator-notification-preferences",pJe=100;function xme(){return`notif-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function gJe(e){if(e.type!=="error"&&e.type!=="system")return null;const t=e.type==="error"?"error":"info",r=e.type==="error"?"Agent Error":"System Event",n=e.agentName||e.agentId||"Agent";return{id:xme(),type:t,title:`${r}: ${n}`,message:e.content?.substring(0,200),timestamp:e.timestamp,read:!1,dismissed:!1,navigateTo:e.sessionId?`/workspaces?session=${e.sessionId}`:void 0,source:{sessionId:e.sessionId,agentId:e.agentId}}}function vJe(e,t){return e.type==="error"?t.errors:t.sessionEvents}function bJe(){try{const e=localStorage.getItem(bme);if(e){const t=JSON.parse(e),r=Date.now()-1440*60*1e3;return t.filter(a=>new Date(a.timestamp).getTime()>r)}}catch{}return[]}function yJe(e){try{localStorage.setItem(bme,JSON.stringify(e))}catch{}}function xJe(){try{const e=localStorage.getItem(yme);if(e)return{...oX,...JSON.parse(e)}}catch{}return oX}function wJe(e){try{localStorage.setItem(yme,JSON.stringify(e))}catch{}}function SJe(){const[e,t]=w.useState(()=>bJe()),[r,n]=w.useState(()=>xJe()),[a,i]=w.useState(!1),s=w.useRef(null),l=w.useRef(null),c=e.filter(_=>!_.read&&!_.dismissed).length,u=e.filter(_=>!_.dismissed);w.useEffect(()=>{yJe(e)},[e]),w.useEffect(()=>{wJe(r)},[r]);const d=w.useCallback(_=>{const N={..._,id:xme(),timestamp:new Date().toISOString(),read:!1,dismissed:!1};return t(j=>[N,...j].slice(0,pJe)),(_.type==="error"?Kr.error:_.type==="warning"?Kr.warning:_.type==="success"?Kr.success:Kr.info)(_.title,{description:_.message,duration:r.toastDuration||void 0,action:_.navigateTo?{label:"View",onClick:()=>{window.location.href=_.navigateTo}}:void 0}),N},[r.toastDuration]),f=w.useCallback(_=>{t(N=>N.map(k=>k.id===_?{...k,read:!0}:k))},[]),m=w.useCallback(()=>{t(_=>_.map(N=>({...N,read:!0})))},[]),p=w.useCallback(_=>{t(N=>N.map(k=>k.id===_?{...k,dismissed:!0}:k))},[]),v=w.useCallback(()=>{t([])},[]),b=w.useCallback(_=>{n(N=>({...N,..._}))},[]),y=w.useCallback(()=>{s.current&&s.current.close();const _=`${mJe}/api/events/stream`,N=new EventSource(_);s.current=N,N.onopen=()=>{i(!0),l.current&&clearTimeout(l.current)},N.onerror=()=>{i(!1),N.close(),l.current=setTimeout(y,5e3)},N.addEventListener("connected",()=>{i(!0)}),N.addEventListener("session_event",k=>{try{const j=JSON.parse(k.data);if(vJe(j,r)){const E=gJe(j);E&&d(E)}}catch{console.error("Failed to parse session event:",k.data)}}),N.addEventListener("notification",k=>{try{const j=JSON.parse(k.data);d(j)}catch{console.error("Failed to parse notification event:",k.data)}}),N.addEventListener("heartbeat",()=>{})},[r,d]),S=w.useCallback(()=>{s.current&&(s.current.close(),s.current=null),l.current&&clearTimeout(l.current),i(!1)},[]);return w.useEffect(()=>(y(),()=>S()),[y,S]),{notifications:u,unreadCount:c,isConnected:a,preferences:r,addNotification:d,markAsRead:f,markAllAsRead:m,dismissNotification:p,clearAll:v,setPreferences:b,connect:y,disconnect:S}}const v0=["elements","all"],Wn={tasks:["elements","tasks"],plans:["elements","plans"],workflows:["elements","workflows"],entities:["elements","entities"],documents:["elements","documents"],channels:["elements","channels"],messages:["elements","messages"],teams:["elements","teams"],libraries:["elements","libraries"]};async function kJe(){const e=await fetch("/api/elements/all?includeTaskCounts=true");if(!e.ok)throw new Error(`Failed to fetch all elements: ${e.statusText}`);return e.json()}function _Je(){const e=ht(),t=gt({queryKey:v0,queryFn:kJe,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),r=t.data;return r&&(r.data.task&&e.setQueryData(Wn.tasks,r.data.task.items),r.data.plan&&e.setQueryData(Wn.plans,r.data.plan.items),r.data.workflow&&e.setQueryData(Wn.workflows,r.data.workflow.items),r.data.entity&&e.setQueryData(Wn.entities,r.data.entity.items),r.data.document&&e.setQueryData(Wn.documents,r.data.document.items),r.data.channel&&e.setQueryData(Wn.channels,r.data.channel.items),r.data.message&&e.setQueryData(Wn.messages,r.data.message.items),r.data.team&&e.setQueryData(Wn.teams,r.data.team.items),r.data.library&&e.setQueryData(Wn.libraries,r.data.library.items)),{isLoading:t.isLoading,isError:t.isError,error:t.error,data:t.data,totalElements:r?.totalElements??0,loadedAt:r?.loadedAt,refetch:t.refetch}}function NJe(){const e=ht();return gt({queryKey:Wn.plans,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.plan)return t.data.plan.items;const r=await fetch("/api/plans?limit=10000");if(!r.ok)throw new Error("Failed to fetch plans");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function y2(){const e=ht();return gt({queryKey:Wn.entities,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.entity)return t.data.entity.items;const r=await fetch("/api/entities?limit=10000");if(!r.ok)throw new Error("Failed to fetch entities");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function MB(){const e=ht();return gt({queryKey:Wn.documents,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.document)return t.data.document.items;const r=await fetch("/api/documents?limit=10000");if(!r.ok)throw new Error("Failed to fetch documents");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function CJe(){const e=ht();return gt({queryKey:Wn.channels,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.channel)return t.data.channel.items;const r=await fetch("/api/channels?limit=10000");if(!r.ok)throw new Error("Failed to fetch channels");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function wme(e){return{task:Wn.tasks,plan:Wn.plans,workflow:Wn.workflows,entity:Wn.entities,document:Wn.documents,channel:Wn.channels,message:Wn.messages,team:Wn.teams,library:Wn.libraries}[e]}function jJe(e,t,r){const n=wme(t);e.setQueryData(n,a=>{if(!a)return[r];const i=a.findIndex(s=>s.id===r.id);if(i>=0){const s=[...a];return s[i]=r,s}else return[r,...a]})}function Sme(e,t,r){const n=wme(t);e.setQueryData(n,a=>a?a.filter(i=>i.id!==r):[]),e.setQueryData(v0,a=>{if(!a)return a;const i=t,s=a.data[i];return s?{...a,data:{...a.data,[i]:{...s,items:s.items.filter(l=>l.id!==r),total:s.total-1}},totalElements:a.totalElements-1}:a})}function EJe(e,t){const r=t.elementType;if(!["task","plan","workflow","entity","document","channel","message","team","library"].includes(r))return!1;const a=t.eventType;return a==="deleted"||a==="soft-deleted"?(Sme(e,r,t.elementId),!0):t.newValue&&(a==="created"||a==="updated"||a.includes("status")||a.includes("assigned"))?(jJe(e,r,t.newValue),!0):!1}function MJe(){const e=ht();return w.useCallback(t=>EJe(e,t),[e])}function TB(e,t){const[r,n]=w.useState(e);return w.useEffect(()=>{const a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}const TJe=300;function AJe(e){return gt({queryKey:["channels",e],queryFn:async()=>{if(!e)throw new Error("No channel selected");const t=await fetch(`/api/channels/${e}`);if(!t.ok)throw new Error("Failed to fetch channel");return t.json()},enabled:!!e})}function DJe(e){return gt({queryKey:["channels",e,"messages"],queryFn:async()=>{if(!e)throw new Error("No channel selected");const t=await fetch(`/api/channels/${e}/messages?limit=10000&hydrate.content=true`);if(!t.ok)throw new Error("Failed to fetch messages");return t.json()},enabled:!!e})}function kme(){const e=ht();return Ct({mutationFn:async({channelId:t,sender:r,content:n,threadId:a,attachmentIds:i})=>{const s=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelId:t,sender:r,content:n,threadId:a,attachmentIds:i})});if(!s.ok){const l=await s.json();throw new Error(l.error?.message||"Failed to send message")}return s.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"messages"]}),r.threadId&&e.invalidateQueries({queryKey:["messages",r.threadId,"replies"]})}})}function LJe(e){return gt({queryKey:["messages",e,"replies"],queryFn:async()=>{if(!e)throw new Error("No thread selected");const t=await fetch(`/api/messages/${e}/replies?limit=10000&hydrate.content=true`);return t.ok?t.json():[]},enabled:!!e})}function OJe(){const e=ht();return Ct({mutationFn:async({channelId:t,actor:r})=>{const n=await fetch(`/api/channels/${t}?actor=${encodeURIComponent(r)}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to delete channel")}return n.json()},onSuccess:(t,{channelId:r})=>{Sme(e,"channel",r),e.invalidateQueries({queryKey:["channels"]}),e.invalidateQueries({queryKey:["channels",r]}),e.invalidateQueries({queryKey:["channels",r,"messages"]}),e.invalidateQueries({queryKey:["channels",r,"members"]})}})}function IJe(e,t){const r=TB(e,TJe);return gt({queryKey:["messages","search",r,t],queryFn:async()=>{if(!r.trim())return{results:[],query:""};const n=new URLSearchParams({q:r,limit:"50"});t&&n.set("channelId",t);const a=await fetch(`/api/messages/search?${n}`);if(!a.ok)throw new Error("Failed to search messages");return a.json()},enabled:r.trim().length>0,staleTime:3e4})}function RJe(e){return gt({queryKey:["documents","search",e],queryFn:async()=>{const t=await fetch("/api/documents");if(!t.ok)throw new Error("Failed to fetch documents");const r=await t.json(),n=r.items||r;if(e.trim()){const a=e.toLowerCase();return n.filter(i=>i.title?.toLowerCase().includes(a)||i.id.toLowerCase().includes(a))}return n}})}function AB(){return gt({queryKey:["entities"],queryFn:async()=>{const e=await fetch("/api/entities");if(!e.ok)throw new Error("Failed to fetch entities");const t=await e.json();return t.items||t}})}const PJe="/api";async function Oh(e,t){const r=await fetch(`${PJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function _me(e){const t=e.metadata?.orchestrator;return(e.status==="review"||e.status==="closed")&&!!t?.mergeStatus}function zJe(e,t,r){const n=e.metadata?.orchestrator?.mergeStatus;if(!n||n==="merged"&&!r)return!1;switch(t){case"all":return!0;case"needs_review":return n==="pending"||n==="test_failed";case"testing":return n==="testing"||n==="merging";case"conflicts":return n==="conflict"||n==="failed";case"merged":return n==="merged";default:return!0}}function BJe(e){return gt({queryKey:["merge-requests",e],queryFn:async()=>{const[t,r]=await Promise.all([Oh("/tasks?status=review"),Oh("/tasks?status=closed")]);let a=[...t.tasks,...r.tasks].filter(_me);const i=e?.status||"all",s=e?.showMerged??!1;return a=a.filter(l=>zJe(l,i,s)),e?.assignee&&(a=a.filter(l=>l.assignee===e.assignee)),a.sort((l,c)=>new Date(c.updatedAt).getTime()-new Date(l.updatedAt).getTime()),a},refetchInterval:1e4})}function $Je(e){return gt({queryKey:["merge-request",e],queryFn:async()=>(await Oh(`/tasks/${e}`)).task,enabled:!!e})}function Nme(){const{data:e,isLoading:t,error:r}=gt({queryKey:["merge-requests","counts"],queryFn:async()=>{const[i,s]=await Promise.all([Oh("/tasks?status=review"),Oh("/tasks?status=closed")]);return[...i.tasks,...s.tasks].filter(_me)},refetchInterval:1e4}),n=e??[];return{counts:{all:n.filter(i=>i.metadata?.orchestrator?.mergeStatus!=="merged").length,needsReview:n.filter(i=>{const s=i.metadata?.orchestrator?.mergeStatus;return s==="pending"||s==="test_failed"}).length,testing:n.filter(i=>{const s=i.metadata?.orchestrator?.mergeStatus;return s==="testing"||s==="merging"}).length,conflicts:n.filter(i=>{const s=i.metadata?.orchestrator?.mergeStatus;return s==="conflict"||s==="failed"}).length,merged:n.filter(i=>i.metadata?.orchestrator?.mergeStatus==="merged").length},isLoading:t,error:r}}function Cme(e){switch(e){case"pending":return{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400",border:"border-amber-500"};case"testing":return{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400",border:"border-blue-500"};case"merging":return{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400",border:"border-blue-600"};case"merged":return{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400",border:"border-green-500"};case"conflict":return{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",border:"border-red-500"};case"test_failed":return{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"};case"failed":return{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",border:"border-red-600"};case"not_applicable":return{bg:"bg-gray-100 dark:bg-gray-800/50",text:"text-gray-500 dark:text-gray-400",border:"border-gray-400"};default:return{bg:"bg-gray-100 dark:bg-gray-900/30",text:"text-gray-700 dark:text-gray-400",border:"border-gray-500"}}}function FJe(){const e=ht();return Ct({mutationFn:async({taskId:t,mergeStatus:r})=>Oh(`/tasks/${t}`,{method:"PATCH",body:JSON.stringify({mergeStatus:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["merge-requests"]}),e.invalidateQueries({queryKey:["merge-request",r]}),e.invalidateQueries({queryKey:["tasks"]})}})}function UJe(){const e=ht();return Ct({mutationFn:async({taskId:t,reason:r})=>Oh(`/tasks/${t}`,{method:"DELETE",body:JSON.stringify({reason:r})}),onSuccess:()=>{e.invalidateQueries({queryKey:["merge-requests"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function HJe(){return[{value:"pending",label:"Pending Merge"},{value:"testing",label:"Testing"},{value:"merging",label:"Merging"},{value:"merged",label:"Merged"},{value:"conflict",label:"Conflict"},{value:"test_failed",label:"Tests Failed"},{value:"failed",label:"Merge Failed"},{value:"not_applicable",label:"No Merge Needed"}]}const qJe="/api";async function x2(e,t){const r=await fetch(`${qJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function m1(){return gt({queryKey:["daemon-status"],queryFn:()=>x2("/daemon/status"),refetchInterval:1e4})}function WJe(){const e=ht();return Ct({mutationFn:async()=>x2("/daemon/start",{method:"POST"}),onSuccess:()=>{e.invalidateQueries({queryKey:["daemon-status"]})}})}function KJe(){const e=ht();return Ct({mutationFn:async()=>x2("/daemon/stop",{method:"POST"}),onSuccess:()=>{e.invalidateQueries({queryKey:["daemon-status"]})}})}function GJe(){const e=ht();return Ct({mutationFn:async t=>x2("/daemon/config",{method:"PATCH",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["daemon-status"]})}})}const VJe="/api";async function YJe(e,t){const r=await fetch(`${VJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function QJe(){const e=ht();return Ct({mutationFn:async()=>YJe("/sessions/stop-all",{method:"POST",body:JSON.stringify({graceful:!0})}),onSuccess:()=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["sessions"]})}})}const JJe="/api";async function ZJe(e){if(e.length===0)return{messages:{}};const t=await fetch(`${JJe}/sessions/latest-messages?sessionIds=${e.join(",")}`);if(!t.ok)throw new Error(`Failed to fetch latest messages: HTTP ${t.status}`);return t.json()}function XJe(e){const t=[...e].sort(),r=["sessions","latest-messages",t],{data:n,isLoading:a,error:i}=gt({queryKey:r,queryFn:()=>ZJe(t),enabled:t.length>0,refetchInterval:2e3,staleTime:1e3});return{latestBySession:n?.messages??{},isLoading:a,error:i}}function eZe(){const{data:e,isLoading:t,isError:r}=m1(),n=WJe(),a=KJe(),i=n.isPending||a.isPending,s=()=>{i||(e?.isRunning?a.mutate():n.mutate())};if(t)return o.jsx("div",{className:"flex items-center gap-2 px-2 py-1.5 text-[var(--color-text-tertiary)]",children:o.jsx($e,{className:"w-4 h-4 animate-spin"})});if(r||!e?.available)return o.jsx(Cn,{content:e?.reason||"Daemon unavailable",side:"bottom",children:o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 text-[var(--color-text-tertiary)] cursor-not-allowed",children:[o.jsx(Bt,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline text-sm",children:"Autopilot"})]})});const l=e.isRunning,c=l?"Stop autopilot":"Start autopilot";return o.jsx(Cn,{content:c,side:"bottom",children:o.jsxs("button",{onClick:s,disabled:i,className:`
          flex items-center gap-2 px-2.5 py-1.5 text-sm font-medium rounded-md
          transition-colors duration-150
          ${l?"text-[var(--color-success-text)] bg-[var(--color-success)]/10 hover:bg-[var(--color-success)]/20":"text-[var(--color-text-secondary)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)]"}
          border border-[var(--color-border)]
          disabled:opacity-50 disabled:cursor-not-allowed
        `,"aria-label":c,"data-testid":"daemon-toggle",children:[i?o.jsx($e,{className:"w-4 h-4 animate-spin"}):l?o.jsx(uu,{className:"w-4 h-4"}):o.jsx(en,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline",children:i?l?"Stopping...":"Starting...":"Autopilot"}),o.jsx("div",{className:`w-2 h-2 rounded-full ${l?"bg-[var(--color-success)]":"bg-[var(--color-text-tertiary)]"}`})]})})}function tZe(){const e=QJe(),{data:t}=m2({status:"starting,running"}),r=t?.sessions?.length??0,n=r>0,a=()=>{e.isPending||!n||e.mutate()},i=e.isPending?"Stopping all agents...":n?`Stop all running agents (${r})`:"No running agents";return o.jsx(Cn,{content:i,side:"bottom",children:o.jsxs("button",{onClick:a,disabled:e.isPending||!n,className:`
          flex items-center gap-2 px-2.5 py-1.5 text-sm font-medium rounded-md
          transition-colors duration-150
          ${n?"text-[var(--color-text-secondary)] bg-[var(--color-surface)] hover:bg-[var(--color-danger)]/10 hover:text-[var(--color-danger-text)]":"text-[var(--color-text-tertiary)] bg-[var(--color-surface)]"}
          border border-[var(--color-border)]
          disabled:opacity-50 disabled:cursor-not-allowed
        `,"aria-label":i,"data-testid":"stop-all-agents-button",children:[e.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(cwe,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline",children:e.isPending?"Stopping...":"Stop All"}),n&&!e.isPending&&o.jsx("span",{className:"flex items-center justify-center min-w-[1.25rem] h-5 px-1 text-xs font-medium bg-[var(--color-danger)]/10 text-[var(--color-danger-text)] rounded-full",children:r})]})})}function rZe({type:e}){const t="w-2 h-2 rounded-full flex-shrink-0";switch(e){case"success":return o.jsx("div",{className:`${t} bg-[var(--color-success)]`});case"error":return o.jsx("div",{className:`${t} bg-[var(--color-error)]`});case"warning":return o.jsx("div",{className:`${t} bg-[var(--color-warning)]`});default:return o.jsx("div",{className:`${t} bg-[var(--color-primary)]`})}}function nZe({notification:e,onMarkAsRead:t,onDismiss:r,onNavigate:n}){return o.jsx("div",{className:`
        group relative px-4 py-3 border-b border-[var(--color-border)] last:border-b-0
        hover:bg-[var(--color-surface-hover)] transition-colors duration-150
        ${e.read?"opacity-60":""}
      `,"data-testid":`notification-${e.id}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(rZe,{type:e.type}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("p",{className:`text-sm font-medium text-[var(--color-text)] truncate ${e.read?"":"font-semibold"}`,children:e.title}),!e.read&&o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-[var(--color-primary)] flex-shrink-0"})]}),e.message&&o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] mt-0.5 line-clamp-2",children:e.message}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-1",children:EB(e.timestamp)})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.navigateTo&&n&&o.jsx("button",{onClick:a=>{a.stopPropagation(),n()},className:"p-1 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-active)] transition-colors",title:"View details","aria-label":"View details",children:o.jsx(Sl,{className:"w-3.5 h-3.5"})}),!e.read&&o.jsx("button",{onClick:a=>{a.stopPropagation(),t()},className:"p-1 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-active)] transition-colors",title:"Mark as read","aria-label":"Mark as read",children:o.jsx(Vn,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:a=>{a.stopPropagation(),r()},className:"p-1 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-surface-active)] transition-colors",title:"Dismiss","aria-label":"Dismiss notification",children:o.jsx(wt,{className:"w-3.5 h-3.5"})})]})]})})}function aZe({notifications:e,unreadCount:t,isConnected:r,onMarkAsRead:n,onMarkAllAsRead:a,onDismiss:i,onClearAll:s,onOpenSettings:l}){const[c,u]=w.useState(!1),d=w.useRef(null),f=Ma();w.useEffect(()=>{function p(v){d.current&&!d.current.contains(v.target)&&u(!1)}if(c)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[c]),w.useEffect(()=>{function p(v){v.key==="Escape"&&u(!1)}if(c)return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[c]);const m=w.useCallback(p=>{p.navigateTo&&(n(p.id),u(!1),f({to:p.navigateTo}))},[f,n]);return o.jsxs("div",{ref:d,className:"relative","data-testid":"notification-center",children:[o.jsxs("button",{onClick:()=>u(!c),className:`
          relative p-2 rounded-md transition-colors duration-150
          ${c?"bg-[var(--color-surface-active)] text-[var(--color-text)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
        `,"aria-label":`Notifications ${t>0?`(${t} unread)`:""}`,"aria-expanded":c,"aria-haspopup":"true","data-testid":"notification-bell",children:[r?o.jsx(CO,{className:"w-5 h-5"}):o.jsx(uwe,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),t>0&&o.jsx("span",{className:"absolute -top-0.5 -right-0.5 flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-bold text-white bg-[var(--color-error)] rounded-full","data-testid":"notification-badge",children:t>99?"99+":t})]}),c&&o.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-[var(--color-surface)] rounded-lg shadow-lg border border-[var(--color-border)] overflow-hidden z-50",role:"menu","aria-label":"Notifications","data-testid":"notification-dropdown",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-[var(--color-surface-elevated)] border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)]",children:"Notifications"}),!r&&o.jsx("span",{className:"text-xs text-[var(--color-warning-text)] bg-[var(--color-warning-muted)] px-1.5 py-0.5 rounded",children:"Offline"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[t>0&&o.jsx("button",{onClick:a,className:"p-1.5 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Mark all as read","aria-label":"Mark all as read",children:o.jsx(YC,{className:"w-4 h-4"})}),e.length>0&&o.jsx("button",{onClick:s,className:"p-1.5 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Clear all","aria-label":"Clear all notifications",children:o.jsx(Sr,{className:"w-4 h-4"})}),l&&o.jsx("button",{onClick:()=>{u(!1),l()},className:"p-1.5 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Notification settings","aria-label":"Notification settings",children:o.jsx(li,{className:"w-4 h-4"})})]})]}),o.jsx("div",{className:"max-h-96 overflow-y-auto","data-testid":"notification-list",children:e.length===0?o.jsxs("div",{className:"px-4 py-8 text-center text-[var(--color-text-secondary)]",children:[o.jsx(CO,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No notifications"}),o.jsx("p",{className:"text-xs mt-1",children:"You're all caught up!"})]}):e.slice(0,20).map(p=>o.jsx(nZe,{notification:p,onMarkAsRead:()=>n(p.id),onDismiss:()=>i(p.id),onNavigate:p.navigateTo?()=>m(p):void 0},p.id))}),e.length>20&&o.jsx("div",{className:"px-4 py-2 bg-[var(--color-surface-elevated)] border-t border-[var(--color-border)] text-center",children:o.jsxs("span",{className:"text-xs text-[var(--color-text-secondary)]",children:["Showing 20 of ",e.length," notifications"]})})]})]})}const iZe={navigation:{label:"Navigation",icon:qh},tasks:{label:"Tasks",icon:Tl},agents:{label:"Agents",icon:Xr},workflows:{label:"Workflows",icon:vh},actions:{label:"Quick Actions",icon:en},settings:{label:"Settings",icon:li}};function sZe({open:e,onOpenChange:t}){const r=Dae(),[n,a]=w.useState("");w.useEffect(()=>{e||a("")},[e]);const i=w.useCallback((d,f)=>{r.navigate({to:d,search:f}),t(!1)},[r,t]),s=w.useCallback(d=>{const f=document.documentElement;if(localStorage.setItem("theme",d),d==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches;f.classList.toggle("dark",m)}else f.classList.toggle("dark",d==="dark");t(!1)},[t]),c=[{id:"nav-activity",label:"Go to Activity",description:"View real-time activity feed",category:"navigation",icon:Hh,keywords:["home","feed","events","activity"],action:()=>i("/activity"),shortcut:"G A"},{id:"nav-tasks",label:"Go to Tasks",description:"View and manage tasks",category:"navigation",icon:Tl,keywords:["tasks","todos","work","items"],action:()=>i("/tasks"),shortcut:"G T"},{id:"nav-agents",label:"Go to Agents",description:"View and manage agents",category:"navigation",icon:Ii,keywords:["agents","workers","director","steward"],action:()=>i("/agents"),shortcut:"G E"},{id:"nav-stewards",label:"Go to Stewards",description:"View steward agents",category:"navigation",icon:Zo,keywords:["stewards","automation","merge","health"],action:()=>i("/agents",{tab:"stewards"})},{id:"nav-workspaces",label:"Go to Workspaces",description:"Terminal multiplexer view",category:"navigation",icon:bh,keywords:["workspaces","terminal","multiplexer","panes"],action:()=>i("/workspaces"),shortcut:"G W"},{id:"nav-workflows",label:"Go to Workflows",description:"View workflow templates",category:"navigation",icon:vh,keywords:["workflows","templates","playbooks"],action:()=>i("/workflows"),shortcut:"G F"},{id:"nav-metrics",label:"Go to Metrics",description:"View performance metrics",category:"navigation",icon:GC,keywords:["metrics","analytics","stats","performance","dashboard"],action:()=>i("/metrics"),shortcut:"G M"},{id:"nav-settings",label:"Go to Settings",description:"App preferences and configuration",category:"navigation",icon:li,keywords:["settings","preferences","config","options"],action:()=>i("/settings"),shortcut:"G S"},{id:"nav-plans",label:"Go to Plans",description:"View and manage plans",category:"navigation",icon:tu,keywords:["plans","roadmap","milestones","goals"],action:()=>i("/plans"),shortcut:"G P"},{id:"nav-merge-requests",label:"Go to Merge Requests",description:"Review and merge agent work",category:"navigation",icon:Ri,keywords:["merge","requests","pr","pull","review","git"],action:()=>i("/merge-requests"),shortcut:"G R"},{id:"task-create",label:"Create Task",description:"Create a new task",category:"tasks",icon:_r,keywords:["create","new","task","add"],action:()=>i("/tasks",{action:"create"}),shortcut:"C T"},{id:"task-unassigned",label:"View Unassigned Tasks",description:"Tasks waiting for assignment",category:"tasks",icon:tn,keywords:["unassigned","pending","queue","backlog"],action:()=>i("/tasks",{status:"unassigned"})},{id:"task-in-progress",label:"View In Progress Tasks",description:"Tasks currently being worked on",category:"tasks",icon:en,keywords:["progress","active","working","running"],action:()=>i("/tasks",{status:"in_progress"})},{id:"task-awaiting-merge",label:"View Awaiting Merge",description:"Tasks ready for merge review",category:"tasks",icon:cu,keywords:["merge","review","pr","pull request","awaiting"],action:()=>i("/tasks",{status:"awaiting_merge"})},{id:"agent-create",label:"Create Agent",description:"Register a new agent",category:"agents",icon:_r,keywords:["create","new","agent","worker","register"],action:()=>i("/agents",{action:"create"}),shortcut:"C A"},{id:"agent-create-steward",label:"Create Steward",description:"Create a new steward agent",category:"agents",icon:Zo,keywords:["create","steward","automation","merge","health"],action:()=>i("/agents",{tab:"stewards",action:"create"})},{id:"agent-start-all",label:"Start All Agents",description:"Start all registered agents",category:"agents",icon:en,keywords:["start","all","agents","boot"],action:()=>{i("/agents")}},{id:"agent-stop-all",label:"Stop All Agents",description:"Stop all running agents",category:"agents",icon:uu,keywords:["stop","all","agents","halt","shutdown"],action:()=>{i("/agents")}},{id:"workflow-templates",label:"View Templates",description:"Browse workflow templates",category:"workflows",icon:rn,keywords:["templates","playbooks","workflows"],action:()=>i("/workflows",{tab:"templates"})},{id:"workflow-active",label:"View Active Workflows",description:"Running workflow instances",category:"workflows",icon:jr,keywords:["active","running","workflows","instances"],action:()=>i("/workflows",{tab:"active"})},{id:"action-refresh",label:"Refresh Data",description:"Refresh all data from server",category:"actions",icon:jr,keywords:["refresh","reload","sync","update"],action:()=>{window.location.reload()},shortcut:"R"},{id:"action-open-terminal",label:"Open Director Terminal",description:"Open the Director terminal panel",category:"actions",icon:na,keywords:["terminal","director","console","cli"],action:()=>{window.dispatchEvent(new CustomEvent("toggle-director-panel")),t(!1)},shortcut:"T"},{id:"action-maximize-director",label:"Maximize Director Panel",description:"Toggle maximize/restore the Director panel",category:"actions",icon:JC,keywords:["maximize","fullscreen","director","terminal","restore","minimize"],action:()=>{window.dispatchEvent(new CustomEvent("maximize-director-panel")),t(!1)}},{id:"settings-preferences",label:"Preferences",description:"User preferences",category:"settings",icon:li,keywords:["preferences","settings","options"],action:()=>i("/settings",{tab:"preferences"})},{id:"settings-workspace",label:"Workspace Settings",description:"Workspace configuration",category:"settings",icon:bh,keywords:["workspace","config","settings"],action:()=>i("/settings",{tab:"workspace"})},{id:"theme-light",label:"Switch to Light Theme",description:"Use light color theme",category:"settings",icon:Zk,keywords:["light","theme","bright","day"],action:()=>s("light")},{id:"theme-dark",label:"Switch to Dark Theme",description:"Use dark color theme",category:"settings",icon:Jk,keywords:["dark","theme","night"],action:()=>s("dark")},{id:"theme-system",label:"Use System Theme",description:"Follow system color preference",category:"settings",icon:E6,keywords:["system","theme","auto","automatic"],action:()=>s("system")}].reduce((d,f)=>(d[f.category]||(d[f.category]=[]),d[f.category].push(f),d),{}),u=["navigation","tasks","agents","workflows","actions","settings"];return o.jsxs(Xi.Dialog,{open:e,onOpenChange:t,label:"Command Palette",className:"fixed inset-0 z-[var(--z-index-modal)] flex items-start justify-center pt-[20vh]","data-testid":"command-palette",children:[o.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] backdrop-blur-sm",onClick:()=>t(!1),"data-testid":"command-palette-backdrop"}),o.jsxs("div",{className:"relative w-full max-w-lg bg-[var(--color-bg-elevated)] rounded-xl shadow-2xl border border-[var(--color-border)] overflow-hidden","data-testid":"command-palette-dialog",children:[o.jsxs("div",{className:"flex items-center gap-3 px-4 border-b border-[var(--color-border)]",children:[o.jsx(br,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),o.jsx(Xi.Input,{value:n,onValueChange:a,placeholder:"Type a command or search...",className:"flex-1 h-14 bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:outline-none text-base","data-testid":"command-palette-input"}),o.jsx("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:"ESC"})]}),o.jsxs(Xi.List,{className:"max-h-[400px] overflow-y-auto p-2","data-testid":"command-palette-list",children:[o.jsx(Xi.Empty,{className:"py-6 text-center text-sm text-[var(--color-text-muted)]",children:"No results found."}),u.map(d=>{const f=c[d];if(!f||f.length===0)return null;const m=iZe[d];return o.jsxs(Xi.Group,{heading:m.label,className:"mb-2","data-testid":`command-group-${d}`,children:[o.jsx("div",{className:"px-2 py-1.5 text-xs font-medium text-[var(--color-text-muted)] uppercase tracking-wider",children:m.label}),f.map(p=>o.jsx(oZe,{command:p,onSelect:()=>p.action()},p.id))]},d)})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Select"})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:"K"})," ","to open"]})]})]})]})}function oZe({command:e,onSelect:t}){const r=e.icon;return o.jsxs(Xi.Item,{value:[e.label,e.description,...e.keywords||[]].join(" "),onSelect:t,className:"flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text)] data-[selected=true]:bg-[var(--color-surface-selected)] data-[selected=true]:text-[var(--color-text)] transition-colors duration-100","data-testid":`command-item-${e.id}`,children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-md bg-[var(--color-surface)] text-[var(--color-text-muted)]",children:o.jsx(r,{className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:e.label}),e.description&&o.jsx("div",{className:"text-xs text-[var(--color-text-muted)] truncate",children:e.description})]}),e.shortcut&&o.jsx("kbd",{className:"hidden sm:block px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:e.shortcut})]})}function lZe(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=n=>{(n.metaKey||n.ctrlKey)&&n.key==="k"&&(n.preventDefault(),t(a=>!a))};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),{open:e,setOpen:t}}function cZe(){const e=gt({queryKey:["entities","humans"],queryFn:async()=>{const t=await fetch("/api/entities?entityType=human&limit=10000");if(!t.ok)throw new Error("Failed to fetch entities");return(await t.json()).items||[]}});return{data:e.data,isLoading:e.isLoading}}function uZe({children:e}){return o.jsx(e_e,{useHumanEntities:cZe,children:e})}const ua={js:{language:"javascript",category:"code",displayName:"JavaScript"},jsx:{language:"javascript",category:"code",displayName:"JavaScript JSX"},mjs:{language:"javascript",category:"code",displayName:"JavaScript Module"},cjs:{language:"javascript",category:"code",displayName:"CommonJS"},ts:{language:"typescript",category:"code",displayName:"TypeScript"},tsx:{language:"typescript",category:"code",displayName:"TypeScript JSX"},mts:{language:"typescript",category:"code",displayName:"TypeScript Module"},cts:{language:"typescript",category:"code",displayName:"CommonJS TypeScript"},html:{language:"html",category:"code",displayName:"HTML"},htm:{language:"html",category:"code",displayName:"HTML"},xhtml:{language:"html",category:"code",displayName:"XHTML"},css:{language:"css",category:"style",displayName:"CSS"},scss:{language:"scss",category:"style",displayName:"SCSS"},sass:{language:"scss",category:"style",displayName:"Sass"},less:{language:"less",category:"style",displayName:"Less"},stylus:{language:"stylus",category:"style",displayName:"Stylus"},json:{language:"json",category:"data",displayName:"JSON"},jsonc:{language:"json",category:"data",displayName:"JSON with Comments"},json5:{language:"json",category:"data",displayName:"JSON5"},yaml:{language:"yaml",category:"data",displayName:"YAML"},yml:{language:"yaml",category:"data",displayName:"YAML"},xml:{language:"xml",category:"data",displayName:"XML"},svg:{language:"xml",category:"data",displayName:"SVG"},toml:{language:"ini",category:"config",displayName:"TOML"},ini:{language:"ini",category:"config",displayName:"INI"},conf:{language:"ini",category:"config",displayName:"Config"},cfg:{language:"ini",category:"config",displayName:"Config"},properties:{language:"ini",category:"config",displayName:"Properties"},env:{language:"shell",category:"config",displayName:"Environment"},md:{language:"markdown",category:"document",displayName:"Markdown"},mdx:{language:"markdown",category:"document",displayName:"MDX"},markdown:{language:"markdown",category:"document",displayName:"Markdown"},rst:{language:"restructuredtext",category:"document",displayName:"reStructuredText"},txt:{language:"plaintext",category:"document",displayName:"Plain Text"},text:{language:"plaintext",category:"document",displayName:"Plain Text"},py:{language:"python",category:"code",displayName:"Python"},pyw:{language:"python",category:"code",displayName:"Python"},pyx:{language:"python",category:"code",displayName:"Cython"},pyi:{language:"python",category:"code",displayName:"Python Stub"},ipynb:{language:"json",category:"code",displayName:"Jupyter Notebook"},rb:{language:"ruby",category:"code",displayName:"Ruby"},rake:{language:"ruby",category:"code",displayName:"Rake"},gemspec:{language:"ruby",category:"code",displayName:"Gemspec"},erb:{language:"html",category:"code",displayName:"ERB"},sh:{language:"shell",category:"script",displayName:"Shell"},bash:{language:"shell",category:"script",displayName:"Bash"},zsh:{language:"shell",category:"script",displayName:"Zsh"},fish:{language:"shell",category:"script",displayName:"Fish"},ksh:{language:"shell",category:"script",displayName:"Ksh"},ps1:{language:"powershell",category:"script",displayName:"PowerShell"},psm1:{language:"powershell",category:"script",displayName:"PowerShell Module"},bat:{language:"bat",category:"script",displayName:"Batch"},cmd:{language:"bat",category:"script",displayName:"Command"},go:{language:"go",category:"code",displayName:"Go"},mod:{language:"go",category:"config",displayName:"Go Module"},rs:{language:"rust",category:"code",displayName:"Rust"},c:{language:"c",category:"code",displayName:"C"},h:{language:"c",category:"code",displayName:"C Header"},cpp:{language:"cpp",category:"code",displayName:"C++"},cc:{language:"cpp",category:"code",displayName:"C++"},cxx:{language:"cpp",category:"code",displayName:"C++"},hpp:{language:"cpp",category:"code",displayName:"C++ Header"},hxx:{language:"cpp",category:"code",displayName:"C++ Header"},hh:{language:"cpp",category:"code",displayName:"C++ Header"},java:{language:"java",category:"code",displayName:"Java"},kt:{language:"kotlin",category:"code",displayName:"Kotlin"},kts:{language:"kotlin",category:"code",displayName:"Kotlin Script"},scala:{language:"scala",category:"code",displayName:"Scala"},sc:{language:"scala",category:"code",displayName:"Scala"},groovy:{language:"groovy",category:"code",displayName:"Groovy"},gradle:{language:"groovy",category:"config",displayName:"Gradle"},cs:{language:"csharp",category:"code",displayName:"C#"},csx:{language:"csharp",category:"code",displayName:"C# Script"},fs:{language:"fsharp",category:"code",displayName:"F#"},fsx:{language:"fsharp",category:"code",displayName:"F# Script"},vb:{language:"vb",category:"code",displayName:"Visual Basic"},php:{language:"php",category:"code",displayName:"PHP"},phtml:{language:"php",category:"code",displayName:"PHP Template"},swift:{language:"swift",category:"code",displayName:"Swift"},m:{language:"objective-c",category:"code",displayName:"Objective-C"},mm:{language:"objective-c",category:"code",displayName:"Objective-C++"},r:{language:"r",category:"code",displayName:"R"},lua:{language:"lua",category:"code",displayName:"Lua"},pl:{language:"perl",category:"code",displayName:"Perl"},pm:{language:"perl",category:"code",displayName:"Perl Module"},ex:{language:"elixir",category:"code",displayName:"Elixir"},exs:{language:"elixir",category:"code",displayName:"Elixir Script"},erl:{language:"erlang",category:"code",displayName:"Erlang"},hrl:{language:"erlang",category:"code",displayName:"Erlang Header"},clj:{language:"clojure",category:"code",displayName:"Clojure"},cljs:{language:"clojure",category:"code",displayName:"ClojureScript"},cljc:{language:"clojure",category:"code",displayName:"Clojure Common"},edn:{language:"clojure",category:"data",displayName:"EDN"},hs:{language:"haskell",category:"code",displayName:"Haskell"},lhs:{language:"haskell",category:"code",displayName:"Literate Haskell"},ml:{language:"fsharp",category:"code",displayName:"OCaml"},mli:{language:"fsharp",category:"code",displayName:"OCaml Interface"},vue:{language:"vue",category:"code",displayName:"Vue"},svelte:{language:"svelte",category:"code",displayName:"Svelte"},astro:{language:"astro",category:"code",displayName:"Astro"},sql:{language:"sql",category:"data",displayName:"SQL"},mysql:{language:"mysql",category:"data",displayName:"MySQL"},pgsql:{language:"pgsql",category:"data",displayName:"PostgreSQL"},graphql:{language:"graphql",category:"data",displayName:"GraphQL"},gql:{language:"graphql",category:"data",displayName:"GraphQL"},dockerfile:{language:"dockerfile",category:"config",displayName:"Dockerfile"},makefile:{language:"makefile",category:"config",displayName:"Makefile"},cmake:{language:"cmake",category:"config",displayName:"CMake"},ninja:{language:"plaintext",category:"config",displayName:"Ninja"},tf:{language:"hcl",category:"config",displayName:"Terraform"},tfvars:{language:"hcl",category:"config",displayName:"Terraform Variables"},hcl:{language:"hcl",category:"config",displayName:"HCL"},prisma:{language:"graphql",category:"config",displayName:"Prisma"},diff:{language:"diff",category:"other",displayName:"Diff"},patch:{language:"diff",category:"other",displayName:"Patch"},log:{language:"log",category:"other",displayName:"Log"},csv:{language:"plaintext",category:"data",displayName:"CSV"},tsv:{language:"plaintext",category:"data",displayName:"TSV"}},lX={dockerfile:{language:"dockerfile",category:"config",displayName:"Dockerfile"},"dockerfile.dev":{language:"dockerfile",category:"config",displayName:"Dockerfile"},"dockerfile.prod":{language:"dockerfile",category:"config",displayName:"Dockerfile"},"dockerfile.test":{language:"dockerfile",category:"config",displayName:"Dockerfile"},makefile:{language:"makefile",category:"config",displayName:"Makefile"},gnumakefile:{language:"makefile",category:"config",displayName:"Makefile"},cmakelists:{language:"cmake",category:"config",displayName:"CMake"},gemfile:{language:"ruby",category:"config",displayName:"Gemfile"},rakefile:{language:"ruby",category:"config",displayName:"Rakefile"},vagrantfile:{language:"ruby",category:"config",displayName:"Vagrantfile"},guardfile:{language:"ruby",category:"config",displayName:"Guardfile"},podfile:{language:"ruby",category:"config",displayName:"Podfile"},fastfile:{language:"ruby",category:"config",displayName:"Fastfile"},appfile:{language:"ruby",category:"config",displayName:"Appfile"},berksfile:{language:"ruby",category:"config",displayName:"Berksfile"},brewfile:{language:"ruby",category:"config",displayName:"Brewfile"},procfile:{language:"yaml",category:"config",displayName:"Procfile"},justfile:{language:"makefile",category:"config",displayName:"Justfile"},jenkinsfile:{language:"groovy",category:"config",displayName:"Jenkinsfile"},"package.json":{language:"json",category:"config",displayName:"package.json"},"tsconfig.json":{language:"json",category:"config",displayName:"tsconfig.json"},"jsconfig.json":{language:"json",category:"config",displayName:"jsconfig.json"},".babelrc":{language:"json",category:"config",displayName:"Babel Config"},".eslintrc":{language:"json",category:"config",displayName:"ESLint Config"},".prettierrc":{language:"json",category:"config",displayName:"Prettier Config"},".editorconfig":{language:"ini",category:"config",displayName:"EditorConfig"},".gitignore":{language:"ignore",category:"config",displayName:"Git Ignore"},".dockerignore":{language:"ignore",category:"config",displayName:"Docker Ignore"},".npmignore":{language:"ignore",category:"config",displayName:"NPM Ignore"},".gitattributes":{language:"properties",category:"config",displayName:"Git Attributes"},".gitmodules":{language:"ini",category:"config",displayName:"Git Modules"},license:{language:"plaintext",category:"document",displayName:"License"},readme:{language:"markdown",category:"document",displayName:"README"},changelog:{language:"markdown",category:"document",displayName:"Changelog"},authors:{language:"plaintext",category:"document",displayName:"Authors"},contributors:{language:"plaintext",category:"document",displayName:"Contributors"},copying:{language:"plaintext",category:"document",displayName:"Copying"}},jme={language:"plaintext",category:"other",displayName:"Plain Text"};function dZe(e){if(e.endsWith(".d.ts")||e.endsWith(".d.mts")||e.endsWith(".d.cts")||e.endsWith(".test.ts")||e.endsWith(".spec.ts"))return"ts";if(e.endsWith(".test.tsx")||e.endsWith(".spec.tsx"))return"tsx";if(e.endsWith(".test.js")||e.endsWith(".spec.js"))return"js";if(e.endsWith(".test.jsx")||e.endsWith(".spec.jsx"))return"jsx";if(e.endsWith(".config.js")||e.endsWith(".config.ts"))return e.endsWith(".ts")?"ts":"js";const t=e.split(".");return t.length<2?"":t[t.length-1].toLowerCase()}function p1(e){const t=e.split("/").pop()||e,r=t.toLowerCase();if(lX[r])return lX[r];if(r.startsWith("dockerfile"))return ua.dockerfile;if(r.endsWith(".d.ts"))return{language:"typescript",category:"code",displayName:"TypeScript Declaration"};const n=dZe(t);return n&&ua[n]?ua[n]:r.startsWith(".")&&ua[r.slice(1)]?ua[r.slice(1)]:jme}function fZe(e){const t=e.toLowerCase();return t.includes("javascript")||t==="js"?ua.js:t.includes("typescript")||t==="ts"?ua.ts:t.includes("json")?ua.json:t.includes("markdown")||t==="md"?ua.md:t.includes("html")?ua.html:t.includes("css")?ua.css:t.includes("python")||t==="py"?ua.py:t.includes("yaml")||t.includes("yml")?ua.yaml:t.includes("xml")?ua.xml:t.includes("sql")?ua.sql:t.includes("shell")||t.includes("bash")||t==="sh"?ua.sh:t.includes("ruby")||t==="rb"?ua.rb:t.includes("go")?ua.go:t.includes("rust")||t==="rs"?ua.rs:t.includes("java")&&!t.includes("javascript")?ua.java:jme}function LP(e){return p1(e).language}function hZe(e,t){if(e){const r=fZe(e);if(r.language!=="plaintext")return r.language}return t?LP(t):"plaintext"}function mZe(e){const t=p1(e);return t.category==="code"||t.category==="script"}function Eme(e){return p1(e).category==="config"}function pZe(e){const t=p1(e).category;return t==="data"||t==="document"}const Bv=["workspace","tree"],gZe=3e4;function Mme(e){return{id:e.path,name:e.name,type:e.type,path:e.path,size:e.size,lastModified:e.lastModified,children:e.children?.map(Mme)}}function vZe(e){return e.length===0?null:"Workspace"}function bZe(){const e=ht(),[t,r]=w.useState(null),{data:n,isLoading:a,isError:i,error:s,refetch:l}=gt({queryKey:Bv,queryFn:async()=>{const j=await fetch("/api/workspace/tree");if(!j.ok){const T=await j.json().catch(()=>({error:{message:"Failed to fetch workspace tree"}}));throw new Error(T.error?.message||`HTTP ${j.status}`)}const E=await j.json();if(E.error)throw new Error(E.error.message);return{entries:E.entries.map(Mme),root:E.root??null}},staleTime:gZe,retry:2,refetchOnWindowFocus:!1}),c=n?.entries??[],u=n?.root??null,d=c.length>0,f=vZe(c);w.useEffect(()=>{i&&s?r(s instanceof Error?s.message:"Failed to load workspace"):i||r(null)},[i,s]);const m=w.useCallback(async()=>{r(null);try{await l()}catch(j){r(j instanceof Error?j.message:"Failed to open workspace")}},[l]),p=w.useCallback(()=>{e.removeQueries({queryKey:Bv})},[e]),v=w.useCallback(async()=>{r(null);try{await l()}catch(j){r(j instanceof Error?j.message:"Failed to refresh workspace")}},[l]),b=w.useCallback(async j=>{if(j.type!=="file")throw new Error("Cannot read content of a directory");const E=await fetch(`/api/workspace/file?path=${encodeURIComponent(j.path)}`);if(!E.ok){const O=await E.json().catch(()=>({error:{message:"Failed to read file"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();if(T.error)throw new Error(T.error.message);return{content:T.content,name:T.name,path:T.path,size:T.size,lastModified:T.lastModified,language:LP(T.name)}},[]),y=w.useCallback(async j=>{try{const E=await fetch(`/api/workspace/file?path=${encodeURIComponent(j)}`);if(!E.ok){if(E.status===404)return null;const O=await E.json().catch(()=>({error:{message:"Failed to read file"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();return T.error?null:{content:T.content,name:T.name,path:T.path,size:T.size,lastModified:T.lastModified,language:LP(T.name)}}catch{return null}},[]),S=w.useCallback(async(j,E)=>{if(j.type!=="file")throw new Error("Cannot write to a directory");const T=await fetch("/api/workspace/file",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:j.path,content:E})});if(!T.ok){const R=await T.json().catch(()=>({error:{message:"Failed to write file"}}));throw new Error(R.error?.message||`HTTP ${T.status}`)}const O=await T.json();if(O.error)throw new Error(O.error.message);return{success:O.success,path:O.path,bytesWritten:O.bytesWritten}},[]),_=w.useCallback(async j=>{const E=await fetch(`/api/workspace/file?path=${encodeURIComponent(j)}`,{method:"DELETE"});if(!E.ok){const O=await E.json().catch(()=>({error:{message:"Failed to delete file"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();if(T.error)throw new Error(T.error.message);return await e.invalidateQueries({queryKey:Bv}),{success:T.success,path:T.path}},[e]),N=w.useCallback(async(j,E)=>{const T=await fetch("/api/workspace/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldPath:j,newPath:E})});if(!T.ok){const R=await T.json().catch(()=>({error:{message:"Failed to rename file"}}));throw new Error(R.error?.message||`HTTP ${T.status}`)}const O=await T.json();if(O.error)throw new Error(O.error.message);return await e.invalidateQueries({queryKey:Bv}),{success:O.success,oldPath:O.oldPath,newPath:O.newPath}},[e]),k=w.useCallback(async j=>{const E=await fetch("/api/workspace/mkdir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:j})});if(!E.ok){const O=await E.json().catch(()=>({error:{message:"Failed to create folder"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();if(T.error)throw new Error(T.error.message);return await e.invalidateQueries({queryKey:Bv}),{success:T.success,path:T.path}},[e]);return{isSupported:!0,isOpen:d,workspaceName:f,workspaceRoot:u,entries:c,isLoading:a,error:t,openWorkspace:m,closeWorkspace:p,refreshTree:v,readFile:b,readFileByPath:y,writeFile:S,deleteFile:_,renameFile:N,createFolder:k}}const Tme=w.createContext(null);function yZe({children:e}){const t=bZe();return o.jsx(Tme.Provider,{value:t,children:e})}function g1(){const e=w.useContext(Tme);if(!e)throw new Error("useWorkspace must be used within a WorkspaceProvider");return e}function xZe(e){const t=e.split(".").pop()?.toLowerCase()||"";return new Set(["js","jsx","ts","tsx","mjs","cjs","mts","cts","json","jsonc","json5","py","pyw","pyx","go","rs","java","kt","kts","c","cpp","cc","cxx","h","hpp","hxx","cs","php","rb","swift","r","lua","pl","pm","ex","exs","erl","hrl","clj","cljs","scala","vue","svelte","astro","html","htm","css","scss","sass","less","yaml","yml","toml","xml","svg","sql","graphql","gql","sh","bash","zsh","fish","ps1","dockerfile","makefile","cmake"]).has(t)?Bs:rn}function wZe(e){const t=e.split(".").pop()?.toLowerCase()||"";return{ts:"TypeScript",tsx:"TypeScript React",js:"JavaScript",jsx:"JavaScript React",py:"Python",go:"Go",rs:"Rust",java:"Java",json:"JSON",yaml:"YAML",yml:"YAML",md:"Markdown",html:"HTML",css:"CSS",scss:"SCSS",sql:"SQL",sh:"Shell",toml:"TOML"}[t]||null}function Ame(e,t=0){const r=[];for(const n of e)r.push({id:n.id,name:n.name,path:n.path,type:n.type,depth:t}),n.children&&n.children.length>0&&r.push(...Ame(n.children,t+1));return r}function SZe({open:e,onOpenChange:t}){const r=Ma(),[n,a]=w.useState(""),i=w.useRef(null),{isOpen:s,workspaceName:l,entries:c,isLoading:u,error:d}=g1();w.useEffect(()=>{e||a("")},[e]),w.useEffect(()=>{e&&i.current&&i.current.focus()},[e]);const f=w.useMemo(()=>!s||c.length===0?[]:Ame(c).filter(v=>v.type==="file"),[s,c]),m=w.useCallback(v=>{r({to:"/editor",search:{file:v.path}}),t(!1)},[r,t]),p=v=>{const b=v.split("/");return b.length<=1?"":b.slice(0,-1).join("/")};return e?o.jsxs(Xi.Dialog,{open:e,onOpenChange:t,label:"Quick File Open",className:"fixed inset-0 z-[var(--z-index-modal)] flex items-start justify-center pt-[15vh]","data-testid":"quick-file-open",children:[o.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] backdrop-blur-sm",onClick:()=>t(!1),"data-testid":"quick-file-open-backdrop"}),o.jsxs("div",{className:"relative w-full max-w-2xl bg-[var(--color-bg-elevated)] rounded-xl shadow-2xl border border-[var(--color-border)] overflow-hidden","data-testid":"quick-file-open-dialog",children:[o.jsxs("div",{className:"flex items-center gap-3 px-4 border-b border-[var(--color-border)]",children:[o.jsx(br,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),o.jsx(Xi.Input,{ref:i,value:n,onValueChange:a,placeholder:s?"Search files by name...":"Open a workspace to search files...",className:"flex-1 h-14 bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:outline-none text-base","data-testid":"quick-file-open-input",disabled:!s}),o.jsxs("div",{className:"flex items-center gap-2",children:[l&&o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] px-2 py-1 rounded max-w-[120px] truncate",children:l}),o.jsx("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:"ESC"})]})]}),o.jsxs(Xi.List,{className:"max-h-[400px] overflow-y-auto","data-testid":"quick-file-open-list",children:[u&&o.jsxs("div",{className:"flex items-center justify-center py-10",children:[o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"}),o.jsx("span",{className:"ml-2 text-sm text-[var(--color-text-muted)]",children:"Loading workspace..."})]}),d&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:d})]}),!u&&!d&&!s&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx($e,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4 animate-spin"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Loading Workspace"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"The workspace is loading from the server..."})]}),!u&&!d&&s&&f.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(L6,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"No Files Found"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"The workspace doesn't contain any readable files."})]}),!u&&!d&&s&&f.length>0&&o.jsx(Xi.Empty,{className:"py-10 text-center text-sm text-[var(--color-text-muted)]",children:"No files match your search."}),!u&&!d&&s&&f.length>0&&o.jsx("div",{className:"p-2",children:f.map(v=>{const b=xZe(v.name),y=p(v.path),S=wZe(v.name);return o.jsxs(Xi.Item,{value:`${v.name} ${v.path}`,onSelect:()=>m(v),className:"flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text)] data-[selected=true]:bg-[var(--color-surface-selected)] data-[selected=true]:text-[var(--color-text)] transition-colors duration-100","data-testid":`quick-file-item-${v.id}`,children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-md bg-[var(--color-surface)] text-[var(--color-text-muted)]",children:o.jsx(b,{className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium truncate",children:v.name}),S&&o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 bg-[var(--color-surface)] text-[var(--color-text-muted)] rounded",children:S})]}),y&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-[var(--color-text-muted)] truncate mt-0.5",children:[o.jsx(gn,{className:"w-3 h-3"}),o.jsx("span",{children:y})]})]})]},v.id)})})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Open file"})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:"P"})," ","to toggle"]})]})]})]}):null}function kZe(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=n=>{(n.metaKey||n.ctrlKey)&&n.key==="p"&&(n.preventDefault(),t(a=>!a))};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),{open:e,setOpen:t}}function _Ze(e={}){const{onToggleSidebar:t,onToggleDirector:r,onToggleDirectorMaximize:n,onOpenCommandPalette:a}=e,i=Ma(),s=Jx(),l=w.useCallback(c=>()=>{const[u,d]=c.split("?");if(d){const f=new URLSearchParams(d),m={};f.forEach((p,v)=>{m[v]=p}),i({to:u,search:m})}else i({to:c})},[i]);w.useEffect(()=>{const c=zp();c.start();const u=[];for(const[d,f]of Object.entries(ix)){const m=Jz(d,ix);if(m){if(d==="action.commandPalette"){a&&(c.register(m,a,f.description),u.push(m));continue}if(d==="action.toggleSidebar"){t&&(c.register(m,t,f.description),u.push(m));continue}if(d==="action.toggleDirector"){r&&(c.register(m,r,f.description),u.push(m));continue}if(d==="action.toggleDirectorMaximize"){n&&(c.register(m,n,f.description),u.push(m));continue}f.path&&(c.register(m,l(f.path),f.description||`Navigate to ${f.path}`),u.push(m))}}return()=>{u.forEach(d=>{c.unregister(d)})}},[l,t,r,n,a,s])}function cX(e){const{data:t,targetId:r,pageSize:n,getId:a}=e,i=t.findIndex(c=>a(c)===r);if(i===-1)return{found:!1,index:-1,page:1,indexOnPage:-1};const s=Math.floor(i/n)+1,l=i%n;return{found:!0,index:i,page:s,indexOnPage:l}}const DB=2e3,uX="deep-link-highlight";function NZe(e,t=DB){e.classList.add(uX),e.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{e.classList.remove(uX)},t)}function CZe(e,t=DB){const r=document.querySelector(`[data-testid="${e}"]`);return r?(NZe(r,t),!0):!1}function jZe(e){const{data:t,selectedId:r,currentPage:n,pageSize:a,getId:i,routePath:s,rowTestIdPrefix:l,autoNavigate:c=!0,highlightDelay:u=100}=e,d=Ma(),[f,m]=w.useState(!1),[p,v]=w.useState(!1),b=w.useRef(null),y=t&&r?cX({data:t,targetId:r,pageSize:a,getId:i}):{found:!1,page:1};w.useEffect(()=>{if(!t||!r){v(!1);return}if(v(!1),!y.found){v(!0);return}c&&y.page!==n?(m(!0),d({to:s,search:_=>({..._,page:y.page,selected:r})})):m(!1)},[t,r,y.found,y.page,n,c,d,s]),w.useEffect(()=>{if(!r||!y.found||f||b.current===r||y.page!==n)return;const _=setTimeout(()=>{const N=`${l}${r}`;CZe(N,DB)&&(b.current=r)},u);return()=>clearTimeout(_)},[r,y.found,y.page,n,f,l,u]),w.useEffect(()=>{r||(b.current=null)},[r]);const S=w.useCallback(_=>{if(!t)return;const N=cX({data:t,targetId:_,pageSize:a,getId:i});N.found?(m(!0),d({to:s,search:k=>({...k,page:N.page,selected:_})})):v(!0)},[t,a,i,d,s]);return{found:y.found,isNavigating:f,notFound:p,targetPage:y.page,navigateToElement:S}}function Dme(e,t,r){if(!t)return e;const n=[...e];return n.sort((a,i)=>{const s=a[t.field],l=i[t.field];let c=0;return s==null?c=1:l==null?c=-1:typeof s=="string"&&typeof l=="string"?c=s.localeCompare(l):typeof s=="number"&&typeof l=="number"?c=s-l:s instanceof Date&&l instanceof Date?c=s.getTime()-l.getTime():c=String(s).localeCompare(String(l)),t.direction==="asc"?c:-c}),n}function EZe(e){if(e.search||e.channelType&&e.channelType!=="all")return r=>{if(e.search){const n=e.search.toLowerCase();if(!r.name.toLowerCase().includes(n))return!1}return!(e.channelType&&e.channelType!=="all"&&r.channelType!==e.channelType)}}const bf=25,Lme="orchestrator-tasks.viewMode",Ome="orchestrator-tasks.groupBy",OP="orchestrator-tasks.search",Ime="orchestrator-tasks.sortBy",Rme="orchestrator-tasks.sortDir",IP="orchestrator-tasks.secondarySort",Pme="orchestrator-tasks.columnWidths",oC=[{id:"checkbox",label:"",defaultWidth:40,minWidth:40,resizable:!1},{id:"title",label:"Task",defaultWidth:300,minWidth:120,resizable:!0,sortField:"title"},{id:"status",label:"Status",defaultWidth:140,minWidth:80,resizable:!0,sortField:"status"},{id:"priority",label:"Priority",defaultWidth:100,minWidth:70,resizable:!0,sortField:"priority"},{id:"taskType",label:"Type",defaultWidth:90,minWidth:60,resizable:!0,sortField:"taskType"},{id:"assignee",label:"Assignee",defaultWidth:140,minWidth:80,resizable:!0,sortField:"assignee"},{id:"branch",label:"Branch",defaultWidth:160,minWidth:80,resizable:!0},{id:"updatedAt",label:"Updated",defaultWidth:100,minWidth:70,resizable:!0,sortField:"updated_at"},{id:"actions",label:"Actions",defaultWidth:100,minWidth:60,resizable:!1}],OS=Object.fromEntries(oC.map(e=>[e.id,e.defaultWidth])),dX={status:[],priority:[],assignee:""},RP=[{value:"open",label:"Open",color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},{value:"in_progress",label:"In Progress",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200"},{value:"blocked",label:"Blocked",color:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200"},{value:"review",label:"Review",color:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-200"},{value:"deferred",label:"Deferred",color:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-200"},{value:"backlog",label:"Backlog",color:"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300"},{value:"closed",label:"Closed",color:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200"}],lC=[{value:1,label:"Critical",color:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200"},{value:2,label:"High",color:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-200"},{value:3,label:"Medium",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200"},{value:4,label:"Low",color:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200"},{value:5,label:"Trivial",color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}],yl=[{value:"priority",label:"Priority"},{value:"created_at",label:"Created"},{value:"updated_at",label:"Updated"},{value:"deadline",label:"Deadline"},{value:"title",label:"Title"},{value:"complexity",label:"Complexity"}],Ak=[{value:"none",label:"None"},{value:"status",label:"Status"},{value:"priority",label:"Priority"},{value:"assignee",label:"Assignee"},{value:"taskType",label:"Type"},{value:"tags",label:"Tags"}];function MZe(e,t){if(!t)return{matched:!0,indices:[]};const r=e.toLowerCase(),n=t.toLowerCase(),a=[];let i=0;for(let s=0;s<r.length&&i<n.length;s++)r[s]===n[i]&&(a.push(s),i++);return i===n.length?{matched:!0,indices:a}:null}function TZe(e,t){if(t.length===0)return e;const r=[],n=new Set(t);let a=0;for(let i=0;i<e.length;i++)n.has(i)&&(i>a&&r.push(o.jsx("span",{children:e.slice(a,i)},`text-${a}`)),r.push(o.jsx("mark",{className:"bg-yellow-200 text-gray-900 rounded-sm px-0.5",children:e[i]},`match-${i}`)),a=i+1);return a<e.length&&r.push(o.jsx("span",{children:e.slice(a)},`text-${a}`)),o.jsx(o.Fragment,{children:r})}function fX(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function hX(e,t,r,n){if(r==="createdAt"||r==="updatedAt"||r==="created_at"||r==="updated_at"){const l=r==="created_at"?"createdAt":r==="updated_at"?"updatedAt":r,c=new Date(e[l]).getTime(),u=new Date(t[l]).getTime(),d=c-u;return n==="asc"?d:-d}if(r==="deadline"){const l=e.deadline,c=t.deadline;if(!l&&!c)return 0;if(!l)return n==="asc"?1:-1;if(!c)return n==="asc"?-1:1;const u=new Date(l).getTime()-new Date(c).getTime();return n==="asc"?u:-u}if(r==="priority"){const l=(e.priority??5)-(t.priority??5);return n==="asc"?l:-l}if(r==="complexity"){const l=(e.complexity??3)-(t.complexity??3);return n==="asc"?l:-l}const a=e[r],i=t[r];let s=0;return a==null?s=1:i==null?s=-1:typeof a=="string"&&typeof i=="string"?s=a.localeCompare(i):typeof a=="number"&&typeof i=="number"?s=a-i:s=String(a).localeCompare(String(i)),n==="asc"?s:-s}function AZe(e,t,r){if(t==="none")return[{key:"all",label:"All Tasks",tasks:e}];const n=new Map;for(const i of e){let s;switch(t){case"status":s=[i.status];break;case"priority":s=[String(i.priority)];break;case"assignee":s=[i.assignee||"unassigned"];break;case"taskType":s=[i.taskType||"task"];break;case"tags":s=i.tags.length>0?i.tags:["untagged"];break;default:s=["other"]}for(const l of s)n.has(l)||n.set(l,[]),n.get(l).push(i)}const a=[];if(t==="status"){const i=["open","in_progress","blocked","review","deferred","closed","tombstone"];for(const s of i)if(n.has(s)){const l=RP.find(c=>c.value===s);a.push({key:s,label:l?.label||fX(s),color:l?.color,tasks:n.get(s)})}for(const[s,l]of n)i.includes(s)||a.push({key:s,label:fX(s),tasks:l})}else if(t==="priority"){const i=[1,2,3,4,5];for(const s of i){const l=String(s);if(n.has(l)){const c=lC.find(u=>u.value===s);a.push({key:l,label:c?.label||`Priority ${s}`,color:c?.color,tasks:n.get(l)})}}}else if(t==="assignee"){const i=Array.from(n.keys()).sort((s,l)=>{if(s==="unassigned")return-1;if(l==="unassigned")return 1;const c=r.get(s)||s,u=r.get(l)||l;return c.localeCompare(u)});for(const s of i){const l=s==="unassigned"?"Unassigned":r.get(s)||s;a.push({key:s,label:l,tasks:n.get(s)})}}else if(t==="taskType"){const i=["task","bug","feature","chore"],s=Array.from(n.keys()).sort((l,c)=>{const u=i.indexOf(l),d=i.indexOf(c);return u>=0&&d>=0?u-d:u>=0?-1:d>=0?1:l.localeCompare(c)});for(const l of s)a.push({key:l,label:l.charAt(0).toUpperCase()+l.slice(1),tasks:n.get(l)})}else if(t==="tags"){const i=Array.from(n.keys()).sort((s,l)=>s==="untagged"?-1:l==="untagged"?1:s.localeCompare(l));for(const s of i)a.push({key:s,label:s==="untagged"?"Untagged":s,tasks:n.get(s)})}return a}function DZe(e,t){const r=t.toLowerCase().trim();return n=>{if(e.status.length>0&&!e.status.includes(n.status)||e.priority.length>0&&!e.priority.includes(n.priority)||e.assignee&&n.assignee!==e.assignee)return!1;if(r){const a=n.title.toLowerCase().includes(r),i=n.id.toLowerCase().includes(r),s=n.tags.some(l=>l.toLowerCase().includes(r));if(!a&&!i&&!s)return!1}return!0}}function LZe(){return typeof window>"u"?"":localStorage.getItem(OP)||""}function OZe(e){typeof window>"u"||(e?localStorage.setItem(OP,e):localStorage.removeItem(OP))}function IZe(){return typeof window>"u"?"list":localStorage.getItem(Lme)==="kanban"?"kanban":"list"}function RZe(e){typeof window>"u"||localStorage.setItem(Lme,e)}function PZe(){if(typeof window>"u")return"none";const e=localStorage.getItem(Ome);return e&&Ak.some(t=>t.value===e)?e:"none"}function zZe(e){typeof window>"u"||localStorage.setItem(Ome,e)}function BZe(){if(typeof window>"u")return"created_at";const e=localStorage.getItem(Ime);return e&&yl.some(t=>t.value===e)?e:"created_at"}function $Ze(e){typeof window>"u"||localStorage.setItem(Ime,e)}function FZe(){return typeof window>"u"?"desc":localStorage.getItem(Rme)==="asc"?"asc":"desc"}function UZe(e){typeof window>"u"||localStorage.setItem(Rme,e)}function HZe(){if(typeof window>"u")return null;const e=localStorage.getItem(IP);return e&&yl.some(t=>t.value===e)?e:null}function qZe(e){typeof window>"u"||(e?localStorage.setItem(IP,e):localStorage.removeItem(IP))}function WZe(){if(typeof window>"u")return{...OS};const e=localStorage.getItem(Pme);if(e)try{const t=JSON.parse(e);return{...OS,...t}}catch{return{...OS}}return{...OS}}function mX(e){typeof window>"u"||localStorage.setItem(Pme,JSON.stringify(e))}function KZe(){const[e,t]=w.useState(()=>WZe()),r=w.useRef(null),[n,a]=w.useState(!1),i=w.useCallback(c=>oC.find(d=>d.id===c)?.minWidth??50,[]),s=w.useCallback((c,u)=>{c.preventDefault(),c.stopPropagation();const d=e[u]??100;r.current={columnId:u,startX:c.clientX,startWidth:d},a(!0)},[e]);w.useEffect(()=>{if(!n)return;const c=d=>{const f=r.current;if(!f)return;const m=d.clientX-f.startX,p=i(f.columnId),v=Math.max(p,f.startWidth+m);t(b=>({...b,[f.columnId]:v}))},u=()=>{r.current&&t(d=>(mX(d),d)),r.current=null,a(!1)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",u),document.body.style.userSelect="none",document.body.style.cursor="col-resize",()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u),document.body.style.userSelect="",document.body.style.cursor=""}},[n,i]);const l=w.useCallback(()=>{const c=Object.fromEntries(oC.map(u=>[u.id,u.defaultWidth]));t(c),mX(c)},[]);return{columnWidths:e,isDragging:n,handleMouseDown:s,resetColumnWidths:l}}const zme=300,pX=200;function GZe(e){const t=e.split("/");return t[t.length-1]||e}function VZe(e){const t=GZe(e.path),r=e.matches.map(n=>({line:n.line,column:n.column,matchedText:n.lineContent.slice(n.column-1,n.column-1+n.length),lineContent:n.lineContent,startIndex:n.column-1,endIndex:n.column-1+n.length}));return{path:e.path,name:t,matches:r,totalMatches:e.matches.length}}const gX={query:"",debouncedQuery:"",isSearching:!1,results:[],filesSearched:0,totalFiles:0,totalMatches:0,progress:0,error:null,isComplete:!1,searchTime:null},YZe={caseSensitive:!1,useRegex:!1,wholeWord:!1,includeExtensions:void 0,excludeExtensions:void 0,debounceDelay:zme};function Bme(e={}){const{isOpen:t}=g1(),[r,n]=w.useState(gX),[a,i]=w.useState({...YZe,...e}),s=w.useRef(null),l=TB(r.query,a.debounceDelay??zme);w.useEffect(()=>{n(m=>({...m,debouncedQuery:l}))},[l]);const c=w.useCallback(m=>{n(p=>({...p,query:m,isComplete:!1}))},[]),u=w.useCallback(()=>{s.current&&(s.current.abort(),s.current=null),n(m=>({...m,isSearching:!1,isComplete:!0}))},[]),d=w.useCallback(()=>{u(),n(gX)},[u]),f=w.useCallback(m=>{i(p=>({...p,...m}))},[]);return w.useEffect(()=>{if(s.current&&s.current.abort(),!l.trim()||!t){n(v=>({...v,results:[],isSearching:!1,filesSearched:0,totalFiles:0,totalMatches:0,progress:0,error:null,isComplete:!l.trim(),searchTime:null}));return}const m=new AbortController;return s.current=m,(async()=>{const v=performance.now();n(b=>({...b,isSearching:!0,results:[],filesSearched:0,totalFiles:0,totalMatches:0,progress:0,error:null,isComplete:!1,searchTime:null}));try{let b,y;a.includeExtensions&&a.includeExtensions.length>0&&(b=`*.{${a.includeExtensions.join(",")}}`),a.excludeExtensions&&a.excludeExtensions.length>0&&(y=`*.{${a.excludeExtensions.join(",")}}`);const S=await fetch("/api/workspace/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:l,isRegex:a.useRegex??!1,caseSensitive:a.caseSensitive??!1,wholeWord:a.wholeWord??!1,includePattern:b,excludePattern:y,maxResults:pX}),signal:m.signal});if(!S.ok){const j=await S.json().catch(()=>({error:{message:"Search failed"}}));throw new Error(j.error?.message||`HTTP ${S.status}`)}const _=await S.json();if(_.error)throw new Error(_.error.message);const N=_.results.map(VZe),k=performance.now();n(j=>({...j,results:N,filesSearched:N.length,totalFiles:N.length,totalMatches:_.totalMatches,progress:1,isSearching:!1,isComplete:!0,searchTime:k-v,error:_.truncated?`Search stopped: Maximum ${pX} matches reached`:null}))}catch(b){if(b instanceof Error&&b.name==="AbortError")return;const y=performance.now();n(S=>({...S,isSearching:!1,isComplete:!0,searchTime:y-v,error:b instanceof Error?b.message:"Search failed"}))}})(),()=>{m.abort()}},[l,t,a.caseSensitive,a.useRegex,a.wholeWord,a.includeExtensions,a.excludeExtensions]),{...r,setQuery:c,cancelSearch:u,clearResults:d,options:a,setOptions:f}}function QZe(e){const t=e.split(".").pop()?.toLowerCase()||"";return new Set(["js","jsx","ts","tsx","mjs","cjs","mts","cts","json","jsonc","json5","py","pyw","pyx","go","rs","java","kt","kts","c","cpp","cc","cxx","h","hpp","hxx","cs","php","rb","swift","r","lua","pl","pm","ex","exs","erl","hrl","clj","cljs","scala","vue","svelte","astro","html","htm","css","scss","sass","less","yaml","yml","toml","xml","svg","sql","graphql","gql","sh","bash","zsh","fish","ps1","dockerfile","makefile","cmake"]).has(t)?Bs:rn}function JZe({lineContent:e,startIndex:t,endIndex:r}){const n=e.slice(0,t),a=e.slice(t,r),i=e.slice(r),s=100;let l=n,c=i;n.length>30&&(l="..."+n.slice(-27)),i.length>50&&(c=i.slice(0,47)+"...");const u=l.length+a.length+c.length;if(u>s){const d=u-s;c.length>d&&(c=c.slice(0,c.length-d-3)+"...")}return o.jsxs("span",{className:"font-mono text-xs",children:[o.jsx("span",{className:"text-[var(--color-text-muted)]",children:l}),o.jsx("span",{className:"bg-[var(--color-warning)]/30 text-[var(--color-text)] font-semibold px-0.5 rounded",children:a}),o.jsx("span",{className:"text-[var(--color-text-muted)]",children:c})]})}function ZZe({result:e,isExpanded:t,onToggleExpand:r,onSelectMatch:n}){const a=QZe(e.name),i=e.path.includes("/")?e.path.split("/").slice(0,-1).join("/"):"";return o.jsxs("div",{className:"border-b border-[var(--color-border)] last:border-b-0",children:[o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-[var(--color-surface-hover)] transition-colors text-left",children:[t?o.jsx(cr,{className:"w-4 h-4 text-[var(--color-text-muted)] flex-shrink-0"}):o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-muted)] flex-shrink-0"}),o.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded bg-[var(--color-surface)] text-[var(--color-text-muted)] flex-shrink-0",children:o.jsx(a,{className:"w-3.5 h-3.5"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.name}),o.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-[var(--color-primary)]/10 text-[var(--color-primary)] rounded",children:[e.totalMatches," ",e.totalMatches===1?"match":"matches"]})]}),i&&o.jsx("div",{className:"text-xs text-[var(--color-text-muted)] truncate",children:i})]})]}),t&&o.jsxs("div",{className:"bg-[var(--color-surface)]/50",children:[e.matches.map((s,l)=>o.jsxs("button",{onClick:()=>n(e,s),className:"w-full flex items-start gap-2 px-3 py-1.5 pl-11 hover:bg-[var(--color-surface-hover)] transition-colors text-left",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono w-8 text-right flex-shrink-0",children:s.line}),o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] mr-1",children:":"}),o.jsx(JZe,{lineContent:s.lineContent,startIndex:s.startIndex,endIndex:s.endIndex})]},`${s.line}-${s.column}-${l}`)),e.totalMatches>e.matches.length&&o.jsxs("div",{className:"px-3 py-1.5 pl-11 text-xs text-[var(--color-text-muted)] italic",children:["+",e.totalMatches-e.matches.length," more matches..."]})]})]})}function kL({active:e,onClick:t,icon:r,label:n,shortLabel:a}){return o.jsxs("button",{onClick:t,className:`
        flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors
        ${e?"bg-[var(--color-primary)] text-white":"bg-[var(--color-surface)] text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
      `,title:n,children:[o.jsx(r,{className:"w-3.5 h-3.5"}),a&&o.jsx("span",{className:"hidden sm:inline",children:a})]})}function XZe({open:e,onOpenChange:t}){const r=Ma(),n=w.useRef(null),[a,i]=w.useState(new Set),{isOpen:s,workspaceName:l,isLoading:c,error:u}=g1(),{query:d,setQuery:f,isSearching:m,results:p,filesSearched:v,totalFiles:b,totalMatches:y,progress:S,error:_,isComplete:N,searchTime:k,options:j,setOptions:E,clearResults:T}=Bme();w.useEffect(()=>{e||(T(),i(new Set))},[e,T]),w.useEffect(()=>{e&&n.current&&n.current.focus()},[e]),w.useEffect(()=>{p.length>0&&p.length<=5&&i(new Set(p.map(B=>B.path)))},[p]);const O=w.useCallback((B,F)=>{r({to:"/editor",search:{file:B.path,line:F.line,column:F.column}}),t(!1)},[r,t]),R=w.useCallback(B=>{i(F=>{const U=new Set(F);return U.has(B)?U.delete(B):U.add(B),U})},[]),q=w.useCallback(()=>{E({caseSensitive:!j.caseSensitive})},[j.caseSensitive,E]),$=w.useCallback(()=>{E({useRegex:!j.useRegex})},[j.useRegex,E]),L=w.useCallback(()=>{E({wholeWord:!j.wholeWord})},[j.wholeWord,E]);if(!e)return null;const A=d.trim().length>0,M=m&&b>0,z=p.length>0,I=N&&A&&p.length===0&&!_;return o.jsxs(Xi.Dialog,{open:e,onOpenChange:t,label:"Search in Files",className:"fixed inset-0 z-[var(--z-index-modal)] flex items-start justify-center pt-[10vh]","data-testid":"file-content-search",shouldFilter:!1,children:[o.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] backdrop-blur-sm",onClick:()=>t(!1),"data-testid":"file-content-search-backdrop"}),o.jsxs("div",{className:"relative w-full max-w-3xl bg-[var(--color-bg-elevated)] rounded-xl shadow-2xl border border-[var(--color-border)] overflow-hidden","data-testid":"file-content-search-dialog",children:[o.jsxs("div",{className:"border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-3 px-4",children:[o.jsx(br,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),o.jsx(Xi.Input,{ref:n,value:d,onValueChange:f,placeholder:s?"Search in files...":"Open a workspace to search...",className:"flex-1 h-14 bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:outline-none text-base","data-testid":"file-content-search-input",disabled:!s}),m&&o.jsx($e,{className:"w-5 h-5 animate-spin text-[var(--color-primary)]"}),o.jsxs("div",{className:"flex items-center gap-2",children:[l&&o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] px-2 py-1 rounded max-w-[120px] truncate",children:l}),o.jsx("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:"ESC"})]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]/50",children:[o.jsx(dwe,{className:"w-4 h-4 text-[var(--color-text-muted)]"}),o.jsx(kL,{active:j.caseSensitive??!1,onClick:q,icon:Hae,label:"Match Case",shortLabel:"Aa"}),o.jsx(kL,{active:j.wholeWord??!1,onClick:L,icon:qae,label:"Whole Word",shortLabel:"W"}),o.jsx(kL,{active:j.useRegex??!1,onClick:$,icon:Wae,label:"Use Regular Expression",shortLabel:".*"}),o.jsx("div",{className:"flex-1"}),M&&o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{children:[v,"/",b," files"]}),o.jsx("div",{className:"w-16 h-1.5 bg-[var(--color-surface)] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-[var(--color-primary)] transition-all duration-200",style:{width:`${S*100}%`}})})]}),N&&A&&!m&&o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[y," ",y===1?"result":"results",k!==null&&` in ${Math.round(k)}ms`]})]})]}),o.jsxs(Xi.List,{className:"max-h-[60vh] overflow-y-auto","data-testid":"file-content-search-list",children:[c&&o.jsxs("div",{className:"flex items-center justify-center py-10",children:[o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"}),o.jsx("span",{className:"ml-2 text-sm text-[var(--color-text-muted)]",children:"Loading workspace..."})]}),u&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:u})]}),_&&o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-[var(--color-danger)]/10 text-[var(--color-danger)] text-sm",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{children:_})]}),!c&&!u&&!s&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx($e,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4 animate-spin"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Loading Workspace"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"The workspace is loading from the server..."})]}),s&&!A&&!m&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(br,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Search in Files"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"Type to search for text across all files in your workspace."})]}),I&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(wt,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"No Results Found"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)]",children:['No files contain "',d,'"']})]}),z&&o.jsx("div",{className:"divide-y divide-[var(--color-border)]",children:p.map(B=>o.jsx(ZZe,{result:B,isExpanded:a.has(B.path),onToggleExpand:()=>R(B.path),onSelectMatch:O},B.path))})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Go to line"})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:"F"})," ","to toggle"]})]})]})]})}function eXe(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=n=>{if((n.metaKey||n.ctrlKey)&&n.shiftKey&&n.key.toLowerCase()==="f"){if(window.location.pathname==="/editor")return;n.preventDefault(),t(a=>!a)}};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),{open:e,setOpen:t}}function tXe(){return gt({queryKey:["health"],queryFn:async()=>{const e=await fetch("/api/health");if(!e.ok)throw new Error("Failed to fetch health");return e.json()},refetchInterval:3e4})}function rXe({health:e}){return e.isLoading?o.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-text-tertiary)]",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--color-text-tertiary)] animate-pulse"}),o.jsx("span",{className:"text-sm",children:"Connecting..."})]}):e.isError?o.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-danger-text)]",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--color-danger)]"}),o.jsx("span",{className:"text-sm font-medium",children:"Disconnected"})]}):o.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-success-text)]",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--color-success)]"}),o.jsx("span",{className:"text-sm font-medium",children:"Connected"})]})}const PP={"/activity":{label:"Activity",icon:Hh},"/tasks":{label:"Tasks",icon:Tl},"/merge-requests":{label:"Merge Requests",icon:Ri},"/plans":{label:"Plans",icon:tu},"/agents":{label:"Agents",icon:Ii},"/workspaces":{label:"Workspaces",icon:bh},"/workflows":{label:"Workflows",icon:vh},"/metrics":{label:"Metrics",icon:GC},"/settings":{label:"Settings",icon:li},"/inbox":{label:"Inbox",icon:rs},"/messages":{label:"Messages",icon:ss},"/documents":{label:"Documents",icon:rn},"/editor":{label:"Editor",icon:Bs}};function $me(){const t=UC().location.pathname;return w.useMemo(()=>{const r=[];let n=t;const a=[];for(;n;){const i=PP[n];if(i)a.unshift(n),n=i.parent||"";else{const s=n.split("/").filter(Boolean);if(s.length>1)n="/"+s.slice(0,-1).join("/");else break}}return a.forEach((i,s)=>{const l=PP[i];l&&r.push({label:l.label,path:i,icon:l.icon,isLast:s===a.length-1})}),r},[t])}function nXe(){const e=$me();return e.length===0?null:o.jsx("nav",{"aria-label":"Breadcrumb","data-testid":"breadcrumbs",children:o.jsx("ol",{className:"flex items-center gap-1 text-sm",children:e.map((t,r)=>{const n=t.icon;return o.jsxs("li",{className:"flex items-center",children:[r>0&&o.jsx(gn,{className:"w-4 h-4 mx-1 text-[var(--color-text-muted)]"}),t.isLast?o.jsxs("span",{className:"flex items-center gap-1.5 px-2 py-1 font-normal text-[var(--color-text)] rounded-md","data-testid":`breadcrumb-${t.label.toLowerCase().replace(/\s/g,"-")}`,children:[n&&o.jsx(n,{className:"w-4 h-4"}),t.label]}):o.jsxs(Aae,{to:t.path,className:"flex items-center gap-1.5 px-2 py-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors duration-150","data-testid":`breadcrumb-${t.label.toLowerCase().replace(/\s/g,"-")}`,children:[n&&o.jsx(n,{className:"w-4 h-4"}),t.label]})]},t.path)})})})}function aXe(){const e=$me(),t=e[e.length-1];if(!t)return null;const r=t.icon;return o.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-sm font-normal text-[var(--color-text)]","data-testid":"breadcrumbs-mobile",children:[r&&o.jsx(r,{className:"w-4 h-4"}),o.jsx("span",{className:"truncate max-w-[150px]",children:t.label})]})}const vX="orchestrator-sidebar-collapsed",bX="orchestrator-director-collapsed",yX="orchestrator-director-maximized";function iXe(){const e=jo(),t=ake(),[r,n]=w.useState(()=>typeof window>"u"?!1:localStorage.getItem(vX)==="true"),[a,i]=w.useState(!1);return w.useEffect(()=>{localStorage.setItem(vX,String(r))},[r]),w.useEffect(()=>{e||i(!1)},[e]),{isMobile:e,isTablet:t,desktopCollapsed:r,setDesktopCollapsed:n,mobileDrawerOpen:a,setMobileDrawerOpen:i}}function sXe(){const e=jo(),[t,r]=w.useState(()=>{if(typeof window>"u")return!0;const s=localStorage.getItem(bX);return s===null?!0:s==="true"}),[n,a]=w.useState(()=>typeof window>"u"?!1:localStorage.getItem(yX)==="true");return w.useEffect(()=>{localStorage.setItem(bX,String(t))},[t]),w.useEffect(()=>{localStorage.setItem(yX,String(n))},[n]),{collapsed:e?!0:t,setCollapsed:r,isMaximized:e?!1:n,setIsMaximized:a,isMobile:e}}function oXe(){const{isMobile:e,isTablet:t,desktopCollapsed:r,setDesktopCollapsed:n,mobileDrawerOpen:a,setMobileDrawerOpen:i}=iXe(),{collapsed:s,setCollapsed:l,isMaximized:c,setIsMaximized:u}=sXe(),d=tXe(),f=Dae(),{notifications:m,unreadCount:p,isConnected:v,markAsRead:b,markAllAsRead:y,dismissNotification:S,clearAll:_}=SJe(),{open:N,setOpen:k}=lZe(),{open:j,setOpen:E}=kZe(),{open:T,setOpen:O}=eXe(),R=w.useCallback(()=>{e?i(B=>!B):n(B=>!B)},[e,i,n]),q=w.useCallback(()=>{l(B=>!B)},[l]),$=w.useCallback(()=>{s&&l(!1),u(B=>!B)},[s,l,u]),L=w.useCallback(()=>{k(!0)},[k]);_Ze({onToggleSidebar:R,onToggleDirector:q,onToggleDirectorMaximize:$,onOpenCommandPalette:L});const A=w.useCallback(()=>{i(!0)},[i]),M=w.useCallback(()=>{i(!1)},[i]);w.useEffect(()=>{const B=()=>{l(F=>!F)};return window.addEventListener("toggle-director-panel",B),()=>window.removeEventListener("toggle-director-panel",B)},[l]),w.useEffect(()=>{const B=()=>{$()};return window.addEventListener("maximize-director-panel",B),()=>window.removeEventListener("maximize-director-panel",B)},[$]),w.useEffect(()=>{const B=()=>{l(!1)};return window.addEventListener("open-director-panel",B),()=>window.removeEventListener("open-director-panel",B)},[l]),w.useEffect(()=>{const B=f.subscribe("onResolved",()=>{e&&a&&i(!1)});return()=>B()},[f,e,a,i]);const z=UC();w.useEffect(()=>{const B=z.location.pathname,F=PP[B];document.title=F?`Stoneforge | ${F.label}`:"Stoneforge"},[z.location.pathname]);const I=e||t?!0:r;return o.jsxs("div",{className:"flex h-screen bg-[var(--color-bg)]","data-testid":"app-shell",children:[e&&o.jsx(ike,{open:a,onClose:M,"data-testid":"mobile-drawer",children:o.jsx(lZ,{collapsed:!1,onToggle:M,isMobileDrawer:!0})}),!e&&o.jsx(lZ,{collapsed:I,onToggle:()=>n(!r)}),o.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[o.jsx("header",{className:"h-14 bg-[var(--color-header-bg)] border-b border-[var(--color-header-border)] overflow-x-auto scrollbar-hide","data-testid":"header",children:o.jsxs("div",{className:"flex items-center justify-between h-full px-4 md:px-6 min-w-max",children:[e&&o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsx("button",{onClick:A,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target flex-shrink-0","aria-label":"Open navigation menu","aria-expanded":a,"data-testid":"mobile-menu-button",children:o.jsx(fwe,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 text-center whitespace-nowrap",children:o.jsx(aXe,{})}),o.jsx("button",{className:"p-2 -mr-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target flex-shrink-0","aria-label":"Search","data-testid":"mobile-search-button",children:o.jsx(br,{className:"w-5 h-5"})})]}),!e&&o.jsx("div",{className:"flex-shrink-0 whitespace-nowrap",children:o.jsx(nXe,{})}),o.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-shrink-0",children:[!e&&o.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-secondary)] transition-colors duration-150 whitespace-nowrap","aria-label":"Open command palette","data-testid":"command-palette-trigger",children:[o.jsx(br,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{className:"hidden lg:inline",children:"Search..."}),o.jsxs("kbd",{className:"hidden md:flex items-center gap-0.5 px-1.5 py-0.5 text-xs bg-[var(--color-bg)] border border-[var(--color-border)] rounded",children:[o.jsx(hwe,{className:"w-3 h-3"}),"K"]})]}),!e&&o.jsx(r_e,{}),!e&&o.jsx(eZe,{}),!e&&o.jsx(tZe,{}),o.jsx(aZe,{notifications:m,unreadCount:p,isConnected:v,onMarkAsRead:b,onMarkAllAsRead:y,onDismiss:S,onClearAll:_,onOpenSettings:()=>f.navigate({to:"/settings",search:{tab:"preferences"}})}),o.jsx(tke,{}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-5 w-px bg-[var(--color-border)] flex-shrink-0"}),o.jsx(rXe,{health:d})]})]})]})}),o.jsx("main",{className:"flex-1 overflow-y-auto p-4 @md:p-6 bg-[var(--color-bg)] @container",children:o.jsx(Lae,{})})]}),!e&&o.jsx(JQe,{collapsed:s,onToggle:q,isMaximized:c,onToggleMaximize:$}),o.jsx(sZe,{open:N,onOpenChange:k}),o.jsx(SZe,{open:j,onOpenChange:E}),o.jsx(XZe,{open:T,onOpenChange:O})]})}const lXe={created:_r,updated:pwe,closed:Pi,reopened:jr,deleted:Sr,dependency_added:Gae,dependency_removed:Kae,tag_added:Vc,tag_removed:Vc,member_added:Fae,member_removed:$ae,auto_blocked:qC,auto_unblocked:mwe},cXe={task:"Task",entity:"Entity",document:"Document",channel:"Channel",message:"Message",plan:"Plan",workflow:"Workflow",library:"Library",team:"Team"};function uXe({event:e,onOpenInWorkspace:t}){const[r,n]=w.useState(!1),a=lXe[e.eventType]||Hh,i=hJe(e.eventType),s=e.elementType?cXe[e.elementType]||e.elementType:"item",l=e.oldValue&&Object.keys(e.oldValue).length>0||e.newValue&&Object.keys(e.newValue).length>0;return o.jsx("div",{className:"group bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg p-4 hover:border-[var(--color-border-hover)] transition-colors duration-150","data-testid":"activity-card","data-event-id":e.id,children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:`${i}20`},children:o.jsx(a,{className:"w-4 h-4",style:{color:i}})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-[var(--color-text)]","data-testid":"activity-summary",children:e.summary||`${e.eventType} on ${s}`}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-[var(--color-text-tertiary)]",children:[e.actorName&&o.jsxs(o.Fragment,{children:[o.jsx("span",{"data-testid":"activity-actor",children:e.actorName}),o.jsx("span",{children:""})]}),o.jsx("span",{"data-testid":"activity-time",children:EB(e.createdAt)}),e.elementType&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium bg-[var(--color-surface-hover)]","data-testid":"activity-element-type",children:s})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-150",children:[t&&o.jsx("button",{onClick:()=>t(e),className:"p-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors duration-150",title:"Open in Workspace","data-testid":"activity-open-workspace",children:o.jsx(Sl,{className:"w-4 h-4"})}),l&&o.jsx("button",{onClick:()=>n(!r),className:"p-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors duration-150",title:r?"Collapse":"Expand","data-testid":"activity-expand",children:r?o.jsx(Xg,{className:"w-4 h-4"}):o.jsx(cr,{className:"w-4 h-4"})})]})]}),e.elementTitle&&o.jsx("div",{className:"mt-2",children:o.jsx("span",{className:"text-sm font-medium text-[var(--color-primary)] hover:underline cursor-pointer","data-testid":"activity-element-title",children:e.elementTitle})}),r&&l&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--color-border)] space-y-3","data-testid":"activity-details",children:[e.newValue&&Object.keys(e.newValue).length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] mb-1",children:e.eventType==="created"?"Initial Values":"New Values"}),o.jsx("pre",{className:"text-xs bg-[var(--color-surface-hover)] p-2 rounded overflow-x-auto",children:JSON.stringify(e.newValue,null,2)})]}),e.oldValue&&Object.keys(e.oldValue).length>0&&e.eventType!=="created"&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] mb-1",children:"Previous Values"}),o.jsx("pre",{className:"text-xs bg-[var(--color-surface-hover)] p-2 rounded overflow-x-auto",children:JSON.stringify(e.oldValue,null,2)})]})]})]})]})})}function dXe({events:e,isLoading:t,hasMore:r,onLoadMore:n,onOpenInWorkspace:a,emptyMessage:i="No activity to show"}){const s=w.useRef(null),l=w.useRef(null),c=w.useCallback(u=>{s.current&&s.current.disconnect(),u&&r&&n&&(s.current=new IntersectionObserver(d=>{d[0].isIntersecting&&!t&&n()},{threshold:.1}),s.current.observe(u)),l.current=u},[r,t,n]);return w.useEffect(()=>()=>{s.current&&s.current.disconnect()},[]),e.length===0&&!t?o.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center","data-testid":"activity-empty",children:o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:i})}):o.jsxs("div",{className:"space-y-3","data-testid":"activity-list",children:[e.map(u=>o.jsx(uXe,{event:u,onOpenInWorkspace:a},u.id)),r&&o.jsx("div",{ref:c,className:"flex items-center justify-center py-4","data-testid":"activity-load-more",children:t&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Loading more..."]})}),t&&e.length===0&&o.jsx("div",{className:"flex items-center justify-center py-12","data-testid":"activity-loading",children:o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-text-secondary)]"})})]})}const fXe={assistant:Xr,tool_use:Zo,tool_result:Pi,error:Bt,system:KC,result:Pi},hXe={assistant:"var(--color-primary)",tool_use:"var(--color-warning)",tool_result:"var(--color-success)",error:"var(--color-error)",system:"var(--color-info)",result:"var(--color-success)"};function mXe({event:e,onOpenInWorkspace:t}){const r=fXe[e.type]||Xr,n=hXe[e.type]||"var(--color-text-secondary)",a=e.content?e.content.length>200?`${e.content.slice(0,200)}...`:e.content:null,i=new Date(e.timestamp).toLocaleTimeString();return o.jsx("div",{className:"group bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg p-3 hover:border-[var(--color-border-hover)] transition-colors duration-150","data-testid":"session-activity-card","data-session-id":e.sessionId,children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center",style:{backgroundColor:`${n}20`},children:o.jsx(r,{className:"w-3.5 h-3.5",style:{color:n}})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)]",children:[e.agentName&&o.jsx("span",{className:"font-medium text-[var(--color-text)]","data-testid":"session-agent-name",children:e.agentName}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium bg-[var(--color-surface-hover)] capitalize","data-testid":"session-event-type",children:e.type.replace("_"," ")}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]","data-testid":"session-time",children:i})]}),t&&o.jsx("button",{onClick:()=>t(e.sessionId),className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] opacity-0 group-hover:opacity-100 transition-all duration-150",title:"Open in Workspace","data-testid":"session-open-workspace",children:o.jsx(na,{className:"w-3.5 h-3.5"})})]}),a&&o.jsx("p",{className:"mt-1.5 text-sm text-[var(--color-text)] whitespace-pre-wrap break-words font-mono text-xs","data-testid":"session-content",children:a})]})]})})}const xX={director:{label:"Director",icon:Px,color:"text-[var(--color-warning)]"},worker:{label:"Worker",icon:Zo,color:"text-[var(--color-primary)]"},steward:{label:"Steward",icon:Xo,color:"text-[var(--color-info)]"}};function wX(e){const t=Date.now()-(typeof e=="number"?e:new Date(e).getTime()),r=Math.floor(t/1e3),n=Math.floor(r/3600),a=Math.floor(r%3600/60),i=r%60;return n>0?`${n}h ${a}m ${i.toString().padStart(2,"0")}s`:`${a}m ${i.toString().padStart(2,"0")}s`}function pXe({agent:e,session:t,currentTask:r,lastOutput:n,onOpenTerminal:a,onStop:i,isStopping:s}){const[l,c]=w.useState(""),u=t.startedAt||t.createdAt;w.useEffect(()=>{c(wX(u));const b=setInterval(()=>c(wX(u)),1e3);return()=>clearInterval(b)},[u]);const d=t.agentRole||e.metadata?.agent?.agentRole||"worker",f=xX[d]||xX.worker,m=f.icon,p=t.status==="running",v=t.status==="starting";return o.jsxs("div",{className:"flex flex-col gap-2 p-4 rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":`active-agent-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full flex-shrink-0 ${p?"bg-[var(--color-success)] animate-pulse":v?"bg-[var(--color-warning)] animate-pulse":"bg-[var(--color-text-tertiary)]"}`}),o.jsx("span",{className:"font-semibold text-sm text-[var(--color-text)] truncate",children:e.name}),o.jsxs("span",{className:`flex items-center gap-1 ml-auto text-xs font-medium ${f.color}`,children:[o.jsx(m,{className:"w-3 h-3"}),f.label]})]}),o.jsx("div",{className:"text-xs text-[var(--color-text-secondary)] truncate",children:r?o.jsxs(o.Fragment,{children:["Working on:"," ",o.jsx("span",{className:"font-medium text-[var(--color-text)]",children:r.externalRef||r.id})," ",o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:r.title})]}):o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:"No task assigned"})}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("div",{className:"flex-1 min-w-0 rounded-md border border-[var(--color-border)] bg-[var(--color-surface-hover)] px-3 py-2",children:o.jsx("span",{className:"text-xs font-mono text-[var(--color-text-secondary)] line-clamp-3",children:n?.content?n.content:v?"starting...":p?"working...":"idle..."})}),o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)] font-mono flex-shrink-0 pt-2",children:l})]}),o.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[o.jsxs("button",{onClick:()=>a(e.id),className:"flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded border border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150",children:[o.jsx(na,{className:"w-3 h-3"}),d==="director"?"Open Panel":"Open Terminal"]}),o.jsxs("button",{onClick:()=>i(e.id),disabled:s,className:"flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded border border-[var(--color-border)] text-[var(--color-error)] hover:bg-[var(--color-error-muted)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150",children:[o.jsx(uu,{className:"w-3 h-3"}),s?"Stopping...":"Stop"]})]})]})}const gXe="";function vXe(e){if(e.type==="tool_use"){const t=e.tool;return t?`Using ${t.charAt(0).toUpperCase()+t.slice(1)}...`:"Running tool..."}if(e.type==="tool_result")return"Tool completed"}const bXe=new Set(["tool_use","tool_result","assistant"]);async function yXe(e){const t=new Map;if(e.length===0)return t;const r=e.map(n=>n.sessionId).join(",");try{const n=await fetch(`${gXe}/api/sessions/latest-messages?sessionIds=${encodeURIComponent(r)}`);if(!n.ok)return t;const a=await n.json();for(const[,i]of Object.entries(a.messages))i.content&&i.agentId&&t.set(i.agentId,{content:i.content,timestamp:i.timestamp,eventType:i.type})}catch{}return t}function xXe(e){const{isConnected:t,sessionEvents:r}=jB("all"),n=w.useRef(new Map),[a,i]=w.useState(0),s=w.useRef(new Set),l=w.useCallback(async c=>{const u=c.filter(m=>!s.current.has(m.sessionId));if(u.length===0)return;const d=await yXe(u);let f=!1;for(const[m,p]of d)n.current.has(m)||(n.current.set(m,p),f=!0);for(const m of u)s.current.add(m.sessionId);f&&i(m=>m+1)},[]);return w.useEffect(()=>{e&&e.length>0&&l(e)},[e,l]),w.useEffect(()=>{if(r.length===0){n.current.size>0&&(n.current.clear(),i(f=>f+1));return}const c=new Map;for(const f of r){if(!f.agentId||c.has(f.agentId))continue;let m=f.content;!m&&bXe.has(f.type)&&(m=vXe(f)),m&&c.set(f.agentId,{content:m,timestamp:f.timestamp,eventType:f.type})}let u=!1;const d=new Map(c);for(const[f,m]of n.current)d.has(f)||d.set(f,m);if(d.size!==n.current.size)u=!0;else for(const[f,m]of d){const p=n.current.get(f);if(!p||p.content!==m.content||p.timestamp!==m.timestamp){u=!0;break}}u&&(n.current=d,i(f=>f+1))},[r]),{outputByAgent:n.current,isConnected:t,_version:a}}const SX={director:0,worker:1,steward:2};function wXe({onOpenTerminal:e,onOpenDirectorPanel:t,onStopAgent:r}){const{allAgents:n}=g0(),{data:a}=m2({status:"running"}),{inProgress:i,awaitingMerge:s}=h1(),l=a?.sessions??[],c=w.useMemo(()=>l.map(N=>({sessionId:N.id,agentId:N.agentId})),[l]),{outputByAgent:u}=xXe(c),{data:d}=m1(),[f,m]=w.useState(new Set),p=w.useMemo(()=>l.map(N=>N.id),[l]),{latestBySession:v}=XJe(p),b=w.useMemo(()=>{const N=new Map;for(const k of n)N.set(k.id,k);return N},[n]),y=w.useMemo(()=>{const N=new Map;for(const k of s)k.assignee&&N.set(k.assignee,k);for(const k of i)k.assignee&&N.set(k.assignee,k);return N},[i,s]),S=w.useMemo(()=>{const N=[];for(const k of l){const j=b.get(k.agentId);if(!j)continue;const E=y.get(j.id);N.push({agent:j,session:k,task:E})}return N.sort((k,j)=>{const E=SX[k.session.agentRole]??1,T=SX[j.session.agentRole]??1;return E-T}),N},[l,b,y]),_=async N=>{m(k=>new Set(k).add(N));try{await r(N)}finally{m(k=>{const j=new Set(k);return j.delete(N),j})}};return S.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 rounded-lg border border-dashed border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":"active-agents-empty",children:[o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"No agents are currently active"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:d?.isRunning?"The daemon is running and will start agents when tasks are available.":"Start the daemon or launch agents manually from the Agents page."})]}):o.jsx("div",{className:"grid gap-3 grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3","data-testid":"active-agents-dashboard",children:S.map(({agent:N,session:k,task:j})=>{const E=u.get(N.id),T=v[k.id];let O;return E&&T?.content?O=new Date(E.timestamp)>=new Date(T.timestamp)?E:{content:T.content,timestamp:T.timestamp,eventType:T.type}:E?O=E:T?.content&&(O={content:T.content,timestamp:T.timestamp,eventType:T.type}),o.jsx(pXe,{agent:N,session:k,currentTask:j,lastOutput:O,onOpenTerminal:k.agentRole==="director"?()=>t():()=>e(N.id),onStop:_,isStopping:f.has(N.id)},k.id)})})}function SXe(){const{data:e}=m2({status:"running"}),{inProgress:t,awaitingMerge:r,closed:n}=h1(),{data:a}=m1(),i=e?.sessions?.length??0;return o.jsxs("div",{className:"flex items-center gap-3 flex-wrap","data-testid":"system-status-bar",children:[o.jsx(IS,{icon:o.jsx(Ii,{className:"w-3.5 h-3.5"}),label:"Active Agents",value:i,color:i>0?"primary":"muted"}),o.jsx(IS,{icon:o.jsx(Hh,{className:"w-3.5 h-3.5"}),label:"In Progress",value:t.length,color:t.length>0?"warning":"muted"}),o.jsx(IS,{icon:o.jsx(gwe,{className:"w-3.5 h-3.5"}),label:"In Review",value:r.length,color:r.length>0?"info":"muted"}),o.jsx(IS,{icon:o.jsx(Pi,{className:"w-3.5 h-3.5"}),label:"Completed",value:n.length,color:"muted"}),o.jsxs("div",{className:"ml-auto flex items-center gap-1.5 text-xs",children:[o.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${a?.isRunning?"bg-[var(--color-success)] animate-pulse":"bg-[var(--color-error)]"}`}),o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:a?.isRunning?"Daemon Running":"Daemon Stopped"})]})]})}function IS({icon:e,label:t,value:r,color:n}){const a={primary:"text-[var(--color-primary)] bg-[var(--color-primary-muted)]",warning:"text-[var(--color-warning)] bg-[var(--color-warning-muted)]",info:"text-[var(--color-info)] bg-[var(--color-info-muted)]",muted:"text-[var(--color-text-secondary)] bg-[var(--color-surface)]"};return o.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border border-[var(--color-border)] ${a[n]}`,children:[e,o.jsx("span",{children:r}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:t})]})}const kXe=8,_Xe=1440*60*1e3;function NXe(e){const t=e.metadata?.orchestrator;if(!t?.mergeStatus)return null;switch(t.mergeStatus){case"merged":return{label:"Merged",color:"text-[var(--color-success)] bg-[var(--color-success-muted)]"};case"pending":return{label:"Pending merge",color:"text-[var(--color-warning)] bg-[var(--color-warning-muted)]"};case"conflict":return{label:"Conflict",color:"text-[var(--color-error)] bg-[var(--color-error-muted)]"};default:return{label:t.mergeStatus,color:"text-[var(--color-text-secondary)] bg-[var(--color-surface)]"}}}function CXe(){const{closed:e}=h1(),{allAgents:t}=g0(),r=Date.now(),n=e.filter(i=>{const s=i.closedAt?new Date(i.closedAt).getTime():0;return r-s<_Xe}).sort((i,s)=>{const l=i.closedAt?new Date(i.closedAt).getTime():0;return(s.closedAt?new Date(s.closedAt).getTime():0)-l}).slice(0,kXe),a=new Map(t.map(i=>[i.id,i.name]));return n.length===0?null:o.jsxs("div",{"data-testid":"recent-completions",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] flex items-center gap-1.5",children:[o.jsx(tn,{className:"w-3.5 h-3.5"}),"Recent Completions"]}),o.jsxs("a",{href:"/tasks?status=closed",className:"text-xs text-[var(--color-primary)] hover:underline flex items-center gap-1",children:["View all",o.jsx(qh,{className:"w-3 h-3"})]})]}),o.jsx("div",{className:"space-y-1",children:n.map(i=>{const s=i.assignee?a.get(i.assignee):void 0,l=NXe(i),c=i.closedAt||i.updatedAt;return o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-[var(--color-surface-hover)] transition-colors duration-150 text-xs",children:[l?.label==="Merged"?o.jsx(Ri,{className:"w-3.5 h-3.5 text-[var(--color-success)] flex-shrink-0"}):o.jsx(Pi,{className:"w-3.5 h-3.5 text-[var(--color-success)] flex-shrink-0"}),o.jsx("span",{className:"font-medium text-[var(--color-text)] flex-shrink-0",children:i.externalRef||i.id}),o.jsx("span",{className:"text-[var(--color-text-secondary)] truncate flex-1",children:i.title}),s&&o.jsx("span",{className:"text-[var(--color-text-tertiary)] flex-shrink-0",children:s}),o.jsx("span",{className:"text-[var(--color-text-tertiary)] flex-shrink-0",children:EB(c)}),l&&o.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium flex-shrink-0 ${l.color}`,children:l.label})]},i.id)})})]})}const jXe=[{value:"all",label:"All"},{value:"tasks",label:"Tasks"},{value:"agents",label:"Agents"},{value:"workflows",label:"Workflows"}];function EXe(){const[e,t]=w.useState(!1),[r,n]=w.useState("all"),{data:a,isLoading:i,fetchNextPage:s,hasNextPage:l,isFetchingNextPage:c}=fJe({category:r,limit:20}),{sessionEvents:u,clearSessionEvents:d}=jB(r),f=w.useMemo(()=>a?.pages?a.pages.flatMap(b=>b.events):[],[a]),m=w.useCallback(()=>{l&&!c&&s()},[l,c,s]),p=b=>{console.log("Open in workspace:",b.elementId)},v=b=>{console.log("Open session in workspace:",b)};return o.jsxs("div",{"data-testid":"activity-feed-section",children:[o.jsxs("button",{onClick:()=>t(b=>!b),className:"flex items-center gap-2 w-full text-left text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] py-2 transition-colors duration-150","data-testid":"activity-feed-toggle",children:[o.jsx(gn,{className:`w-4 h-4 transition-transform duration-150 ${e?"rotate-90":""}`}),"Activity Feed",(u.length>0||f.length>0)&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:["(",u.length+f.length," events)"]})]}),e&&o.jsxs("div",{className:"space-y-4 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-1 p-1 bg-[var(--color-surface)] rounded-lg border border-[var(--color-border)]",children:[o.jsx(ru,{className:"w-4 h-4 text-[var(--color-text-tertiary)] ml-2 mr-1"}),jXe.map(b=>o.jsx("button",{onClick:()=>n(b.value),"data-testid":`activity-filter-${b.value}`,className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors duration-150 ${r===b.value?"bg-[var(--color-primary)] text-white":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}`,children:b.label},b.value))]}),u.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Live Activity"}),o.jsx("button",{onClick:d,className:"text-xs text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]",children:"Clear"})]}),o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:u.slice(0,5).map((b,y)=>o.jsx(mXe,{event:b,onOpenInWorkspace:v},`${b.sessionId}-${y}`))})]}),o.jsx(dXe,{events:f,isLoading:i||c,hasMore:l,onLoadMore:m,onOpenInWorkspace:p,emptyMessage:r==="all"?"No activity yet. Activity will appear here when agents start working on tasks.":`No ${r} activity to show.`})]})]})}function MXe(){const e=Ma(),{isConnected:t}=jB("all"),{data:r}=m1(),n=f1(),a=w.useCallback(()=>{window.location.reload()},[]);l6e(Pl("action.refreshActivity"),a,"Refresh Activity");const i=w.useCallback(c=>{e({to:"/workspaces",search:{layout:"single",agent:c,resumeSessionId:void 0,resumePrompt:void 0}})},[e]),s=w.useCallback(()=>{window.dispatchEvent(new CustomEvent("open-director-panel"))},[]),l=w.useCallback(async c=>{await n.mutateAsync({agentId:c,graceful:!0})},[n]);return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"activity-page",children:[o.jsxs("div",{className:"flex flex-col gap-3 @sm:flex-row @sm:items-center @sm:justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Hh,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Activity"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Command center for agent orchestration"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${t?"bg-[var(--color-success-muted)] text-[var(--color-success)]":"bg-[var(--color-error-muted)] text-[var(--color-error)]"}`,"data-testid":"activity-connection-status",children:t?o.jsxs(o.Fragment,{children:[o.jsx(t0,{className:"w-3 h-3"}),"Live"]}):o.jsxs(o.Fragment,{children:[o.jsx(vwe,{className:"w-3 h-3"}),"Offline"]})}),o.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${r?.isRunning?"bg-[var(--color-success-muted)] text-[var(--color-success)]":"bg-[var(--color-surface)] text-[var(--color-text-tertiary)]"}`,children:[o.jsx("span",{className:`inline-block w-1.5 h-1.5 rounded-full ${r?.isRunning?"bg-[var(--color-success)]":"bg-[var(--color-text-tertiary)]"}`}),"Daemon"]}),o.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-[var(--color-text-secondary)] rounded-md border border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":"activity-refresh",children:[o.jsx(jr,{className:"w-4 h-4"}),"Refresh",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] px-1 py-0.5 rounded border border-[var(--color-border)]",children:nm(Pl("action.refreshActivity"))})]})]})]}),o.jsx(SXe,{}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] mb-3",children:"Active Agents"}),o.jsx(wXe,{onOpenTerminal:i,onOpenDirectorPanel:s,onStopAgent:l})]}),o.jsx(CXe,{}),o.jsx(EXe,{})]})}function TXe({task:e,onDeleted:t}){const[r,n]=w.useState(!1),[a,i]=w.useState(!1),[s,l]=w.useState(null),c=w.useRef(null),u=w.useRef(null),d=gme();w.useEffect(()=>{function v(b){c.current&&!c.current.contains(b.target)&&n(!1)}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]),w.useEffect(()=>{if(!a)return;const v=b=>{b.key==="Escape"&&i(!1)};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[a]);const f=v=>{v.stopPropagation(),n(!1),i(!0)},m=async v=>{v.stopPropagation();try{await d.mutateAsync({taskId:e.id}),i(!1),t?.()}catch(b){console.error("Failed to delete task:",b)}},p=v=>{v.stopPropagation(),i(!1)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",ref:c,children:[o.jsx("button",{ref:u,onClick:v=>{if(v.stopPropagation(),!r&&u.current){const b=u.current.getBoundingClientRect();l({top:b.bottom,left:b.right})}n(!r)},className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-elevated)] rounded transition-colors","data-testid":"task-row-menu","aria-label":"Task actions",children:o.jsx(bwe,{className:"w-4 h-4"})}),r&&s&&o.jsx("div",{className:"fixed z-30 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-36",style:{top:s.top,left:s.left,transform:"translateX(-100%)"},"data-testid":"task-actions-menu",children:o.jsxs("button",{onClick:f,className:"w-full text-left px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2 transition-colors","data-testid":"task-action-delete",children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})})]}),a&&o.jsxs("div",{className:"fixed inset-0 z-50",onClick:p,"data-testid":"delete-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm",onClick:v=>v.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Task"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsx("div",{className:"px-5 py-4",children:o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-md border border-[var(--color-border)]",children:[o.jsx("p",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.title,children:e.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono mt-1",children:e.id})]})}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:p,disabled:d.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"delete-cancel",children:"Cancel"}),o.jsxs("button",{onClick:m,disabled:d.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"delete-confirm",children:[d.isPending&&o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Delete"]})]})]})})]})]})}function AXe({task:e,assigneeName:t,onStart:r,onComplete:n,onReopen:a,onClick:i,isStarting:s,isCompleting:l,isReopening:c,highlightedTitle:u,isSelected:d,onToggleSelect:f}){const m=e.metadata?.orchestrator,p=e.status==="open"&&e.assignee,v=e.status==="in_progress",b=e.status==="closed";return o.jsxs("tr",{className:"border-b border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] cursor-pointer transition-colors",onClick:i,"data-testid":`task-row-${e.id}`,children:[f&&o.jsx("td",{className:"pl-4 pr-1 py-3 w-10",children:o.jsx("input",{type:"checkbox",checked:d??!1,onChange:y=>{y.stopPropagation(),f(e.id)},onClick:y=>y.stopPropagation(),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)] cursor-pointer","data-testid":`task-row-checkbox-${e.id}`,"aria-label":`Select task ${e.title}`})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:o.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.title,children:u??e.title}),o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)] font-mono truncate",children:e.id})]})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:o.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[o.jsx(Vp,{status:e.status,mergeStatus:m?.mergeStatus}),e.status==="review"&&(m?.mergeStatus==="testing"||m?.mergeStatus==="merging")&&o.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-blue-600 dark:text-blue-400",title:"Steward reviewing",children:[o.jsx(Xr,{className:"w-3.5 h-3.5 animate-pulse"}),"Reviewing"]}),e.status==="closed"&&m?.mergeStatus==="merged"&&o.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-green-600 dark:text-green-400",children:[o.jsx(Ri,{className:"w-3.5 h-3.5"}),"Merged"]}),e.status==="closed"&&m?.mergeStatus&&m.mergeStatus!=="merged"&&o.jsx("span",{className:"inline-flex items-center text-orange-500 dark:text-orange-400",title:"Closed but not merged",children:o.jsx(Bn,{className:"w-3.5 h-3.5"})})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(Yp,{priority:e.priority,showIcon:!1})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(H6,{taskType:e.taskType})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:e.assignee?o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] min-w-0",children:[o.jsx(Zr,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:t||e.assignee})]}):o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"Unassigned"})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:m?.branch?o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)] min-w-0",children:[o.jsx(cu,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{className:"truncate font-mono",title:m.branch,children:m.branch.split("/").pop()})]}):o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"-"})}),o.jsx("td",{className:"px-4 py-3 text-xs text-[var(--color-text-tertiary)]",children:DXe(e.updatedAt)}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[p&&r&&o.jsx("button",{onClick:y=>{y.stopPropagation(),r()},disabled:s,className:"p-1.5 text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded disabled:opacity-50 transition-colors",title:"Start task","data-testid":"task-row-start",children:o.jsx(en,{className:"w-4 h-4"})}),v&&n&&o.jsx("button",{onClick:y=>{y.stopPropagation(),n()},disabled:l,className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded disabled:opacity-50 transition-colors",title:"Complete task","data-testid":"task-row-complete",children:o.jsx(Yn,{className:"w-4 h-4"})}),b&&a&&o.jsx("button",{onClick:y=>{y.stopPropagation(),a()},disabled:c,className:"p-1.5 text-amber-600 hover:bg-amber-100 dark:hover:bg-amber-900/30 rounded disabled:opacity-50 transition-colors",title:"Reopen task","data-testid":"task-row-reopen",children:o.jsx(Rs,{className:"w-4 h-4"})}),o.jsx(TXe,{task:e})]})})]})}function DXe(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/(1e3*60*60*24));if(a===0){const i=Math.floor(n/36e5);if(i===0){const s=Math.floor(n/6e4);return s<=1?"Just now":`${s}m ago`}return`${i}h ago`}return a===1?"Yesterday":a<7?`${a}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function LXe({taskId:e,onNavigateToTask:t}){const{data:r,isLoading:n,error:a}=lJe(e),[i,s]=w.useState(!0),[l,c]=w.useState(!0),[u,d]=w.useState(!1),f=cJe(),m=uJe(),p=r?.blockedBy??[],v=r?.blocks??[],b=r?.progress??{resolved:0,total:0},y=p.length===0&&v.length===0,S=k=>{f.mutate({taskId:e,blockerId:k},{onSuccess:()=>d(!1)})},_=k=>{m.mutate({taskId:e,blockerId:k})},N=p.map(k=>k.task.id);return n?o.jsx("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Loading dependencies..."]})}):a?o.jsx("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:o.jsxs("div",{className:"text-sm text-[var(--color-danger)]",children:["Failed to load dependencies: ",a.message]})}):o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]","data-testid":"dependencies-section",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:[o.jsx(Ox,{className:"w-3 h-3"}),"Dependencies"]}),b.total>0&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:[b.resolved,"/",b.total," resolved"]})]}),y&&o.jsx("div",{className:"text-sm text-[var(--color-text-tertiary)] mb-3","data-testid":"dependencies-empty",children:"No dependencies"}),p.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("button",{onClick:()=>s(!i),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] mb-2 hover:text-[var(--color-text)]","data-testid":"blocked-by-toggle",children:[i?o.jsx(cr,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),"Blocked By (",b.resolved,"/",b.total," resolved)"]}),i&&o.jsx("div",{className:"space-y-2","data-testid":"blocked-by-list",children:p.map(k=>o.jsx(kX,{dependency:k,onClick:t?()=>t(k.task.id):void 0,onRemove:()=>_(k.task.id),isRemoving:m.isPending&&m.variables?.blockerId===k.task.id},k.task.id))})]}),o.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors w-full mb-4","data-testid":"add-blocker-btn",children:[o.jsx(_r,{className:"w-4 h-4"}),"Add Blocker"]}),v.length>0&&o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>c(!l),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] mb-2 hover:text-[var(--color-text)]","data-testid":"blocks-toggle",children:[l?o.jsx(cr,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),"Blocks (",v.length,")"]}),l&&o.jsx("div",{className:"space-y-2","data-testid":"blocks-list",children:v.map(k=>o.jsx(kX,{dependency:k,onClick:t?()=>t(k.task.id):void 0},k.task.id))})]}),o.jsx(OXe,{isOpen:u,onClose:()=>d(!1),onSelect:S,excludeTaskIds:[e,...N],isAdding:f.isPending})]})}function kX({dependency:e,onClick:t,onRemove:r,isRemoving:n}){const{task:a}=e,i=a.status==="closed",s=!!t;return o.jsxs("div",{className:`w-full flex items-center gap-3 p-3 rounded-lg border border-[var(--color-border)] group ${i?"opacity-70":""} ${s?"hover:bg-[var(--color-surface-hover)] hover:border-[var(--color-primary)]":""} transition-colors`,"data-testid":`dependency-card-${a.id}`,children:[o.jsx(Fme,{status:a.status}),s?o.jsx("button",{onClick:t,className:`flex-1 text-sm text-[var(--color-text)] truncate text-left hover:text-[var(--color-primary)] ${i?"line-through":""}`,children:a.title}):o.jsx("span",{className:`flex-1 text-sm text-[var(--color-text)] truncate ${i?"line-through":""}`,children:a.title}),o.jsx(Ume,{priority:a.priority}),r&&o.jsx("button",{onClick:l=>{l.stopPropagation(),r()},disabled:n,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)] rounded opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50","aria-label":"Remove blocker","data-testid":`remove-blocker-${a.id}`,children:n?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(wt,{className:"w-4 h-4"})}),s&&!r&&o.jsx(qh,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]})}function OXe({isOpen:e,onClose:t,onSelect:r,excludeTaskIds:n,isAdding:a}){const[i,s]=w.useState(""),{data:l,isLoading:c}=b2(),u=w.useRef(null);if(w.useEffect(()=>{e&&u.current&&u.current.focus()},[e]),w.useEffect(()=>{if(e){const f=m=>{m.key==="Escape"&&!a&&t()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)}},[e,a,t]),w.useEffect(()=>{e&&s("")},[e]),!e)return null;const d=(l?.tasks??[]).filter(f=>n.includes(f.id)||f.status==="closed"?!1:i?f.title.toLowerCase().includes(i.toLowerCase()):!0);return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"add-blocker-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!a&&t()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col border border-[var(--color-border)]",children:[o.jsxs("div",{className:"p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Add Blocking Task"}),o.jsx("button",{onClick:t,disabled:a,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded","data-testid":"add-blocker-modal-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-3",children:"Select a task that must be completed before this task can proceed."}),o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{ref:u,type:"text",placeholder:"Search tasks...",value:i,onChange:f=>s(f.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]","data-testid":"add-blocker-search"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-text-tertiary)]"})}):d.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-tertiary)]","data-testid":"add-blocker-empty",children:i?"No tasks match your search":"No available tasks to add as blockers"}):o.jsx("div",{className:"space-y-2",children:d.map(f=>o.jsxs("button",{onClick:()=>r(f.id),disabled:a,className:"w-full flex items-center gap-3 p-3 text-left bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors disabled:opacity-50","data-testid":`add-blocker-item-${f.id}`,children:[o.jsx(Fme,{status:f.status}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] truncate",children:f.title}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:f.id})]}),o.jsx(Ume,{priority:f.priority}),a&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-primary)]"})]},f.id))})})]})]})}function Fme({status:e}){switch(e){case"open":return o.jsx(nu,{className:"w-4 h-4 text-blue-500"});case"in_progress":return o.jsx(ywe,{className:"w-4 h-4 text-yellow-500"});case"blocked":return o.jsx(Bn,{className:"w-4 h-4 text-red-500"});case"review":return o.jsx(du,{className:"w-4 h-4 text-purple-500"});case"closed":return o.jsx(Yn,{className:"w-4 h-4 text-green-500"});case"deferred":return o.jsx(tn,{className:"w-4 h-4 text-gray-500"});default:return o.jsx(nu,{className:"w-4 h-4 text-gray-400"})}}function Ume({priority:e}){const t=IXe(e);return o.jsxs("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${t.className}`,title:t.label,children:["P",e]})}function IXe(e){switch(e){case 1:return{label:"Critical",className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};case 2:return{label:"High",className:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"};case 3:return{label:"Medium",className:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"};case 4:return{label:"Low",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"};case 5:return{label:"Minimal",className:"bg-gray-100 text-gray-600 dark:bg-gray-800/50 dark:text-gray-400"};default:return{label:`P${e}`,className:"bg-gray-100 text-gray-600 dark:bg-gray-800/50 dark:text-gray-400"}}}const b0=new ax({headingStyle:"atx",codeBlockStyle:"fenced",bulletListMarker:"-",emDelimiter:"_",strongDelimiter:"**"});b0.addRule("highlight",{filter:"mark",replacement:function(e){return"=="+e+"=="}});b0.addRule("strikethrough",{filter:function(e){return e.nodeName==="S"||e.nodeName==="DEL"},replacement:function(e){return"~~"+e+"~~"}});b0.addRule("taskEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="taskEmbed"},replacement:function(e,t){const r=t.getAttribute("data-task-id");return r?`![[task:${r}]]`:""}});b0.addRule("documentEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="documentEmbed"},replacement:function(e,t){const r=t.getAttribute("data-document-id");return r?`![[doc:${r}]]`:""}});b0.addRule("mention",{filter:function(e){return e.nodeName==="A"&&e.hasAttribute("data-mention-id")},replacement:function(e,t){const r=t.getAttribute("data-mention-name");return r?`@${r}`:""}});b0.addRule("textAlign",{filter:function(e){if(!["P","H1","H2","H3","H4","H5","H6"].includes(e.nodeName))return!1;const t=e.getAttribute("style")||"";return/text-align:\s*(center|right|justify)/i.test(t)},replacement:function(e,t){const n=(t.getAttribute("style")||"").match(/text-align:\s*(center|right|justify)/i);if(!n)return e;const a=n[1].toLowerCase(),i=t.nodeName.toLowerCase();return i.startsWith("h")?`<${i} style="text-align: ${a}">${e}</${i}>

`:`<p style="text-align: ${a}">${e}</p>

`}});Ar.setOptions({gfm:!0,breaks:!0});function Hme(e){if(!e)return"<p></p>";let t=e;return t=t.replace(/!\[\[task:([\w-]+)\]\]/g,'<div data-type="taskEmbed" data-task-id="$1"></div>'),t=t.replace(/!\[\[doc:([\w-]+)\]\]/g,'<div data-type="documentEmbed" data-document-id="$1"></div>'),t=t.replace(/==([^=]+)==/g,"<mark>$1</mark>"),t=t.replace(/~~([^~]+)~~/g,"<s>$1</s>"),Ar.parse(t,{async:!1})}function w2({content:e,className:t="","data-testid":r}){const n=w.useMemo(()=>e?Hme(e):"",[e]);return e?o.jsx("div",{className:`markdown-content ${t}`,"data-testid":r,dangerouslySetInnerHTML:{__html:n}}):null}function qme(e){return{id:e.id,type:e.type,timestamp:typeof e.createdAt=="number"?e.createdAt:Date.parse(e.createdAt),content:e.content,toolName:e.toolName,toolInput:e.toolInput?JSON.parse(e.toolInput):void 0,toolOutput:e.toolOutput,isError:e.isError}}function Wme({events:e}){return e.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-[var(--color-text-muted)] p-6",children:[o.jsx(ss,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No transcript available for this session"})]}):o.jsx("div",{className:"p-3 space-y-2 overflow-y-auto h-full",children:e.map(t=>o.jsx(RXe,{event:t},t.id))})}function RXe({event:e}){const t={assistant:{bg:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-700 dark:text-blue-300"},user:{bg:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-700 dark:text-purple-300"},tool_use:{bg:"bg-amber-50 dark:bg-amber-900/20",text:"text-amber-700 dark:text-amber-300"},tool_result:{bg:"bg-green-50 dark:bg-green-900/20",text:"text-green-700 dark:text-green-300"},system:{bg:"bg-gray-50 dark:bg-gray-800/50",text:"text-gray-600 dark:text-gray-400"},error:{bg:"bg-red-50 dark:bg-red-900/20",text:"text-red-700 dark:text-red-300"}},r=t[e.type]||t.system,n=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:`rounded-md border overflow-hidden ${r.bg} border-[var(--color-border)]/30`,children:[o.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 ${r.text}`,children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",children:e.type.replace("_"," ")}),e.toolName&&o.jsx("span",{className:"text-xs font-mono opacity-75",children:e.toolName}),o.jsx("span",{className:"ml-auto text-xs opacity-50",children:n})]}),e.content&&o.jsx("div",{className:"px-3 py-2 border-t border-[var(--color-border)]/30",children:e.type==="assistant"||e.type==="user"?o.jsx(w2,{content:e.content,className:"text-sm text-[var(--color-text)]"}):o.jsx("div",{className:"text-sm whitespace-pre-wrap break-words text-[var(--color-text)]",children:e.content})})]})}const PXe=[{value:1,label:"Critical"},{value:2,label:"High"},{value:3,label:"Medium"},{value:4,label:"Low"},{value:5,label:"Minimal"}],zXe=[{value:"backlog",label:"Backlog"},{value:"open",label:"Open"},{value:"in_progress",label:"In Progress"},{value:"blocked",label:"Blocked"},{value:"review",label:"Review"},{value:"deferred",label:"Deferred"},{value:"closed",label:"Closed"}],_X=[{value:1,label:"Trivial"},{value:2,label:"Simple"},{value:3,label:"Moderate"},{value:4,label:"Complex"},{value:5,label:"Very Complex"}];function BXe({taskId:e,onClose:t,onNavigateToTask:r}){const{data:n,isLoading:a,error:i}=XQe(e),{data:s}=d1("worker"),{data:l}=ime(),{data:c}=y2(),u=fme(),d=gme(),f=hme(),m=mme(),p=pme(),v=eJe(),b=tJe(),[y,S]=w.useState(!1),[_,N]=w.useState(!1),[k,j]=w.useState(!1),[E,T]=w.useState(null),O=n?.task,R=s?.agents??[],q=l?.items??[],$=new Map;c&&c.forEach(Y=>$.set(Y.id,Y.name));const L=O?.metadata?.orchestrator,A=O?.description,M=O?.status==="open"&&O?.assignee,z=O?.status==="in_progress",I=O?.status==="closed",B=O?.assignee||O?.status==="in_progress"||O?.status==="review"||O?.status==="closed",F=async Y=>{if(O)try{await u.mutateAsync({taskId:O.id,...Y}),T(null)}catch{}},U=async Y=>{if(O)try{await b.mutateAsync({taskId:O.id,mergeStatus:Y})}catch{}},V=async()=>{if(O)try{await d.mutateAsync({taskId:O.id}),t()}catch{}},K=async()=>{O&&await f.mutateAsync({taskId:O.id})},G=async()=>{O&&await m.mutateAsync({taskId:O.id})},J=async Y=>{O&&(await p.mutateAsync({taskId:O.id,message:Y||void 0}),N(!1))},ee=async()=>{O&&(await v.mutateAsync({taskId:O.id}),j(!1))};return a?o.jsx("div",{className:"h-full flex items-center justify-center bg-[var(--color-surface)]","data-testid":"task-detail-loading",children:o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading task..."})]})}):i||!O?o.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-[var(--color-surface)]","data-testid":"task-detail-error",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:i?.message||"Task not found"}),o.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 text-sm text-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] rounded-md",children:"Close"})]}):o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-surface)]","data-testid":"task-detail-panel",children:[y&&o.jsx(ZXe,{taskTitle:O.title,onConfirm:V,onCancel:()=>S(!1),isDeleting:d.isPending}),_&&o.jsx(Kme,{taskTitle:O.title,onConfirm:J,onCancel:()=>N(!1),isReopening:p.isPending}),k&&o.jsx(XXe,{taskTitle:O.title,onConfirm:ee,onCancel:()=>j(!1),isResetting:v.isPending}),o.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Vp,{status:O.status,mergeStatus:L?.mergeStatus}),O.status==="review"&&(L?.mergeStatus==="testing"||L?.mergeStatus==="merging")&&o.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-blue-600 dark:text-blue-400",title:"Steward reviewing",children:[o.jsx(Xr,{className:"w-3.5 h-3.5 animate-pulse"}),"Reviewing"]}),o.jsx(Yp,{priority:O.priority}),o.jsx(H6,{taskType:O.taskType})]}),o.jsx(FXe,{value:O.title,onSave:Y=>F({title:Y}),isUpdating:u.isPending&&E==="title",onEdit:()=>T("title")}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-[var(--color-text-tertiary)] font-mono",children:[o.jsx("span",{"data-testid":"task-detail-id",children:O.id}),O.ephemeral&&o.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 rounded text-[10px]",children:"Ephemeral"})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[B&&o.jsx("button",{onClick:()=>j(!0),className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-amber-600 hover:bg-amber-100 dark:hover:text-amber-400 dark:hover:bg-amber-900/30 rounded transition-colors","aria-label":"Reset task",title:"Reset task to open, clearing assignee and work data","data-testid":"task-reset-btn",children:o.jsx(jO,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>S(!0),className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)] rounded transition-colors","aria-label":"Delete task","data-testid":"task-delete-btn",children:o.jsx(Sr,{className:"w-5 h-5"})}),o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Close panel","data-testid":"task-detail-close",children:o.jsx(wt,{className:"w-5 h-5"})})]})]}),(M||z||I)&&o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface-elevated)]",children:[M&&o.jsxs("button",{onClick:K,disabled:f.isPending,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-primary-muted)] hover:bg-[var(--color-primary-muted)]/80 rounded-md disabled:opacity-50 transition-colors","data-testid":"task-start-btn",children:[o.jsx(en,{className:"w-4 h-4"}),f.isPending?"Starting...":"Start Task"]}),z&&o.jsxs("button",{onClick:G,disabled:m.isPending,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-green-700 bg-green-100 hover:bg-green-200 dark:text-green-300 dark:bg-green-900/30 dark:hover:bg-green-900/50 rounded-md disabled:opacity-50 transition-colors","data-testid":"task-complete-btn",children:[o.jsx(Yn,{className:"w-4 h-4"}),m.isPending?"Completing...":"Complete Task"]}),I&&o.jsxs("button",{onClick:()=>N(!0),disabled:p.isPending,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-amber-700 bg-amber-100 hover:bg-amber-200 dark:text-amber-300 dark:bg-amber-900/30 dark:hover:bg-amber-900/50 rounded-md disabled:opacity-50 transition-colors","data-testid":"task-reopen-btn",children:[o.jsx(Rs,{className:"w-4 h-4"}),p.isPending?"Reopening...":"Reopen Task"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsx($v,{label:"Status",icon:o.jsx(Yn,{className:"w-3 h-3"}),children:o.jsx(HXe,{value:O.status,onSave:Y=>F({status:Y}),isUpdating:u.isPending&&E==="status"})}),o.jsx($v,{label:"Priority",children:o.jsx(qXe,{value:O.priority,onSave:Y=>F({priority:Y}),isUpdating:u.isPending&&E==="priority"})}),o.jsx($v,{label:"Assigned To",icon:o.jsx(Zr,{className:"w-3 h-3"}),children:o.jsx(WXe,{value:O.assignee,entityNameMap:$,workers:R,operators:q,onSave:Y=>F({assignee:Y??null}),isUpdating:u.isPending&&E==="assignee"})}),o.jsx($v,{label:"Complexity",children:o.jsx(KXe,{value:O.complexity,onSave:Y=>F({complexity:Y}),isUpdating:u.isPending&&E==="complexity"})}),o.jsx($v,{label:"Deadline",icon:o.jsx(r0,{className:"w-3 h-3"}),children:o.jsx(YXe,{value:O.deadline,onSave:Y=>F({deadline:Y??null}),isUpdating:u.isPending&&E==="deadline"})})]}),o.jsx(QXe,{tags:O.tags,onSave:Y=>F({tags:Y}),isUpdating:u.isPending&&E==="tags",onEdit:()=>T("tags")}),o.jsx(JXe,{value:A,onSave:Y=>F({description:Y??null}),isUpdating:u.isPending&&E==="description",onEdit:()=>T("description")}),o.jsx(eet,{taskId:O.id}),o.jsx(LXe,{taskId:O.id,onNavigateToTask:r}),L?.sessionHistory&&L.sessionHistory.length>0&&o.jsx(iet,{sessionHistory:L.sessionHistory,entityNameMap:$}),L&&o.jsx($Xe,{meta:L,onUpdateMergeStatus:U,isUpdatingMergeStatus:b.isPending}),o.jsx("div",{className:"mt-6 pt-4 border-t border-[var(--color-border)]",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-[var(--color-text-tertiary)]",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Created:"})," ",o.jsx("span",{title:dh(O.createdAt),children:jl(O.createdAt)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Updated:"})," ",o.jsx("span",{title:dh(O.updatedAt),children:jl(O.updatedAt)})]}),O.closedAt&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Closed:"})," ",o.jsx("span",{title:dh(O.closedAt),children:jl(O.closedAt)})]})]})}),u.isError&&o.jsxs("div",{className:"mt-4 p-3 bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-lg text-sm text-[var(--color-danger)]",children:["Failed to update: ",u.error?.message]})]})]})}function $Xe({meta:e,onUpdateMergeStatus:t,isUpdatingMergeStatus:r}){return e?o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Orchestrator Info"}),o.jsxs("div",{className:"space-y-3",children:[e.branch&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(cu,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"font-mono text-[var(--color-text)]",children:e.branch})]}),e.mergeStatus&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Ri,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),t?o.jsx(VXe,{value:e.mergeStatus,onSave:t,isUpdating:r??!1}):o.jsx(Qp,{status:e.mergeStatus}),e.mergeFailureReason&&o.jsx("span",{className:"text-xs text-[var(--color-danger)]",children:e.mergeFailureReason})]}),e.lastTestResult&&o.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[o.jsx(O6,{className:"w-4 h-4 text-[var(--color-text-tertiary)] mt-0.5"}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:`font-medium ${e.lastTestResult.passed?"text-green-600 dark:text-green-400":"text-[var(--color-danger)]"}`,children:["Tests: ",e.lastTestResult.passed?"Passed":"Failed"]}),e.testRunCount&&e.testRunCount>1&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:["(Run #",e.testRunCount,")"]})]}),e.lastTestResult.totalTests!==void 0&&o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[e.lastTestResult.passedTests??0,"/",e.lastTestResult.totalTests," passed",e.lastTestResult.failedTests?`, ${e.lastTestResult.failedTests} failed`:"",e.lastTestResult.skippedTests?`, ${e.lastTestResult.skippedTests} skipped`:""]}),e.lastTestResult.errorMessage&&o.jsx("div",{className:"mt-1 text-xs text-[var(--color-danger)] font-mono",children:e.lastTestResult.errorMessage})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)] pt-2 border-t border-[var(--color-border)]",children:[e.startedAt&&o.jsxs("div",{children:["Started: ",jl(e.startedAt)]}),e.completedAt&&o.jsxs("div",{children:["Completed: ",jl(e.completedAt)]}),e.mergedAt&&o.jsxs("div",{children:["Merged: ",jl(e.mergedAt)]})]})]})]}):null}function $v({label:e,icon:t,children:r}){return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-1",children:[t,e]}),r]})}function FXe({value:e,onSave:t,isUpdating:r,onEdit:n}){const[a,i]=w.useState(!1),[s,l]=w.useState(e),c=w.useRef(null);w.useEffect(()=>{a&&c.current&&(c.current.focus(),c.current.select())},[a]),w.useEffect(()=>{l(e)},[e]);const u=()=>{s.trim()&&s!==e&&(n(),t(s.trim())),i(!1)},d=f=>{f.key==="Enter"?u():f.key==="Escape"&&(l(e),i(!1))};return a?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{ref:c,type:"text",value:s,onChange:f=>l(f.target.value),onBlur:u,onKeyDown:d,className:"flex-1 text-lg font-semibold text-[var(--color-text)] border border-[var(--color-primary)] rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)]","data-testid":"task-title-input"}),r&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]}):o.jsxs("div",{className:"flex items-center gap-2 group",children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)] cursor-pointer hover:text-[var(--color-primary)] transition-colors",onClick:()=>i(!0),"data-testid":"task-detail-title",children:e}),o.jsx("button",{onClick:()=>i(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit title",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})}),r&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]})}const UXe={backlog:["open","deferred","closed"],open:["in_progress","blocked","deferred","backlog","closed"],in_progress:["open","blocked","deferred","review","closed"],blocked:["open","in_progress","deferred","closed"],deferred:["open","in_progress","backlog"],review:["closed","in_progress"],closed:["open"],tombstone:[]};function HXe({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),i=w.useRef(null),s=UXe[e]||[],l=zXe.filter(c=>c.value===e||s.includes(c.value));return w.useEffect(()=>{function c(u){i.current&&!i.current.contains(u.target)&&a(!1)}return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),o.jsxs("div",{className:"relative",ref:i,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 hover:ring-2 hover:ring-[var(--color-primary)] rounded transition-all",disabled:r,"data-testid":"task-status-dropdown",children:[o.jsx(Vp,{status:e}),r&&o.jsx($e,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[140px]",children:l.map(c=>o.jsxs("button",{onClick:()=>{c.value!==e&&t(c.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${c.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Vp,{status:c.value}),c.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},c.value))})]})}function qXe({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),i=w.useRef(null);return w.useEffect(()=>{function s(l){i.current&&!i.current.contains(l.target)&&a(!1)}return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),o.jsxs("div",{className:"relative",ref:i,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 hover:ring-2 hover:ring-[var(--color-primary)] rounded transition-all",disabled:r,"data-testid":"task-priority-dropdown",children:[o.jsx(Yp,{priority:e}),r&&o.jsx($e,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[120px]",children:PXe.map(s=>o.jsxs("button",{onClick:()=>{s.value!==e&&t(s.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${s.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Yp,{priority:s.value,showIcon:!1}),s.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},s.value))})]})}function WXe({value:e,entityNameMap:t,workers:r,operators:n,onSave:a,isUpdating:i}){const[s,l]=w.useState(!1),c=w.useRef(null),u=e?t.get(e):void 0,d=e?n.some(f=>f.id===e):!1;return w.useEffect(()=>{function f(m){c.current&&!c.current.contains(m.target)&&l(!1)}return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),o.jsxs("div",{className:"relative",ref:c,children:[o.jsxs("button",{onClick:()=>l(!s),className:"flex items-center gap-2 px-2 py-1 text-sm rounded bg-[var(--color-surface-elevated)] hover:ring-2 hover:ring-[var(--color-primary)] transition-all",disabled:i,"data-testid":"task-assignee-dropdown",children:[d?o.jsx(Zr,{className:"w-3.5 h-3.5 text-blue-500"}):e?o.jsx(Xr,{className:"w-3.5 h-3.5 text-purple-500"}):o.jsx(Zr,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:u?"text-[var(--color-text)]":"text-[var(--color-text-tertiary)] italic",children:u||"Unassigned"}),i&&o.jsx($e,{className:"w-3 h-3 animate-spin"})]}),s&&o.jsxs("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[180px] max-h-[280px] overflow-y-auto",children:[o.jsxs("button",{onClick:()=>{e&&a(null),l(!1)},className:`w-full text-left px-3 py-2 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${e?"":"bg-[var(--color-surface-elevated)]"}`,children:[o.jsx(Zr,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"text-[var(--color-text-tertiary)] italic",children:"Unassigned"}),!e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]}),n.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-t border-[var(--color-border)] my-1"}),o.jsx("div",{className:"px-3 py-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wider",children:"Operators"}),n.map(f=>o.jsxs("button",{onClick:()=>{f.id!==e&&a(f.id),l(!1)},className:`w-full text-left px-3 py-2 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${f.id===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Zr,{className:"w-3.5 h-3.5 text-blue-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:f.name}),f.id===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},f.id))]}),o.jsx("div",{className:"border-t border-[var(--color-border)] my-1"}),o.jsx("div",{className:"px-3 py-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wider",children:"Worker Agents"}),r.length===0?o.jsx("div",{className:"px-3 py-2 text-xs text-[var(--color-text-tertiary)]",children:"No worker agents available"}):r.map(f=>o.jsxs("button",{onClick:()=>{f.id!==e&&a(f.id),l(!1)},className:`w-full text-left px-3 py-2 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${f.id===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Xr,{className:"w-3.5 h-3.5 text-purple-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:f.name}),f.id===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},f.id))]})]})}function KXe({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),i=w.useRef(null);w.useEffect(()=>{function l(c){i.current&&!i.current.contains(c.target)&&a(!1)}return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const s=_X.find(l=>l.value===e)?.label??"Unknown";return o.jsxs("div",{className:"relative",ref:i,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 px-2 py-1 text-sm rounded bg-[var(--color-surface-elevated)] hover:ring-2 hover:ring-[var(--color-primary)] transition-all",disabled:r,"data-testid":"task-complexity-dropdown",children:[o.jsx("span",{className:"text-[var(--color-text)]",children:s}),r&&o.jsx($e,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[120px]",children:_X.map(l=>o.jsxs("button",{onClick:()=>{l.value!==e&&t(l.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${l.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx("span",{className:"text-[var(--color-text)]",children:l.label}),l.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},l.value))})]})}const GXe=[{value:"pending",label:"Pending"},{value:"testing",label:"Testing"},{value:"merging",label:"Merging"},{value:"merged",label:"Merged"},{value:"conflict",label:"Conflict"},{value:"test_failed",label:"Test Failed"},{value:"failed",label:"Failed"},{value:"not_applicable",label:"N/A"}];function VXe({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),i=w.useRef(null);return w.useEffect(()=>{function s(l){i.current&&!i.current.contains(l.target)&&a(!1)}return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),o.jsxs("div",{className:"relative",ref:i,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 hover:ring-2 hover:ring-[var(--color-primary)] rounded transition-all",disabled:r,"data-testid":"merge-status-dropdown",children:[o.jsx(Qp,{status:e}),r&&o.jsx($e,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[140px]",children:GXe.map(s=>o.jsxs("button",{onClick:()=>{s.value!==e&&t(s.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${s.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Qp,{status:s.value}),s.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},s.value))})]})}function YXe({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),[i,s]=w.useState(e?e.split("T")[0]:""),l=w.useRef(null);w.useEffect(()=>{n&&l.current&&l.current.focus()},[n]),w.useEffect(()=>{s(e?e.split("T")[0]:"")},[e]);const c=()=>{const f=i?new Date(i).toISOString():null;f!==e&&(f||e)&&t(f),a(!1)},u=f=>{f.key==="Enter"?c():f.key==="Escape"&&(s(e?e.split("T")[0]:""),a(!1))},d=()=>{e&&t(null),a(!1)};return n?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{ref:l,type:"date",value:i,onChange:f=>s(f.target.value),onBlur:c,onKeyDown:u,className:"text-sm text-[var(--color-text)] border border-[var(--color-primary)] rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)]","data-testid":"task-deadline-input"}),e&&o.jsx("button",{onClick:d,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] rounded","aria-label":"Clear deadline",children:o.jsx(wt,{className:"w-4 h-4"})}),r&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]}):o.jsxs("div",{className:"flex items-center gap-2 group",children:[o.jsx("span",{className:`text-sm cursor-pointer hover:text-[var(--color-primary)] transition-colors ${e?"text-[var(--color-text)]":"text-[var(--color-text-tertiary)] italic"}`,onClick:()=>a(!0),"data-testid":"task-deadline-display",children:e?Gme(e):"No deadline"}),o.jsx("button",{onClick:()=>a(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit deadline",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})}),r&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]})}function QXe({tags:e,onSave:t,isUpdating:r,onEdit:n}){const[a,i]=w.useState(!1),[s,l]=w.useState(e),[c,u]=w.useState(""),d=w.useRef(null);w.useEffect(()=>{a&&d.current&&d.current.focus()},[a]),w.useEffect(()=>{l(e)},[e]);const f=()=>{const b=c.trim().toLowerCase();b&&!s.includes(b)&&(l([...s,b]),u(""))},m=b=>{l(s.filter(y=>y!==b))},p=b=>{b.key==="Enter"||b.key===","?(b.preventDefault(),f()):b.key==="Escape"?(l(e),u(""),i(!1)):b.key==="Backspace"&&!c&&s.length>0&&l(s.slice(0,-1))},v=()=>{JSON.stringify(s.sort())!==JSON.stringify([...e].sort())&&(n(),t(s)),i(!1),u("")};return a?o.jsxs("div",{className:"mb-6","data-testid":"tags-editor",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:[o.jsx(Vc,{className:"w-3 h-3"}),"Tags"]}),o.jsx("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:"Enter to add, Esc to cancel"})]}),o.jsxs("div",{className:"p-2 border border-[var(--color-primary)] rounded-lg bg-[var(--color-input-bg)] focus-within:ring-2 focus-within:ring-[var(--color-primary)]",children:[o.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:s.map(b=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300 rounded-full",children:[b,o.jsx("button",{type:"button",onClick:()=>m(b),className:"hover:text-red-600 dark:hover:text-red-400 transition-colors","aria-label":`Remove ${b}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},b))}),o.jsx("input",{ref:d,type:"text",value:c,onChange:b=>u(b.target.value),onKeyDown:p,onBlur:()=>{c.trim()&&f()},placeholder:"Type tag and press Enter...",className:"w-full text-sm bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none","data-testid":"tags-input"})]}),o.jsxs("div",{className:"flex items-center justify-end gap-2 mt-2",children:[r&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"}),o.jsx("button",{onClick:()=>{l(e),u(""),i(!1)},className:"px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded transition-colors",children:"Cancel"}),o.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:opacity-90 rounded transition-colors",children:"Save"})]})]}):o.jsxs("div",{className:"mb-6 group","data-testid":"tags-section",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:[o.jsx(Vc,{className:"w-3 h-3"}),"Tags"]}),o.jsx("button",{onClick:()=>i(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit tags",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})})]}),e.length>0?o.jsx("div",{className:"flex flex-wrap gap-1.5 p-2 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)] cursor-pointer hover:border-[var(--color-primary)] transition-colors",onClick:()=>i(!0),children:e.map(b=>o.jsx("span",{className:"px-2.5 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300 rounded-full",children:b},b))}):o.jsx("button",{onClick:()=>i(!0),className:"w-full p-2 text-sm text-[var(--color-text-tertiary)] italic bg-[var(--color-surface-elevated)] rounded-lg border border-dashed border-[var(--color-border)] hover:border-[var(--color-primary)] hover:text-[var(--color-text-secondary)] transition-colors text-left","data-testid":"add-tags-btn",children:"Add tags..."}),r&&o.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),"Saving..."]})]})}function JXe({value:e,onSave:t,isUpdating:r,onEdit:n}){const[a,i]=w.useState(!1),[s,l]=w.useState(e??""),c=w.useRef(null),u=w.useRef(0);w.useEffect(()=>{a&&c.current&&(u.current=s.length,c.current.focus(),c.current.setSelectionRange(u.current,u.current))},[a]),w.useEffect(()=>{l(e??"")},[e]);const d=()=>{const m=s.trim();m!==(e??"")&&(n(),t(m||null)),i(!1)},f=m=>{m.key==="Escape"&&(l(e??""),i(!1)),m.key==="Enter"&&(m.ctrlKey||m.metaKey)&&d()};return a?o.jsxs("div",{className:"mb-6","data-testid":"description-editor",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:"Description"}),o.jsx("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:"Ctrl+Enter to save, Esc to cancel"})]}),o.jsx("div",{className:"relative",children:o.jsx("textarea",{ref:c,value:s,onChange:m=>l(m.target.value),onKeyDown:f,rows:8,placeholder:"Add a description (supports markdown)...",className:"w-full p-3 text-sm border border-[var(--color-primary)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)] resize-y min-h-[120px]","data-testid":"task-description-input"})}),o.jsxs("div",{className:"flex items-center justify-end gap-2 mt-2",children:[r&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"}),o.jsx("button",{onClick:()=>{l(e??""),i(!1)},className:"px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded transition-colors",children:"Cancel"}),o.jsx("button",{onClick:d,className:"px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:opacity-90 rounded transition-colors",children:"Save"})]})]}):o.jsxs("div",{className:"mb-6 group","data-testid":"description-section",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:"Description"}),o.jsx("button",{onClick:()=>i(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit description",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})})]}),e?o.jsx("div",{onClick:()=>i(!0),className:"p-3 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)] cursor-pointer hover:border-[var(--color-primary)] transition-colors",children:o.jsx(w2,{content:e,className:"text-sm text-[var(--color-text)] prose prose-sm dark:prose-invert max-w-none","data-testid":"task-description"})}):o.jsx("button",{onClick:()=>i(!0),className:"w-full p-3 text-sm text-[var(--color-text-tertiary)] italic bg-[var(--color-surface-elevated)] rounded-lg border border-dashed border-[var(--color-border)] hover:border-[var(--color-primary)] hover:text-[var(--color-text-secondary)] transition-colors text-left","data-testid":"add-description-btn",children:"Add a description..."}),r&&o.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),"Saving..."]})]})}function ZXe({taskTitle:e,onConfirm:t,onCancel:r,isDeleting:n}){return w.useEffect(()=>{const a=i=>{i.key==="Escape"&&!n&&r()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n,r]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"delete-confirm-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!n&&r()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-[var(--color-danger-muted)] flex items-center justify-center",children:o.jsx(Sr,{className:"w-5 h-5 text-[var(--color-danger)]"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Task"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Are you sure you want to delete"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e,'"']}),"? This action cannot be undone."]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"delete-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:t,disabled:n,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 disabled:opacity-50","data-testid":"delete-confirm-btn",children:n?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})})]})]})]})}function Kme({taskTitle:e,onConfirm:t,onCancel:r,isReopening:n}){const[a,i]=w.useState(""),s=w.useRef(null);return w.useEffect(()=>{s.current&&s.current.focus()},[]),w.useEffect(()=>{const l=c=>{c.key==="Escape"&&!n&&r()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[n,r]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"reopen-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!n&&r()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:o.jsx(Rs,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Reopen Task"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Reopen ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e,'"']}),"? This will clear the assignee and merge metadata."]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Message (optional)"}),o.jsx("textarea",{ref:s,value:a,onChange:l=>i(l.target.value),placeholder:"Why is this task being reopened?",rows:3,className:"w-full p-3 text-sm border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-[var(--color-input-bg)] text-[var(--color-text)] resize-y","data-testid":"reopen-message-input"})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"reopen-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:()=>t(a.trim()||void 0),disabled:n,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-md hover:bg-amber-700 disabled:opacity-50","data-testid":"reopen-confirm-btn",children:n?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Reopening..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reopen"]})})]})]})]})}function XXe({taskTitle:e,onConfirm:t,onCancel:r,isResetting:n}){return w.useEffect(()=>{const a=i=>{i.key==="Escape"&&!n&&r()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n,r]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"reset-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!n&&r()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:o.jsx(jO,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Reset Task"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Reset ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e,'"']}),"? This will:"]}),o.jsxs("ul",{className:"mt-2 text-sm text-[var(--color-text-secondary)] list-disc list-inside space-y-1",children:[o.jsx("li",{children:"Set status back to open"}),o.jsx("li",{children:"Remove the assignee"}),o.jsx("li",{children:"Clear merge status"}),o.jsx("li",{children:"Remove branch/worktree metadata"}),o.jsx("li",{children:"Remove session ID"})]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"reset-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:t,disabled:n,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-md hover:bg-amber-700 disabled:opacity-50","data-testid":"reset-confirm-btn",children:n?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Resetting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(jO,{className:"w-4 h-4"}),"Reset Task"]})})]})]})]})}function Gme(e){return new Date(e).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function dh(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function jl(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:Gme(e)}function eet({taskId:e}){const[t,r]=w.useState(!0),[n,a]=w.useState(!1),{data:i,isLoading:s}=nJe(e),l=aJe(),c=iJe(),[u,d]=w.useState(null),f=v=>{l.mutate({taskId:e,documentId:v},{onSuccess:()=>a(!1)})},m=v=>{d(v),c.mutate({taskId:e,documentId:v},{onSettled:()=>d(null)})},p=i?.map(v=>v.id)||[];return o.jsxs("div",{className:"mb-6","data-testid":"attachments-section",children:[o.jsxs("button",{onClick:()=>r(!t),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-2 hover:text-[var(--color-text)]","data-testid":"attachments-toggle",children:[t?o.jsx(cr,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),o.jsx(HC,{className:"w-3 h-3"}),"Attachments (",i?.length||0,")"]}),t&&o.jsxs("div",{className:"space-y-2",children:[s?o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Loading attachments..."]}):i&&i.length>0?i.map(v=>o.jsx(net,{doc:v,onRemove:()=>m(v.id),isRemoving:u===v.id},v.id)):o.jsx("div",{className:"text-sm text-[var(--color-text-tertiary)]","data-testid":"attachments-empty",children:"No documents attached"}),o.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors w-full","data-testid":"attach-document-btn",children:[o.jsx(_r,{className:"w-4 h-4"}),"Attach Document"]})]}),o.jsx(aet,{isOpen:n,onClose:()=>a(!1),onSelect:f,alreadyAttachedIds:p,isAttaching:l.isPending})]})}function tet(e){if(!e)return"";const t=e.split(`
`)[0].trim();return t.length>100?t.substring(0,100)+"...":t}function ret(e,t){if(t==="json")try{const r=JSON.stringify(JSON.parse(e),null,2);return o.jsx("pre",{className:"text-xs font-mono bg-[var(--color-surface)] p-3 rounded overflow-x-auto whitespace-pre-wrap text-[var(--color-text)]",children:r})}catch{return o.jsx("pre",{className:"text-xs font-mono bg-[var(--color-surface)] p-3 rounded overflow-x-auto whitespace-pre-wrap text-[var(--color-text)]",children:e})}return t==="markdown"?o.jsx(w2,{content:e,className:"text-sm text-[var(--color-text)] prose prose-sm dark:prose-invert max-w-none","data-testid":"attachment-markdown-content"}):o.jsx("pre",{className:"whitespace-pre-wrap font-sans text-sm text-[var(--color-text)]",children:e})}function net({doc:e,onRemove:t,isRemoving:r}){const[n,a]=w.useState(!1),i=tet(e.content);return o.jsxs("div",{className:"border border-[var(--color-border)] rounded-lg overflow-hidden","data-testid":`attachment-item-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[var(--color-surface-elevated)] group",children:[o.jsx("button",{onClick:()=>a(!n),className:"p-1 hover:bg-[var(--color-surface-hover)] rounded flex-shrink-0","data-testid":`attachment-expand-${e.id}`,"aria-label":n?"Collapse":"Expand",children:n?o.jsx(cr,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}):o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})}),o.jsx(rn,{className:"w-4 h-4 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-primary)] truncate",children:e.title||"Untitled Document"}),o.jsx("span",{className:"px-1.5 py-0.5 bg-[var(--color-surface)] text-[var(--color-text-tertiary)] rounded text-[10px] flex-shrink-0",children:e.contentType})]}),!n&&i&&o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)] truncate mt-0.5","data-testid":`attachment-preview-${e.id}`,children:i})]}),o.jsx("button",{onClick:t,disabled:r,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)] rounded opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50","aria-label":"Remove attachment","data-testid":`attachment-remove-${e.id}`,children:r?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(wt,{className:"w-4 h-4"})})]}),n&&e.content&&o.jsx("div",{className:"p-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":`attachment-content-${e.id}`,children:ret(e.content,e.contentType)}),n&&!e.content&&o.jsx("div",{className:"p-3 border-t border-[var(--color-border)] bg-[var(--color-surface)] text-sm text-[var(--color-text-tertiary)] italic","data-testid":`attachment-content-${e.id}`,children:"No content available"})]})}function aet({isOpen:e,onClose:t,onSelect:r,alreadyAttachedIds:n,isAttaching:a}){const[i,s]=w.useState(""),{data:l,isLoading:c}=sJe(i),u=w.useRef(null);if(w.useEffect(()=>{e&&u.current&&u.current.focus()},[e]),w.useEffect(()=>{if(e){const f=m=>{m.key==="Escape"&&!a&&t()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)}},[e,a,t]),!e)return null;const d=l?.filter(f=>!n.includes(f.id))||[];return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"document-picker-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!a&&t()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col border border-[var(--color-border)]",children:[o.jsxs("div",{className:"p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Attach Document"}),o.jsx("button",{onClick:t,disabled:a,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded","data-testid":"document-picker-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{ref:u,type:"text",placeholder:"Search documents...",value:i,onChange:f=>s(f.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]","data-testid":"document-picker-search"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-text-tertiary)]"})}):d.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-tertiary)]","data-testid":"document-picker-empty",children:l?.length===0?"No documents available":i?"No documents match your search":"All documents are already attached"}):o.jsx("div",{className:"space-y-2",children:d.map(f=>o.jsxs("button",{onClick:()=>r(f.id),disabled:a,className:"w-full flex items-center gap-3 p-3 text-left bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors disabled:opacity-50","data-testid":`document-picker-item-${f.id}`,children:[o.jsx(rn,{className:"w-5 h-5 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] truncate",children:f.title||"Untitled Document"}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)] flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:f.id}),o.jsx("span",{className:"px-1.5 py-0.5 bg-[var(--color-surface)] text-[var(--color-text-tertiary)] rounded",children:f.contentType})]})]}),a&&o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-primary)]"})]},f.id))})})]})]})}function iet({sessionHistory:e,entityNameMap:t}){const[r,n]=w.useState(!0),[a,i]=w.useState(null),[s,l]=w.useState(null),c=[...e].sort((u,d)=>new Date(d.startedAt).getTime()-new Date(u.startedAt).getTime());return o.jsxs("div",{className:"mb-6","data-testid":"sessions-section",children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-2 hover:text-[var(--color-text)]","data-testid":"sessions-toggle",children:[r?o.jsx(cr,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),o.jsx(Xf,{className:"w-3 h-3"}),"Sessions (",e.length,")"]}),r&&o.jsx("div",{className:"space-y-2",children:c.length>0?c.map(u=>o.jsx(set,{entry:u,entityNameMap:t,onView:()=>i(u),onResume:()=>l(u)},u.sessionId)):o.jsx("div",{className:"text-sm text-[var(--color-text-tertiary)]","data-testid":"sessions-empty",children:"No sessions recorded"})}),a&&o.jsx(oet,{entry:a,onClose:()=>i(null),onResume:()=>{i(null),l(a)}}),s&&o.jsx(cet,{entry:s,onClose:()=>l(null)})]})}function set({entry:e,onView:t,onResume:r}){const n=e.agentRole==="worker",a=e.providerSessionId?.substring(0,8);return o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)] group","data-testid":`session-entry-${e.sessionId}`,children:[n?o.jsx(Xr,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):o.jsx(Xo,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.agentName}),o.jsx("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${n?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.agentRole}),a&&o.jsx("span",{className:"font-mono text-[10px] text-[var(--color-text-tertiary)]",children:a})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-tertiary)] mt-0.5",children:[o.jsx("span",{title:dh(e.startedAt),children:jl(e.startedAt)}),e.endedAt&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{title:dh(e.endedAt),children:jl(e.endedAt)})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"View transcript",title:"View transcript","data-testid":`session-view-${e.sessionId}`,children:o.jsx(du,{className:"w-4 h-4"})}),e.providerSessionId&&o.jsx("button",{onClick:r,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-green-600 dark:hover:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/30 rounded transition-colors","aria-label":"Resume session",title:"Resume session","data-testid":`session-resume-${e.sessionId}`,children:o.jsx(en,{className:"w-4 h-4"})})]})]})}function oet({entry:e,onClose:t,onResume:r}){const[n,a]=w.useState([]),[i,s]=w.useState(!0),[l,c]=w.useState(null),u=w.useCallback(async()=>{s(!0),c(null);try{const p=(await nme(e.sessionId)).messages.map(qme);a(p)}catch(m){c(m instanceof Error?m.message:"Failed to load messages")}finally{s(!1)}},[e.sessionId]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{const m=p=>{p.key==="Escape"&&t()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[t]);const d=e.agentRole==="worker",f=e.providerSessionId?.substring(0,8);return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"session-transcript-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[70vh] flex flex-col border border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[d?o.jsx(Xr,{className:"w-5 h-5 text-purple-500"}):o.jsx(Xo,{className:"w-5 h-5 text-blue-500"}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:e.agentName}),o.jsx("span",{className:`px-1.5 py-0.5 text-xs font-medium rounded ${d?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.agentRole})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-tertiary)] mt-0.5",children:[f&&o.jsx("span",{className:"font-mono",children:f}),o.jsxs("span",{title:dh(e.startedAt),children:["Started: ",jl(e.startedAt)]}),e.endedAt&&o.jsxs("span",{title:dh(e.endedAt),children:[" Ended: ",jl(e.endedAt)]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[e.providerSessionId&&o.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-green-700 bg-green-100 hover:bg-green-200 dark:text-green-300 dark:bg-green-900/30 dark:hover:bg-green-900/50 rounded-md transition-colors","data-testid":"transcript-resume-btn",children:[o.jsx(en,{className:"w-4 h-4"}),"Resume"]}),o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded","aria-label":"Close","data-testid":"transcript-close-btn",children:o.jsx(wt,{className:"w-5 h-5"})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:i?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-primary)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading transcript..."})]}):l?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[o.jsx(Bt,{className:"w-6 h-6 text-[var(--color-danger)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:l}),o.jsx("button",{onClick:u,className:"mt-3 px-3 py-1.5 text-sm text-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] rounded-md",children:"Retry"})]}):o.jsx(Wme,{events:n})})]})]})}function cet({entry:e,onClose:t}){const[r,n]=w.useState(""),a=Ma(),i=w.useRef(null);w.useEffect(()=>{i.current&&i.current.focus()},[]),w.useEffect(()=>{const c=u=>{u.key==="Escape"&&t()};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[t]);const s=()=>{a({to:"/workspaces",search:{layout:"single",agent:e.agentId,resumeSessionId:e.providerSessionId,resumePrompt:r.trim()||void 0}})},l=e.agentRole==="worker";return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"session-resume-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6 border border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${l?"bg-purple-100 dark:bg-purple-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:l?o.jsx(Xr,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}):o.jsx(Xo,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Resume Session"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["You'll be taken to the workspace to resume the session with"," ",o.jsx("span",{className:"font-medium text-[var(--color-text)]",children:e.agentName}),"."]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Resume message (optional)"}),o.jsx("textarea",{ref:i,value:r,onChange:c=>n(c.target.value),placeholder:"Enter a message to send when resuming...",rows:3,className:"w-full p-3 text-sm border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)] resize-y","data-testid":"resume-prompt-input"})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)]","data-testid":"resume-cancel-btn",children:"Cancel"}),o.jsxs("button",{onClick:s,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700","data-testid":"resume-confirm-btn",children:[o.jsx(en,{className:"w-4 h-4"}),"Resume"]})]})]})]})}const uet=[{value:1,label:"Critical"},{value:2,label:"High"},{value:3,label:"Medium"},{value:4,label:"Low"},{value:5,label:"Minimal"}],det=[{value:1,label:"Trivial"},{value:2,label:"Simple"},{value:3,label:"Moderate"},{value:4,label:"Complex"},{value:5,label:"Very Complex"}],fet=[{value:"task",label:"Task"},{value:"bug",label:"Bug"},{value:"feature",label:"Feature"},{value:"chore",label:"Chore"}];function Vme({isOpen:e,onClose:t,onSuccess:r,defaultToBacklog:n=!1}){const[a,i]=w.useState(""),[s,l]=w.useState(""),[c,u]=w.useState(3),[d,f]=w.useState(3),[m,p]=w.useState("task"),[v,b]=w.useState(""),[y,S]=w.useState([]),[_,N]=w.useState(n),k=w.useRef(null),j=dme(),{data:E}=d1("worker"),{data:T}=ime(),{currentUser:O}=nl(),R=E?.agents??[],q=T?.items??[];w.useEffect(()=>{e&&k.current&&setTimeout(()=>k.current?.focus(),100)},[e]),w.useEffect(()=>{e?N(n):(i(""),l(""),u(3),f(3),p("task"),b(""),S([]),N(!1),j.reset())},[e,n]);const $=async M=>{if(M.preventDefault(),!!a.trim())try{const z=await j.mutateAsync({title:a.trim(),createdBy:O?.id,description:s.trim()||void 0,priority:c,complexity:d,taskType:m,assignee:v||void 0,tags:y.length>0?y:void 0,status:_?"backlog":void 0});r?.(z.task?.id??""),t()}catch{}},L=M=>{M.key==="Escape"&&t()},A=typeof window<"u"&&window.innerWidth<768;return e?A?o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)]","data-testid":"create-task-modal",onKeyDown:L,children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",children:[o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Cancel","data-testid":"create-task-close",children:o.jsx(Fl,{className:"w-5 h-5"})}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Create Task"}),o.jsx("button",{onClick:$,disabled:j.isPending||!a.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors","data-testid":"create-task-submit",children:j.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):"Create"})]}),o.jsxs("form",{onSubmit:$,className:"p-4 pb-20 overflow-y-auto h-[calc(100vh-60px)]",children:[j.isError&&o.jsx("div",{className:"mb-4 p-3 bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-lg text-sm text-[var(--color-danger)]",children:j.error?.message||"Failed to create task"}),o.jsx(NX,{title:a,setTitle:i,titleInputRef:k,description:s,setDescription:l,priority:c,setPriority:u,complexity:d,setComplexity:f,taskType:m,setTaskType:p,assignee:v,setAssignee:b,workers:R,operators:q,tags:y,setTags:S,addToBacklog:_,setAddToBacklog:N})]})]}):o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"create-task-modal",onKeyDown:L,children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"data-testid":"create-task-backdrop"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Create Task"}),o.jsx("button",{onClick:t,className:"p-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded","aria-label":"Close","data-testid":"create-task-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:$,className:"p-4",children:[j.isError&&o.jsx("div",{className:"mb-4 p-3 bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-lg text-sm text-[var(--color-danger)]","data-testid":"create-task-error",children:j.error?.message||"Failed to create task"}),o.jsx(NX,{title:a,setTitle:i,titleInputRef:k,description:s,setDescription:l,priority:c,setPriority:u,complexity:d,setComplexity:f,taskType:m,setTaskType:p,assignee:v,setAssignee:b,workers:R,operators:q,tags:y,setTags:S,addToBacklog:_,setAddToBacklog:N}),o.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"create-task-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:j.isPending||!a.trim(),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"create-task-submit",children:j.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Task"]})})]})]})]})})]}):null}function NX({title:e,setTitle:t,titleInputRef:r,description:n,setDescription:a,priority:i,setPriority:s,complexity:l,setComplexity:c,taskType:u,setTaskType:d,assignee:f,setAssignee:m,workers:p,operators:v,tags:b,setTags:y,addToBacklog:S,setAddToBacklog:_}){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"task-title",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:["Title ",o.jsx("span",{className:"text-[var(--color-danger)]",children:"*"})]}),o.jsx("input",{ref:r,id:"task-title",type:"text",value:e,onChange:N=>t(N.target.value),placeholder:"Enter task title...",className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-title",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"task-description",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Description"}),o.jsx("textarea",{id:"task-description",value:n,onChange:N=>a(N.target.value),placeholder:"Describe the task in detail... (supports Markdown)",rows:4,className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent resize-y min-h-[100px]","data-testid":"create-task-description"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Markdown formatting is supported"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-priority",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Priority"}),o.jsx("select",{id:"task-priority",value:i,onChange:N=>s(Number(N.target.value)),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-priority",children:uet.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-complexity",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Complexity"}),o.jsx("select",{id:"task-complexity",value:l,onChange:N=>c(Number(N.target.value)),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-complexity",children:det.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-type",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Type"}),o.jsx("select",{id:"task-type",value:u,onChange:N=>d(N.target.value),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-type",children:fet.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-assignee",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Assign to"}),o.jsxs("select",{id:"task-assignee",value:f,onChange:N=>m(N.target.value),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-assignee",children:[o.jsx("option",{value:"",children:"Unassigned"}),v.length>0&&o.jsx("optgroup",{label:"Operators",children:v.map(N=>o.jsx("option",{value:N.id,children:N.name},N.id))}),p.length>0&&o.jsx("optgroup",{label:"Worker Agents",children:p.map(N=>o.jsx("option",{value:N.id,children:N.name},N.id))})]})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Tags"}),o.jsx(aj,{tags:b,onChange:y,placeholder:"Type and press comma to add tags","data-testid":"create-task-tags"})]}),o.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",id:"task-backlog",checked:S,onChange:N=>_(N.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)]","data-testid":"create-task-backlog"}),o.jsx("label",{htmlFor:"task-backlog",className:"text-sm text-[var(--color-text)]",children:"Add to Backlog"})]})]})}function het({sortField:e,sortDirection:t,secondarySort:r,onSortFieldChange:n,onSortDirectionChange:a,onSecondarySortChange:i}){const[s,l]=w.useState(!1),[c,u]=w.useState(!1),d=w.useRef(null);w.useEffect(()=>{function v(b){d.current&&!d.current.contains(b.target)&&(l(!1),u(!1))}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const f=yl.find(v=>v.value===e)||yl[0],m=r?yl.find(v=>v.value===r):null,p=yl.filter(v=>v.value!==e);return o.jsxs("div",{className:"relative flex items-center gap-1",ref:d,children:[o.jsxs("button",{onClick:()=>{l(!s),u(!1)},className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)]","data-testid":"sort-by-dropdown",children:[o.jsx(e0,{className:"w-4 h-4"}),o.jsxs("span",{children:["Sort: ",f.label]}),m&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["+ ",m.label]}),o.jsx(cr,{className:`w-3.5 h-3.5 transition-transform ${s?"rotate-180":""}`})]}),o.jsx("button",{onClick:()=>a(t==="asc"?"desc":"asc"),className:`inline-flex items-center justify-center w-8 h-8 text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)] ${t==="asc"?"text-[var(--color-primary)]":""}`,"data-testid":"sort-direction-toggle","aria-label":t==="asc"?"Sort ascending":"Sort descending",title:t==="asc"?"Sort ascending":"Sort descending",children:t==="asc"?o.jsx(Rx,{className:"w-4 h-4"}):o.jsx(Ix,{className:"w-4 h-4"})}),s&&!c&&o.jsxs("div",{className:"absolute z-20 mt-1 top-full left-0 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-48","data-testid":"sort-by-options",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase",children:"Primary Sort"}),yl.map(v=>o.jsxs("button",{onClick:()=>{n(v.value),r===v.value&&i(null),l(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${e===v.value?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":`sort-by-option-${v.value}`,children:[o.jsx("span",{children:v.label}),e===v.value&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]},v.value)),o.jsx("div",{className:"border-t border-[var(--color-border)] mt-1 pt-1",children:o.jsxs("button",{onClick:()=>u(!0),className:"w-full text-left px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] flex items-center justify-between","data-testid":"sort-secondary-button",children:[o.jsx("span",{children:"Secondary sort..."}),o.jsx(gn,{className:"w-4 h-4"})]})})]}),s&&c&&o.jsxs("div",{className:"absolute z-20 mt-1 top-full left-0 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-48","data-testid":"sort-secondary-options",children:[o.jsxs("button",{onClick:()=>u(!1),className:"w-full text-left px-3 py-1.5 text-sm text-[var(--color-text-tertiary)] hover:bg-[var(--color-surface-hover)] flex items-center gap-1",children:[o.jsx(gn,{className:"w-4 h-4 rotate-180"}),o.jsx("span",{children:"Back"})]}),o.jsx("div",{className:"border-t border-[var(--color-border)] my-1"}),o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase",children:"Secondary Sort"}),o.jsxs("button",{onClick:()=>{i(null),l(!1),u(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${r===null?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":"sort-secondary-option-none",children:[o.jsx("span",{children:"None"}),r===null&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]}),p.map(v=>o.jsxs("button",{onClick:()=>{i(v.value),l(!1),u(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${r===v.value?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":`sort-secondary-option-${v.value}`,children:[o.jsx("span",{children:v.label}),r===v.value&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]},v.value))]})]})}function met({groupBy:e,onGroupByChange:t}){const[r,n]=w.useState(!1),a=w.useRef(null);w.useEffect(()=>{function s(l){a.current&&!a.current.contains(l.target)&&n(!1)}return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const i=Ak.find(s=>s.value===e)||Ak[0];return o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>n(!r),className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)]","data-testid":"group-by-dropdown",children:[o.jsx(xwe,{className:"w-4 h-4"}),o.jsxs("span",{children:["Group: ",i.label]}),o.jsx(cr,{className:`w-3.5 h-3.5 transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"absolute z-20 mt-1 right-0 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-40","data-testid":"group-by-options",children:Ak.map(s=>o.jsxs("button",{onClick:()=>{t(s.value),n(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${e===s.value?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":`group-by-option-${s.value}`,children:[o.jsx("span",{children:s.label}),e===s.value&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]},s.value))})]})}function pet({view:e,onViewChange:t}){return o.jsxs("div",{className:"flex items-center bg-[var(--color-surface-elevated)] rounded-md p-0.5 border border-[var(--color-border)]","data-testid":"tasks-view-toggle",children:[o.jsxs("button",{onClick:()=>t("list"),className:`inline-flex items-center justify-center px-2 py-1.5 text-sm rounded transition-all duration-200 ${e==="list"?"bg-[var(--color-primary)] text-white shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":"tasks-view-list","aria-label":"List view (V L)",title:"List view (V L)",children:[o.jsx(Wp,{className:"w-4 h-4"}),o.jsx("span",{className:"pl-2 hidden @sm:inline",children:"List"})]}),o.jsxs("button",{onClick:()=>t("kanban"),className:`inline-flex items-center justify-center px-2 py-1.5 text-sm rounded transition-all duration-200 ${e==="kanban"?"bg-[var(--color-primary)] text-white shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":"tasks-view-kanban","aria-label":"Kanban view (V K)",title:"Kanban view (V K)",children:[o.jsx(bh,{className:"w-4 h-4"}),o.jsx("span",{className:"pl-2 hidden @sm:inline",children:"Kanban"})]})]})}function get({filters:e,onFilterChange:t,onClearFilters:r,entityNameMap:n}){const[a,i]=w.useState(!1),s=e.status.length>0||e.priority.length>0||e.assignee!=="",l=e.status.length+e.priority.length+(e.assignee?1:0),c=d=>{const f=e.status.includes(d)?e.status.filter(m=>m!==d):[...e.status,d];t({...e,status:f})},u=d=>{const f=e.priority.includes(d)?e.priority.filter(m=>m!==d):[...e.priority,d];t({...e,priority:f})};return o.jsxs("div",{className:"border-b border-[var(--color-border)] bg-[var(--color-surface-elevated)]","data-testid":"filter-bar",children:[o.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[o.jsxs("button",{onClick:()=>i(!a),className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)]","data-testid":"filter-toggle",children:[o.jsx(ru,{className:"w-4 h-4"}),o.jsx("span",{children:"Filters"}),l>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium bg-[var(--color-primary-muted)] text-[var(--color-primary)] rounded-full",children:l}),o.jsx(cr,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`})]}),s&&o.jsxs("button",{onClick:r,className:"flex items-center gap-1 text-sm text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]","data-testid":"clear-filters",children:[o.jsx(oi,{className:"w-4 h-4"}),o.jsx("span",{children:"Clear all"})]})]}),a&&o.jsxs("div",{className:"px-4 pb-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-tertiary)] uppercase mb-1.5",children:"Status"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:RP.map(d=>o.jsx("button",{onClick:()=>c(d.value),className:`px-2.5 py-1 text-xs rounded-full border transition-colors ${e.status.includes(d.value)?`${d.color} border-transparent font-medium`:"bg-[var(--color-surface)] border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-[var(--color-border-hover)]"}`,"data-testid":`filter-status-${d.value}`,children:d.label},d.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-tertiary)] uppercase mb-1.5",children:"Priority"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:lC.map(d=>o.jsx("button",{onClick:()=>u(d.value),className:`px-2.5 py-1 text-xs rounded-full border transition-colors ${e.priority.includes(d.value)?`${d.color} border-transparent font-medium`:"bg-[var(--color-surface)] border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-[var(--color-border-hover)]"}`,"data-testid":`filter-priority-${d.value}`,children:d.label},d.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-tertiary)] uppercase mb-1.5",children:"Assignee"}),o.jsxs("select",{value:e.assignee,onChange:d=>t({...e,assignee:d.target.value}),className:"w-full max-w-xs px-3 py-1.5 text-sm border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] focus:border-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":"filter-assignee",children:[o.jsx("option",{value:"",children:"All assignees"}),Array.from(n.entries()).map(([d,f])=>o.jsx("option",{value:d,children:f||d},d))]})]})]}),!a&&s&&o.jsxs("div",{className:"px-4 pb-2 flex flex-wrap gap-1.5",children:[e.status.map(d=>{const f=RP.find(m=>m.value===d);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full ${f?.color||"bg-gray-100 text-gray-800"}`,children:[f?.label||d,o.jsx("button",{onClick:()=>c(d),className:"hover:opacity-70","aria-label":`Remove ${f?.label||d} filter`,children:o.jsx(wt,{className:"w-3 h-3"})})]},d)}),e.priority.map(d=>{const f=lC.find(m=>m.value===d);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full ${f?.color||"bg-gray-100 text-gray-800"}`,children:[f?.label||d,o.jsx("button",{onClick:()=>u(d),className:"hover:opacity-70","aria-label":`Remove ${f?.label||d} filter`,children:o.jsx(wt,{className:"w-3 h-3"})})]},d)}),e.assignee&&o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full bg-[var(--color-surface)] text-[var(--color-text)]",children:["Assignee: ",n.get(e.assignee)||e.assignee,o.jsx("button",{onClick:()=>t({...e,assignee:""}),className:"hover:opacity-70","aria-label":"Remove assignee filter",children:o.jsx(wt,{className:"w-3 h-3"})})]})]})]})}function vet(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w.useMemo(()=>n=>{t.forEach(a=>a(n))},t)}const S2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function y0(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function LB(e){return"nodeType"in e}function qi(e){var t,r;return e?y0(e)?e:LB(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function OB(e){const{Document:t}=qi(e);return e instanceof t}function v1(e){return y0(e)?!1:e instanceof qi(e).HTMLElement}function Yme(e){return e instanceof qi(e).SVGElement}function x0(e){return e?y0(e)?e.document:LB(e)?OB(e)?e:v1(e)||Yme(e)?e.ownerDocument:document:document:document}const el=S2?w.useLayoutEffect:w.useEffect;function k2(e){const t=w.useRef(e);return el(()=>{t.current=e}),w.useCallback(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.current==null?void 0:t.current(...n)},[])}function bet(){const e=w.useRef(null),t=w.useCallback((n,a)=>{e.current=setInterval(n,a)},[]),r=w.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function cx(e,t){t===void 0&&(t=[e]);const r=w.useRef(e);return el(()=>{r.current!==e&&(r.current=e)},t),r}function b1(e,t){const r=w.useRef();return w.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function cC(e){const t=k2(e),r=w.useRef(null),n=w.useCallback(a=>{a!==r.current&&t?.(a,r.current),r.current=a},[]);return[r,n]}function uC(e){const t=w.useRef();return w.useEffect(()=>{t.current=e},[e]),t.current}let _L={};function y1(e,t){return w.useMemo(()=>{if(t)return t;const r=_L[e]==null?0:_L[e]+1;return _L[e]=r,e+"-"+r},[e,t])}function Qme(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((i,s)=>{const l=Object.entries(s);for(const[c,u]of l){const d=i[c];d!=null&&(i[c]=d+e*u)}return i},{...t})}}const Fp=Qme(1),ux=Qme(-1);function yet(e){return"clientX"in e&&"clientY"in e}function _2(e){if(!e)return!1;const{KeyboardEvent:t}=qi(e.target);return t&&e instanceof t}function xet(e){if(!e)return!1;const{TouchEvent:t}=qi(e.target);return t&&e instanceof t}function dC(e){if(xet(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return yet(e)?{x:e.clientX,y:e.clientY}:null}const Bl=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Bl.Translate.toString(e),Bl.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),CX="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function wet(e){return e.matches(CX)?e:e.querySelector(CX)}const ket={display:"none"};function _et(e){let{id:t,value:r}=e;return le.createElement("div",{id:t,style:ket},r)}function Net(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return le.createElement("div",{id:t,style:a,role:"status","aria-live":n,"aria-atomic":!0},r)}function Cet(){const[e,t]=w.useState("");return{announce:w.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const Jme=w.createContext(null);function jet(e){const t=w.useContext(Jme);w.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Eet(){const[e]=w.useState(()=>new Set),t=w.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[w.useCallback(n=>{let{type:a,event:i}=n;e.forEach(s=>{var l;return(l=s[a])==null?void 0:l.call(s,i)})},[e]),t]}const Met={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Tet={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Aet(e){let{announcements:t=Tet,container:r,hiddenTextDescribedById:n,screenReaderInstructions:a=Met}=e;const{announce:i,announcement:s}=Cet(),l=y1("DndLiveRegion"),[c,u]=w.useState(!1);if(w.useEffect(()=>{u(!0)},[]),jet(w.useMemo(()=>({onDragStart(f){let{active:m}=f;i(t.onDragStart({active:m}))},onDragMove(f){let{active:m,over:p}=f;t.onDragMove&&i(t.onDragMove({active:m,over:p}))},onDragOver(f){let{active:m,over:p}=f;i(t.onDragOver({active:m,over:p}))},onDragEnd(f){let{active:m,over:p}=f;i(t.onDragEnd({active:m,over:p}))},onDragCancel(f){let{active:m,over:p}=f;i(t.onDragCancel({active:m,over:p}))}}),[i,t])),!c)return null;const d=le.createElement(le.Fragment,null,le.createElement(_et,{id:n,value:a.draggable}),le.createElement(Net,{id:l,announcement:s}));return r?pd.createPortal(d,r):d}var Na;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Na||(Na={}));function fC(){}function dx(e,t){return w.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function IB(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const tl=Object.freeze({x:0,y:0});function Zme(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Det(e,t){const r=dC(e);if(!r)return"0 0";const n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}function Xme(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function Let(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function jX(e){let{left:t,top:r,height:n,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+n},{x:t+a,y:r+n}]}function epe(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function EX(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const Oet=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=EX(t,t.left,t.top),i=[];for(const s of n){const{id:l}=s,c=r.get(l);if(c){const u=Zme(EX(c),a);i.push({id:l,data:{droppableContainer:s,value:u}})}}return i.sort(Xme)},tpe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=jX(t),i=[];for(const s of n){const{id:l}=s,c=r.get(l);if(c){const u=jX(c),d=a.reduce((m,p,v)=>m+Zme(u[v],p),0),f=Number((d/4).toFixed(4));i.push({id:l,data:{droppableContainer:s,value:f}})}}return i.sort(Xme)};function Iet(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=a-n,l=i-r;if(n<a&&r<i){const c=t.width*t.height,u=e.width*e.height,d=s*l,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const Ret=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=[];for(const i of n){const{id:s}=i,l=r.get(s);if(l){const c=Iet(l,t);c>0&&a.push({id:s,data:{droppableContainer:i,value:c}})}}return a.sort(Let)};function Pet(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function rpe(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:tl}function zet(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return a.reduce((s,l)=>({...s,top:s.top+e*l.y,bottom:s.bottom+e*l.y,left:s.left+e*l.x,right:s.right+e*l.x}),{...r})}}const Bet=zet(1);function npe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function $et(e,t,r){const n=npe(t);if(!n)return e;const{scaleX:a,scaleY:i,x:s,y:l}=n,c=e.left-s-(1-a)*parseFloat(r),u=e.top-l-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),d=a?e.width/a:e.width,f=i?e.height/i:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const Fet={ignoreTransform:!1};function w0(e,t){t===void 0&&(t=Fet);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=qi(e).getComputedStyle(e);u&&(r=$et(r,u,d))}const{top:n,left:a,width:i,height:s,bottom:l,right:c}=r;return{top:n,left:a,width:i,height:s,bottom:l,right:c}}function MX(e){return w0(e,{ignoreTransform:!0})}function Uet(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function Het(e,t){return t===void 0&&(t=qi(e).getComputedStyle(e)),t.position==="fixed"}function qet(e,t){t===void 0&&(t=qi(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?r.test(i):!1})}function N2(e,t){const r=[];function n(a){if(t!=null&&r.length>=t||!a)return r;if(OB(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!v1(a)||Yme(a)||r.includes(a))return r;const i=qi(e).getComputedStyle(a);return a!==e&&qet(a,i)&&r.push(a),Het(a,i)?r:n(a.parentNode)}return e?n(e):r}function ape(e){const[t]=N2(e,1);return t??null}function NL(e){return!S2||!e?null:y0(e)?e:LB(e)?OB(e)||e===x0(e).scrollingElement?window:v1(e)?e:null:null}function ipe(e){return y0(e)?e.scrollX:e.scrollLeft}function spe(e){return y0(e)?e.scrollY:e.scrollTop}function zP(e){return{x:ipe(e),y:spe(e)}}var Ba;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ba||(Ba={}));function ope(e){return!S2||!e?!1:e===document.scrollingElement}function lpe(e){const t={x:0,y:0},r=ope(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,s=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:a,isLeft:i,isBottom:s,isRight:l,maxScroll:n,minScroll:t}}const Wet={x:.2,y:.2};function Ket(e,t,r,n,a){let{top:i,left:s,right:l,bottom:c}=r;n===void 0&&(n=10),a===void 0&&(a=Wet);const{isTop:u,isBottom:d,isLeft:f,isRight:m}=lpe(e),p={x:0,y:0},v={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!u&&i<=t.top+b.height?(p.y=Ba.Backward,v.y=n*Math.abs((t.top+b.height-i)/b.height)):!d&&c>=t.bottom-b.height&&(p.y=Ba.Forward,v.y=n*Math.abs((t.bottom-b.height-c)/b.height)),!m&&l>=t.right-b.width?(p.x=Ba.Forward,v.x=n*Math.abs((t.right-b.width-l)/b.width)):!f&&s<=t.left+b.width&&(p.x=Ba.Backward,v.x=n*Math.abs((t.left+b.width-s)/b.width)),{direction:p,speed:v}}function Get(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:s}=window;return{top:0,left:0,right:i,bottom:s,width:i,height:s}}const{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function cpe(e){return e.reduce((t,r)=>Fp(t,zP(r)),tl)}function Vet(e){return e.reduce((t,r)=>t+ipe(r),0)}function Yet(e){return e.reduce((t,r)=>t+spe(r),0)}function upe(e,t){if(t===void 0&&(t=w0),!e)return;const{top:r,left:n,bottom:a,right:i}=t(e);ape(e)&&(a<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Qet=[["x",["left","right"],Vet],["y",["top","bottom"],Yet]];class RB{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=N2(r),a=cpe(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,s,l]of Qet)for(const c of s)Object.defineProperty(this,c,{get:()=>{const u=l(n),d=a[i]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Qb{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var a;(a=this.target)==null||a.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function Jet(e){const{EventTarget:t}=qi(e);return e instanceof t?e:x0(e)}function CL(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ho;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ho||(ho={}));function TX(e){e.preventDefault()}function Zet(e){e.stopPropagation()}var Cr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Cr||(Cr={}));const dpe={start:[Cr.Space,Cr.Enter],cancel:[Cr.Esc],end:[Cr.Space,Cr.Enter,Cr.Tab]},Xet=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Cr.Right:return{...r,x:r.x+25};case Cr.Left:return{...r,x:r.x-25};case Cr.Down:return{...r,y:r.y+25};case Cr.Up:return{...r,y:r.y-25}}};class C2{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Qb(x0(r)),this.windowListeners=new Qb(qi(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ho.Resize,this.handleCancel),this.windowListeners.add(ho.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ho.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&upe(n),r(tl)}handleKeyDown(t){if(_2(t)){const{active:r,context:n,options:a}=this.props,{keyboardCodes:i=dpe,coordinateGetter:s=Xet,scrollBehavior:l="smooth"}=a,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:tl;this.referenceCoordinates||(this.referenceCoordinates=d);const f=s(t,{active:r,context:n.current,currentCoordinates:d});if(f){const m=ux(f,d),p={x:0,y:0},{scrollableAncestors:v}=n.current;for(const b of v){const y=t.code,{isTop:S,isRight:_,isLeft:N,isBottom:k,maxScroll:j,minScroll:E}=lpe(b),T=Get(b),O={x:Math.min(y===Cr.Right?T.right-T.width/2:T.right,Math.max(y===Cr.Right?T.left:T.left+T.width/2,f.x)),y:Math.min(y===Cr.Down?T.bottom-T.height/2:T.bottom,Math.max(y===Cr.Down?T.top:T.top+T.height/2,f.y))},R=y===Cr.Right&&!_||y===Cr.Left&&!N,q=y===Cr.Down&&!k||y===Cr.Up&&!S;if(R&&O.x!==f.x){const $=b.scrollLeft+m.x,L=y===Cr.Right&&$<=j.x||y===Cr.Left&&$>=E.x;if(L&&!m.y){b.scrollTo({left:$,behavior:l});return}L?p.x=b.scrollLeft-$:p.x=y===Cr.Right?b.scrollLeft-j.x:b.scrollLeft-E.x,p.x&&b.scrollBy({left:-p.x,behavior:l});break}else if(q&&O.y!==f.y){const $=b.scrollTop+m.y,L=y===Cr.Down&&$<=j.y||y===Cr.Up&&$>=E.y;if(L&&!m.x){b.scrollTo({top:$,behavior:l});return}L?p.y=b.scrollTop-$:p.y=y===Cr.Down?b.scrollTop-j.y:b.scrollTop-E.y,p.y&&b.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,Fp(ux(f,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}C2.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=dpe,onActivation:a}=t,{active:i}=r;const{code:s}=e.nativeEvent;if(n.start.includes(s)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function AX(e){return!!(e&&"distance"in e)}function DX(e){return!!(e&&"delay"in e)}class PB{constructor(t,r,n){var a;n===void 0&&(n=Jet(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:s}=i;this.props=t,this.events=r,this.document=x0(s),this.documentListeners=new Qb(this.document),this.listeners=new Qb(n),this.windowListeners=new Qb(qi(s)),this.initialCoordinates=(a=dC(i))!=null?a:tl,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ho.Resize,this.handleCancel),this.windowListeners.add(ho.DragStart,TX),this.windowListeners.add(ho.VisibilityChange,this.handleCancel),this.windowListeners.add(ho.ContextMenu,TX),this.documentListeners.add(ho.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(DX(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(AX(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:a}=this.props;a(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ho.Click,Zet,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ho.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:a,props:i}=this,{onMove:s,options:{activationConstraint:l}}=i;if(!a)return;const c=(r=dC(t))!=null?r:tl,u=ux(a,c);if(!n&&l){if(AX(l)){if(l.tolerance!=null&&CL(u,l.tolerance))return this.handleCancel();if(CL(u,l.distance))return this.handleStart()}if(DX(l)&&CL(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),s(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Cr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const ett={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class x1 extends PB{constructor(t){const{event:r}=t,n=x0(r.target);super(t,ett,n)}}x1.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const ttt={move:{name:"mousemove"},end:{name:"mouseup"}};var BP;(function(e){e[e.RightClick=2]="RightClick"})(BP||(BP={}));class rtt extends PB{constructor(t){super(t,ttt,x0(t.event.target))}}rtt.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===BP.RightClick?!1:(n?.({event:r}),!0)}}];const jL={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ntt extends PB{constructor(t){super(t,jL)}static setup(){return window.addEventListener(jL.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(jL.move.name,t)};function t(){}}}ntt.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:a}=r;return a.length>1?!1:(n?.({event:r}),!0)}}];var Jb;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Jb||(Jb={}));var hC;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(hC||(hC={}));function att(e){let{acceleration:t,activator:r=Jb.Pointer,canScroll:n,draggingRect:a,enabled:i,interval:s=5,order:l=hC.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:m}=e;const p=stt({delta:f,disabled:!i}),[v,b]=bet(),y=w.useRef({x:0,y:0}),S=w.useRef({x:0,y:0}),_=w.useMemo(()=>{switch(r){case Jb.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Jb.DraggableRect:return a}},[r,a,c]),N=w.useRef(null),k=w.useCallback(()=>{const E=N.current;if(!E)return;const T=y.current.x*S.current.x,O=y.current.y*S.current.y;E.scrollBy(T,O)},[]),j=w.useMemo(()=>l===hC.TreeOrder?[...u].reverse():u,[l,u]);w.useEffect(()=>{if(!i||!u.length||!_){b();return}for(const E of j){if(n?.(E)===!1)continue;const T=u.indexOf(E),O=d[T];if(!O)continue;const{direction:R,speed:q}=Ket(E,O,_,t,m);for(const $ of["x","y"])p[$][R[$]]||(q[$]=0,R[$]=0);if(q.x>0||q.y>0){b(),N.current=E,v(k,s),y.current=q,S.current=R;return}}y.current={x:0,y:0},S.current={x:0,y:0},b()},[t,k,n,b,i,s,JSON.stringify(_),JSON.stringify(p),v,u,j,d,JSON.stringify(m)])}const itt={x:{[Ba.Backward]:!1,[Ba.Forward]:!1},y:{[Ba.Backward]:!1,[Ba.Forward]:!1}};function stt(e){let{delta:t,disabled:r}=e;const n=uC(t);return b1(a=>{if(r||!n||!a)return itt;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Ba.Backward]:a.x[Ba.Backward]||i.x===-1,[Ba.Forward]:a.x[Ba.Forward]||i.x===1},y:{[Ba.Backward]:a.y[Ba.Backward]||i.y===-1,[Ba.Forward]:a.y[Ba.Forward]||i.y===1}}},[r,t,n])}function ott(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return b1(a=>{var i;return t==null?null:(i=n??a)!=null?i:null},[n,t])}function ltt(e,t){return w.useMemo(()=>e.reduce((r,n)=>{const{sensor:a}=n,i=a.activators.map(s=>({eventName:s.eventName,handler:t(s.handler,n)}));return[...r,...i]},[]),[e,t])}var fx;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(fx||(fx={}));var $P;(function(e){e.Optimized="optimized"})($P||($P={}));const LX=new Map;function ctt(e,t){let{dragging:r,dependencies:n,config:a}=t;const[i,s]=w.useState(null),{frequency:l,measure:c,strategy:u}=a,d=w.useRef(e),f=y(),m=cx(f),p=w.useCallback(function(S){S===void 0&&(S=[]),!m.current&&s(_=>_===null?S:_.concat(S.filter(N=>!_.includes(N))))},[m]),v=w.useRef(null),b=b1(S=>{if(f&&!r)return LX;if(!S||S===LX||d.current!==e||i!=null){const _=new Map;for(let N of e){if(!N)continue;if(i&&i.length>0&&!i.includes(N.id)&&N.rect.current){_.set(N.id,N.rect.current);continue}const k=N.node.current,j=k?new RB(c(k),k):null;N.rect.current=j,j&&_.set(N.id,j)}return _}return S},[e,i,r,f,c]);return w.useEffect(()=>{d.current=e},[e]),w.useEffect(()=>{f||p()},[r,f]),w.useEffect(()=>{i&&i.length>0&&s(null)},[JSON.stringify(i)]),w.useEffect(()=>{f||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{p(),v.current=null},l))},[l,f,p,...n]),{droppableRects:b,measureDroppableContainers:p,measuringScheduled:i!=null};function y(){switch(u){case fx.Always:return!1;case fx.BeforeDragging:return r;default:return!r}}}function zB(e,t){return b1(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function utt(e,t){return zB(e,t)}function dtt(e){let{callback:t,disabled:r}=e;const n=k2(t),a=w.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(n)},[n,r]);return w.useEffect(()=>()=>a?.disconnect(),[a]),a}function j2(e){let{callback:t,disabled:r}=e;const n=k2(t),a=w.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(n)},[r]);return w.useEffect(()=>()=>a?.disconnect(),[a]),a}function ftt(e){return new RB(w0(e),e)}function OX(e,t,r){t===void 0&&(t=ftt);const[n,a]=w.useState(null);function i(){a(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const s=dtt({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),l=j2({callback:i});return el(()=>{i(),e?(l?.observe(e),s?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),s?.disconnect())},[e]),n}function htt(e){const t=zB(e);return rpe(e,t)}const IX=[];function mtt(e){const t=w.useRef(e),r=b1(n=>e?n&&n!==IX&&e&&t.current&&e.parentNode===t.current.parentNode?n:N2(e):IX,[e]);return w.useEffect(()=>{t.current=e},[e]),r}function ptt(e){const[t,r]=w.useState(null),n=w.useRef(e),a=w.useCallback(i=>{const s=NL(i.target);s&&r(l=>l?(l.set(s,zP(s)),new Map(l)):null)},[]);return w.useEffect(()=>{const i=n.current;if(e!==i){s(i);const l=e.map(c=>{const u=NL(c);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,zP(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{s(e),s(i)};function s(l){l.forEach(c=>{const u=NL(c);u?.removeEventListener("scroll",a)})}},[a,e]),w.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,s)=>Fp(i,s),tl):cpe(e):tl,[e,t])}function RX(e,t){t===void 0&&(t=[]);const r=w.useRef(null);return w.useEffect(()=>{r.current=null},t),w.useEffect(()=>{const n=e!==tl;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?ux(e,r.current):tl}function gtt(e){w.useEffect(()=>{if(!S2)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function vtt(e,t){return w.useMemo(()=>e.reduce((r,n)=>{let{eventName:a,handler:i}=n;return r[a]=s=>{i(s,t)},r},{}),[e,t])}function fpe(e){return w.useMemo(()=>e?Uet(e):null,[e])}const PX=[];function btt(e,t){t===void 0&&(t=w0);const[r]=e,n=fpe(r?qi(r):null),[a,i]=w.useState(PX);function s(){i(()=>e.length?e.map(c=>ope(c)?n:new RB(t(c),c)):PX)}const l=j2({callback:s});return el(()=>{l?.disconnect(),s(),e.forEach(c=>l?.observe(c))},[e]),a}function hpe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return v1(t)?t:e}function ytt(e){let{measure:t}=e;const[r,n]=w.useState(null),a=w.useCallback(u=>{for(const{target:d}of u)if(v1(d)){n(f=>{const m=t(d);return f?{...f,width:m.width,height:m.height}:m});break}},[t]),i=j2({callback:a}),s=w.useCallback(u=>{const d=hpe(u);i?.disconnect(),d&&i?.observe(d),n(d?t(d):null)},[t,i]),[l,c]=cC(s);return w.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const xtt=[{sensor:x1,options:{}},{sensor:C2,options:{}}],wtt={current:{}},Dk={draggable:{measure:MX},droppable:{measure:MX,strategy:fx.WhileDragging,frequency:$P.Optimized},dragOverlay:{measure:w0}};class Zb extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const Stt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Zb,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:fC},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Dk,measureDroppableContainers:fC,windowRect:null,measuringScheduled:!1},mpe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:fC,draggableNodes:new Map,over:null,measureDroppableContainers:fC},w1=w.createContext(mpe),ppe=w.createContext(Stt);function ktt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Zb}}}function _tt(e,t){switch(t.type){case Na.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Na.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Na.DragEnd:case Na.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Na.RegisterDroppable:{const{element:r}=t,{id:n}=r,a=new Zb(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case Na.SetDroppableDisabled:{const{id:r,key:n,disabled:a}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const s=new Zb(e.droppable.containers);return s.set(r,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:s}}}case Na.UnregisterDroppable:{const{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const i=new Zb(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ntt(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:a}=w.useContext(w1),i=uC(n),s=uC(r?.id);return w.useEffect(()=>{if(!t&&!n&&i&&s!=null){if(!_2(i)||document.activeElement===i.target)return;const l=a.get(s);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=wet(d);if(f){f.focus();break}}})}},[n,t,a,s,i]),null}function gpe(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...n}),r):r}function Ctt(e){return w.useMemo(()=>({draggable:{...Dk.draggable,...e?.draggable},droppable:{...Dk.droppable,...e?.droppable},dragOverlay:{...Dk.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function jtt(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e;const i=w.useRef(!1),{x:s,y:l}=typeof a=="boolean"?{x:a,y:a}:a;el(()=>{if(!s&&!l||!t){i.current=!1;return}if(i.current||!n)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=rpe(d,n);if(s||(f.x=0),l||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=ape(u);m&&m.scrollBy({top:f.y,left:f.x})}},[t,s,l,n,r])}const E2=w.createContext({...tl,scaleX:1,scaleY:1});var cd;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(cd||(cd={}));const mC=w.memo(function(t){var r,n,a,i;let{id:s,accessibility:l,autoScroll:c=!0,children:u,sensors:d=xtt,collisionDetection:f=Ret,measuring:m,modifiers:p,...v}=t;const b=w.useReducer(_tt,void 0,ktt),[y,S]=b,[_,N]=Eet(),[k,j]=w.useState(cd.Uninitialized),E=k===cd.Initialized,{draggable:{active:T,nodes:O,translate:R},droppable:{containers:q}}=y,$=T!=null?O.get(T):null,L=w.useRef({initial:null,translated:null}),A=w.useMemo(()=>{var Wt;return T!=null?{id:T,data:(Wt=$?.data)!=null?Wt:wtt,rect:L}:null},[T,$]),M=w.useRef(null),[z,I]=w.useState(null),[B,F]=w.useState(null),U=cx(v,Object.values(v)),V=y1("DndDescribedBy",s),K=w.useMemo(()=>q.getEnabled(),[q]),G=Ctt(m),{droppableRects:J,measureDroppableContainers:ee,measuringScheduled:Y}=ctt(K,{dragging:E,dependencies:[R.x,R.y],config:G.droppable}),ie=ott(O,T),fe=w.useMemo(()=>B?dC(B):null,[B]),me=Zt(),te=utt(ie,G.draggable.measure);jtt({activeNode:T!=null?O.get(T):null,config:me.layoutShiftCompensation,initialRect:te,measure:G.draggable.measure});const oe=OX(ie,G.draggable.measure,te),ce=OX(ie?ie.parentElement:null),Z=w.useRef({activatorEvent:null,active:null,activeNode:ie,collisionRect:null,collisions:null,droppableRects:J,draggableNodes:O,draggingNode:null,draggingNodeRect:null,droppableContainers:q,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ue=q.getNodeFor((r=Z.current.over)==null?void 0:r.id),H=ytt({measure:G.dragOverlay.measure}),ge=(n=H.nodeRef.current)!=null?n:ie,de=E?(a=H.rect)!=null?a:oe:null,re=!!(H.nodeRef.current&&H.rect),ne=htt(re?null:oe),pe=fpe(ge?qi(ge):null),ke=mtt(E?ue??ie:null),we=btt(ke),ve=gpe(p,{transform:{x:R.x-ne.x,y:R.y-ne.y,scaleX:1,scaleY:1},activatorEvent:B,active:A,activeNodeRect:oe,containerNodeRect:ce,draggingNodeRect:de,over:Z.current.over,overlayNodeRect:H.rect,scrollableAncestors:ke,scrollableAncestorRects:we,windowRect:pe}),Le=fe?Fp(fe,R):null,Ae=ptt(ke),Re=RX(Ae),Ye=RX(Ae,[oe]),mt=Fp(ve,Re),ot=de?Bet(de,ve):null,Ot=A&&ot?f({active:A,collisionRect:ot,droppableRects:J,droppableContainers:K,pointerCoordinates:Le}):null,rt=epe(Ot,"id"),[ze,bt]=w.useState(null),tt=re?ve:Fp(ve,Ye),_e=Pet(tt,(i=ze?.rect)!=null?i:null,oe),We=w.useRef(null),Ve=w.useCallback((Wt,Rt)=>{let{sensor:he,options:De}=Rt;if(M.current==null)return;const Ue=O.get(M.current);if(!Ue)return;const ut=Wt.nativeEvent,St=new he({active:M.current,activeNode:Ue,event:ut,options:De,context:Z,onAbort(Je){if(!O.get(Je))return;const{onDragAbort:it}=U.current,Xt={id:Je};it?.(Xt),_({type:"onDragAbort",event:Xt})},onPending(Je,Xe,it,Xt){if(!O.get(Je))return;const{onDragPending:Oe}=U.current,Ke={id:Je,constraint:Xe,initialCoordinates:it,offset:Xt};Oe?.(Ke),_({type:"onDragPending",event:Ke})},onStart(Je){const Xe=M.current;if(Xe==null)return;const it=O.get(Xe);if(!it)return;const{onDragStart:Xt}=U.current,X={activatorEvent:ut,active:{id:Xe,data:it.data,rect:L}};pd.unstable_batchedUpdates(()=>{Xt?.(X),j(cd.Initializing),S({type:Na.DragStart,initialCoordinates:Je,active:Xe}),_({type:"onDragStart",event:X}),I(We.current),F(ut)})},onMove(Je){S({type:Na.DragMove,coordinates:Je})},onEnd:jt(Na.DragEnd),onCancel:jt(Na.DragCancel)});We.current=St;function jt(Je){return async function(){const{active:it,collisions:Xt,over:X,scrollAdjustedTranslate:Oe}=Z.current;let Ke=null;if(it&&Oe){const{cancelDrop:be}=U.current;Ke={activatorEvent:ut,active:it,collisions:Xt,delta:Oe,over:X},Je===Na.DragEnd&&typeof be=="function"&&await Promise.resolve(be(Ke))&&(Je=Na.DragCancel)}M.current=null,pd.unstable_batchedUpdates(()=>{S({type:Je}),j(cd.Uninitialized),bt(null),I(null),F(null),We.current=null;const be=Je===Na.DragEnd?"onDragEnd":"onDragCancel";if(Ke){const W=U.current[be];W?.(Ke),_({type:be,event:Ke})}})}}},[O]),Mt=w.useCallback((Wt,Rt)=>(he,De)=>{const Ue=he.nativeEvent,ut=O.get(De);if(M.current!==null||!ut||Ue.dndKit||Ue.defaultPrevented)return;const St={active:ut};Wt(he,Rt.options,St)===!0&&(Ue.dndKit={capturedBy:Rt.sensor},M.current=De,Ve(he,Rt))},[O,Ve]),kt=ltt(d,Mt);gtt(d),el(()=>{oe&&k===cd.Initializing&&j(cd.Initialized)},[oe,k]),w.useEffect(()=>{const{onDragMove:Wt}=U.current,{active:Rt,activatorEvent:he,collisions:De,over:Ue}=Z.current;if(!Rt||!he)return;const ut={active:Rt,activatorEvent:he,collisions:De,delta:{x:mt.x,y:mt.y},over:Ue};pd.unstable_batchedUpdates(()=>{Wt?.(ut),_({type:"onDragMove",event:ut})})},[mt.x,mt.y]),w.useEffect(()=>{const{active:Wt,activatorEvent:Rt,collisions:he,droppableContainers:De,scrollAdjustedTranslate:Ue}=Z.current;if(!Wt||M.current==null||!Rt||!Ue)return;const{onDragOver:ut}=U.current,St=De.get(rt),jt=St&&St.rect.current?{id:St.id,rect:St.rect.current,data:St.data,disabled:St.disabled}:null,Je={active:Wt,activatorEvent:Rt,collisions:he,delta:{x:Ue.x,y:Ue.y},over:jt};pd.unstable_batchedUpdates(()=>{bt(jt),ut?.(Je),_({type:"onDragOver",event:Je})})},[rt]),el(()=>{Z.current={activatorEvent:B,active:A,activeNode:ie,collisionRect:ot,collisions:Ot,droppableRects:J,draggableNodes:O,draggingNode:ge,draggingNodeRect:de,droppableContainers:q,over:ze,scrollableAncestors:ke,scrollAdjustedTranslate:mt},L.current={initial:de,translated:ot}},[A,ie,Ot,ot,O,ge,de,J,q,ze,ke,mt]),att({...me,delta:R,draggingRect:ot,pointerCoordinates:Le,scrollableAncestors:ke,scrollableAncestorRects:we});const er=w.useMemo(()=>({active:A,activeNode:ie,activeNodeRect:oe,activatorEvent:B,collisions:Ot,containerNodeRect:ce,dragOverlay:H,draggableNodes:O,droppableContainers:q,droppableRects:J,over:ze,measureDroppableContainers:ee,scrollableAncestors:ke,scrollableAncestorRects:we,measuringConfiguration:G,measuringScheduled:Y,windowRect:pe}),[A,ie,oe,B,Ot,ce,H,O,q,J,ze,ee,ke,we,G,Y,pe]),mr=w.useMemo(()=>({activatorEvent:B,activators:kt,active:A,activeNodeRect:oe,ariaDescribedById:{draggable:V},dispatch:S,draggableNodes:O,over:ze,measureDroppableContainers:ee}),[B,kt,A,oe,S,V,O,ze,ee]);return le.createElement(Jme.Provider,{value:N},le.createElement(w1.Provider,{value:mr},le.createElement(ppe.Provider,{value:er},le.createElement(E2.Provider,{value:_e},u)),le.createElement(Ntt,{disabled:l?.restoreFocus===!1})),le.createElement(Aet,{...l,hiddenTextDescribedById:V}));function Zt(){const Wt=z?.autoScrollEnabled===!1,Rt=typeof c=="object"?c.enabled===!1:c===!1,he=E&&!Wt&&!Rt;return typeof c=="object"?{...c,enabled:he}:{enabled:he}}}),Ett=w.createContext(null),zX="button",Mtt="Draggable";function vpe(e){let{id:t,data:r,disabled:n=!1,attributes:a}=e;const i=y1(Mtt),{activators:s,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:m}=w.useContext(w1),{role:p=zX,roleDescription:v="draggable",tabIndex:b=0}=a??{},y=c?.id===t,S=w.useContext(y?E2:Ett),[_,N]=cC(),[k,j]=cC(),E=vtt(s,t),T=cx(r);el(()=>(f.set(t,{id:t,key:i,node:_,activatorNode:k,data:T}),()=>{const R=f.get(t);R&&R.key===i&&f.delete(t)}),[f,t]);const O=w.useMemo(()=>({role:p,tabIndex:b,"aria-disabled":n,"aria-pressed":y&&p===zX?!0:void 0,"aria-roledescription":v,"aria-describedby":d.draggable}),[n,p,b,y,v,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:O,isDragging:y,listeners:n?void 0:E,node:_,over:m,setNodeRef:N,setActivatorNodeRef:j,transform:S}}function bpe(){return w.useContext(ppe)}const Ttt="Droppable",Att={timeout:25};function M2(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e;const i=y1(Ttt),{active:s,dispatch:l,over:c,measureDroppableContainers:u}=w.useContext(w1),d=w.useRef({disabled:r}),f=w.useRef(!1),m=w.useRef(null),p=w.useRef(null),{disabled:v,updateMeasurementsFor:b,timeout:y}={...Att,...a},S=cx(b??n),_=w.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(S.current)?S.current:[S.current]),p.current=null},y)},[y]),N=j2({callback:_,disabled:v||!s}),k=w.useCallback((O,R)=>{N&&(R&&(N.unobserve(R),f.current=!1),O&&N.observe(O))},[N]),[j,E]=cC(k),T=cx(t);return w.useEffect(()=>{!N||!j.current||(N.disconnect(),f.current=!1,N.observe(j.current))},[j,N]),w.useEffect(()=>(l({type:Na.RegisterDroppable,element:{id:n,key:i,disabled:r,node:j,rect:m,data:T}}),()=>l({type:Na.UnregisterDroppable,key:i,id:n})),[n]),w.useEffect(()=>{r!==d.current.disabled&&(l({type:Na.SetDroppableDisabled,id:n,key:i,disabled:r}),d.current.disabled=r)},[n,i,r,l]),{active:s,rect:m,isOver:c?.id===n,node:j,over:c,setNodeRef:E}}function Dtt(e){let{animation:t,children:r}=e;const[n,a]=w.useState(null),[i,s]=w.useState(null),l=uC(r);return!r&&!n&&l&&a(l),el(()=>{if(!i)return;const c=n?.key,u=n?.props.id;if(c==null||u==null){a(null);return}Promise.resolve(t(u,i)).then(()=>{a(null)})},[t,n,i]),le.createElement(le.Fragment,null,r,n?w.cloneElement(n,{ref:s}):null)}const Ltt={x:0,y:0,scaleX:1,scaleY:1};function Ott(e){let{children:t}=e;return le.createElement(w1.Provider,{value:mpe},le.createElement(E2.Provider,{value:Ltt},t))}const Itt={position:"fixed",touchAction:"none"},Rtt=e=>_2(e)?"transform 250ms ease":void 0,Ptt=w.forwardRef((e,t)=>{let{as:r,activatorEvent:n,adjustScale:a,children:i,className:s,rect:l,style:c,transform:u,transition:d=Rtt}=e;if(!l)return null;const f=a?u:{...u,scaleX:1,scaleY:1},m={...Itt,width:l.width,height:l.height,top:l.top,left:l.left,transform:Bl.Transform.toString(f),transformOrigin:a&&n?Det(n,l):void 0,transition:typeof d=="function"?d(n):d,...c};return le.createElement(r,{className:s,style:m,ref:t},i)}),ztt=e=>t=>{let{active:r,dragOverlay:n}=t;const a={},{styles:i,className:s}=e;if(i!=null&&i.active)for(const[l,c]of Object.entries(i.active))c!==void 0&&(a[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,c));if(i!=null&&i.dragOverlay)for(const[l,c]of Object.entries(i.dragOverlay))c!==void 0&&n.node.style.setProperty(l,c);return s!=null&&s.active&&r.node.classList.add(s.active),s!=null&&s.dragOverlay&&n.node.classList.add(s.dragOverlay),function(){for(const[c,u]of Object.entries(a))r.node.style.setProperty(c,u);s!=null&&s.active&&r.node.classList.remove(s.active)}},Btt=e=>{let{transform:{initial:t,final:r}}=e;return[{transform:Bl.Transform.toString(t)},{transform:Bl.Transform.toString(r)}]},$tt={duration:250,easing:"ease",keyframes:Btt,sideEffects:ztt({styles:{active:{opacity:"0"}}})};function Ftt(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:a}=e;return k2((i,s)=>{if(t===null)return;const l=r.get(i);if(!l)return;const c=l.node.current;if(!c)return;const u=hpe(s);if(!u)return;const{transform:d}=qi(s).getComputedStyle(s),f=npe(d);if(!f)return;const m=typeof t=="function"?t:Utt(t);return upe(c,a.draggable.measure),m({active:{id:i,data:l.data,node:c,rect:a.draggable.measure(c)},draggableNodes:r,dragOverlay:{node:s,rect:a.dragOverlay.measure(u)},droppableContainers:n,measuringConfiguration:a,transform:f})})}function Utt(e){const{duration:t,easing:r,sideEffects:n,keyframes:a}={...$tt,...e};return i=>{let{active:s,dragOverlay:l,transform:c,...u}=i;if(!t)return;const d={x:l.rect.left-s.rect.left,y:l.rect.top-s.rect.top},f={scaleX:c.scaleX!==1?s.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?s.rect.height*c.scaleY/l.rect.height:1},m={x:c.x-d.x,y:c.y-d.y,...f},p=a({...u,active:s,dragOverlay:l,transform:{initial:c,final:m}}),[v]=p,b=p[p.length-1];if(JSON.stringify(v)===JSON.stringify(b))return;const y=n?.({active:s,dragOverlay:l,...u}),S=l.node.animate(p,{duration:t,easing:r,fill:"forwards"});return new Promise(_=>{S.onfinish=()=>{y?.(),_()}})}}let BX=0;function Htt(e){return w.useMemo(()=>{if(e!=null)return BX++,BX},[e])}const pC=le.memo(e=>{let{adjustScale:t=!1,children:r,dropAnimation:n,style:a,transition:i,modifiers:s,wrapperElement:l="div",className:c,zIndex:u=999}=e;const{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:p,draggableNodes:v,droppableContainers:b,dragOverlay:y,over:S,measuringConfiguration:_,scrollableAncestors:N,scrollableAncestorRects:k,windowRect:j}=bpe(),E=w.useContext(E2),T=Htt(f?.id),O=gpe(s,{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:p,draggingNodeRect:y.rect,over:S,overlayNodeRect:y.rect,scrollableAncestors:N,scrollableAncestorRects:k,transform:E,windowRect:j}),R=zB(m),q=Ftt({config:n,draggableNodes:v,droppableContainers:b,measuringConfiguration:_}),$=R?y.setRef:void 0;return le.createElement(Ott,null,le.createElement(Dtt,{animation:q},f&&T?le.createElement(Ptt,{key:T,id:f.id,ref:$,as:l,activatorEvent:d,adjustScale:t,className:c,transition:i,rect:R,style:{zIndex:u,...a},transform:O},r):null))});function ype(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function qtt(e,t){return e.reduce((r,n,a)=>{const i=t.get(n);return i&&(r[a]=i),r},Array(e.length))}function RS(e){return e!==null&&e>=0}function Wtt(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Ktt(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const PS={scaleX:1,scaleY:1},Gtt=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:a,overIndex:i,index:s}=e;const l=(t=r[a])!=null?t:n;if(!l)return null;const c=Vtt(r,s,a);if(s===a){const u=r[i];return u?{x:a<i?u.left+u.width-(l.left+l.width):u.left-l.left,y:0,...PS}:null}return s>a&&s<=i?{x:-l.width-c,y:0,...PS}:s<a&&s>=i?{x:l.width+c,y:0,...PS}:{x:0,y:0,...PS}};function Vtt(e,t,r){const n=e[t],a=e[t-1],i=e[t+1];return!n||!a&&!i?0:r<t?a?n.left-(a.left+a.width):i.left-(n.left+n.width):i?i.left-(n.left+n.width):n.left-(a.left+a.width)}const xpe=e=>{let{rects:t,activeIndex:r,overIndex:n,index:a}=e;const i=ype(t,n,r),s=t[a],l=i[a];return!l||!s?null:{x:l.left-s.left,y:l.top-s.top,scaleX:l.width/s.width,scaleY:l.height/s.height}},zS={scaleX:1,scaleY:1},Ytt=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:a,rects:i,overIndex:s}=e;const l=(t=i[r])!=null?t:n;if(!l)return null;if(a===r){const u=i[s];return u?{x:0,y:r<s?u.top+u.height-(l.top+l.height):u.top-l.top,...zS}:null}const c=Qtt(i,a,r);return a>r&&a<=s?{x:0,y:-l.height-c,...zS}:a<r&&a>=s?{x:0,y:l.height+c,...zS}:{x:0,y:0,...zS}};function Qtt(e,t,r){const n=e[t],a=e[t-1],i=e[t+1];return n?r<t?a?n.top-(a.top+a.height):i?i.top-(n.top+n.height):0:i?i.top-(n.top+n.height):a?n.top-(a.top+a.height):0:0}const wpe="Sortable",Spe=le.createContext({activeIndex:-1,containerId:wpe,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:xpe,disabled:{draggable:!1,droppable:!1}});function kpe(e){let{children:t,id:r,items:n,strategy:a=xpe,disabled:i=!1}=e;const{active:s,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=bpe(),f=y1(wpe,r),m=l.rect!==null,p=w.useMemo(()=>n.map(E=>typeof E=="object"&&"id"in E?E.id:E),[n]),v=s!=null,b=s?p.indexOf(s.id):-1,y=u?p.indexOf(u.id):-1,S=w.useRef(p),_=!Wtt(p,S.current),N=y!==-1&&b===-1||_,k=Ktt(i);el(()=>{_&&v&&d(p)},[_,p,v,d]),w.useEffect(()=>{S.current=p},[p]);const j=w.useMemo(()=>({activeIndex:b,containerId:f,disabled:k,disableTransforms:N,items:p,overIndex:y,useDragOverlay:m,sortedRects:qtt(p,c),strategy:a}),[b,f,k.draggable,k.droppable,N,p,y,c,m,a]);return le.createElement(Spe.Provider,{value:j},t)}const Jtt=e=>{let{id:t,items:r,activeIndex:n,overIndex:a}=e;return ype(r,n,a).indexOf(t)},Ztt=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:a,items:i,newIndex:s,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!n||l!==i&&a===s?!1:r?!0:s!==a&&t===c},Xtt={duration:200,easing:"ease"},_pe="transform",ert=Bl.Transition.toString({property:_pe,duration:0,easing:"linear"}),trt={roleDescription:"sortable"};function rrt(e){let{disabled:t,index:r,node:n,rect:a}=e;const[i,s]=w.useState(null),l=w.useRef(r);return el(()=>{if(!t&&r!==l.current&&n.current){const c=a.current;if(c){const u=w0(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&s(d)}}r!==l.current&&(l.current=r)},[t,r,n,a]),w.useEffect(()=>{i&&s(null)},[i]),i}function Npe(e){let{animateLayoutChanges:t=Ztt,attributes:r,disabled:n,data:a,getNewIndex:i=Jtt,id:s,strategy:l,resizeObserverConfig:c,transition:u=Xtt}=e;const{items:d,containerId:f,activeIndex:m,disabled:p,disableTransforms:v,sortedRects:b,overIndex:y,useDragOverlay:S,strategy:_}=w.useContext(Spe),N=nrt(n,p),k=d.indexOf(s),j=w.useMemo(()=>({sortable:{containerId:f,index:k,items:d},...a}),[f,a,k,d]),E=w.useMemo(()=>d.slice(d.indexOf(s)),[d,s]),{rect:T,node:O,isOver:R,setNodeRef:q}=M2({id:s,data:j,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:$,activatorEvent:L,activeNodeRect:A,attributes:M,setNodeRef:z,listeners:I,isDragging:B,over:F,setActivatorNodeRef:U,transform:V}=vpe({id:s,data:j,attributes:{...trt,...r},disabled:N.draggable}),K=vet(q,z),G=!!$,J=G&&!v&&RS(m)&&RS(y),ee=!S&&B,Y=ee&&J?V:null,fe=J?Y??(l??_)({rects:b,activeNodeRect:A,activeIndex:m,overIndex:y,index:k}):null,me=RS(m)&&RS(y)?i({id:s,items:d,activeIndex:m,overIndex:y}):k,te=$?.id,oe=w.useRef({activeId:te,items:d,newIndex:me,containerId:f}),ce=d!==oe.current.items,Z=t({active:$,containerId:f,isDragging:B,isSorting:G,id:s,index:k,items:d,newIndex:oe.current.newIndex,previousItems:oe.current.items,previousContainerId:oe.current.containerId,transition:u,wasDragging:oe.current.activeId!=null}),ue=rrt({disabled:!Z,index:k,node:O,rect:T});return w.useEffect(()=>{G&&oe.current.newIndex!==me&&(oe.current.newIndex=me),f!==oe.current.containerId&&(oe.current.containerId=f),d!==oe.current.items&&(oe.current.items=d)},[G,me,f,d]),w.useEffect(()=>{if(te===oe.current.activeId)return;if(te!=null&&oe.current.activeId==null){oe.current.activeId=te;return}const ge=setTimeout(()=>{oe.current.activeId=te},50);return()=>clearTimeout(ge)},[te]),{active:$,activeIndex:m,attributes:M,data:j,rect:T,index:k,newIndex:me,items:d,isOver:R,isSorting:G,isDragging:B,listeners:I,node:O,overIndex:y,over:F,setNodeRef:K,setActivatorNodeRef:U,setDroppableNodeRef:q,setDraggableNodeRef:z,transform:ue??fe,transition:H()};function H(){if(ue||ce&&oe.current.newIndex===k)return ert;if(!(ee&&!_2(L)||!u)&&(G||Z))return Bl.Transition.toString({...u,property:_pe})}}function nrt(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e?.draggable)!=null?r:t.draggable,droppable:(n=e?.droppable)!=null?n:t.droppable}}function gC(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const art=[Cr.Down,Cr.Right,Cr.Up,Cr.Left],Cpe=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:a,droppableContainers:i,over:s,scrollableAncestors:l}}=t;if(art.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const m=a.get(f.id);if(m)switch(e.code){case Cr.Down:n.top<m.top&&c.push(f);break;case Cr.Up:n.top>m.top&&c.push(f);break;case Cr.Left:n.left>m.left&&c.push(f);break;case Cr.Right:n.left<m.left&&c.push(f);break}});const u=tpe({collisionRect:n,droppableRects:a,droppableContainers:c});let d=epe(u,"id");if(d===s?.id&&u.length>1&&(d=u[1].id),d!=null){const f=i.get(r.id),m=i.get(d),p=m?a.get(m.id):null,v=m?.node.current;if(v&&p&&f&&m){const y=N2(v).some((E,T)=>l[T]!==E),S=jpe(f,m),_=irt(f,m),N=y||!S?{x:0,y:0}:{x:_?n.width-p.width:0,y:_?n.height-p.height:0},k={x:p.left,y:p.top};return N.x&&N.y?k:ux(k,N)}}}};function jpe(e,t){return!gC(e)||!gC(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function irt(e,t){return!gC(e)||!gC(t)||!jpe(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const EL=new Map,Lk={assignee:null,priority:null,tag:null},$X={field:"created_at",direction:"desc"},FX=[{id:"backlog",title:"Backlog",icon:I6,color:"border-slate-400",iconColor:"text-slate-500"},{id:"unassigned",title:"Unassigned",icon:rs,color:"border-gray-400",iconColor:"text-gray-500"},{id:"assigned",title:"Assigned",icon:Vae,color:"border-blue-400",iconColor:"text-blue-500"},{id:"in_progress",title:"In Progress",icon:en,color:"border-yellow-400",iconColor:"text-yellow-500"},{id:"awaiting_merge",title:"Awaiting Merge",icon:Ri,color:"border-purple-400",iconColor:"text-purple-500"},{id:"closed",title:"Closed",icon:Yn,color:"border-green-400",iconColor:"text-green-500"}],srt=120,ort=8,UX={1:"border-l-red-500",2:"border-l-orange-500",3:"border-l-yellow-500",4:"border-l-green-500",5:"border-l-gray-400"},lrt={bug:"bg-red-50 dark:bg-red-900/20",feature:"bg-purple-50 dark:bg-purple-900/20",task:"bg-blue-50 dark:bg-blue-900/20",chore:"bg-gray-50 dark:bg-gray-800/50"};function crt(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:t.toLocaleDateString()}function np(e){const t=`orchestrator-kanban-column-${e}`,[r,n]=w.useState(()=>{if(typeof window>"u")return{filters:{...Lk},sortOverride:null};try{const i=localStorage.getItem(t);if(i){const s=JSON.parse(i);return{filters:{...Lk,...s.filters},sortOverride:s.sortOverride||null}}}catch{}return{filters:{...Lk},sortOverride:null}}),a=w.useCallback(i=>{n(s=>{const l={filters:{...s.filters,...i.filters||{}},sortOverride:"sortOverride"in i?i.sortOverride??null:s.sortOverride};try{localStorage.setItem(t,JSON.stringify(l))}catch{}return l})},[t]);return[r,a]}function ap(e,t,r,n){let a=[...e];if(n){const i=n.toLowerCase();a=a.filter(s=>s.title.toLowerCase().includes(i)||s.id.toLowerCase().includes(i))}return t.assignee&&(a=a.filter(i=>i.assignee===t.assignee)),t.priority!==null&&(a=a.filter(i=>i.priority===t.priority)),t.tag&&(a=a.filter(i=>i.tags?.includes(t.tag))),a.sort((i,s)=>{let l=0;switch(r.field){case"priority":l=i.priority-s.priority;break;case"created_at":l=new Date(i.createdAt).getTime()-new Date(s.createdAt).getTime();break;case"updated_at":l=new Date(i.updatedAt).getTime()-new Date(s.updatedAt).getTime();break;case"deadline":{const c=i.deadline,u=s.deadline;!c&&!u?l=0:c?u?l=new Date(c).getTime()-new Date(u).getTime():l=-1:l=1;break}case"title":l=i.title.localeCompare(s.title);break;case"complexity":l=i.complexity-s.complexity;break}return r.direction==="asc"?l:-l}),a}function urt(e){const t=new Set;return e.forEach(r=>{r.assignee&&t.add(r.assignee)}),Array.from(t).sort()}function drt(e){const t=new Set;return e.forEach(r=>{r.tags?.forEach(n=>t.add(n))}),Array.from(t).sort()}function Epe({task:e,entityNameMap:t,isSelected:r,onClick:n,isDragging:a=!1}){const i=UX[e.priority]||UX[3],s=lrt[e.taskType]||"",l=e.assignee?t.get(e.assignee):void 0,c=e.metadata?.orchestrator?.branch,u=e.metadata?.orchestrator?.mergeStatus;return o.jsxs("div",{className:`
        p-3 bg-[var(--color-surface)] rounded-lg shadow-sm border-l-4 ${i} ${s}
        cursor-pointer transition-all hover:shadow-md h-full flex flex-col
        ${r?"ring-2 ring-[var(--color-primary)]":"border-t border-r border-b border-[var(--color-border)]"}
        ${a?"opacity-50":""}
      `,onClick:n,"data-testid":`kanban-card-${e.id}`,children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] text-sm mb-1 line-clamp-2 break-words",children:e.title}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-tertiary)] mb-2",children:[o.jsx("span",{className:"font-mono truncate max-w-20",children:e.id.slice(0,8)}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(tn,{className:"w-3 h-3"}),crt(e.createdAt)]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap mt-auto",children:[o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] rounded capitalize",children:e.taskType}),l&&o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded truncate max-w-24",children:[o.jsx(Zr,{className:"w-3 h-3 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:l})]}),c&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] rounded truncate max-w-20 font-mono",children:c.split("/").pop()}),u&&o.jsx(frt,{status:u})]})]})}function frt({status:e}){const t={pending:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300",testing:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300",merging:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-300",merged:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300",conflict:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300",test_failed:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300",failed:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300",not_applicable:"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400"};return o.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${t[e]}`,children:e.replace("_"," ")})}function hrt({task:e,entityNameMap:t,isSelected:r,onClick:n}){const{attributes:a,listeners:i,setNodeRef:s,transform:l,transition:c,isDragging:u}=Npe({id:e.id}),d={transform:Bl.Transform.toString(l),transition:c};return o.jsx("div",{ref:s,style:d,className:"h-full",...a,...i,children:o.jsx(Epe,{task:e,entityNameMap:t,isSelected:r,onClick:n,isDragging:u})})}function mrt({columnId:e,availableAssignees:t,availableTags:r,preferences:n,pageSort:a,onUpdate:i,entityNameMap:s}){const[l,c]=w.useState(!1),u=w.useRef(null),d=[n.filters.assignee,n.filters.priority,n.filters.tag].filter(Boolean).length,f=n.sortOverride!==null,m=n.sortOverride||a;w.useEffect(()=>{function S(_){u.current&&!u.current.contains(_.target)&&c(!1)}return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const p=()=>{i({filters:Lk})},v=S=>{i(S==="page"?{sortOverride:null}:{sortOverride:{field:S,direction:m.direction}})},b=S=>{f&&n.sortOverride?i({sortOverride:{...n.sortOverride,direction:S}}):i({sortOverride:{field:a.field,direction:S}})},y=yl.find(S=>S.value===a.field)?.label||a.field;return o.jsxs("div",{className:"relative",ref:u,children:[o.jsxs("button",{onClick:()=>c(!l),className:`p-1 rounded transition-colors ${d>0||f?"text-[var(--color-primary)] bg-[var(--color-primary-muted)] hover:bg-[var(--color-primary-muted)]":"text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,title:"Filter & Sort","data-testid":`${e}-filter-button`,children:[o.jsx(ru,{className:"w-3.5 h-3.5"}),(d>0||f)&&o.jsx("span",{className:"absolute -top-1 -right-1 w-3.5 h-3.5 bg-[var(--color-primary)] text-white text-[10px] rounded-full flex items-center justify-center",children:d+(f?1:0)})]}),l&&o.jsxs("div",{className:"absolute right-0 top-full mt-1 w-56 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg z-20 py-2","data-testid":`${e}-filter-dropdown`,children:[o.jsxs("div",{className:"px-3 pb-2 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide mb-2",children:[o.jsx(e0,{className:"w-3 h-3"}),"Sort"]}),o.jsx("div",{className:"mb-2",children:o.jsxs("select",{value:f?n.sortOverride.field:"page",onChange:S=>v(S.target.value),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-sort-field`,children:[o.jsxs("option",{value:"page",children:["Page sort (",y,")"]}),yl.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))]})}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>b("asc"),className:`flex-1 px-2 py-1 text-xs rounded ${m.direction==="asc"?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] border border-[var(--color-border)]"}`,"data-testid":`${e}-sort-asc`,children:"Ascending"}),o.jsx("button",{onClick:()=>b("desc"),className:`flex-1 px-2 py-1 text-xs rounded ${m.direction==="desc"?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] border border-[var(--color-border)]"}`,"data-testid":`${e}-sort-desc`,children:"Descending"})]})]}),o.jsxs("div",{className:"px-3 pt-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:[o.jsx(ru,{className:"w-3 h-3"}),"Filter"]}),d>0&&o.jsx("button",{onClick:p,className:"text-xs text-[var(--color-primary)] hover:underline","data-testid":`${e}-clear-filters`,children:"Clear"})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)] mb-1 block",children:"Priority"}),o.jsxs("select",{value:n.filters.priority??"",onChange:S=>i({filters:{...n.filters,priority:S.target.value?parseInt(S.target.value,10):null}}),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-filter-priority`,children:[o.jsx("option",{value:"",children:"All priorities"}),lC.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))]})]}),t.length>0&&o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)] mb-1 block",children:"Assignee"}),o.jsxs("select",{value:n.filters.assignee??"",onChange:S=>i({filters:{...n.filters,assignee:S.target.value||null}}),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-filter-assignee`,children:[o.jsx("option",{value:"",children:"All assignees"}),t.map(S=>o.jsx("option",{value:S,children:s.get(S)||S},S))]})]}),r.length>0&&o.jsxs("div",{className:"mb-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)] mb-1 block",children:"Tag"}),o.jsxs("select",{value:n.filters.tag??"",onChange:S=>i({filters:{...n.filters,tag:S.target.value||null}}),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-filter-tag`,children:[o.jsx("option",{value:"",children:"All tags"}),r.map(S=>o.jsx("option",{value:S,children:S},S))]})]})]})]})]})}function prt({columnId:e,title:t,color:r,icon:n,tasks:a,entityNameMap:i,selectedTaskId:s,onTaskClick:l,isDragActive:c,preferences:u,pageSort:d,onUpdatePreferences:f,availableAssignees:m,availableTags:p}){const v=w.useRef(null),b=a.map(R=>R.id),y=w.useRef(null),S=`kanban-column-${e}`,_=u.filters.assignee||u.filters.priority!==null||u.filters.tag,{setNodeRef:N,isOver:k}=M2({id:e}),j=lj({count:a.length,getScrollElement:()=>v.current,estimateSize:()=>srt,gap:ort,overscan:5,getItemKey:R=>a[R].id}),E=j.getVirtualItems(),T=w.useCallback(R=>{v.current=R,N(R)},[N]);w.useEffect(()=>{if(S&&v.current){const R=EL.get(S);R!==void 0&&R>0&&requestAnimationFrame(()=>{j.scrollToOffset(R)})}},[S]),w.useEffect(()=>()=>{if(S&&v.current){const R=j.scrollOffset;R!==null&&R>0&&EL.set(S,R)}},[S,j]);const O=w.useCallback(()=>{y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{const R=j.scrollOffset;S&&R!==null&&R>0&&EL.set(S,R)},100)},[j,S]);return w.useEffect(()=>()=>{y.current&&clearTimeout(y.current)},[]),o.jsxs("div",{className:`flex flex-col flex-1 min-w-[280px] bg-[var(--color-surface-elevated)] rounded-lg border-t-4 ${r} h-full`,"data-testid":`kanban-column-${e}`,children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-b border-[var(--color-border)] sticky top-0 bg-[var(--color-surface-elevated)] z-10 rounded-t-lg",children:[n,o.jsx("span",{className:"font-medium text-[var(--color-text)] text-sm",children:t}),o.jsx("span",{className:"px-2 py-0.5 text-xs bg-[var(--color-surface)] text-[var(--color-text-secondary)] rounded-full","data-testid":`kanban-column-${e}-count`,children:a.length}),o.jsx("div",{className:"ml-auto flex items-center gap-2",children:o.jsx(mrt,{columnId:e,availableAssignees:m,availableTags:p,preferences:u,pageSort:d,onUpdate:f,entityNameMap:i})})]}),o.jsx("div",{ref:T,className:`flex-1 overflow-y-auto p-2 pt-3 ${k&&c?"bg-[var(--color-primary-muted)]":""}`,"data-testid":`kanban-column-${e}-scroll`,onScroll:O,children:a.length===0?o.jsx("div",{className:"p-4 text-center text-[var(--color-text-tertiary)] text-sm h-32 flex items-center justify-center",children:_?"No matching tasks":"No tasks"}):o.jsx("div",{className:"relative w-full",style:{height:`${j.getTotalSize()}px`},children:o.jsx(kpe,{items:b,strategy:Ytt,children:E.map(R=>{const q=a[R.index];return o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${R.size}px`,transform:`translateY(${R.start}px)`},"data-index":R.index,children:o.jsx(hrt,{task:q,entityNameMap:i,isSelected:q.id===s,onClick:()=>l(q.id)})},q.id)})})})})]})}function grt({tasks:e,entityNameMap:t,selectedTaskId:r,onTaskClick:n,onUpdateTask:a,searchQuery:i,pageSort:s}){const[l,c]=w.useState(null),u=w.useMemo(()=>{if(!s)return $X;const V=s.field;return yl.some(K=>K.value===V)?{field:V,direction:s.direction}:$X},[s?.field,s?.direction]),[d,f]=np("backlog"),[m,p]=np("unassigned"),[v,b]=np("assigned"),[y,S]=np("in_progress"),[_,N]=np("closed"),[k,j]=np("awaiting_merge"),E=w.useMemo(()=>urt(e||[]),[e]),T=w.useMemo(()=>drt(e||[]),[e]),O=w.useMemo(()=>{const V={backlog:[],unassigned:[],assigned:[],in_progress:[],closed:[],awaiting_merge:[]};for(const K of e){if(K.status==="tombstone")continue;const G=K.metadata?.orchestrator?.mergeStatus;K.status==="backlog"?V.backlog.push(K):K.status==="review"?V.awaiting_merge.push(K):K.status==="closed"?G&&G!=="merged"?V.awaiting_merge.push(K):V.closed.push(K):K.status==="in_progress"?V.in_progress.push(K):(K.status==="open"||K.status==="blocked"||K.status==="deferred")&&(K.assignee?V.assigned.push(K):V.unassigned.push(K))}return V},[e]),R=w.useMemo(()=>ap(O.backlog,d.filters,d.sortOverride||u,i),[O.backlog,d.filters,d.sortOverride,u,i]),q=w.useMemo(()=>ap(O.unassigned,m.filters,m.sortOverride||u,i),[O.unassigned,m.filters,m.sortOverride,u,i]),$=w.useMemo(()=>ap(O.assigned,v.filters,v.sortOverride||u,i),[O.assigned,v.filters,v.sortOverride,u,i]),L=w.useMemo(()=>ap(O.in_progress,y.filters,y.sortOverride||u,i),[O.in_progress,y.filters,y.sortOverride,u,i]),A=w.useMemo(()=>ap(O.closed,_.filters,_.sortOverride||u,i),[O.closed,_.filters,_.sortOverride,u,i]),M=w.useMemo(()=>ap(O.awaiting_merge,k.filters,k.sortOverride||u,i),[O.awaiting_merge,k.filters,k.sortOverride,u,i]),z=IB(dx(x1,{activationConstraint:{distance:8}}),dx(C2,{coordinateGetter:Cpe})),I=V=>{const{active:K}=V,G=e?.find(J=>J.id===K.id);G&&c(G)},B=V=>{const{active:K,over:G}=V;if(c(null),!G||!e)return;const J=K.id,ee=e.find(fe=>fe.id===J);if(!ee)return;let Y=null;if(e.find(fe=>fe.id===G.id)){for(const[fe,me]of Object.entries(O))if(me.some(te=>te.id===G.id)){Y=fe;break}}else FX.some(fe=>fe.id===G.id)&&(Y=G.id);if(Y){const fe={},te={backlog:"backlog",unassigned:"open",assigned:"open",in_progress:"in_progress",closed:"closed",awaiting_merge:"closed"}[Y];te&&te!==ee.status&&(fe.status=te),Y==="unassigned"&&ee.assignee&&(fe.assignee=null),Object.keys(fe).length>0&&a(J,fe)}},F=l!==null,U=[{id:"backlog",prefs:d,setPrefs:f,tasks:R},{id:"unassigned",prefs:m,setPrefs:p,tasks:q},{id:"assigned",prefs:v,setPrefs:b,tasks:$},{id:"in_progress",prefs:y,setPrefs:S,tasks:L},{id:"awaiting_merge",prefs:k,setPrefs:j,tasks:M},{id:"closed",prefs:_,setPrefs:N,tasks:A}];return o.jsxs(mC,{sensors:z,collisionDetection:tpe,onDragStart:I,onDragEnd:B,children:[o.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 h-[calc(100vh-320px)]","data-testid":"kanban-board",children:FX.map((V,K)=>{const G=V.icon,{prefs:J,setPrefs:ee,tasks:Y}=U[K];return o.jsx(prt,{columnId:V.id,title:V.title,color:V.color,icon:o.jsx(G,{className:`w-4 h-4 ${V.iconColor}`}),tasks:Y,entityNameMap:t,selectedTaskId:r,onTaskClick:n,isDragActive:F,preferences:J,pageSort:u,onUpdatePreferences:ee,availableAssignees:E,availableTags:T},V.id)})}),o.jsx(pC,{children:l&&o.jsx(Epe,{task:l,entityNameMap:t,isSelected:!1,onClick:()=>{}})})]})}const vrt=[10,25,50,100];function brt({currentPage:e,totalPages:t,totalItems:r,pageSize:n,onPageChange:a,onPageSizeChange:i,showPageSizeSelector:s=!0}){const l=r===0?0:(e-1)*n+1,c=Math.min(e*n,r),u=()=>{const d=[];if(t<=5)for(let m=1;m<=t;m++)d.push(m);else{d.push(1),e>3&&d.push("ellipsis");const m=Math.max(2,e-1),p=Math.min(t-1,e+1);for(let v=m;v<=p;v++)d.push(v);e<t-2&&d.push("ellipsis"),t>1&&d.push(t)}return d};return t<=1&&!s?o.jsx("div",{className:"flex items-center justify-center sm:justify-between px-3 sm:px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:o.jsx("span",{className:"text-xs sm:text-sm text-[var(--color-text-tertiary)]",children:r===0?"No items":`Showing ${r} item${r!==1?"s":""}`})}):o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":"pagination",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]","data-testid":"pagination-info",children:r===0?"No items":`Showing ${l}-${c} of ${r}`}),s&&i&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"pagination-page-size",className:"text-sm text-[var(--color-text-tertiary)]",children:"Show"}),o.jsx("select",{id:"pagination-page-size",value:n,onChange:d=>i(parseInt(d.target.value,10)),className:"px-2 py-1 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] focus:border-[var(--color-primary)]","data-testid":"pagination-page-size","aria-label":"Items per page",children:vrt.map(d=>o.jsx("option",{value:d,children:d},d))}),o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"per page"})]})]}),t>1&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>a(1),disabled:e===1,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"First page","data-testid":"pagination-first",children:o.jsx(wwe,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>a(e-1),disabled:e===1,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Previous page","data-testid":"pagination-prev",children:o.jsx(Fl,{className:"w-4 h-4"})}),o.jsx("div",{className:"flex items-center gap-1 mx-2",children:u().map((d,f)=>d==="ellipsis"?o.jsx("span",{className:"px-2 text-[var(--color-text-tertiary)]",children:"..."},`ellipsis-${f}`):o.jsx("button",{onClick:()=>a(d),className:`min-w-[32px] h-8 px-2 text-sm rounded transition-colors ${d===e?"bg-[var(--color-primary)] text-white font-medium":"hover:bg-[var(--color-surface-hover)] text-[var(--color-text)]"}`,"data-testid":`pagination-page-${d}`,"aria-current":d===e?"page":void 0,children:d},d))}),o.jsx("button",{onClick:()=>a(e+1),disabled:e===t,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Next page","data-testid":"pagination-next",children:o.jsx(gn,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>a(t),disabled:e===t,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Last page","data-testid":"pagination-last",children:o.jsx(Swe,{className:"w-4 h-4"})})]})]})}function yrt(){const e=rl({from:"/tasks"}),t=Ma(),r=e.showClosed??!1,[n,a]=w.useState(()=>IZe()),[i,s]=w.useState(()=>BZe()),[l,c]=w.useState(()=>FZe()),[u,d]=w.useState(()=>HZe()),[f,m]=w.useState(()=>PZe()),[p,v]=w.useState(()=>LZe()),[b,y]=w.useState(dX),S=e.page??1,_=e.limit??bf,N=e.status||"all",[k,j]=w.useState(!1),[E,T]=w.useState(!1),O=e.selected,[R,q]=w.useState(new Set),[$,L]=w.useState(!1),{columnWidths:A,handleMouseDown:M}=KZe();w.useEffect(()=>{(e.action==="create"||e.backlog)&&(T(e.backlog===!0),j(!0),t({to:"/tasks",search:{selected:e.selected,page:e.page??1,limit:e.limit??bf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0},replace:!0}))},[e.action,e.backlog,e.selected,e.page,e.limit,e.status,e.assignee,e.showClosed,t]);const[z,I]=w.useState(new Set),[B,F]=w.useState(new Set),[U,V]=w.useState(new Set),[K,G]=w.useState(null),[J,ee]=w.useState(new Set),{backlog:Y,unassigned:ie,assigned:fe,inProgress:me,closed:te,awaitingMerge:oe,allTasks:ce,isLoading:Z,error:ue,refetch:H}=h1(),{data:ge}=y2(),de=w.useMemo(()=>{const be=new Map;return ge&&ge.forEach(W=>be.set(W.id,W.name)),be},[ge]),re=hme(),ne=mme(),pe=pme(),ke=fme(),we=rJe(),ve=w.useCallback(be=>{a(be),RZe(be)},[]),Le=w.useCallback(be=>{s(be),$Ze(be)},[]),Ae=w.useCallback(be=>{c(be),UZe(be)},[]),Re=w.useCallback(be=>{d(be),qZe(be)},[]),Ye=w.useCallback(be=>{m(be),zZe(be)},[]),mt=w.useCallback(be=>{v(be),OZe(be)},[]);w.useEffect(()=>{let be=!1;const W=xe=>{if(!(xe.target instanceof HTMLInputElement||xe.target instanceof HTMLTextAreaElement)){if(xe.key==="v"||xe.key==="V"){be=!0;return}be&&(xe.key==="l"||xe.key==="L"?(ve("list"),be=!1):((xe.key==="k"||xe.key==="K")&&ve("kanban"),be=!1))}},se=()=>{setTimeout(()=>{be=!1},500)};return document.addEventListener("keydown",W),document.addEventListener("keyup",se),()=>{document.removeEventListener("keydown",W),document.removeEventListener("keyup",se)}},[ve]);const ot=w.useMemo(()=>{let be;switch(N){case"backlog":be=Y;break;case"unassigned":be=ie;break;case"assigned":be=fe;break;case"in_progress":be=me;break;case"closed":be=te;break;case"awaiting_merge":be=oe;break;default:be=ce.filter(W=>W.status!=="tombstone"&&(r||W.status!=="closed"))}return be},[N,ce,Y,ie,fe,me,te,oe,r]),Ot=w.useMemo(()=>{const be=DZe(b,p);return ot.filter(be)},[ot,b,p]),rt=w.useMemo(()=>{const be=[...Ot];return be.sort((W,se)=>{const xe=hX(W,se,i==="created_at"?"createdAt":i==="updated_at"?"updatedAt":i,l);return xe!==0||!u?xe:hX(W,se,u==="created_at"?"createdAt":u==="updated_at"?"updatedAt":u,l)}),be},[Ot,i,l,u]),ze=rt.length,bt=Math.ceil(ze/_),tt=w.useMemo(()=>{if(n==="kanban")return rt;const be=(S-1)*_,W=be+_;return rt.slice(be,W)},[rt,S,_,n]),_e=w.useMemo(()=>n==="kanban"||f==="none"?[{key:"all",label:"All Tasks",tasks:tt}]:AZe(tt,f,de),[tt,f,de,n]),We=be=>{q(new Set),t({to:"/tasks",search:{selected:e.selected,page:1,limit:e.limit??bf,status:be==="all"?void 0:be,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},Ve=w.useCallback(be=>{t({to:"/tasks",search:{selected:e.selected,page:e.page??1,limit:e.limit??bf,status:e.status,assignee:e.assignee,showClosed:be||void 0,action:void 0,backlog:void 0}})},[t,e.selected,e.page,e.limit,e.status,e.assignee]),Mt=be=>{t({to:"/tasks",search:{selected:e.selected,page:be,limit:e.limit??bf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},kt=be=>{t({to:"/tasks",search:{selected:e.selected,page:1,limit:be,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},er=be=>{t({to:"/tasks",search:{selected:be,page:e.page??1,limit:e.limit??bf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},mr=()=>{t({to:"/tasks",search:{selected:void 0,page:e.page??1,limit:e.limit??bf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},Zt=async be=>{I(W=>new Set(W).add(be));try{await re.mutateAsync({taskId:be})}finally{I(W=>{const se=new Set(W);return se.delete(be),se})}},Wt=async be=>{F(W=>new Set(W).add(be));try{await ne.mutateAsync({taskId:be})}finally{F(W=>{const se=new Set(W);return se.delete(be),se})}},Rt=be=>{G(be)},he=async be=>{if(!K)return;const W=K;G(null),V(se=>new Set(se).add(W));try{await pe.mutateAsync({taskId:W,message:be})}finally{V(se=>{const xe=new Set(se);return xe.delete(W),xe})}},De=async(be,W)=>{const se={taskId:be};W.status!==void 0&&(se.status=W.status),W.assignee!==void 0&&(se.assignee=W.assignee),await ke.mutateAsync(se)},Ue=()=>{y(dX)},ut=w.useCallback(be=>{q(W=>{const se=new Set(W);return se.has(be)?se.delete(be):se.add(be),se})},[]),St=w.useCallback(()=>{q(be=>{const W=tt.map(xe=>xe.id);if(W.length>0&&W.every(xe=>be.has(xe))){const xe=new Set(be);return W.forEach(Ce=>xe.delete(Ce)),xe}else{const xe=new Set(be);return W.forEach(Ce=>xe.add(Ce)),xe}})},[tt]),jt=async()=>{try{await we.mutateAsync({ids:Array.from(R)}),q(new Set),L(!1)}catch(be){console.error("Failed to bulk delete tasks:",be)}},Je=w.useCallback(()=>{q(new Set)},[]),Xe=be=>{ee(W=>{const se=new Set(W);return se.has(be)?se.delete(be):se.add(be),se})},it=w.useCallback(be=>{be===i?Ae(l==="asc"?"desc":"asc"):(Le(be),Ae(be==="updated_at"||be==="priority"?"desc":"asc"))},[i,l,Le,Ae]),Xt=tt.length>0&&tt.every(be=>R.has(be.id)),X=tt.some(be=>R.has(be.id)),Oe={all:ce.filter(be=>be.status!=="tombstone"&&(r||be.status!=="closed")).length,backlog:Y.length,unassigned:ie.length,assigned:fe.length,in_progress:me.length,closed:te.length,awaiting_merge:oe.length},Ke=ce.filter(be=>be.status==="closed").length;return o.jsxs("div",{className:"space-y-4 animate-fade-in","data-testid":"tasks-page",children:[o.jsx(Vme,{isOpen:k,onClose:()=>{j(!1),T(!1)},onSuccess:be=>er(be),defaultToBacklog:E}),K&&o.jsx(Kme,{taskTitle:ce.find(be=>be.id===K)?.title??K,onConfirm:he,onCancel:()=>G(null),isReopening:pe.isPending}),O&&o.jsxs("div",{className:"fixed inset-0 z-40","data-testid":"task-detail-overlay",children:[o.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:mr}),o.jsx("div",{className:"absolute right-0 top-0 h-full w-full max-w-[min(32rem,100%)] bg-[var(--color-surface)] shadow-xl border-l border-[var(--color-border)] animate-slide-in-right",children:o.jsx(BXe,{taskId:O,onClose:mr,onNavigateToTask:er})})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)] shrink-0",children:o.jsx(Tl,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Tasks"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] truncate",children:"Manage and track agent task assignments"})]})]}),o.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150 shrink-0","data-testid":"tasks-create",children:[o.jsx(_r,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden @sm:inline",children:"Create Task"}),o.jsx("kbd",{className:"hidden @sm:inline ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(Pl("action.createTask"))})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("div",{className:"relative flex-1 min-w-[12rem] max-w-xs",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:"Search tasks...",value:p,onChange:be=>mt(be.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"tasks-search"})]}),o.jsx(het,{sortField:i,sortDirection:l,secondarySort:u,onSortFieldChange:Le,onSortDirectionChange:Ae,onSecondarySortChange:Re}),n==="list"&&o.jsx(met,{groupBy:f,onGroupByChange:Ye}),o.jsx(pet,{view:n,onViewChange:ve})]})]}),n==="list"&&o.jsx(get,{filters:b,onFilterChange:y,onClearFilters:Ue,entityNameMap:de}),n==="list"&&o.jsxs("div",{className:"flex items-center justify-between border-b border-[var(--color-border)] overflow-x-auto",children:[o.jsxs("nav",{className:"flex gap-1 min-w-max","aria-label":"Tabs",children:[o.jsx(yf,{label:"All",value:"all",current:N,count:Oe.all,icon:Tl,onClick:()=>We("all")}),o.jsx(yf,{label:"Backlog",value:"backlog",current:N,count:Oe.backlog,icon:rs,onClick:()=>We("backlog")}),o.jsx(yf,{label:"Unassigned",value:"unassigned",current:N,count:Oe.unassigned,icon:rs,onClick:()=>We("unassigned")}),o.jsx(yf,{label:"Assigned",value:"assigned",current:N,count:Oe.assigned,icon:Vae,onClick:()=>We("assigned")}),o.jsx(yf,{label:"In Progress",value:"in_progress",current:N,count:Oe.in_progress,icon:en,onClick:()=>We("in_progress")}),o.jsx(yf,{label:"Awaiting Merge",value:"awaiting_merge",current:N,count:Oe.awaiting_merge,icon:Ri,onClick:()=>We("awaiting_merge")}),o.jsx(yf,{label:"Closed",value:"closed",current:N,count:Oe.closed,icon:Yn,onClick:()=>We("closed")})]}),o.jsxs("button",{onClick:()=>Ve(!r),className:`
              flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-md ml-4 mb-1
              transition-all duration-150 ease-out border
              ${r?"bg-[var(--color-success-muted)] text-[var(--color-success)] border-[var(--color-success)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:bg-[var(--color-surface-hover)]"}
            `,"data-testid":"toggle-show-closed",children:[r?o.jsx(du,{className:"w-4 h-4"}):o.jsx(Yae,{className:"w-4 h-4"}),o.jsxs("span",{children:["Closed (",Ke,")"]})]})]}),R.size>0&&n==="list"&&o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 bg-[var(--color-primary-muted)] border border-[var(--color-primary)] rounded-lg","data-testid":"bulk-actions-bar",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-sm font-medium text-[var(--color-primary)]",children:[R.size," task",R.size!==1?"s":""," selected"]}),o.jsxs("button",{onClick:Je,className:"text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors flex items-center gap-1","data-testid":"bulk-clear-selection",children:[o.jsx(wt,{className:"w-3.5 h-3.5"}),"Clear"]})]}),o.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 border border-red-200 dark:border-red-800 rounded-md transition-colors","data-testid":"bulk-delete-button",children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})]}),$&&o.jsxs("div",{className:"fixed inset-0 z-50",onClick:()=>L(!1),"data-testid":"bulk-delete-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm",onClick:be=>be.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Tasks"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsx("div",{className:"px-5 py-4",children:o.jsxs("p",{className:"text-sm text-[var(--color-text)]",children:["Are you sure you want to delete ",o.jsx("strong",{children:R.size})," task",R.size!==1?"s":"","?"]})}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>L(!1),disabled:we.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"bulk-delete-cancel",children:"Cancel"}),o.jsxs("button",{onClick:jt,disabled:we.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"bulk-delete-confirm",children:[we.isPending&&o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Delete ",R.size," Task",R.size!==1?"s":""]})]})]})})]}),Z?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading tasks..."})]}):ue?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-danger)] rounded-lg bg-[var(--color-danger-muted)]",children:[o.jsx(Bt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"Failed to load tasks"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:ue.message}),o.jsxs("button",{onClick:()=>H(),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-surface)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"tasks-retry",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]}):Ot.length===0?o.jsx(Srt,{searchQuery:p,currentTab:N,onCreateClick:()=>j(!0)}):n==="list"?o.jsxs(o.Fragment,{children:[o.jsx(xrt,{groups:_e,entityNameMap:de,onStart:Zt,onComplete:Wt,onReopen:Rt,onSelectTask:er,pendingStart:z,pendingComplete:B,pendingReopen:U,collapsedGroups:J,onToggleCollapse:Xe,searchQuery:p,sortField:i,sortDirection:l,onSortChange:it,selectedTaskIds:R,onToggleSelect:ut,allPageSelected:Xt,somePageSelected:X,onToggleSelectAll:St,columnWidths:A,onColumnResizeStart:M}),o.jsx(brt,{currentPage:S,totalPages:bt,totalItems:ze,pageSize:_,onPageChange:Mt,onPageSizeChange:kt})]}):o.jsx(grt,{tasks:ce,entityNameMap:de,selectedTaskId:O??null,onTaskClick:er,onUpdateTask:De,searchQuery:p,pageSort:{field:i,direction:l}})]})}function yf({label:e,value:t,current:r,count:n,icon:a,onClick:i}){const s=r===t;return o.jsx("button",{onClick:i,className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${s?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":`tasks-tab-${t}`,children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(a,{className:"w-4 h-4"}),e,n>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:n})]})})}function ip({label:e,field:t,currentSortField:r,currentSortDirection:n,onSortChange:a,width:i,resizable:s,columnId:l,onResizeStart:c}){const u=r===t;return o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wider relative",style:i!=null?{width:`${i}px`,minWidth:`${i}px`}:void 0,children:[o.jsxs("button",{onClick:()=>a(t),className:"flex items-center gap-1 cursor-pointer hover:text-[var(--color-text)] transition-colors group",children:[o.jsx("span",{children:e}),u?n==="asc"?o.jsx(Rx,{className:"w-3.5 h-3.5 text-[var(--color-primary)]"}):o.jsx(Ix,{className:"w-3.5 h-3.5 text-[var(--color-primary)]"}):o.jsx(e0,{className:"w-3.5 h-3.5 opacity-0 group-hover:opacity-50 transition-opacity"})]}),s&&l&&c&&o.jsx(Mpe,{columnId:l,onResizeStart:c})]})}function Mpe({columnId:e,onResizeStart:t}){return o.jsx("div",{className:"absolute top-0 right-0 w-2 h-full cursor-col-resize group/resize z-10 select-none",onMouseDown:r=>t(r,e),onClick:r=>r.stopPropagation(),role:"separator","aria-orientation":"vertical","aria-label":`Resize ${e} column`,"data-testid":`column-resize-handle-${e}`,children:o.jsx("div",{className:"absolute right-0 top-0 w-[2px] h-full bg-transparent group-hover/resize:bg-[var(--color-primary)] transition-colors"})})}function xrt({groups:e,entityNameMap:t,onStart:r,onComplete:n,onReopen:a,onSelectTask:i,pendingStart:s,pendingComplete:l,pendingReopen:c,collapsedGroups:u,onToggleCollapse:d,searchQuery:f,sortField:m,sortDirection:p,onSortChange:v,selectedTaskIds:b,onToggleSelect:y,allPageSelected:S,somePageSelected:_,onToggleSelectAll:N,columnWidths:k,onColumnResizeStart:j}){const E=e.length>1||e.length===1&&e[0].key!=="all",T=oC;return o.jsx("div",{className:"border border-[var(--color-border)] rounded-lg overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",style:{tableLayout:"fixed"},"data-testid":"tasks-table",children:[o.jsx("colgroup",{children:T.map(O=>o.jsx("col",{style:{width:`${k[O.id]??O.defaultWidth}px`,minWidth:`${O.minWidth}px`}},O.id))}),o.jsx("thead",{className:"bg-[var(--color-surface-elevated)]",children:o.jsxs("tr",{className:"border-b border-[var(--color-border)]",children:[o.jsx("th",{className:"pl-4 pr-1 py-3",style:{width:`${k.checkbox??40}px`},children:o.jsx("input",{type:"checkbox",checked:S,ref:O=>{O&&(O.indeterminate=_&&!S)},onChange:N,className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)] cursor-pointer","data-testid":"task-select-all-checkbox","aria-label":"Select all tasks"})}),o.jsx(ip,{label:"Task",field:"title",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.title,resizable:!0,columnId:"title",onResizeStart:j}),o.jsx(ip,{label:"Status",field:"status",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.status,resizable:!0,columnId:"status",onResizeStart:j}),o.jsx(ip,{label:"Priority",field:"priority",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.priority,resizable:!0,columnId:"priority",onResizeStart:j}),o.jsx(ip,{label:"Type",field:"taskType",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.taskType,resizable:!0,columnId:"taskType",onResizeStart:j}),o.jsx(ip,{label:"Assignee",field:"assignee",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.assignee,resizable:!0,columnId:"assignee",onResizeStart:j}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wider relative",style:{width:`${k.branch??160}px`},children:["Branch",o.jsx(Mpe,{columnId:"branch",onResizeStart:j})]}),o.jsx(ip,{label:"Updated",field:"updated_at",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.updatedAt,resizable:!0,columnId:"updatedAt",onResizeStart:j}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wider",style:{width:`${k.actions??100}px`},children:"Actions"})]})}),o.jsx("tbody",{className:"bg-[var(--color-surface)]",children:e.map(O=>o.jsx(wrt,{group:O,entityNameMap:t,onStart:r,onComplete:n,onReopen:a,onSelectTask:i,pendingStart:s,pendingComplete:l,pendingReopen:c,showHeader:E,isCollapsed:u.has(O.key),onToggleCollapse:()=>d(O.key),searchQuery:f,selectedTaskIds:b,onToggleSelect:y},O.key))})]})})})}function wrt({group:e,entityNameMap:t,onStart:r,onComplete:n,onReopen:a,onSelectTask:i,pendingStart:s,pendingComplete:l,pendingReopen:c,showHeader:u,isCollapsed:d,onToggleCollapse:f,searchQuery:m,selectedTaskIds:p,onToggleSelect:v}){return o.jsxs(o.Fragment,{children:[u&&o.jsx("tr",{className:"bg-[var(--color-surface-elevated)] border-t border-b border-[var(--color-border)]",children:o.jsx("td",{colSpan:9,children:o.jsxs("button",{onClick:f,className:"w-full px-4 py-2 flex items-center gap-2 text-sm font-medium text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]",children:[d?o.jsx(gn,{className:"w-4 h-4"}):o.jsx(cr,{className:"w-4 h-4"}),o.jsx("span",{className:e.color?`px-2 py-0.5 rounded text-xs ${e.color}`:"",children:e.label}),o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:["(",e.tasks.length,")"]})]})})}),!d&&e.tasks.map(b=>{const y=m?MZe(b.title,m):null;return o.jsx(AXe,{task:b,assigneeName:b.assignee?t.get(b.assignee):void 0,onStart:()=>r(b.id),onComplete:()=>n(b.id),onReopen:()=>a(b.id),onClick:()=>i(b.id),isStarting:s.has(b.id),isCompleting:l.has(b.id),isReopening:c.has(b.id),highlightedTitle:y?.indices?TZe(b.title,y.indices):void 0,isSelected:p.has(b.id),onToggleSelect:v},b.id)})]})}function Srt({searchQuery:e,currentTab:t,onCreateClick:r}){if(e)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(br,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"No matching tasks"}),o.jsxs("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:['No tasks found matching "',e,'". Try a different search term.']})]});const n={all:{title:"No tasks yet",description:"Create your first task to get started. Tasks can be assigned to agents and tracked through completion."},backlog:{title:"No backlog tasks",description:"No tasks are currently in the backlog. Create a task with backlog status to see it here."},unassigned:{title:"No unassigned tasks",description:"All tasks have been assigned to agents. Create a new task or unassign an existing one."},assigned:{title:"No assigned tasks",description:"No tasks are currently assigned and waiting to start. Assign a task to an agent to see it here."},in_progress:{title:"No tasks in progress",description:"No agents are currently working on tasks. Start a task to see it here."},closed:{title:"No completed tasks",description:"No tasks have been completed yet. Keep working on those tasks!"},awaiting_merge:{title:"No tasks awaiting merge",description:"No completed tasks are waiting to be merged. Completed task branches will appear here."}},{title:a,description:i}=n[t];return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(Tl,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:a}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:i}),t==="all"&&o.jsxs("button",{onClick:r,className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"tasks-create-empty",children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Task"]})]})}function FP({title:e,icon:t,iconColor:r="text-blue-500",count:n,totalCount:a,subtitle:i,actions:s=[],children:l,testId:c,bordered:u=!1,className:d=""}){const f=jo(),m=()=>n===void 0?null:a!==void 0&&a!==n?o.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[n," of ",a]}):o.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:["(",n,")"]}),p=()=>s.length===0?null:o.jsx("div",{className:"flex items-center gap-2",children:s.map((b,y)=>{const S=b.icon,_=b.variant!=="secondary";return o.jsxs("button",{onClick:b.onClick,className:`inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-md transition-colors touch-target ${_?"text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]":"text-[var(--color-text)] bg-[var(--color-surface-hover)] hover:bg-[var(--color-border)]"}`,"data-testid":b.testId,children:[S&&o.jsx(S,{className:"w-4 h-4"}),o.jsx("span",{className:f&&b.shortLabel?"hidden sm:inline":"",children:b.label}),f&&b.shortLabel&&o.jsx("span",{className:"sm:hidden",children:b.shortLabel}),b.shortcut&&!f&&o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:b.shortcut})]},y)})}),v=u?`border-b border-[var(--color-border)] bg-[var(--color-surface)] ${f?"p-3":"p-4"} ${d}`:`mb-4 sm:mb-6 ${d}`;return o.jsxs("div",{"data-testid":c,className:v,children:[o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t&&o.jsx(t,{className:`w-5 h-5 sm:w-6 sm:h-6 ${r} flex-shrink-0`}),o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-[var(--color-text)] truncate",children:e}),!f&&m()]})]}),p()]}),f&&n!==void 0&&o.jsx("div",{className:"mt-1",children:m()}),i&&o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)]",children:i}),l&&o.jsx("div",{className:u?"mt-3":"mt-3 sm:mt-4",children:l})]})}function krt(){const e=rl({from:"/plans"}),t=Ma(),r=jo(),{currentUser:n}=nl(),[a,i]=w.useState(()=>h6e()),[s,l]=w.useState(()=>d6e()),[c,u]=w.useState(s),[d,f]=w.useState(!1),[m,p]=w.useState(!1);w.useEffect(()=>{e.action==="create"&&(f(!0),t({to:"/plans",search:{selected:e.selected,status:e.status},replace:!0}))},[e.action,e.selected,e.status,t]);const v=e.status||null,{data:b=[],isLoading:y,isError:S,error:_,refetch:N}=g6e(v||void 0),k=w.useCallback(I=>{i(I),m6e(I)},[]),j=w.useCallback(I=>{l(I),f6e(I)},[]);w.useEffect(()=>{const I=setTimeout(()=>{u(s)},u6e);return()=>clearTimeout(I)},[s]);const E=w.useMemo(()=>c?b.filter(I=>{const B=qY(I.title,c);return B&&B.matched}):b,[b,c]),T=w.useCallback(I=>c?qY(I,c)?.indices||[]:[],[c]),O=w.useCallback(I=>{t({to:"/plans",search:{selected:I,status:e.status??void 0}})},[t,e.status]),R=w.useCallback(()=>{t({to:"/plans",search:{selected:void 0,status:e.status??void 0}})},[t,e.status]),q=w.useCallback(I=>{t({to:"/plans",search:{status:I??void 0,selected:void 0}})},[t]),$=w.useCallback(()=>{j("")},[j]),L=w.useCallback(I=>{O(I.id)},[O]),A=w.useCallback(I=>{fetch(`/api/tasks/${I}`).then(B=>B.json()).then(B=>{const F=B.task||B;GY({id:F.id,title:F.title}),Kr.success("Task created and added to selection")}).catch(()=>{GY({id:I,title:"New Task"})}),p(!1)},[]),M=e.selected||null,z=M&&!r;return S?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[o.jsx(Bt,{className:"w-12 h-12 text-red-400 mb-4"}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Failed to load plans"}),o.jsx("p",{className:"text-[var(--color-text-secondary)] mt-1",children:_?.message||"An unknown error occurred"}),o.jsx("button",{onClick:()=>N(),className:"mt-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:"Retry"})]}):o.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[o.jsx(FP,{title:"Plans",icon:tu,iconColor:"text-blue-500",count:E.length,totalCount:b.length!==E.length?b.length:void 0,bordered:!0,actions:[{label:"Create Plan",shortLabel:"Create",icon:_r,onClick:()=>f(!0),shortcut:Pl("action.createPlan"),testId:"create-plan-btn"}],testId:"plans-header",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(M6e,{value:s,onChange:j,onClear:$}),o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsx("div",{className:r?"overflow-x-auto -mx-3 px-3 scrollbar-hide flex-1":"",children:o.jsx(j6e,{selectedStatus:v,onStatusChange:q})}),!r&&o.jsx(E6e,{view:a,onViewChange:k})]})]})}),o.jsxs("div",{className:"flex-1 flex min-h-0",children:[o.jsx("div",{className:`flex-1 overflow-hidden ${z?"hidden lg:block":""}`,children:y?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx($e,{className:"w-8 h-8 animate-spin text-blue-500"})}):E.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[o.jsx(tu,{className:"w-12 h-12 text-gray-300 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:c?"No plans found":"No plans yet"}),o.jsx("p",{className:"text-[var(--color-text-secondary)] mt-1",children:c?"Try adjusting your search or filters":"Create your first plan to get started"}),!c&&o.jsxs("button",{onClick:()=>f(!0),className:"mt-4 inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Plan"]})]}):a==="roadmap"&&!r?o.jsx("div",{className:"h-full p-4",children:o.jsx(I6e,{plans:E,onPlanClick:O,selectedPlanId:M})}):o.jsx("div",{className:"h-full overflow-y-auto",children:r?o.jsx("div",{children:E.map(I=>o.jsx($6e,{plan:I,isSelected:M===I.id,onClick:()=>O(I.id),searchMatchIndices:T(I.title)},I.id))}):o.jsx("div",{className:"p-4 space-y-3",children:E.map(I=>o.jsx(T6e,{plan:I,isSelected:M===I.id,onClick:O,searchMatchIndices:T(I.title)},I.id))})})}),z&&M&&o.jsx("div",{className:"w-96 flex-shrink-0 border-l border-[var(--color-border)] overflow-hidden",children:o.jsx(P6e,{planId:M,onClose:R,taskLinkBase:"/tasks",onRemoveTaskNotAllowed:()=>Kr.error("Cannot remove the last task. Plans must have at least one task."),onDeleteSuccess:()=>{Kr.success("Plan deleted successfully"),R()},onDeleteError:I=>Kr.error(I)})})]}),o.jsx(F6e,{isOpen:d,onClose:()=>f(!1),onSuccess:L,currentUserId:n?.id,isMobile:r,onToastSuccess:I=>Kr.success(I),onToastError:I=>Kr.error(I),onCreateNewTask:()=>p(!0)}),o.jsx(Vme,{isOpen:m,onClose:()=>p(!1),onSuccess:A})]})}const HX={running:{label:"Running",color:"text-[var(--color-success-text)]",bgColor:"bg-[var(--color-success-muted)]",icon:nu},idle:{label:"Idle",color:"text-[var(--color-text-secondary)]",bgColor:"bg-[var(--color-surface-elevated)]",icon:nu},suspended:{label:"Suspended",color:"text-[var(--color-warning-text)]",bgColor:"bg-[var(--color-warning-muted)]",icon:kwe},terminated:{label:"Stopped",color:"text-[var(--color-text-tertiary)]",bgColor:"bg-[var(--color-surface)]",icon:uu},starting:{label:"Starting",color:"text-[var(--color-info-text)]",bgColor:"bg-[var(--color-info-muted)]",icon:$e},unknown:{label:"Unknown",color:"text-[var(--color-text-muted)]",bgColor:"bg-[var(--color-surface)]",icon:Bt}};function _rt({status:e,size:t="md",showLabel:r=!0}){const n=HX[e??"unknown"]??HX.unknown,a=n.icon,i=e==="running"||e==="starting",s=t==="sm"?"w-2.5 h-2.5":"w-3 h-3",l=t==="sm"?"text-xs":"text-sm",c=t==="sm"?"px-1.5 py-0.5":"px-2 py-1";return o.jsxs("span",{className:`inline-flex items-center gap-1.5 ${c} rounded-full ${n.bgColor} ${n.color} ${l} font-medium`,"data-testid":`agent-status-${e??"unknown"}`,children:[o.jsx(a,{className:`${s} ${i?e==="running"?"fill-current":"animate-spin":""}`}),r&&o.jsx("span",{children:n.label})]})}const Nrt={director:{label:"Director",color:"text-[var(--color-primary)]",bgColor:"bg-[var(--color-primary-muted)]",icon:Px},worker:{label:"Worker",color:"text-[var(--color-info-text)]",bgColor:"bg-[var(--color-info-muted)]",icon:Zo},steward:{label:"Steward",color:"text-[var(--color-accent-text)]",bgColor:"bg-[var(--color-accent-muted)]",icon:Xo}},Crt={ephemeral:{label:"Ephemeral",icon:eh},persistent:{label:"Persistent",icon:Xr}},jrt={merge:{label:"Merge",icon:Xr},health:{label:"Health",icon:Xo},reminder:{label:"Reminder",icon:Xr},ops:{label:"Ops",icon:li},docs:{label:"Docs",icon:Xr}};function Ert({role:e,workerMode:t,stewardFocus:r,size:n="md"}){const a=Nrt[e];let i=a.icon,s=null;if(e==="worker"&&t){const d=Crt[t];i=d.icon,s=d.label}e==="steward"&&r&&(s=jrt[r].label);const l=n==="sm"?"w-3 h-3":"w-4 h-4",c=n==="sm"?"text-xs":"text-sm",u=n==="sm"?"px-1.5 py-0.5":"px-2 py-1";return o.jsxs("span",{className:`inline-flex items-center gap-1.5 ${u} rounded-md ${a.bgColor} ${a.color} ${c} font-medium`,"data-testid":`agent-role-${e}`,children:[o.jsx(i,{className:l}),o.jsx("span",{children:a.label}),s&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["(",s,")"]})]})}function Tpe(e,t="sm"){const r=t==="sm"?"w-3 h-3":"w-4 h-4";switch(e){case"agent":return o.jsx(Xr,{className:r});case"human":return o.jsx(Zr,{className:r});case"system":return o.jsx(Od,{className:r});default:return o.jsx(Zr,{className:r})}}function Ape(e){switch(e){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}}function Mrt({item:e,isSelected:t,onSelect:r}){const n=e.status==="unread",a=e.sender?.name??"Unknown",i=e.sender?.entityType??"agent",l=(e.message?.contentPreview??"").split(`
`)[0]?.slice(0,60)||"";return o.jsxs("button",{onClick:r,className:`w-full text-left px-3 py-2.5 flex items-start gap-2.5 transition-colors border-b border-gray-100 dark:border-gray-800 ${t?"bg-blue-50 dark:bg-blue-900/20 border-l-2 border-l-blue-500":n?"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50":"bg-gray-50/50 dark:bg-gray-900/50 hover:bg-gray-100/50 dark:hover:bg-gray-800/30"}`,children:[o.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 ${Ape(i)}`,children:Tpe(i,"sm")}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("span",{className:`text-sm truncate ${n?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"}`,children:a}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:lme(e.createdAt)}),n&&o.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[o.jsx("span",{className:`inline-flex items-center gap-0.5 px-1 py-0.5 text-[10px] font-medium rounded ${e.sourceType==="mention"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.sourceType==="mention"?o.jsx(R6,{className:"w-2.5 h-2.5"}):o.jsx(ss,{className:"w-2.5 h-2.5"})}),l&&o.jsx("p",{className:`text-xs truncate ${n?"text-gray-600 dark:text-gray-400":"text-gray-500 dark:text-gray-500"}`,children:l})]})]})]})}function Trt({item:e,onMarkRead:t,onMarkUnread:r,onArchive:n,onRestore:a,isPending:i}){const s=e.status==="unread",l=e.status==="archived",c=e.sender?.name??"Unknown",u=e.sender?.entityType??"agent",d=e.channel?.name??"Unknown channel",f=e.message?.fullContent??e.message?.contentPreview??"";return o.jsxs("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[o.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${Ape(u)}`,children:Tpe(u,"md")}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:c}),o.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("span",{children:["#",d]}),o.jsx("span",{children:""}),o.jsx("span",{className:`inline-flex items-center gap-0.5 px-1 py-0.5 font-medium rounded ${e.sourceType==="mention"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.sourceType==="mention"?o.jsxs(o.Fragment,{children:[o.jsx(R6,{className:"w-2.5 h-2.5"}),"Mention"]}):o.jsxs(o.Fragment,{children:[o.jsx(ss,{className:"w-2.5 h-2.5"}),"Direct"]})})]})]})]}),o.jsx("div",{className:"flex items-center gap-0.5",children:i?o.jsx($e,{className:"w-4 h-4 animate-spin text-gray-400"}):l?o.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",title:"Restore",children:o.jsx(jr,{className:"w-4 h-4"})}):o.jsxs(o.Fragment,{children:[s?o.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:"Mark as read",children:o.jsx(YC,{className:"w-4 h-4"})}):o.jsx("button",{onClick:r,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:"Mark as unread",children:o.jsx(VC,{className:"w-4 h-4"})}),o.jsx("button",{onClick:n,className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded transition-colors",title:"Archive",children:o.jsx(I6,{className:"w-4 h-4"})})]})})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:UQe(e.createdAt)})]}),o.jsx("div",{className:"flex-1 overflow-auto p-3",children:o.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:f||o.jsx("span",{className:"text-gray-400 italic",children:"No content"})})})]})}function Art({view:e}){const t={unread:{title:"No unread messages",subtitle:"All caught up!"},all:{title:"No messages",subtitle:"This agent has no messages yet"},archived:{title:"No archived messages",subtitle:"Archive messages to see them here"}};return o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 p-6",children:[o.jsx(rs,{className:"w-10 h-10 mb-2"}),o.jsx("p",{className:"text-sm font-medium",children:t[e].title}),o.jsx("p",{className:"text-xs mt-1",children:t[e].subtitle})]})}function Drt({isOpen:e,onClose:t,agentId:r,agentName:n}){const[a,i]=w.useState("unread"),[s,l]=w.useState(null),{data:c,isLoading:u,error:d,refetch:f}=sme(r,a),{data:m}=NB(r),p=FQe(r),v=ome(r),b=c?.items.find(E=>E.id===s),y=m?.count??0,S=E=>{p.mutate({itemId:E,status:"read"})},_=E=>{p.mutate({itemId:E,status:"unread"})},N=E=>{p.mutate({itemId:E,status:"archived"}),s===E&&l(null)},k=E=>{p.mutate({itemId:E,status:"read"})},j=()=>{v.mutate()};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:t}),o.jsxs("div",{className:"fixed inset-y-0 right-0 w-full max-w-2xl bg-white dark:bg-gray-900 shadow-xl z-50 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(rs,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:["Inbox: ",n]}),y>0&&o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[y," unread message",y!==1?"s":""]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[y>0&&o.jsx("button",{onClick:j,disabled:v.isPending,className:"text-xs px-2 py-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors disabled:opacity-50",children:v.isPending?"Marking...":"Mark all read"}),o.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded transition-colors",children:o.jsx(wt,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex items-center gap-1 px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[["unread","all","archived"].map(E=>o.jsxs("button",{onClick:()=>{i(E),l(null)},className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${a===E?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[E==="unread"?"Unread":E==="all"?"All":"Archived",E==="unread"&&y>0&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-[10px] bg-blue-500 text-white rounded-full",children:y})]},E)),o.jsx("button",{onClick:()=>f(),className:"ml-auto p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Refresh",children:o.jsx(jr,{className:`w-4 h-4 ${u?"animate-spin":""}`})})]}),o.jsx("div",{className:"flex-1 flex overflow-hidden",children:d?o.jsx("div",{className:"flex-1 flex items-center justify-center text-red-500 dark:text-red-400 p-6",children:o.jsxs("p",{className:"text-sm",children:["Failed to load inbox: ",d.message]})}):u?o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:o.jsx($e,{className:"w-6 h-6 animate-spin"})}):c?.items.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-2/5 border-r border-gray-200 dark:border-gray-700 overflow-y-auto",children:c.items.map(E=>o.jsx(Mrt,{item:E,isSelected:s===E.id,onSelect:()=>l(E.id)},E.id))}),o.jsx("div",{className:"flex-1 overflow-hidden",children:b?o.jsx(Trt,{item:b,onMarkRead:()=>S(b.id),onMarkUnread:()=>_(b.id),onArchive:()=>N(b.id),onRestore:()=>k(b.id),isPending:p.isPending}):o.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500",children:[o.jsx(gn,{className:"w-8 h-8 mb-2"}),o.jsx("p",{className:"text-sm",children:"Select a message to view"})]})})]}):o.jsx(Art,{view:a})})]})]}):null}function Lrt({isOpen:e,onClose:t,agentId:r,currentProvider:n,onSuccess:a}){const[i,s]=w.useState(n),[l,c]=w.useState(null),u=PQe(),{data:d,isLoading:f}=wB();if(w.useEffect(()=>{e&&(s(n),c(null))},[e,n]),!e)return null;const m=()=>{c(null),t()},p=async b=>{if(b.preventDefault(),c(null),i===n){m();return}try{await u.mutateAsync({agentId:r,provider:i}),a?.(),m()}catch(y){c(y instanceof Error?y.message:"Failed to change provider")}},v=d?.providers??[];return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:m,"data-testid":"change-provider-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-sm
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"change-provider-dialog",role:"dialog","aria-labelledby":"change-provider-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"change-provider-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Change Provider"}),o.jsx("button",{onClick:m,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"change-provider-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[l&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),l]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-provider",className:"text-sm font-medium text-[var(--color-text)]",children:"Provider"}),f?o.jsxs("div",{className:"flex items-center gap-2 py-2 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Loading providers..."]}):o.jsx("select",{id:"agent-provider",value:i,onChange:b=>s(b.target.value),className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"change-provider-select",children:v.map(b=>o.jsxs("option",{value:b.name,disabled:!b.available,children:[b.name,b.available?"":" (not installed)"]},b.name))})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:m,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-provider-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u.isPending||i===n,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-provider-submit",children:u.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Changing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(ZC,{className:"w-4 h-4"}),"Change"]})})]})]})]})})]})}function Ort({isOpen:e,onClose:t,agentId:r,currentModel:n,currentProvider:a,onSuccess:i}){const[s,l]=w.useState(n??""),[c,u]=w.useState(null),d=zQe(),{data:f,isLoading:m,error:p}=SB(a);if(w.useEffect(()=>{e&&(l(n??""),u(null))},[e,n]),!e)return null;const v=()=>{u(null),t()},b=async j=>{if(j.preventDefault(),u(null),s===(n??"")){v();return}try{await d.mutateAsync({agentId:r,model:s||null}),i?.(),v()}catch(T){u(T instanceof Error?T.message:"Failed to change model")}},y=f?.models??[],S=y.find(j=>j.isDefault),_=y.filter(j=>!j.isDefault),k=s!==(n??"");return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:v,"data-testid":"change-model-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-sm
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"change-model-dialog",role:"dialog","aria-labelledby":"change-model-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"change-model-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Change Model"}),o.jsx("button",{onClick:v,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"change-model-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:b,className:"p-4 space-y-4",children:[c&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),c]}),p&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),"Failed to load models. Try again later."]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-model",className:"text-sm font-medium text-[var(--color-text)]",children:"Model"}),m?o.jsxs("div",{className:"flex items-center gap-2 py-2 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Loading models..."]}):o.jsxs("select",{id:"agent-model",value:s,onChange:j=>l(j.target.value),className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"change-model-select",children:[o.jsx("option",{value:"",children:S?`Default (${S.displayName})`:"(Default)"}),_.map(j=>o.jsx("option",{value:j.id,children:j.providerName?`${j.displayName}    ${j.providerName}`:j.displayName},j.id))]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Select a model or use the provider's default."})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:v,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-model-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:d.isPending||!k||m,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-model-submit",children:d.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Changing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(li,{className:"w-4 h-4"}),"Change"]})})]})]})]})})]})}function Ok({agent:e,activeSessionStatus:t,onStart:r,onStop:n,onRestart:a,onOpenTerminal:i,onRename:s,onDelete:l,isStarting:c,isStopping:u}){const[d,f]=w.useState(!1),[m,p]=w.useState(!1),[v,b]=w.useState(!1),[y,S]=w.useState(!1),_=w.useRef(null),{data:N}=NB(e.id),k=N?.count??0,j=e.metadata?.agent,E=t==="running"||t==="starting",T=!E&&!c,O=E&&!u;w.useEffect(()=>{if(!d)return;const $=L=>{_.current&&!_.current.contains(L.target)&&f(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[d]);const R=j?.agentRole==="worker"?j:null,q=j?.agentRole==="steward"?j:null;return o.jsxs("div",{className:"p-4 border border-[var(--color-border)] rounded-lg bg-[var(--color-surface)] hover:border-[var(--color-border-hover)] transition-colors duration-150","data-testid":`agent-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h3",{className:"font-semibold text-[var(--color-text)] truncate","data-testid":`agent-name-${e.id}`,children:e.name}),o.jsx(_rt,{status:t??"idle",size:"sm",showLabel:!1})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[o.jsx(Ert,{role:j?.agentRole??"worker",workerMode:R?.workerMode,stewardFocus:q?.stewardFocus,size:"sm"}),o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-[10px] font-medium rounded bg-[var(--color-surface-elevated)] text-[var(--color-text-tertiary)] border border-[var(--color-border)]","data-testid":`agent-provider-${e.id}`,children:!j?.provider||j.provider==="claude"?"claude code":j.provider}),j?.model&&o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-[10px] font-medium rounded bg-[var(--color-surface-elevated)] text-[var(--color-text-tertiary)] border border-[var(--color-border)]","data-testid":`agent-model-${e.id}`,children:j.model})]})]}),o.jsxs("div",{className:"relative",ref:_,children:[o.jsx("button",{onClick:()=>f(!d),className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-menu-${e.id}`,children:o.jsx(n0,{className:"w-4 h-4"})}),d&&o.jsxs("div",{className:`
                absolute right-0 top-full mt-1 z-20
                min-w-36 py-1 rounded-md shadow-lg
                bg-[var(--color-bg)] border border-[var(--color-border)]
              `,"data-testid":`agent-menu-dropdown-${e.id}`,children:[o.jsxs("button",{onClick:()=>{f(!1),s?.()},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-text-secondary)]
                  hover:bg-[var(--color-surface-hover)]
                  hover:text-[var(--color-text)]
                `,"data-testid":`agent-rename-${e.id}`,children:[o.jsx(Uh,{className:"w-3.5 h-3.5"}),"Rename agent"]}),o.jsxs("button",{onClick:()=>{f(!1),b(!0)},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-text-secondary)]
                  hover:bg-[var(--color-surface-hover)]
                  hover:text-[var(--color-text)]
                  whitespace-nowrap
                `,"data-testid":`agent-change-provider-${e.id}`,children:[o.jsx(ZC,{className:"w-3.5 h-3.5"}),"Change provider"]}),o.jsxs("button",{onClick:()=>{f(!1),S(!0)},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-text-secondary)]
                  hover:bg-[var(--color-surface-hover)]
                  hover:text-[var(--color-text)]
                  whitespace-nowrap
                `,"data-testid":`agent-change-model-${e.id}`,children:[o.jsx(li,{className:"w-3.5 h-3.5"}),"Change model"]}),o.jsxs("button",{onClick:()=>{f(!1),l?.()},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-danger)]
                  hover:bg-[var(--color-surface-hover)]
                `,"data-testid":`agent-delete-${e.id}`,children:[o.jsx(Sr,{className:"w-3.5 h-3.5"}),"Delete agent"]})]})]})]}),R?.branch&&o.jsxs("div",{className:"mt-3 flex items-center gap-1.5 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(cu,{className:"w-3.5 h-3.5"}),o.jsx("span",{className:"truncate font-mono text-xs",children:R.branch})]}),q?.lastExecutedAt&&o.jsxs("div",{className:"mt-3 flex items-center gap-1.5 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(tn,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:["Last run: ",Irt(q.lastExecutedAt)]})]}),o.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[T&&r&&o.jsx(Cn,{content:"Start agent",children:o.jsxs("button",{onClick:r,disabled:c,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-white bg-[var(--color-success)] rounded-md hover:bg-[var(--color-success-hover)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":`agent-start-${e.id}`,children:[o.jsx(en,{className:"w-3.5 h-3.5"}),c?"Starting...":"Start"]})}),O&&n&&o.jsx(Cn,{content:"Stop agent",children:o.jsxs("button",{onClick:n,disabled:u,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-[var(--color-danger-text)] bg-[var(--color-danger-muted)] rounded-md hover:bg-[var(--color-danger-muted-hover)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":`agent-stop-${e.id}`,children:[o.jsx(uu,{className:"w-3.5 h-3.5"}),u?"Stopping...":"Stop"]})}),E&&i&&o.jsx(Cn,{content:"Open in Workspace",children:o.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-terminal-${e.id}`,children:[o.jsx(na,{className:"w-3.5 h-3.5"}),"Open"]})}),o.jsx(Cn,{content:k>0?`${k} unread messages`:"View inbox",children:o.jsxs("button",{onClick:()=>p(!0),className:"relative p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-inbox-${e.id}`,children:[o.jsx(rs,{className:"w-4 h-4"}),k>0&&o.jsx("span",{className:"absolute -top-0.5 -right-0.5 min-w-[14px] h-[14px] flex items-center justify-center text-[10px] font-medium text-white bg-blue-500 rounded-full px-0.5","data-testid":`agent-inbox-badge-${e.id}`,children:k>99?"99+":k})]})}),a&&o.jsx(Cn,{content:"Restart agent",children:o.jsx("button",{onClick:a,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-restart-${e.id}`,children:o.jsx(jr,{className:"w-4 h-4"})})})]}),o.jsx(Drt,{isOpen:m,onClose:()=>p(!1),agentId:e.id,agentName:e.name}),o.jsx(Lrt,{isOpen:v,onClose:()=>b(!1),agentId:e.id,currentProvider:j?.provider??"claude"}),o.jsx(Ort,{isOpen:y,onClose:()=>S(!1),agentId:e.id,currentModel:j?.model,currentProvider:j?.provider??"claude"})]})}function Irt(e){const r=Date.now()-e,n=Math.floor(r/1e3),a=Math.floor(n/60),i=Math.floor(a/60),s=Math.floor(i/24);return s>0?`${s}d ago`:i>0?`${i}h ago`:a>0?`${a}m ago`:"just now"}const Dpe=[{value:0,label:"Sunday",short:"Sun"},{value:1,label:"Monday",short:"Mon"},{value:2,label:"Tuesday",short:"Tue"},{value:3,label:"Wednesday",short:"Wed"},{value:4,label:"Thursday",short:"Thu"},{value:5,label:"Friday",short:"Fri"},{value:6,label:"Saturday",short:"Sat"}],Rrt=[{value:"minutely",label:"Minutes",description:"Runs every N minutes"},{value:"hourly",label:"Hourly",description:"Runs every N hours"},{value:"daily",label:"Daily",description:"Runs every N days"},{value:"weekly",label:"Weekly",description:"Runs once every week"},{value:"monthly",label:"Monthly",description:"Runs once every month"},{value:"custom",label:"Custom",description:"Write a cron expression directly"}],ML={minutely:[1,2,3,5,10,15,20,30],hourly:[1,2,3,4,6,8,12],daily:[1,2,3,5,7,10,14,30]};function qX(e){const t=e.trim().split(/\s+/);if(t.length<5||t.length>6)return!1;const r=/^(\*|\d+(-\d+)?(,\d+(-\d+)?)*)(\/\d+)?$/;return t.every(n=>r.test(n)||n==="*")}function BS(e){const t=e.interval??1;switch(e.frequency){case"minutely":return t>1?`*/${t} * * * *`:"* * * * *";case"hourly":return t>1?`${e.minute} */${t} * * *`:`${e.minute} * * * *`;case"daily":return t>1?`${e.minute} ${e.hour} */${t} * *`:`${e.minute} ${e.hour} * * *`;case"weekly":return`${e.minute} ${e.hour} * * ${e.dayOfWeek}`;case"monthly":return`${e.minute} ${e.hour} ${e.dayOfMonth} * *`;case"custom":return""}}function WX(e){const t=e.trim().split(/\s+/);if(t.length!==5)return null;const[r,n,a,i,s]=t,l=m=>/^\d+$/.test(m),c=m=>m==="*",u=m=>/^\*\/\d+$/.test(m),d=m=>parseInt(m,10),f=m=>d(m.split("/")[1]);return u(r)&&c(n)&&c(a)&&c(i)&&c(s)?{frequency:"minutely",interval:f(r),minute:0,hour:0,dayOfWeek:1,dayOfMonth:1}:c(r)&&c(n)&&c(a)&&c(i)&&c(s)?{frequency:"minutely",interval:1,minute:0,hour:0,dayOfWeek:1,dayOfMonth:1}:l(r)&&u(n)&&c(a)&&c(i)&&c(s)?{frequency:"hourly",interval:f(n),minute:d(r),hour:0,dayOfWeek:1,dayOfMonth:1}:l(r)&&c(n)&&c(a)&&c(i)&&c(s)?{frequency:"hourly",interval:1,minute:d(r),hour:0,dayOfWeek:1,dayOfMonth:1}:l(r)&&l(n)&&u(a)&&c(i)&&c(s)?{frequency:"daily",interval:f(a),minute:d(r),hour:d(n),dayOfWeek:1,dayOfMonth:1}:l(r)&&l(n)&&c(a)&&c(i)&&c(s)?{frequency:"daily",interval:1,minute:d(r),hour:d(n),dayOfWeek:1,dayOfMonth:1}:l(r)&&l(n)&&c(a)&&c(i)&&l(s)?{frequency:"weekly",interval:1,minute:d(r),hour:d(n),dayOfWeek:d(s),dayOfMonth:1}:l(r)&&l(n)&&l(a)&&c(i)&&c(s)?{frequency:"monthly",interval:1,minute:d(r),hour:d(n),dayOfWeek:1,dayOfMonth:d(a)}:null}function Prt(e){const t=e.trim().split(/\s+/);if(t.length<5||t.length>6)return"Invalid cron expression";const[r,n,a,i,s]=t.length===6?t.slice(1):t,l=b=>b==="*",c=b=>/^\d+$/.test(b),u=b=>parseInt(b,10),d=(b,y)=>{const S=b>=12?"PM":"AM";return`${b===0?12:b>12?b-12:b}:${y.toString().padStart(2,"0")} ${S}`},f=b=>Dpe[b%7]?.label??`day ${b}`,m=b=>{const y=["th","st","nd","rd"],S=b%100;return b+(y[(S-20)%10]||y[S]||y[0])},p=b=>b.startsWith("*/"),v=b=>u(b.split("/")[1]);if(p(r)&&l(n)&&l(a)&&l(i)&&l(s)){const b=v(r);return`Every ${b} minute${b===1?"":"s"}`}if(l(r)&&l(n)&&l(a)&&l(i)&&l(s))return"Every minute";if(c(r)&&p(n)&&l(a)&&l(i)&&l(s)){const b=v(n),y=u(r),S=`Every ${b} hour${b===1?"":"s"}`;return y===0?S:`${S} at minute ${y}`}if(c(r)&&l(n)&&l(a)&&l(i)&&l(s)){const b=u(r);return b===0?"Every hour, on the hour":`Every hour at minute ${b}`}if(c(r)&&c(n)&&p(a)&&l(i)&&l(s)){const b=v(a);return`Every ${b} day${b===1?"":"s"} at ${d(u(n),u(r))}`}return c(r)&&c(n)&&l(a)&&l(i)&&l(s)?`Every day at ${d(u(n),u(r))}`:c(r)&&c(n)&&l(a)&&l(i)&&c(s)?`Every ${f(u(s))} at ${d(u(n),u(r))}`:c(r)&&c(n)&&c(a)&&l(i)&&l(s)?`${m(u(a))} of every month at ${d(u(n),u(r))}`:`Custom schedule: ${e}`}const TL={frequency:"hourly",interval:1,minute:0,hour:9,dayOfWeek:1,dayOfMonth:1};function zrt({value:e,onChange:t,testIdPrefix:r="cron-builder"}){const[n,a]=w.useState("builder"),[i,s]=w.useState(TL),[l,c]=w.useState(e),[u,d]=w.useState(null);w.useEffect(()=>{const k=WX(e);k?(s(k),a("builder")):e&&e!==BS(i)&&(c(e),e!=="0 * * * *"&&a("raw"))},[]);const f=w.useMemo(()=>BS(i),[i]),m=w.useMemo(()=>{const k=n==="raw"?l:f;return k?Prt(k):""},[n,l,f]),p=w.useCallback(k=>{s(j=>{const E={...j,...k},T=BS(E);return T&&t(T),E})},[t]),v=w.useCallback(k=>{c(k),qX(k)?(d(null),t(k)):k.trim()?d("Invalid cron expression. Expected format: * * * * * (minute hour day month weekday)"):d(null)},[t]),b=w.useCallback(()=>{if(n==="builder")c(f),d(null),a("raw");else{const k=WX(l);k?(s(k),a("builder")):(s(TL),t(BS(TL)),a("builder"))}},[n,f,l,t]),y=w.useMemo(()=>{const k=[];for(let j=0;j<60;j+=5)k.push(j);return k},[]),S=w.useMemo(()=>{const k=[];for(let j=0;j<24;j++)k.push(j);return k},[]),_=k=>{const j=k>=12?"PM":"AM";return`${k===0?12:k>12?k-12:k}:00 ${j}`},N=k=>`:${k.toString().padStart(2,"0")}`;return o.jsxs("div",{className:"space-y-2","data-testid":r,children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsx("button",{type:"button",onClick:b,className:"flex items-center gap-1.5 text-xs text-[var(--color-primary)] hover:text-[var(--color-primary-hover)] transition-colors","data-testid":`${r}-mode-toggle`,children:n==="builder"?o.jsxs(o.Fragment,{children:[o.jsx(Kp,{className:"w-3 h-3"}),"Use cron syntax"]}):o.jsxs(o.Fragment,{children:[o.jsx(r0,{className:"w-3 h-3"}),"Use schedule builder"]})})}),n==="builder"?o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"flex flex-wrap gap-1",children:Rrt.filter(k=>k.value!=="custom").map(k=>o.jsx("button",{type:"button",onClick:()=>{p({frequency:k.value,interval:1})},className:`
                  px-2.5 py-1 text-xs rounded-full border transition-all
                  ${i.frequency===k.value?"border-[var(--color-primary)] bg-[var(--color-primary-muted)] text-[var(--color-primary)] font-medium":"border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-[var(--color-border-hover)] hover:text-[var(--color-text)]"}
                `,"data-testid":`${r}-freq-${k.value}`,children:k.label},k.value))}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-[var(--color-text-secondary)]",children:[i.frequency==="minutely"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Every"}),o.jsx("select",{value:i.interval,onChange:k=>p({interval:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-interval`,children:ML.minutely.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsxs("span",{children:["minute",i.interval===1?"":"s"]})]}),i.frequency==="hourly"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Every"}),o.jsx("select",{value:i.interval,onChange:k=>p({interval:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-interval`,children:ML.hourly.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsxs("span",{children:["hour",i.interval===1?"":"s"," at minute"]}),o.jsx("select",{value:i.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]}),i.frequency==="daily"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Every"}),o.jsx("select",{value:i.interval,onChange:k=>p({interval:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-interval`,children:ML.daily.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsxs("span",{children:["day",i.interval===1?"":"s"," at"]}),o.jsx("select",{value:i.hour,onChange:k=>p({hour:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-hour`,children:S.map(k=>o.jsx("option",{value:k,children:_(k)},k))}),o.jsx("select",{value:i.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]}),i.frequency==="weekly"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"on"}),o.jsx("select",{value:i.dayOfWeek,onChange:k=>p({dayOfWeek:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-day-of-week`,children:Dpe.map(k=>o.jsx("option",{value:k.value,children:k.label},k.value))}),o.jsx("span",{children:"at"}),o.jsx("select",{value:i.hour,onChange:k=>p({hour:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-hour`,children:S.map(k=>o.jsx("option",{value:k,children:_(k)},k))}),o.jsx("select",{value:i.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]}),i.frequency==="monthly"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"on day"}),o.jsx("select",{value:i.dayOfMonth,onChange:k=>p({dayOfMonth:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-day-of-month`,children:Array.from({length:31},(k,j)=>j+1).map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsx("span",{children:"at"}),o.jsx("select",{value:i.hour,onChange:k=>p({hour:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-hour`,children:S.map(k=>o.jsx("option",{value:k,children:_(k)},k))}),o.jsx("select",{value:i.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-[var(--color-surface)] border border-[var(--color-border)] rounded text-xs",children:[o.jsx(tn,{className:"w-3 h-3 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsx("span",{className:"font-mono text-[var(--color-text-secondary)]",children:f}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:m})]})]}):o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("input",{type:"text",value:l,onChange:k=>v(k.target.value),placeholder:"0 * * * * (every hour)",className:`
              w-full px-2 py-1
              text-xs font-mono
              bg-[var(--color-bg)]
              border rounded
              focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
              ${u?"border-red-400 dark:border-red-600":"border-[var(--color-border)]"}
            `,"data-testid":`${r}-raw-input`}),u&&o.jsx("p",{className:"text-xs text-red-600 dark:text-red-400","data-testid":`${r}-raw-error`,children:u}),!u&&l.trim()&&qX(l)&&o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-[var(--color-surface)] border border-[var(--color-border)] rounded text-xs",children:[o.jsx(tn,{className:"w-3 h-3 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:m})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Format: minute (0-59) hour (0-23) day (1-31) month (1-12) weekday (0-6, Sun=0)"})]})]})}const KX={taskCompletion:!0,agentHealth:!0,mergeNotifications:!0,sound:!1,toastDuration:5e3},GX={worktreeDirectory:".stoneforge/.worktrees/",ephemeralRetention:"24h",defaultBranch:"main",autoMerge:!1},VX={healthCheckInterval:"5m",opsSchedule:"0 2 * * *",mergeStewardEnabled:!0,healthStewardEnabled:!0,opsStewardEnabled:!0},YX={defaultProvider:"claude",defaultModels:{}},QX="settings.theme",JX="settings.notifications",ZX="settings.workspace",XX="settings.stewardSchedules",eee="settings.agentDefaults";function T2(e,t){try{const r=localStorage.getItem(e);if(r)return{...t,...JSON.parse(r)}}catch{}return t}function A2(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function Brt(){const[e,t]=w.useState(()=>{if(typeof window>"u")return"system";const i=localStorage.getItem(QX);return i==="light"||i==="dark"||i==="system"?i:"system"}),r=w.useCallback(i=>{const s=document.documentElement,l=window.matchMedia("(prefers-color-scheme: dark)").matches;s.classList.remove("dark","theme-dark","theme-light"),(i==="system"?l?"dark":"light":i)==="dark"?s.classList.add("dark","theme-dark"):s.classList.add("theme-light")},[]);w.useEffect(()=>{r(e),localStorage.setItem(QX,e)},[e,r]),w.useEffect(()=>{if(e!=="system")return;const i=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>r("system");return i.addEventListener("change",s),()=>i.removeEventListener("change",s)},[e,r]);const n=w.useCallback(i=>{t(i)},[]),a=e==="system"?typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;return{theme:e,setTheme:n,resolvedTheme:a}}function $rt(){const[e,t]=w.useState(()=>T2(JX,KX));w.useEffect(()=>{A2(JX,e)},[e]);const r=w.useCallback(a=>{t(i=>({...i,...a}))},[]),n=w.useCallback(()=>{t(KX)},[]);return{settings:e,setSettings:r,resetToDefaults:n}}function Frt(){const[e,t]=w.useState(()=>T2(ZX,GX));w.useEffect(()=>{A2(ZX,e)},[e]);const r=w.useCallback(a=>{t(i=>({...i,...a}))},[]),n=w.useCallback(()=>{t(GX)},[]);return{settings:e,setSettings:r,resetToDefaults:n}}function Urt(){const[e,t]=w.useState(()=>T2(XX,VX));w.useEffect(()=>{A2(XX,e)},[e]);const r=w.useCallback(a=>{t(i=>({...i,...a}))},[]),n=w.useCallback(()=>{t(VX)},[]);return{settings:e,setSettings:r,resetToDefaults:n}}function Lpe(){const[e,t]=w.useState(()=>T2(eee,YX));w.useEffect(()=>{A2(eee,e)},[e]);const r=w.useCallback(i=>{t(s=>({...s,...i}))},[]),n=w.useCallback((i,s)=>{t(l=>({...l,defaultModels:{...l.defaultModels,[i]:s}}))},[]),a=w.useCallback(()=>{t(YX)},[]);return{settings:e,setSettings:r,setDefaultModel:n,resetToDefaults:a}}function Ope(){const e=Brt(),t=$rt(),r=Frt(),n=Urt(),a=Lpe(),i={theme:e.theme,notifications:t.settings,workspace:r.settings,stewardSchedules:n.settings,agentDefaults:a.settings},s=w.useCallback(()=>{e.setTheme("system"),t.resetToDefaults(),r.resetToDefaults(),n.resetToDefaults(),a.resetToDefaults()},[e,t,r,n,a]);return{settings:i,theme:e,notifications:t,workspace:r,stewardSchedules:n,agentDefaults:a,resetAllToDefaults:s}}function Hrt(){const e=[];for(const[t,r]of Object.entries(ix))e.push({key:nm(r.keys),label:r.description||t,description:r.path?`Navigate to ${r.path.split("?")[0]}`:"Quick action",actionId:t});return e.push({key:"Esc",label:"Close dialog",description:"Close any open dialog or panel"},{key:"",label:"Navigate",description:"Navigate through lists and options"},{key:"Enter",label:"Select",description:"Select the current item or confirm action"},{key:"J/K",label:"Next/Previous",description:"Navigate items in inbox (vim-style)"}),e}Hrt();const AL={director:{icon:Xr,color:"purple",description:"Strategic agent that creates and assigns tasks. One per workspace."},worker:{icon:na,color:"blue",description:"Execution agent that produces code and completes tasks."},steward:{icon:t0,color:"amber",description:"Support agent that performs automated maintenance tasks."}},DL={merge:{label:"Merge Steward",description:"Handles merging completed branches, running tests, and cleanup."},health:{label:"Health Steward",description:"Monitors agent health, detects stuck agents, helps unstick."},reminder:{label:"Reminder Steward",description:"Sends reminders and notifications to agents and humans."},ops:{label:"Ops Steward",description:"Runs scheduled maintenance tasks and garbage collection."},docs:{label:"Documentation Steward",description:"Reviews, updates, and maintains workspace documents."}},tee={ephemeral:{label:"Ephemeral",description:"Short-lived worker spawned per task, reports to Director."},persistent:{label:"Persistent",description:"Long-lived worker that handles multiple tasks, human-supervised."}};function qrt(e,t,r,n){if(e==="director")return"director";let a,i;e==="worker"?(a=t==="ephemeral"?"e-worker":"p-worker",i=a):(a=`${r.charAt(0)}-steward`,i=a);const s=new RegExp(`^${a}-(\\d+)$`);let l=0;for(const c of n){const u=c.name.match(s);if(u){const d=parseInt(u[1],10);d>l&&(l=d)}}return`${i}-${l+1}`}const ree={name:"",role:"steward",workerMode:"ephemeral",stewardFocus:"merge",triggers:[],tags:"",provider:"claude",model:""};function Wrt({isOpen:e,onClose:t,initialRole:r,initialStewardFocus:n,hasDirector:a=!1,onSuccess:i}){const{data:s}=d1(),l=w.useMemo(()=>s?.agents??[],[s?.agents]),{data:c}=wB(),u=w.useMemo(()=>c?.providers??[],[c?.providers]),d=u.length>1,{settings:f}=Lpe(),[m,p]=w.useState({...ree,role:r??"steward",stewardFocus:n??"merge",provider:f.defaultProvider||"claude",model:f.defaultModels[f.defaultProvider]??""}),{data:v,isLoading:b}=SB(m.provider),y=w.useMemo(()=>v?.models??[],[v?.models]),S=w.useMemo(()=>y.find(U=>U.isDefault),[y]),_=w.useMemo(()=>y.filter(U=>!U.isDefault),[y]),[N,k]=w.useState(!1),[j,E]=w.useState(null),[T,O]=w.useState(!1),R=w.useCallback(()=>qrt(m.role,m.workerMode,m.stewardFocus,l),[m.role,m.workerMode,m.stewardFocus,l]);w.useEffect(()=>{if(e&&!T){const U=R();p(V=>({...V,name:U}))}},[e,R,T]),w.useEffect(()=>{e||O(!1)},[e]),w.useEffect(()=>{e&&p(U=>({...U,provider:f.defaultProvider||U.provider,model:f.defaultModels[f.defaultProvider]??""}))},[e,f.defaultProvider,f.defaultModels]);const q=OQe();if(!e)return null;const $=()=>{p({...ree,role:r??"steward",stewardFocus:n??"merge",provider:f.defaultProvider||"claude",model:f.defaultModels[f.defaultProvider]??""}),E(null),O(!1),t()},L=U=>{const V=f.defaultModels[U]??"";p(K=>({...K,provider:U,model:V}))},A=async U=>{if(U.preventDefault(),E(null),!m.name.trim()){E("Name is required");return}const V={name:m.name.trim(),role:m.role,tags:m.tags.trim()?m.tags.split(",").map(K=>K.trim()).filter(Boolean):void 0,provider:m.provider!=="claude"?m.provider:void 0,model:m.model||void 0};m.role==="worker"?V.workerMode=m.workerMode:m.role==="steward"&&(V.stewardFocus=m.stewardFocus,m.triggers.length>0&&(V.triggers=m.triggers));try{const K=await q.mutateAsync(V);i?.({id:K.agent.id,name:K.agent.name}),$()}catch(K){E(K instanceof Error?K.message:"Failed to create agent")}},M=()=>{p(U=>({...U,triggers:[...U.triggers,{type:"cron",schedule:"0 * * * *"}]}))},z=()=>{p(U=>({...U,triggers:[...U.triggers,{type:"event",event:"task_completed"}]}))},I=(U,V)=>{p(K=>({...K,triggers:K.triggers.map((G,J)=>J===U?V:G)}))},B=U=>{p(V=>({...V,triggers:V.triggers.filter((K,G)=>G!==U)}))},F=AL[m.role];return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:$,"data-testid":"create-agent-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:o.jsxs("div",{className:`
            w-full max-w-lg
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
            my-8
          `,"data-testid":"create-agent-dialog",role:"dialog","aria-labelledby":"create-agent-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsxs("h2",{id:"create-agent-title",className:"text-lg font-semibold text-[var(--color-text)]",children:["Create ",m.role==="steward"?"Steward":m.role==="worker"?"Worker":"Agent"]}),o.jsx("button",{onClick:$,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"create-agent-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:A,className:"p-4 space-y-4",children:[j&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),j]}),!r&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Agent Type"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(AL).map(U=>{const V=AL[U],K=V.icon,G=m.role===U,J=U==="director"&&a;return o.jsxs("button",{type:"button",onClick:()=>!J&&p(ee=>({...ee,role:U})),disabled:J,className:`
                          flex flex-col items-center gap-2 p-3 rounded-lg border transition-all
                          ${J?"opacity-50 cursor-not-allowed border-[var(--color-border)] bg-[var(--color-surface)]":G?`border-${V.color}-500 bg-${V.color}-50 dark:bg-${V.color}-900/20`:"border-[var(--color-border)] hover:border-[var(--color-border-hover)]"}
                        `,title:J?"A Director already exists. Use the menu on the existing Director card to rename it.":void 0,"data-testid":`role-${U}`,children:[o.jsx(K,{className:`w-6 h-6 ${J?"text-[var(--color-text-tertiary)]":G?`text-${V.color}-600 dark:text-${V.color}-400`:"text-[var(--color-text-secondary)]"}`}),o.jsx("span",{className:`text-sm font-medium capitalize ${J?"text-[var(--color-text-tertiary)]":G?`text-${V.color}-700 dark:text-${V.color}-300`:"text-[var(--color-text)]"}`,children:U}),J&&o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"(exists)"})]},U)})}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:F.description})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-name",className:"text-sm font-medium text-[var(--color-text)]",children:"Name"}),o.jsx("input",{id:"agent-name",type:"text",value:m.name,onChange:U=>{O(!0),p(V=>({...V,name:U.target.value}))},placeholder:`e.g., ${m.role==="steward"?"Merge Bot":m.role==="worker"?"Alice":"Director"}`,className:`
                  w-full px-3 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,"data-testid":"agent-name"})]}),m.role==="worker"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Worker Mode"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(tee).map(U=>{const V=tee[U],K=m.workerMode===U;return o.jsxs("button",{type:"button",onClick:()=>p(G=>({...G,workerMode:U})),className:`
                          flex items-center gap-2 p-3 rounded-lg border text-left transition-all
                          ${K?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-[var(--color-border)] hover:border-[var(--color-border-hover)]"}
                        `,"data-testid":`worker-mode-${U}`,children:[U==="ephemeral"?o.jsx(eh,{className:`w-5 h-5 ${K?"text-blue-600 dark:text-blue-400":"text-[var(--color-text-secondary)]"}`}):o.jsx(na,{className:`w-5 h-5 ${K?"text-blue-600 dark:text-blue-400":"text-[var(--color-text-secondary)]"}`}),o.jsxs("div",{children:[o.jsx("div",{className:`text-sm font-medium ${K?"text-blue-700 dark:text-blue-300":"text-[var(--color-text)]"}`,children:V.label}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:V.description})]})]},U)})})]}),m.role==="steward"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"steward-focus",className:"text-sm font-medium text-[var(--color-text)]",children:"Focus Area"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{id:"steward-focus",value:m.stewardFocus,onChange:U=>p(V=>({...V,stewardFocus:U.target.value})),className:`
                      w-full px-3 py-2 pr-8
                      text-sm
                      bg-[var(--color-surface)]
                      border border-[var(--color-border)]
                      rounded-lg
                      appearance-none
                      focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                    `,"data-testid":"steward-focus",children:Object.keys(DL).map(U=>o.jsx("option",{value:U,children:DL[U].label},U))}),o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:DL[m.stewardFocus].description})]}),m.role==="steward"&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Triggers"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsxs("button",{type:"button",onClick:M,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"add-cron-trigger",children:[o.jsx(tn,{className:"w-3 h-3"}),"Cron"]}),o.jsxs("button",{type:"button",onClick:z,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"add-event-trigger",children:[o.jsx(eh,{className:"w-3 h-3"}),"Event"]})]})]}),m.triggers.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No triggers configured. Steward will only run manually."}):o.jsx("div",{className:"space-y-2",children:m.triggers.map((U,V)=>o.jsxs("div",{className:"flex items-start gap-2 p-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg","data-testid":`trigger-${V}`,children:[U.type==="cron"?o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(tn,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Cron Schedule"})]}),o.jsx(zrt,{value:U.schedule,onChange:K=>I(V,{...U,schedule:K}),testIdPrefix:`trigger-${V}-schedule`})]}):o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(eh,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Event"})]}),o.jsx("input",{type:"text",value:U.event,onChange:K=>I(V,{...U,event:K.target.value}),placeholder:"task_completed",className:`
                                w-full px-2 py-1
                                text-xs
                                bg-[var(--color-bg)]
                                border border-[var(--color-border)]
                                rounded
                                focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                              `,"data-testid":`trigger-${V}-event`}),o.jsx("input",{type:"text",value:U.condition??"",onChange:K=>I(V,{...U,condition:K.target.value||void 0}),placeholder:"Condition (optional)",className:`
                                w-full px-2 py-1
                                text-xs
                                bg-[var(--color-bg)]
                                border border-[var(--color-border)]
                                rounded
                                focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                              `,"data-testid":`trigger-${V}-condition`})]}),o.jsx("button",{type:"button",onClick:()=>B(V),className:"p-1 text-[var(--color-text-tertiary)] hover:text-red-500 transition-colors","aria-label":"Remove trigger","data-testid":`trigger-${V}-remove`,children:o.jsx(Sr,{className:"w-4 h-4"})})]},V))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("button",{type:"button",onClick:()=>k(!N),className:"flex items-center gap-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors","data-testid":"toggle-capabilities",children:[o.jsx(cr,{className:`w-4 h-4 transition-transform ${N?"rotate-180":""}`}),"Settings & Tags"]}),N&&o.jsxs("div",{className:"space-y-3 pl-6",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-tags",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Tags (comma-separated)"}),o.jsx("input",{id:"agent-tags",type:"text",value:m.tags,onChange:U=>p(V=>({...V,tags:U.target.value})),placeholder:"e.g., team-alpha, high-priority",className:`
                        w-full px-3 py-1.5
                        text-sm
                        bg-[var(--color-surface)]
                        border border-[var(--color-border)]
                        rounded-lg
                        placeholder:text-[var(--color-text-tertiary)]
                        focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                      `,"data-testid":"agent-tags"})]}),d&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-provider",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Provider"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{id:"agent-provider",value:m.provider,onChange:U=>L(U.target.value),className:`
                            w-full px-3 py-1.5 pr-8
                            text-sm
                            bg-[var(--color-surface)]
                            border border-[var(--color-border)]
                            rounded-lg
                            appearance-none
                            focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                          `,"data-testid":"agent-provider",children:u.map(U=>o.jsxs("option",{value:U.name,disabled:!U.available,children:[U.name,U.available?"":" (not installed)"]},U.name))}),o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-model",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Model"}),o.jsxs("div",{className:"relative",children:[b?o.jsxs("div",{className:"flex items-center gap-2 py-1.5 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),"Loading models..."]}):o.jsxs("select",{id:"agent-model",value:m.model,onChange:U=>p(V=>({...V,model:U.target.value})),disabled:!m.provider,className:`
                            w-full px-3 py-1.5 pr-8
                            text-sm
                            bg-[var(--color-surface)]
                            border border-[var(--color-border)]
                            rounded-lg
                            appearance-none
                            focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                            disabled:opacity-50 disabled:cursor-not-allowed
                          `,"data-testid":"agent-model",children:[o.jsx("option",{value:"",children:S?`Default (${S.displayName})`:"(Default)"}),_.map(U=>o.jsx("option",{value:U.id,children:U.providerName?`${U.displayName}    ${U.providerName}`:U.displayName},U.id))]}),!b&&o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:$,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"cancel-create-agent",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:q.isPending||!m.name.trim(),className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"submit-create-agent",children:q.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_r,{className:"w-4 h-4"}),"Create ",m.role==="steward"?"Steward":m.role==="worker"?"Worker":"Agent"]})})]})]})]})})]})}function Krt({isOpen:e,onClose:t,agentName:r,onConfirm:n,isDeleting:a}){return w.useEffect(()=>{if(!e)return;const i=s=>{s.key==="Escape"&&!a&&t()};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[e,a,t]),e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"delete-agent-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!a&&t()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-[var(--color-danger-muted)] flex items-center justify-center",children:o.jsx(Sr,{className:"w-5 h-5 text-[var(--color-danger)]"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Agent"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Are you sure you want to delete"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',r,'"']}),"? This action cannot be undone."]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:t,disabled:a,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"delete-agent-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:n,disabled:a,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 disabled:opacity-50","data-testid":"delete-agent-confirm-btn",children:a?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})})]})]})]}):null}function Grt({isOpen:e,onClose:t,agentId:r,currentName:n,onSuccess:a}){const[i,s]=w.useState(n),[l,c]=w.useState(null),u=RQe();if(w.useEffect(()=>{e&&(s(n),c(null))},[e,n]),!e)return null;const d=()=>{c(null),t()},f=async m=>{m.preventDefault(),c(null);const p=i.trim();if(!p){c("Name is required");return}if(p===n){d();return}try{await u.mutateAsync({agentId:r,name:p}),a?.(),d()}catch(v){c(v instanceof Error?v.message:"Failed to rename agent")}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:d,"data-testid":"rename-agent-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-sm
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"rename-agent-dialog",role:"dialog","aria-labelledby":"rename-agent-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"rename-agent-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Rename Agent"}),o.jsx("button",{onClick:d,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"rename-agent-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:f,className:"p-4 space-y-4",children:[l&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),l]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-new-name",className:"text-sm font-medium text-[var(--color-text)]",children:"New Name"}),o.jsx("input",{id:"agent-new-name",type:"text",value:i,onChange:m=>s(m.target.value),placeholder:"Enter new name",className:`
                  w-full px-3 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,"data-testid":"rename-agent-input"})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:d,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"rename-agent-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u.isPending||!i.trim(),className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"rename-agent-submit",children:u.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Renaming..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Uh,{className:"w-4 h-4"}),"Rename"]})})]})]})]})})]})}const nee={title:"",priority:3};function Vrt({isOpen:e,onClose:t,agent:r,onStart:n,onStartAndOpen:a,isStarting:i=!1}){const[s,l]=w.useState(""),[c,u]=w.useState(""),[d,f]=w.useState(!1),[m,p]=w.useState(nee),[v,b]=w.useState(null),[y,S]=w.useState(null),{data:_,isLoading:N}=b2({assignment:"unassigned"}),k=dme(),j=w.useMemo(()=>(_?.tasks??[]).filter(L=>!L.assignee&&L.status!=="closed"&&L.status!=="tombstone"),[_]);if(w.useEffect(()=>{e&&(l(""),u(""),f(!1),p(nee),b(null),S(null))},[e]),!e)return null;const E=()=>{b(null),t()},T=async($,L="start")=>{$.preventDefault(),b(null),S(L);let A=s;if(d){const M=m.title.trim();if(!M){b("Task title is required"),S(null);return}try{A=(await k.mutateAsync({title:M,priority:m.priority})).task.id}catch(z){b(z instanceof Error?z.message:"Failed to create task"),S(null);return}}if(!A){b("Please select or create a task"),S(null);return}try{await(L==="startAndOpen"&&a?a:n)(r.id,A,c.trim()||void 0),E()}catch(M){b(M instanceof Error?M.message:"Failed to start agent"),S(null)}},O=$=>{const L=$.target.value;L==="__new__"?(f(!0),l("")):(f(!1),l(L))},R=d?m.title.trim().length>0:s.length>0,q=i||k.isPending||y!==null;return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:E,"data-testid":"start-agent-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-md
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"start-agent-dialog",role:"dialog","aria-labelledby":"start-agent-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsxs("h2",{id:"start-agent-title",className:"text-lg font-semibold text-[var(--color-text)]",children:["Start Agent: ",r.name]}),o.jsx("button",{onClick:E,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"start-agent-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:T,className:"p-4 space-y-4",children:[v&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),v]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{htmlFor:"task-select",className:"text-sm font-medium text-[var(--color-text)]",children:["Task ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Select an unassigned task or create a new one for this agent to work on."}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{id:"task-select",value:d?"__new__":s,onChange:O,disabled:N,className:`
                    w-full px-3 py-2 pr-8
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    appearance-none
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                    disabled:opacity-50
                  `,"data-testid":"task-select",children:[o.jsx("option",{value:"",children:N?"Loading tasks...":"Select a task..."}),j.map($=>o.jsx("option",{value:$.id,children:$.title},$.id)),o.jsx("option",{value:"__new__",children:"+ Create new task"})]}),o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}),d&&o.jsxs("div",{className:"space-y-3 p-3 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-[var(--color-text)]",children:[o.jsx(_r,{className:"w-4 h-4"}),"New Task"]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{htmlFor:"new-task-title",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{id:"new-task-title",type:"text",value:m.title,onChange:$=>p(L=>({...L,title:$.target.value})),placeholder:"Enter task title",className:`
                      w-full px-3 py-2
                      text-sm
                      bg-[var(--color-bg)]
                      border border-[var(--color-border)]
                      rounded-lg
                      placeholder:text-[var(--color-text-tertiary)]
                      focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                    `,autoFocus:!0,"data-testid":"new-task-title"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"new-task-priority",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Priority"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{id:"new-task-priority",value:m.priority,onChange:$=>p(L=>({...L,priority:parseInt($.target.value,10)})),className:`
                        w-full px-3 py-2 pr-8
                        text-sm
                        bg-[var(--color-bg)]
                        border border-[var(--color-border)]
                        rounded-lg
                        appearance-none
                        focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                      `,"data-testid":"new-task-priority",children:[o.jsx("option",{value:1,children:"Critical (P1)"}),o.jsx("option",{value:2,children:"High (P2)"}),o.jsx("option",{value:3,children:"Medium (P3)"}),o.jsx("option",{value:4,children:"Low (P4)"}),o.jsx("option",{value:5,children:"Minimal (P5)"})]}),o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{htmlFor:"initial-message",className:"text-sm font-medium text-[var(--color-text)]",children:["Initial Message ",o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:"(optional)"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Additional context or instructions for the agent."}),o.jsx("textarea",{id:"initial-message",value:c,onChange:$=>u($.target.value),placeholder:"e.g., Focus on the API endpoints first...",rows:3,className:`
                  w-full px-3 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  resize-none
                `,"data-testid":"initial-message"})]}),s&&!d&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[o.jsx(A6,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0"}),o.jsx("span",{className:"text-blue-700 dark:text-blue-300 truncate",children:j.find($=>$.id===s)?.title??"Selected task"})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:E,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"start-agent-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:q||!R,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  border border-[var(--color-border)]
                  hover:bg-[var(--color-surface-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"start-agent-submit",children:q&&y==="start"?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),k.isPending?"Creating task...":"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-4 h-4"}),"Start"]})}),a&&o.jsx("button",{type:"button",onClick:$=>T($,"startAndOpen"),disabled:q||!R,className:`
                    flex items-center gap-2
                    px-4 py-2
                    text-sm font-medium
                    text-white
                    bg-green-600
                    hover:bg-green-500
                    disabled:opacity-50 disabled:cursor-not-allowed
                    rounded-lg
                    transition-colors
                  `,"data-testid":"start-agent-submit-and-open",children:q&&y==="startAndOpen"?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),k.isPending?"Creating task...":"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Sl,{className:"w-4 h-4"}),"Start & Open"]})})]})]})]})})]})}function ya(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=ya(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var Yrt={value:()=>{}};function D2(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Ik(r)}function Ik(e){this._=e}function Qrt(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",a=r.indexOf(".");if(a>=0&&(n=r.slice(a+1),r=r.slice(0,a)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Ik.prototype=D2.prototype={constructor:Ik,on:function(e,t){var r=this._,n=Qrt(e+"",r),a,i=-1,s=n.length;if(arguments.length<2){for(;++i<s;)if((a=(e=n[i]).type)&&(a=Jrt(r[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(a=(e=n[i]).type)r[a]=aee(r[a],e.name,t);else if(t==null)for(a in r)r[a]=aee(r[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Ik(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,i;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,a=i.length;n<a;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(t,r)}};function Jrt(e,t){for(var r=0,n=e.length,a;r<n;++r)if((a=e[r]).name===t)return a.value}function aee(e,t,r){for(var n=0,a=e.length;n<a;++n)if(e[n].name===t){e[n]=Yrt,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var UP="http://www.w3.org/1999/xhtml";const iee={svg:"http://www.w3.org/2000/svg",xhtml:UP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function L2(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),iee.hasOwnProperty(t)?{space:iee[t],local:e}:e}function Zrt(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===UP&&t.documentElement.namespaceURI===UP?t.createElement(e):t.createElementNS(r,e)}}function Xrt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ipe(e){var t=L2(e);return(t.local?Xrt:Zrt)(t)}function ent(){}function BB(e){return e==null?ent:function(){return this.querySelector(e)}}function tnt(e){typeof e!="function"&&(e=BB(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,l=n[a]=new Array(s),c,u,d=0;d<s;++d)(c=i[d])&&(u=e.call(c,c.__data__,d,i))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new zs(n,this._parents)}function rnt(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function nnt(){return[]}function Rpe(e){return e==null?nnt:function(){return this.querySelectorAll(e)}}function ant(e){return function(){return rnt(e.apply(this,arguments))}}function int(e){typeof e=="function"?e=ant(e):e=Rpe(e);for(var t=this._groups,r=t.length,n=[],a=[],i=0;i<r;++i)for(var s=t[i],l=s.length,c,u=0;u<l;++u)(c=s[u])&&(n.push(e.call(c,c.__data__,u,s)),a.push(c));return new zs(n,a)}function Ppe(e){return function(){return this.matches(e)}}function zpe(e){return function(t){return t.matches(e)}}var snt=Array.prototype.find;function ont(e){return function(){return snt.call(this.children,e)}}function lnt(){return this.firstElementChild}function cnt(e){return this.select(e==null?lnt:ont(typeof e=="function"?e:zpe(e)))}var unt=Array.prototype.filter;function dnt(){return Array.from(this.children)}function fnt(e){return function(){return unt.call(this.children,e)}}function hnt(e){return this.selectAll(e==null?dnt:fnt(typeof e=="function"?e:zpe(e)))}function mnt(e){typeof e!="function"&&(e=Ppe(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,l=n[a]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&l.push(c);return new zs(n,this._parents)}function Bpe(e){return new Array(e.length)}function pnt(){return new zs(this._enter||this._groups.map(Bpe),this._parents)}function vC(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}vC.prototype={constructor:vC,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function gnt(e){return function(){return e}}function vnt(e,t,r,n,a,i){for(var s=0,l,c=t.length,u=i.length;s<u;++s)(l=t[s])?(l.__data__=i[s],n[s]=l):r[s]=new vC(e,i[s]);for(;s<c;++s)(l=t[s])&&(a[s]=l)}function bnt(e,t,r,n,a,i,s){var l,c,u=new Map,d=t.length,f=i.length,m=new Array(d),p;for(l=0;l<d;++l)(c=t[l])&&(m[l]=p=s.call(c,c.__data__,l,t)+"",u.has(p)?a[l]=c:u.set(p,c));for(l=0;l<f;++l)p=s.call(e,i[l],l,i)+"",(c=u.get(p))?(n[l]=c,c.__data__=i[l],u.delete(p)):r[l]=new vC(e,i[l]);for(l=0;l<d;++l)(c=t[l])&&u.get(m[l])===c&&(a[l]=c)}function ynt(e){return e.__data__}function xnt(e,t){if(!arguments.length)return Array.from(this,ynt);var r=t?bnt:vnt,n=this._parents,a=this._groups;typeof e!="function"&&(e=gnt(e));for(var i=a.length,s=new Array(i),l=new Array(i),c=new Array(i),u=0;u<i;++u){var d=n[u],f=a[u],m=f.length,p=wnt(e.call(d,d&&d.__data__,u,n)),v=p.length,b=l[u]=new Array(v),y=s[u]=new Array(v),S=c[u]=new Array(m);r(d,f,b,y,S,p,t);for(var _=0,N=0,k,j;_<v;++_)if(k=b[_]){for(_>=N&&(N=_+1);!(j=y[N])&&++N<v;);k._next=j||null}}return s=new zs(s,n),s._enter=l,s._exit=c,s}function wnt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Snt(){return new zs(this._exit||this._groups.map(Bpe),this._parents)}function knt(e,t,r){var n=this.enter(),a=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),r==null?i.remove():r(i),n&&a?n.merge(a).order():a}function _nt(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,a=r.length,i=n.length,s=Math.min(a,i),l=new Array(a),c=0;c<s;++c)for(var u=r[c],d=n[c],f=u.length,m=l[c]=new Array(f),p,v=0;v<f;++v)(p=u[v]||d[v])&&(m[v]=p);for(;c<a;++c)l[c]=r[c];return new zs(l,this._parents)}function Nnt(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],a=n.length-1,i=n[a],s;--a>=0;)(s=n[a])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Cnt(e){e||(e=jnt);function t(f,m){return f&&m?e(f.__data__,m.__data__):!f-!m}for(var r=this._groups,n=r.length,a=new Array(n),i=0;i<n;++i){for(var s=r[i],l=s.length,c=a[i]=new Array(l),u,d=0;d<l;++d)(u=s[d])&&(c[d]=u);c.sort(t)}return new zs(a,this._parents).order()}function jnt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ent(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Mnt(){return Array.from(this)}function Tnt(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,i=n.length;a<i;++a){var s=n[a];if(s)return s}return null}function Ant(){let e=0;for(const t of this)++e;return e}function Dnt(){return!this.node()}function Lnt(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var a=t[r],i=0,s=a.length,l;i<s;++i)(l=a[i])&&e.call(l,l.__data__,i,a);return this}function Ont(e){return function(){this.removeAttribute(e)}}function Int(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Rnt(e,t){return function(){this.setAttribute(e,t)}}function Pnt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function znt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Bnt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function $nt(e,t){var r=L2(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?Int:Ont:typeof t=="function"?r.local?Bnt:znt:r.local?Pnt:Rnt)(r,t))}function $pe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Fnt(e){return function(){this.style.removeProperty(e)}}function Unt(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Hnt(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function qnt(e,t,r){return arguments.length>1?this.each((t==null?Fnt:typeof t=="function"?Hnt:Unt)(e,t,r??"")):Og(this.node(),e)}function Og(e,t){return e.style.getPropertyValue(t)||$pe(e).getComputedStyle(e,null).getPropertyValue(t)}function Wnt(e){return function(){delete this[e]}}function Knt(e,t){return function(){this[e]=t}}function Gnt(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Vnt(e,t){return arguments.length>1?this.each((t==null?Wnt:typeof t=="function"?Gnt:Knt)(e,t)):this.node()[e]}function Fpe(e){return e.trim().split(/^|\s+/)}function $B(e){return e.classList||new Upe(e)}function Upe(e){this._node=e,this._names=Fpe(e.getAttribute("class")||"")}Upe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Hpe(e,t){for(var r=$B(e),n=-1,a=t.length;++n<a;)r.add(t[n])}function qpe(e,t){for(var r=$B(e),n=-1,a=t.length;++n<a;)r.remove(t[n])}function Ynt(e){return function(){Hpe(this,e)}}function Qnt(e){return function(){qpe(this,e)}}function Jnt(e,t){return function(){(t.apply(this,arguments)?Hpe:qpe)(this,e)}}function Znt(e,t){var r=Fpe(e+"");if(arguments.length<2){for(var n=$B(this.node()),a=-1,i=r.length;++a<i;)if(!n.contains(r[a]))return!1;return!0}return this.each((typeof t=="function"?Jnt:t?Ynt:Qnt)(r,t))}function Xnt(){this.textContent=""}function eat(e){return function(){this.textContent=e}}function tat(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function rat(e){return arguments.length?this.each(e==null?Xnt:(typeof e=="function"?tat:eat)(e)):this.node().textContent}function nat(){this.innerHTML=""}function aat(e){return function(){this.innerHTML=e}}function iat(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function sat(e){return arguments.length?this.each(e==null?nat:(typeof e=="function"?iat:aat)(e)):this.node().innerHTML}function oat(){this.nextSibling&&this.parentNode.appendChild(this)}function lat(){return this.each(oat)}function cat(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uat(){return this.each(cat)}function dat(e){var t=typeof e=="function"?e:Ipe(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function fat(){return null}function hat(e,t){var r=typeof e=="function"?e:Ipe(e),n=t==null?fat:typeof t=="function"?t:BB(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function mat(){var e=this.parentNode;e&&e.removeChild(this)}function pat(){return this.each(mat)}function gat(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function vat(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bat(e){return this.select(e?vat:gat)}function yat(e){return arguments.length?this.property("__data__",e):this.node().__data__}function xat(e){return function(t){e.call(this,t,this.__data__)}}function wat(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function Sat(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,a=t.length,i;r<a;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++n]=i;++n?t.length=n:delete this.__on}}}function kat(e,t,r){return function(){var n=this.__on,a,i=xat(t);if(n){for(var s=0,l=n.length;s<l;++s)if((a=n[s]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=r),a.value=t;return}}this.addEventListener(e.type,i,r),a={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(a):this.__on=[a]}}function _at(e,t,r){var n=wat(e+""),a,i=n.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(a=0,d=l[c];a<i;++a)if((s=n[a]).type===d.type&&s.name===d.name)return d.value}return}for(l=t?kat:Sat,a=0;a<i;++a)this.each(l(n[a],t,r));return this}function Wpe(e,t,r){var n=$pe(e),a=n.CustomEvent;typeof a=="function"?a=new a(t,r):(a=n.document.createEvent("Event"),r?(a.initEvent(t,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Nat(e,t){return function(){return Wpe(this,e,t)}}function Cat(e,t){return function(){return Wpe(this,e,t.apply(this,arguments))}}function jat(e,t){return this.each((typeof t=="function"?Cat:Nat)(e,t))}function*Eat(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,i=n.length,s;a<i;++a)(s=n[a])&&(yield s)}var Kpe=[null];function zs(e,t){this._groups=e,this._parents=t}function S1(){return new zs([[document.documentElement]],Kpe)}function Mat(){return this}zs.prototype=S1.prototype={constructor:zs,select:tnt,selectAll:int,selectChild:cnt,selectChildren:hnt,filter:mnt,data:xnt,enter:pnt,exit:Snt,join:knt,merge:_nt,selection:Mat,order:Nnt,sort:Cnt,call:Ent,nodes:Mnt,node:Tnt,size:Ant,empty:Dnt,each:Lnt,attr:$nt,style:qnt,property:Vnt,classed:Znt,text:rat,html:sat,raise:lat,lower:uat,append:dat,insert:hat,remove:pat,clone:bat,datum:yat,on:_at,dispatch:jat,[Symbol.iterator]:Eat};function Ts(e){return typeof e=="string"?new zs([[document.querySelector(e)]],[document.documentElement]):new zs([[e]],Kpe)}function Tat(e){let t;for(;t=e.sourceEvent;)e=t;return e}function zo(e,t){if(e=Tat(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const Aat={passive:!1},hx={capture:!0,passive:!1};function LL(e){e.stopImmediatePropagation()}function Up(e){e.preventDefault(),e.stopImmediatePropagation()}function Gpe(e){var t=e.document.documentElement,r=Ts(e).on("dragstart.drag",Up,hx);"onselectstart"in t?r.on("selectstart.drag",Up,hx):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Vpe(e,t){var r=e.document.documentElement,n=Ts(e).on("dragstart.drag",null);t&&(n.on("click.drag",Up,hx),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const $S=e=>()=>e;function HP(e,{sourceEvent:t,subject:r,target:n,identifier:a,active:i,x:s,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}HP.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Dat(e){return!e.ctrlKey&&!e.button}function Lat(){return this.parentNode}function Oat(e,t){return t??{x:e.x,y:e.y}}function Iat(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ype(){var e=Dat,t=Lat,r=Oat,n=Iat,a={},i=D2("start","drag","end"),s=0,l,c,u,d,f=0;function m(k){k.on("mousedown.drag",p).filter(n).on("touchstart.drag",y).on("touchmove.drag",S,Aat).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(k,j){if(!(d||!e.call(this,k,j))){var E=N(this,t.call(this,k,j),k,j,"mouse");E&&(Ts(k.view).on("mousemove.drag",v,hx).on("mouseup.drag",b,hx),Gpe(k.view),LL(k),u=!1,l=k.clientX,c=k.clientY,E("start",k))}}function v(k){if(Up(k),!u){var j=k.clientX-l,E=k.clientY-c;u=j*j+E*E>f}a.mouse("drag",k)}function b(k){Ts(k.view).on("mousemove.drag mouseup.drag",null),Vpe(k.view,u),Up(k),a.mouse("end",k)}function y(k,j){if(e.call(this,k,j)){var E=k.changedTouches,T=t.call(this,k,j),O=E.length,R,q;for(R=0;R<O;++R)(q=N(this,T,k,j,E[R].identifier,E[R]))&&(LL(k),q("start",k,E[R]))}}function S(k){var j=k.changedTouches,E=j.length,T,O;for(T=0;T<E;++T)(O=a[j[T].identifier])&&(Up(k),O("drag",k,j[T]))}function _(k){var j=k.changedTouches,E=j.length,T,O;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),T=0;T<E;++T)(O=a[j[T].identifier])&&(LL(k),O("end",k,j[T]))}function N(k,j,E,T,O,R){var q=i.copy(),$=zo(R||E,j),L,A,M;if((M=r.call(k,new HP("beforestart",{sourceEvent:E,target:m,identifier:O,active:s,x:$[0],y:$[1],dx:0,dy:0,dispatch:q}),T))!=null)return L=M.x-$[0]||0,A=M.y-$[1]||0,function z(I,B,F){var U=$,V;switch(I){case"start":a[O]=z,V=s++;break;case"end":delete a[O],--s;case"drag":$=zo(F||B,j),V=s;break}q.call(I,k,new HP(I,{sourceEvent:B,subject:M,target:m,identifier:O,active:V,x:$[0]+L,y:$[1]+A,dx:$[0]-U[0],dy:$[1]-U[1],dispatch:q}),T)}}return m.filter=function(k){return arguments.length?(e=typeof k=="function"?k:$S(!!k),m):e},m.container=function(k){return arguments.length?(t=typeof k=="function"?k:$S(k),m):t},m.subject=function(k){return arguments.length?(r=typeof k=="function"?k:$S(k),m):r},m.touchable=function(k){return arguments.length?(n=typeof k=="function"?k:$S(!!k),m):n},m.on=function(){var k=i.on.apply(i,arguments);return k===i?m:k},m.clickDistance=function(k){return arguments.length?(f=(k=+k)*k,m):Math.sqrt(f)},m}var Ig=0,kb=0,Fv=0,Qpe=1e3,bC,_b,yC=0,Ih=0,O2=0,mx=typeof performance=="object"&&performance.now?performance:Date,Jpe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function FB(){return Ih||(Jpe(Rat),Ih=mx.now()+O2)}function Rat(){Ih=0}function xC(){this._call=this._time=this._next=null}xC.prototype=Zpe.prototype={constructor:xC,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?FB():+r)+(t==null?0:+t),!this._next&&_b!==this&&(_b?_b._next=this:bC=this,_b=this),this._call=e,this._time=r,qP()},stop:function(){this._call&&(this._call=null,this._time=1/0,qP())}};function Zpe(e,t,r){var n=new xC;return n.restart(e,t,r),n}function Pat(){FB(),++Ig;for(var e=bC,t;e;)(t=Ih-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ig}function see(){Ih=(yC=mx.now())+O2,Ig=kb=0;try{Pat()}finally{Ig=0,Bat(),Ih=0}}function zat(){var e=mx.now(),t=e-yC;t>Qpe&&(O2-=t,yC=e)}function Bat(){for(var e,t=bC,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:bC=r);_b=e,qP(n)}function qP(e){if(!Ig){kb&&(kb=clearTimeout(kb));var t=e-Ih;t>24?(e<1/0&&(kb=setTimeout(see,e-mx.now()-O2)),Fv&&(Fv=clearInterval(Fv))):(Fv||(yC=mx.now(),Fv=setInterval(zat,Qpe)),Ig=1,Jpe(see))}}function oee(e,t,r){var n=new xC;return t=t==null?0:+t,n.restart(a=>{n.stop(),e(a+t)},t,r),n}var $at=D2("start","end","cancel","interrupt"),Fat=[],Xpe=0,lee=1,WP=2,Rk=3,cee=4,KP=5,Pk=6;function I2(e,t,r,n,a,i){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;Uat(e,r,{name:t,index:n,group:a,on:$at,tween:Fat,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Xpe})}function UB(e,t){var r=il(e,t);if(r.state>Xpe)throw new Error("too late; already scheduled");return r}function ql(e,t){var r=il(e,t);if(r.state>Rk)throw new Error("too late; already running");return r}function il(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function Uat(e,t,r){var n=e.__transition,a;n[t]=r,r.timer=Zpe(i,0,r.time);function i(u){r.state=lee,r.timer.restart(s,r.delay,r.time),r.delay<=u&&s(u-r.delay)}function s(u){var d,f,m,p;if(r.state!==lee)return c();for(d in n)if(p=n[d],p.name===r.name){if(p.state===Rk)return oee(s);p.state===cee?(p.state=Pk,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete n[d]):+d<t&&(p.state=Pk,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete n[d])}if(oee(function(){r.state===Rk&&(r.state=cee,r.timer.restart(l,r.delay,r.time),l(u))}),r.state=WP,r.on.call("start",e,e.__data__,r.index,r.group),r.state===WP){for(r.state=Rk,a=new Array(m=r.tween.length),d=0,f=-1;d<m;++d)(p=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(a[++f]=p);a.length=f+1}}function l(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=KP,1),f=-1,m=a.length;++f<m;)a[f].call(e,d);r.state===KP&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Pk,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function zk(e,t){var r=e.__transition,n,a,i=!0,s;if(r){t=t==null?null:t+"";for(s in r){if((n=r[s]).name!==t){i=!1;continue}a=n.state>WP&&n.state<KP,n.state=Pk,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[s]}i&&delete e.__transition}}function Hat(e){return this.each(function(){zk(this,e)})}function qat(e,t){var r,n;return function(){var a=ql(this,e),i=a.tween;if(i!==r){n=r=i;for(var s=0,l=n.length;s<l;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}a.tween=n}}function Wat(e,t,r){var n,a;if(typeof r!="function")throw new Error;return function(){var i=ql(this,e),s=i.tween;if(s!==n){a=(n=s).slice();for(var l={name:t,value:r},c=0,u=a.length;c<u;++c)if(a[c].name===t){a[c]=l;break}c===u&&a.push(l)}i.tween=a}}function Kat(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=il(this.node(),r).tween,a=0,i=n.length,s;a<i;++a)if((s=n[a]).name===e)return s.value;return null}return this.each((t==null?qat:Wat)(r,e,t))}function HB(e,t,r){var n=e._id;return e.each(function(){var a=ql(this,n);(a.value||(a.value={}))[t]=r.apply(this,arguments)}),function(a){return il(a,n).value[t]}}function ege(e,t){var r;return(typeof t=="number"?Bo:t instanceof Sh?g_:(r=Sh(t))?(t=r,g_):toe)(e,t)}function Gat(e){return function(){this.removeAttribute(e)}}function Vat(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Yat(e,t,r){var n,a=r+"",i;return function(){var s=this.getAttribute(e);return s===a?null:s===n?i:i=t(n=s,r)}}function Qat(e,t,r){var n,a=r+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===a?null:s===n?i:i=t(n=s,r)}}function Jat(e,t,r){var n,a,i;return function(){var s,l=r(this),c;return l==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=l+"",s===c?null:s===n&&c===a?i:(a=c,i=t(n=s,l)))}}function Zat(e,t,r){var n,a,i;return function(){var s,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=l+"",s===c?null:s===n&&c===a?i:(a=c,i=t(n=s,l)))}}function Xat(e,t){var r=L2(e),n=r==="transform"?rMe:ege;return this.attrTween(e,typeof t=="function"?(r.local?Zat:Jat)(r,n,HB(this,"attr."+e,t)):t==null?(r.local?Vat:Gat)(r):(r.local?Qat:Yat)(r,n,t))}function eit(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function tit(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function rit(e,t){var r,n;function a(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&tit(e,i)),r}return a._value=t,a}function nit(e,t){var r,n;function a(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&eit(e,i)),r}return a._value=t,a}function ait(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=L2(e);return this.tween(r,(n.local?rit:nit)(n,t))}function iit(e,t){return function(){UB(this,e).delay=+t.apply(this,arguments)}}function sit(e,t){return t=+t,function(){UB(this,e).delay=t}}function oit(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?iit:sit)(t,e)):il(this.node(),t).delay}function lit(e,t){return function(){ql(this,e).duration=+t.apply(this,arguments)}}function cit(e,t){return t=+t,function(){ql(this,e).duration=t}}function uit(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?lit:cit)(t,e)):il(this.node(),t).duration}function dit(e,t){if(typeof t!="function")throw new Error;return function(){ql(this,e).ease=t}}function fit(e){var t=this._id;return arguments.length?this.each(dit(t,e)):il(this.node(),t).ease}function hit(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;ql(this,e).ease=r}}function mit(e){if(typeof e!="function")throw new Error;return this.each(hit(this._id,e))}function pit(e){typeof e!="function"&&(e=Ppe(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var i=t[a],s=i.length,l=n[a]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&l.push(c);return new lu(n,this._parents,this._name,this._id)}function git(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,a=r.length,i=Math.min(n,a),s=new Array(n),l=0;l<i;++l)for(var c=t[l],u=r[l],d=c.length,f=s[l]=new Array(d),m,p=0;p<d;++p)(m=c[p]||u[p])&&(f[p]=m);for(;l<n;++l)s[l]=t[l];return new lu(s,this._parents,this._name,this._id)}function vit(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function bit(e,t,r){var n,a,i=vit(t)?UB:ql;return function(){var s=i(this,e),l=s.on;l!==n&&(a=(n=l).copy()).on(t,r),s.on=a}}function yit(e,t){var r=this._id;return arguments.length<2?il(this.node(),r).on.on(e):this.each(bit(r,e,t))}function xit(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function wit(){return this.on("end.remove",xit(this._id))}function Sit(e){var t=this._name,r=this._id;typeof e!="function"&&(e=BB(e));for(var n=this._groups,a=n.length,i=new Array(a),s=0;s<a;++s)for(var l=n[s],c=l.length,u=i[s]=new Array(c),d,f,m=0;m<c;++m)(d=l[m])&&(f=e.call(d,d.__data__,m,l))&&("__data__"in d&&(f.__data__=d.__data__),u[m]=f,I2(u[m],t,r,m,u,il(d,r)));return new lu(i,this._parents,t,r)}function kit(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Rpe(e));for(var n=this._groups,a=n.length,i=[],s=[],l=0;l<a;++l)for(var c=n[l],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var m=e.call(d,d.__data__,f,c),p,v=il(d,r),b=0,y=m.length;b<y;++b)(p=m[b])&&I2(p,t,r,b,m,v);i.push(m),s.push(d)}return new lu(i,s,t,r)}var _it=S1.prototype.constructor;function Nit(){return new _it(this._groups,this._parents)}function Cit(e,t){var r,n,a;return function(){var i=Og(this,e),s=(this.style.removeProperty(e),Og(this,e));return i===s?null:i===r&&s===n?a:a=t(r=i,n=s)}}function tge(e){return function(){this.style.removeProperty(e)}}function jit(e,t,r){var n,a=r+"",i;return function(){var s=Og(this,e);return s===a?null:s===n?i:i=t(n=s,r)}}function Eit(e,t,r){var n,a,i;return function(){var s=Og(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Og(this,e))),s===c?null:s===n&&c===a?i:(a=c,i=t(n=s,l))}}function Mit(e,t){var r,n,a,i="style."+t,s="end."+i,l;return function(){var c=ql(this,e),u=c.on,d=c.value[i]==null?l||(l=tge(t)):void 0;(u!==r||a!==d)&&(n=(r=u).copy()).on(s,a=d),c.on=n}}function Tit(e,t,r){var n=(e+="")=="transform"?tMe:ege;return t==null?this.styleTween(e,Cit(e,n)).on("end.style."+e,tge(e)):typeof t=="function"?this.styleTween(e,Eit(e,n,HB(this,"style."+e,t))).each(Mit(this._id,e)):this.styleTween(e,jit(e,n,t),r).on("end.style."+e,null)}function Ait(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function Dit(e,t,r){var n,a;function i(){var s=t.apply(this,arguments);return s!==a&&(n=(a=s)&&Ait(e,s,r)),n}return i._value=t,i}function Lit(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Dit(e,t,r??""))}function Oit(e){return function(){this.textContent=e}}function Iit(e){return function(){var t=e(this);this.textContent=t??""}}function Rit(e){return this.tween("text",typeof e=="function"?Iit(HB(this,"text",e)):Oit(e==null?"":e+""))}function Pit(e){return function(t){this.textContent=e.call(this,t)}}function zit(e){var t,r;function n(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&Pit(a)),t}return n._value=e,n}function Bit(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,zit(e))}function $it(){for(var e=this._name,t=this._id,r=rge(),n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],l=s.length,c,u=0;u<l;++u)if(c=s[u]){var d=il(c,t);I2(c,e,r,u,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new lu(n,this._parents,e,r)}function Fit(){var e,t,r=this,n=r._id,a=r.size();return new Promise(function(i,s){var l={value:s},c={value:function(){--a===0&&i()}};r.each(function(){var u=ql(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),a===0&&i()})}var Uit=0;function lu(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function rge(){return++Uit}var yc=S1.prototype;lu.prototype={constructor:lu,select:Sit,selectAll:kit,selectChild:yc.selectChild,selectChildren:yc.selectChildren,filter:pit,merge:git,selection:Nit,transition:$it,call:yc.call,nodes:yc.nodes,node:yc.node,size:yc.size,empty:yc.empty,each:yc.each,on:yit,attr:Xat,attrTween:ait,style:Tit,styleTween:Lit,text:Rit,textTween:Bit,remove:wit,tween:Kat,delay:oit,duration:uit,ease:fit,easeVarying:mit,end:Fit,[Symbol.iterator]:yc[Symbol.iterator]};function Hit(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var qit={time:null,delay:0,duration:250,ease:Hit};function Wit(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function Kit(e){var t,r;e instanceof lu?(t=e._id,e=e._name):(t=rge(),(r=qit).time=FB(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,i=0;i<a;++i)for(var s=n[i],l=s.length,c,u=0;u<l;++u)(c=s[u])&&I2(c,e,t,u,s,r||Wit(c,t));return new lu(n,this._parents,e,t)}S1.prototype.interrupt=Hat;S1.prototype.transition=Kit;const FS=e=>()=>e;function Git(e,{sourceEvent:t,target:r,transform:n,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:a}})}function Wc(e,t,r){this.k=e,this.x=t,this.y=r}Wc.prototype={constructor:Wc,scale:function(e){return e===1?this:new Wc(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Wc(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var R2=new Wc(1,0,0);nge.prototype=Wc.prototype;function nge(e){for(;!e.__zoom;)if(!(e=e.parentNode))return R2;return e.__zoom}function OL(e){e.stopImmediatePropagation()}function Uv(e){e.preventDefault(),e.stopImmediatePropagation()}function Vit(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Yit(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function uee(){return this.__zoom||R2}function Qit(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Jit(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zit(e,t,r){var n=e.invertX(t[0][0])-r[0][0],a=e.invertX(t[1][0])-r[1][0],i=e.invertY(t[0][1])-r[0][1],s=e.invertY(t[1][1])-r[1][1];return e.translate(a>n?(n+a)/2:Math.min(0,n)||Math.max(0,a),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function age(){var e=Vit,t=Yit,r=Zit,n=Qit,a=Jit,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,c=pk,u=D2("start","zoom","end"),d,f,m,p=500,v=150,b=0,y=10;function S(M){M.property("__zoom",uee).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",q).filter(a).on("touchstart.zoom",$).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function(M,z,I,B){var F=M.selection?M.selection():M;F.property("__zoom",uee),M!==F?j(M,z,I,B):F.interrupt().each(function(){E(this,arguments).event(B).start().zoom(null,typeof z=="function"?z.apply(this,arguments):z).end()})},S.scaleBy=function(M,z,I,B){S.scaleTo(M,function(){var F=this.__zoom.k,U=typeof z=="function"?z.apply(this,arguments):z;return F*U},I,B)},S.scaleTo=function(M,z,I,B){S.transform(M,function(){var F=t.apply(this,arguments),U=this.__zoom,V=I==null?k(F):typeof I=="function"?I.apply(this,arguments):I,K=U.invert(V),G=typeof z=="function"?z.apply(this,arguments):z;return r(N(_(U,G),V,K),F,s)},I,B)},S.translateBy=function(M,z,I,B){S.transform(M,function(){return r(this.__zoom.translate(typeof z=="function"?z.apply(this,arguments):z,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),s)},null,B)},S.translateTo=function(M,z,I,B,F){S.transform(M,function(){var U=t.apply(this,arguments),V=this.__zoom,K=B==null?k(U):typeof B=="function"?B.apply(this,arguments):B;return r(R2.translate(K[0],K[1]).scale(V.k).translate(typeof z=="function"?-z.apply(this,arguments):-z,typeof I=="function"?-I.apply(this,arguments):-I),U,s)},B,F)};function _(M,z){return z=Math.max(i[0],Math.min(i[1],z)),z===M.k?M:new Wc(z,M.x,M.y)}function N(M,z,I){var B=z[0]-I[0]*M.k,F=z[1]-I[1]*M.k;return B===M.x&&F===M.y?M:new Wc(M.k,B,F)}function k(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function j(M,z,I,B){M.on("start.zoom",function(){E(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(B).end()}).tween("zoom",function(){var F=this,U=arguments,V=E(F,U).event(B),K=t.apply(F,U),G=I==null?k(K):typeof I=="function"?I.apply(F,U):I,J=Math.max(K[1][0]-K[0][0],K[1][1]-K[0][1]),ee=F.__zoom,Y=typeof z=="function"?z.apply(F,U):z,ie=c(ee.invert(G).concat(J/ee.k),Y.invert(G).concat(J/Y.k));return function(fe){if(fe===1)fe=Y;else{var me=ie(fe),te=J/me[2];fe=new Wc(te,G[0]-me[0]*te,G[1]-me[1]*te)}V.zoom(null,fe)}})}function E(M,z,I){return!I&&M.__zooming||new T(M,z)}function T(M,z){this.that=M,this.args=z,this.active=0,this.sourceEvent=null,this.extent=t.apply(M,z),this.taps=0}T.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,z){return this.mouse&&M!=="mouse"&&(this.mouse[1]=z.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=z.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=z.invert(this.touch1[0])),this.that.__zoom=z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var z=Ts(this.that).datum();u.call(M,this.that,new Git(M,{sourceEvent:this.sourceEvent,target:S,transform:this.that.__zoom,dispatch:u}),z)}};function O(M,...z){if(!e.apply(this,arguments))return;var I=E(this,z).event(M),B=this.__zoom,F=Math.max(i[0],Math.min(i[1],B.k*Math.pow(2,n.apply(this,arguments)))),U=zo(M);if(I.wheel)(I.mouse[0][0]!==U[0]||I.mouse[0][1]!==U[1])&&(I.mouse[1]=B.invert(I.mouse[0]=U)),clearTimeout(I.wheel);else{if(B.k===F)return;I.mouse=[U,B.invert(U)],zk(this),I.start()}Uv(M),I.wheel=setTimeout(V,v),I.zoom("mouse",r(N(_(B,F),I.mouse[0],I.mouse[1]),I.extent,s));function V(){I.wheel=null,I.end()}}function R(M,...z){if(m||!e.apply(this,arguments))return;var I=M.currentTarget,B=E(this,z,!0).event(M),F=Ts(M.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",J,!0),U=zo(M,I),V=M.clientX,K=M.clientY;Gpe(M.view),OL(M),B.mouse=[U,this.__zoom.invert(U)],zk(this),B.start();function G(ee){if(Uv(ee),!B.moved){var Y=ee.clientX-V,ie=ee.clientY-K;B.moved=Y*Y+ie*ie>b}B.event(ee).zoom("mouse",r(N(B.that.__zoom,B.mouse[0]=zo(ee,I),B.mouse[1]),B.extent,s))}function J(ee){F.on("mousemove.zoom mouseup.zoom",null),Vpe(ee.view,B.moved),Uv(ee),B.event(ee).end()}}function q(M,...z){if(e.apply(this,arguments)){var I=this.__zoom,B=zo(M.changedTouches?M.changedTouches[0]:M,this),F=I.invert(B),U=I.k*(M.shiftKey?.5:2),V=r(N(_(I,U),B,F),t.apply(this,z),s);Uv(M),l>0?Ts(this).transition().duration(l).call(j,V,B,M):Ts(this).call(S.transform,V,B,M)}}function $(M,...z){if(e.apply(this,arguments)){var I=M.touches,B=I.length,F=E(this,z,M.changedTouches.length===B).event(M),U,V,K,G;for(OL(M),V=0;V<B;++V)K=I[V],G=zo(K,this),G=[G,this.__zoom.invert(G),K.identifier],F.touch0?!F.touch1&&F.touch0[2]!==G[2]&&(F.touch1=G,F.taps=0):(F.touch0=G,U=!0,F.taps=1+!!d);d&&(d=clearTimeout(d)),U&&(F.taps<2&&(f=G[0],d=setTimeout(function(){d=null},p)),zk(this),F.start())}}function L(M,...z){if(this.__zooming){var I=E(this,z).event(M),B=M.changedTouches,F=B.length,U,V,K,G;for(Uv(M),U=0;U<F;++U)V=B[U],K=zo(V,this),I.touch0&&I.touch0[2]===V.identifier?I.touch0[0]=K:I.touch1&&I.touch1[2]===V.identifier&&(I.touch1[0]=K);if(V=I.that.__zoom,I.touch1){var J=I.touch0[0],ee=I.touch0[1],Y=I.touch1[0],ie=I.touch1[1],fe=(fe=Y[0]-J[0])*fe+(fe=Y[1]-J[1])*fe,me=(me=ie[0]-ee[0])*me+(me=ie[1]-ee[1])*me;V=_(V,Math.sqrt(fe/me)),K=[(J[0]+Y[0])/2,(J[1]+Y[1])/2],G=[(ee[0]+ie[0])/2,(ee[1]+ie[1])/2]}else if(I.touch0)K=I.touch0[0],G=I.touch0[1];else return;I.zoom("touch",r(N(V,K,G),I.extent,s))}}function A(M,...z){if(this.__zooming){var I=E(this,z).event(M),B=M.changedTouches,F=B.length,U,V;for(OL(M),m&&clearTimeout(m),m=setTimeout(function(){m=null},p),U=0;U<F;++U)V=B[U],I.touch0&&I.touch0[2]===V.identifier?delete I.touch0:I.touch1&&I.touch1[2]===V.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(V=zo(V,this),Math.hypot(f[0]-V[0],f[1]-V[1])<y)){var K=Ts(this).on("dblclick.zoom");K&&K.apply(this,arguments)}}}return S.wheelDelta=function(M){return arguments.length?(n=typeof M=="function"?M:FS(+M),S):n},S.filter=function(M){return arguments.length?(e=typeof M=="function"?M:FS(!!M),S):e},S.touchable=function(M){return arguments.length?(a=typeof M=="function"?M:FS(!!M),S):a},S.extent=function(M){return arguments.length?(t=typeof M=="function"?M:FS([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),S):t},S.scaleExtent=function(M){return arguments.length?(i[0]=+M[0],i[1]=+M[1],S):[i[0],i[1]]},S.translateExtent=function(M){return arguments.length?(s[0][0]=+M[0][0],s[1][0]=+M[1][0],s[0][1]=+M[0][1],s[1][1]=+M[1][1],S):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},S.constrain=function(M){return arguments.length?(r=M,S):r},S.duration=function(M){return arguments.length?(l=+M,S):l},S.interpolate=function(M){return arguments.length?(c=M,S):c},S.on=function(){var M=u.on.apply(u,arguments);return M===u?S:M},S.clickDistance=function(M){return arguments.length?(b=(M=+M)*M,S):Math.sqrt(b)},S.tapDistance=function(M){return arguments.length?(y=+M,S):y},S}const $l={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:n})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:n}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},px=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ige=["Enter"," ","Escape"],sge={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Rg;(function(e){e.Strict="strict",e.Loose="loose"})(Rg||(Rg={}));var fh;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(fh||(fh={}));var gx;(function(e){e.Partial="partial",e.Full="full"})(gx||(gx={}));const oge={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var hd;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(hd||(hd={}));var wC;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(wC||(wC={}));var It;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(It||(It={}));const dee={[It.Left]:It.Right,[It.Right]:It.Left,[It.Top]:It.Bottom,[It.Bottom]:It.Top};function lge(e){return e===null?null:e?"valid":"invalid"}const cge=e=>"id"in e&&"source"in e&&"target"in e,Xit=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),qB=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),k1=(e,t=[0,0])=>{const{width:r,height:n}=yu(e),a=e.origin??t,i=r*a[0],s=n*a[1];return{x:e.position.x-i,y:e.position.y-s}},est=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,a)=>{const i=typeof a=="string";let s=!t.nodeLookup&&!i?a:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(a):qB(a)?a:t.nodeLookup.get(a.id));const l=s?SC(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return P2(n,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return z2(r)},_1=(e,t={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return e.forEach(a=>{(t.filter===void 0||t.filter(a))&&(r=P2(r,SC(a)),n=!0)}),n?z2(r):{x:0,y:0,width:0,height:0}},WB=(e,t,[r,n,a]=[0,0,1],i=!1,s=!1)=>{const l={...C1(t,[r,n,a]),width:t.width/a,height:t.height/a},c=[];for(const u of e.values()){const{measured:d,selectable:f=!0,hidden:m=!1}=u;if(s&&!f||m)continue;const p=d.width??u.width??u.initialWidth??null,v=d.height??u.height??u.initialHeight??null,b=vx(l,zg(u)),y=(p??0)*(v??0),S=i&&b>0;(!u.internals.handleBounds||S||b>=y||u.dragging)&&c.push(u)}return c},tst=(e,t)=>{const r=new Set;return e.forEach(n=>{r.add(n.id)}),t.filter(n=>r.has(n.source)||r.has(n.target))};function rst(e,t){const r=new Map,n=t?.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t?.includeHiddenNodes||!a.hidden)&&(!n||n.has(a.id))&&r.set(a.id,a)}),r}async function nst({nodes:e,width:t,height:r,panZoom:n,minZoom:a,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const l=rst(e,s),c=_1(l),u=KB(c,t,r,s?.minZoom??a,s?.maxZoom??i,s?.padding??.1);return await n.setViewport(u,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function uge({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:n=[0,0],nodeExtent:a,onError:i}){const s=r.get(e),l=s.parentId?r.get(s.parentId):void 0,{x:c,y:u}=l?l.internals.positionAbsolute:{x:0,y:0},d=s.origin??n;let f=s.extent||a;if(s.extent==="parent"&&!s.expandParent)if(!l)i?.("005",$l.error005());else{const p=l.measured.width,v=l.measured.height;p&&v&&(f=[[c,u],[c+p,u+v]])}else l&&Bg(s.extent)&&(f=[[s.extent[0][0]+c,s.extent[0][1]+u],[s.extent[1][0]+c,s.extent[1][1]+u]]);const m=Bg(f)?Rh(t,f,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",$l.error015()),{position:{x:m.x-c+(s.measured.width??0)*d[0],y:m.y-u+(s.measured.height??0)*d[1]},positionAbsolute:m}}async function ast({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:n,onBeforeDelete:a}){const i=new Set(e.map(m=>m.id)),s=[];for(const m of r){if(m.deletable===!1)continue;const p=i.has(m.id),v=!p&&m.parentId&&s.find(b=>b.id===m.parentId);(p||v)&&s.push(m)}const l=new Set(t.map(m=>m.id)),c=n.filter(m=>m.deletable!==!1),d=tst(s,c);for(const m of c)l.has(m.id)&&!d.find(v=>v.id===m.id)&&d.push(m);if(!a)return{edges:d,nodes:s};const f=await a({nodes:s,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:s}:{edges:[],nodes:[]}:f}const Pg=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Rh=(e={x:0,y:0},t,r)=>({x:Pg(e.x,t[0][0],t[1][0]-(r?.width??0)),y:Pg(e.y,t[0][1],t[1][1]-(r?.height??0))});function dge(e,t,r){const{width:n,height:a}=yu(r),{x:i,y:s}=r.internals.positionAbsolute;return Rh(e,[[i,s],[i+n,s+a]],t)}const fee=(e,t,r)=>e<t?Pg(Math.abs(e-t),1,t)/t:e>r?-Pg(Math.abs(e-r),1,t)/t:0,fge=(e,t,r=15,n=40)=>{const a=fee(e.x,n,t.width-n)*r,i=fee(e.y,n,t.height-n)*r;return[a,i]},P2=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),GP=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),z2=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),zg=(e,t=[0,0])=>{const{x:r,y:n}=qB(e)?e.internals.positionAbsolute:k1(e,t);return{x:r,y:n,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},SC=(e,t=[0,0])=>{const{x:r,y:n}=qB(e)?e.internals.positionAbsolute:k1(e,t);return{x:r,y:n,x2:r+(e.measured?.width??e.width??e.initialWidth??0),y2:n+(e.measured?.height??e.height??e.initialHeight??0)}},hge=(e,t)=>z2(P2(GP(e),GP(t))),vx=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},hee=e=>Go(e.width)&&Go(e.height)&&Go(e.x)&&Go(e.y),Go=e=>!isNaN(e)&&isFinite(e),ist=(e,t)=>{},N1=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),C1=({x:e,y:t},[r,n,a],i=!1,s=[1,1])=>{const l={x:(e-r)/a,y:(t-n)/a};return i?N1(l,s):l},kC=({x:e,y:t},[r,n,a])=>({x:e*a+r,y:t*a+n});function sp(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function sst(e,t,r){if(typeof e=="string"||typeof e=="number"){const n=sp(e,r),a=sp(e,t);return{top:n,right:a,bottom:n,left:a,x:a*2,y:n*2}}if(typeof e=="object"){const n=sp(e.top??e.y??0,r),a=sp(e.bottom??e.y??0,r),i=sp(e.left??e.x??0,t),s=sp(e.right??e.x??0,t);return{top:n,right:s,bottom:a,left:i,x:i+s,y:n+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function ost(e,t,r,n,a,i){const{x:s,y:l}=kC(e,[t,r,n]),{x:c,y:u}=kC({x:e.x+e.width,y:e.y+e.height},[t,r,n]),d=a-c,f=i-u;return{left:Math.floor(s),top:Math.floor(l),right:Math.floor(d),bottom:Math.floor(f)}}const KB=(e,t,r,n,a,i)=>{const s=sst(i,t,r),l=(t-s.x)/e.width,c=(r-s.y)/e.height,u=Math.min(l,c),d=Pg(u,n,a),f=e.x+e.width/2,m=e.y+e.height/2,p=t/2-f*d,v=r/2-m*d,b=ost(e,p,v,d,t,r),y={left:Math.min(b.left-s.left,0),top:Math.min(b.top-s.top,0),right:Math.min(b.right-s.right,0),bottom:Math.min(b.bottom-s.bottom,0)};return{x:p-y.left+y.right,y:v-y.top+y.bottom,zoom:d}},bx=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Bg(e){return e!=null&&e!=="parent"}function yu(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function mge(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function pge(e,t={width:0,height:0},r,n,a){const i={...e},s=n.get(r);if(s){const l=s.origin||a;i.x+=s.internals.positionAbsolute.x-(t.width??0)*l[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*l[1]}return i}function mee(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function lst(){let e,t;return{promise:new Promise((n,a)=>{e=n,t=a}),resolve:e,reject:t}}function cst(e){return{...sge,...e||{}}}function Xb(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:n,containerBounds:a}){const{x:i,y:s}=Vo(e),l=C1({x:i-(a?.left??0),y:s-(a?.top??0)},n),{x:c,y:u}=r?N1(l,t):l;return{xSnapped:c,ySnapped:u,...l}}const GB=e=>({width:e.offsetWidth,height:e.offsetHeight}),gge=e=>e?.getRootNode?.()||window?.document,ust=["INPUT","SELECT","TEXTAREA"];function vge(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:ust.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const bge=e=>"clientX"in e,Vo=(e,t)=>{const r=bge(e),n=r?e.clientX:e.touches?.[0].clientX,a=r?e.clientY:e.touches?.[0].clientY;return{x:n-(t?.left??0),y:a-(t?.top??0)}},pee=(e,t,r,n,a)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const l=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:a,position:s.getAttribute("data-handlepos"),x:(l.left-r.left)/n,y:(l.top-r.top)/n,...GB(s)}})};function yge({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:a,sourceControlY:i,targetControlX:s,targetControlY:l}){const c=e*.125+a*.375+s*.375+r*.125,u=t*.125+i*.375+l*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}function US(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function gee({pos:e,x1:t,y1:r,x2:n,y2:a,c:i}){switch(e){case It.Left:return[t-US(t-n,i),r];case It.Right:return[t+US(n-t,i),r];case It.Top:return[t,r-US(r-a,i)];case It.Bottom:return[t,r+US(a-r,i)]}}function xge({sourceX:e,sourceY:t,sourcePosition:r=It.Bottom,targetX:n,targetY:a,targetPosition:i=It.Top,curvature:s=.25}){const[l,c]=gee({pos:r,x1:e,y1:t,x2:n,y2:a,c:s}),[u,d]=gee({pos:i,x1:n,y1:a,x2:e,y2:t,c:s}),[f,m,p,v]=yge({sourceX:e,sourceY:t,targetX:n,targetY:a,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${l},${c} ${u},${d} ${n},${a}`,f,m,p,v]}function wge({sourceX:e,sourceY:t,targetX:r,targetY:n}){const a=Math.abs(r-e)/2,i=r<e?r+a:r-a,s=Math.abs(n-t)/2,l=n<t?n+s:n-s;return[i,l,a,s]}function dst({sourceNode:e,targetNode:t,selected:r=!1,zIndex:n=0,elevateOnSelect:a=!1,zIndexMode:i="basic"}){if(i==="manual")return n;const s=a&&r?n+1e3:n,l=Math.max(e.parentId||a&&e.selected?e.internals.z:0,t.parentId||a&&t.selected?t.internals.z:0);return s+l}function fst({sourceNode:e,targetNode:t,width:r,height:n,transform:a}){const i=P2(SC(e),SC(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-a[0]/a[2],y:-a[1]/a[2],width:r/a[2],height:n/a[2]};return vx(s,z2(i))>0}const hst=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`xy-edge__${e}${t||""}-${r}${n||""}`,mst=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),pst=(e,t,r={})=>{if(!e.source||!e.target)return t;const n=r.getEdgeId||hst;let a;return cge(e)?a={...e}:a={...e,id:n(e)},mst(a,t)?t:(a.sourceHandle===null&&delete a.sourceHandle,a.targetHandle===null&&delete a.targetHandle,t.concat(a))};function Sge({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[a,i,s,l]=wge({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,a,i,s,l]}const vee={[It.Left]:{x:-1,y:0},[It.Right]:{x:1,y:0},[It.Top]:{x:0,y:-1},[It.Bottom]:{x:0,y:1}},gst=({source:e,sourcePosition:t=It.Bottom,target:r})=>t===It.Left||t===It.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},bee=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function vst({source:e,sourcePosition:t=It.Bottom,target:r,targetPosition:n=It.Top,center:a,offset:i,stepPosition:s}){const l=vee[t],c=vee[n],u={x:e.x+l.x*i,y:e.y+l.y*i},d={x:r.x+c.x*i,y:r.y+c.y*i},f=gst({source:u,sourcePosition:t,target:d}),m=f.x!==0?"x":"y",p=f[m];let v=[],b,y;const S={x:0,y:0},_={x:0,y:0},[,,N,k]=wge({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(l[m]*c[m]===-1){m==="x"?(b=a.x??u.x+(d.x-u.x)*s,y=a.y??(u.y+d.y)/2):(b=a.x??(u.x+d.x)/2,y=a.y??u.y+(d.y-u.y)*s);const E=[{x:b,y:u.y},{x:b,y:d.y}],T=[{x:u.x,y},{x:d.x,y}];l[m]===p?v=m==="x"?E:T:v=m==="x"?T:E}else{const E=[{x:u.x,y:d.y}],T=[{x:d.x,y:u.y}];if(m==="x"?v=l.x===p?T:E:v=l.y===p?E:T,t===n){const L=Math.abs(e[m]-r[m]);if(L<=i){const A=Math.min(i-1,i-L);l[m]===p?S[m]=(u[m]>e[m]?-1:1)*A:_[m]=(d[m]>r[m]?-1:1)*A}}if(t!==n){const L=m==="x"?"y":"x",A=l[m]===c[L],M=u[L]>d[L],z=u[L]<d[L];(l[m]===1&&(!A&&M||A&&z)||l[m]!==1&&(!A&&z||A&&M))&&(v=m==="x"?E:T)}const O={x:u.x+S.x,y:u.y+S.y},R={x:d.x+_.x,y:d.y+_.y},q=Math.max(Math.abs(O.x-v[0].x),Math.abs(R.x-v[0].x)),$=Math.max(Math.abs(O.y-v[0].y),Math.abs(R.y-v[0].y));q>=$?(b=(O.x+R.x)/2,y=v[0].y):(b=v[0].x,y=(O.y+R.y)/2)}return[[e,{x:u.x+S.x,y:u.y+S.y},...v,{x:d.x+_.x,y:d.y+_.y},r],b,y,N,k]}function bst(e,t,r,n){const a=Math.min(bee(e,t)/2,bee(t,r)/2,n),{x:i,y:s}=t;if(e.x===i&&i===r.x||e.y===s&&s===r.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${i+a*u},${s}Q ${i},${s} ${i},${s+a*d}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${i},${s+a*c}Q ${i},${s} ${i+a*l},${s}`}function VP({sourceX:e,sourceY:t,sourcePosition:r=It.Bottom,targetX:n,targetY:a,targetPosition:i=It.Top,borderRadius:s=5,centerX:l,centerY:c,offset:u=20,stepPosition:d=.5}){const[f,m,p,v,b]=vst({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:a},targetPosition:i,center:{x:l,y:c},offset:u,stepPosition:d});return[f.reduce((S,_,N)=>{let k="";return N>0&&N<f.length-1?k=bst(f[N-1],_,f[N+1],s):k=`${N===0?"M":"L"}${_.x} ${_.y}`,S+=k,S},""),m,p,v,b]}function yee(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function yst(e){const{sourceNode:t,targetNode:r}=e;if(!yee(t)||!yee(r))return null;const n=t.internals.handleBounds||xee(t.handles),a=r.internals.handleBounds||xee(r.handles),i=wee(n?.source??[],e.sourceHandle),s=wee(e.connectionMode===Rg.Strict?a?.target??[]:(a?.target??[]).concat(a?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",$l.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const l=i?.position||It.Bottom,c=s?.position||It.Top,u=Ph(t,i,l),d=Ph(r,s,c);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y,sourcePosition:l,targetPosition:c}}function xee(e){if(!e)return null;const t=[],r=[];for(const n of e)n.width=n.width??1,n.height=n.height??1,n.type==="source"?t.push(n):n.type==="target"&&r.push(n);return{source:t,target:r}}function Ph(e,t,r=It.Left,n=!1){const a=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:l}=t??yu(e);if(n)return{x:a+s/2,y:i+l/2};switch(t?.position??r){case It.Top:return{x:a+s/2,y:i};case It.Right:return{x:a+s,y:i+l/2};case It.Bottom:return{x:a+s/2,y:i+l};case It.Left:return{x:a,y:i+l/2}}}function wee(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function YP(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function xst(e,{id:t,defaultColor:r,defaultMarkerStart:n,defaultMarkerEnd:a}){const i=new Set;return e.reduce((s,l)=>([l.markerStart||n,l.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const u=YP(c,t);i.has(u)||(s.push({id:u,color:c.color||r,...c}),i.add(u))}}),s),[]).sort((s,l)=>s.id.localeCompare(l.id))}const kge=1e3,wst=10,VB={nodeOrigin:[0,0],nodeExtent:px,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},Sst={...VB,checkEquality:!0};function YB(e,t){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}function kst(e,t,r){const n=YB(VB,r);for(const a of e.values())if(a.parentId)JB(a,e,t,n);else{const i=k1(a,n.nodeOrigin),s=Bg(a.extent)?a.extent:n.nodeExtent,l=Rh(i,s,yu(a));a.internals.positionAbsolute=l}}function _st(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const r=[],n=[];for(const a of e.handles){const i={id:a.id,width:a.width??1,height:a.height??1,nodeId:e.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?r.push(i):a.type==="target"&&n.push(i)}return{source:r,target:n}}function QB(e){return e==="manual"}function QP(e,t,r,n={}){const a=YB(Sst,n),i={i:0},s=new Map(t),l=a?.elevateNodesOnSelect&&!QB(a.zIndexMode)?kge:0;let c=e.length>0;t.clear(),r.clear();for(const u of e){let d=s.get(u.id);if(a.checkEquality&&u===d?.internals.userNode)t.set(u.id,d);else{const f=k1(u,a.nodeOrigin),m=Bg(u.extent)?u.extent:a.nodeExtent,p=Rh(f,m,yu(u));d={...a.defaults,...u,measured:{width:u.measured?.width,height:u.measured?.height},internals:{positionAbsolute:p,handleBounds:_st(u,d),z:_ge(u,l,a.zIndexMode),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(c=!1),u.parentId&&JB(d,t,r,n,i)}return c}function Nst(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function JB(e,t,r,n,a){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:l,zIndexMode:c}=YB(VB,n),u=e.parentId,d=t.get(u);if(!d){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Nst(e,r),a&&!d.parentId&&d.internals.rootParentIndex===void 0&&c==="auto"&&(d.internals.rootParentIndex=++a.i,d.internals.z=d.internals.z+a.i*wst),a&&d.internals.rootParentIndex!==void 0&&(a.i=d.internals.rootParentIndex);const f=i&&!QB(c)?kge:0,{x:m,y:p,z:v}=Cst(e,d,s,l,f,c),{positionAbsolute:b}=e.internals,y=m!==b.x||p!==b.y;(y||v!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:m,y:p}:b,z:v}})}function _ge(e,t,r){const n=Go(e.zIndex)?e.zIndex:0;return QB(r)?n:n+(e.selected?t:0)}function Cst(e,t,r,n,a,i){const{x:s,y:l}=t.internals.positionAbsolute,c=yu(e),u=k1(e,r),d=Bg(e.extent)?Rh(u,e.extent,c):u;let f=Rh({x:s+d.x,y:l+d.y},n,c);e.extent==="parent"&&(f=dge(f,c,t));const m=_ge(e,a,i),p=t.internals.z??0;return{x:f.x,y:f.y,z:p>=m?p+1:m}}function ZB(e,t,r,n=[0,0]){const a=[],i=new Map;for(const s of e){const l=t.get(s.parentId);if(!l)continue;const c=i.get(s.parentId)?.expandedRect??zg(l),u=hge(c,s.rect);i.set(s.parentId,{expandedRect:u,parent:l})}return i.size>0&&i.forEach(({expandedRect:s,parent:l},c)=>{const u=l.internals.positionAbsolute,d=yu(l),f=l.origin??n,m=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,p=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,v=Math.max(d.width,Math.round(s.width)),b=Math.max(d.height,Math.round(s.height)),y=(v-d.width)*f[0],S=(b-d.height)*f[1];(m>0||p>0||y||S)&&(a.push({id:c,type:"position",position:{x:l.position.x-m+y,y:l.position.y-p+S}}),r.get(c)?.forEach(_=>{e.some(N=>N.id===_.id)||a.push({id:_.id,type:"position",position:{x:_.position.x+m,y:_.position.y+p}})})),(d.width<s.width||d.height<s.height||m||p)&&a.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:v+(m?f[0]*m-y:0),height:b+(p?f[1]*p-S:0)}})}),a}function jst(e,t,r,n,a,i,s){const l=n?.querySelector(".xyflow__viewport");let c=!1;if(!l)return{changes:[],updatedInternals:c};const u=[],d=window.getComputedStyle(l),{m22:f}=new window.DOMMatrixReadOnly(d.transform),m=[];for(const p of e.values()){const v=t.get(p.id);if(!v)continue;if(v.hidden){t.set(v.id,{...v,internals:{...v.internals,handleBounds:void 0}}),c=!0;continue}const b=GB(p.nodeElement),y=v.measured.width!==b.width||v.measured.height!==b.height;if(!!(b.width&&b.height&&(y||!v.internals.handleBounds||p.force))){const _=p.nodeElement.getBoundingClientRect(),N=Bg(v.extent)?v.extent:i;let{positionAbsolute:k}=v.internals;v.parentId&&v.extent==="parent"?k=dge(k,b,t.get(v.parentId)):N&&(k=Rh(k,N,b));const j={...v,measured:b,internals:{...v.internals,positionAbsolute:k,handleBounds:{source:pee("source",p.nodeElement,_,f,v.id),target:pee("target",p.nodeElement,_,f,v.id)}}};t.set(v.id,j),v.parentId&&JB(j,t,r,{nodeOrigin:a,zIndexMode:s}),c=!0,y&&(u.push({id:v.id,type:"dimensions",dimensions:b}),v.expandParent&&v.parentId&&m.push({id:v.id,parentId:v.parentId,rect:zg(j,a)}))}}if(m.length>0){const p=ZB(m,t,r,a);u.push(...p)}return{changes:u,updatedInternals:c}}async function Est({delta:e,panZoom:t,transform:r,translateExtent:n,width:a,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[a,i]],n),l=!!s&&(s.x!==r[0]||s.y!==r[1]||s.k!==r[2]);return Promise.resolve(l)}function See(e,t,r,n,a,i){let s=a;const l=n.get(s)||new Map;n.set(s,l.set(r,t)),s=`${a}-${e}`;const c=n.get(s)||new Map;if(n.set(s,c.set(r,t)),i){s=`${a}-${e}-${i}`;const u=n.get(s)||new Map;n.set(s,u.set(r,t))}}function Nge(e,t,r){e.clear(),t.clear();for(const n of r){const{source:a,target:i,sourceHandle:s=null,targetHandle:l=null}=n,c={edgeId:n.id,source:a,target:i,sourceHandle:s,targetHandle:l},u=`${a}-${s}--${i}-${l}`,d=`${i}-${l}--${a}-${s}`;See("source",c,d,e,a,s),See("target",c,u,e,i,l),t.set(n.id,n)}}function Cge(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:Cge(r,t):!1}function kee(e,t,r){let n=e;do{if(n?.matches?.(t))return!0;if(n===r)return!1;n=n?.parentElement}while(n);return!1}function Mst(e,t,r,n){const a=new Map;for(const[i,s]of e)if((s.selected||s.id===n)&&(!s.parentId||!Cge(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const l=e.get(i);l&&a.set(i,{id:i,position:l.position||{x:0,y:0},distance:{x:r.x-l.internals.positionAbsolute.x,y:r.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return a}function IL({nodeId:e,dragItems:t,nodeLookup:r,dragging:n=!0}){const a=[];for(const[s,l]of t){const c=r.get(s)?.internals.userNode;c&&a.push({...c,position:l.position,dragging:n})}if(!e)return[a[0],a];const i=r.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:n}:a[0],a]}function Tst({dragItems:e,snapGrid:t,x:r,y:n}){const a=e.values().next().value;if(!a)return null;const i={x:r-a.distance.x,y:n-a.distance.y},s=N1(i,t);return{x:s.x-i.x,y:s.y-i.y}}function Ast({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:n,onDragStop:a}){let i={x:null,y:null},s=0,l=new Map,c=!1,u={x:0,y:0},d=null,f=!1,m=null,p=!1,v=!1,b=null;function y({noDragClassName:_,handleSelector:N,domNode:k,isSelectable:j,nodeId:E,nodeClickDistance:T=0}){m=Ts(k);function O({x:L,y:A}){const{nodeLookup:M,nodeExtent:z,snapGrid:I,snapToGrid:B,nodeOrigin:F,onNodeDrag:U,onSelectionDrag:V,onError:K,updateNodePositions:G}=t();i={x:L,y:A};let J=!1;const ee=l.size>1,Y=ee&&z?GP(_1(l)):null,ie=ee&&B?Tst({dragItems:l,snapGrid:I,x:L,y:A}):null;for(const[fe,me]of l){if(!M.has(fe))continue;let te={x:L-me.distance.x,y:A-me.distance.y};B&&(te=ie?{x:Math.round(te.x+ie.x),y:Math.round(te.y+ie.y)}:N1(te,I));let oe=null;if(ee&&z&&!me.extent&&Y){const{positionAbsolute:ue}=me.internals,H=ue.x-Y.x+z[0][0],ge=ue.x+me.measured.width-Y.x2+z[1][0],de=ue.y-Y.y+z[0][1],re=ue.y+me.measured.height-Y.y2+z[1][1];oe=[[H,de],[ge,re]]}const{position:ce,positionAbsolute:Z}=uge({nodeId:fe,nextPosition:te,nodeLookup:M,nodeExtent:oe||z,nodeOrigin:F,onError:K});J=J||me.position.x!==ce.x||me.position.y!==ce.y,me.position=ce,me.internals.positionAbsolute=Z}if(v=v||J,!!J&&(G(l,!0),b&&(n||U||!E&&V))){const[fe,me]=IL({nodeId:E,dragItems:l,nodeLookup:M});n?.(b,l,fe,me),U?.(b,fe,me),E||V?.(b,me)}}async function R(){if(!d)return;const{transform:L,panBy:A,autoPanSpeed:M,autoPanOnNodeDrag:z}=t();if(!z){c=!1,cancelAnimationFrame(s);return}const[I,B]=fge(u,d,M);(I!==0||B!==0)&&(i.x=(i.x??0)-I/L[2],i.y=(i.y??0)-B/L[2],await A({x:I,y:B})&&O(i)),s=requestAnimationFrame(R)}function q(L){const{nodeLookup:A,multiSelectionActive:M,nodesDraggable:z,transform:I,snapGrid:B,snapToGrid:F,selectNodesOnDrag:U,onNodeDragStart:V,onSelectionDragStart:K,unselectNodesAndEdges:G}=t();f=!0,(!U||!j)&&!M&&E&&(A.get(E)?.selected||G()),j&&U&&E&&e?.(E);const J=Xb(L.sourceEvent,{transform:I,snapGrid:B,snapToGrid:F,containerBounds:d});if(i=J,l=Mst(A,z,J,E),l.size>0&&(r||V||!E&&K)){const[ee,Y]=IL({nodeId:E,dragItems:l,nodeLookup:A});r?.(L.sourceEvent,l,ee,Y),V?.(L.sourceEvent,ee,Y),E||K?.(L.sourceEvent,Y)}}const $=Ype().clickDistance(T).on("start",L=>{const{domNode:A,nodeDragThreshold:M,transform:z,snapGrid:I,snapToGrid:B}=t();d=A?.getBoundingClientRect()||null,p=!1,v=!1,b=L.sourceEvent,M===0&&q(L),i=Xb(L.sourceEvent,{transform:z,snapGrid:I,snapToGrid:B,containerBounds:d}),u=Vo(L.sourceEvent,d)}).on("drag",L=>{const{autoPanOnNodeDrag:A,transform:M,snapGrid:z,snapToGrid:I,nodeDragThreshold:B,nodeLookup:F}=t(),U=Xb(L.sourceEvent,{transform:M,snapGrid:z,snapToGrid:I,containerBounds:d});if(b=L.sourceEvent,(L.sourceEvent.type==="touchmove"&&L.sourceEvent.touches.length>1||E&&!F.has(E))&&(p=!0),!p){if(!c&&A&&f&&(c=!0,R()),!f){const V=Vo(L.sourceEvent,d),K=V.x-u.x,G=V.y-u.y;Math.sqrt(K*K+G*G)>B&&q(L)}(i.x!==U.xSnapped||i.y!==U.ySnapped)&&l&&f&&(u=Vo(L.sourceEvent,d),O(U))}}).on("end",L=>{if(!(!f||p)&&(c=!1,f=!1,cancelAnimationFrame(s),l.size>0)){const{nodeLookup:A,updateNodePositions:M,onNodeDragStop:z,onSelectionDragStop:I}=t();if(v&&(M(l,!1),v=!1),a||z||!E&&I){const[B,F]=IL({nodeId:E,dragItems:l,nodeLookup:A,dragging:!1});a?.(L.sourceEvent,l,B,F),z?.(L.sourceEvent,B,F),E||I?.(L.sourceEvent,F)}}}).filter(L=>{const A=L.target;return!L.button&&(!_||!kee(A,`.${_}`,k))&&(!N||kee(A,N,k))});m.call($)}function S(){m?.on(".drag",null)}return{update:y,destroy:S}}function Dst(e,t,r){const n=[],a={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const i of t.values())vx(a,zg(i))>0&&n.push(i);return n}const Lst=250;function Ost(e,t,r,n){let a=[],i=1/0;const s=Dst(e,r,t+Lst);for(const l of s){const c=[...l.internals.handleBounds?.source??[],...l.internals.handleBounds?.target??[]];for(const u of c){if(n.nodeId===u.nodeId&&n.type===u.type&&n.id===u.id)continue;const{x:d,y:f}=Ph(l,u,u.position,!0),m=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(f-e.y,2));m>t||(m<i?(a=[{...u,x:d,y:f}],i=m):m===i&&a.push({...u,x:d,y:f}))}}if(!a.length)return null;if(a.length>1){const l=n.type==="source"?"target":"source";return a.find(c=>c.type===l)??a[0]}return a[0]}function jge(e,t,r,n,a,i=!1){const s=n.get(e);if(!s)return null;const l=a==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],c=(r?l?.find(u=>u.id===r):l?.[0])??null;return c&&i?{...c,...Ph(s,c,c.position,!0)}:c}function Ege(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ist(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const Mge=()=>!0;function Rst(e,{connectionMode:t,connectionRadius:r,handleId:n,nodeId:a,edgeUpdaterType:i,isTarget:s,domNode:l,nodeLookup:c,lib:u,autoPanOnConnect:d,flowId:f,panBy:m,cancelConnection:p,onConnectStart:v,onConnect:b,onConnectEnd:y,isValidConnection:S=Mge,onReconnectEnd:_,updateConnection:N,getTransform:k,getFromHandle:j,autoPanSpeed:E,dragThreshold:T=1,handleDomNode:O}){const R=gge(e.target);let q=0,$;const{x:L,y:A}=Vo(e),M=Ege(i,O),z=l?.getBoundingClientRect();let I=!1;if(!z||!M)return;const B=jge(a,M,n,c,t);if(!B)return;let F=Vo(e,z),U=!1,V=null,K=!1,G=null;function J(){if(!d||!z)return;const[ce,Z]=fge(F,z,E);m({x:ce,y:Z}),q=requestAnimationFrame(J)}const ee={...B,nodeId:a,type:M,position:B.position},Y=c.get(a);let fe={inProgress:!0,isValid:null,from:Ph(Y,ee,It.Left,!0),fromHandle:ee,fromPosition:ee.position,fromNode:Y,to:F,toHandle:null,toPosition:dee[ee.position],toNode:null,pointer:F};function me(){I=!0,N(fe),v?.(e,{nodeId:a,handleId:n,handleType:M})}T===0&&me();function te(ce){if(!I){const{x:re,y:ne}=Vo(ce),pe=re-L,ke=ne-A;if(!(pe*pe+ke*ke>T*T))return;me()}if(!j()||!ee){oe(ce);return}const Z=k();F=Vo(ce,z),$=Ost(C1(F,Z,!1,[1,1]),r,c,ee),U||(J(),U=!0);const ue=Tge(ce,{handle:$,connectionMode:t,fromNodeId:a,fromHandleId:n,fromType:s?"target":"source",isValidConnection:S,doc:R,lib:u,flowId:f,nodeLookup:c});G=ue.handleDomNode,V=ue.connection,K=Ist(!!$,ue.isValid);const H=c.get(a),ge=H?Ph(H,ee,It.Left,!0):fe.from,de={...fe,from:ge,isValid:K,to:ue.toHandle&&K?kC({x:ue.toHandle.x,y:ue.toHandle.y},Z):F,toHandle:ue.toHandle,toPosition:K&&ue.toHandle?ue.toHandle.position:dee[ee.position],toNode:ue.toHandle?c.get(ue.toHandle.nodeId):null,pointer:F};N(de),fe=de}function oe(ce){if(!("touches"in ce&&ce.touches.length>0)){if(I){($||G)&&V&&K&&b?.(V);const{inProgress:Z,...ue}=fe,H={...ue,toPosition:fe.toHandle?fe.toPosition:null};y?.(ce,H),i&&_?.(ce,H)}p(),cancelAnimationFrame(q),U=!1,K=!1,V=null,G=null,R.removeEventListener("mousemove",te),R.removeEventListener("mouseup",oe),R.removeEventListener("touchmove",te),R.removeEventListener("touchend",oe)}}R.addEventListener("mousemove",te),R.addEventListener("mouseup",oe),R.addEventListener("touchmove",te),R.addEventListener("touchend",oe)}function Tge(e,{handle:t,connectionMode:r,fromNodeId:n,fromHandleId:a,fromType:i,doc:s,lib:l,flowId:c,isValidConnection:u=Mge,nodeLookup:d}){const f=i==="target",m=t?s.querySelector(`.${l}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:v}=Vo(e),b=s.elementFromPoint(p,v),y=b?.classList.contains(`${l}-flow__handle`)?b:m,S={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const _=Ege(void 0,y),N=y.getAttribute("data-nodeid"),k=y.getAttribute("data-handleid"),j=y.classList.contains("connectable"),E=y.classList.contains("connectableend");if(!N||!_)return S;const T={source:f?N:n,sourceHandle:f?k:a,target:f?n:N,targetHandle:f?a:k};S.connection=T;const R=j&&E&&(r===Rg.Strict?f&&_==="source"||!f&&_==="target":N!==n||k!==a);S.isValid=R&&u(T),S.toHandle=jge(N,_,k,d,r,!0)}return S}const JP={onPointerDown:Rst,isValid:Tge};function Pst({domNode:e,panZoom:t,getTransform:r,getViewScale:n}){const a=Ts(e);function i({translateExtent:l,width:c,height:u,zoomStep:d=1,pannable:f=!0,zoomable:m=!0,inversePan:p=!1}){const v=N=>{if(N.sourceEvent.type!=="wheel"||!t)return;const k=r(),j=N.sourceEvent.ctrlKey&&bx()?10:1,E=-N.sourceEvent.deltaY*(N.sourceEvent.deltaMode===1?.05:N.sourceEvent.deltaMode?1:.002)*d,T=k[2]*Math.pow(2,E*j);t.scaleTo(T)};let b=[0,0];const y=N=>{(N.sourceEvent.type==="mousedown"||N.sourceEvent.type==="touchstart")&&(b=[N.sourceEvent.clientX??N.sourceEvent.touches[0].clientX,N.sourceEvent.clientY??N.sourceEvent.touches[0].clientY])},S=N=>{const k=r();if(N.sourceEvent.type!=="mousemove"&&N.sourceEvent.type!=="touchmove"||!t)return;const j=[N.sourceEvent.clientX??N.sourceEvent.touches[0].clientX,N.sourceEvent.clientY??N.sourceEvent.touches[0].clientY],E=[j[0]-b[0],j[1]-b[1]];b=j;const T=n()*Math.max(k[2],Math.log(k[2]))*(p?-1:1),O={x:k[0]-E[0]*T,y:k[1]-E[1]*T},R=[[0,0],[c,u]];t.setViewportConstrained({x:O.x,y:O.y,zoom:k[2]},R,l)},_=age().on("start",y).on("zoom",f?S:null).on("zoom.wheel",m?v:null);a.call(_,{})}function s(){a.on("zoom",null)}return{update:i,destroy:s,pointer:zo}}const B2=e=>({x:e.x,y:e.y,zoom:e.k}),RL=({x:e,y:t,zoom:r})=>R2.translate(e,t).scale(r),Ap=(e,t)=>e.target.closest(`.${t}`),Age=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),zst=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,PL=(e,t=0,r=zst,n=()=>{})=>{const a=typeof t=="number"&&t>0;return a||n(),a?e.transition().duration(t).ease(r).on("end",n):e},Dge=e=>{const t=e.ctrlKey&&bx()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Bst({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:n,panOnScrollMode:a,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:l,onPanZoom:c,onPanZoomEnd:u}){return d=>{if(Ap(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const f=r.property("__zoom").k||1;if(d.ctrlKey&&s){const y=zo(d),S=Dge(d),_=f*Math.pow(2,S);n.scaleTo(r,_,y,d);return}const m=d.deltaMode===1?20:1;let p=a===fh.Vertical?0:d.deltaX*m,v=a===fh.Horizontal?0:d.deltaY*m;!bx()&&d.shiftKey&&a!==fh.Vertical&&(p=d.deltaY*m,v=0),n.translateBy(r,-(p/f)*i,-(v/f)*i,{internal:!0});const b=B2(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c?.(d,b),e.panScrollTimeout=setTimeout(()=>{u?.(d,b),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,l?.(d,b))}}function $st({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(n,a){const i=n.type==="wheel",s=!t&&i&&!n.ctrlKey,l=Ap(n,e);if(n.ctrlKey&&i&&l&&n.preventDefault(),s||l)return null;n.preventDefault(),r.call(this,n,a)}}function Fst({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return n=>{if(n.sourceEvent?.internal)return;const a=B2(n.transform);e.mouseButton=n.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=a,n.sourceEvent?.type==="mousedown"&&t(!0),r&&r?.(n.sourceEvent,a)}}function Ust({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:n,onPanZoom:a}){return i=>{e.usedRightMouseButton=!!(r&&Age(t,e.mouseButton??0)),i.sourceEvent?.sync||n([i.transform.x,i.transform.y,i.transform.k]),a&&!i.sourceEvent?.internal&&a?.(i.sourceEvent,B2(i.transform))}}function Hst({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:n,onPanZoomEnd:a,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&Age(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,n(!1),a)){const l=B2(s.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a?.(s.sourceEvent,l)},r?150:0)}}}function qst({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:n,panOnScroll:a,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:l,noPanClassName:c,lib:u,connectionInProgress:d}){return f=>{const m=e||t,p=r&&f.ctrlKey,v=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(Ap(f,`${u}-flow__node`)||Ap(f,`${u}-flow__edge`)))return!0;if(!n&&!m&&!a&&!i&&!r||s||d&&!v||Ap(f,l)&&v||Ap(f,c)&&(!v||a&&v&&!e)||!r&&f.ctrlKey&&v)return!1;if(!r&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!m&&!a&&!p&&v||!n&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(n)&&!n.includes(f.button)&&f.type==="mousedown")return!1;const b=Array.isArray(n)&&n.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||v)&&b}}function Wst({domNode:e,minZoom:t,maxZoom:r,translateExtent:n,viewport:a,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:l,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=age().scaleExtent([t,r]).translateExtent(n),m=Ts(e).call(f);_({x:a.x,y:a.y,zoom:Pg(a.zoom,t,r)},[[0,0],[d.width,d.height]],n);const p=m.on("wheel.zoom"),v=m.on("dblclick.zoom");f.wheelDelta(Dge);function b($,L){return m?new Promise(A=>{f?.interpolate(L?.interpolate==="linear"?Qc:pk).transform(PL(m,L?.duration,L?.ease,()=>A(!0)),$)}):Promise.resolve(!1)}function y({noWheelClassName:$,noPanClassName:L,onPaneContextMenu:A,userSelectionActive:M,panOnScroll:z,panOnDrag:I,panOnScrollMode:B,panOnScrollSpeed:F,preventScrolling:U,zoomOnPinch:V,zoomOnScroll:K,zoomOnDoubleClick:G,zoomActivationKeyPressed:J,lib:ee,onTransformChange:Y,connectionInProgress:ie,paneClickDistance:fe,selectionOnDrag:me}){M&&!u.isZoomingOrPanning&&S();const te=z&&!J&&!M;f.clickDistance(me?1/0:!Go(fe)||fe<0?0:fe);const oe=te?Bst({zoomPanValues:u,noWheelClassName:$,d3Selection:m,d3Zoom:f,panOnScrollMode:B,panOnScrollSpeed:F,zoomOnPinch:V,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:l}):$st({noWheelClassName:$,preventScrolling:U,d3ZoomHandler:p});if(m.on("wheel.zoom",oe,{passive:!1}),!M){const Z=Fst({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:s});f.on("start",Z);const ue=Ust({zoomPanValues:u,panOnDrag:I,onPaneContextMenu:!!A,onPanZoom:i,onTransformChange:Y});f.on("zoom",ue);const H=Hst({zoomPanValues:u,panOnDrag:I,panOnScroll:z,onPaneContextMenu:A,onPanZoomEnd:l,onDraggingChange:c});f.on("end",H)}const ce=qst({zoomActivationKeyPressed:J,panOnDrag:I,zoomOnScroll:K,panOnScroll:z,zoomOnDoubleClick:G,zoomOnPinch:V,userSelectionActive:M,noPanClassName:L,noWheelClassName:$,lib:ee,connectionInProgress:ie});f.filter(ce),G?m.on("dblclick.zoom",v):m.on("dblclick.zoom",null)}function S(){f.on("zoom",null)}async function _($,L,A){const M=RL($),z=f?.constrain()(M,L,A);return z&&await b(z),new Promise(I=>I(z))}async function N($,L){const A=RL($);return await b(A,L),new Promise(M=>M(A))}function k($){if(m){const L=RL($),A=m.property("__zoom");(A.k!==$.zoom||A.x!==$.x||A.y!==$.y)&&f?.transform(m,L,null,{sync:!0})}}function j(){const $=m?nge(m.node()):{x:0,y:0,k:1};return{x:$.x,y:$.y,zoom:$.k}}function E($,L){return m?new Promise(A=>{f?.interpolate(L?.interpolate==="linear"?Qc:pk).scaleTo(PL(m,L?.duration,L?.ease,()=>A(!0)),$)}):Promise.resolve(!1)}function T($,L){return m?new Promise(A=>{f?.interpolate(L?.interpolate==="linear"?Qc:pk).scaleBy(PL(m,L?.duration,L?.ease,()=>A(!0)),$)}):Promise.resolve(!1)}function O($){f?.scaleExtent($)}function R($){f?.translateExtent($)}function q($){const L=!Go($)||$<0?0:$;f?.clickDistance(L)}return{update:y,destroy:S,setViewport:N,setViewportConstrained:_,getViewport:j,scaleTo:E,scaleBy:T,setScaleExtent:O,setTranslateExtent:R,syncViewport:k,setClickDistance:q}}var $g;(function(e){e.Line="line",e.Handle="handle"})($g||($g={}));function Kst({width:e,prevWidth:t,height:r,prevHeight:n,affectsX:a,affectsY:i}){const s=e-t,l=r-n,c=[s>0?1:s<0?-1:0,l>0?1:l<0?-1:0];return s&&a&&(c[0]=c[0]*-1),l&&i&&(c[1]=c[1]*-1),c}function _ee(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),n=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:n,affectsY:a}}function Zu(e,t){return Math.max(0,t-e)}function Xu(e,t){return Math.max(0,e-t)}function HS(e,t,r){return Math.max(0,t-e,e-r)}function Nee(e,t){return e?!t:t}function Gst(e,t,r,n,a,i,s,l){let{affectsX:c,affectsY:u}=t;const{isHorizontal:d,isVertical:f}=t,m=d&&f,{xSnapped:p,ySnapped:v}=r,{minWidth:b,maxWidth:y,minHeight:S,maxHeight:_}=n,{x:N,y:k,width:j,height:E,aspectRatio:T}=e;let O=Math.floor(d?p-e.pointerX:0),R=Math.floor(f?v-e.pointerY:0);const q=j+(c?-O:O),$=E+(u?-R:R),L=-i[0]*j,A=-i[1]*E;let M=HS(q,b,y),z=HS($,S,_);if(s){let F=0,U=0;c&&O<0?F=Zu(N+O+L,s[0][0]):!c&&O>0&&(F=Xu(N+q+L,s[1][0])),u&&R<0?U=Zu(k+R+A,s[0][1]):!u&&R>0&&(U=Xu(k+$+A,s[1][1])),M=Math.max(M,F),z=Math.max(z,U)}if(l){let F=0,U=0;c&&O>0?F=Xu(N+O,l[0][0]):!c&&O<0&&(F=Zu(N+q,l[1][0])),u&&R>0?U=Xu(k+R,l[0][1]):!u&&R<0&&(U=Zu(k+$,l[1][1])),M=Math.max(M,F),z=Math.max(z,U)}if(a){if(d){const F=HS(q/T,S,_)*T;if(M=Math.max(M,F),s){let U=0;!c&&!u||c&&!u&&m?U=Xu(k+A+q/T,s[1][1])*T:U=Zu(k+A+(c?O:-O)/T,s[0][1])*T,M=Math.max(M,U)}if(l){let U=0;!c&&!u||c&&!u&&m?U=Zu(k+q/T,l[1][1])*T:U=Xu(k+(c?O:-O)/T,l[0][1])*T,M=Math.max(M,U)}}if(f){const F=HS($*T,b,y)/T;if(z=Math.max(z,F),s){let U=0;!c&&!u||u&&!c&&m?U=Xu(N+$*T+L,s[1][0])/T:U=Zu(N+(u?R:-R)*T+L,s[0][0])/T,z=Math.max(z,U)}if(l){let U=0;!c&&!u||u&&!c&&m?U=Zu(N+$*T,l[1][0])/T:U=Xu(N+(u?R:-R)*T,l[0][0])/T,z=Math.max(z,U)}}}R=R+(R<0?z:-z),O=O+(O<0?M:-M),a&&(m?q>$*T?R=(Nee(c,u)?-O:O)/T:O=(Nee(c,u)?-R:R)*T:d?(R=O/T,u=c):(O=R*T,c=u));const I=c?N+O:N,B=u?k+R:k;return{width:j+(c?-O:O),height:E+(u?-R:R),x:i[0]*O*(c?-1:1)+I,y:i[1]*R*(u?-1:1)+B}}const Lge={width:0,height:0,x:0,y:0},Vst={...Lge,pointerX:0,pointerY:0,aspectRatio:1};function Yst(e){return[[0,0],[e.measured.width,e.measured.height]]}function Qst(e,t,r){const n=t.position.x+e.position.x,a=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,l=r[0]*i,c=r[1]*s;return[[n-l,a-c],[n+i-l,a+s-c]]}function Jst({domNode:e,nodeId:t,getStoreItems:r,onChange:n,onEnd:a}){const i=Ts(e);let s={controlDirection:_ee("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function l({controlPosition:u,boundaries:d,keepAspectRatio:f,resizeDirection:m,onResizeStart:p,onResize:v,onResizeEnd:b,shouldResize:y}){let S={...Lge},_={...Vst};s={boundaries:d,resizeDirection:m,keepAspectRatio:f,controlDirection:_ee(u)};let N,k=null,j=[],E,T,O,R=!1;const q=Ype().on("start",$=>{const{nodeLookup:L,transform:A,snapGrid:M,snapToGrid:z,nodeOrigin:I,paneDomNode:B}=r();if(N=L.get(t),!N)return;k=B?.getBoundingClientRect()??null;const{xSnapped:F,ySnapped:U}=Xb($.sourceEvent,{transform:A,snapGrid:M,snapToGrid:z,containerBounds:k});S={width:N.measured.width??0,height:N.measured.height??0,x:N.position.x??0,y:N.position.y??0},_={...S,pointerX:F,pointerY:U,aspectRatio:S.width/S.height},E=void 0,N.parentId&&(N.extent==="parent"||N.expandParent)&&(E=L.get(N.parentId),T=E&&N.extent==="parent"?Yst(E):void 0),j=[],O=void 0;for(const[V,K]of L)if(K.parentId===t&&(j.push({id:V,position:{...K.position},extent:K.extent}),K.extent==="parent"||K.expandParent)){const G=Qst(K,N,K.origin??I);O?O=[[Math.min(G[0][0],O[0][0]),Math.min(G[0][1],O[0][1])],[Math.max(G[1][0],O[1][0]),Math.max(G[1][1],O[1][1])]]:O=G}p?.($,{...S})}).on("drag",$=>{const{transform:L,snapGrid:A,snapToGrid:M,nodeOrigin:z}=r(),I=Xb($.sourceEvent,{transform:L,snapGrid:A,snapToGrid:M,containerBounds:k}),B=[];if(!N)return;const{x:F,y:U,width:V,height:K}=S,G={},J=N.origin??z,{width:ee,height:Y,x:ie,y:fe}=Gst(_,s.controlDirection,I,s.boundaries,s.keepAspectRatio,J,T,O),me=ee!==V,te=Y!==K,oe=ie!==F&&me,ce=fe!==U&&te;if(!oe&&!ce&&!me&&!te)return;if((oe||ce||J[0]===1||J[1]===1)&&(G.x=oe?ie:S.x,G.y=ce?fe:S.y,S.x=G.x,S.y=G.y,j.length>0)){const ge=ie-F,de=fe-U;for(const re of j)re.position={x:re.position.x-ge+J[0]*(ee-V),y:re.position.y-de+J[1]*(Y-K)},B.push(re)}if((me||te)&&(G.width=me&&(!s.resizeDirection||s.resizeDirection==="horizontal")?ee:S.width,G.height=te&&(!s.resizeDirection||s.resizeDirection==="vertical")?Y:S.height,S.width=G.width,S.height=G.height),E&&N.expandParent){const ge=J[0]*(G.width??0);G.x&&G.x<ge&&(S.x=ge,_.x=_.x-(G.x-ge));const de=J[1]*(G.height??0);G.y&&G.y<de&&(S.y=de,_.y=_.y-(G.y-de))}const Z=Kst({width:S.width,prevWidth:V,height:S.height,prevHeight:K,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),ue={...S,direction:Z};y?.($,ue)!==!1&&(R=!0,v?.($,ue),n(G,B))}).on("end",$=>{R&&(b?.($,{...S}),a?.({...S}),R=!1)});i.call(q)}function c(){i.on(".drag",null)}return{update:l,destroy:c}}const Zst={},Cee=e=>{let t;const r=new Set,n=(d,f)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const p=t;t=f??(typeof m!="object"||m===null)?m:Object.assign({},t,m),r.forEach(v=>v(t,p))}},a=()=>t,c={setState:n,getState:a,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(Zst?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,a,c);return c},Xst=e=>e?Cee(e):Cee,{useDebugValue:eot}=le,{useSyncExternalStoreWithSelector:tot}=H1e,rot=e=>e;function Oge(e,t=rot,r){const n=tot(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return eot(n),n}const jee=(e,t)=>{const r=Xst(e),n=(a,i=t)=>Oge(r,a,i);return Object.assign(n,r),n},not=(e,t)=>e?jee(e,t):jee;function Tn(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,a]of e)if(!Object.is(a,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}const $2=w.createContext(null),aot=$2.Provider,Ige=$l.error001();function Er(e,t){const r=w.useContext($2);if(r===null)throw new Error(Ige);return Oge(r,e,t)}function An(){const e=w.useContext($2);if(e===null)throw new Error(Ige);return w.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Eee={display:"none"},iot={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Rge="react-flow__node-desc",Pge="react-flow__edge-desc",sot="react-flow__aria-live",oot=e=>e.ariaLiveMessage,lot=e=>e.ariaLabelConfig;function cot({rfId:e}){const t=Er(oot);return o.jsx("div",{id:`${sot}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:iot,children:t})}function uot({rfId:e,disableKeyboardA11y:t}){const r=Er(lot);return o.jsxs(o.Fragment,{children:[o.jsx("div",{id:`${Rge}-${e}`,style:Eee,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),o.jsx("div",{id:`${Pge}-${e}`,style:Eee,children:r["edge.a11yDescription.default"]}),!t&&o.jsx(cot,{rfId:e})]})}const F2=w.forwardRef(({position:e="top-left",children:t,className:r,style:n,...a},i)=>{const s=`${e}`.split("-");return o.jsx("div",{className:ya(["react-flow__panel",r,...s]),style:n,ref:i,...a,children:t})});F2.displayName="Panel";function dot({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:o.jsx(F2,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:o.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const fot=e=>{const t=[],r=[];for(const[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(const[,n]of e.edgeLookup)n.selected&&r.push(n);return{selectedNodes:t,selectedEdges:r}},qS=e=>e.id;function hot(e,t){return Tn(e.selectedNodes.map(qS),t.selectedNodes.map(qS))&&Tn(e.selectedEdges.map(qS),t.selectedEdges.map(qS))}function mot({onSelectionChange:e}){const t=An(),{selectedNodes:r,selectedEdges:n}=Er(fot,hot);return w.useEffect(()=>{const a={nodes:r,edges:n};e?.(a),t.getState().onSelectionChangeHandlers.forEach(i=>i(a))},[r,n,e]),null}const pot=e=>!!e.onSelectionChangeHandlers;function got({onSelectionChange:e}){const t=Er(pot);return e||t?o.jsx(mot,{onSelectionChange:e}):null}const zge=[0,0],vot={x:0,y:0,zoom:1},bot=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Mee=[...bot,"rfId"],yot=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Tee={translateExtent:px,nodeOrigin:zge,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function xot(e){const{setNodes:t,setEdges:r,setMinZoom:n,setMaxZoom:a,setTranslateExtent:i,setNodeExtent:s,reset:l,setDefaultNodesAndEdges:c}=Er(yot,Tn),u=An();w.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=Tee,l()}),[]);const d=w.useRef(Tee);return w.useEffect(()=>{for(const f of Mee){const m=e[f],p=d.current[f];m!==p&&(typeof e[f]>"u"||(f==="nodes"?t(m):f==="edges"?r(m):f==="minZoom"?n(m):f==="maxZoom"?a(m):f==="translateExtent"?i(m):f==="nodeExtent"?s(m):f==="ariaLabelConfig"?u.setState({ariaLabelConfig:cst(m)}):f==="fitView"?u.setState({fitViewQueued:m}):f==="fitViewOptions"?u.setState({fitViewOptions:m}):u.setState({[f]:m})))}d.current=e},Mee.map(f=>e[f])),null}function Aee(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function wot(e){const[t,r]=w.useState(e==="system"?null:e);return w.useEffect(()=>{if(e!=="system"){r(e);return}const n=Aee(),a=()=>r(n?.matches?"dark":"light");return a(),n?.addEventListener("change",a),()=>{n?.removeEventListener("change",a)}},[e]),t!==null?t:Aee()?.matches?"dark":"light"}const Dee=typeof document<"u"?document:null;function yx(e=null,t={target:Dee,actInsideInputWithModifier:!0}){const[r,n]=w.useState(!1),a=w.useRef(!1),i=w.useRef(new Set([])),[s,l]=w.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=u.reduce((f,m)=>f.concat(...m),[]);return[u,d]}return[[],[]]},[e]);return w.useEffect(()=>{const c=t?.target??Dee,u=t?.actInsideInputWithModifier??!0;if(e!==null){const d=p=>{if(a.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!a.current||a.current&&!u)&&vge(p))return!1;const b=Oee(p.code,l);if(i.current.add(p[b]),Lee(s,i.current,!1)){const y=p.composedPath?.()?.[0]||p.target,S=y?.nodeName==="BUTTON"||y?.nodeName==="A";t.preventDefault!==!1&&(a.current||!S)&&p.preventDefault(),n(!0)}},f=p=>{const v=Oee(p.code,l);Lee(s,i.current,!0)?(n(!1),i.current.clear()):i.current.delete(p[v]),p.key==="Meta"&&i.current.clear(),a.current=!1},m=()=>{i.current.clear(),n(!1)};return c?.addEventListener("keydown",d),c?.addEventListener("keyup",f),window.addEventListener("blur",m),window.addEventListener("contextmenu",m),()=>{c?.removeEventListener("keydown",d),c?.removeEventListener("keyup",f),window.removeEventListener("blur",m),window.removeEventListener("contextmenu",m)}}},[e,n]),r}function Lee(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(a=>t.has(a)))}function Oee(e,t){return t.includes(e)?"code":"key"}const Sot=()=>{const e=An();return w.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:n}=e.getState();return n?n.scaleTo(t,{duration:r?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[n,a,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??n,y:t.y??a,zoom:t.zoom??i},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,n]=e.getState().transform;return{x:t,y:r,zoom:n}},setCenter:async(t,r,n)=>e.getState().setCenter(t,r,n),fitBounds:async(t,r)=>{const{width:n,height:a,minZoom:i,maxZoom:s,panZoom:l}=e.getState(),c=KB(t,n,a,i,s,r?.padding??.1);return l?(await l.setViewport(c,{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:n,snapGrid:a,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:l,y:c}=s.getBoundingClientRect(),u={x:t.x-l,y:t.y-c},d=r.snapGrid??a,f=r.snapToGrid??i;return C1(u,n,f,d)},flowToScreenPosition:t=>{const{transform:r,domNode:n}=e.getState();if(!n)return t;const{x:a,y:i}=n.getBoundingClientRect(),s=kC(t,r);return{x:s.x+a,y:s.y+i}}}),[])};function Bge(e,t){const r=[],n=new Map,a=[];for(const i of e)if(i.type==="add"){a.push(i);continue}else if(i.type==="remove"||i.type==="replace")n.set(i.id,[i]);else{const s=n.get(i.id);s?s.push(i):n.set(i.id,[i])}for(const i of t){const s=n.get(i.id);if(!s){r.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){r.push({...s[0].item});continue}const l={...i};for(const c of s)kot(c,l);r.push(l)}return a.length&&a.forEach(i=>{i.index!==void 0?r.splice(i.index,0,{...i.item}):r.push({...i.item})}),r}function kot(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function $ge(e,t){return Bge(e,t)}function Fge(e,t){return Bge(e,t)}function $f(e,t){return{id:e,type:"select",selected:t}}function Dp(e,t=new Set,r=!1){const n=[];for(const[a,i]of e){const s=t.has(a);!(i.selected===void 0&&!s)&&i.selected!==s&&(r&&(i.selected=s),n.push($f(i.id,s)))}return n}function Iee({items:e=[],lookup:t}){const r=[],n=new Map(e.map(a=>[a.id,a]));for(const[a,i]of e.entries()){const s=t.get(i.id),l=s?.internals?.userNode??s;l!==void 0&&l!==i&&r.push({id:i.id,item:i,type:"replace"}),l===void 0&&r.push({item:i,type:"add",index:a})}for(const[a]of t)n.get(a)===void 0&&r.push({id:a,type:"remove"});return r}function Ree(e){return{id:e.id,type:"remove"}}const Pee=e=>Xit(e),_ot=e=>cge(e);function Uge(e){return w.forwardRef(e)}const Not=typeof window<"u"?w.useLayoutEffect:w.useEffect;function zee(e){const[t,r]=w.useState(BigInt(0)),[n]=w.useState(()=>Cot(()=>r(a=>a+BigInt(1))));return Not(()=>{const a=n.get();a.length&&(e(a),n.reset())},[t]),n}function Cot(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const Hge=w.createContext(null);function jot({children:e}){const t=An(),r=w.useCallback(l=>{const{nodes:c=[],setNodes:u,hasDefaultNodes:d,onNodesChange:f,nodeLookup:m,fitViewQueued:p,onNodesChangeMiddlewareMap:v}=t.getState();let b=c;for(const S of l)b=typeof S=="function"?S(b):S;let y=Iee({items:b,lookup:m});for(const S of v.values())y=S(y);d&&u(b),y.length>0?f?.(y):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:S,nodes:_,setNodes:N}=t.getState();S&&N(_)})},[]),n=zee(r),a=w.useCallback(l=>{const{edges:c=[],setEdges:u,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:m}=t.getState();let p=c;for(const v of l)p=typeof v=="function"?v(p):v;d?u(p):f&&f(Iee({items:p,lookup:m}))},[]),i=zee(a),s=w.useMemo(()=>({nodeQueue:n,edgeQueue:i}),[]);return o.jsx(Hge.Provider,{value:s,children:e})}function Eot(){const e=w.useContext(Hge);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Mot=e=>!!e.panZoom;function XB(){const e=Sot(),t=An(),r=Eot(),n=Er(Mot),a=w.useMemo(()=>{const i=f=>t.getState().nodeLookup.get(f),s=f=>{r.nodeQueue.push(f)},l=f=>{r.edgeQueue.push(f)},c=f=>{const{nodeLookup:m,nodeOrigin:p}=t.getState(),v=Pee(f)?f:m.get(f.id),b=v.parentId?pge(v.position,v.measured,v.parentId,m,p):v.position,y={...v,position:b,width:v.measured?.width??v.width,height:v.measured?.height??v.height};return zg(y)},u=(f,m,p={replace:!1})=>{s(v=>v.map(b=>{if(b.id===f){const y=typeof m=="function"?m(b):m;return p.replace&&Pee(y)?y:{...b,...y}}return b}))},d=(f,m,p={replace:!1})=>{l(v=>v.map(b=>{if(b.id===f){const y=typeof m=="function"?m(b):m;return p.replace&&_ot(y)?y:{...b,...y}}return b}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>i(f)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(m=>({...m}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:s,setEdges:l,addNodes:f=>{const m=Array.isArray(f)?f:[f];r.nodeQueue.push(p=>[...p,...m])},addEdges:f=>{const m=Array.isArray(f)?f:[f];r.edgeQueue.push(p=>[...p,...m])},toObject:()=>{const{nodes:f=[],edges:m=[],transform:p}=t.getState(),[v,b,y]=p;return{nodes:f.map(S=>({...S})),edges:m.map(S=>({...S})),viewport:{x:v,y:b,zoom:y}}},deleteElements:async({nodes:f=[],edges:m=[]})=>{const{nodes:p,edges:v,onNodesDelete:b,onEdgesDelete:y,triggerNodeChanges:S,triggerEdgeChanges:_,onDelete:N,onBeforeDelete:k}=t.getState(),{nodes:j,edges:E}=await ast({nodesToRemove:f,edgesToRemove:m,nodes:p,edges:v,onBeforeDelete:k}),T=E.length>0,O=j.length>0;if(T){const R=E.map(Ree);y?.(E),_(R)}if(O){const R=j.map(Ree);b?.(j),S(R)}return(O||T)&&N?.({nodes:j,edges:E}),{deletedNodes:j,deletedEdges:E}},getIntersectingNodes:(f,m=!0,p)=>{const v=hee(f),b=v?f:c(f),y=p!==void 0;return b?(p||t.getState().nodes).filter(S=>{const _=t.getState().nodeLookup.get(S.id);if(_&&!v&&(S.id===f.id||!_.internals.positionAbsolute))return!1;const N=zg(y?S:_),k=vx(N,b);return m&&k>0||k>=N.width*N.height||k>=b.width*b.height}):[]},isNodeIntersecting:(f,m,p=!0)=>{const b=hee(f)?f:c(f);if(!b)return!1;const y=vx(b,m);return p&&y>0||y>=m.width*m.height||y>=b.width*b.height},updateNode:u,updateNodeData:(f,m,p={replace:!1})=>{u(f,v=>{const b=typeof m=="function"?m(v):m;return p.replace?{...v,data:b}:{...v,data:{...v.data,...b}}},p)},updateEdge:d,updateEdgeData:(f,m,p={replace:!1})=>{d(f,v=>{const b=typeof m=="function"?m(v):m;return p.replace?{...v,data:b}:{...v,data:{...v.data,...b}}},p)},getNodesBounds:f=>{const{nodeLookup:m,nodeOrigin:p}=t.getState();return est(f,{nodeLookup:m,nodeOrigin:p})},getHandleConnections:({type:f,id:m,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}-${f}${m?`-${m}`:""}`)?.values()??[]),getNodeConnections:({type:f,handleId:m,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}${f?m?`-${f}-${m}`:`-${f}`:""}`)?.values()??[]),fitView:async f=>{const m=t.getState().fitViewResolver??lst();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:m}),r.nodeQueue.push(p=>[...p]),m.promise}}},[]);return w.useMemo(()=>({...a,...e,viewportInitialized:n}),[n])}const Bee=e=>e.selected,Tot=typeof window<"u"?window:void 0;function Aot({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=An(),{deleteElements:n}=XB(),a=yx(e,{actInsideInputWithModifier:!1}),i=yx(t,{target:Tot});w.useEffect(()=>{if(a){const{edges:s,nodes:l}=r.getState();n({nodes:l.filter(Bee),edges:s.filter(Bee)}),r.setState({nodesSelectionActive:!1})}},[a]),w.useEffect(()=>{r.setState({multiSelectionActive:i})},[i])}function Dot(e){const t=An();w.useEffect(()=>{const r=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const n=GB(e.current);(n.height===0||n.width===0)&&t.getState().onError?.("004",$l.error004()),t.setState({width:n.width||500,height:n.height||500})};if(e.current){r(),window.addEventListener("resize",r);const n=new ResizeObserver(()=>r());return n.observe(e.current),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}},[])}const U2={position:"absolute",width:"100%",height:"100%",top:0,left:0},Lot=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Oot({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:n=!1,panOnScrollSpeed:a=.5,panOnScrollMode:i=fh.Free,zoomOnDoubleClick:s=!0,panOnDrag:l=!0,defaultViewport:c,translateExtent:u,minZoom:d,maxZoom:f,zoomActivationKeyCode:m,preventScrolling:p=!0,children:v,noWheelClassName:b,noPanClassName:y,onViewportChange:S,isControlledViewport:_,paneClickDistance:N,selectionOnDrag:k}){const j=An(),E=w.useRef(null),{userSelectionActive:T,lib:O,connectionInProgress:R}=Er(Lot,Tn),q=yx(m),$=w.useRef();Dot(E);const L=w.useCallback(A=>{S?.({x:A[0],y:A[1],zoom:A[2]}),_||j.setState({transform:A})},[S,_]);return w.useEffect(()=>{if(E.current){$.current=Wst({domNode:E.current,minZoom:d,maxZoom:f,translateExtent:u,viewport:c,onDraggingChange:I=>j.setState({paneDragging:I}),onPanZoomStart:(I,B)=>{const{onViewportChangeStart:F,onMoveStart:U}=j.getState();U?.(I,B),F?.(B)},onPanZoom:(I,B)=>{const{onViewportChange:F,onMove:U}=j.getState();U?.(I,B),F?.(B)},onPanZoomEnd:(I,B)=>{const{onViewportChangeEnd:F,onMoveEnd:U}=j.getState();U?.(I,B),F?.(B)}});const{x:A,y:M,zoom:z}=$.current.getViewport();return j.setState({panZoom:$.current,transform:[A,M,z],domNode:E.current.closest(".react-flow")}),()=>{$.current?.destroy()}}},[]),w.useEffect(()=>{$.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:n,panOnScrollSpeed:a,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:l,zoomActivationKeyPressed:q,preventScrolling:p,noPanClassName:y,userSelectionActive:T,noWheelClassName:b,lib:O,onTransformChange:L,connectionInProgress:R,selectionOnDrag:k,paneClickDistance:N})},[e,t,r,n,a,i,s,l,q,p,y,T,b,O,L,R,k,N]),o.jsx("div",{className:"react-flow__renderer",ref:E,style:U2,children:v})}const Iot=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Rot(){const{userSelectionActive:e,userSelectionRect:t}=Er(Iot,Tn);return e&&t?o.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const zL=(e,t)=>r=>{r.target===t.current&&e?.(r)},Pot=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function zot({isSelecting:e,selectionKeyPressed:t,selectionMode:r=gx.Full,panOnDrag:n,paneClickDistance:a,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:l,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:d,onPaneMouseEnter:f,onPaneMouseMove:m,onPaneMouseLeave:p,children:v}){const b=An(),{userSelectionActive:y,elementsSelectable:S,dragging:_,connectionInProgress:N}=Er(Pot,Tn),k=S&&(e||y),j=w.useRef(null),E=w.useRef(),T=w.useRef(new Set),O=w.useRef(new Set),R=w.useRef(!1),q=F=>{if(R.current||N){R.current=!1;return}c?.(F),b.getState().resetSelectedElements(),b.setState({nodesSelectionActive:!1})},$=F=>{if(Array.isArray(n)&&n?.includes(2)){F.preventDefault();return}u?.(F)},L=d?F=>d(F):void 0,A=F=>{R.current&&(F.stopPropagation(),R.current=!1)},M=F=>{const{domNode:U}=b.getState();if(E.current=U?.getBoundingClientRect(),!E.current)return;const V=F.target===j.current;if(!V&&!!F.target.closest(".nokey")||!e||!(i&&V||t)||F.button!==0||!F.isPrimary)return;F.target?.setPointerCapture?.(F.pointerId),R.current=!1;const{x:J,y:ee}=Vo(F.nativeEvent,E.current);b.setState({userSelectionRect:{width:0,height:0,startX:J,startY:ee,x:J,y:ee}}),V||(F.stopPropagation(),F.preventDefault())},z=F=>{const{userSelectionRect:U,transform:V,nodeLookup:K,edgeLookup:G,connectionLookup:J,triggerNodeChanges:ee,triggerEdgeChanges:Y,defaultEdgeOptions:ie,resetSelectedElements:fe}=b.getState();if(!E.current||!U)return;const{x:me,y:te}=Vo(F.nativeEvent,E.current),{startX:oe,startY:ce}=U;if(!R.current){const de=t?0:a;if(Math.hypot(me-oe,te-ce)<=de)return;fe(),s?.(F)}R.current=!0;const Z={startX:oe,startY:ce,x:me<oe?me:oe,y:te<ce?te:ce,width:Math.abs(me-oe),height:Math.abs(te-ce)},ue=T.current,H=O.current;T.current=new Set(WB(K,Z,V,r===gx.Partial,!0).map(de=>de.id)),O.current=new Set;const ge=ie?.selectable??!0;for(const de of T.current){const re=J.get(de);if(re)for(const{edgeId:ne}of re.values()){const pe=G.get(ne);pe&&(pe.selectable??ge)&&O.current.add(ne)}}if(!mee(ue,T.current)){const de=Dp(K,T.current,!0);ee(de)}if(!mee(H,O.current)){const de=Dp(G,O.current);Y(de)}b.setState({userSelectionRect:Z,userSelectionActive:!0,nodesSelectionActive:!1})},I=F=>{F.button===0&&(F.target?.releasePointerCapture?.(F.pointerId),!y&&F.target===j.current&&b.getState().userSelectionRect&&q?.(F),b.setState({userSelectionActive:!1,userSelectionRect:null}),R.current&&(l?.(F),b.setState({nodesSelectionActive:T.current.size>0})))},B=n===!0||Array.isArray(n)&&n.includes(0);return o.jsxs("div",{className:ya(["react-flow__pane",{draggable:B,dragging:_,selection:e}]),onClick:k?void 0:zL(q,j),onContextMenu:zL($,j),onWheel:zL(L,j),onPointerEnter:k?void 0:f,onPointerMove:k?z:m,onPointerUp:k?I:void 0,onPointerDownCapture:k?M:void 0,onClickCapture:k?A:void 0,onPointerLeave:p,ref:j,style:U2,children:[v,o.jsx(Rot,{})]})}function ZP({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:a,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:l,onError:c}=t.getState(),u=l.get(e);if(!u){c?.("012",$l.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>n?.current?.blur())):a([e])}function qge({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:a,isSelectable:i,nodeClickDistance:s}){const l=An(),[c,u]=w.useState(!1),d=w.useRef();return w.useEffect(()=>{d.current=Ast({getStoreItems:()=>l.getState(),onNodeMouseDown:f=>{ZP({id:f,store:l,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),w.useEffect(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:r,handleSelector:n,domNode:e.current,isSelectable:i,nodeId:a,nodeClickDistance:s}),()=>{d.current?.destroy()}},[r,n,t,i,e,a]),c}const Bot=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Wge(){const e=An();return w.useCallback(r=>{const{nodeExtent:n,snapToGrid:a,snapGrid:i,nodesDraggable:s,onError:l,updateNodePositions:c,nodeLookup:u,nodeOrigin:d}=e.getState(),f=new Map,m=Bot(s),p=a?i[0]:5,v=a?i[1]:5,b=r.direction.x*p*r.factor,y=r.direction.y*v*r.factor;for(const[,S]of u){if(!m(S))continue;let _={x:S.internals.positionAbsolute.x+b,y:S.internals.positionAbsolute.y+y};a&&(_=N1(_,i));const{position:N,positionAbsolute:k}=uge({nodeId:S.id,nextPosition:_,nodeLookup:u,nodeExtent:n,nodeOrigin:d,onError:l});S.position=N,S.internals.positionAbsolute=k,f.set(S.id,S)}c(f)},[])}const e$=w.createContext(null),$ot=e$.Provider;e$.Consumer;const Kge=()=>w.useContext(e$),Fot=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Uot=(e,t,r)=>n=>{const{connectionClickStartHandle:a,connectionMode:i,connection:s}=n,{fromHandle:l,toHandle:c,isValid:u}=s,d=c?.nodeId===e&&c?.id===t&&c?.type===r;return{connectingFrom:l?.nodeId===e&&l?.id===t&&l?.type===r,connectingTo:d,clickConnecting:a?.nodeId===e&&a?.id===t&&a?.type===r,isPossibleEndHandle:i===Rg.Strict?l?.type!==r:e!==l?.nodeId||t!==l?.id,connectionInProcess:!!l,clickConnectionInProcess:!!a,valid:d&&u}};function Hot({type:e="source",position:t=It.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:a=!0,isConnectableEnd:i=!0,id:s,onConnect:l,children:c,className:u,onMouseDown:d,onTouchStart:f,...m},p){const v=s||null,b=e==="target",y=An(),S=Kge(),{connectOnClick:_,noPanClassName:N,rfId:k}=Er(Fot,Tn),{connectingFrom:j,connectingTo:E,clickConnecting:T,isPossibleEndHandle:O,connectionInProcess:R,clickConnectionInProcess:q,valid:$}=Er(Uot(S,v,e),Tn);S||y.getState().onError?.("010",$l.error010());const L=z=>{const{defaultEdgeOptions:I,onConnect:B,hasDefaultEdges:F}=y.getState(),U={...I,...z};if(F){const{edges:V,setEdges:K}=y.getState();K(pst(U,V))}B?.(U),l?.(U)},A=z=>{if(!S)return;const I=bge(z.nativeEvent);if(a&&(I&&z.button===0||!I)){const B=y.getState();JP.onPointerDown(z.nativeEvent,{handleDomNode:z.currentTarget,autoPanOnConnect:B.autoPanOnConnect,connectionMode:B.connectionMode,connectionRadius:B.connectionRadius,domNode:B.domNode,nodeLookup:B.nodeLookup,lib:B.lib,isTarget:b,handleId:v,nodeId:S,flowId:B.rfId,panBy:B.panBy,cancelConnection:B.cancelConnection,onConnectStart:B.onConnectStart,onConnectEnd:B.onConnectEnd,updateConnection:B.updateConnection,onConnect:L,isValidConnection:r||B.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:B.autoPanSpeed,dragThreshold:B.connectionDragThreshold})}I?d?.(z):f?.(z)},M=z=>{const{onClickConnectStart:I,onClickConnectEnd:B,connectionClickStartHandle:F,connectionMode:U,isValidConnection:V,lib:K,rfId:G,nodeLookup:J,connection:ee}=y.getState();if(!S||!F&&!a)return;if(!F){I?.(z.nativeEvent,{nodeId:S,handleId:v,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:S,type:e,id:v}});return}const Y=gge(z.target),ie=r||V,{connection:fe,isValid:me}=JP.isValid(z.nativeEvent,{handle:{nodeId:S,id:v,type:e},connectionMode:U,fromNodeId:F.nodeId,fromHandleId:F.id||null,fromType:F.type,isValidConnection:ie,flowId:G,doc:Y,lib:K,nodeLookup:J});me&&fe&&L(fe);const te=structuredClone(ee);delete te.inProgress,te.toPosition=te.toHandle?te.toHandle.position:null,B?.(z,te),y.setState({connectionClickStartHandle:null})};return o.jsx("div",{"data-handleid":v,"data-nodeid":S,"data-handlepos":t,"data-id":`${k}-${S}-${v}-${e}`,className:ya(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,u,{source:!b,target:b,connectable:n,connectablestart:a,connectableend:i,clickconnecting:T,connectingfrom:j,connectingto:E,valid:$,connectionindicator:n&&(!R||O)&&(R||q?i:a)}]),onMouseDown:A,onTouchStart:A,onClick:_?M:void 0,ref:p,...m,children:c})}const Fg=w.memo(Uge(Hot));function qot({data:e,isConnectable:t,sourcePosition:r=It.Bottom}){return o.jsxs(o.Fragment,{children:[e?.label,o.jsx(Fg,{type:"source",position:r,isConnectable:t})]})}function Wot({data:e,isConnectable:t,targetPosition:r=It.Top,sourcePosition:n=It.Bottom}){return o.jsxs(o.Fragment,{children:[o.jsx(Fg,{type:"target",position:r,isConnectable:t}),e?.label,o.jsx(Fg,{type:"source",position:n,isConnectable:t})]})}function Kot(){return null}function Got({data:e,isConnectable:t,targetPosition:r=It.Top}){return o.jsxs(o.Fragment,{children:[o.jsx(Fg,{type:"target",position:r,isConnectable:t}),e?.label]})}const _C={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},$ee={input:qot,default:Wot,output:Got,group:Kot};function Vot(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Yot=e=>{const{width:t,height:r,x:n,y:a}=_1(e.nodeLookup,{filter:i=>!!i.selected});return{width:Go(t)?t:null,height:Go(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${n}px,${a}px)`}};function Qot({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=An(),{width:a,height:i,transformString:s,userSelectionActive:l}=Er(Yot,Tn),c=Wge(),u=w.useRef(null);if(w.useEffect(()=>{r||u.current?.focus({preventScroll:!0})},[r]),qge({nodeRef:u}),l||!a||!i)return null;const d=e?m=>{const p=n.getState().nodes.filter(v=>v.selected);e(m,p)}:void 0,f=m=>{Object.prototype.hasOwnProperty.call(_C,m.key)&&(m.preventDefault(),c({direction:_C[m.key],factor:m.shiftKey?4:1}))};return o.jsx("div",{className:ya(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:o.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:r?void 0:-1,onKeyDown:r?void 0:f,style:{width:a,height:i}})})}const Fee=typeof window<"u"?window:void 0,Jot=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Gge({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:a,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:l,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:d,selectionMode:f,onSelectionStart:m,onSelectionEnd:p,multiSelectionKeyCode:v,panActivationKeyCode:b,zoomActivationKeyCode:y,elementsSelectable:S,zoomOnScroll:_,zoomOnPinch:N,panOnScroll:k,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:T,panOnDrag:O,defaultViewport:R,translateExtent:q,minZoom:$,maxZoom:L,preventScrolling:A,onSelectionContextMenu:M,noWheelClassName:z,noPanClassName:I,disableKeyboardA11y:B,onViewportChange:F,isControlledViewport:U}){const{nodesSelectionActive:V,userSelectionActive:K}=Er(Jot,Tn),G=yx(u,{target:Fee}),J=yx(b,{target:Fee}),ee=J||O,Y=J||k,ie=d&&ee!==!0,fe=G||K||ie;return Aot({deleteKeyCode:c,multiSelectionKeyCode:v}),o.jsx(Oot,{onPaneContextMenu:i,elementsSelectable:S,zoomOnScroll:_,zoomOnPinch:N,panOnScroll:Y,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:T,panOnDrag:!G&&ee,defaultViewport:R,translateExtent:q,minZoom:$,maxZoom:L,zoomActivationKeyCode:y,preventScrolling:A,noWheelClassName:z,noPanClassName:I,onViewportChange:F,isControlledViewport:U,paneClickDistance:l,selectionOnDrag:ie,children:o.jsxs(zot,{onSelectionStart:m,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:a,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:ee,isSelecting:!!fe,selectionMode:f,selectionKeyPressed:G,paneClickDistance:l,selectionOnDrag:ie,children:[e,V&&o.jsx(Qot,{onSelectionContextMenu:M,noPanClassName:I,disableKeyboardA11y:B})]})})}Gge.displayName="FlowRenderer";const Zot=w.memo(Gge),Xot=e=>t=>e?WB(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function elt(e){return Er(w.useCallback(Xot(e),[e]),Tn)}const tlt=e=>e.updateNodeInternals;function rlt(){const e=Er(tlt),[t]=w.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const n=new Map;r.forEach(a=>{const i=a.target.getAttribute("data-id");n.set(i,{id:i,nodeElement:a.target,force:!0})}),e(n)}));return w.useEffect(()=>()=>{t?.disconnect()},[t]),t}function nlt({node:e,nodeType:t,hasDimensions:r,resizeObserver:n}){const a=An(),i=w.useRef(null),s=w.useRef(null),l=w.useRef(e.sourcePosition),c=w.useRef(e.targetPosition),u=w.useRef(t),d=r&&!!e.internals.handleBounds;return w.useEffect(()=>{i.current&&!e.hidden&&(!d||s.current!==i.current)&&(s.current&&n?.unobserve(s.current),n?.observe(i.current),s.current=i.current)},[d,e.hidden]),w.useEffect(()=>()=>{s.current&&(n?.unobserve(s.current),s.current=null)},[]),w.useEffect(()=>{if(i.current){const f=u.current!==t,m=l.current!==e.sourcePosition,p=c.current!==e.targetPosition;(f||m||p)&&(u.current=t,l.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function alt({id:e,onClick:t,onMouseEnter:r,onMouseMove:n,onMouseLeave:a,onContextMenu:i,onDoubleClick:s,nodesDraggable:l,elementsSelectable:c,nodesConnectable:u,nodesFocusable:d,resizeObserver:f,noDragClassName:m,noPanClassName:p,disableKeyboardA11y:v,rfId:b,nodeTypes:y,nodeClickDistance:S,onError:_}){const{node:N,internals:k,isParent:j}=Er(me=>{const te=me.nodeLookup.get(e),oe=me.parentLookup.has(e);return{node:te,internals:te.internals,isParent:oe}},Tn);let E=N.type||"default",T=y?.[E]||$ee[E];T===void 0&&(_?.("003",$l.error003(E)),E="default",T=y?.default||$ee.default);const O=!!(N.draggable||l&&typeof N.draggable>"u"),R=!!(N.selectable||c&&typeof N.selectable>"u"),q=!!(N.connectable||u&&typeof N.connectable>"u"),$=!!(N.focusable||d&&typeof N.focusable>"u"),L=An(),A=mge(N),M=nlt({node:N,nodeType:E,hasDimensions:A,resizeObserver:f}),z=qge({nodeRef:M,disabled:N.hidden||!O,noDragClassName:m,handleSelector:N.dragHandle,nodeId:e,isSelectable:R,nodeClickDistance:S}),I=Wge();if(N.hidden)return null;const B=yu(N),F=Vot(N),U=R||O||t||r||n||a,V=r?me=>r(me,{...k.userNode}):void 0,K=n?me=>n(me,{...k.userNode}):void 0,G=a?me=>a(me,{...k.userNode}):void 0,J=i?me=>i(me,{...k.userNode}):void 0,ee=s?me=>s(me,{...k.userNode}):void 0,Y=me=>{const{selectNodesOnDrag:te,nodeDragThreshold:oe}=L.getState();R&&(!te||!O||oe>0)&&ZP({id:e,store:L,nodeRef:M}),t&&t(me,{...k.userNode})},ie=me=>{if(!(vge(me.nativeEvent)||v)){if(ige.includes(me.key)&&R){const te=me.key==="Escape";ZP({id:e,store:L,unselect:te,nodeRef:M})}else if(O&&N.selected&&Object.prototype.hasOwnProperty.call(_C,me.key)){me.preventDefault();const{ariaLabelConfig:te}=L.getState();L.setState({ariaLiveMessage:te["node.a11yDescription.ariaLiveMessage"]({direction:me.key.replace("Arrow","").toLowerCase(),x:~~k.positionAbsolute.x,y:~~k.positionAbsolute.y})}),I({direction:_C[me.key],factor:me.shiftKey?4:1})}}},fe=()=>{if(v||!M.current?.matches(":focus-visible"))return;const{transform:me,width:te,height:oe,autoPanOnNodeFocus:ce,setCenter:Z}=L.getState();if(!ce)return;WB(new Map([[e,N]]),{x:0,y:0,width:te,height:oe},me,!0).length>0||Z(N.position.x+B.width/2,N.position.y+B.height/2,{zoom:me[2]})};return o.jsx("div",{className:ya(["react-flow__node",`react-flow__node-${E}`,{[p]:O},N.className,{selected:N.selected,selectable:R,parent:j,draggable:O,dragging:z}]),ref:M,style:{zIndex:k.z,transform:`translate(${k.positionAbsolute.x}px,${k.positionAbsolute.y}px)`,pointerEvents:U?"all":"none",visibility:A?"visible":"hidden",...N.style,...F},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:K,onMouseLeave:G,onContextMenu:J,onClick:Y,onDoubleClick:ee,onKeyDown:$?ie:void 0,tabIndex:$?0:void 0,onFocus:$?fe:void 0,role:N.ariaRole??($?"group":void 0),"aria-roledescription":"node","aria-describedby":v?void 0:`${Rge}-${b}`,"aria-label":N.ariaLabel,...N.domAttributes,children:o.jsx($ot,{value:e,children:o.jsx(T,{id:e,data:N.data,type:E,positionAbsoluteX:k.positionAbsolute.x,positionAbsoluteY:k.positionAbsolute.y,selected:N.selected??!1,selectable:R,draggable:O,deletable:N.deletable??!0,isConnectable:q,sourcePosition:N.sourcePosition,targetPosition:N.targetPosition,dragging:z,dragHandle:N.dragHandle,zIndex:k.z,parentId:N.parentId,...B})})})}var ilt=w.memo(alt);const slt=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Vge(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:a,onError:i}=Er(slt,Tn),s=elt(e.onlyRenderVisibleElements),l=rlt();return o.jsx("div",{className:"react-flow__nodes",style:U2,children:s.map(c=>o.jsx(ilt,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:l,nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:i},c))})}Vge.displayName="NodeRenderer";const olt=w.memo(Vge);function llt(e){return Er(w.useCallback(r=>{if(!e)return r.edges.map(a=>a.id);const n=[];if(r.width&&r.height)for(const a of r.edges){const i=r.nodeLookup.get(a.source),s=r.nodeLookup.get(a.target);i&&s&&fst({sourceNode:i,targetNode:s,width:r.width,height:r.height,transform:r.transform})&&n.push(a.id)}return n},[e]),Tn)}const clt=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e}};return o.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},ult=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e,fill:e}};return o.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Uee={[wC.Arrow]:clt,[wC.ArrowClosed]:ult};function dlt(e){const t=An();return w.useMemo(()=>Object.prototype.hasOwnProperty.call(Uee,e)?Uee[e]:(t.getState().onError?.("009",$l.error009(e)),null),[e])}const flt=({id:e,type:t,color:r,width:n=12.5,height:a=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:l="auto-start-reverse"})=>{const c=dlt(t);return c?o.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0",children:o.jsx(c,{color:r,strokeWidth:s})}):null},Yge=({defaultColor:e,rfId:t})=>{const r=Er(i=>i.edges),n=Er(i=>i.defaultEdgeOptions),a=w.useMemo(()=>xst(r,{id:t,defaultColor:e,defaultMarkerStart:n?.markerStart,defaultMarkerEnd:n?.markerEnd}),[r,n,t,e]);return a.length?o.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:o.jsx("defs",{children:a.map(i=>o.jsx(flt,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Yge.displayName="MarkerDefinitions";var hlt=w.memo(Yge);function Qge({x:e,y:t,label:r,labelStyle:n,labelShowBg:a=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:l=2,children:c,className:u,...d}){const[f,m]=w.useState({x:1,y:0,width:0,height:0}),p=ya(["react-flow__edge-textwrapper",u]),v=w.useRef(null);return w.useEffect(()=>{if(v.current){const b=v.current.getBBox();m({x:b.x,y:b.y,width:b.width,height:b.height})}},[r]),r?o.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:p,visibility:f.width?"visible":"hidden",...d,children:[a&&o.jsx("rect",{width:f.width+2*s[0],x:-s[0],y:-s[1],height:f.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),o.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:v,style:n,children:r}),c]}):null}Qge.displayName="EdgeText";const mlt=w.memo(Qge);function H2({path:e,labelX:t,labelY:r,label:n,labelStyle:a,labelShowBg:i,labelBgStyle:s,labelBgPadding:l,labelBgBorderRadius:c,interactionWidth:u=20,...d}){return o.jsxs(o.Fragment,{children:[o.jsx("path",{...d,d:e,fill:"none",className:ya(["react-flow__edge-path",d.className])}),u?o.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,n&&Go(t)&&Go(r)?o.jsx(mlt,{x:t,y:r,label:n,labelStyle:a,labelShowBg:i,labelBgStyle:s,labelBgPadding:l,labelBgBorderRadius:c}):null]})}function Hee({pos:e,x1:t,y1:r,x2:n,y2:a}){return e===It.Left||e===It.Right?[.5*(t+n),r]:[t,.5*(r+a)]}function Jge({sourceX:e,sourceY:t,sourcePosition:r=It.Bottom,targetX:n,targetY:a,targetPosition:i=It.Top}){const[s,l]=Hee({pos:r,x1:e,y1:t,x2:n,y2:a}),[c,u]=Hee({pos:i,x1:n,y1:a,x2:e,y2:t}),[d,f,m,p]=yge({sourceX:e,sourceY:t,targetX:n,targetY:a,sourceControlX:s,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${s},${l} ${c},${u} ${n},${a}`,d,f,m,p]}function Zge(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:i,sourcePosition:s,targetPosition:l,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,interactionWidth:S})=>{const[_,N,k]=Jge({sourceX:r,sourceY:n,sourcePosition:s,targetX:a,targetY:i,targetPosition:l}),j=e.isInternal?void 0:t;return o.jsx(H2,{id:j,path:_,labelX:N,labelY:k,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,interactionWidth:S})})}const plt=Zge({isInternal:!1}),Xge=Zge({isInternal:!0});plt.displayName="SimpleBezierEdge";Xge.displayName="SimpleBezierEdgeInternal";function e0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:i,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,sourcePosition:p=It.Bottom,targetPosition:v=It.Top,markerEnd:b,markerStart:y,pathOptions:S,interactionWidth:_})=>{const[N,k,j]=VP({sourceX:r,sourceY:n,sourcePosition:p,targetX:a,targetY:i,targetPosition:v,borderRadius:S?.borderRadius,offset:S?.offset,stepPosition:S?.stepPosition}),E=e.isInternal?void 0:t;return o.jsx(H2,{id:E,path:N,labelX:k,labelY:j,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:b,markerStart:y,interactionWidth:_})})}const t0e=e0e({isInternal:!1}),r0e=e0e({isInternal:!0});t0e.displayName="SmoothStepEdge";r0e.displayName="SmoothStepEdgeInternal";function n0e(e){return w.memo(({id:t,...r})=>{const n=e.isInternal?void 0:t;return o.jsx(t0e,{...r,id:n,pathOptions:w.useMemo(()=>({borderRadius:0,offset:r.pathOptions?.offset}),[r.pathOptions?.offset])})})}const glt=n0e({isInternal:!1}),a0e=n0e({isInternal:!0});glt.displayName="StepEdge";a0e.displayName="StepEdgeInternal";function i0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:i,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:p,markerStart:v,interactionWidth:b})=>{const[y,S,_]=Sge({sourceX:r,sourceY:n,targetX:a,targetY:i}),N=e.isInternal?void 0:t;return o.jsx(H2,{id:N,path:y,labelX:S,labelY:_,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:p,markerStart:v,interactionWidth:b})})}const vlt=i0e({isInternal:!1}),s0e=i0e({isInternal:!0});vlt.displayName="StraightEdge";s0e.displayName="StraightEdgeInternal";function o0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:i,sourcePosition:s=It.Bottom,targetPosition:l=It.Top,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,pathOptions:S,interactionWidth:_})=>{const[N,k,j]=xge({sourceX:r,sourceY:n,sourcePosition:s,targetX:a,targetY:i,targetPosition:l,curvature:S?.curvature}),E=e.isInternal?void 0:t;return o.jsx(H2,{id:E,path:N,labelX:k,labelY:j,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,interactionWidth:_})})}const blt=o0e({isInternal:!1}),l0e=o0e({isInternal:!0});blt.displayName="BezierEdge";l0e.displayName="BezierEdgeInternal";const qee={default:l0e,straight:s0e,step:a0e,smoothstep:r0e,simplebezier:Xge},Wee={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},ylt=(e,t,r)=>r===It.Left?e-t:r===It.Right?e+t:e,xlt=(e,t,r)=>r===It.Top?e-t:r===It.Bottom?e+t:e,Kee="react-flow__edgeupdater";function Gee({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:a,onMouseEnter:i,onMouseOut:s,type:l}){return o.jsx("circle",{onMouseDown:a,onMouseEnter:i,onMouseOut:s,className:ya([Kee,`${Kee}-${l}`]),cx:ylt(t,n,e),cy:xlt(r,n,e),r:n,stroke:"transparent",fill:"transparent"})}function wlt({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:n,sourceY:a,targetX:i,targetY:s,sourcePosition:l,targetPosition:c,onReconnect:u,onReconnectStart:d,onReconnectEnd:f,setReconnecting:m,setUpdateHover:p}){const v=An(),b=(k,j)=>{if(k.button!==0)return;const{autoPanOnConnect:E,domNode:T,isValidConnection:O,connectionMode:R,connectionRadius:q,lib:$,onConnectStart:L,onConnectEnd:A,cancelConnection:M,nodeLookup:z,rfId:I,panBy:B,updateConnection:F}=v.getState(),U=j.type==="target",V=(J,ee)=>{m(!1),f?.(J,r,j.type,ee)},K=J=>u?.(r,J),G=(J,ee)=>{m(!0),d?.(k,r,j.type),L?.(J,ee)};JP.onPointerDown(k.nativeEvent,{autoPanOnConnect:E,connectionMode:R,connectionRadius:q,domNode:T,handleId:j.id,nodeId:j.nodeId,nodeLookup:z,isTarget:U,edgeUpdaterType:j.type,lib:$,flowId:I,cancelConnection:M,panBy:B,isValidConnection:O,onConnect:K,onConnectStart:G,onConnectEnd:A,onReconnectEnd:V,updateConnection:F,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,dragThreshold:v.getState().connectionDragThreshold,handleDomNode:k.currentTarget})},y=k=>b(k,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),S=k=>b(k,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),_=()=>p(!0),N=()=>p(!1);return o.jsxs(o.Fragment,{children:[(e===!0||e==="source")&&o.jsx(Gee,{position:l,centerX:n,centerY:a,radius:t,onMouseDown:y,onMouseEnter:_,onMouseOut:N,type:"source"}),(e===!0||e==="target")&&o.jsx(Gee,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:S,onMouseEnter:_,onMouseOut:N,type:"target"})]})}function Slt({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:n,onClick:a,onDoubleClick:i,onContextMenu:s,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,reconnectRadius:d,onReconnect:f,onReconnectStart:m,onReconnectEnd:p,rfId:v,edgeTypes:b,noPanClassName:y,onError:S,disableKeyboardA11y:_}){let N=Er(Z=>Z.edgeLookup.get(e));const k=Er(Z=>Z.defaultEdgeOptions);N=k?{...k,...N}:N;let j=N.type||"default",E=b?.[j]||qee[j];E===void 0&&(S?.("011",$l.error011(j)),j="default",E=b?.default||qee.default);const T=!!(N.focusable||t&&typeof N.focusable>"u"),O=typeof f<"u"&&(N.reconnectable||r&&typeof N.reconnectable>"u"),R=!!(N.selectable||n&&typeof N.selectable>"u"),q=w.useRef(null),[$,L]=w.useState(!1),[A,M]=w.useState(!1),z=An(),{zIndex:I,sourceX:B,sourceY:F,targetX:U,targetY:V,sourcePosition:K,targetPosition:G}=Er(w.useCallback(Z=>{const ue=Z.nodeLookup.get(N.source),H=Z.nodeLookup.get(N.target);if(!ue||!H)return{zIndex:N.zIndex,...Wee};const ge=yst({id:e,sourceNode:ue,targetNode:H,sourceHandle:N.sourceHandle||null,targetHandle:N.targetHandle||null,connectionMode:Z.connectionMode,onError:S});return{zIndex:dst({selected:N.selected,zIndex:N.zIndex,sourceNode:ue,targetNode:H,elevateOnSelect:Z.elevateEdgesOnSelect,zIndexMode:Z.zIndexMode}),...ge||Wee}},[N.source,N.target,N.sourceHandle,N.targetHandle,N.selected,N.zIndex]),Tn),J=w.useMemo(()=>N.markerStart?`url('#${YP(N.markerStart,v)}')`:void 0,[N.markerStart,v]),ee=w.useMemo(()=>N.markerEnd?`url('#${YP(N.markerEnd,v)}')`:void 0,[N.markerEnd,v]);if(N.hidden||B===null||F===null||U===null||V===null)return null;const Y=Z=>{const{addSelectedEdges:ue,unselectNodesAndEdges:H,multiSelectionActive:ge}=z.getState();R&&(z.setState({nodesSelectionActive:!1}),N.selected&&ge?(H({nodes:[],edges:[N]}),q.current?.blur()):ue([e])),a&&a(Z,N)},ie=i?Z=>{i(Z,{...N})}:void 0,fe=s?Z=>{s(Z,{...N})}:void 0,me=l?Z=>{l(Z,{...N})}:void 0,te=c?Z=>{c(Z,{...N})}:void 0,oe=u?Z=>{u(Z,{...N})}:void 0,ce=Z=>{if(!_&&ige.includes(Z.key)&&R){const{unselectNodesAndEdges:ue,addSelectedEdges:H}=z.getState();Z.key==="Escape"?(q.current?.blur(),ue({edges:[N]})):H([e])}};return o.jsx("svg",{style:{zIndex:I},children:o.jsxs("g",{className:ya(["react-flow__edge",`react-flow__edge-${j}`,N.className,y,{selected:N.selected,animated:N.animated,inactive:!R&&!a,updating:$,selectable:R}]),onClick:Y,onDoubleClick:ie,onContextMenu:fe,onMouseEnter:me,onMouseMove:te,onMouseLeave:oe,onKeyDown:T?ce:void 0,tabIndex:T?0:void 0,role:N.ariaRole??(T?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":N.ariaLabel===null?void 0:N.ariaLabel||`Edge from ${N.source} to ${N.target}`,"aria-describedby":T?`${Pge}-${v}`:void 0,ref:q,...N.domAttributes,children:[!A&&o.jsx(E,{id:e,source:N.source,target:N.target,type:N.type,selected:N.selected,animated:N.animated,selectable:R,deletable:N.deletable??!0,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,sourceX:B,sourceY:F,targetX:U,targetY:V,sourcePosition:K,targetPosition:G,data:N.data,style:N.style,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerStart:J,markerEnd:ee,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth}),O&&o.jsx(wlt,{edge:N,isReconnectable:O,reconnectRadius:d,onReconnect:f,onReconnectStart:m,onReconnectEnd:p,sourceX:B,sourceY:F,targetX:U,targetY:V,sourcePosition:K,targetPosition:G,setUpdateHover:L,setReconnecting:M})]})})}var klt=w.memo(Slt);const _lt=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function c0e({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:n,noPanClassName:a,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:m,onReconnectStart:p,onReconnectEnd:v,disableKeyboardA11y:b}){const{edgesFocusable:y,edgesReconnectable:S,elementsSelectable:_,onError:N}=Er(_lt,Tn),k=llt(t);return o.jsxs("div",{className:"react-flow__edges",children:[o.jsx(hlt,{defaultColor:e,rfId:r}),k.map(j=>o.jsx(klt,{id:j,edgesFocusable:y,edgesReconnectable:S,elementsSelectable:_,noPanClassName:a,onReconnect:i,onContextMenu:s,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,onClick:d,reconnectRadius:f,onDoubleClick:m,onReconnectStart:p,onReconnectEnd:v,rfId:r,onError:N,edgeTypes:n,disableKeyboardA11y:b},j))]})}c0e.displayName="EdgeRenderer";const Nlt=w.memo(c0e),Clt=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function jlt({children:e}){const t=Er(Clt);return o.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Elt(e){const t=XB(),r=w.useRef(!1);w.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const Mlt=e=>e.panZoom?.syncViewport;function Tlt(e){const t=Er(Mlt),r=An();return w.useEffect(()=>{e&&(t?.(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Alt(e){return e.connection.inProgress?{...e.connection,to:C1(e.connection.to,e.transform)}:{...e.connection}}function Dlt(e){return Alt}function Llt(e){const t=Dlt();return Er(t,Tn)}const Olt=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ilt({containerStyle:e,style:t,type:r,component:n}){const{nodesConnectable:a,width:i,height:s,isValid:l,inProgress:c}=Er(Olt,Tn);return!(i&&a&&c)?null:o.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:o.jsx("g",{className:ya(["react-flow__connection",lge(l)]),children:o.jsx(u0e,{style:t,type:r,CustomComponent:n,isValid:l})})})}const u0e=({style:e,type:t=hd.Bezier,CustomComponent:r,isValid:n})=>{const{inProgress:a,from:i,fromNode:s,fromHandle:l,fromPosition:c,to:u,toNode:d,toHandle:f,toPosition:m,pointer:p}=Llt();if(!a)return;if(r)return o.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:l,fromX:i.x,fromY:i.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:m,connectionStatus:lge(n),toNode:d,toHandle:f,pointer:p});let v="";const b={sourceX:i.x,sourceY:i.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:m};switch(t){case hd.Bezier:[v]=xge(b);break;case hd.SimpleBezier:[v]=Jge(b);break;case hd.Step:[v]=VP({...b,borderRadius:0});break;case hd.SmoothStep:[v]=VP(b);break;default:[v]=Sge(b)}return o.jsx("path",{d:v,fill:"none",className:"react-flow__connection-path",style:e})};u0e.displayName="ConnectionLine";const Rlt={};function Vee(e=Rlt){w.useRef(e),An(),w.useEffect(()=>{},[e])}function Plt(){An(),w.useRef(!1),w.useEffect(()=>{},[])}function d0e({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:n,onEdgeClick:a,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:l,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:m,onSelectionEnd:p,connectionLineType:v,connectionLineStyle:b,connectionLineComponent:y,connectionLineContainerStyle:S,selectionKeyCode:_,selectionOnDrag:N,selectionMode:k,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:T,deleteKeyCode:O,onlyRenderVisibleElements:R,elementsSelectable:q,defaultViewport:$,translateExtent:L,minZoom:A,maxZoom:M,preventScrolling:z,defaultMarkerColor:I,zoomOnScroll:B,zoomOnPinch:F,panOnScroll:U,panOnScrollSpeed:V,panOnScrollMode:K,zoomOnDoubleClick:G,panOnDrag:J,onPaneClick:ee,onPaneMouseEnter:Y,onPaneMouseMove:ie,onPaneMouseLeave:fe,onPaneScroll:me,onPaneContextMenu:te,paneClickDistance:oe,nodeClickDistance:ce,onEdgeContextMenu:Z,onEdgeMouseEnter:ue,onEdgeMouseMove:H,onEdgeMouseLeave:ge,reconnectRadius:de,onReconnect:re,onReconnectStart:ne,onReconnectEnd:pe,noDragClassName:ke,noWheelClassName:we,noPanClassName:ve,disableKeyboardA11y:Le,nodeExtent:Ae,rfId:Re,viewport:Ye,onViewportChange:mt}){return Vee(e),Vee(t),Plt(),Elt(r),Tlt(Ye),o.jsx(Zot,{onPaneClick:ee,onPaneMouseEnter:Y,onPaneMouseMove:ie,onPaneMouseLeave:fe,onPaneContextMenu:te,onPaneScroll:me,paneClickDistance:oe,deleteKeyCode:O,selectionKeyCode:_,selectionOnDrag:N,selectionMode:k,onSelectionStart:m,onSelectionEnd:p,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:T,elementsSelectable:q,zoomOnScroll:B,zoomOnPinch:F,zoomOnDoubleClick:G,panOnScroll:U,panOnScrollSpeed:V,panOnScrollMode:K,panOnDrag:J,defaultViewport:$,translateExtent:L,minZoom:A,maxZoom:M,onSelectionContextMenu:f,preventScrolling:z,noDragClassName:ke,noWheelClassName:we,noPanClassName:ve,disableKeyboardA11y:Le,onViewportChange:mt,isControlledViewport:!!Ye,children:o.jsxs(jlt,{children:[o.jsx(Nlt,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:s,onReconnect:re,onReconnectStart:ne,onReconnectEnd:pe,onlyRenderVisibleElements:R,onEdgeContextMenu:Z,onEdgeMouseEnter:ue,onEdgeMouseMove:H,onEdgeMouseLeave:ge,reconnectRadius:de,defaultMarkerColor:I,noPanClassName:ve,disableKeyboardA11y:Le,rfId:Re}),o.jsx(Ilt,{style:b,type:v,component:y,containerStyle:S}),o.jsx("div",{className:"react-flow__edgelabel-renderer"}),o.jsx(olt,{nodeTypes:e,onNodeClick:n,onNodeDoubleClick:i,onNodeMouseEnter:l,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,nodeClickDistance:ce,onlyRenderVisibleElements:R,noPanClassName:ve,noDragClassName:ke,disableKeyboardA11y:Le,nodeExtent:Ae,rfId:Re}),o.jsx("div",{className:"react-flow__viewport-portal"})]})})}d0e.displayName="GraphView";const zlt=w.memo(d0e),Yee=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:a,height:i,fitView:s,fitViewOptions:l,minZoom:c=.5,maxZoom:u=2,nodeOrigin:d,nodeExtent:f,zIndexMode:m="basic"}={})=>{const p=new Map,v=new Map,b=new Map,y=new Map,S=n??t??[],_=r??e??[],N=d??[0,0],k=f??px;Nge(b,y,S);const j=QP(_,p,v,{nodeOrigin:N,nodeExtent:k,zIndexMode:m});let E=[0,0,1];if(s&&a&&i){const T=_1(p,{filter:$=>!!(($.width||$.initialWidth)&&($.height||$.initialHeight))}),{x:O,y:R,zoom:q}=KB(T,a,i,c,u,l?.padding??.1);E=[O,R,q]}return{rfId:"1",width:a??0,height:i??0,transform:E,nodes:_,nodesInitialized:j,nodeLookup:p,parentLookup:v,edges:S,edgeLookup:y,connectionLookup:b,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:n!==void 0,panZoom:null,minZoom:c,maxZoom:u,translateExtent:px,nodeExtent:k,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Rg.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:l,fitViewResolver:null,connection:{...oge},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:ist,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:sge,zIndexMode:m,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Blt=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:a,height:i,fitView:s,fitViewOptions:l,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:f,zIndexMode:m})=>not((p,v)=>{async function b(){const{nodeLookup:y,panZoom:S,fitViewOptions:_,fitViewResolver:N,width:k,height:j,minZoom:E,maxZoom:T}=v();S&&(await nst({nodes:y,width:k,height:j,panZoom:S,minZoom:E,maxZoom:T},_),N?.resolve(!0),p({fitViewResolver:null}))}return{...Yee({nodes:e,edges:t,width:a,height:i,fitView:s,fitViewOptions:l,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:f,defaultNodes:r,defaultEdges:n,zIndexMode:m}),setNodes:y=>{const{nodeLookup:S,parentLookup:_,nodeOrigin:N,elevateNodesOnSelect:k,fitViewQueued:j,zIndexMode:E}=v(),T=QP(y,S,_,{nodeOrigin:N,nodeExtent:f,elevateNodesOnSelect:k,checkEquality:!0,zIndexMode:E});j&&T?(b(),p({nodes:y,nodesInitialized:T,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:y,nodesInitialized:T})},setEdges:y=>{const{connectionLookup:S,edgeLookup:_}=v();Nge(S,_,y),p({edges:y})},setDefaultNodesAndEdges:(y,S)=>{if(y){const{setNodes:_}=v();_(y),p({hasDefaultNodes:!0})}if(S){const{setEdges:_}=v();_(S),p({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:S,nodeLookup:_,parentLookup:N,domNode:k,nodeOrigin:j,nodeExtent:E,debug:T,fitViewQueued:O,zIndexMode:R}=v(),{changes:q,updatedInternals:$}=jst(y,_,N,k,j,E,R);$&&(kst(_,N,{nodeOrigin:j,nodeExtent:E,zIndexMode:R}),O?(b(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),q?.length>0&&(T&&console.log("React Flow: trigger node changes",q),S?.(q)))},updateNodePositions:(y,S=!1)=>{const _=[];let N=[];const{nodeLookup:k,triggerNodeChanges:j,connection:E,updateConnection:T,onNodesChangeMiddlewareMap:O}=v();for(const[R,q]of y){const $=k.get(R),L=!!($?.expandParent&&$?.parentId&&q?.position),A={id:R,type:"position",position:L?{x:Math.max(0,q.position.x),y:Math.max(0,q.position.y)}:q.position,dragging:S};if($&&E.inProgress&&E.fromNode.id===$.id){const M=Ph($,E.fromHandle,It.Left,!0);T({...E,from:M})}L&&$.parentId&&_.push({id:R,parentId:$.parentId,rect:{...q.internals.positionAbsolute,width:q.measured.width??0,height:q.measured.height??0}}),N.push(A)}if(_.length>0){const{parentLookup:R,nodeOrigin:q}=v(),$=ZB(_,k,R,q);N.push(...$)}for(const R of O.values())N=R(N);j(N)},triggerNodeChanges:y=>{const{onNodesChange:S,setNodes:_,nodes:N,hasDefaultNodes:k,debug:j}=v();if(y?.length){if(k){const E=$ge(y,N);_(E)}j&&console.log("React Flow: trigger node changes",y),S?.(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:S,setEdges:_,edges:N,hasDefaultEdges:k,debug:j}=v();if(y?.length){if(k){const E=Fge(y,N);_(E)}j&&console.log("React Flow: trigger edge changes",y),S?.(y)}},addSelectedNodes:y=>{const{multiSelectionActive:S,edgeLookup:_,nodeLookup:N,triggerNodeChanges:k,triggerEdgeChanges:j}=v();if(S){const E=y.map(T=>$f(T,!0));k(E);return}k(Dp(N,new Set([...y]),!0)),j(Dp(_))},addSelectedEdges:y=>{const{multiSelectionActive:S,edgeLookup:_,nodeLookup:N,triggerNodeChanges:k,triggerEdgeChanges:j}=v();if(S){const E=y.map(T=>$f(T,!0));j(E);return}j(Dp(_,new Set([...y]))),k(Dp(N,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:S}={})=>{const{edges:_,nodes:N,nodeLookup:k,triggerNodeChanges:j,triggerEdgeChanges:E}=v(),T=y||N,O=S||_,R=T.map($=>{const L=k.get($.id);return L&&(L.selected=!1),$f($.id,!1)}),q=O.map($=>$f($.id,!1));j(R),E(q)},setMinZoom:y=>{const{panZoom:S,maxZoom:_}=v();S?.setScaleExtent([y,_]),p({minZoom:y})},setMaxZoom:y=>{const{panZoom:S,minZoom:_}=v();S?.setScaleExtent([_,y]),p({maxZoom:y})},setTranslateExtent:y=>{v().panZoom?.setTranslateExtent(y),p({translateExtent:y})},resetSelectedElements:()=>{const{edges:y,nodes:S,triggerNodeChanges:_,triggerEdgeChanges:N,elementsSelectable:k}=v();if(!k)return;const j=S.reduce((T,O)=>O.selected?[...T,$f(O.id,!1)]:T,[]),E=y.reduce((T,O)=>O.selected?[...T,$f(O.id,!1)]:T,[]);_(j),N(E)},setNodeExtent:y=>{const{nodes:S,nodeLookup:_,parentLookup:N,nodeOrigin:k,elevateNodesOnSelect:j,nodeExtent:E,zIndexMode:T}=v();y[0][0]===E[0][0]&&y[0][1]===E[0][1]&&y[1][0]===E[1][0]&&y[1][1]===E[1][1]||(QP(S,_,N,{nodeOrigin:k,nodeExtent:y,elevateNodesOnSelect:j,checkEquality:!1,zIndexMode:T}),p({nodeExtent:y}))},panBy:y=>{const{transform:S,width:_,height:N,panZoom:k,translateExtent:j}=v();return Est({delta:y,panZoom:k,transform:S,translateExtent:j,width:_,height:N})},setCenter:async(y,S,_)=>{const{width:N,height:k,maxZoom:j,panZoom:E}=v();if(!E)return Promise.resolve(!1);const T=typeof _?.zoom<"u"?_.zoom:j;return await E.setViewport({x:N/2-y*T,y:k/2-S*T,zoom:T},{duration:_?.duration,ease:_?.ease,interpolate:_?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...oge}})},updateConnection:y=>{p({connection:y})},reset:()=>p({...Yee()})}},Object.is);function $lt({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:n,initialWidth:a,initialHeight:i,initialMinZoom:s,initialMaxZoom:l,initialFitViewOptions:c,fitView:u,nodeOrigin:d,nodeExtent:f,zIndexMode:m,children:p}){const[v]=w.useState(()=>Blt({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:a,height:i,fitView:u,minZoom:s,maxZoom:l,fitViewOptions:c,nodeOrigin:d,nodeExtent:f,zIndexMode:m}));return o.jsx(aot,{value:v,children:o.jsx(jot,{children:p})})}function Flt({children:e,nodes:t,edges:r,defaultNodes:n,defaultEdges:a,width:i,height:s,fitView:l,fitViewOptions:c,minZoom:u,maxZoom:d,nodeOrigin:f,nodeExtent:m,zIndexMode:p}){return w.useContext($2)?o.jsx(o.Fragment,{children:e}):o.jsx($lt,{initialNodes:t,initialEdges:r,defaultNodes:n,defaultEdges:a,initialWidth:i,initialHeight:s,fitView:l,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:d,nodeOrigin:f,nodeExtent:m,zIndexMode:p,children:e})}const Ult={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Hlt({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:a,nodeTypes:i,edgeTypes:s,onNodeClick:l,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:m,onConnect:p,onConnectStart:v,onConnectEnd:b,onClickConnectStart:y,onClickConnectEnd:S,onNodeMouseEnter:_,onNodeMouseMove:N,onNodeMouseLeave:k,onNodeContextMenu:j,onNodeDoubleClick:E,onNodeDragStart:T,onNodeDrag:O,onNodeDragStop:R,onNodesDelete:q,onEdgesDelete:$,onDelete:L,onSelectionChange:A,onSelectionDragStart:M,onSelectionDrag:z,onSelectionDragStop:I,onSelectionContextMenu:B,onSelectionStart:F,onSelectionEnd:U,onBeforeDelete:V,connectionMode:K,connectionLineType:G=hd.Bezier,connectionLineStyle:J,connectionLineComponent:ee,connectionLineContainerStyle:Y,deleteKeyCode:ie="Backspace",selectionKeyCode:fe="Shift",selectionOnDrag:me=!1,selectionMode:te=gx.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:ce=bx()?"Meta":"Control",zoomActivationKeyCode:Z=bx()?"Meta":"Control",snapToGrid:ue,snapGrid:H,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:de,nodesDraggable:re,autoPanOnNodeFocus:ne,nodesConnectable:pe,nodesFocusable:ke,nodeOrigin:we=zge,edgesFocusable:ve,edgesReconnectable:Le,elementsSelectable:Ae=!0,defaultViewport:Re=vot,minZoom:Ye=.5,maxZoom:mt=2,translateExtent:ot=px,preventScrolling:Ot=!0,nodeExtent:rt,defaultMarkerColor:ze="#b1b1b7",zoomOnScroll:bt=!0,zoomOnPinch:tt=!0,panOnScroll:_e=!1,panOnScrollSpeed:We=.5,panOnScrollMode:Ve=fh.Free,zoomOnDoubleClick:Mt=!0,panOnDrag:kt=!0,onPaneClick:er,onPaneMouseEnter:mr,onPaneMouseMove:Zt,onPaneMouseLeave:Wt,onPaneScroll:Rt,onPaneContextMenu:he,paneClickDistance:De=1,nodeClickDistance:Ue=0,children:ut,onReconnect:St,onReconnectStart:jt,onReconnectEnd:Je,onEdgeContextMenu:Xe,onEdgeDoubleClick:it,onEdgeMouseEnter:Xt,onEdgeMouseMove:X,onEdgeMouseLeave:Oe,reconnectRadius:Ke=10,onNodesChange:be,onEdgesChange:W,noDragClassName:se="nodrag",noWheelClassName:xe="nowheel",noPanClassName:Ce="nopan",fitView:dt,fitViewOptions:st,connectOnClick:Tt,attributionPosition:Ft,proOptions:lt,defaultEdgeOptions:Pt,elevateNodesOnSelect:ct=!0,elevateEdgesOnSelect:Ht=!1,disableKeyboardA11y:rr=!1,autoPanOnConnect:Dr,autoPanOnNodeDrag:vn,autoPanSpeed:gm,connectionRadius:Kl,isValidConnection:Mo,onError:Qe,style:Et,id:sr,nodeDragThreshold:Br,connectionDragThreshold:On,viewport:Aa,onViewportChange:ki,width:di,height:nn,colorMode:_i="light",debug:vm,onScroll:Gl,ariaLabelConfig:Yd,zIndexMode:Vl="basic",...C0},fi){const Yl=sr||"1",Ql=wot(_i),wu=w.useCallback(aa=>{aa.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Gl?.(aa)},[Gl]);return o.jsx("div",{"data-testid":"rf__wrapper",...C0,onScroll:wu,style:{...Et,...Ult},ref:fi,className:ya(["react-flow",a,Ql]),id:sr,role:"application",children:o.jsxs(Flt,{nodes:e,edges:t,width:di,height:nn,fitView:dt,fitViewOptions:st,minZoom:Ye,maxZoom:mt,nodeOrigin:we,nodeExtent:rt,zIndexMode:Vl,children:[o.jsx(zlt,{onInit:u,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:_,onNodeMouseMove:N,onNodeMouseLeave:k,onNodeContextMenu:j,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:s,connectionLineType:G,connectionLineStyle:J,connectionLineComponent:ee,connectionLineContainerStyle:Y,selectionKeyCode:fe,selectionOnDrag:me,selectionMode:te,deleteKeyCode:ie,multiSelectionKeyCode:ce,panActivationKeyCode:oe,zoomActivationKeyCode:Z,onlyRenderVisibleElements:ge,defaultViewport:Re,translateExtent:ot,minZoom:Ye,maxZoom:mt,preventScrolling:Ot,zoomOnScroll:bt,zoomOnPinch:tt,zoomOnDoubleClick:Mt,panOnScroll:_e,panOnScrollSpeed:We,panOnScrollMode:Ve,panOnDrag:kt,onPaneClick:er,onPaneMouseEnter:mr,onPaneMouseMove:Zt,onPaneMouseLeave:Wt,onPaneScroll:Rt,onPaneContextMenu:he,paneClickDistance:De,nodeClickDistance:Ue,onSelectionContextMenu:B,onSelectionStart:F,onSelectionEnd:U,onReconnect:St,onReconnectStart:jt,onReconnectEnd:Je,onEdgeContextMenu:Xe,onEdgeDoubleClick:it,onEdgeMouseEnter:Xt,onEdgeMouseMove:X,onEdgeMouseLeave:Oe,reconnectRadius:Ke,defaultMarkerColor:ze,noDragClassName:se,noWheelClassName:xe,noPanClassName:Ce,rfId:Yl,disableKeyboardA11y:rr,nodeExtent:rt,viewport:Aa,onViewportChange:ki}),o.jsx(xot,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:p,onConnectStart:v,onConnectEnd:b,onClickConnectStart:y,onClickConnectEnd:S,nodesDraggable:re,autoPanOnNodeFocus:ne,nodesConnectable:pe,nodesFocusable:ke,edgesFocusable:ve,edgesReconnectable:Le,elementsSelectable:Ae,elevateNodesOnSelect:ct,elevateEdgesOnSelect:Ht,minZoom:Ye,maxZoom:mt,nodeExtent:rt,onNodesChange:be,onEdgesChange:W,snapToGrid:ue,snapGrid:H,connectionMode:K,translateExtent:ot,connectOnClick:Tt,defaultEdgeOptions:Pt,fitView:dt,fitViewOptions:st,onNodesDelete:q,onEdgesDelete:$,onDelete:L,onNodeDragStart:T,onNodeDrag:O,onNodeDragStop:R,onSelectionDrag:z,onSelectionDragStart:M,onSelectionDragStop:I,onMove:d,onMoveStart:f,onMoveEnd:m,noPanClassName:Ce,nodeOrigin:we,rfId:Yl,autoPanOnConnect:Dr,autoPanOnNodeDrag:vn,autoPanSpeed:gm,onError:Qe,connectionRadius:Kl,isValidConnection:Mo,selectNodesOnDrag:de,nodeDragThreshold:Br,connectionDragThreshold:On,onBeforeDelete:V,debug:vm,ariaLabelConfig:Yd,zIndexMode:Vl}),o.jsx(got,{onSelectionChange:A}),ut,o.jsx(dot,{proOptions:lt,position:Ft}),o.jsx(uot,{rfId:Yl,disableKeyboardA11y:rr})]})})}var qlt=Uge(Hlt);function Wlt(e){const[t,r]=w.useState(e),n=w.useCallback(a=>r(i=>$ge(a,i)),[]);return[t,r,n]}function Klt(e){const[t,r]=w.useState(e),n=w.useCallback(a=>r(i=>Fge(a,i)),[]);return[t,r,n]}function Glt({dimensions:e,lineWidth:t,variant:r,className:n}){return o.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ya(["react-flow__background-pattern",r,n])})}function Vlt({radius:e,className:t}){return o.jsx("circle",{cx:e,cy:e,r:e,className:ya(["react-flow__background-pattern","dots",t])})}var Ad;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ad||(Ad={}));const Ylt={[Ad.Dots]:1,[Ad.Lines]:1,[Ad.Cross]:6},Qlt=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function f0e({id:e,variant:t=Ad.Dots,gap:r=20,size:n,lineWidth:a=1,offset:i=0,color:s,bgColor:l,style:c,className:u,patternClassName:d}){const f=w.useRef(null),{transform:m,patternId:p}=Er(Qlt,Tn),v=n||Ylt[t],b=t===Ad.Dots,y=t===Ad.Cross,S=Array.isArray(r)?r:[r,r],_=[S[0]*m[2]||1,S[1]*m[2]||1],N=v*m[2],k=Array.isArray(i)?i:[i,i],j=y?[N,N]:_,E=[k[0]*m[2]||1+j[0]/2,k[1]*m[2]||1+j[1]/2],T=`${p}${e||""}`;return o.jsxs("svg",{className:ya(["react-flow__background",u]),style:{...c,...U2,"--xy-background-color-props":l,"--xy-background-pattern-color-props":s},ref:f,"data-testid":"rf__background",children:[o.jsx("pattern",{id:T,x:m[0]%_[0],y:m[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:b?o.jsx(Vlt,{radius:N/2,className:d}):o.jsx(Glt,{dimensions:j,lineWidth:a,variant:t,className:d})}),o.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${T})`})]})}f0e.displayName="Background";const Jlt=w.memo(f0e);function Zlt(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:o.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Xlt(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:o.jsx("path",{d:"M0 0h32v4.2H0z"})})}function ect(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:o.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function tct(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:o.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function rct(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:o.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function WS({children:e,className:t,...r}){return o.jsx("button",{type:"button",className:ya(["react-flow__controls-button",t]),...r,children:e})}const nct=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function h0e({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:a,onZoomIn:i,onZoomOut:s,onFitView:l,onInteractiveChange:c,className:u,children:d,position:f="bottom-left",orientation:m="vertical","aria-label":p}){const v=An(),{isInteractive:b,minZoomReached:y,maxZoomReached:S,ariaLabelConfig:_}=Er(nct,Tn),{zoomIn:N,zoomOut:k,fitView:j}=XB(),E=()=>{N(),i?.()},T=()=>{k(),s?.()},O=()=>{j(a),l?.()},R=()=>{v.setState({nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b}),c?.(!b)},q=m==="horizontal"?"horizontal":"vertical";return o.jsxs(F2,{className:ya(["react-flow__controls",q,u]),position:f,style:e,"data-testid":"rf__controls","aria-label":p??_["controls.ariaLabel"],children:[t&&o.jsxs(o.Fragment,{children:[o.jsx(WS,{onClick:E,className:"react-flow__controls-zoomin",title:_["controls.zoomIn.ariaLabel"],"aria-label":_["controls.zoomIn.ariaLabel"],disabled:S,children:o.jsx(Zlt,{})}),o.jsx(WS,{onClick:T,className:"react-flow__controls-zoomout",title:_["controls.zoomOut.ariaLabel"],"aria-label":_["controls.zoomOut.ariaLabel"],disabled:y,children:o.jsx(Xlt,{})})]}),r&&o.jsx(WS,{className:"react-flow__controls-fitview",onClick:O,title:_["controls.fitView.ariaLabel"],"aria-label":_["controls.fitView.ariaLabel"],children:o.jsx(ect,{})}),n&&o.jsx(WS,{className:"react-flow__controls-interactive",onClick:R,title:_["controls.interactive.ariaLabel"],"aria-label":_["controls.interactive.ariaLabel"],children:b?o.jsx(rct,{}):o.jsx(tct,{})}),d]})}h0e.displayName="Controls";const act=w.memo(h0e);function ict({id:e,x:t,y:r,width:n,height:a,style:i,color:s,strokeColor:l,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,selected:m,onClick:p}){const{background:v,backgroundColor:b}=i||{},y=s||v||b;return o.jsx("rect",{className:ya(["react-flow__minimap-node",{selected:m},u]),x:t,y:r,rx:d,ry:d,width:n,height:a,style:{fill:y,stroke:l,strokeWidth:c},shapeRendering:f,onClick:p?S=>p(S,e):void 0})}const sct=w.memo(ict),oct=e=>e.nodes.map(t=>t.id),BL=e=>e instanceof Function?e:()=>e;function lct({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:a,nodeComponent:i=sct,onClick:s}){const l=Er(oct,Tn),c=BL(t),u=BL(e),d=BL(r),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return o.jsx(o.Fragment,{children:l.map(m=>o.jsx(uct,{id:m,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:d,nodeBorderRadius:n,nodeStrokeWidth:a,NodeComponent:i,onClick:s,shapeRendering:f},m))})}function cct({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:n,nodeBorderRadius:a,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:l,onClick:c}){const{node:u,x:d,y:f,width:m,height:p}=Er(v=>{const{internals:b}=v.nodeLookup.get(e),y=b.userNode,{x:S,y:_}=b.positionAbsolute,{width:N,height:k}=yu(y);return{node:y,x:S,y:_,width:N,height:k}},Tn);return!u||u.hidden||!mge(u)?null:o.jsx(l,{x:d,y:f,width:m,height:p,style:u.style,selected:!!u.selected,className:n(u),color:t(u),borderRadius:a,strokeColor:r(u),strokeWidth:i,shapeRendering:s,onClick:c,id:u.id})}const uct=w.memo(cct);var dct=w.memo(lct);const fct=200,hct=150,mct=e=>!e.hidden,pct=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?hge(_1(e.nodeLookup,{filter:mct}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},gct="react-flow__minimap-desc";function m0e({style:e,className:t,nodeStrokeColor:r,nodeColor:n,nodeClassName:a="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:l,bgColor:c,maskColor:u,maskStrokeColor:d,maskStrokeWidth:f,position:m="bottom-right",onClick:p,onNodeClick:v,pannable:b=!1,zoomable:y=!1,ariaLabel:S,inversePan:_,zoomStep:N=1,offsetScale:k=5}){const j=An(),E=w.useRef(null),{boundingRect:T,viewBB:O,rfId:R,panZoom:q,translateExtent:$,flowWidth:L,flowHeight:A,ariaLabelConfig:M}=Er(pct,Tn),z=e?.width??fct,I=e?.height??hct,B=T.width/z,F=T.height/I,U=Math.max(B,F),V=U*z,K=U*I,G=k*U,J=T.x-(V-T.width)/2-G,ee=T.y-(K-T.height)/2-G,Y=V+G*2,ie=K+G*2,fe=`${gct}-${R}`,me=w.useRef(0),te=w.useRef();me.current=U,w.useEffect(()=>{if(E.current&&q)return te.current=Pst({domNode:E.current,panZoom:q,getTransform:()=>j.getState().transform,getViewScale:()=>me.current}),()=>{te.current?.destroy()}},[q]),w.useEffect(()=>{te.current?.update({translateExtent:$,width:L,height:A,inversePan:_,pannable:b,zoomStep:N,zoomable:y})},[b,y,_,N,$,L,A]);const oe=p?ue=>{const[H,ge]=te.current?.pointer(ue)||[0,0];p(ue,{x:H,y:ge})}:void 0,ce=v?w.useCallback((ue,H)=>{const ge=j.getState().nodeLookup.get(H).internals.userNode;v(ue,ge)},[]):void 0,Z=S??M["minimap.ariaLabel"];return o.jsx(F2,{position:m,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*U:void 0,"--xy-minimap-node-background-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:ya(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:o.jsxs("svg",{width:z,height:I,viewBox:`${J} ${ee} ${Y} ${ie}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":fe,ref:E,onClick:oe,children:[Z&&o.jsx("title",{id:fe,children:Z}),o.jsx(dct,{onClick:ce,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:i,nodeClassName:a,nodeStrokeWidth:s,nodeComponent:l}),o.jsx("path",{className:"react-flow__minimap-mask",d:`M${J-G},${ee-G}h${Y+G*2}v${ie+G*2}h${-Y-G*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}m0e.displayName="MiniMap";const vct=w.memo(m0e),bct=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,yct={[$g.Line]:"right",[$g.Handle]:"bottom-right"};function xct({nodeId:e,position:t,variant:r=$g.Handle,className:n,style:a=void 0,children:i,color:s,minWidth:l=10,minHeight:c=10,maxWidth:u=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:m,autoScale:p=!0,shouldResize:v,onResizeStart:b,onResize:y,onResizeEnd:S}){const _=Kge(),N=typeof e=="string"?e:_,k=An(),j=w.useRef(null),E=r===$g.Handle,T=Er(w.useCallback(bct(E&&p),[E,p]),Tn),O=w.useRef(null),R=t??yct[r];w.useEffect(()=>{if(!(!j.current||!N))return O.current||(O.current=Jst({domNode:j.current,nodeId:N,getStoreItems:()=>{const{nodeLookup:$,transform:L,snapGrid:A,snapToGrid:M,nodeOrigin:z,domNode:I}=k.getState();return{nodeLookup:$,transform:L,snapGrid:A,snapToGrid:M,nodeOrigin:z,paneDomNode:I}},onChange:($,L)=>{const{triggerNodeChanges:A,nodeLookup:M,parentLookup:z,nodeOrigin:I}=k.getState(),B=[],F={x:$.x,y:$.y},U=M.get(N);if(U&&U.expandParent&&U.parentId){const V=U.origin??I,K=$.width??U.measured.width??0,G=$.height??U.measured.height??0,J={id:U.id,parentId:U.parentId,rect:{width:K,height:G,...pge({x:$.x??U.position.x,y:$.y??U.position.y},{width:K,height:G},U.parentId,M,V)}},ee=ZB([J],M,z,I);B.push(...ee),F.x=$.x?Math.max(V[0]*K,$.x):void 0,F.y=$.y?Math.max(V[1]*G,$.y):void 0}if(F.x!==void 0&&F.y!==void 0){const V={id:N,type:"position",position:{...F}};B.push(V)}if($.width!==void 0&&$.height!==void 0){const K={id:N,type:"dimensions",resizing:!0,setAttributes:m?m==="horizontal"?"width":"height":!0,dimensions:{width:$.width,height:$.height}};B.push(K)}for(const V of L){const K={...V,type:"position"};B.push(K)}A(B)},onEnd:({width:$,height:L})=>{const A={id:N,type:"dimensions",resizing:!1,dimensions:{width:$,height:L}};k.getState().triggerNodeChanges([A])}})),O.current.update({controlPosition:R,boundaries:{minWidth:l,minHeight:c,maxWidth:u,maxHeight:d},keepAspectRatio:f,resizeDirection:m,onResizeStart:b,onResize:y,onResizeEnd:S,shouldResize:v}),()=>{O.current?.destroy()}},[R,l,c,u,d,f,b,y,S,v]);const q=R.split("-");return o.jsx("div",{className:ya(["react-flow__resize-control","nodrag",...q,r,n]),ref:j,style:{...a,scale:T,...s&&{[E?"backgroundColor":"borderColor"]:s}},children:i})}w.memo(xct);const wct={human:Zr,director:Px,worker:eh,steward:Xo},Qee={running:{bg:"bg-[var(--color-success-muted)]",text:"text-[var(--color-success-text)]",border:"border-[var(--color-success)]"},idle:{bg:"bg-[var(--color-surface-elevated)]",text:"text-[var(--color-text-secondary)]",border:"border-[var(--color-border)]"},suspended:{bg:"bg-[var(--color-warning-muted)]",text:"text-[var(--color-warning-text)]",border:"border-[var(--color-warning)]"},terminated:{bg:"bg-[var(--color-surface)]",text:"text-[var(--color-text-tertiary)]",border:"border-[var(--color-border-subtle)]"},starting:{bg:"bg-[var(--color-info-muted)]",text:"text-[var(--color-info-text)]",border:"border-[var(--color-info)]"}},Sct={healthy:{icon:Pi,color:"text-[var(--color-success)]"},warning:{icon:Bn,color:"text-[var(--color-warning)]"},error:{icon:oi,color:"text-[var(--color-error)]"}};function kct({data:e,selected:t}){const{label:r,nodeType:n,agent:a,status:i="idle",currentTask:s,branch:l,healthIndicator:c}=e,u=wct[n]||Zr,d=Qee[i]||Qee.idle,f=c?Sct[c]:null,m=f?.icon,p=n==="human",v=!!a;return o.jsxs("div",{className:`
        relative min-w-[180px] max-w-[220px] rounded-lg border-2 shadow-sm transition-all duration-200
        ${d.bg} ${d.border}
        ${t?"ring-2 ring-[var(--color-primary)] ring-offset-2 ring-offset-[var(--color-bg)]":""}
        ${v?"cursor-pointer hover:shadow-md hover:scale-[1.02]":""}
        ${p?"border-dashed":""}
      `,"data-testid":`graph-node-${a?.id||n}`,children:[!p&&o.jsx(Fg,{type:"target",position:It.Top,className:"!bg-[var(--color-border)] !border-[var(--color-bg)] !w-3 !h-3","data-testid":`handle-target-${a?.id||n}`}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`
              p-1.5 rounded-md
              ${p?"bg-[var(--color-accent-muted)]":d.bg}
            `,children:o.jsx(u,{className:`w-4 h-4 ${p?"text-[var(--color-accent)]":d.text}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-semibold text-sm text-[var(--color-text)] truncate",title:r,children:r}),!p&&o.jsx("span",{className:`text-xs ${d.text} capitalize`,children:i})]}),m&&o.jsx(m,{className:`w-4 h-4 ${f?.color}`})]}),s&&o.jsx("div",{className:"mt-2 px-2 py-1 rounded bg-[var(--color-surface)] border border-[var(--color-border-subtle)]",children:o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] truncate",title:s.title,children:s.title})}),l&&o.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(cu,{className:"w-3 h-3"}),o.jsx("span",{className:"truncate font-mono",title:l,children:l})]}),v&&(i==="running"||i==="starting")&&o.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-[var(--color-primary)]",children:[o.jsx(na,{className:"w-3 h-3"}),o.jsx("span",{children:"Open in Workspace"})]}),i==="running"&&o.jsx("div",{className:"absolute top-2 right-2",children:o.jsx(nu,{className:"w-2 h-2 fill-[var(--color-success)] text-[var(--color-success)] animate-pulse"})})]}),(p||n==="director")&&o.jsx(Fg,{type:"source",position:It.Bottom,className:"!bg-[var(--color-border)] !border-[var(--color-bg)] !w-3 !h-3","data-testid":`handle-source-${a?.id||n}`})]})}const _ct=w.memo(kct),Nct={humanY:50,directorY:200,workerY:400,stewardY:400,nodeSpacing:200,centerX:400},Cct=[],jct=new Map,Ect={};function Mct({director:e,workers:t,stewards:r,tasks:n,sessionStatuses:a,layout:i}){const s=n??Cct,l=a??jct,c=i??Ect,u=w.useMemo(()=>({...Nct,...c}),[c]);return w.useMemo(()=>{const d=[],f=[],m=new Map;for(const y of s)y.assignee&&(y.status==="in_progress"||y.status==="open")&&m.set(y.assignee,y);const p={id:"human",type:"agentNode",position:{x:u.centerX,y:u.humanY},data:{label:"Human",nodeType:"human"}};if(d.push(p),e){const y=l.get(e.id)||e.metadata?.agent?.sessionStatus||"idle",S={id:e.id,type:"agentNode",position:{x:u.centerX,y:u.directorY},data:{label:e.name,nodeType:"director",agent:e,status:y,currentTask:m.get(e.id)}};d.push(S),f.push({id:"human-director",source:"human",target:e.id,type:"smoothstep",animated:y==="running",style:{stroke:"var(--color-border)",strokeWidth:2},data:{relationship:"supervises"}})}const v=t.filter(y=>y.metadata?.agent?.workerMode==="persistent"),b=t.filter(y=>y.metadata?.agent?.workerMode==="ephemeral");return v.forEach((y,S)=>{const _=l.get(y.id)||y.metadata?.agent?.sessionStatus||"idle",N=y.metadata?.agent,k=u.centerX-300+S*u.nodeSpacing,j={id:y.id,type:"agentNode",position:{x:k,y:u.workerY},data:{label:y.name,nodeType:"worker",agent:y,status:_,currentTask:m.get(y.id),branch:N?.branch}};d.push(j),f.push({id:`human-${y.id}`,source:"human",target:y.id,type:"smoothstep",animated:_==="running",style:{stroke:"var(--color-border)",strokeWidth:2},data:{relationship:"supervises"}})}),e&&b.forEach((y,S)=>{const _=l.get(y.id)||y.metadata?.agent?.sessionStatus||"idle",N=y.metadata?.agent,k=(b.length-1)*u.nodeSpacing,E=u.centerX-k/2-100+S*u.nodeSpacing,T={id:y.id,type:"agentNode",position:{x:E,y:u.workerY},data:{label:y.name,nodeType:"worker",agent:y,status:_,currentTask:m.get(y.id),branch:N?.branch}};d.push(T),f.push({id:`${e.id}-${y.id}`,source:e.id,target:y.id,type:"smoothstep",animated:_==="running",style:{stroke:"var(--color-border)",strokeWidth:2},data:{relationship:"supervises"}})}),e&&r.forEach((y,S)=>{const _=l.get(y.id)||y.metadata?.agent?.sessionStatus||"idle",N=y.metadata?.agent,k=(r.length-1)*u.nodeSpacing,E=u.centerX-k/2+100+S*u.nodeSpacing,T={id:y.id,type:"agentNode",position:{x:E,y:u.stewardY},data:{label:y.name,nodeType:"steward",agent:y,status:_,healthIndicator:Tct(N)}};d.push(T),f.push({id:`${e.id}-${y.id}`,source:e.id,target:y.id,type:"smoothstep",animated:_==="running",style:{stroke:"var(--color-border)",strokeWidth:2,strokeDasharray:"5,5"},data:{relationship:"supervises"}})}),{nodes:d,edges:f}},[e,t,r,s,l,u])}function Tct(e){if(e&&e.stewardFocus==="health")return e.lastExecutedAt&&(Date.now()-e.lastExecutedAt)/36e5>24?"warning":"healthy"}const Act=new Map,Dct={agentNode:_ct};function Lct(e){switch(e.data?.status){case"running":return"var(--color-success)";case"starting":return"var(--color-info)";case"suspended":return"var(--color-warning)";case"terminated":return"var(--color-text-tertiary)";default:return"var(--color-border)"}}function Oct({director:e,workers:t,stewards:r,tasks:n=[],sessionStatuses:a=Act,isLoading:i=!1,error:s=null,onRefresh:l}){const c=Ma(),{nodes:u,edges:d}=Mct({director:e,workers:t,stewards:r,tasks:n,sessionStatuses:a}),f=w.useCallback((N,k)=>{const j=k.data?.agent;j&&c({to:"/workspaces",search:{layout:"single",agent:j.id,resumeSessionId:void 0,resumePrompt:void 0}})},[c]),[m,p,v]=Wlt(u),[b,y,S]=Klt(d);w.useEffect(()=>{p(u),y(d)},[u,d]);const _=w.useMemo(()=>({padding:.2,maxZoom:1.5,minZoom:.5}),[]);return i?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-graph-loading",children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-[var(--color-text-secondary)]",children:[o.jsx($e,{className:"w-8 h-8 animate-spin"}),o.jsx("span",{children:"Loading agents..."})]})}):s?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-graph-error",children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-error)]"}),o.jsx("p",{className:"text-[var(--color-text)]",children:"Failed to load agents"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-md",children:s.message}),l&&o.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-[var(--color-primary)] border border-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-muted)] transition-colors","data-testid":"agent-graph-retry",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]})}):!e&&t.length===0&&r.length===0?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-graph-empty",children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[o.jsx("div",{className:"p-3 rounded-full bg-[var(--color-surface-elevated)]",children:o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-text-tertiary)]"})}),o.jsx("p",{className:"text-[var(--color-text)]",children:"No agents registered"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-md",children:"Register agents to see them visualized in the hierarchy graph."})]})}):o.jsx("div",{className:"w-full h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-workspace-graph",children:o.jsxs(qlt,{nodes:m,edges:b,onNodesChange:v,onEdgesChange:S,onNodeClick:f,nodeTypes:Dct,fitView:!0,fitViewOptions:_,nodesDraggable:!0,nodesConnectable:!1,elementsSelectable:!0,zoomOnScroll:!0,panOnScroll:!0,panOnDrag:!0,attributionPosition:"bottom-left",className:"bg-[var(--color-bg)]",children:[o.jsx(Jlt,{gap:16,size:1,color:"var(--color-border-subtle)"}),o.jsx(act,{showZoom:!0,showFitView:!0,showInteractive:!1,className:"!bg-[var(--color-surface)] !border-[var(--color-border)] !rounded-lg !shadow-sm"}),o.jsx(vct,{nodeColor:Lct,maskColor:"rgba(0, 0, 0, 0.1)",className:"!bg-[var(--color-surface)] !border-[var(--color-border)] !rounded-lg",zoomable:!0,pannable:!0})]})})}function Ict(){const e=rl({from:"/agents"}),t=Ma(),r=e.tab||"agents",[n,a]=w.useState(""),[i,s]=w.useState(!1);w.useEffect(()=>{e.action==="create"&&(s(!0),t({to:"/agents",search:{tab:e.tab??"agents",selected:e.selected,role:e.role},replace:!0}))},[e.action,e.tab,e.selected,e.role,t]);const[l,c]=w.useState(void 0),[u,d]=w.useState(void 0),[f,m]=w.useState(!1),[p,v]=w.useState(null),[b,y]=w.useState(!1),[S,_]=w.useState(null),[N,k]=w.useState(!1),[j,E]=w.useState(null),[T,O]=w.useState(new Set),[R,q]=w.useState(new Set),{director:$,ephemeralWorkers:L,persistentWorkers:A,stewards:M,workers:z,isLoading:I,error:B,refetch:F}=g0(),{data:U}=b2({status:"all",limit:100}),V=U?.tasks??[],K=p2(),G=f1(),J=BQe(),{hasActiveSession:ee}=ame(),{data:Y}=m2({status:"running"}),ie=Y?.sessions??[],fe=w.useMemo(()=>{const rt=new Map;$&&rt.set($.id,"idle");for(const ze of z)rt.set(ze.id,"idle");for(const ze of M)rt.set(ze.id,"idle");for(const ze of ie){const bt=ze.status==="terminating"?"terminated":ze.status;rt.set(ze.agentId,bt)}return rt},[$,z,M,ie]),me=rt=>{const ze=ie.find(bt=>bt.agentId===rt);if(ze)return ze.status==="running"?"running":ze.status==="starting"?"starting":void 0},te=w.useMemo(()=>{const rt=n.toLowerCase().trim();if(!rt)return{director:$,ephemeralWorkers:L,persistentWorkers:A,stewards:M};const ze=bt=>bt.filter(tt=>tt.name.toLowerCase().includes(rt));return{director:$?.name.toLowerCase().includes(rt)?$:void 0,ephemeralWorkers:ze(L),persistentWorkers:ze(A),stewards:ze(M)}},[n,$,L,A,M]),oe=rt=>{t({to:"/agents",search:{selected:e.selected,tab:rt,role:e.role}})},ce=async rt=>{O(ze=>new Set(ze).add(rt));try{await K.mutateAsync({agentId:rt})}finally{O(ze=>{const bt=new Set(ze);return bt.delete(rt),bt})}},Z=rt=>{E(rt),k(!0)},ue=()=>{k(!1),E(null)},H=async(rt,ze,bt)=>{O(tt=>new Set(tt).add(rt));try{await K.mutateAsync({agentId:rt,taskId:ze,initialMessage:bt})}finally{O(tt=>{const _e=new Set(tt);return _e.delete(rt),_e})}},ge=async(rt,ze,bt)=>{await H(rt,ze,bt),t({to:"/workspaces",search:{layout:"single",agent:rt,resumeSessionId:void 0,resumePrompt:void 0}})},de=rt=>L.some(ze=>ze.id===rt),re=rt=>{const ze=[...L,...A,$].find(bt=>bt?.id===rt);ze&&(de(rt)?Z({id:ze.id,name:ze.name}):ce(rt))},ne=async rt=>{q(ze=>new Set(ze).add(rt));try{await G.mutateAsync({agentId:rt,graceful:!0})}finally{q(ze=>{const bt=new Set(ze);return bt.delete(rt),bt})}},pe=rt=>{t({to:"/workspaces",search:{layout:"single",agent:rt,resumeSessionId:void 0,resumePrompt:void 0}})},ke=()=>{window.dispatchEvent(new CustomEvent("open-director-panel"))},we=(rt,ze)=>{c(rt),d(ze),s(!0)},ve=()=>{s(!1),c(void 0),d(void 0)},Le=rt=>{v(rt),m(!0)},Ae=()=>{m(!1),v(null)},Re=rt=>{_(rt),y(!0)},Ye=()=>{y(!1),_(null)},mt=async()=>{if(S)try{await J.mutateAsync({agentId:S.id}),Ye()}catch{}},ot=($?1:0)+L.length+A.length,Ot=M.length;return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"agents-page",children:[o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Ii,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]","data-testid":"agents-page-title",children:"Agents"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Manage your AI agents and stewards"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:"Search agents...",value:n,onChange:rt=>a(rt.target.value),className:"pl-9 pr-3 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent w-48 @md:w-64","data-testid":"agents-search"})]}),o.jsxs("button",{onClick:()=>we(r==="stewards"?"steward":void 0),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"agents-create",children:[o.jsx(_r,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:r==="stewards"?"Create Steward":"Create Agent"}),o.jsx("kbd",{className:"hidden sm:inline ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(Pl("action.createAgent"))})]})]})]}),o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("nav",{className:"flex gap-1","aria-label":"Tabs",children:[o.jsx("button",{onClick:()=>oe("agents"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="agents"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-agents",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Ii,{className:"w-4 h-4"}),"Agents",ot>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:ot})]})}),o.jsx("button",{onClick:()=>oe("stewards"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="stewards"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-stewards",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Xo,{className:"w-4 h-4"}),"Stewards",Ot>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:Ot})]})}),o.jsx("button",{onClick:()=>oe("graph"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="graph"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-graph",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(_we,{className:"w-4 h-4"}),"Graph"]})})]})}),r==="graph"?o.jsx("div",{className:"h-[600px] border border-[var(--color-border)] rounded-lg overflow-hidden",children:o.jsx(Oct,{director:$,workers:z,stewards:M,tasks:V,sessionStatuses:fe,isLoading:I,error:B,onRefresh:F})}):I?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading agents..."})]}):B?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-danger)] rounded-lg bg-[var(--color-danger-muted)]",children:[o.jsx(Bt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"Failed to load agents"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:B.message}),o.jsxs("button",{onClick:()=>F(),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-surface)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]}):r==="agents"?o.jsx(Rct,{director:te.director,directorHasActiveSession:ee,onOpenDirectorPanel:ke,ephemeralWorkers:te.ephemeralWorkers,persistentWorkers:te.persistentWorkers,onStart:re,onStop:ne,onOpenTerminal:pe,onRename:Le,onDelete:Re,pendingStart:T,pendingStop:R,onCreateAgent:()=>we(),getActiveSessionStatus:me}):r==="stewards"?o.jsx(Pct,{stewards:te.stewards,onStart:ce,onStop:ne,onOpenTerminal:pe,onRename:Le,onDelete:Re,pendingStart:T,pendingStop:R,onCreateSteward:()=>we("steward"),getActiveSessionStatus:me}):null,o.jsx(Wrt,{isOpen:i,onClose:ve,initialRole:l,initialStewardFocus:u,hasDirector:!!$,onSuccess:()=>F()}),p&&o.jsx(Grt,{isOpen:f,onClose:Ae,agentId:p.id,currentName:p.name,onSuccess:()=>F()}),j&&o.jsx(Vrt,{isOpen:N,onClose:ue,agent:j,onStart:H,onStartAndOpen:ge,isStarting:T.has(j.id)}),S&&o.jsx(Krt,{isOpen:b,onClose:Ye,agentName:S.name,onConfirm:mt,isDeleting:J.isPending})]})}function Rct({director:e,directorHasActiveSession:t,onOpenDirectorPanel:r,ephemeralWorkers:n,persistentWorkers:a,onStart:i,onStop:s,onOpenTerminal:l,onRename:c,onDelete:u,pendingStart:d,pendingStop:f,onCreateAgent:m,getActiveSessionStatus:p}){return e||n.length>0||a.length>0?o.jsxs("div",{className:"space-y-8",children:[e&&o.jsx(Bk,{title:"Director",icon:Px,description:"Strategic agent that creates and assigns tasks",children:o.jsx(Ok,{agent:e,activeSessionStatus:t?"running":void 0,onStart:()=>i(e.id),onStop:()=>s(e.id),onOpenTerminal:r,onRename:()=>c({id:e.id,name:e.name}),onDelete:()=>u({id:e.id,name:e.name}),isStarting:d.has(e.id),isStopping:f.has(e.id)})}),a.length>0&&o.jsx(Bk,{title:"Persistent Workers",icon:Zo,description:"Long-lived workers that handle multiple tasks",count:a.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:a.map(b=>o.jsx(Ok,{agent:b,activeSessionStatus:p(b.id),onStart:()=>i(b.id),onStop:()=>s(b.id),onOpenTerminal:()=>l(b.id),onRename:()=>c({id:b.id,name:b.name}),onDelete:()=>u({id:b.id,name:b.name}),isStarting:d.has(b.id),isStopping:f.has(b.id)},b.id))})}),n.length>0&&o.jsx(Bk,{title:"Ephemeral Workers",icon:Zo,description:"Short-lived workers spawned per task",count:n.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:n.map(b=>o.jsx(Ok,{agent:b,activeSessionStatus:p(b.id),onStart:()=>i(b.id),onStop:()=>s(b.id),onOpenTerminal:()=>l(b.id),onRename:()=>c({id:b.id,name:b.name}),onDelete:()=>u({id:b.id,name:b.name}),isStarting:d.has(b.id),isStopping:f.has(b.id)},b.id))})})]}):o.jsx(p0e,{icon:Ii,title:"No agents yet",description:"Create your first agent to start orchestrating AI work. Agents can work on tasks autonomously in isolated git worktrees.",actionLabel:"Create Agent",actionTestId:"agents-create-empty",onAction:m})}function Pct({stewards:e,onStart:t,onStop:r,onOpenTerminal:n,onRename:a,onDelete:i,pendingStart:s,pendingStop:l,onCreateSteward:c,getActiveSessionStatus:u}){if(e.length===0)return o.jsx(p0e,{icon:Xo,title:"No stewards yet",description:"Create stewards to automate maintenance tasks like merging branches, health monitoring, and cleanup operations.",actionLabel:"Create Steward",actionTestId:"stewards-create-empty",onAction:c});const d=e.reduce((m,p)=>{const v=p.metadata?.agent,b=v?.agentRole==="steward"?v?.stewardFocus:"ops";return m[b??"ops"]||(m[b??"ops"]=[]),m[b??"ops"].push(p),m},{}),f={merge:"Merge Stewards",health:"Health Stewards",reminder:"Reminder Stewards",ops:"Ops Stewards"};return o.jsx("div",{className:"space-y-8",children:Object.entries(d).map(([m,p])=>o.jsx(Bk,{title:f[m]??m,icon:Xo,count:p.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:p.map(v=>o.jsx(Ok,{agent:v,activeSessionStatus:u(v.id),onStart:()=>t(v.id),onStop:()=>r(v.id),onOpenTerminal:()=>n(v.id),onRename:()=>a({id:v.id,name:v.name}),onDelete:()=>i({id:v.id,name:v.name}),isStarting:s.has(v.id),isStopping:l.has(v.id)},v.id))})},m))})}function Bk({title:e,icon:t,description:r,count:n,children:a}){return o.jsxs("section",{"data-testid":`agent-section-${e.toLowerCase().replace(/\s+/g,"-")}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(t,{className:"w-5 h-5 text-[var(--color-text-secondary)]"}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:e}),n!==void 0&&o.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)]",children:n})]}),r&&o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4",children:r}),a]})}function p0e({icon:e,title:t,description:r,actionLabel:n,actionTestId:a,onAction:i}){return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(e,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:t}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:r}),o.jsxs("button",{onClick:i,className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":a,children:[o.jsx(_r,{className:"w-4 h-4"}),n]})]})}const g0e="stoneforge-workspace-layouts",v0e="stoneforge-active-workspace-layout",b0e="stoneforge-workspace-channel",zct={id:"default",name:"Default",preset:"single",panes:[],gridOrientation:"horizontal",sectionLayout:"single-first",createdAt:Date.now(),modifiedAt:Date.now()};function Jee(){return`pane-${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function Bct(){return`layout-${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function $ct(e){const t=e.metadata?.agent;return t&&(t.agentRole==="director"||t.agentRole==="worker"&&t.workerMode==="persistent")?"terminal":"stream"}function Fct(){try{const e=localStorage.getItem(g0e);return e?JSON.parse(e):[]}catch{return[]}}function Zee(e){try{localStorage.setItem(g0e,JSON.stringify(e))}catch{}}function Uct(){try{const e=localStorage.getItem(v0e);if(e){const t=JSON.parse(e);if(t.id&&t.panes&&Array.isArray(t.panes))return t}}catch{}return{...zct}}function Hct(e){try{localStorage.setItem(v0e,JSON.stringify(e))}catch{}}function qct(){const[e,t]=w.useState(()=>Uct()),[r,n]=w.useState(null),[a,i]=w.useState(null),[s,l]=w.useState(()=>Fct()),c=a!==null;w.useEffect(()=>{Hct(e)},[e]),w.useEffect(()=>{const M=new BroadcastChannel(b0e),z=I=>{if(I.data.type==="pop-back-in"){const{pane:B}=I.data,F={id:Jee(),...B,status:"disconnected",position:0,weight:1};t(U=>{const V=[...U.panes,{...F,position:U.panes.length}];let K=U.preset;return V.length===2&&U.preset==="single"?K="columns":V.length>2&&U.preset!=="grid"&&U.preset!=="flex"&&U.preset!=="rows"&&U.preset!=="columns"&&(K="grid"),{...U,preset:K,panes:V,modifiedAt:Date.now()}}),n(F.id)}};return M.addEventListener("message",z),()=>{M.removeEventListener("message",z),M.close()}},[]);const u=w.useCallback(M=>{const z={id:Jee(),agentId:M.id,agentName:M.name,agentRole:M.metadata?.agent?.agentRole??"worker",workerMode:M.metadata?.agent?.agentRole==="worker"?M.metadata?.agent?.workerMode:void 0,paneType:$ct(M),status:"disconnected",position:0,weight:1};t(I=>{const B=[...I.panes,{...z,position:I.panes.length}];let F=I.preset;return B.length===2&&I.preset==="single"?F="columns":B.length>2&&I.preset!=="grid"&&I.preset!=="flex"&&I.preset!=="rows"&&I.preset!=="columns"&&(F="grid"),{...I,preset:F,panes:B,modifiedAt:Date.now()}}),n(z.id)},[]),d=w.useCallback(M=>{t(z=>{const B=z.panes.filter(U=>U.id!==M).map((U,V)=>({...U,position:V}));let F=z.preset;return B.length<=1?F="single":B.length===2&&z.preset==="grid"&&(F="columns"),{...z,preset:F,panes:B,modifiedAt:Date.now()}}),n(z=>z===M?null:z)},[]),f=w.useCallback((M,z)=>{t(I=>({...I,panes:I.panes.map(B=>B.id===M?{...B,status:z}:B)}))},[]),m=w.useCallback(M=>{t(z=>({...z,preset:M,modifiedAt:Date.now()}))},[]),p=w.useCallback((M,z)=>{t(I=>{const B=[...I.panes],[F]=B.splice(M,1);B.splice(z,0,F);const U=B.map((V,K)=>({...V,position:K}));return{...I,panes:U,modifiedAt:Date.now()}})},[]),v=w.useCallback((M,z)=>{t(I=>({...I,panes:I.panes.map(B=>B.id===M?{...B,weight:Math.max(.5,Math.min(2,z))}:B)}))},[]),b=w.useCallback(M=>{const z=e.panes.find(I=>I.id===M);z&&i({paneId:M,originalPosition:z.position,targetPosition:null})},[e.panes]),y=w.useCallback(M=>{i(z=>z?{...z,targetPosition:M}:null)},[]),S=w.useCallback(()=>{a&&a.targetPosition!==null&&a.targetPosition!==a.originalPosition&&p(a.originalPosition,a.targetPosition),i(null)},[a,p]),_=w.useCallback(()=>{i(null)},[]),N=w.useCallback((M,z)=>{t(I=>{const B=I.panes.findIndex(G=>G.id===M);if(B===-1)return I;const F=[...I.panes],[U]=F.splice(B,1),V=Math.min(z,F.length);F.splice(V,0,U);const K=F.map((G,J)=>({...G,position:J}));return{...I,panes:K,modifiedAt:Date.now()}})},[]),k=w.useCallback(M=>{const z={...e,id:Bct(),name:M,createdAt:Date.now(),modifiedAt:Date.now()},I=[...s,z];l(I),Zee(I)},[e,s]),j=w.useCallback(M=>{t({...M,modifiedAt:Date.now()}),n(M.panes[0]?.id??null)},[]),E=w.useCallback(M=>{const z=s.filter(I=>I.id!==M);l(z),Zee(z)},[s]),T=w.useCallback(()=>{t(M=>({...M,preset:"single",panes:[],modifiedAt:Date.now()})),n(null)},[]),O=w.useCallback((M,z)=>{t(I=>{const B=[...I.panes],F=B.findIndex(K=>K.id===M),U=B.findIndex(K=>K.id===z);if(F===-1||U===-1)return I;[B[F],B[U]]=[B[U],B[F]];const V=B.map((K,G)=>({...K,position:G}));return{...I,panes:V,modifiedAt:Date.now()}})},[]),R=w.useCallback(M=>{t(z=>{const I=z.panes.findIndex(U=>U.id===M);if(I<=0)return z;const B=[...z.panes];[B[I-1],B[I]]=[B[I],B[I-1]];const F=B.map((U,V)=>({...U,position:V}));return{...z,panes:F,modifiedAt:Date.now()}})},[]),q=w.useCallback(M=>{t(z=>{const I=z.panes.findIndex(U=>U.id===M);if(I===-1||I>=z.panes.length-1)return z;const B=[...z.panes];[B[I],B[I+1]]=[B[I+1],B[I]];const F=B.map((U,V)=>({...U,position:V}));return{...z,panes:F,modifiedAt:Date.now()}})},[]),$=w.useCallback(()=>{t(M=>{const z=M.panes.length;if(M.preset!=="grid"||z<3)return M;const B=(M.gridOrientation||"horizontal")==="horizontal"?"vertical":"horizontal";return{...M,gridOrientation:B,modifiedAt:Date.now()}})},[]),L=w.useCallback(()=>{t(M=>{const z=M.panes.length;if(M.preset!=="grid"||z<3)return M;if(z===3){const I=M.sectionLayout||"single-first",B=I==="single-first"?"single-last":"single-first",F=[...M.panes];if(I==="single-first"){const V=F.shift();F.push(V)}else{const V=F.pop();F.unshift(V)}const U=F.map((V,K)=>({...V,position:K}));return{...M,panes:U,sectionLayout:B,modifiedAt:Date.now()}}if(z===4){const I=M.gridOrientation||"horizontal",B=[...M.panes];I==="horizontal"?([B[0],B[1]]=[B[1],B[0]],[B[2],B[3]]=[B[3],B[2]]):([B[0],B[2]]=[B[2],B[0]],[B[1],B[3]]=[B[3],B[1]]);const F=B.map((U,V)=>({...U,position:V}));return{...M,panes:F,modifiedAt:Date.now()}}return M})},[]),A=w.useCallback(()=>{t(M=>{if(M.panes.length!==4)return M;const I=[...M.panes];[I[0],I[2]]=[I[2],I[0]],[I[1],I[3]]=[I[3],I[1]];const B=I.map((F,U)=>({...F,position:U}));return{...M,panes:B,modifiedAt:Date.now()}})},[]);return{layout:e,activePane:r,isDragging:c,dragState:a,savedLayouts:s,hasPanes:e.panes.length>0,paneCount:e.panes.length,addPane:u,removePane:d,setActivePane:n,updatePaneStatus:f,setLayoutPreset:m,reorderPanes:p,setPaneWeight:v,saveLayout:k,loadLayout:j,deleteLayout:E,clearPanes:T,startDrag:b,updateDragTarget:y,endDrag:S,cancelDrag:_,movePaneToPosition:N,swapPanes:O,movePaneUp:R,movePaneDown:q,rotateLayout:$,swapGridSections:L,swap2x2Rows:A}}function y0e({isConnected:e,onSend:t,connectedPlaceholder:r="Type a message...",disconnectedPlaceholder:n="Connect to send messages","data-testid":a="terminal-input"}){const[i,s]=w.useState(""),[l,c]=w.useState(!1),u=w.useRef(null),d=w.useCallback(()=>{const p=u.current;if(!p)return;p.style.height="auto";const v=200;p.style.height=`${Math.min(p.scrollHeight,v)}px`},[]);w.useEffect(()=>{d()},[i,d]);const f=w.useCallback(async()=>{if(!i.trim()||l||!e)return;const p=i.trim();c(!0),s("");try{await t(p)}catch(v){console.error("[TerminalInput] Error sending message:",v),s(p)}finally{c(!1)}},[i,l,e,t]),m=w.useCallback(p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),f())},[f]);return o.jsxs("div",{className:`
        flex items-end gap-2 p-3
        border-t border-[var(--color-border)]
        bg-[var(--color-surface)]
      `,"data-testid":a,children:[o.jsx("textarea",{ref:u,value:i,onChange:p=>s(p.target.value),onKeyDown:m,placeholder:e?r:n,disabled:!e||l,rows:1,className:`
          flex-1 px-3 py-2
          text-sm
          bg-[var(--color-bg)]
          border border-[var(--color-border)]
          rounded-md
          placeholder:text-[var(--color-text-tertiary)]
          focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]
          disabled:opacity-50 disabled:cursor-not-allowed
          resize-none
          overflow-y-auto
        `,style:{minHeight:"38px"},"data-testid":`${a}-field`}),o.jsx("button",{onClick:f,disabled:!i.trim()||!e||l,className:`
          p-2 rounded-md
          text-white bg-[var(--color-primary)]
          hover:bg-[var(--color-primary-hover)]
          disabled:opacity-50 disabled:cursor-not-allowed
          transition-colors
          flex-shrink-0
        `,title:"Send message (Enter)","data-testid":`${a}-send-btn`,children:o.jsx(QC,{className:"w-4 h-4"})})]})}const Wct=180*1e3,Xee="/api/agents",Kct=window.location.origin,XP={assistant:{bg:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-700 dark:text-blue-300",border:"border-blue-200 dark:border-blue-800"},tool_use:{bg:"bg-amber-50 dark:bg-amber-900/20",text:"text-amber-700 dark:text-amber-300",border:"border-amber-200 dark:border-amber-800"},tool_result:{bg:"bg-green-50 dark:bg-green-900/20",text:"text-green-700 dark:text-green-300",border:"border-green-200 dark:border-green-800"},user:{bg:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-700 dark:text-purple-300",border:"border-purple-200 dark:border-purple-800"},system:{bg:"bg-gray-50 dark:bg-gray-800/50",text:"text-gray-600 dark:text-gray-400",border:"border-gray-200 dark:border-gray-700"},error:{bg:"bg-red-50 dark:bg-red-900/20",text:"text-red-700 dark:text-red-300",border:"border-red-200 dark:border-red-800"},result:{bg:"bg-cyan-50 dark:bg-cyan-900/20",text:"text-cyan-700 dark:text-cyan-300",border:"border-cyan-200 dark:border-cyan-800"}},Gct={assistant:Xr,tool_use:Zo,tool_result:Zo,user:Zr,system:KC,error:Bt,result:Pi};function Vct(e){return e.content!=null||e.toolInput!=null||e.toolOutput!=null}function x0e({event:e,isLast:t}){const r=e.type==="tool_use"||e.type==="tool_result",[n,a]=w.useState(!r),i=XP[e.type]||XP.system,s=Gct[e.type]||KC,l=new Date(e.timestamp).toLocaleTimeString();return o.jsxs("div",{className:`
        mb-1 rounded border overflow-hidden
        ${i.bg} ${i.border}
        ${t?"animate-fade-in":""}
      `,"data-testid":`stream-event-${e.id}`,children:[o.jsxs("div",{className:`
          flex items-center gap-1.5 px-2 py-1 cursor-pointer
          ${i.text}
        `,onClick:()=>a(!n),children:[e.content||e.toolInput||e.toolOutput?n?o.jsx(cr,{className:"w-3 h-3 flex-shrink-0"}):o.jsx(gn,{className:"w-3 h-3 flex-shrink-0"}):o.jsx("div",{className:"w-3 h-3 flex-shrink-0"}),o.jsx(s,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide flex-shrink-0",children:e.type.replace("_"," ")}),e.toolName&&o.jsx("span",{className:"text-[10px] font-mono opacity-75 truncate",children:e.toolName}),o.jsx("span",{className:"ml-auto text-[10px] opacity-50 flex-shrink-0",children:l})]}),n&&Vct(e)&&o.jsxs("div",{className:"px-2 py-1.5 border-t border-[var(--color-border)]/30",children:[e.content!=null&&e.content!==""&&(e.type==="assistant"||e.type==="user"?o.jsx(w2,{content:e.content,className:"text-xs text-[var(--color-text)]"}):o.jsx("div",{className:"text-xs whitespace-pre-wrap break-words text-[var(--color-text)]",children:e.content})),e.toolInput!=null&&o.jsxs("div",{className:"mt-1.5",children:[o.jsx("div",{className:"text-[10px] font-medium text-[var(--color-text-secondary)] mb-0.5",children:"Input:"}),o.jsx("pre",{className:`
                text-[10px] font-mono p-1.5 rounded
                bg-[var(--color-bg-secondary)]
                text-[var(--color-text-secondary)]
                overflow-x-auto
              `,children:typeof e.toolInput=="string"?e.toolInput:String(JSON.stringify(e.toolInput,null,2))})]}),e.toolOutput&&o.jsxs("div",{className:"mt-1.5",children:[o.jsx("div",{className:"text-[10px] font-medium text-[var(--color-text-secondary)] mb-0.5",children:"Output:"}),o.jsx("pre",{className:`
                text-[10px] font-mono p-1.5 rounded
                bg-[var(--color-bg-secondary)]
                text-[var(--color-text-secondary)]
                overflow-x-auto max-h-36 overflow-y-auto
              `,children:e.toolOutput})]})]})]})}function Yct(e){const t=[];let r=[];const n=()=>{r.length>0&&(r.length===1?t.push({type:"single",event:r[0]}):t.push({type:"tool-group",events:[...r]}),r=[])};for(const a of e)a.type==="tool_use"||a.type==="tool_result"?r.push(a):(n(),t.push({type:"single",event:a}));return n(),t}function Qct({events:e,isLast:t}){const[r,n]=w.useState(!1),a=XP.tool_use,i=e.filter(u=>u.type==="tool_use").length,s=e.filter(u=>u.type==="tool_result").length,l=[...new Set(e.filter(u=>u.toolName).map(u=>u.toolName))],c=l.length>3?`${l.slice(0,3).join(", ")}...`:l.join(", ");return o.jsxs("div",{className:`
        mb-1 rounded border overflow-hidden
        ${a.bg} ${a.border}
        ${t?"animate-fade-in":""}
      `,"data-testid":"tool-call-group",children:[o.jsxs("div",{className:`
          flex items-center gap-1.5 px-2 py-1 cursor-pointer
          ${a.text}
        `,onClick:()=>n(!r),children:[r?o.jsx(cr,{className:"w-3 h-3 flex-shrink-0"}):o.jsx(gn,{className:"w-3 h-3 flex-shrink-0"}),o.jsx(Zo,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsxs("span",{className:"text-[10px] font-semibold uppercase tracking-wide flex-shrink-0",children:[i," tool call",i!==1?"s":""]}),c&&o.jsxs("span",{className:"text-[10px] font-mono opacity-75 truncate",children:["(",c,")"]}),s>0&&o.jsxs("span",{className:"text-[10px] opacity-60 flex-shrink-0",children:[" ",s," result",s!==1?"s":""]})]}),r&&o.jsx("div",{className:"px-1.5 py-1 border-t border-[var(--color-border)]/30 space-y-1",children:e.map((u,d)=>o.jsx(x0e,{event:u,isLast:t&&d===e.length-1},u.id))})]})}function w0e({agentId:e,agentName:t,sessionId:r,providerSessionId:n,hasActiveSession:a=!1,onResumeWithMessage:i,apiUrl:s=Kct,onStatusChange:l,enableFileDrop:c=!0,"data-testid":u="stream-viewer"}){const[d,f]=w.useState([]),[m,p]=w.useState("disconnected"),[v,b]=w.useState(!1),[y,S]=w.useState(!1),[_,N]=w.useState(!1),k=w.useRef(null),j=w.useRef(!0),E=w.useRef(null),T=w.useRef(null),O=w.useRef(0),R=5,q=w.useRef(!1),$=w.useRef(0),L=w.useRef(null),A=w.useRef(void 0);w.useEffect(()=>{r&&A.current&&r!==A.current&&(f([]),N(!1)),A.current=r},[r]),w.useEffect(()=>{j.current=!0},[r]),w.useEffect(()=>{if(!r)return;(async()=>{try{const Y=await fetch(`/api/sessions/${r}/messages`);if(!Y.ok){console.warn("[StreamViewer] Failed to fetch session messages:",Y.status);return}const fe=(await Y.json()).messages||[];if(fe.length>0){const me=ce=>{if(ce)try{return JSON.parse(ce)}catch{return ce}},te=fe.map(ce=>({id:ce.id,type:ce.type,timestamp:new Date(ce.createdAt).getTime(),content:ce.content,toolName:ce.toolName,toolInput:me(ce.toolInput),toolOutput:ce.toolOutput,isError:ce.isError}));f(ce=>{if(ce.length===0)return te;const Z=new Set(te.map(H=>H.id)),ue=ce.filter(H=>!Z.has(H.id));return[...te,...ue]});const oe=te.filter(ce=>ce.type==="user"||ce.type==="assistant"||ce.type==="result"||ce.type==="error");if(oe.length>0){const ce=oe[oe.length-1],Z=ce.type==="assistant"||ce.type==="result"||ce.type==="error";N(!Z)}}}catch(Y){console.error("[StreamViewer] Error loading session messages:",Y)}})()},[r]);const M=w.useCallback(ee=>{p(ee),l?.(ee)},[l]),z=w.useCallback(ee=>{$.current=Date.now(),L.current&&(clearTimeout(L.current),L.current=null),(ee??_)&&(L.current=setTimeout(()=>{N(!1)},Wct))},[_]),I=w.useCallback(()=>{if(!k.current)return;const{scrollTop:ee,scrollHeight:Y,clientHeight:ie}=k.current,fe=Y-ee-ie<80;j.current=fe},[]);w.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]),w.useEffect(()=>{k.current&&j.current&&(k.current.scrollTop=k.current.scrollHeight)},[d]),w.useEffect(()=>{if(!e){M("disconnected");return}if(!a){M("disconnected");return}O.current=0,N(!1);const ee=()=>{M("connecting");const Y=`${Xee}/${e}/stream`;console.log("[StreamViewer] Connecting to SSE:",Y,"sessionId:",r);const ie=new EventSource(Y);T.current=ie;const fe=()=>{console.log("[StreamViewer] ReadyState:",["CONNECTING","OPEN","CLOSED"][ie.readyState]||ie.readyState)};ie.onopen=()=>{console.log("[StreamViewer] Connection opened"),fe(),O.current=0,M("connected")};const me=oe=>{if(oe!=null){if(typeof oe=="string")return oe;if(Array.isArray(oe)){const ce=oe.filter(Z=>typeof Z=="object"&&Z!==null&&Z.type==="text"&&typeof Z.text=="string").map(Z=>Z.text);return ce.length>0?ce.join(`
`):void 0}if(typeof oe=="object"&&"content"in oe)return me(oe.content);if(typeof oe=="object"&&"text"in oe&&typeof oe.text=="string")return oe.text;if(typeof oe=="object")try{const ce=JSON.stringify(oe,null,2);return ce.length>500?ce.slice(0,500)+"...":ce}catch{return"[Object]"}return String(oe)}},te=oe=>{try{const ce=JSON.parse(oe.data),Z=ce.event||ce;let ue=Z.type?.replace("agent_","")||"system";if(ue==="result"){N(!1),z(!1);return}if(ue==="system")return;let H=Z.tool?.name||Z.data?.name||Z.toolName||Z.raw?.tool,ge=Z.tool?.input||Z.data?.input||Z.toolInput||Z.raw?.tool_input,de;const re=Z.raw?.message?.content||Z.raw?.content||Z.message?.content||Z.content;if(Array.isArray(re))for(const ve of re)typeof ve=="object"&&ve!==null&&"type"in ve&&(ve.type==="tool_use"&&ve.name?(H=H||ve.name,ge=ge||ve.input,ue==="assistant"&&(ue="tool_use")):ve.type==="tool_result"&&(de=typeof ve.content=="string"?ve.content:void 0,ue==="user"&&(ue="tool_result")));const ne=Z.message||(typeof Z.content=="string"?Z.content:void 0)||Z.raw?.message||(typeof Z.raw?.content=="string"?Z.raw?.content:void 0)||Z.raw?.result||Z.data?.content,pe=me(ne);de||(de=Z.output||Z.data?.output||(ue==="tool_result"&&typeof Z.raw?.content=="string"?Z.raw?.content:void 0));const ke=ue==="tool_result"&&de?void 0:pe,we={id:Z.msgId||oe.lastEventId||`event-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,type:ue,timestamp:Date.now(),content:ke,toolName:H,toolInput:ge,toolOutput:de,isError:ue==="error"};f(ve=>ve.some(Le=>Le.id===we.id)?ve:[...ve.slice(-200),we]),z(),ue==="user"&&(N(!0),z(!0))}catch(ce){console.error("[StreamViewer] Error parsing event:",ce)}};ie.addEventListener("connected",oe=>{console.log('[StreamViewer] Received "connected" event:',oe)}),ie.addEventListener("heartbeat",()=>{console.log("[StreamViewer] Received heartbeat")}),ie.addEventListener("agent_system",te),ie.addEventListener("agent_assistant",te),ie.addEventListener("agent_user",te),ie.addEventListener("agent_tool_use",te),ie.addEventListener("agent_tool_result",te),ie.addEventListener("agent_error",te),ie.addEventListener("agent_result",te),ie.addEventListener("agent_exit",oe=>{try{const ce=JSON.parse(oe.data),Z=ce.code===0?"The agent has stopped the session":`The agent session ended unexpectedly (exit code ${ce.code})${ce.signal?` (signal: ${ce.signal})`:""}`,ue={id:`exit-${Date.now()}`,type:"system",timestamp:Date.now(),content:Z};f(H=>[...H,ue])}catch(ce){console.error("[StreamViewer] Error parsing exit event:",ce)}}),ie.onmessage=oe=>{try{const ce=JSON.parse(oe.data);if(ce.type==="connected"||ce.type==="heartbeat")return;te(oe)}catch(ce){console.error("[StreamViewer] Error parsing message:",ce)}},ie.onerror=oe=>{if(console.log("[StreamViewer] SSE error:",oe),console.log("[StreamViewer] ReadyState on error:",ie.readyState),q.current){q.current=!1;return}if(M("error"),ie.close(),O.current<R){O.current++;const ce=Math.min(1e3*Math.pow(2,O.current),3e4);console.log(`[StreamViewer] Reconnecting in ${ce}ms (attempt ${O.current}/${R})`),setTimeout(ee,ce)}else console.log("[StreamViewer] Max reconnect attempts reached")}};return q.current=!1,ee(),()=>{if(T.current){q.current=!0;const Y=T.current;Y.onopen=null,Y.onmessage=null,Y.onerror=null,Y.close(),T.current=null}}},[e,r,a,M]);const B=w.useCallback(async ee=>{try{if(!a&&n&&i){N(!0),z(!0),await i(n,ee);return}const Y={id:`user-${Date.now()}`,type:"user",timestamp:Date.now(),content:ee};f(fe=>[...fe,Y]);const ie=await fetch(`${Xee}/${e}/input`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:ee,isUserMessage:!0})});if(!ie.ok)throw new Error(`HTTP ${ie.status}`);N(!0),z(!0)}catch(Y){console.error("[StreamViewer] Error sending input:",Y);const ie={id:`error-${Date.now()}`,type:"error",timestamp:Date.now(),content:`Failed to send message: ${Y instanceof Error?Y.message:"Unknown error"}`,isError:!0};throw f(fe=>[...fe,ie]),N(!1),Y}},[e,a,n,i,z]),F=w.useCallback(async ee=>{try{const Y=await ee.arrayBuffer(),ie=btoa(new Uint8Array(Y).reduce((te,oe)=>te+String.fromCharCode(oe),"")),fe=await fetch(`${s}/api/terminal/upload`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:ee.name,data:ie})});if(!fe.ok){const te=await fe.json().catch(()=>({}));throw new Error(te.error?.message||`Upload failed: ${fe.status}`)}return(await fe.json()).path}catch(Y){console.error("[StreamViewer] File upload failed:",Y);const ie={id:`error-${Date.now()}`,type:"error",timestamp:Date.now(),content:`File upload failed: ${Y instanceof Error?Y.message:"Unknown error"}`,isError:!0};return f(fe=>[...fe,ie]),null}},[s]),U=w.useCallback(ee=>Array.from(ee.dataTransfer.types).includes("application/x-workspace-pane"),[]),V=w.useCallback(async ee=>{if(U(ee)||(ee.preventDefault(),ee.stopPropagation(),b(!1),!c||m!=="connected"))return;const Y=Array.from(ee.dataTransfer.files);if(Y.length===0)return;S(!0);const ie={id:`system-${Date.now()}`,type:"system",timestamp:Date.now(),content:`Uploading ${Y.length} file(s)...`};f(me=>[...me,ie]);const fe=[];for(const me of Y){const te=await F(me);te&&fe.push(te)}if(S(!1),fe.length>0){const me=fe.join(" "),te={id:`system-${Date.now()+1}`,type:"system",timestamp:Date.now(),content:`${fe.length} file(s) uploaded:
${me}`};f(oe=>[...oe,te]),await B(me)}},[c,m,F,B,U]),K=w.useCallback(ee=>{if(U(ee)){ee.preventDefault();return}ee.preventDefault(),ee.stopPropagation(),c&&m==="connected"&&b(!0)},[c,m,U]),G=w.useCallback(ee=>{if(U(ee)){ee.preventDefault();return}ee.preventDefault(),ee.stopPropagation(),c&&m==="connected"&&b(!0)},[c,m,U]),J=w.useCallback(ee=>{if(U(ee))return;ee.preventDefault(),ee.stopPropagation();const Y=E.current?.getBoundingClientRect();if(Y){const{clientX:ie,clientY:fe}=ee;(ie<Y.left||ie>=Y.right||fe<Y.top||fe>=Y.bottom)&&b(!1)}},[U]);return o.jsxs("div",{ref:E,className:"relative flex flex-col h-full bg-[var(--color-bg-secondary)]","data-testid":u,"data-status":m,"data-drag-over":v,onDrop:V,onDragOver:K,onDragEnter:G,onDragLeave:J,children:[v&&c&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-primary)]/20 border-2 border-dashed border-[var(--color-primary)] rounded-lg pointer-events-none","data-testid":"file-drop-overlay",children:o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 rounded-lg bg-[var(--color-bg)]/90 shadow-lg",children:[o.jsx("svg",{className:"w-10 h-10 text-[var(--color-primary)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Drop files to upload"}),o.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"File paths will be added to input"})]})}),y&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-bg)]/50 pointer-events-none","data-testid":"upload-progress-overlay",children:o.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-[var(--color-bg)] shadow-lg border border-[var(--color-border)]",children:[o.jsxs("svg",{className:"w-5 h-5 text-[var(--color-primary)] animate-spin",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Uploading..."})]})}),o.jsx("div",{ref:k,className:"flex-1 overflow-y-auto p-3 space-y-1",onScroll:I,"data-testid":"stream-events",children:d.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-[var(--color-text-tertiary)]",children:[o.jsx(Xr,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:m==="connected"?`Waiting for output from ${t}...`:m==="connecting"?"Connecting...":"Not connected"})]}):o.jsxs(o.Fragment,{children:[Yct(d).map((ee,Y,ie)=>{const fe=Y===ie.length-1&&!_;return ee.type==="tool-group"?o.jsx(Qct,{events:ee.events,isLast:fe},`group-${ee.events[0].id}`):o.jsx(x0e,{event:ee.event,isLast:fe},ee.event.id)}),_&&m==="connected"&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-[var(--color-text-secondary)] animate-fade-in","data-testid":"working-indicator",children:[o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm",children:"Agent is working..."})]})]})}),o.jsx(y0e,{isConnected:m==="connected"||!a&&!!n&&!!i,onSend:B,connectedPlaceholder:a?void 0:"Send a message to resume this session...","data-testid":"stream-input"})]})}const S0e="stoneforge-session-transcript-";function Jct(e){try{const t=localStorage.getItem(`${S0e}${e}`);if(t)return JSON.parse(t)}catch(t){console.error("[SessionHistory] Failed to load transcript:",t)}return[]}function Zct(e){try{localStorage.removeItem(`${S0e}${e}`)}catch(t){console.error("[SessionHistory] Failed to clear transcript:",t)}}function Xct(e){if(!e)return"Unknown";const t=new Date(e),r=new Date,n=t.toDateString()===r.toDateString(),a=new Date(r.getTime()-864e5).toDateString()===t.toDateString();return n?`Today ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:a?`Yesterday ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:t.toLocaleDateString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function eut(e){const t=e.match(/\*\*Title\*\*:\s*(.+?)(?:\n|$)/);if(t?.[1])return t[1].trim();const r=e.match(/Title:\s*(.+?)(?:\n|$)/);return r?.[1]?r[1].trim():null}function tut(e){const t=e.match(/\*\*Task ID\*\*:\s*(.+?)(?:\n|$)/);if(t?.[1])return t[1].trim();const r=e.match(/Task ID:\s*(.+?)(?:\n|$)/);return r?.[1]?r[1].trim():null}function $L(e){if(e.content?.trim()){const t=e.content.trim();if(t.includes("You have been assigned the following task")){const r=eut(t);if(r)return r}return t}if(e.type==="tool_use"&&e.toolInput){const t=typeof e.toolInput=="string"?e.toolInput:JSON.stringify(e.toolInput);if(t.trim())return t.trim()}if(e.type==="tool_result"&&e.toolOutput?.trim())return e.toolOutput.trim()}function k0e(e,t){if(e.worktree){const l=e.worktree.split("/"),c=l[l.length-1];if(c&&!c.startsWith("worktree-"))return c.replace(/-/g," ")}const r=t.find(l=>l.type==="user"),n=r?$L(r):void 0;if(n)return n.length>100?n.slice(0,100)+"...":n;const a=t.find(l=>l.type==="assistant"),i=a?$L(a):void 0;if(i){const l=i.split(`
`)[0].split(".")[0];if(l.length>100)return l.slice(0,100)+"...";if(l.length>0)return l}for(const l of t){if(l.type==="system"||l.type==="error")continue;const c=$L(l);if(c){const u=c.split(`
`)[0];if(u.length>100)return u.slice(0,100)+"...";if(u.length>0)return u}}return`Session from ${new Date(e.startedAt||e.createdAt).toLocaleDateString([],{month:"short",day:"numeric"})}`}function rut({session:e,transcript:t,isSelected:r,onClick:n,onDelete:a,onOpen:i}){const[s,l]=w.useState(!1),c=k0e(e,t),u=Xct(e.startedAt||e.createdAt),d=w.useMemo(()=>{const v=t.find(b=>b.type==="user"&&b.content);return v?.content?.includes("You have been assigned the following task")?tut(v.content):null},[t]),f=v=>{v.stopPropagation(),l(!0)},m=v=>{v.stopPropagation(),a(),l(!1)},p=v=>{v.stopPropagation(),l(!1)};return o.jsxs("div",{className:`
        group flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-colors
        ${r?"bg-[var(--color-primary)]/10 border border-[var(--color-primary)]/30":"hover:bg-[var(--color-surface-hover)] border border-transparent"}
      `,onClick:n,"data-testid":`session-item-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(ss,{className:`w-4 h-4 ${r?"text-[var(--color-primary)]":"text-[var(--color-text-muted)]"}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:`text-sm font-medium truncate ${r?"text-[var(--color-primary)]":"text-[var(--color-text)]"}`,children:c}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsx("span",{children:u}),d&&o.jsx("span",{className:"px-1.5 py-0.5 rounded bg-[var(--color-primary)]/10 text-[var(--color-primary)] text-[10px] font-mono",children:d})]})]}),o.jsx("div",{className:"flex items-center gap-1",children:s?o.jsxs("div",{className:"flex items-center gap-1",onClick:v=>v.stopPropagation(),children:[o.jsx("button",{onClick:m,className:"px-2 py-0.5 text-xs rounded bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Delete"}),o.jsx("button",{onClick:p,className:"px-2 py-0.5 text-xs rounded bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:bg-[var(--color-border)] transition-colors",children:"Cancel"})]}):o.jsxs(o.Fragment,{children:[i&&o.jsx("button",{onClick:v=>{v.stopPropagation(),i()},className:"p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity text-[var(--color-text-muted)] hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",title:"Open session",children:o.jsx(du,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:f,className:"p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity text-[var(--color-text-muted)] hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete transcript",children:o.jsx(Sr,{className:"w-3.5 h-3.5"})}),o.jsx(gn,{className:`w-4 h-4 ${r?"text-[var(--color-primary)]":"text-[var(--color-text-muted)]"}`})]})})]})}function nut({isOpen:e,onClose:t,agentName:r,sessions:n,onViewSession:a}){const[i,s]=w.useState(null),[l,c]=w.useState({}),[u,d]=w.useState(!1);w.useEffect(()=>{if(!e)return;let b=!1;d(!0);async function y(){const S={};await Promise.all(n.map(async _=>{try{const N=await nme(_.id);if(!b&&N.messages&&N.messages.length>0){S[_.id]=N.messages.map(qme);return}}catch(N){console.debug("[SessionHistory] Server fetch failed, trying localStorage:",N)}b||(S[_.id]=Jct(_.id))})),b||(c(S),s(null),d(!1))}return y(),()=>{b=!0}},[e,n]);const f=w.useMemo(()=>{const b=n.filter(S=>(l[S.id]?.length||0)>0),y=new Map;for(const S of b){const _=S.providerSessionId||S.id,N=y.get(_);if(!N)y.set(_,S);else{const k=N.startedAt||N.createdAt,j=S.startedAt||S.createdAt,E=typeof k=="number"?k:new Date(k).getTime();(typeof j=="number"?j:new Date(j).getTime())>E&&y.set(_,S)}}return Array.from(y.values())},[n,l]),m=w.useMemo(()=>i?l[i]||[]:[],[i,l]),p=b=>{Zct(b),c(y=>({...y,[b]:[]})),b===i&&s(null)};if(!e)return null;const v=i!==null;return o.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4","data-testid":"session-history-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),o.jsxs("div",{className:"relative w-full max-w-3xl h-[70%] max-h-[500px] bg-[var(--color-bg)] rounded-xl shadow-2xl border border-[var(--color-border)] flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Xf,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Session History"}),o.jsxs("span",{className:"text-sm text-[var(--color-text-muted)]",children:[" ",r]})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"session-history-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"flex-1 flex min-h-0",children:u?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-[var(--color-text-muted)] p-6",children:[o.jsx(Xf,{className:"w-12 h-12 mb-3 opacity-50 animate-pulse"}),o.jsx("p",{className:"text-sm",children:"Loading session history..."})]}):f.length===0?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-[var(--color-text-muted)] p-6",children:[o.jsx(Xf,{className:"w-12 h-12 mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No session history available"}),o.jsx("p",{className:"text-xs mt-1",children:"Sessions will appear here after you start using this agent"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`${v?"w-72 border-r border-[var(--color-border)]":"flex-1"} overflow-y-auto p-2 flex-shrink-0`,children:f.map(b=>o.jsx(rut,{session:b,transcript:l[b.id]||[],isSelected:b.id===i,onClick:()=>s(b.id),onDelete:()=>p(b.id),onOpen:a?()=>a(b.id,b.providerSessionId):void 0},b.id))}),v&&(()=>{const b=f.find(y=>y.id===i);return o.jsxs("div",{className:"flex-1 min-w-0 bg-[var(--color-bg-secondary)] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:k0e(b,m)}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a&&o.jsxs("button",{onClick:()=>{a(b.id,b.providerSessionId),t()},className:"flex items-center gap-1.5 px-2.5 py-1 rounded text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Open this session (send a message to resume)",children:[o.jsx(du,{className:"w-3.5 h-3.5"}),"Open"]}),o.jsx("button",{onClick:()=>s(null),className:"p-1 rounded text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Close transcript",children:o.jsx(wt,{className:"w-4 h-4"})})]})]}),o.jsx("div",{className:"flex-1 min-h-0",children:o.jsx(Wme,{events:m})})]})})()]})})]})]})}const ete={disconnected:"bg-gray-400",connecting:"bg-yellow-500 animate-pulse",connected:"bg-green-500",error:"bg-red-500"},tte={disconnected:"Disconnected",connecting:"Connecting...",connected:"Connected",error:"Error"},rte={director:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",icon:na},worker:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",icon:na},steward:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",icon:t0}},aut=w.forwardRef(function({pane:t,isActive:r,isMaximized:n,isSingleMode:a=!1,draggable:i=!1,onClose:s,onMaximize:l,onMinimize:c,onFocus:u,onStatusChange:d,onDragStart:f,onDragOver:m,onDrop:p,onDragEnd:v},b){const[y,S]=w.useState(!1),[_,N]=w.useState(!1),[k,j]=w.useState(!1),[E,T]=w.useState(!1),[O,R]=w.useState(void 0),[q,$]=w.useState(void 0),[L,A]=w.useState(!1),M=w.useRef(null),z=w.useRef(null),{data:I}=kB(t.agentRole!=="director"?t.agentId:void 0),B=p2(),F=f1(),U=IQe(),V=_B(),K=I?.hasActiveSession??!1;w.useEffect(()=>{I?.activeSession?.id?(R(I.activeSession.id),$(I.activeSession.providerSessionId),A(!1)):O&&!K&&A(!0)},[I?.activeSession?.id,I?.activeSession?.providerSessionId,K,O]);const G=w.useCallback(async()=>{try{const ue=M.current?.getDimensions();await B.mutateAsync({agentId:t.agentId,interactive:t.paneType==="terminal",...ue&&{cols:ue.cols,rows:ue.rows}})}catch(ue){console.error("Failed to start session:",ue)}},[t.agentId,t.paneType,B]),J=w.useCallback(async()=>{try{await F.mutateAsync({agentId:t.agentId,graceful:!0}),R(void 0),$(void 0),A(!1)}catch(ue){console.error("Failed to stop session:",ue)}},[t.agentId,F]),ee=w.useCallback((ue,H)=>{R(ue),$(H),A(!0),j(!1)},[]),Y=w.useCallback(async(ue,H)=>{try{A(!1),await V.mutateAsync({agentId:t.agentId,providerSessionId:ue,resumePrompt:H})}catch(ge){throw console.error("Failed to resume session:",ge),A(!0),ge}},[t.agentId,V]),ie=w.useRef(d);w.useEffect(()=>{ie.current=d},[d]),w.useEffect(()=>{if(!E||!K||t.agentRole==="director")return;const ue=H=>{H.key==="Escape"&&!U.isPending&&(H.preventDefault(),H.stopPropagation(),U.mutate({agentId:t.agentId}))};return window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue)},[E,K,t.agentId,t.agentRole,U]);const fe=w.useCallback(ue=>{ie.current(ue)},[]),me=w.useCallback(()=>{M.current?.refresh()},[]),te=w.useCallback(ue=>{M.current?.sendInput(ue),M.current?.sendInput("\r")},[]),oe=w.useCallback(()=>{N(ue=>!ue),S(!1)},[]);w.useImperativeHandle(b,()=>({refresh:me}),[me]);const ce=rte[t.agentRole]||rte.worker,Z=ce.icon;return o.jsxs("div",{ref:z,tabIndex:0,className:`
        flex flex-col h-full
        rounded-lg border overflow-hidden
        transition-all duration-150
        ${r?"border-[var(--color-primary)] ring-1 ring-[var(--color-primary)]/30":"border-[var(--color-border)]"}
        bg-[var(--color-bg-secondary)]
        focus:outline-none
      `,onClick:u,onFocus:()=>T(!0),onBlur:()=>T(!1),"data-testid":`workspace-pane-${t.id}`,"data-pane-id":t.id,"data-agent-id":t.agentId,"data-pane-type":t.paneType,children:[o.jsxs("div",{className:`
          flex items-center justify-between
          px-3 py-2
          border-b border-[var(--color-border)]
          bg-[var(--color-surface)]
          ${i?"cursor-grab active:cursor-grabbing":""}
        `,draggable:i,onDragStart:f,onDragOver:m,onDrop:p,onDragEnd:v,"data-testid":"pane-header",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full flex-shrink-0 ${t.agentRole==="director"||K?ete[t.status]:"bg-gray-400"}`,title:t.agentRole==="director"||K?tte[t.status]:"Session not running"}),o.jsxs("span",{className:`
            inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium flex-shrink-0
            ${ce.bg} ${ce.text}
          `,children:[o.jsx(Z,{className:"w-3 h-3"}),t.agentRole]}),o.jsx("span",{className:"text-sm font-mono text-[var(--color-text)] truncate",title:t.agentName,children:t.agentName}),t.workerMode&&o.jsx("span",{className:`
              px-1.5 py-0.5 rounded text-xs
              bg-[var(--color-surface-hover)] text-[var(--color-text-tertiary)]
              flex-shrink-0
            `,children:t.workerMode})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[t.agentRole!=="director"&&o.jsx(o.Fragment,{children:K?o.jsx(Cn,{content:"Stop Session",side:"bottom",children:o.jsx("button",{onClick:ue=>{ue.stopPropagation(),J()},disabled:F.isPending,className:`
                      p-1 rounded
                      text-red-600 dark:text-red-400
                      hover:bg-[var(--color-surface-hover)]
                      transition-colors
                      disabled:opacity-50
                    `,title:"Stop Session","data-testid":"pane-stop-session",children:F.isPending?o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(uu,{className:"w-3.5 h-3.5"})})}):o.jsx(Cn,{content:"Start Session",side:"bottom",children:o.jsx("button",{onClick:ue=>{ue.stopPropagation(),G()},disabled:B.isPending,className:`
                      p-1 rounded
                      text-green-600 dark:text-green-400
                      hover:bg-[var(--color-surface-hover)]
                      transition-colors
                      disabled:opacity-50
                    `,title:"Start Session","data-testid":"pane-start-session",children:B.isPending?o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(en,{className:"w-3.5 h-3.5"})})})}),!a&&o.jsx("button",{onClick:ue=>{ue.stopPropagation(),n?c():l()},className:`
                p-1 rounded
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,title:n?"Restore":"Maximize","data-testid":"pane-maximize-btn",children:n?o.jsx(D6,{className:"w-3.5 h-3.5"}):o.jsx(JC,{className:"w-3.5 h-3.5"})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:ue=>{ue.stopPropagation(),S(!y)},className:`
                p-1 rounded
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,title:"More options","data-testid":"pane-menu-btn",children:o.jsx(n0,{className:"w-3.5 h-3.5"})}),y&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>S(!1)}),o.jsxs("div",{className:`
                    absolute right-0 top-full mt-1 z-20
                    min-w-40 py-1 rounded-md shadow-lg
                    bg-[var(--color-bg)] border border-[var(--color-border)]
                  `,"data-testid":"pane-menu",children:[t.paneType==="terminal"&&t.agentRole!=="director"&&o.jsxs("button",{onClick:ue=>{ue.stopPropagation(),S(!1),me()},className:`
                        w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                        text-[var(--color-text-secondary)]
                        hover:bg-[var(--color-surface-hover)]
                      `,children:[o.jsx(Qae,{className:"w-4 h-4"}),"Refresh"]}),t.paneType==="terminal"&&t.agentRole!=="director"&&o.jsx("button",{onClick:ue=>{ue.stopPropagation(),oe()},className:`
                        w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                        text-[var(--color-text-secondary)]
                        hover:bg-[var(--color-surface-hover)]
                      `,"data-testid":"pane-toggle-textbox",children:_?o.jsxs(o.Fragment,{children:[o.jsx(Nwe,{className:"w-4 h-4"}),"Hide textbox"]}):o.jsxs(o.Fragment,{children:[o.jsx(ss,{className:"w-4 h-4"}),"Show textbox"]})}),(t.workerMode==="ephemeral"||t.agentRole==="steward")&&t.agentRole!=="director"&&o.jsxs("button",{onClick:ue=>{ue.stopPropagation(),S(!1),j(!0)},className:`
                        w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                        text-[var(--color-text-secondary)]
                        hover:bg-[var(--color-surface-hover)]
                      `,"data-testid":"pane-view-history",children:[o.jsx(Xf,{className:"w-4 h-4"}),"View history"]}),o.jsxs("button",{onClick:ue=>{ue.stopPropagation(),S(!1);const ge=`/popout/terminal?${new URLSearchParams({agent:t.agentId,type:t.paneType,name:t.agentName,role:t.agentRole,...t.workerMode&&{mode:t.workerMode}}).toString()}`;window.open(ge,`terminal-${t.agentId}`,"width=800,height=600,menubar=no,toolbar=no,location=no,status=no"),s()},className:`
                      w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                      text-[var(--color-text-secondary)]
                      hover:bg-[var(--color-surface-hover)]
                    `,children:[o.jsx(ZC,{className:"w-4 h-4"}),"Pop out"]})]})]})]}),o.jsx("button",{onClick:ue=>{ue.stopPropagation(),s()},className:`
              p-1 rounded
              text-[var(--color-text-tertiary)]
              hover:text-red-500
              hover:bg-red-50 dark:hover:bg-red-900/20
              transition-colors
            `,title:"Close pane","data-testid":"pane-close-btn",children:o.jsx(wt,{className:"w-3.5 h-3.5"})})]})]}),o.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden relative flex flex-col","data-testid":"pane-content",children:[t.agentRole==="director"?o.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 p-6 text-center bg-[#1a1a1a]",children:[o.jsx(na,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-2",children:"Director Terminal"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-xs",children:"Use the Director panel on the right for interactive terminal access."})]}):t.paneType==="terminal"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 min-h-0",children:o.jsx(xB,{ref:M,agentId:t.agentId,onStatusChange:fe,interactive:!0,autoFocus:!0,controlsResize:!0,"data-testid":`terminal-${t.id}`})}),_&&o.jsx(y0e,{isConnected:t.status==="connected"&&K,onSend:te,connectedPlaceholder:"Type a command...",disconnectedPlaceholder:"Start session to send commands","data-testid":`textbox-${t.id}`})]}):o.jsx(w0e,{agentId:t.agentId,agentName:t.agentName,sessionId:O,providerSessionId:q,hasActiveSession:K,onResumeWithMessage:Y,onStatusChange:fe,"data-testid":`stream-${t.id}`}),t.agentRole!=="director"&&(!K||F.isPending)&&!L&&!V.isPending&&o.jsx("div",{className:`
              absolute inset-0 z-10
              flex flex-col items-center justify-center
              bg-[#1a1a1a]/95 backdrop-blur-sm
              overflow-y-auto p-3
            `,"data-testid":"pane-idle-overlay",children:F.isPending?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-3",children:[o.jsx("div",{className:"absolute inset-0 bg-amber-500/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                    relative p-2.5 rounded-xl
                    bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                    border border-[#333]
                    shadow-lg
                  `,children:o.jsx(jr,{className:"w-7 h-7 text-amber-400 animate-spin"})})]}),o.jsxs("div",{className:"text-center mb-3",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-0.5",children:"Shutting Down"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-[280px] px-2",children:"Gracefully stopping the session..."})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"0ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"150ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"300ms"}})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-3 flex-shrink-0",children:[o.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                    relative p-2.5 rounded-xl
                    bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                    border border-[#333]
                    shadow-lg
                  `,children:t.status==="error"?o.jsx(Bt,{className:"w-7 h-7 text-red-400"}):o.jsx(Uae,{className:"w-7 h-7 text-[var(--color-text-muted)]"})})]}),o.jsxs("div",{className:"text-center mb-3 flex-shrink-0",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-0.5",children:t.status==="error"?"Session Error":"Session Idle"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-[280px] px-2",children:t.status==="error"?"The agent session encountered an error.":`Start a session to interact with ${t.agentName}.`})]}),o.jsx("button",{onClick:G,disabled:B.isPending,className:`
                    inline-flex items-center gap-2 flex-shrink-0
                    px-4 py-2 rounded-lg
                    bg-gradient-to-r from-green-600 to-green-500
                    hover:from-green-500 hover:to-green-400
                    text-white font-medium text-sm
                    shadow-lg shadow-green-500/25
                    transition-all duration-200
                    hover:scale-105 hover:shadow-green-500/40
                    disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                    focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                  `,"data-testid":"pane-overlay-start-btn",children:B.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-3.5 h-3.5"}),"Start Session"]})}),o.jsxs("div",{className:`
                  mt-3 px-2.5 py-1 rounded-full flex-shrink-0
                  bg-[#252525] border border-[#333]
                  text-[10px] text-[var(--color-text-tertiary)]
                `,children:[t.workerMode==="persistent"?"Persistent Worker":"Ephemeral Worker","  ",t.paneType==="terminal"?"Interactive":"Stream"]})]})})]}),(t.workerMode==="ephemeral"||t.agentRole==="steward")&&o.jsx(nut,{isOpen:k,onClose:()=>j(!1),agentId:t.agentId,agentName:t.agentName,sessions:I?.recentHistory??[],onViewSession:ee})]})});function un(e,t="Assertion error"){if(!e)throw Error(t)}function Ug({group:e}){const{orientation:t,panels:r}=e;return r.reduce((n,a)=>(n+=t==="horizontal"?a.element.offsetWidth:a.element.offsetHeight,n),0)}function e5(e,t){return t.sort(e==="horizontal"?iut:sut)}function iut(e,t){const r=e.element.offsetLeft-t.element.offsetLeft;return r!==0?r:e.element.offsetWidth-t.element.offsetWidth}function sut(e,t){const r=e.element.offsetTop-t.element.offsetTop;return r!==0?r:e.element.offsetHeight-t.element.offsetHeight}function _0e(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function N0e(e,t){return{x:e.x>=t.left&&e.x<=t.right?0:Math.min(Math.abs(e.x-t.left),Math.abs(e.x-t.right)),y:e.y>=t.top&&e.y<=t.bottom?0:Math.min(Math.abs(e.y-t.top),Math.abs(e.y-t.bottom))}}function out({orientation:e,rects:t,targetRect:r}){const n={x:r.x+r.width/2,y:r.y+r.height/2};let a,i=Number.MAX_VALUE;for(const s of t){const{x:l,y:c}=N0e(n,s),u=e==="horizontal"?l:c;u<i&&(i=u,a=s)}return un(a,"No rect found"),a}let KS;function lut(){return KS===void 0&&(typeof matchMedia=="function"?KS=!!matchMedia("(pointer:coarse)").matches:KS=!1),KS}function C0e(e){const{element:t,orientation:r,panels:n,separators:a}=e,i=e5(r,Array.from(t.children).filter(_0e).map(d=>({element:d}))).map(({element:d})=>d),s=[];let l=!1,c,u=[];for(const d of i)if(d.hasAttribute("data-panel")){const f=n.find(m=>m.element===d);if(f){if(c){const m=c.element.getBoundingClientRect(),p=d.getBoundingClientRect();let v;if(l){const b=r==="horizontal"?new DOMRect(m.right,m.top,0,m.height):new DOMRect(m.left,m.bottom,m.width,0),y=r==="horizontal"?new DOMRect(p.left,p.top,0,p.height):new DOMRect(p.left,p.top,p.width,0);switch(u.length){case 0:{v=[b,y];break}case 1:{const S=u[0],_=out({orientation:r,rects:[m,p],targetRect:S.element.getBoundingClientRect()});v=[S,_===m?y:b];break}default:{v=u;break}}}else u.length?v=u:v=[r==="horizontal"?new DOMRect(m.right,p.top,p.left-m.right,p.height):new DOMRect(p.left,m.bottom,p.width,p.top-m.bottom)];for(const b of v){let y="width"in b?b:b.element.getBoundingClientRect();const S=lut()?e.resizeTargetMinimumSize.coarse:e.resizeTargetMinimumSize.fine;if(y.width<S){const _=S-y.width;y=new DOMRect(y.x-_/2,y.y,y.width+_,y.height)}if(y.height<S){const _=S-y.height;y=new DOMRect(y.x,y.y-_/2,y.width,y.height+_)}s.push({group:e,groupSize:Ug({group:e}),panels:[c,f],separator:"width"in b?void 0:b,rect:y})}}l=!1,c=f,u=[]}}else if(d.hasAttribute("data-separator")){const f=a.find(m=>m.element===d);f?u.push(f):(c=void 0,u=[])}else l=!0;return s}function cut(e,t){const r=getComputedStyle(e),n=parseFloat(r.fontSize);return t*n}function uut(e,t){const r=getComputedStyle(e.ownerDocument.body),n=parseFloat(r.fontSize);return t*n}function dut(e){return e/100*window.innerHeight}function fut(e){return e/100*window.innerWidth}function hut(e){switch(typeof e){case"number":return[e,"px"];case"string":{const t=parseFloat(e);return e.endsWith("%")?[t,"%"]:e.endsWith("px")?[t,"px"]:e.endsWith("rem")?[t,"rem"]:e.endsWith("em")?[t,"em"]:e.endsWith("vh")?[t,"vh"]:e.endsWith("vw")?[t,"vw"]:[t,"%"]}}}function GS({groupSize:e,panelElement:t,styleProp:r}){let n;const[a,i]=hut(r);switch(i){case"%":{n=a/100*e;break}case"px":{n=a;break}case"rem":{n=uut(t,a);break}case"em":{n=cut(t,a);break}case"vh":{n=dut(a);break}case"vw":{n=fut(a);break}}return n}function Yo(e){return parseFloat(e.toFixed(3))}function nte(e){const{panels:t}=e,r=Ug({group:e});return r===0?t.map(n=>({collapsedSize:0,collapsible:n.panelConstraints.collapsible===!0,defaultSize:void 0,minSize:0,maxSize:100,panelId:n.id})):t.map(n=>{const{element:a,panelConstraints:i}=n;let s=0;if(i.collapsedSize!==void 0){const d=GS({groupSize:r,panelElement:a,styleProp:i.collapsedSize});s=Yo(d/r*100)}let l;if(i.defaultSize!==void 0){const d=GS({groupSize:r,panelElement:a,styleProp:i.defaultSize});l=Yo(d/r*100)}let c=0;if(i.minSize!==void 0){const d=GS({groupSize:r,panelElement:a,styleProp:i.minSize});c=Yo(d/r*100)}let u=100;if(i.maxSize!==void 0){const d=GS({groupSize:r,panelElement:a,styleProp:i.maxSize});u=Yo(d/r*100)}return{collapsedSize:s,collapsible:i.collapsible===!0,defaultSize:l,minSize:c,maxSize:u,panelId:n.id}})}var md;class mut{constructor(){CH(this,md,{})}addListener(t,r){const n=gv(this,md)[t];return n===void 0?gv(this,md)[t]=[r]:n.includes(r)||n.push(r),()=>{this.removeListener(t,r)}}emit(t,r){const n=gv(this,md)[t];if(n!==void 0)if(n.length===1)n[0].call(null,r);else{let a=!1,i=null;const s=Array.from(n);for(let l=0;l<s.length;l++){const c=s[l];try{c.call(null,r)}catch(u){i===null&&(a=!0,i=u)}}if(a)throw i}}removeAllListeners(){jH(this,md,{})}removeListener(t,r){const n=gv(this,md)[t];if(n!==void 0){const a=n.indexOf(r);a>=0&&n.splice(a,1)}}}md=new WeakMap;function Ti(e,t,r=0){return Math.abs(Yo(e)-Yo(t))<=r}let lo={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map};const hh=new mut;function Is(){return lo}function ts(e){const t=typeof e=="function"?e(lo):e;if(lo===t)return lo;const r=lo;return lo={...lo,...t},t.cursorFlags!==void 0&&hh.emit("cursorFlagsChange",lo.cursorFlags),t.interactionState!==void 0&&hh.emit("interactionStateChange",lo.interactionState),t.mountedGroups!==void 0&&(lo.mountedGroups.forEach((n,a)=>{n.derivedPanelConstraints.forEach(i=>{if(i.collapsible){const{layout:s}=r.mountedGroups.get(a)??{};if(s){const l=Ti(i.collapsedSize,n.layout[i.panelId]),c=Ti(i.collapsedSize,s[i.panelId]);l&&!c&&(a.inMemoryLastExpandedPanelSizes[i.panelId]=s[i.panelId])}}})}),hh.emit("mountedGroupsChange",lo.mountedGroups)),lo}function put(e,t,r){let n,a={x:1/0,y:1/0};for(const i of t){const s=N0e(r,i.rect);switch(e){case"horizontal":{s.x<=a.x&&(n=i,a=s);break}case"vertical":{s.y<=a.y&&(n=i,a=s);break}}}return n?{distance:a,hitRegion:n}:void 0}function gut(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function vut(e,t){if(e===t)throw new Error("Cannot compare node with itself");const r={a:ste(e),b:ste(t)};let n;for(;r.a.at(-1)===r.b.at(-1);)e=r.a.pop(),t=r.b.pop(),n=e;un(n,"Stacking order can only be calculated for elements with a common ancestor");const a={a:ite(ate(r.a)),b:ite(ate(r.b))};if(a.a===a.b){const i=n.childNodes,s={a:r.a.at(-1),b:r.b.at(-1)};let l=i.length;for(;l--;){const c=i[l];if(c===s.a)return 1;if(c===s.b)return-1}}return Math.sign(a.a-a.b)}const but=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function yut(e){const t=getComputedStyle(j0e(e)??e).display;return t==="flex"||t==="inline-flex"}function xut(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||yut(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||but.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function ate(e){let t=e.length;for(;t--;){const r=e[t];if(un(r,"Missing node"),xut(r))return r}return null}function ite(e){return e&&Number(getComputedStyle(e).zIndex)||0}function ste(e){const t=[];for(;e;)t.push(e),e=j0e(e);return t}function j0e(e){const{parentNode:t}=e;return gut(t)?t.host:t}function wut(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function Sut({groupElement:e,hitRegion:t,pointerEventTarget:r}){if(!_0e(r)||r.contains(e)||e.contains(r))return!0;if(vut(r,e)>0){let n=r;for(;n;){if(n.contains(e))return!0;if(wut(n.getBoundingClientRect(),t))return!1;n=n.parentElement}}return!0}function t$(e,t){const r=[];return t.forEach((n,a)=>{if(a.disabled)return;const i=C0e(a),s=put(a.orientation,i,{x:e.clientX,y:e.clientY});s&&s.distance.x<=0&&s.distance.y<=0&&Sut({groupElement:a.element,hitRegion:s.hitRegion.rect,pointerEventTarget:e.target})&&r.push(s.hitRegion)}),r}function kut(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function Pc(e,t){return Ti(e,t)?0:e>t?1:-1}function Lp({panelConstraints:e,size:t}){const{collapsedSize:r=0,collapsible:n,maxSize:a=100,minSize:i=0}=e;if(Pc(t,i)<0)if(n){const s=(r+i)/2;Pc(t,s)<0?t=r:t=i}else t=i;return t=Math.min(a,t),t=Yo(t),t}function xx({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:n,prevLayout:a,trigger:i}){if(Ti(e,0))return t;const s=Object.values(t),l=Object.values(a),c=[...s],[u,d]=n;un(u!=null,"Invalid first pivot index"),un(d!=null,"Invalid second pivot index");let f=0;switch(i){case"keyboard":{{const v=e<0?d:u,b=r[v];un(b,`Panel constraints not found for index ${v}`);const{collapsedSize:y=0,collapsible:S,minSize:_=0}=b;if(S){const N=s[v];if(un(N!=null,`Previous layout not found for panel index ${v}`),Ti(N,y)){const k=_-N;Pc(k,Math.abs(e))>0&&(e=e<0?0-k:k)}}}{const v=e<0?u:d,b=r[v];un(b,`No panel constraints found for index ${v}`);const{collapsedSize:y=0,collapsible:S,minSize:_=0}=b;if(S){const N=s[v];if(un(N!=null,`Previous layout not found for panel index ${v}`),Ti(N,_)){const k=N-y;Pc(k,Math.abs(e))>0&&(e=e<0?0-k:k)}}}break}default:{const v=e<0?d:u,b=r[v];un(b,`Panel constraints not found for index ${v}`);const{collapsible:y,collapsedSize:S,minSize:_}=b;if(y)if(e>0){const N=_-S,k=N/2;Pc(e,_)<0&&(e=Pc(e,k)<=0?0:N)}else{const N=_-S,k=100-N/2;Pc(100+e,_)>0&&(e=Pc(100+e,k)>0?0:-N)}break}}{const v=e<0?1:-1;let b=e<0?d:u,y=0;for(;;){const _=s[b];un(_!=null,`Previous layout not found for panel index ${b}`);const N=Lp({panelConstraints:r[b],size:100})-_;if(y+=N,b+=v,b<0||b>=r.length)break}const S=Math.min(Math.abs(e),Math.abs(y));e=e<0?0-S:S}{let v=e<0?u:d;for(;v>=0&&v<r.length;){const b=Math.abs(e)-Math.abs(f),y=s[v];un(y!=null,`Previous layout not found for panel index ${v}`);const S=y-b,_=Lp({panelConstraints:r[v],size:S});if(!Ti(y,_)&&(f+=y-_,c[v]=_,f.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?v--:v++}}if(kut(l,c))return a;{const v=e<0?d:u,b=s[v];un(b!=null,`Previous layout not found for panel index ${v}`);const y=b+f,S=Lp({panelConstraints:r[v],size:y});if(c[v]=S,!Ti(S,y)){let _=y-S,N=e<0?d:u;for(;N>=0&&N<r.length;){const k=c[N];un(k!=null,`Previous layout not found for panel index ${N}`);const j=k+_,E=Lp({panelConstraints:r[N],size:j});if(Ti(k,E)||(_-=E-k,c[N]=E),Ti(_,0))break;e>0?N--:N++}}}const m=Object.values(c).reduce((v,b)=>b+v,0);if(!Ti(m,100,.1))return a;const p=Object.keys(a);return c.reduce((v,b,y)=>(v[p[y]]=b,v),{})}function zh(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(t[r]===void 0||Pc(e[r],t[r])!==0)return!1;return!0}function Bh({layout:e,panelConstraints:t}){const r=[...Object.values(e)],n=r.reduce((s,l)=>s+l,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(s=>`${s}%`).join(", ")}`);if(!Ti(n,100)&&r.length>0)for(let s=0;s<t.length;s++){const l=r[s];un(l!=null,`No layout data found for index ${s}`);const c=100/n*l;r[s]=c}let a=0;for(let s=0;s<t.length;s++){const l=r[s];un(l!=null,`No layout data found for index ${s}`);const c=Lp({panelConstraints:t[s],size:l});l!=c&&(a+=l-c,r[s]=c)}if(!Ti(a,0))for(let s=0;s<t.length;s++){const l=r[s];un(l!=null,`No layout data found for index ${s}`);const c=l+a,u=Lp({panelConstraints:t[s],size:c});if(l!==u&&(a-=u-l,r[s]=u,Ti(a,0)))break}const i=Object.keys(e);return r.reduce((s,l,c)=>(s[i[c]]=l,s),{})}function E0e({groupId:e,panelId:t}){const r=()=>{const{mountedGroups:l}=Is();for(const[c,{defaultLayoutDeferred:u,derivedPanelConstraints:d,layout:f,separatorToPanels:m}]of l)if(c.id===e)return{defaultLayoutDeferred:u,derivedPanelConstraints:d,group:c,layout:f,separatorToPanels:m};throw Error(`Group ${e} not found`)},n=()=>{const l=r().derivedPanelConstraints.find(c=>c.panelId===t);if(l!==void 0)return l;throw Error(`Panel constraints not found for Panel ${t}`)},a=()=>{const l=r().group.panels.find(c=>c.id===t);if(l!==void 0)return l;throw Error(`Layout not found for Panel ${t}`)},i=()=>{const l=r().layout[t];if(l!==void 0)return l;throw Error(`Layout not found for Panel ${t}`)},s=l=>{const c=i();if(l===c)return;const{defaultLayoutDeferred:u,derivedPanelConstraints:d,group:f,layout:m,separatorToPanels:p}=r(),v=f.panels.findIndex(_=>_.id===t),b=v===f.panels.length-1,y=xx({delta:b?c-l:l-c,initialLayout:m,panelConstraints:d,pivotIndices:b?[v-1,v]:[v,v+1],prevLayout:m,trigger:"imperative-api"}),S=Bh({layout:y,panelConstraints:d});zh(m,S)||ts(_=>({mountedGroups:new Map(_.mountedGroups).set(f,{defaultLayoutDeferred:u,derivedPanelConstraints:d,layout:S,separatorToPanels:p})}))};return{collapse:()=>{const{collapsible:l,collapsedSize:c}=n(),{mutableValues:u}=a(),d=i();l&&d!==c&&(u.expandToSize=d,s(c))},expand:()=>{const{collapsible:l,collapsedSize:c,minSize:u}=n(),{mutableValues:d}=a(),f=i();if(l&&f===c){let m=d.expandToSize??u;m===0&&(m=1),s(m)}},getSize:()=>{const{group:l}=r(),c=i(),{element:u}=a(),d=l.orientation==="horizontal"?u.offsetWidth:u.offsetHeight;return{asPercentage:c,inPixels:d}},isCollapsed:()=>{const{collapsible:l,collapsedSize:c}=n(),u=i();return l&&Ti(c,u)},resize:l=>{if(i()!==l){let c;switch(typeof l){case"number":{const{group:u}=r(),d=Ug({group:u});c=Yo(l/d*100);break}case"string":{c=parseFloat(l);break}}s(c)}}}}function ote(e){if(e.defaultPrevented)return;const{mountedGroups:t}=Is();t$(e,t).forEach(r=>{if(r.separator){const n=r.panels.find(a=>a.panelConstraints.defaultSize!==void 0);if(n){const a=n.panelConstraints.defaultSize,i=E0e({groupId:r.group.id,panelId:n.id});i&&a!==void 0&&(i.resize(a),e.preventDefault())}}})}function $k(e){const{mountedGroups:t}=Is();for(const[r]of t)if(r.separators.some(n=>n.element===e))return r;throw Error("Could not find parent Group for separator element")}function M0e({groupId:e}){const t=()=>{const{mountedGroups:r}=Is();for(const[n,a]of r)if(n.id===e)return{group:n,...a};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){const{defaultLayoutDeferred:r,layout:n}=t();return r?{}:n},setLayout(r){const{defaultLayoutDeferred:n,derivedPanelConstraints:a,group:i,layout:s,separatorToPanels:l}=t(),c=Bh({layout:r,panelConstraints:a});return n?s:(zh(s,c)||ts(u=>({mountedGroups:new Map(u.mountedGroups).set(i,{defaultLayoutDeferred:n,derivedPanelConstraints:a,layout:c,separatorToPanels:l})})),c)}}}function T0e(e){const{mountedGroups:t}=Is(),r=t.get(e);return un(r,`Mounted Group ${e.id} not found`),r}function xf(e,t){const r=$k(e),n=T0e(r),a=r.separators.find(d=>d.element===e);un(a,"Matching separator not found");const i=n.separatorToPanels.get(a);un(i,"Matching panels not found");const s=i.map(d=>r.panels.indexOf(d)),l=M0e({groupId:r.id}).getLayout(),c=xx({delta:t,initialLayout:l,panelConstraints:n.derivedPanelConstraints,pivotIndices:s,prevLayout:l,trigger:"keyboard"}),u=Bh({layout:c,panelConstraints:n.derivedPanelConstraints});zh(l,u)||ts(d=>({mountedGroups:new Map(d.mountedGroups).set(r,{defaultLayoutDeferred:n.defaultLayoutDeferred,derivedPanelConstraints:n.derivedPanelConstraints,layout:u,separatorToPanels:n.separatorToPanels})}))}function lte(e){if(e.defaultPrevented)return;const t=e.currentTarget,r=$k(t);if(!r.disabled)switch(e.key){case"ArrowDown":{e.preventDefault(),r.orientation==="vertical"&&xf(t,5);break}case"ArrowLeft":{e.preventDefault(),r.orientation==="horizontal"&&xf(t,-5);break}case"ArrowRight":{e.preventDefault(),r.orientation==="horizontal"&&xf(t,5);break}case"ArrowUp":{e.preventDefault(),r.orientation==="vertical"&&xf(t,-5);break}case"End":{e.preventDefault(),xf(t,100);break}case"Enter":{e.preventDefault();const n=$k(t),{derivedPanelConstraints:a,layout:i,separatorToPanels:s}=T0e(n),l=n.separators.find(f=>f.element===t);un(l,"Matching separator not found");const c=s.get(l);un(c,"Matching panels not found");const u=c[0],d=a.find(f=>f.panelId===u.id);if(un(d,"Panel metadata not found"),d.collapsible){const f=i[u.id],m=d.collapsedSize===f?n.inMemoryLastExpandedPanelSizes[u.id]??d.minSize:d.collapsedSize;xf(t,m-f)}break}case"F6":{e.preventDefault();const n=$k(t).separators.map(s=>s.element),a=Array.from(n).findIndex(s=>s===e.currentTarget);un(a!==null,"Index not found");const i=e.shiftKey?a>0?a-1:n.length-1:a+1<n.length?a+1:0;n[i].focus();break}case"Home":{e.preventDefault(),xf(t,-100);break}}}function cte(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{mountedGroups:t}=Is(),r=t$(e,t),n=new Set,a=new Set,i=new Set,s=new Map;let l=!1;r.forEach(c=>{n.add(c.group),c.panels.forEach(d=>{a.add(d)}),c.separator&&(i.add(c.separator),l||(l=!0,c.separator.element.focus()));const u=t.get(c.group);u&&s.set(c.group,u.layout)}),ts({interactionState:{hitRegions:r,initialLayoutMap:s,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),r.length&&e.preventDefault()}const _ut=e=>e,FL=()=>{},A0e=1,D0e=2,L0e=4,O0e=8,ute=3,dte=12;let VS;function fte(){return VS===void 0&&(VS=!1,typeof window<"u"&&(window.navigator.userAgent.includes("Chrome")||window.navigator.userAgent.includes("Firefox"))&&(VS=!0)),VS}function Nut({cursorFlags:e,groups:t,state:r}){let n=0,a=0;switch(r){case"active":case"hover":t.forEach(i=>{if(!i.disableCursor)switch(i.orientation){case"horizontal":{n++;break}case"vertical":{a++;break}}})}if(n===0&&a===0)return null;switch(r){case"active":{if(e&&fte()){const i=(e&A0e)!==0,s=(e&D0e)!==0,l=(e&L0e)!==0,c=(e&O0e)!==0;if(i)return l?"se-resize":c?"ne-resize":"e-resize";if(s)return l?"sw-resize":c?"nw-resize":"w-resize";if(l)return"s-resize";if(c)return"n-resize"}break}}return fte()?n>0&&a>0?"move":n>0?"ew-resize":"ns-resize":n>0&&a>0?"grab":n>0?"col-resize":"row-resize"}const hte=new WeakMap;function r$(e){if(e.defaultView===null||e.defaultView===void 0)return;let{prevStyle:t,styleSheet:r}=hte.get(e)??{};r===void 0&&(r=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets.push(r));const{cursorFlags:n,interactionState:a}=Is();switch(a.state){case"active":case"hover":{const i=Nut({cursorFlags:n,groups:a.hitRegions.map(l=>l.group),state:a.state}),s=`*, *:hover {cursor: ${i} !important; ${a.state==="active"?"touch-action: none;":""} }`;if(t===s)return;t=s,i?r.cssRules.length===0?r.insertRule(s):r.replaceSync(s):r.cssRules.length===1&&r.deleteRule(0);break}case"inactive":{t=void 0,r.cssRules.length===1&&r.deleteRule(0);break}}hte.set(e,{prevStyle:t,styleSheet:r})}function I0e({document:e,event:t,hitRegions:r,initialLayoutMap:n,mountedGroups:a,pointerDownAtPoint:i,prevCursorFlags:s}){let l=0;const c=new Map(a);r.forEach(d=>{const{group:f,groupSize:m}=d,{disableCursor:p,orientation:v,panels:b}=f;let y=0;i?v==="horizontal"?y=(t.clientX-i.x)/m*100:y=(t.clientY-i.y)/m*100:v==="horizontal"?y=t.clientX<0?-100:100:y=t.clientY<0?-100:100;const S=n.get(f),{defaultLayoutDeferred:_,derivedPanelConstraints:N,layout:k,separatorToPanels:j}=a.get(f)??{defaultLayoutDeferred:!1};if(N&&S&&k&&j){const E=xx({delta:y,initialLayout:S,panelConstraints:N,pivotIndices:d.panels.map(T=>b.indexOf(T)),prevLayout:k,trigger:"mouse-or-touch"});if(zh(E,k)){if(y!==0&&!p)switch(v){case"horizontal":{l|=y<0?A0e:D0e;break}case"vertical":{l|=y<0?L0e:O0e;break}}}else{c.set(d.group,{defaultLayoutDeferred:_,derivedPanelConstraints:N,layout:E,separatorToPanels:j});const T=d.group.panels.map(({id:O})=>O).join(",");d.group.inMemoryLayouts[T]=E}}});let u=0;t.movementX===0?u|=s&ute:u|=l&ute,t.movementY===0?u|=s&dte:u|=l&dte,ts({cursorFlags:u,mountedGroups:c}),r$(e)}function mte(e){const{cursorFlags:t,interactionState:r,mountedGroups:n}=Is();switch(r.state){case"active":I0e({document:e.currentTarget,event:e,hitRegions:r.hitRegions,initialLayoutMap:r.initialLayoutMap,mountedGroups:n,prevCursorFlags:t})}}function pte(e){if(e.defaultPrevented)return;const{cursorFlags:t,interactionState:r,mountedGroups:n}=Is();switch(r.state){case"active":{if(e.buttons===0){ts(a=>a.interactionState.state==="inactive"?a:{cursorFlags:0,interactionState:{state:"inactive"}}),ts(a=>({mountedGroups:new Map(a.mountedGroups)}));return}I0e({document:e.currentTarget,event:e,hitRegions:r.hitRegions,initialLayoutMap:r.initialLayoutMap,mountedGroups:n,pointerDownAtPoint:r.pointerDownAtPoint,prevCursorFlags:t});break}default:{const a=t$(e,n);a.length===0?r.state!=="inactive"&&ts({interactionState:{state:"inactive"}}):ts({interactionState:{hitRegions:a,state:"hover"}}),r$(e.currentTarget);break}}}function gte(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{interactionState:t}=Is();switch(t.state){case"active":ts({cursorFlags:0,interactionState:{state:"inactive"}}),t.hitRegions.length>0&&(r$(e.currentTarget),ts(r=>({mountedGroups:new Map(r.mountedGroups)})),e.preventDefault())}}function vte(e){let t=0,r=0;const n={};for(const i of e)if(i.defaultSize!==void 0){t++;const s=Yo(i.defaultSize);r+=s,n[i.panelId]=s}else n[i.panelId]=void 0;const a=e.length-t;if(a!==0){const i=Yo((100-r)/a);for(const s of e)s.defaultSize===void 0&&(n[s.panelId]=i)}return n}function Cut(e,t,r){if(!r[0])return;const n=e.panels.find(c=>c.element===t);if(!n||!n.onResize)return;const a=Ug({group:e}),i=e.orientation==="horizontal"?n.element.offsetWidth:n.element.offsetHeight,s=n.mutableValues.prevSize,l={asPercentage:Yo(i/a*100),inPixels:i};n.mutableValues.prevSize=l,n.onResize(l,n.id,s)}function jut(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Eut(e,t){const r=e.map(a=>a.id),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r)if(!n.includes(a))return!1;return!0}const op=new Map;function Mut(e){let t=!0;un(e.element.ownerDocument.defaultView,"Cannot register an unmounted Group");const r=e.element.ownerDocument.defaultView.ResizeObserver,n=new Set,a=new Set,i=new r(v=>{for(const b of v){const{borderBoxSize:y,target:S}=b;if(S===e.element){if(t){if(Ug({group:e})===0)return;ts(_=>{const N=_.mountedGroups.get(e);if(N){const k=nte(e),j=N.defaultLayoutDeferred?vte(k):N.layout,E=Bh({layout:j,panelConstraints:k});return!N.defaultLayoutDeferred&&zh(j,E)&&jut(N.derivedPanelConstraints,k)?_:{mountedGroups:new Map(_.mountedGroups).set(e,{defaultLayoutDeferred:!1,derivedPanelConstraints:k,layout:E,separatorToPanels:N.separatorToPanels})}}return _})}}else Cut(e,S,y)}});i.observe(e.element),e.panels.forEach(v=>{un(!n.has(v.id),`Panel ids must be unique; id "${v.id}" was used more than once`),n.add(v.id),v.onResize&&i.observe(v.element)});const s=Ug({group:e}),l=nte(e),c=e.panels.map(({id:v})=>v).join(",");let u=e.defaultLayout;u&&(Eut(e.panels,u)||(u=void 0));const d=e.inMemoryLayouts[c]??u??vte(l),f=Bh({layout:d,panelConstraints:l}),m=C0e(e),p=e.element.ownerDocument;return ts(v=>{const b=new Map;return op.set(p,(op.get(p)??0)+1),m.forEach(y=>{y.separator&&b.set(y.separator,y.panels)}),{mountedGroups:new Map(v.mountedGroups).set(e,{defaultLayoutDeferred:s===0,derivedPanelConstraints:l,layout:f,separatorToPanels:b})}}),e.separators.forEach(v=>{un(!a.has(v.id),`Separator ids must be unique; id "${v.id}" was used more than once`),a.add(v.id),v.element.addEventListener("keydown",lte)}),op.get(p)===1&&(p.addEventListener("dblclick",ote,!0),p.addEventListener("pointerdown",cte,!0),p.addEventListener("pointerleave",mte),p.addEventListener("pointermove",pte),p.addEventListener("pointerup",gte,!0)),function(){t=!1,op.set(p,Math.max(0,(op.get(p)??0)-1)),ts(v=>{const b=new Map(v.mountedGroups);return b.delete(e),{mountedGroups:b}}),e.separators.forEach(v=>{v.element.removeEventListener("keydown",lte)}),op.get(p)||(p.removeEventListener("dblclick",ote,!0),p.removeEventListener("pointerdown",cte,!0),p.removeEventListener("pointerleave",mte),p.removeEventListener("pointermove",pte),p.removeEventListener("pointerup",gte,!0)),i.disconnect()}}function R0e(){const[e,t]=w.useState({}),r=w.useCallback(()=>t({}),[]);return[e,r]}function n$(e){const t=w.useId();return`${e??t}`}const im=typeof window<"u"?w.useLayoutEffect:w.useEffect;function ey(e){const t=w.useRef(e);return im(()=>{t.current=e},[e]),w.useCallback((...r)=>t.current?.(...r),[t])}function a$(...e){return ey(t=>{e.forEach(r=>{if(r)switch(typeof r){case"function":{r(t);break}case"object":{r.current=t;break}}})})}function Tut(e){const t=w.useRef({...e});return im(()=>{for(const r in e)t.current[r]=e[r]},[e]),t.current}const P0e=w.createContext(null);function Aut(e,t){const r=w.useRef({getLayout:()=>({}),setLayout:_ut});w.useImperativeHandle(t,()=>r.current,[]),im(()=>{Object.assign(r.current,M0e({groupId:e}))})}function nd({children:e,className:t,defaultLayout:r,disableCursor:n,disabled:a,elementRef:i,groupRef:s,id:l,onLayoutChange:c,onLayoutChanged:u,orientation:d="horizontal",resizeTargetMinimumSize:f={coarse:20,fine:10},style:m,...p}){const v=w.useRef({onLayoutChange:{},onLayoutChanged:{}}),b=ey($=>{zh(v.current.onLayoutChange,$)||(v.current.onLayoutChange=$,c?.($))}),y=ey($=>{zh(v.current.onLayoutChanged,$)||(v.current.onLayoutChanged=$,u?.($))}),S=n$(l),_=w.useRef(null),[N,k]=R0e(),j=w.useRef({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:f,separators:[]}),E=a$(_,i);Aut(S,s);const T=ey(($,L)=>{const{interactionState:A,mountedGroups:M}=Is();for(const z of M.keys())if(z.id===$){const I=M.get(z);if(I){let B=!1;switch(A.state){case"active":{B=A.hitRegions.some(F=>F.group===z);break}}return{flexGrow:I.layout[L]??1,pointerEvents:B?"none":void 0}}}return{flexGrow:r?.[L]??1}}),O=w.useMemo(()=>({getPanelStyles:T,id:S,orientation:d,registerPanel:$=>{const L=j.current;return L.panels=e5(d,[...L.panels,$]),k(),()=>{L.panels=L.panels.filter(A=>A!==$),k()}},registerSeparator:$=>{const L=j.current;return L.separators=e5(d,[...L.separators,$]),k(),()=>{L.separators=L.separators.filter(A=>A!==$),k()}}}),[T,S,k,d]),R=Tut({defaultLayout:r,disableCursor:n}),q=w.useRef(null);return im(()=>{const $=_.current;if($===null)return;const L=j.current,A={defaultLayout:R.defaultLayout,disableCursor:!!R.disableCursor,disabled:!!a,element:$,id:S,inMemoryLastExpandedPanelSizes:j.current.lastExpandedPanelSizes,inMemoryLayouts:j.current.layouts,orientation:d,panels:L.panels,resizeTargetMinimumSize:L.resizeTargetMinimumSize,separators:L.separators};q.current=A;const M=Mut(A),z=Is().mountedGroups.get(A);if(z){const{defaultLayoutDeferred:F,derivedPanelConstraints:U,layout:V}=z;!F&&U.length>0&&(b(V),y(V),L.panels.forEach(K=>{K.scheduleUpdate()}))}const I=hh.addListener("interactionStateChange",()=>{L.panels.forEach(F=>{F.scheduleUpdate()})}),B=hh.addListener("mountedGroupsChange",F=>{const U=F.get(A);if(U){const{defaultLayoutDeferred:V,derivedPanelConstraints:K,layout:G}=U;if(V||K.length===0)return;const{interactionState:J}=Is(),ee=J.state!=="active";b(G),ee&&y(G),L.panels.forEach(Y=>{Y.scheduleUpdate()})}});return()=>{q.current=null,M(),I(),B()}},[a,S,y,b,d,N,R]),w.useEffect(()=>{const $=q.current;$&&($.defaultLayout=r,$.disableCursor=!!n)}),o.jsx(P0e.Provider,{value:O,children:o.jsx("div",{...p,"aria-orientation":d,className:t,"data-group":!0,"data-testid":S,id:S,ref:E,style:{height:"100%",width:"100%",overflow:"hidden",...m,display:"flex",flexDirection:d==="horizontal"?"row":"column",flexWrap:"nowrap"},children:e})})}nd.displayName="Group";function i$(){const e=w.useContext(P0e);return un(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function Dut(e,t){const{id:r}=i$(),n=w.useRef({collapse:FL,expand:FL,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:FL});w.useImperativeHandle(t,()=>n.current,[]),im(()=>{Object.assign(n.current,E0e({groupId:r,panelId:e}))})}function xs({children:e,className:t,collapsedSize:r="0%",collapsible:n=!1,defaultSize:a,elementRef:i,id:s,maxSize:l="100%",minSize:c="0%",onResize:u,panelRef:d,style:f,...m}){const p=!!s,v=n$(s),b=w.useRef(null),y=a$(b,i),[,S]=R0e(),{getPanelStyles:_,id:N,registerPanel:k}=i$(),j=u!==null,E=ey((O,R,q)=>{u?.(O,s,q)});im(()=>{const O=b.current;if(O!==null)return k({element:O,id:v,idIsStable:p,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:j?E:void 0,panelConstraints:{collapsedSize:r,collapsible:n,defaultSize:a,maxSize:l,minSize:c},scheduleUpdate:S})},[r,n,a,S,j,v,p,l,c,E,k]),Dut(v,d);const T=_(N,v);return o.jsx("div",{...m,"data-panel":!0,"data-testid":v,id:v,ref:y,style:{...Lut,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...T},children:o.jsx("div",{className:t,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...f},children:e})})}xs.displayName="Panel";const Lut={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function Out({layout:e,panelConstraints:t,panelId:r,panelIndex:n}){let a,i;const s=e[r],l=t.find(c=>c.panelId===r);if(l){const c=l.maxSize,u=i=l.collapsible?l.collapsedSize:l.minSize,d=[n,n+1];i=Bh({layout:xx({delta:u-s,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[r],a=Bh({layout:xx({delta:c-s,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[r]}return{valueControls:r,valueMax:a,valueMin:i,valueNow:s}}function z0e({children:e,className:t,elementRef:r,id:n,style:a,...i}){const s=n$(n),[l,c]=w.useState({}),[u,d]=w.useState("inactive"),f=w.useRef(null),m=a$(f,r),{id:p,orientation:v,registerSeparator:b}=i$(),y=v==="horizontal"?"vertical":"horizontal";return im(()=>{const S=f.current;if(S!==null){const _={element:S,id:s},N=b(_),k=hh.addListener("interactionStateChange",E=>{d(E.state!=="inactive"&&E.hitRegions.some(T=>T.separator===_)?E.state:"inactive")}),j=hh.addListener("mountedGroupsChange",E=>{E.forEach(({derivedPanelConstraints:T,layout:O,separatorToPanels:R},q)=>{if(q.id===p){const $=R.get(_);if($){const L=$[0],A=q.panels.indexOf(L);c(Out({layout:O,panelConstraints:T,panelId:L.id,panelIndex:A}))}}})});return()=>{k(),j(),N()}}},[p,s,b]),o.jsx("div",{...i,"aria-controls":l.valueControls,"aria-orientation":y,"aria-valuemax":l.valueMax,"aria-valuemin":l.valueMin,"aria-valuenow":l.valueNow,children:e,className:t,"data-separator":u,"data-testid":s,id:s,ref:m,role:"separator",style:{flexBasis:"auto",...a,flexGrow:0,flexShrink:0},tabIndex:0})}z0e.displayName="Separator";const bte={director:"text-purple-500",worker:"text-blue-500",steward:"text-amber-500"};function ed({orientation:e,onSwap:t,swapTestId:r,testId:n}){const a=e==="horizontal",i=a?ZC:e0,s=le.useRef(null),l=le.useRef(!1),c=le.useRef(null),u=5,d=w.useCallback(f=>{c.current={x:f.clientX,y:f.clientY},l.current=!1;const m=v=>{if(c.current){const b=v.clientX-c.current.x,y=v.clientY-c.current.y;(Math.abs(b)>u||Math.abs(y)>u)&&(l.current=!0)}},p=()=>{c.current=null,document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",p)};document.addEventListener("pointermove",m),document.addEventListener("pointerup",p)},[]);return le.useEffect(()=>{if(!t)return;const f=m=>{if(s.current&&!l.current){const p=s.current.getBoundingClientRect();m.clientX>=p.left&&m.clientX<=p.right&&m.clientY>=p.top&&m.clientY<=p.bottom&&t()}l.current=!1};return document.addEventListener("click",f),()=>document.removeEventListener("click",f)},[t]),le.useEffect(()=>{if(!t)return;const f=s.current;if(!f)return;const m=v=>{const b=f.getBoundingClientRect(),y=v.clientX>=b.left&&v.clientX<=b.right&&v.clientY>=b.top&&v.clientY<=b.bottom;f.classList.toggle("is-hovered",y)},p=()=>{f.classList.remove("is-hovered")};return document.addEventListener("mousemove",m),document.addEventListener("mouseleave",p),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",p)}},[t]),o.jsxs(z0e,{onPointerDown:t?d:void 0,className:`
        group relative
        flex items-center justify-center
        ${a?"w-2 cursor-col-resize":"h-2 cursor-row-resize"}
        hover:bg-[var(--color-primary-muted)]
        transition-colors duration-150
      `,"data-testid":n,children:[!t&&o.jsx("div",{className:`
            ${a?"w-0.5 h-8":"h-0.5 w-8"}
            bg-[var(--color-border)]
            group-hover:bg-[var(--color-primary)]
            group-data-[resize-handle-active]:bg-[var(--color-primary)]
            transition-colors duration-150
            rounded-full
          `}),t&&o.jsx("div",{ref:s,className:`
            absolute z-20
            p-2 rounded-full
            bg-[var(--color-surface)] border border-[var(--color-border)]
            text-[var(--color-text-tertiary)]
            pointer-events-none
            transition-all duration-150
            shadow-md
            opacity-60
            [&.is-hovered]:opacity-100
            [&.is-hovered]:bg-[var(--color-primary-muted)]
            [&.is-hovered]:text-[var(--color-primary)]
            [&.is-hovered]:border-[var(--color-primary)]
            [&.is-hovered]:scale-110
          `,title:"Swap sections","data-testid":r,children:o.jsx(i,{className:"w-3.5 h-3.5"})})]})}function yte({pane:e,isActive:t,isMaximized:r,isSingleMode:n,isDragging:a,isDropTarget:i,onClose:s,onMaximize:l,onMinimize:c,onFocus:u,onStatusChange:d,onDragStart:f,onDragOver:m,onDrop:p,onDragEnd:v,paneRef:b}){const y=!r&&!n;return o.jsxs("div",{className:`
        h-full w-full min-h-0 min-w-0 relative
        ${a?"opacity-50 scale-95":""}
        transition-all duration-150
      `,onDragOver:m,onDrop:p,children:[i&&o.jsx("div",{className:"absolute inset-0 z-10 pointer-events-none flex items-center justify-center bg-[var(--color-primary)]/10 border-2 border-dashed border-[var(--color-primary)] rounded-lg",children:o.jsx("div",{className:"px-3 py-1.5 rounded-md bg-[var(--color-primary)] text-white text-sm font-medium shadow-lg",children:"Drop to swap positions"})}),o.jsx(aut,{ref:b,pane:e,isActive:t,isMaximized:r,isSingleMode:n,draggable:y,onClose:s,onMaximize:l,onMinimize:c,onFocus:u,onStatusChange:d,onDragStart:f,onDragEnd:v,onDragOver:m,onDrop:p})]})}function Iut(e,t){if(t===0)return{orientation:"horizontal",rows:[]};if(t===1)return{orientation:"horizontal",rows:[[0]]};switch(e){case"single":return{orientation:"vertical",rows:Array.from({length:t},(a,i)=>[i])};case"columns":return{orientation:"horizontal",rows:Array.from({length:t},(a,i)=>[i])};case"rows":return{orientation:"vertical",rows:Array.from({length:t},(a,i)=>[i])};case"grid":case"flex":default:if(t===2)return{orientation:"horizontal",rows:[[0,1]]};if(t===3)return{orientation:"horizontal",rows:[[0],[1,2]]};if(t===4)return{orientation:"vertical",rows:[[0,1],[2,3]]};const r=3,n=[];for(let a=0;a<t;a+=r)n.push(Array.from({length:Math.min(r,t-a)},(i,s)=>a+s));return{orientation:"vertical",rows:n}}}function Rut({panes:e,preset:t,gridOrientation:r="horizontal",sectionLayout:n="single-first",activePane:a,dragState:i,onPaneClose:s,onPaneActivate:l,onPaneStatusChange:c,onStartDrag:u,onUpdateDragTarget:d,onEndDrag:f,onCancelDrag:m,onSwapSections:p,onSwapPanes:v,onSwap2x2Rows:b}){const[y,S]=w.useState(null),_=y?e.filter(J=>J.id===y):e,N=y!==null,k=a||e[0]?.id||null,j=w.useRef(new Map),[E,T]=w.useState(0),O=w.useCallback(J=>(j.current.has(J)||j.current.set(J,le.createRef()),j.current.get(J)),[]),R=w.useCallback(()=>{setTimeout(()=>{j.current.forEach(J=>{J.current?.refresh()})},200)},[]);w.useEffect(()=>{E>0&&R()},[E,R]);const q=w.useCallback((J,ee)=>{v?.(J,ee),T(Y=>Y+1)},[v]),$=w.useCallback(()=>{p?.(),T(J=>J+1)},[p]),L=w.useCallback(()=>{b?.(),T(J=>J+1)},[b]),A=w.useCallback(()=>{T(J=>J+1)},[]),M=w.useCallback(J=>{S(J)},[]),z=w.useCallback(()=>{S(null)},[]),I=w.useCallback((J,ee)=>{J.dataTransfer.effectAllowed="move",J.dataTransfer.setData("text/plain",ee),J.dataTransfer.setData("application/x-workspace-pane",ee),u(ee)},[u]),B=w.useCallback((J,ee)=>{J.preventDefault(),J.dataTransfer.dropEffect="move",d(ee)},[d]),F=w.useCallback((J,ee)=>{J.preventDefault();let Y=J.dataTransfer.getData("application/x-workspace-pane");if(!Y){const fe=J.dataTransfer.getData("text/plain");fe&&fe.startsWith("pane-")&&(Y=fe)}if(!Y){m();return}const ie=_[ee];if(!ie||ie.id===Y){m();return}v&&q(Y,ie.id),m()},[m,_,v,q]),U=w.useCallback(J=>ee=>F(ee,J),[F]),V=w.useCallback(()=>{m()},[m]),K=w.useMemo(()=>Iut(N?"single":t,_.length),[t,_.length,N]);if(e.length===0)return null;const G=J=>{const ee=_[J];if(!ee)return null;const Y=i?.paneId===ee.id,ie=i!==null&&i.targetPosition===J&&!Y;return o.jsx(yte,{pane:ee,paneRef:O(ee.id),isActive:ee.id===a,isMaximized:y===ee.id,isSingleMode:t==="single"&&!N,isDragging:Y,isDropTarget:ie,onClose:()=>s(ee.id),onMaximize:()=>M(ee.id),onMinimize:z,onFocus:()=>l(ee.id),onStatusChange:fe=>c(ee.id,fe),onDragStart:fe=>I(fe,ee.id),onDragOver:fe=>B(fe,J),onDrop:U(J),onDragEnd:V},ee.id)};if(_.length===1)return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:G(0)});if(t==="single"&&!N&&_.length>1){const J=_.findIndex(Y=>Y.id===k),ee=J>=0?J:0;return o.jsxs("div",{className:"h-full w-full flex flex-col","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:[o.jsx("div",{className:"flex-shrink-0 flex items-center border-b border-[var(--color-border)] bg-[var(--color-surface)] overflow-x-auto",children:_.map((Y,ie)=>{const fe=ie===ee,me=Y.agentRole==="steward"?t0:na,te=bte[Y.agentRole]||bte.worker;return o.jsxs("div",{className:`
                  group relative flex items-center gap-2 px-3 py-2 min-w-0
                  border-r border-[var(--color-border)]
                  cursor-pointer select-none
                  transition-colors duration-150
                  ${fe?"bg-[var(--color-bg)] text-[var(--color-text)]":"bg-[var(--color-surface-hover)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-secondary)]"}
                `,onClick:()=>l(Y.id),"data-testid":`workspace-tab-${Y.id}`,children:[o.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${Y.status==="connected"?"bg-green-500":Y.status==="connecting"?"bg-yellow-500 animate-pulse":Y.status==="error"?"bg-red-500":"bg-gray-400"}`}),o.jsx(me,{className:`w-3.5 h-3.5 flex-shrink-0 ${te}`}),o.jsx("span",{className:"truncate text-sm font-medium max-w-32",title:Y.agentName,children:Y.agentName}),o.jsx("button",{onClick:oe=>{oe.stopPropagation(),s(Y.id)},className:`
                    p-0.5 rounded ml-1 flex-shrink-0
                    text-[var(--color-text-tertiary)]
                    hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20
                    opacity-0 group-hover:opacity-100
                    transition-all duration-150
                  `,title:"Close tab",children:o.jsx(wt,{className:"w-3 h-3"})}),fe&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[var(--color-primary)]"})]},Y.id)})}),o.jsx("div",{className:"flex-1 min-h-0 relative",children:_.map((Y,ie)=>{const fe=ie===ee,me=i?.paneId===Y.id,te=i!==null&&i.targetPosition===ie&&!me;return o.jsx("div",{className:`
                  absolute inset-0
                  ${fe?"visible z-10":"invisible z-0"}
                `,children:o.jsx(yte,{pane:Y,paneRef:O(Y.id),isActive:Y.id===a,isMaximized:!1,isSingleMode:!0,isDragging:me,isDropTarget:te,onClose:()=>s(Y.id),onMaximize:()=>M(Y.id),onMinimize:z,onFocus:()=>l(Y.id),onStatusChange:oe=>c(Y.id,oe),onDragStart:oe=>I(oe,Y.id),onDragOver:oe=>B(oe,ie),onDrop:U(ie),onDragEnd:V})},Y.id)})})]})}if(!N&&t==="grid"&&_.length===3){const J=r==="horizontal",ee=n==="single-first",Y=ee?0:2,ie=ee?[1,2]:[0,1];return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,"data-orientation":r,"data-section-layout":n,children:o.jsx(nd,{orientation:J?"horizontal":"vertical",id:"workspace-grid-3pane",onLayoutChange:A,children:ee?o.jsxs(o.Fragment,{children:[o.jsx(xs,{id:"pane-single",defaultSize:50,minSize:15,children:G(Y)}),o.jsx(ed,{orientation:J?"horizontal":"vertical",onSwap:$,swapTestId:"swap-sections-btn"}),o.jsx(xs,{id:"pane-paired",defaultSize:50,minSize:15,children:o.jsxs(nd,{orientation:J?"vertical":"horizontal",id:"workspace-grid-3pane-secondary",onLayoutChange:A,children:[o.jsx(xs,{id:"pane-paired-0",defaultSize:50,minSize:15,children:G(ie[0])}),o.jsx(ed,{orientation:J?"vertical":"horizontal",onSwap:v?()=>q(_[ie[0]].id,_[ie[1]].id):void 0,swapTestId:"swap-panes-btn"}),o.jsx(xs,{id:"pane-paired-1",defaultSize:50,minSize:15,children:G(ie[1])})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(xs,{id:"pane-paired",defaultSize:50,minSize:15,children:o.jsxs(nd,{orientation:J?"vertical":"horizontal",id:"workspace-grid-3pane-secondary",onLayoutChange:A,children:[o.jsx(xs,{id:"pane-paired-0",defaultSize:50,minSize:15,children:G(ie[0])}),o.jsx(ed,{orientation:J?"vertical":"horizontal",onSwap:v?()=>q(_[ie[0]].id,_[ie[1]].id):void 0,swapTestId:"swap-panes-btn"}),o.jsx(xs,{id:"pane-paired-1",defaultSize:50,minSize:15,children:G(ie[1])})]})}),o.jsx(ed,{orientation:J?"horizontal":"vertical",onSwap:$,swapTestId:"swap-sections-btn"}),o.jsx(xs,{id:"pane-single",defaultSize:50,minSize:15,children:G(Y)})]})})})}if(K.orientation==="vertical"){const J=K.rows.length===2&&K.rows[0].length===2&&K.rows[1].length===2;return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:o.jsx(nd,{orientation:"vertical",id:`workspace-grid-${t}`,onLayoutChange:A,children:K.rows.map((ee,Y)=>o.jsxs(w.Fragment,{children:[Y>0&&o.jsx(ed,{orientation:"vertical",onSwap:J&&b?L:v&&K.rows[Y-1].length===1&&ee.length===1?()=>q(_[K.rows[Y-1][0]].id,_[ee[0]].id):void 0,swapTestId:`swap-row-${Y-1}-${Y}-btn`,testId:J?"vertical-resize-handle":void 0}),o.jsx(xs,{id:`row-${Y}`,defaultSize:100/K.rows.length,minSize:10,children:ee.length===1?G(ee[0]):o.jsx(nd,{orientation:"horizontal",id:`workspace-row-${Y}`,onLayoutChange:A,children:ee.map((ie,fe)=>o.jsxs(w.Fragment,{children:[fe>0&&o.jsx(ed,{orientation:"horizontal",onSwap:q?()=>q(_[ee[fe-1]].id,_[ie].id):void 0,swapTestId:`swap-col-${fe-1}-${fe}-btn`}),o.jsx(xs,{id:`col-${Y}-${fe}`,defaultSize:100/ee.length,minSize:15,children:G(ie)})]},`col-group-${fe}`))})})]},`row-group-${Y}`))})})}return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:o.jsx(nd,{orientation:"horizontal",id:`workspace-grid-${t}`,onLayoutChange:A,children:K.rows.map((J,ee)=>o.jsxs(w.Fragment,{children:[ee>0&&o.jsx(ed,{orientation:"horizontal",onSwap:v&&K.rows[ee-1].length===1&&J.length===1?()=>q(_[K.rows[ee-1][0]].id,_[J[0]].id):void 0,swapTestId:`swap-col-${ee-1}-${ee}-btn`}),o.jsx(xs,{id:`col-${ee}`,defaultSize:100/K.rows.length,minSize:15,children:J.length===1?G(J[0]):o.jsx(nd,{orientation:"vertical",id:`workspace-col-${ee}`,onLayoutChange:A,children:J.map((Y,ie)=>o.jsxs(w.Fragment,{children:[ie>0&&o.jsx(ed,{orientation:"vertical",onSwap:v?()=>q(_[J[ie-1]].id,_[Y].id):void 0,swapTestId:`swap-row-${ie-1}-${ie}-btn`}),o.jsx(xs,{id:`row-${ee}-${ie}`,defaultSize:100/J.length,minSize:15,children:G(Y)})]},`row-group-${ie}`))})})]},`col-group-${ee}`))})})}const Put={director:Xr,worker:na,steward:t0},zut={director:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300"},worker:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300"},steward:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300"}};function xte({agent:e,isExisting:t,onSelect:r}){const n=e.metadata?.agent,a=n?.agentRole??"worker",i=a==="worker"?n?.workerMode:void 0,s=Put[a],l=zut[a],c=n?.sessionStatus,u=c==="running";return o.jsxs("button",{onClick:r,disabled:t,className:`
        w-full flex items-center gap-3 p-3 rounded-lg text-left
        transition-colors duration-150
        ${t?"opacity-50 cursor-not-allowed bg-[var(--color-surface)]":"hover:bg-[var(--color-surface-hover)] cursor-pointer"}
      `,"data-testid":`agent-option-${e.id}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`p-2 rounded-lg ${l.bg}`,children:o.jsx(s,{className:`w-5 h-5 ${l.text}`})}),u&&o.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full bg-green-500 border-2 border-[var(--color-bg)]"})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-[var(--color-text)] truncate",children:e.name}),t&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-[var(--color-primary-muted)] text-[var(--color-primary)]",children:"In workspace"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)]",children:[o.jsx("span",{className:"capitalize",children:a}),i&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{className:"capitalize flex items-center gap-1",children:[i==="ephemeral"&&o.jsx(eh,{className:"w-3 h-3"}),i]})]}),c&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:u?"text-green-600 dark:text-green-400":"",children:c})]})]})]})]})}function But({isOpen:e,onClose:t,onSelectAgent:r,existingAgentIds:n=[]}){const[a,i]=w.useState(""),{persistentWorkers:s,ephemeralWorkers:l,stewards:c,isLoading:u,error:d}=g0();if(!e)return null;const m=[...s,...l,...c].filter(y=>y!=null).filter(y=>{const S=a.toLowerCase(),_=y.name.toLowerCase(),N=y.metadata?.agent?.agentRole?.toLowerCase()??"";return _.includes(S)||N.includes(S)}),p=m.filter(y=>y.metadata?.agent?.agentRole==="worker"),v=m.filter(y=>y.metadata?.agent?.agentRole==="steward"),b=y=>{r(y),t()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:t,"data-testid":"add-pane-backdrop"}),o.jsx("div",{className:`
          fixed inset-0 z-50
          flex items-center justify-center
          p-4
          pointer-events-none
        `,children:o.jsxs("div",{className:`
            w-full max-w-md
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"add-pane-dialog",role:"dialog","aria-labelledby":"add-pane-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"add-pane-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Add Terminal Pane"}),o.jsx("button",{onClick:t,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"add-pane-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"px-4 py-3 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",value:a,onChange:y=>i(y.target.value),placeholder:"Search agents...",className:`
                  w-full pl-10 pr-4 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,"data-testid":"add-pane-search"})]})}),o.jsx("div",{className:"max-h-80 overflow-y-auto p-2","data-testid":"add-pane-list",children:u?o.jsx("div",{className:"flex items-center justify-center py-8 text-[var(--color-text-secondary)]",children:"Loading agents..."}):d?o.jsx("div",{className:"flex items-center justify-center py-8 text-red-500",children:"Failed to load agents"}):m.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-[var(--color-text-secondary)]",children:[o.jsx(Ii,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:a?"No agents match your search":"No agents registered"})]}):o.jsxs("div",{className:"space-y-1",children:[p.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-2 py-1 mt-2 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Workers"}),p.map(y=>o.jsx(xte,{agent:y,isExisting:n.includes(y.id),onSelect:()=>b(y)},y.id))]}),v.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-2 py-1 mt-2 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Stewards"}),v.map(y=>o.jsx(xte,{agent:y,isExisting:n.includes(y.id),onSelect:()=>b(y)},y.id))]})]})})]})})]})}const UL=[{id:"single",icon:uu,label:"Single"},{id:"columns",icon:Cwe,label:"Columns"},{id:"rows",icon:jwe,label:"Rows"},{id:"grid",icon:Bae,label:"Grid"}];function $ut(){const e=rl({from:"/workspaces"}),t=Ma(),[r,n]=w.useState(!1);w.useEffect(()=>{e.action==="addPane"&&(n(!0),t({to:"/workspaces",search:{layout:e.layout??"single",agent:void 0,resumeSessionId:void 0,resumePrompt:void 0},replace:!0}))},[e.action,e.layout,t]);const[a,i]=w.useState(!1),[s,l]=w.useState(!1),[c,u]=w.useState(""),{layout:d,activePane:f,hasPanes:m,paneCount:p,savedLayouts:v,dragState:b,addPane:y,removePane:S,setActivePane:_,updatePaneStatus:N,setLayoutPreset:k,saveLayout:j,loadLayout:E,deleteLayout:T,clearPanes:O,startDrag:R,updateDragTarget:q,endDrag:$,cancelDrag:L,rotateLayout:A,swapGridSections:M,swapPanes:z,swap2x2Rows:I}=qct(),B=e.agent,{data:F}=rme(B??""),U=F?.agent,V=w.useRef(null),K=w.useRef(null),G=_B();w.useEffect(()=>{if(U&&B&&V.current!==B){const ie=d.panes.find(me=>me.agentId===B);ie?_(ie.id):y(U),V.current=B;const fe=e.resumeSessionId;fe&&K.current!==fe&&(K.current=fe,G.mutate({agentId:B,providerSessionId:fe,resumePrompt:e.resumePrompt})),t({to:"/workspaces",search:{layout:e.layout??"single",agent:void 0,resumeSessionId:void 0,resumePrompt:void 0},replace:!0})}},[U,B,d.panes,y,_,t,e.layout,e.resumeSessionId,e.resumePrompt,G]);const J=UL.find(ie=>ie.id===d.preset)||UL[0],ee=d.panes.map(ie=>ie.agentId),Y=()=>{c.trim()&&(j(c.trim()),u(""),l(!1))};return o.jsxs("div",{className:"flex flex-col h-full animate-fade-in","data-testid":"workspaces-page",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(bh,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Workspaces"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)]",children:["Terminal multiplexer for agent sessions",p>0&&`  ${p} pane${p===1?"":"s"}`]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>i(!a),className:`
                flex items-center gap-2 px-3 py-2
                text-sm font-medium
                text-[var(--color-text-secondary)]
                rounded-md border border-[var(--color-border)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors duration-150
              `,"data-testid":"workspaces-layout-btn",children:[o.jsx(J.icon,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:J.label}),o.jsx(cr,{className:"w-3.5 h-3.5 opacity-50"})]}),a&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),o.jsxs("div",{className:`
                    absolute right-0 top-full mt-1 z-20
                    min-w-48 py-1 rounded-md shadow-lg
                    bg-[var(--color-bg)] border border-[var(--color-border)]
                  `,"data-testid":"layout-menu",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Layout Presets"}),UL.map(ie=>o.jsxs("button",{onClick:()=>{k(ie.id),i(!1)},className:`
                        w-full flex items-center gap-2 px-3 py-2 text-left text-sm
                        ${d.preset===ie.id?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}
                      `,"data-testid":`layout-preset-${ie.id}`,children:[o.jsx(ie.icon,{className:"w-4 h-4"}),ie.label]},ie.id)),v.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"my-1 border-t border-[var(--color-border)]"}),o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Saved Layouts"}),v.map(ie=>o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-[var(--color-surface-hover)]",children:[o.jsx("button",{onClick:()=>{E(ie),i(!1)},className:"flex-1 text-left text-sm text-[var(--color-text-secondary)]",children:ie.name}),o.jsx("button",{onClick:()=>T(ie.id),className:"p-1 rounded text-[var(--color-text-tertiary)] hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete layout",children:o.jsx(Sr,{className:"w-3.5 h-3.5"})})]},ie.id))]}),m&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"my-1 border-t border-[var(--color-border)]"}),o.jsxs("button",{onClick:()=>{i(!1),l(!0)},className:"w-full flex items-center gap-2 px-3 py-2 text-left text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]",children:[o.jsx(XC,{className:"w-4 h-4"}),"Save Current Layout"]})]}),m&&o.jsxs("button",{onClick:()=>{O(),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[o.jsx(Sr,{className:"w-4 h-4"}),"Clear All Panes"]})]})]})]}),d.preset==="grid"&&p>=3&&o.jsxs("button",{onClick:A,className:`
                flex items-center gap-2 px-3 py-2
                text-sm font-medium
                text-[var(--color-text-secondary)]
                rounded-md border border-[var(--color-border)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors duration-150
              `,title:"Rotate grid layout","data-testid":"workspaces-rotate-btn",children:[o.jsx(Qae,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Rotate"})]}),o.jsxs("button",{onClick:()=>n(!0),className:`
              flex items-center gap-2 px-3 py-2
              text-sm font-medium text-white
              bg-[var(--color-primary)]
              rounded-md
              hover:bg-[var(--color-primary-hover)]
              transition-colors duration-150
            `,"data-testid":"workspaces-add-pane",children:[o.jsx(_r,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Add Pane"}),o.jsx("kbd",{className:"hidden sm:inline ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(Pl("action.addPane"))})]})]})]}),o.jsx("div",{className:"flex-1 min-h-0 p-4 overflow-hidden",children:m?o.jsx(Rut,{panes:d.panes,preset:d.preset,gridOrientation:d.gridOrientation,sectionLayout:d.sectionLayout,activePane:f,dragState:b,onPaneClose:S,onPaneActivate:_,onPaneStatusChange:N,onStartDrag:R,onUpdateDragTarget:q,onEndDrag:$,onCancelDrag:L,onSwapSections:M,onSwapPanes:z,onSwap2x2Rows:I}):o.jsxs("div",{className:`
              flex flex-col items-center justify-center
              h-full
              rounded-lg border-2 border-dashed border-[var(--color-border)]
              bg-[var(--color-bg-secondary)]
            `,"data-testid":"workspaces-empty",children:[o.jsx(bh,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4 opacity-50"}),o.jsx("h2",{className:"text-lg font-medium text-[var(--color-text)] mb-1",children:"No Terminal Panes"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4 text-center max-w-sm",children:"Add panes to view and interact with your agent terminals side by side."}),o.jsxs("button",{onClick:()=>n(!0),className:`
                flex items-center gap-2 px-4 py-2
                text-sm font-medium text-white
                bg-[var(--color-primary)]
                rounded-md
                hover:bg-[var(--color-primary-hover)]
                transition-colors duration-150
              `,children:[o.jsx(_r,{className:"w-4 h-4"}),"Add Your First Pane"]})]})}),o.jsx(But,{isOpen:r,onClose:()=>n(!1),onSelectAgent:y,existingAgentIds:ee}),s&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:()=>l(!1)}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
                w-full max-w-sm
                bg-[var(--color-bg)]
                rounded-xl shadow-2xl
                border border-[var(--color-border)]
                animate-scale-in
                pointer-events-auto
                p-4
              `,"data-testid":"save-layout-dialog",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)] mb-3",children:"Save Layout"}),o.jsx("input",{type:"text",value:c,onChange:ie=>u(ie.target.value),placeholder:"Layout name...",className:`
                  w-full px-3 py-2 mb-4
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,onKeyDown:ie=>{ie.key==="Enter"&&Y(),ie.key==="Escape"&&l(!1)}}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{onClick:()=>l(!1),className:`
                    px-3 py-2 text-sm font-medium
                    text-[var(--color-text-secondary)]
                    rounded-md
                    hover:bg-[var(--color-surface-hover)]
                  `,children:"Cancel"}),o.jsx("button",{onClick:Y,disabled:!c.trim(),className:`
                    px-3 py-2 text-sm font-medium text-white
                    bg-[var(--color-primary)]
                    rounded-md
                    hover:bg-[var(--color-primary-hover)]
                    disabled:opacity-50 disabled:cursor-not-allowed
                  `,children:"Save"})]})]})})]})]})}function B0e(e){return e.type==="function"}const s$={pending:{label:"Pending",icon:tn,color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-100 dark:bg-gray-900/30",borderColor:"border-gray-300 dark:border-gray-700"},running:{label:"Running",icon:en,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30",borderColor:"border-blue-300 dark:border-blue-700"},completed:{label:"Completed",icon:Pi,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30",borderColor:"border-green-300 dark:border-green-700"},failed:{label:"Failed",icon:oi,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30",borderColor:"border-red-300 dark:border-red-700"},cancelled:{label:"Cancelled",icon:WC,color:"text-yellow-600 dark:text-yellow-400",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",borderColor:"border-yellow-300 dark:border-yellow-700"}},Fut=[{value:"task",label:"Task"},{value:"bug",label:"Bug"},{value:"feature",label:"Feature"},{value:"chore",label:"Chore"}],Uut=[{value:5,label:"5 - Critical"},{value:4,label:"4 - High"},{value:3,label:"3 - Medium"},{value:2,label:"2 - Low"},{value:1,label:"1 - Lowest"}],Hut=[{value:1,label:"1 - Trivial"},{value:2,label:"2 - Simple"},{value:3,label:"3 - Medium"},{value:4,label:"4 - Complex"},{value:5,label:"5 - Very Complex"}],qut=[{value:"string",label:"String"},{value:"number",label:"Number"},{value:"boolean",label:"Boolean"}],Wut=[{value:"task",label:"Task",description:"Agent-executed task"},{value:"function",label:"Function",description:"Execute code directly"}],wte=[{value:"typescript",label:"TypeScript",description:"Execute TypeScript/JavaScript code"},{value:"python",label:"Python",description:"Execute Python code"},{value:"shell",label:"Shell",description:"Execute shell commands"}];function Kut(e){return s$[e]?.label??e}function Ste(e){const t=s$[e];return t?`${t.color} ${t.bgColor}`:"text-gray-600 bg-gray-100"}function Gut(e){if(!e.startedAt)return;const t=new Date(e.startedAt).getTime(),n=(e.finishedAt?new Date(e.finishedAt).getTime():Date.now())-t;return n<1e3?`${n}ms`:n<6e4?`${Math.round(n/1e3)}s`:n<36e5?`${Math.round(n/6e4)}m`:`${Math.round(n/36e5)}h`}function kte(e){const t=Date.now(),r=new Date(e).getTime(),n=t-r,a=Math.floor(n/1e3),i=Math.floor(a/60),s=Math.floor(i/60),l=Math.floor(s/24);return a<60?"just now":i<60?`${i}m ago`:s<24?`${s}h ago`:l<7?`${l}d ago`:new Date(e).toLocaleDateString()}function HL(){return`step_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,6)}`}const Vut="/api";async function Wl(e,t){const r=await fetch(`${Vut}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function Yut(e){const r=new URLSearchParams().toString(),n=r?`/workflows?${r}`:"/workflows";return gt({queryKey:["workflows",e],queryFn:()=>Wl(n),refetchInterval:1e4})}function Qut(e){return gt({queryKey:["workflow",e],queryFn:()=>Wl(`/workflows/${e}`),enabled:!!e})}function Jut(e){return gt({queryKey:["workflow-tasks",e],queryFn:()=>Wl(`/workflows/${e}/tasks`),enabled:!!e,refetchInterval:5e3})}function Zut(e){const t=Qut(e),r=Jut(e);return{workflow:t.data?.workflow,tasks:r.data?.tasks??[],progress:r.data?.progress??{total:0,completed:0,inProgress:0,blocked:0,open:0,percentage:0},dependencies:r.data?.dependencies??[],isLoading:t.isLoading||r.isLoading,error:t.error||r.error,refetch:async()=>{await t.refetch(),await r.refetch()}}}function Xut(){const e=ht();return Ct({mutationFn:async({workflowId:t,reason:r})=>Wl(`/workflows/${t}/cancel`,{method:"POST",body:JSON.stringify({reason:r})}),onSuccess:(t,{workflowId:r})=>{e.invalidateQueries({queryKey:["workflows"]}),e.invalidateQueries({queryKey:["workflow",r]})}})}function edt(){const e=ht();return Ct({mutationFn:async({workflowId:t})=>Wl(`/workflows/${t}`,{method:"DELETE"}),onSuccess:()=>{e.invalidateQueries({queryKey:["workflows"]})}})}function $0e(e){const r=new URLSearchParams().toString(),n=r?`/playbooks?${r}`:"/playbooks";return gt({queryKey:["playbooks",e],queryFn:()=>Wl(n),refetchInterval:3e4})}function F0e(e){return gt({queryKey:["playbook",e],queryFn:()=>Wl(`/playbooks/${e}`),enabled:!!e})}function tdt(){const e=ht();return Ct({mutationFn:async t=>Wl("/playbooks",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["playbooks"]})}})}function rdt(){const e=ht();return Ct({mutationFn:async({playbookId:t,...r})=>Wl(`/playbooks/${t}`,{method:"PATCH",body:JSON.stringify(r)}),onSuccess:(t,{playbookId:r})=>{e.invalidateQueries({queryKey:["playbooks"]}),e.invalidateQueries({queryKey:["playbook",r]})}})}function ndt(){const e=ht();return Ct({mutationFn:async({playbookId:t,...r})=>Wl("/workflows",{method:"POST",body:JSON.stringify({playbookId:t,...r})}),onSuccess:()=>{e.invalidateQueries({queryKey:["workflows"]})}})}function adt({playbook:e,onCreate:t,onEdit:r,onDelete:n}){const[a,i]=w.useState(!1);return o.jsxs("div",{className:"flex flex-col p-4 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)] transition-colors duration-150","data-testid":`playbook-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(kd,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:e.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:e.name})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>i(!a),className:"p-1 rounded hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Playbook actions",children:o.jsx(n0,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),a&&o.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg z-10",children:[o.jsxs("button",{onClick:()=>{t(e.id),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]",children:[o.jsx(en,{className:"w-4 h-4"}),"Create Workflow"]}),r&&o.jsxs("button",{onClick:()=>{r(e.id),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]","data-testid":`playbook-edit-${e.id}`,children:[o.jsx(li,{className:"w-4 h-4"}),"Edit"]}),n&&o.jsxs("button",{onClick:()=>{n(e.id),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-[var(--color-text-secondary)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(rn,{className:"w-3 h-3"}),e.steps.length," steps"]}),o.jsxs("span",{children:["v",e.version]}),e.variables.length>0&&o.jsxs("span",{children:[e.variables.length," variables"]})]}),o.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--color-border)]",children:o.jsxs("button",{onClick:()=>t(e.id),className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":`playbook-create-${e.id}`,children:[o.jsx(en,{className:"w-4 h-4"}),"Create Workflow"]})})]})}function idt(e){switch(e){case"pending":return o.jsx(tn,{className:"w-4 h-4"});case"running":return o.jsx(en,{className:"w-4 h-4"});case"completed":return o.jsx(Pi,{className:"w-4 h-4"});case"failed":return o.jsx(oi,{className:"w-4 h-4"});case"cancelled":return o.jsx(WC,{className:"w-4 h-4"});default:return o.jsx(tn,{className:"w-4 h-4"})}}function _te({workflow:e,onViewDetails:t,onCancel:r,onDelete:n}){const[a,i]=w.useState(!1),s=e.status==="pending"||e.status==="running",l=["completed","failed","cancelled"].includes(e.status),c=Gut(e);return o.jsxs("div",{className:"flex flex-col p-4 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)] transition-colors duration-150 cursor-pointer","data-testid":`workflow-card-${e.id}`,onClick:()=>t(e.id),children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${Ste(e.status)}`,children:idt(e.status)}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:e.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:e.id})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:u=>{u.stopPropagation(),i(!a)},className:"p-1 rounded hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Workflow actions",children:o.jsx(n0,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),a&&o.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg z-10",children:[o.jsxs("button",{onClick:u=>{u.stopPropagation(),t(e.id),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]",children:[o.jsx(du,{className:"w-4 h-4"}),"View Details"]}),s&&r&&o.jsxs("button",{onClick:u=>{u.stopPropagation(),r(e.id),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-900/20",children:[o.jsx(Bn,{className:"w-4 h-4"}),"Cancel"]}),l&&n&&o.jsxs("button",{onClick:u=>{u.stopPropagation(),n(e.id),i(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-[var(--color-text-secondary)]",children:[o.jsx("span",{className:`px-2 py-0.5 rounded-full ${Ste(e.status)}`,children:Kut(e.status)}),c&&o.jsxs("span",{children:["Duration: ",c]}),e.ephemeral&&o.jsx("span",{className:"text-amber-600",children:"Ephemeral"})]}),o.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-[var(--color-text-tertiary)]",children:[o.jsxs("span",{children:["Created ",kte(e.createdAt)]}),e.startedAt&&o.jsxs("span",{children:["Started ",kte(e.startedAt)]})]}),(e.failureReason||e.cancelReason)&&o.jsx("div",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded text-xs text-red-600 dark:text-red-400",children:e.failureReason||e.cancelReason})]})}function sdt({variable:e,value:t,onChange:r}){const n=t!==void 0?t:e.default;return e.type==="boolean"?o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:!!n,onChange:a=>r(a.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)]","data-testid":`variable-input-${e.name}`}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Enable"})]}):e.enum&&e.enum.length>0?o.jsxs("select",{value:String(n??""),onChange:a=>r(e.type==="number"?Number(a.target.value):a.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":`variable-input-${e.name}`,children:[o.jsx("option",{value:"",children:"Select..."}),e.enum.map(a=>o.jsx("option",{value:String(a),children:String(a)},String(a)))]}):o.jsx("input",{type:e.type==="number"?"number":"text",value:String(n??""),onChange:a=>r(e.type==="number"?Number(a.target.value):a.target.value),placeholder:e.default!==void 0?`Default: ${e.default}`:"",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":`variable-input-${e.name}`})}function odt({steps:e}){const[t,r]=w.useState(!1),n=t?e:e.slice(0,3),a=e.length>3;return o.jsxs("div",{"data-testid":"steps-preview",className:"space-y-2",children:[o.jsxs("div",{className:"text-sm font-medium text-[var(--color-text)]",children:["Steps (",e.length,")"]}),o.jsx("div",{className:"space-y-1",children:n.map((i,s)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx("span",{className:"w-5 h-5 flex items-center justify-center bg-[var(--color-surface-elevated)] rounded text-xs font-medium",children:s+1}),o.jsx("span",{className:"truncate",children:i.title})]},i.id))}),a&&o.jsx("button",{onClick:()=>r(!t),className:"text-xs text-[var(--color-primary)] hover:underline",children:t?"Show less":`Show ${e.length-3} more...`})]})}function ldt({selectedPlaybookId:e,onSelect:t}){const[r,n]=w.useState(!1),{data:a,isLoading:i}=$0e(),s=a?.playbooks??[],l=s.find(c=>c.id===e);return i?o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg",children:[o.jsx($e,{className:"w-4 h-4 animate-spin text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading playbooks..."})]}):s.length===0?o.jsxs("div",{className:"px-3 py-4 text-center bg-[var(--color-surface)] border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(kd,{className:"w-6 h-6 mx-auto mb-2 text-[var(--color-text-tertiary)]"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"No playbooks available"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Create a playbook template first"})]}):o.jsxs("div",{className:"relative","data-testid":"playbook-picker",children:[o.jsxs("button",{type:"button",onClick:()=>n(!r),className:"w-full flex items-center justify-between px-3 py-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)]/50 transition-colors","data-testid":"playbook-picker-trigger",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(kd,{className:"w-4 h-4 text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:l?.title??"Select a playbook..."})]}),o.jsx(cr,{className:`w-4 h-4 text-[var(--color-text-secondary)] transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"absolute z-20 w-full mt-1 max-h-60 overflow-auto bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg","data-testid":"playbook-picker-dropdown",children:s.map(c=>o.jsxs("button",{onClick:()=>{t(c.id),n(!1)},className:`w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-[var(--color-surface-hover)] ${e===c.id?"bg-[var(--color-primary-muted)]":""}`,"data-testid":`playbook-option-${c.id}`,children:[o.jsx(kd,{className:"w-4 h-4 text-[var(--color-primary)]"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-[var(--color-text)]",children:c.title}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:c.name})]})]},c.id))})]})}function cdt({isOpen:e,onClose:t,playbookId:r,onSuccess:n}){const[a,i]=w.useState(""),[s,l]=w.useState(r??null),[c,u]=w.useState({}),[d,f]=w.useState(!0),[m,p]=w.useState(null),{data:v,isLoading:b}=F0e(s),y=v?.playbook,S=ndt();w.useEffect(()=>{r&&l(r)},[r]),w.useEffect(()=>{if(y){const E={};for(const T of y.variables)T.default!==void 0&&(E[T.name]=T.default);u(E),a||i(y.title)}},[y]),w.useEffect(()=>{e||(i(""),l(r??null),u({}),f(!0),p(null),S.reset())},[e,r]);const N=w.useMemo(()=>{const E=[];if(!y)E.push("Please select a playbook");else for(const T of y.variables)T.required&&!c[T.name]&&T.default===void 0&&E.push(`Required variable: ${T.name}`);return E},[y,c]).length===0&&!S.isPending,k=w.useCallback((E,T)=>{u(O=>({...O,[E]:T}))},[]),j=async()=>{if(p(null),!y||!s){p("Please select a playbook");return}try{const E=await S.mutateAsync({playbookId:s,title:a||y.title,variables:c,ephemeral:d});n?.({id:E.workflow.id,title:a||y.title}),t()}catch(E){p(E instanceof Error?E.message:"Failed to create workflow")}};return e?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"create-workflow-container",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 animate-fade-in",onClick:t,"data-testid":"create-workflow-backdrop"}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:o.jsxs("div",{className:`
            w-full max-w-lg max-h-[90vh]
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
            flex flex-col
          `,style:{pointerEvents:"auto"},"data-testid":"create-workflow-dialog",role:"dialog","aria-labelledby":"create-workflow-title",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(en,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{id:"create-workflow-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Create Workflow"})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Close dialog","data-testid":"create-workflow-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),(m||S.error)&&o.jsxs("div",{className:"mx-4 mt-4 flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),m||S.error?.message||"An error occurred"]}),o.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-sm font-medium text-[var(--color-text)]",children:["Playbook ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(ldt,{selectedPlaybookId:s,onSelect:l})]}),b&&s&&o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx($e,{className:"w-6 h-6 text-[var(--color-primary)] animate-spin"})}),y&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Workflow Title"}),o.jsx("input",{type:"text",value:a,onChange:E=>i(E.target.value),placeholder:y.title,className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"create-title-input"})]}),o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(kd,{className:"w-4 h-4 text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:y.title})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[y.steps.length," steps, v",y.version]})]}),y.variables.length>0&&o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"text-sm font-medium text-[var(--color-text)]",children:"Variables"}),y.variables.map(E=>o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)]",children:[E.name,E.required&&o.jsx("span",{className:"text-red-500",children:"*"})]}),E.description&&o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:E.description}),o.jsx(sdt,{variable:E,value:c[E.name],onChange:T=>k(E.name,T)})]},E.name))]}),o.jsx(odt,{steps:y.steps}),o.jsxs("details",{className:"text-sm","data-testid":"advanced-options",children:[o.jsx("summary",{className:"text-[var(--color-text-secondary)] cursor-pointer hover:text-[var(--color-text)]","data-testid":"toggle-advanced",children:"Advanced options"}),o.jsx("div",{className:"mt-2 p-3 bg-[var(--color-surface)] rounded-lg space-y-2",children:o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:d,onChange:E=>f(E.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)]","data-testid":"ephemeral-checkbox"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Ephemeral workflow"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Ephemeral workflows are automatically cleaned up after completion"})]})]})})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end gap-2 px-4 py-3 border-t border-[var(--color-border)] flex-shrink-0",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors","data-testid":"create-cancel-button",children:"Cancel"}),o.jsx("button",{onClick:j,disabled:!N,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors","data-testid":"create-submit-button",children:S.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-4 h-4"}),"Create Workflow"]})})]})]})})]}):null}function udt(e){const t={id:e.id,title:e.title};if(e.description.trim()&&(t.description=e.description.trim()),e.dependsOn.length>0&&(t.dependsOn=e.dependsOn),e.condition.trim()&&(t.condition=e.condition.trim()),e.stepType==="function"){if(t.stepType="function",t.runtime=e.runtime,e.runtime==="shell"?e.command.trim()&&(t.command=e.command.trim()):e.code.trim()&&(t.code=e.code.trim()),e.timeout.trim()){const r=parseInt(e.timeout,10);!isNaN(r)&&r>0&&(t.timeout=r)}}else e.taskType&&(t.taskType=e.taskType),e.priority&&(t.priority=e.priority),e.complexity&&(t.complexity=e.complexity),e.assignee.trim()&&(t.assignee=e.assignee.trim());return t}function ddt(e){const t={name:e.name,type:e.type,required:e.required};if(e.description.trim()&&(t.description=e.description.trim()),e.default.trim())switch(e.type){case"number":t.default=Number(e.default);break;case"boolean":t.default=e.default==="true";break;default:t.default=e.default}if(e.enum.length>0&&e.enum.some(r=>r.trim())){const r=e.enum.filter(n=>n.trim());switch(e.type){case"number":t.enum=r.map(Number);break;case"boolean":t.enum=r.map(n=>n==="true");break;default:t.enum=r}}return t}function fdt(e,t,r,n){const a=[];if(a.push(`name: ${e}`),a.push(`title: "${t}"`),a.push("version: 1"),n.length>0){a.push(""),a.push("variables:");for(const i of n){if(a.push(`  - name: ${i.name}`),a.push(`    type: ${i.type}`),a.push(`    required: ${i.required}`),i.description&&a.push(`    description: "${i.description}"`),i.default){const s=i.type==="string"?`"${i.default}"`:i.default;a.push(`    default: ${s}`)}if(i.enum.length>0&&i.enum.some(s=>s.trim())){a.push("    enum:");for(const s of i.enum.filter(l=>l.trim())){const l=i.type==="string"?`"${s}"`:s;a.push(`      - ${l}`)}}}}if(r.length>0){a.push(""),a.push("steps:");for(const i of r){if(a.push(`  - id: ${i.id}`),a.push(`    title: "${i.title}"`),i.description&&a.push(`    description: "${i.description}"`),i.stepType==="function"){if(a.push("    step_type: function"),a.push(`    runtime: ${i.runtime}`),i.runtime==="shell"&&i.command)if(i.command.includes(`
`)){a.push("    command: |");for(const s of i.command.split(`
`))a.push(`      ${s}`)}else a.push(`    command: "${i.command}"`);else if(i.code){a.push("    code: |");for(const s of i.code.split(`
`))a.push(`      ${s}`)}i.timeout&&a.push(`    timeout: ${i.timeout}`)}else i.taskType&&a.push(`    task_type: ${i.taskType}`),i.priority&&a.push(`    priority: ${i.priority}`),i.complexity&&a.push(`    complexity: ${i.complexity}`),i.assignee&&a.push(`    assignee: "${i.assignee}"`);if(i.dependsOn.length>0){a.push("    depends_on:");for(const s of i.dependsOn)a.push(`      - ${s}`)}i.condition&&a.push(`    condition: "${i.condition}"`)}}return a.join(`
`)}function hdt({step:e,index:t,isSelected:r,onSelect:n,onMoveUp:a,onMoveDown:i,onDelete:s,isFirst:l,isLast:c}){const u=e.stepType==="function";return o.jsxs("div",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors duration-150 ${r?"border-[var(--color-primary)] bg-[var(--color-primary-muted)]":"border-[var(--color-border)] bg-[var(--color-surface)] hover:border-[var(--color-primary)]/50"}`,onClick:n,"data-testid":`step-item-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx(Jae,{className:"w-4 h-4 text-[var(--color-text-tertiary)] cursor-grab flex-shrink-0"}),o.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs font-medium text-[var(--color-text-secondary)] flex-shrink-0",children:t+1}),o.jsx("span",{className:`flex items-center justify-center w-6 h-6 rounded flex-shrink-0 ${u?"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400":"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400"}`,title:u?"Function step":"Task step",children:u?o.jsx(na,{className:"w-3.5 h-3.5"}):o.jsx(tu,{className:"w-3.5 h-3.5"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.title||"Untitled step"}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)] font-mono truncate",children:[e.id,u&&e.runtime&&o.jsxs("span",{className:"ml-1 text-purple-500",children:[" ",e.runtime]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[e.dependsOn.length>0&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",children:[e.dependsOn.length," dep",e.dependsOn.length>1?"s":""]}),o.jsx("button",{onClick:d=>{d.stopPropagation(),a()},disabled:l,className:"p-1 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:o.jsx(Rx,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),o.jsx("button",{onClick:d=>{d.stopPropagation(),i()},disabled:c,className:"p-1 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:o.jsx(Ix,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),o.jsx("button",{onClick:d=>{d.stopPropagation(),s()},className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-red-500",title:"Delete step",children:o.jsx(Sr,{className:"w-4 h-4"})})]})]})}function mdt({step:e,onChange:t,allStepIds:r,onClose:n}){const a=r.filter(c=>c!==e.id),i=e.stepType==="function",s=(c,u)=>{t({...e,[c]:u})},l=c=>{const u=e.dependsOn.includes(c)?e.dependsOn.filter(d=>d!==c):[...e.dependsOn,c];s("dependsOn",u)};return o.jsxs("div",{className:"space-y-4 max-h-[500px] overflow-y-auto","data-testid":"step-form",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)]",children:"Edit Step"}),o.jsx("button",{onClick:n,className:"p-1 rounded hover:bg-[var(--color-surface-hover)]",children:o.jsx(wt,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Step Type"}),o.jsx("div",{className:"flex gap-2",children:Wut.map(c=>o.jsx("button",{onClick:()=>s("stepType",c.value),className:`flex-1 px-3 py-2 text-sm rounded-lg border transition-colors ${e.stepType===c.value?"bg-[var(--color-primary)] text-white border-[var(--color-primary)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:border-[var(--color-primary)]"}`,"data-testid":`step-type-${c.value}`,children:c.label},c.value))}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:e.stepType==="function"?"Execute code directly":"Create an agent task"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Step ID"}),o.jsx("input",{type:"text",value:e.id,onChange:c=>s("id",c.target.value.replace(/[^a-zA-Z0-9_-]/g,"")),placeholder:"step_id",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 font-mono","data-testid":"step-id-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:e.title,onChange:c=>s("title",c.target.value),placeholder:"Step title",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-title-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Description"}),o.jsx("textarea",{value:e.description,onChange:c=>s("description",c.target.value),placeholder:"Step description",rows:2,className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"step-description-input"})]}),i&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Runtime ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:e.runtime,onChange:c=>s("runtime",c.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-runtime-select",children:wte.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:wte.find(c=>c.value===e.runtime)?.description})]}),e.runtime!=="shell"&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Code ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:e.code,onChange:c=>s("code",c.target.value),placeholder:e.runtime==="typescript"?`// TypeScript code to execute
export default async function() {
  // Your code here
}`:`# Python code to execute
def main():
    # Your code here
    pass`,rows:8,className:"w-full px-3 py-2 text-sm font-mono bg-gray-900 text-green-400 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"step-code-input"})]}),e.runtime==="shell"&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Command ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:e.command,onChange:c=>s("command",c.target.value),placeholder:"echo 'Hello World' && ls -la",rows:4,className:"w-full px-3 py-2 text-sm font-mono bg-gray-900 text-green-400 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"step-command-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Timeout (ms)"}),o.jsx("input",{type:"number",value:e.timeout,onChange:c=>s("timeout",c.target.value),placeholder:"30000",min:"1",max:"600000",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-timeout-input"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Default: 30000ms (30 seconds). Max: 600000ms (10 minutes)"})]})]}),!i&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Task Type"}),o.jsxs("select",{value:e.taskType,onChange:c=>s("taskType",c.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-tasktype-select",children:[o.jsx("option",{value:"",children:"None"}),Fut.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Priority"}),o.jsxs("select",{value:e.priority,onChange:c=>s("priority",c.target.value?Number(c.target.value):""),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-priority-select",children:[o.jsx("option",{value:"",children:"None"}),Uut.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Complexity"}),o.jsxs("select",{value:e.complexity,onChange:c=>s("complexity",c.target.value?Number(c.target.value):""),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-complexity-select",children:[o.jsx("option",{value:"",children:"None"}),Hut.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Assignee"}),o.jsx("input",{type:"text",value:e.assignee,onChange:c=>s("assignee",c.target.value),placeholder:"{{variable}} or entity name",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-assignee-input"})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Dependencies"}),a.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No other steps available"}):o.jsx("div",{className:"flex flex-wrap gap-2","data-testid":"step-dependencies",children:a.map(c=>o.jsx("button",{onClick:()=>l(c),className:`px-2 py-1 text-xs rounded-full border transition-colors ${e.dependsOn.includes(c)?"bg-[var(--color-primary)] text-white border-[var(--color-primary)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:border-[var(--color-primary)]"}`,children:c},c))})]})]})}function pdt({variable:e,onChange:t,onClose:r}){const n=(l,c)=>{t({...e,[l]:c})},a=()=>{n("enum",[...e.enum,""])},i=(l,c)=>{const u=[...e.enum];u[l]=c,n("enum",u)},s=l=>{n("enum",e.enum.filter((c,u)=>u!==l))};return o.jsxs("div",{className:"space-y-4","data-testid":"variable-form",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)]",children:"Edit Variable"}),o.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-[var(--color-surface-hover)]",children:o.jsx(wt,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:e.name,onChange:l=>n("name",l.target.value.replace(/[^a-zA-Z0-9_]/g,"")),placeholder:"variable_name",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 font-mono","data-testid":"variable-name-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Type ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:e.type,onChange:l=>n("type",l.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-type-select",children:qut.map(l=>o.jsx("option",{value:l.value,children:l.label},l.value))})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:e.required,onChange:l=>n("required",l.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)]","data-testid":"variable-required-checkbox"}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Required"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Description"}),o.jsx("input",{type:"text",value:e.description,onChange:l=>n("description",l.target.value),placeholder:"What this variable is for",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-description-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Default Value"}),e.type==="boolean"?o.jsxs("select",{value:e.default,onChange:l=>n("default",l.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-default-input",children:[o.jsx("option",{value:"",children:"No default"}),o.jsx("option",{value:"true",children:"true"}),o.jsx("option",{value:"false",children:"false"})]}):o.jsx("input",{type:e.type==="number"?"number":"text",value:e.default,onChange:l=>n("default",l.target.value),placeholder:e.type==="number"?"0":"default value",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-default-input"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Allowed Values"}),o.jsxs("button",{onClick:a,className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded",children:[o.jsx(_r,{className:"w-3 h-3"}),"Add"]})]}),e.enum.length>0?o.jsx("div",{className:"space-y-2","data-testid":"variable-enum-list",children:e.enum.map((l,c)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:e.type==="number"?"number":"text",value:l,onChange:u=>i(c,u.target.value),placeholder:`Option ${c+1}`,className:"flex-1 px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30"}),o.jsx("button",{onClick:()=>s(c),className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-red-500",children:o.jsx(Sr,{className:"w-4 h-4"})})]},c))}):o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No enum values. Variable accepts any value of its type."})]})]})}function gdt({yaml:e,onImport:t}){const[r,n]=w.useState(!1),[a,i]=w.useState(""),[s,l]=w.useState(!1),c=async()=>{try{await navigator.clipboard.writeText(e),l(!0),setTimeout(()=>l(!1),2e3)}catch(f){console.error("Failed to copy:",f)}},u=()=>{const f=new Blob([e],{type:"text/yaml"}),m=URL.createObjectURL(f),p=document.createElement("a");p.href=m,p.download="playbook.yaml",p.click(),URL.revokeObjectURL(m)},d=()=>{t(a),n(!1),i("")};return o.jsxs("div",{className:"space-y-3","data-testid":"yaml-preview",children:[o.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[o.jsxs("button",{onClick:()=>n(!r),className:`flex items-center gap-1 px-3 py-1.5 text-sm rounded-lg transition-colors ${r?"bg-[var(--color-primary)] text-white":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":"yaml-import-toggle",children:[o.jsx(zae,{className:"w-4 h-4"}),"Import"]}),o.jsxs("button",{onClick:c,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-[var(--color-surface)] text-[var(--color-text-secondary)] rounded-lg hover:bg-[var(--color-surface-hover)]","data-testid":"yaml-copy",children:[s?o.jsx(Vn,{className:"w-4 h-4 text-green-500"}):o.jsx(ej,{className:"w-4 h-4"}),s?"Copied!":"Copy"]}),o.jsxs("button",{onClick:u,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-[var(--color-surface)] text-[var(--color-text-secondary)] rounded-lg hover:bg-[var(--color-surface-hover)]","data-testid":"yaml-download",children:[o.jsx(sy,{className:"w-4 h-4"}),"Download"]})]}),r&&o.jsxs("div",{className:"p-3 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 text-sm bg-[var(--color-primary)] text-white rounded-lg cursor-pointer hover:bg-[var(--color-primary-hover)]",children:[o.jsx(rn,{className:"w-4 h-4"}),"Upload File",o.jsx("input",{type:"file",accept:".yaml,.yml",onChange:f=>{const m=f.target.files?.[0];if(m){const p=new FileReader;p.onload=v=>{const b=v.target?.result;t(b),n(!1)},p.readAsText(m)}},className:"hidden","data-testid":"yaml-file-input"})]}),o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"or paste YAML below"})]}),o.jsx("textarea",{value:a,onChange:f=>i(f.target.value),placeholder:"Paste YAML content here...",rows:10,className:"w-full px-3 py-2 text-sm font-mono bg-[var(--color-bg)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"yaml-import-textarea"}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{onClick:()=>{n(!1),i("")},className:"px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded-lg",children:"Cancel"}),o.jsxs("button",{onClick:d,disabled:!a.trim(),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary-hover)] disabled:opacity-50","data-testid":"yaml-import-confirm",children:[o.jsx(Vn,{className:"w-4 h-4"}),"Import"]})]})]}),o.jsx("pre",{className:"p-4 bg-gray-900 text-green-400 rounded-lg overflow-auto text-xs font-mono max-h-96","data-testid":"yaml-content",children:e})]})}function vdt({isOpen:e,onClose:t,playbookId:r,onSuccess:n}){const a=!!r,[i,s]=w.useState(""),[l,c]=w.useState(""),[u,d]=w.useState([]),[f,m]=w.useState([]),[p,v]=w.useState("steps"),[b,y]=w.useState(null),[S,_]=w.useState(null),[N,k]=w.useState(null),{data:j,isLoading:E,error:T}=F0e(r??void 0),O=j?.playbook,R=tdt(),q=rdt();w.useEffect(()=>{O&&a&&(s(O.name),c(O.title),d(O.steps.map(Y=>{const ie=Y.stepType??"task",fe=ie==="function";return{id:Y.id,title:Y.title,description:Y.description??"",stepType:ie,taskType:fe?"":Y.taskType??"",priority:fe?"":Y.priority??"",complexity:fe?"":Y.complexity??"",assignee:fe?"":Y.assignee??"",runtime:fe?Y.runtime??"typescript":"typescript",code:fe?Y.code??"":"",command:fe?Y.command??"":"",timeout:fe?Y.timeout?.toString()??"":"",dependsOn:Y.dependsOn??[],condition:Y.condition??""}})),m(O.variables.map(Y=>({name:Y.name,description:Y.description??"",type:Y.type,required:Y.required,default:Y.default!==void 0?String(Y.default):"",enum:Y.enum?.map(String)??[]}))))},[O,a]),w.useEffect(()=>{e||(s(""),c(""),d([]),m([]),v("steps"),y(null),_(null),k(null))},[e]);const $=w.useMemo(()=>fdt(i||"my_playbook",l||"My Playbook",u,f),[i,l,u,f]),L=w.useMemo(()=>u.map(Y=>Y.id),[u]),A=w.useMemo(()=>{const Y=[];i.trim()||Y.push("Name is required"),l.trim()||Y.push("Title is required"),!/^[a-zA-Z_][a-zA-Z0-9_-]*$/.test(i)&&i.trim()&&Y.push("Name must start with letter/underscore");for(const ie of u)ie.id.trim()||Y.push("All steps must have an ID"),ie.title.trim()||Y.push("All steps must have a title");for(const ie of f)ie.name.trim()||Y.push("All variables must have a name");return Y},[i,l,u,f]),M=A.length===0&&!R.isPending&&!q.isPending,z=w.useCallback((Y="task")=>{const ie={id:HL(),title:"",description:"",stepType:Y,taskType:"",priority:"",complexity:"",assignee:"",runtime:"typescript",code:"",command:"",timeout:"",dependsOn:[],condition:""};d(fe=>[...fe,ie]),y(u.length)},[u.length]),I=w.useCallback((Y,ie)=>{d(fe=>fe.map((me,te)=>te===Y?ie:me))},[]),B=w.useCallback(Y=>{const ie=u[Y]?.id;d(fe=>fe.filter((te,oe)=>oe!==Y).map(te=>({...te,dependsOn:te.dependsOn.filter(oe=>oe!==ie)}))),y(null)},[u]),F=w.useCallback((Y,ie)=>{d(fe=>{const me=[...fe],te=ie==="up"?Y-1:Y+1;return[me[Y],me[te]]=[me[te],me[Y]],me}),y(ie==="up"?Y-1:Y+1)},[]),U=w.useCallback(()=>{const Y={name:"",description:"",type:"string",required:!1,default:"",enum:[]};m(ie=>[...ie,Y]),_(f.length)},[f.length]),V=w.useCallback((Y,ie)=>{m(fe=>fe.map((me,te)=>te===Y?ie:me))},[]),K=w.useCallback(Y=>{m(ie=>ie.filter((fe,me)=>me!==Y)),_(null)},[]),G=w.useCallback(Y=>{try{const ie=Y.split(`
`);let fe="",me="";const te=[],oe=[];let ce="root",Z=null;for(const ue of ie){const H=ue.trim();if(!H||H.startsWith("#"))continue;if(H==="steps:"){ce="steps",Z=null;continue}if(H==="variables:"){ce="variables",Z=null;continue}const ge=H.match(/^-?\s*(\w+):\s*(.*)$/);if(!ge)continue;const[,de,re]=ge,ne=re.replace(/^["']|["']$/g,"");ce==="root"?de==="name"?fe=ne:de==="title"&&(me=ne):ce==="steps"?H.startsWith("-")?(Z&&"id"in Z&&te.push({id:Z.id||HL(),title:Z.title||"",description:Z.description||"",stepType:"task",taskType:"",priority:"",complexity:"",assignee:"",runtime:"typescript",code:"",command:"",timeout:"",dependsOn:[],condition:""}),Z={id:ne}):Z&&(de==="title"?Z.title=ne:de==="description"&&(Z.description=ne)):ce==="variables"&&(H.startsWith("-")?(Z&&"name"in Z&&Z.name&&oe.push({name:Z.name||"",description:Z.description||"",type:Z.type||"string",required:Z.required||!1,default:Z.default||"",enum:[]}),Z={name:ne}):Z&&(de==="type"?Z.type=ne:de==="required"?Z.required=ne==="true":de==="description"?Z.description=ne:de==="default"&&(Z.default=ne)))}Z&&(ce==="steps"&&"id"in Z?te.push({id:Z.id||HL(),title:Z.title||"",description:Z.description||"",stepType:"task",taskType:"",priority:"",complexity:"",assignee:"",runtime:"typescript",code:"",command:"",timeout:"",dependsOn:[],condition:""}):ce==="variables"&&"name"in Z&&Z.name&&oe.push({name:Z.name||"",description:Z.description||"",type:Z.type||"string",required:Z.required||!1,default:Z.default||"",enum:[]})),fe&&s(fe),me&&c(me),te.length>0&&d(te),oe.length>0&&m(oe),v("steps"),k(null)}catch{k("Failed to parse YAML. Please check the format and try again.")}},[]),J=async()=>{if(k(null),A.length>0){k(A.join(", "));return}try{const Y=u.map(udt),ie=f.map(ddt);if(a&&r){const fe=await q.mutateAsync({playbookId:r,title:l,steps:Y,variables:ie});n?.(fe.playbook)}else{const fe=await R.mutateAsync({name:i,title:l,steps:Y,variables:ie});n?.(fe.playbook)}t()}catch(Y){k(Y instanceof Error?Y.message:"Failed to save playbook")}};if(!e)return null;const ee=R.isPending||q.isPending;return o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"workflow-editor-container",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 animate-fade-in",onClick:t,"data-testid":"workflow-editor-backdrop"}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:o.jsxs("div",{className:"w-full max-w-3xl max-h-[90vh] mx-auto bg-[var(--color-bg)] rounded-xl shadow-2xl border border-[var(--color-border)] animate-scale-in pointer-events-auto flex flex-col",style:{pointerEvents:"auto"},"data-testid":"workflow-editor-dialog",role:"dialog","aria-labelledby":"workflow-editor-title",onClick:Y=>Y.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(kd,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{id:"workflow-editor-title",className:"text-lg font-semibold text-[var(--color-text)]",children:a?"Edit Template":"Create Template"})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Close dialog","data-testid":"workflow-editor-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),E&&a&&o.jsx("div",{className:"flex items-center justify-center py-16",children:o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})}),(N||T)&&o.jsxs("div",{className:"mx-4 mt-4 flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-4 h-4 flex-shrink-0"}),N||T?.message||"An error occurred"]}),(!E||!a)&&o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[o.jsx("div",{className:"px-4 pt-4 pb-3 border-b border-[var(--color-border)] space-y-3 flex-shrink-0",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:i,onChange:Y=>s(Y.target.value.replace(/[^a-zA-Z0-9_-]/g,"")),placeholder:"my_playbook",disabled:a,className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 font-mono disabled:opacity-50","data-testid":"playbook-name-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l,onChange:Y=>c(Y.target.value),placeholder:"My Playbook",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"playbook-title-input"})]})]})}),o.jsx("div",{className:"px-4 border-b border-[var(--color-border)] flex-shrink-0",children:o.jsxs("nav",{className:"flex gap-4","aria-label":"Editor tabs",children:[o.jsxs("button",{onClick:()=>v("steps"),className:`flex items-center gap-1.5 py-3 px-1 text-sm font-medium border-b-2 transition-colors ${p==="steps"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent"}`,"data-testid":"tab-steps",children:[o.jsx(Wp,{className:"w-4 h-4"}),"Steps",o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface)]",children:u.length})]}),o.jsxs("button",{onClick:()=>v("variables"),className:`flex items-center gap-1.5 py-3 px-1 text-sm font-medium border-b-2 transition-colors ${p==="variables"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent"}`,"data-testid":"tab-variables",children:[o.jsx(dT,{className:"w-4 h-4"}),"Variables",o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface)]",children:f.length})]}),o.jsxs("button",{onClick:()=>v("yaml"),className:`flex items-center gap-1.5 py-3 px-1 text-sm font-medium border-b-2 transition-colors ${p==="yaml"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent"}`,"data-testid":"tab-yaml",children:[o.jsx(Kp,{className:"w-4 h-4"}),"YAML"]})]})}),o.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[p==="steps"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:"Steps"}),o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 text-sm text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded","data-testid":"add-step-button",children:[o.jsx(_r,{className:"w-4 h-4"}),"Add Step",o.jsx(cr,{className:"w-3 h-3 ml-0.5"})]}),o.jsxs("div",{className:"absolute right-0 mt-1 w-48 py-1 bg-[var(--color-bg)] border border-[var(--color-border)] rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:[o.jsxs("button",{onClick:()=>z("task"),className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]","data-testid":"add-task-step",children:[o.jsx(tu,{className:"w-4 h-4 text-blue-500"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-medium",children:"Task Step"}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Agent-executed task"})]})]}),o.jsxs("button",{onClick:()=>z("function"),className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]","data-testid":"add-function-step",children:[o.jsx(na,{className:"w-4 h-4 text-purple-500"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-medium",children:"Function Step"}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Execute code directly"})]})]})]})]})]}),o.jsx("div",{className:"space-y-2 max-h-[400px] overflow-auto","data-testid":"step-list",children:u.length===0?o.jsxs("div",{className:"text-center py-8 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(Wp,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),'No steps yet. Click "Add Step" to begin.']}):u.map((Y,ie)=>o.jsx(hdt,{step:Y,index:ie,isSelected:b===ie,onSelect:()=>y(ie),onMoveUp:()=>F(ie,"up"),onMoveDown:()=>F(ie,"down"),onDelete:()=>B(ie),isFirst:ie===0,isLast:ie===u.length-1},Y.id||ie))})]}),o.jsx("div",{className:"border-l border-[var(--color-border)] pl-4",children:b!==null&&u[b]?o.jsx(mdt,{step:u[b],onChange:Y=>I(b,Y),allStepIds:L,onClose:()=>y(null)}):o.jsx("div",{className:"flex items-center justify-center h-full text-sm text-[var(--color-text-tertiary)]",children:o.jsxs("div",{className:"text-center",children:[o.jsx(EO,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Select a step to edit"]})})})]}),p==="variables"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:"Variables"}),o.jsxs("button",{onClick:U,className:"flex items-center gap-1 px-2 py-1 text-sm text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded","data-testid":"add-variable-button",children:[o.jsx(_r,{className:"w-4 h-4"}),"Add Variable"]})]}),o.jsx("div",{className:"space-y-2 max-h-[400px] overflow-auto","data-testid":"variable-list",children:f.length===0?o.jsxs("div",{className:"text-center py-8 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(dT,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),'No variables yet. Click "Add Variable" to begin.']}):f.map((Y,ie)=>o.jsxs("div",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors duration-150 ${S===ie?"border-[var(--color-primary)] bg-[var(--color-primary-muted)]":"border-[var(--color-border)] bg-[var(--color-surface)] hover:border-[var(--color-primary)]/50"}`,onClick:()=>_(ie),"data-testid":`variable-item-${Y.name}`,children:[o.jsx(dT,{className:"w-4 h-4 text-[var(--color-primary)] flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate font-mono",children:Y.name||"unnamed"}),Y.required&&o.jsx("span",{className:"text-red-500 text-xs",children:"required"})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[Y.type,Y.enum.length>0&&` (enum: ${Y.enum.length})`]})]}),o.jsx("button",{onClick:fe=>{fe.stopPropagation(),K(ie)},className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-red-500",title:"Delete variable",children:o.jsx(Sr,{className:"w-4 h-4"})})]},Y.name||ie))})]}),o.jsx("div",{className:"border-l border-[var(--color-border)] pl-4",children:S!==null&&f[S]?o.jsx(pdt,{variable:f[S],onChange:Y=>V(S,Y),onClose:()=>_(null)}):o.jsx("div",{className:"flex items-center justify-center h-full text-sm text-[var(--color-text-tertiary)]",children:o.jsxs("div",{className:"text-center",children:[o.jsx(EO,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Select a variable to edit"]})})})]}),p==="yaml"&&o.jsx(gdt,{yaml:$,onImport:G})]})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[u.length," step",u.length!==1?"s":"",", ",f.length," variable",f.length!==1?"s":"",A.length>0&&o.jsxs("span",{className:"ml-2 text-red-500",children:["(",A.length," validation error",A.length!==1?"s":"",")"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors","data-testid":"cancel-button",children:"Cancel"}),o.jsx("button",{onClick:J,disabled:!M,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors","data-testid":"save-button",children:ee?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(XC,{className:"w-4 h-4"}),a?"Save Changes":"Create Template"]})})]})]})]})})]})}function bdt({progress:e}){const{percentage:t,completed:r,inProgress:n,blocked:a,open:i,total:s}=e,l=s>0?r/s*100:0,c=s>0?n/s*100:0,u=s>0?a/s*100:0;return o.jsxs("div",{className:"space-y-3","data-testid":"workflow-progress-bar",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Progress"}),o.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[t,"% complete"]})]}),o.jsxs("div",{className:"h-3 bg-[var(--color-surface-elevated)] rounded-full overflow-hidden flex",children:[l>0&&o.jsx("div",{className:"bg-green-500 transition-all duration-500",style:{width:`${l}%`},title:`Completed: ${r}`}),c>0&&o.jsx("div",{className:"bg-blue-500 transition-all duration-500",style:{width:`${c}%`},title:`In Progress: ${n}`}),u>0&&o.jsx("div",{className:"bg-red-400 transition-all duration-500",style:{width:`${u}%`},title:`Blocked: ${a}`})]}),o.jsxs("div",{className:"flex flex-wrap gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["Completed (",r,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["In Progress (",n,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["Blocked (",a,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300 dark:bg-gray-600"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["Open (",i,")"]})]})]})]})}function ydt({progress:e}){const t=[{label:"Total Tasks",value:e.total,icon:A6,color:"text-[var(--color-text)]",bgColor:"bg-[var(--color-surface-elevated)]"},{label:"Completed",value:e.completed,icon:Pi,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30"},{label:"In Progress",value:e.inProgress,icon:en,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30"},{label:"Blocked",value:e.blocked,icon:Bt,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30"}];return o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3","data-testid":"workflow-stats-cards",children:t.map(r=>o.jsxs("div",{className:`p-3 rounded-lg ${r.bgColor}`,"data-testid":`stat-card-${r.label.toLowerCase().replace(" ","-")}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(r.icon,{className:`w-4 h-4 ${r.color}`}),o.jsx("span",{className:`text-xl font-semibold ${r.color}`,children:r.value})]}),o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:r.label})]},r.label))})}function xdt({task:e,dependsOn:t,blockedBy:r}){const n=w.useMemo(()=>{switch(e.status){case"closed":return o.jsx(Pi,{className:"w-4 h-4 text-green-500"});case"in_progress":return o.jsx($e,{className:"w-4 h-4 text-blue-500 animate-spin"});case"blocked":return o.jsx(Bt,{className:"w-4 h-4 text-red-400"});case"open":return o.jsx(nu,{className:"w-4 h-4 text-gray-400"});default:return o.jsx(tn,{className:"w-4 h-4 text-gray-400"})}},[e.status]);return o.jsxs("div",{className:"flex items-center gap-3 p-3 border border-[var(--color-border)] rounded-lg bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`workflow-task-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0",children:n}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.title})}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs",children:[o.jsx("span",{className:`px-1.5 py-0.5 rounded ${wdt(e.status)}`,children:e.status.replace("_"," ")}),t.length>0&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["Depends on ",t.length," task",t.length>1?"s":""]})]})]}),r.length>0&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-500",children:[o.jsx(Bn,{className:"w-3 h-3"}),o.jsx("span",{children:"Blocked"})]})]})}function wdt(e){switch(e){case"closed":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400";case"blocked":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400";case"in_progress":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400";default:return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400"}}function Sdt({step:e,dependsOn:t,blockedBy:r}){const n=w.useMemo(()=>{switch(e.status){case"completed":return o.jsx(Pi,{className:"w-4 h-4 text-green-500"});case"running":return o.jsx($e,{className:"w-4 h-4 text-purple-500 animate-spin"});case"failed":return o.jsx(oi,{className:"w-4 h-4 text-red-500"});case"pending":default:return o.jsx(tn,{className:"w-4 h-4 text-gray-400"})}},[e.status]),a=w.useMemo(()=>{const l=e.runtime;switch(l){case"typescript":return"TS";case"python":return"PY";case"shell":return"SH";default:return l?.toUpperCase()??""}},[e.runtime]),i=l=>{switch(l){case"typescript":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400";case"python":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400";case"shell":return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400";default:return"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400"}},s=l=>{switch(l){case"completed":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400";case"failed":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400";case"running":return"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400";default:return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400"}};return o.jsxs("div",{className:"flex items-center gap-3 p-3 border border-purple-200 dark:border-purple-800/50 rounded-lg bg-purple-50/50 dark:bg-purple-900/10 hover:bg-purple-100/50 dark:hover:bg-purple-900/20 transition-colors","data-testid":`workflow-function-step-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0",children:n}),o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded bg-purple-100 dark:bg-purple-900/30",children:o.jsx(na,{className:"w-3.5 h-3.5 text-purple-600 dark:text-purple-400"})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.title}),o.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-mono ${i(e.runtime)}`,children:a})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs",children:[o.jsx("span",{className:`px-1.5 py-0.5 rounded ${s(e.status)}`,children:e.status}),t.length>0&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["Depends on ",t.length," step",t.length>1?"s":""]}),e.timeout&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["Timeout: ",e.timeout/1e3,"s"]})]})]}),e.error&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-500",title:e.error,children:[o.jsx(Bn,{className:"w-3 h-3"}),o.jsx("span",{children:"Error"})]}),r.length>0&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-500",children:[o.jsx(Bn,{className:"w-3 h-3"}),o.jsx("span",{children:"Blocked"})]})]})}function kdt({tasks:e,functionSteps:t=[],steps:r=[],dependencies:n}){const{dependsOnMap:a,blockedByMap:i}=w.useMemo(()=>{const l=new Map,c=new Map;for(const u of n)l.has(u.blockedId)||l.set(u.blockedId,[]),l.get(u.blockedId).push(u.blockerId),c.has(u.blockedId)||c.set(u.blockedId,[]),c.get(u.blockedId).push(u.blockerId);return{dependsOnMap:l,blockedByMap:c}},[n]),s=w.useMemo(()=>{let l=r.length>0?r:[...e,...t];const c={in_progress:0,running:0,blocked:1,open:2,pending:2,closed:3,completed:3,failed:4,deferred:5,tombstone:6};return l.sort((u,d)=>{const f=c[u.status]??99,m=c[d.status]??99;return f-m})},[e,t,r]);return s.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-secondary)]",children:"No steps in this workflow"}):o.jsx("div",{className:"space-y-2","data-testid":"workflow-step-list",children:s.map(l=>B0e(l)?o.jsx(Sdt,{step:l,dependsOn:a.get(l.id)??[],blockedBy:i.get(l.id)??[]},l.id):o.jsx(xdt,{task:l,dependsOn:a.get(l.id)??[],blockedBy:i.get(l.id)??[]},l.id))})}function _dt({tasks:e,dependencies:t}){const r=w.useMemo(()=>{const a=new Map;for(const i of e)a.set(i.id,i);return a},[e]);if(t.length===0)return o.jsx("div",{className:"text-center py-4 text-[var(--color-text-tertiary)] text-sm",children:"No dependencies between tasks"});const n=a=>{switch(a){case"closed":return"border-green-500 bg-green-100 dark:bg-green-900/30";case"in_progress":return"border-blue-500 bg-blue-100 dark:bg-blue-900/30";case"blocked":return"border-red-400 bg-red-100 dark:bg-red-900/30";default:return"border-gray-300 bg-gray-100 dark:bg-gray-800"}};return o.jsxs("div",{className:"space-y-3","data-testid":"workflow-dependency-graph",children:[o.jsxs("div",{className:"text-xs text-[var(--color-text-secondary)] mb-2",children:["Task dependencies (",t.length," connection",t.length!==1?"s":"",")"]}),o.jsxs("div",{className:"space-y-2 overflow-x-auto",children:[t.slice(0,10).map((a,i)=>{const s=r.get(a.blockedId),l=r.get(a.blockerId);return!s||!l?null:o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("div",{className:`px-2 py-1 rounded border-2 ${n(s.status)} truncate max-w-[150px]`,title:s.title,children:s.title}),o.jsx(qh,{className:"w-4 h-4 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsx("div",{className:`px-2 py-1 rounded border-2 ${n(l.status)} truncate max-w-[150px]`,title:l.title,children:l.title})]},i)}),t.length>10&&o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:["...and ",t.length-10," more"]})]})]})}function Ndt({workflow:e,tasks:t,functionSteps:r=[],steps:n=[],progress:a,dependencies:i,isLoading:s}){if(s)return o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})});const l=s$[e.status],c=n.length>0?n.length:t.length+r.length,u=r.length>0||n.some(d=>B0e(d));return o.jsxs("div",{className:"space-y-6","data-testid":"workflow-progress-dashboard",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:e.title}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)]",children:[c," step",c!==1?"s":""," in workflow",u&&o.jsxs("span",{className:"ml-2 inline-flex items-center gap-1",children:[o.jsx(na,{className:"w-3 h-3 text-purple-500"}),o.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"includes function steps"})]})]})]}),o.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${l?.bgColor??""} ${l?.color??""}`,children:l?.label??e.status})]}),o.jsx(ydt,{progress:a}),o.jsx(bdt,{progress:a}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)] mb-3",children:"Steps"}),o.jsx(kdt,{tasks:t,functionSteps:r,steps:n,dependencies:i})]}),o.jsxs("div",{className:"lg:col-span-1",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)] mb-3",children:"Dependencies"}),o.jsx("div",{className:"p-4 border border-[var(--color-border)] rounded-lg bg-[var(--color-surface)]",children:o.jsx(_dt,{tasks:t,dependencies:i})})]})]})]})}function Cdt(){const e=rl({from:"/workflows"}),t=Ma(),r=e.tab||"templates",n=e.selected,[a,i]=w.useState(""),[s,l]=w.useState(!1),[c,u]=w.useState(null),[d,f]=w.useState(!1),[m,p]=w.useState(null);w.useEffect(()=>{e.action==="create"&&(f(!0),p(null),t({to:"/workflows",search:{tab:"templates",selected:void 0},replace:!0}))},[e.action,t]);const{data:v,isLoading:b,error:y,refetch:S}=$0e(),_=v?.playbooks??[],{data:N,isLoading:k,error:j,refetch:E}=Yut(),T=N?.workflows??[],{workflow:O,tasks:R,progress:q,dependencies:$,isLoading:L,error:A}=Zut(n),M=w.useMemo(()=>T.filter(H=>H.status==="pending"||H.status==="running"),[T]),z=w.useMemo(()=>T.filter(H=>["completed","failed","cancelled"].includes(H.status)),[T]),I=Xut(),B=edt(),F=w.useMemo(()=>{const H=a.toLowerCase().trim();return H?_.filter(ge=>ge.name.toLowerCase().includes(H)||ge.title.toLowerCase().includes(H)):_},[a,_]),U=w.useMemo(()=>{const H=a.toLowerCase().trim();return H?M.filter(ge=>ge.title.toLowerCase().includes(H)):M},[a,M]),V=w.useMemo(()=>{const H=a.toLowerCase().trim();return H?z.filter(ge=>ge.title.toLowerCase().includes(H)):z},[a,z]),K=H=>{t({to:"/workflows",search:{selected:e.selected,tab:H}})},G=H=>{u(H),l(!0)},J=H=>{console.log("Workflow created:",H.id,H.title),K("active")},ee=()=>{p(null),f(!0)},Y=H=>{p(H),f(!0)},ie=()=>{S()},fe=async H=>{try{await I.mutateAsync({workflowId:H,reason:"Cancelled by user"})}catch(ge){console.error("Failed to cancel workflow:",ge)}},me=async H=>{try{await B.mutateAsync({workflowId:H})}catch(ge){console.error("Failed to delete workflow:",ge)}},te=H=>{t({to:"/workflows",search:{tab:e.tab??"active",selected:H}})},oe=()=>{t({to:"/workflows",search:{tab:e.tab??"active",selected:void 0}})},ce=r==="templates"?b:k,Z=r==="templates"?y:j,ue=r==="templates"?S:E;return n&&O?o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"workflow-detail-page",children:[o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"workflow-back-button",children:[o.jsx(zx,{className:"w-4 h-4"}),"Back to Workflows"]})}),A&&o.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-5 h-5 text-red-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error loading workflow"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:A.message})]})]}),o.jsx(Ndt,{workflow:O,tasks:R,progress:q,dependencies:$,isLoading:L})]}):n&&L?o.jsx("div",{className:"flex items-center justify-center py-16",children:o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})}):o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"workflows-page",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(vh,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Workflows"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Manage workflow templates and active workflows"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>ue(),className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors duration-150",title:"Refresh",children:o.jsx(jr,{className:`w-4 h-4 ${ce?"animate-spin":""}`})}),r==="templates"&&o.jsxs("button",{onClick:ee,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"workflows-create",children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Template",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(Pl("action.createWorkflow"))})]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:r==="templates"?"Search templates...":"Search workflows...",value:a,onChange:H=>i(H.target.value),className:"w-full pl-10 pr-4 py-2 text-sm text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"workflows-search"})]}),o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("nav",{className:"flex gap-4","aria-label":"Tabs",children:[o.jsxs("button",{onClick:()=>K("templates"),className:`pb-3 px-1 text-sm font-medium border-b-2 transition-colors ${r==="templates"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"workflows-tab-templates",children:["Templates",_.length>0&&o.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-[var(--color-primary-muted)] text-[var(--color-primary)]",children:_.length})]}),o.jsxs("button",{onClick:()=>K("active"),className:`pb-3 px-1 text-sm font-medium border-b-2 transition-colors ${r==="active"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"workflows-tab-active",children:["Active",M.length>0&&o.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",children:M.length})]})]})}),Z&&o.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Bt,{className:"w-5 h-5 text-red-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error loading data"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:Z.message})]}),o.jsx("button",{onClick:()=>ue(),className:"ml-auto px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",children:"Retry"})]}),ce&&o.jsx("div",{className:"flex items-center justify-center py-16","data-testid":"workflows-loading",children:o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})}),!ce&&!Z&&r==="templates"&&o.jsx(o.Fragment,{children:F.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(kd,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:a?"No matching templates":"No workflow templates"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:a?"Try adjusting your search query.":"Create workflow templates to define reusable sequences of tasks. Templates can be used to create active workflows."}),!a&&o.jsx("div",{className:"mt-4",children:o.jsxs("button",{onClick:ee,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"workflows-create-empty",children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Template"]})})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"playbooks-grid",children:F.map(H=>o.jsx(adt,{playbook:H,onCreate:G,onEdit:Y},H.id))})}),!ce&&!Z&&r==="active"&&o.jsx(o.Fragment,{children:U.length===0&&V.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(vh,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:a?"No matching workflows":"No workflows"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:a?"Try adjusting your search query.":"Use a template to create a new workflow, or create an ad-hoc workflow."}),!a&&o.jsx("div",{className:"mt-4",children:o.jsxs("button",{onClick:()=>K("templates"),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150",children:[o.jsx(kd,{className:"w-4 h-4"}),"View Templates"]})})]}):o.jsxs("div",{className:"space-y-6",children:[U.length>0&&o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] mb-3",children:["Active (",U.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"active-workflows-grid",children:U.map(H=>o.jsx(_te,{workflow:H,onCancel:fe,onDelete:me,onViewDetails:te},H.id))})]}),V.length>0&&o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] mb-3",children:["Recent (",V.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"terminal-workflows-grid",children:V.slice(0,9).map(H=>o.jsx(_te,{workflow:H,onCancel:fe,onDelete:me,onViewDetails:te},H.id))}),V.length>9&&o.jsxs("p",{className:"mt-4 text-sm text-[var(--color-text-secondary)] text-center",children:["Showing 9 of ",V.length," completed workflows"]})]})]})}),o.jsx(cdt,{isOpen:s,onClose:()=>{l(!1),u(null)},playbookId:c,onSuccess:J}),o.jsx(vdt,{isOpen:d,onClose:()=>{f(!1),p(null)},playbookId:m,onSuccess:ie})]})}const lp={open:"#3b82f6",in_progress:"#eab308",blocked:"#ef4444",closed:"#22c55e",review:"#8b5cf6",backlog:"#94a3b8"},jdt={1:"#ef4444",2:"#f97316",3:"#eab308",4:"#3b82f6",5:"#6b7280"},U0e=[{label:"Last 7 days",days:7},{label:"Last 14 days",days:14},{label:"Last 30 days",days:30}];function Nte(e,t){const r=new Date;return r.setDate(r.getDate()-t),r.setHours(0,0,0,0),e.filter(n=>{const a=n.metadata?.orchestrator?.completedAt||n.updatedAt;return new Date(a)>=r})}function Edt(e){const t=new Date;return t.setHours(0,0,0,0),e.filter(r=>{const n=r.metadata?.orchestrator?.completedAt||r.updatedAt;return new Date(n)>=t}).length}function H0e(e){if(e<6e4)return"<1m";const t=Math.floor(e/6e4);if(t<60)return`${t}m`;const r=Math.floor(t/60),n=t%60;return r<24?n>0?`${r}h ${n}m`:`${r}h`:`${Math.floor(r/24)}d ${r%24}h`}function Mdt(e){const t=e.filter(n=>{const a=n.metadata?.orchestrator;return a?.startedAt&&a?.completedAt});if(t.length===0)return"";const r=t.reduce((n,a)=>{const i=a.metadata?.orchestrator,s=new Date(i.startedAt).getTime(),l=new Date(i.completedAt).getTime();return n+Math.max(0,l-s)},0);return H0e(r/t.length)}function cp({label:e,value:t,subtitle:r,icon:n,iconColor:a,trend:i,warning:s,testId:l}){return o.jsxs("div",{className:`p-4 rounded-lg border bg-[var(--color-card-bg)] transition-colors duration-150 ${s?"border-[var(--color-warning)] bg-[color-mix(in_srgb,var(--color-warning)_5%,var(--color-card-bg))]":"border-[var(--color-border)]"}`,"data-testid":l,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:e}),o.jsx("div",{className:`p-1.5 rounded-md ${a}`,children:o.jsx(n,{className:"w-3.5 h-3.5"})})]}),o.jsx("div",{className:"mt-2 text-2xl font-bold text-[var(--color-text)] tabular-nums",children:t}),o.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:r}),i&&i.value!==0&&o.jsxs("span",{className:`inline-flex items-center gap-0.5 text-xs font-medium ${i.value>0?"text-[var(--color-success)]":"text-[var(--color-error)]"}`,children:[i.value>0?o.jsx(Zae,{className:"w-3 h-3"}):o.jsx(Ewe,{className:"w-3 h-3"}),i.value>0?"+":"",i.value,o.jsx("span",{className:"text-[var(--color-text-tertiary)] font-normal ml-0.5",children:i.label})]})]})]})}function Tdt({selected:e,onSelect:t}){const[r,n]=w.useState(!1),a=w.useRef(null);return w.useEffect(()=>{function i(s){a.current&&!a.current.contains(s.target)&&n(!1)}return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-[var(--color-text-secondary)] rounded-md border border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":"metrics-timerange",children:[o.jsx(r0,{className:"w-4 h-4"}),e.label,o.jsx(cr,{className:`w-3.5 h-3.5 transition-transform duration-150 ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"absolute right-0 mt-1 w-44 rounded-md border border-[var(--color-border)] bg-[var(--color-card-bg)] shadow-lg z-20",children:U0e.map(i=>o.jsx("button",{onClick:()=>{t(i),n(!1)},className:`w-full text-left px-3 py-2 text-sm transition-colors duration-100 first:rounded-t-md last:rounded-b-md ${i.days===e.days?"bg-[var(--color-primary-muted)] text-[var(--color-primary)] font-medium":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,children:i.label},i.days))})]})}function YS({title:e,icon:t}){return o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(t,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("h2",{className:"text-sm font-semibold text-[var(--color-text-secondary)] uppercase tracking-wider",children:e})]})}function Adt({plans:e,allTasks:t,isLoading:r}){const n=w.useMemo(()=>!e||e.length===0?[]:e.filter(a=>a.status!=="closed"&&a.status!=="completed").map(a=>{const i=t.filter(f=>f.tags?.includes(`plan:${a.id}`)||f.metadata?.planId===a.id),s=i.length,l=i.filter(f=>f.status==="closed").length,c=i.filter(f=>f.status==="in_progress").length,u=i.filter(f=>f.status==="blocked").length,d=s>0?Math.round(l/s*100):0;return{id:a.id,title:a.title,total:s,completed:l,inProgress:c,blocked:u,pct:d}}).filter(a=>a.total>0).sort((a,i)=>i.total-a.total).slice(0,8),[e,t]);return r?o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Plan Progress"}),o.jsx("div",{className:"space-y-3",children:[1,2,3].map(a=>o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-3 bg-[var(--color-surface-hover)] rounded w-1/3 mb-2"}),o.jsx("div",{className:"h-2 bg-[var(--color-surface-hover)] rounded w-full"})]},a))})]}):n.length===0?o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Plan Progress"}),o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-[var(--color-text-tertiary)]",children:[o.jsx(M6,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No active plans with tasks"})]})]}):o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Plan Progress"}),o.jsx("div",{className:"space-y-4",children:n.map(a=>o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[o.jsx("span",{className:"text-sm text-[var(--color-text)] truncate max-w-[70%]",title:a.title,children:a.title}),o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)] tabular-nums whitespace-nowrap ml-2",children:[a.completed,"/",a.total," (",a.pct,"%)"]})]}),o.jsxs("div",{className:"relative h-2 rounded-full bg-[var(--color-surface-hover)] overflow-hidden",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-[var(--color-success)] transition-all duration-500",style:{width:`${a.pct}%`}}),a.inProgress>0&&a.total>0&&o.jsx("div",{className:"absolute inset-y-0 rounded-full bg-[#eab308] opacity-70 transition-all duration-500",style:{left:`${a.pct}%`,width:`${Math.round(a.inProgress/a.total*100)}%`}}),a.blocked>0&&a.total>0&&o.jsx("div",{className:"absolute inset-y-0 rounded-full bg-[var(--color-error)] opacity-70 transition-all duration-500",style:{left:`${Math.round((a.completed+a.inProgress)/a.total*100)}%`,width:`${Math.round(a.blocked/a.total*100)}%`}})]}),(a.inProgress>0||a.blocked>0)&&o.jsxs("div",{className:"flex gap-3 mt-1",children:[a.inProgress>0&&o.jsxs("span",{className:"text-[10px] text-[#eab308]",children:[a.inProgress," in progress"]}),a.blocked>0&&o.jsxs("span",{className:"text-[10px] text-[var(--color-error)]",children:[a.blocked," blocked"]})]})]},a.id))})]})}function Ddt({counts:e,isLoading:t}){const r=[{label:"Needs Review",value:e.needsReview,color:"#eab308"},{label:"Testing",value:e.testing,color:"#3b82f6"},{label:"Conflicts",value:e.conflicts,color:"#ef4444"},{label:"Merged",value:e.merged,color:"#22c55e"}];return o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Merge Pipeline"}),t?o.jsx("div",{className:"space-y-3 animate-pulse",children:[1,2,3,4].map(n=>o.jsx("div",{className:"h-4 bg-[var(--color-surface-hover)] rounded"},n))}):o.jsx("div",{className:"space-y-3",children:r.map(n=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:n.color}}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:n.label})]}),o.jsx("span",{className:`text-sm font-semibold tabular-nums ${n.value>0?"text-[var(--color-text)]":"text-[var(--color-text-tertiary)]"}`,children:n.value})]},n.label))})]})}function Ldt({unassigned:e,blocked:t,inProgress:r,allTasks:n,isLoading:a}){const i=w.useMemo(()=>{if(e.length===0)return null;const u=e.reduce((f,m)=>new Date(f.createdAt)<new Date(m.createdAt)?f:m),d=Date.now()-new Date(u.createdAt).getTime();return H0e(d)},[e]),s=w.useMemo(()=>{const u=n.filter(f=>f.status!=="closed"&&f.status!=="tombstone"&&f.status!=="backlog").length;if(u===0)return 100;let d=100;return d-=Math.min(40,t.length/Math.max(1,u)*100),d-=Math.min(30,e.length/Math.max(1,u)*60),Math.max(0,Math.round(d))},[n,t,e]),l=s>=80?"text-[var(--color-success)]":s>=50?"text-[#eab308]":"text-[var(--color-error)]",c=[{label:"Unassigned",value:e.length,warn:e.length>3},{label:"Blocked",value:t.length,warn:t.length>0},{label:"In Progress",value:r.length,warn:!1}];return o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)]",children:"Queue Health"}),o.jsxs("span",{className:`text-lg font-bold tabular-nums ${l}`,children:[s,"%"]})]}),a?o.jsx("div",{className:"space-y-3 animate-pulse",children:[1,2,3].map(u=>o.jsx("div",{className:"h-4 bg-[var(--color-surface-hover)] rounded"},u))}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-3",children:c.map(u=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:u.label}),o.jsxs("span",{className:`text-sm font-semibold tabular-nums ${u.warn?"text-[var(--color-warning)]":"text-[var(--color-text)]"}`,children:[u.value,u.warn&&o.jsx(Bn,{className:"w-3 h-3 inline ml-1 -mt-0.5"})]})]},u.label))}),i&&o.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:"Oldest unassigned"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)] font-medium tabular-nums",children:[i," ago"]})]})})]})]})}function Odt(){const[e,t]=w.useState(U0e[0]),{backlog:r,unassigned:n,assigned:a,inProgress:i,blocked:s,closed:l,awaitingMerge:c,allTasks:u,isLoading:d,error:f}=h1(),{data:m,isLoading:p,error:v}=d1(),b=m?.agents??[],{workers:y,stewards:S}=g0(),{data:_,isLoading:N}=NJe(),{counts:k,isLoading:j}=Nme(),E=d||p,T=!!(f||v),O=w.useMemo(()=>b.filter(V=>V.metadata?.agent?.sessionStatus==="running").length,[b]),R=b.length,q=w.useMemo(()=>Nte(l,e.days),[l,e.days]),$=w.useMemo(()=>Edt(l),[l]),L=w.useMemo(()=>{const V=q.length,K=Nte(l,e.days*2).length-V;return{value:V-K,label:"vs prev"}},[q,l,e.days]),A=w.useMemo(()=>Mdt(q),[q]),M=w.useMemo(()=>[{name:"Open",value:a.length,key:"open",color:lp.open},{name:"In Progress",value:i.length,key:"in_progress",color:lp.in_progress},{name:"Blocked",value:s.length,key:"blocked",color:lp.blocked},{name:"Completed",value:l.length,key:"closed",color:lp.closed},{name:"Review",value:c.length,key:"review",color:lp.review},{name:"Backlog",value:r.length,key:"backlog",color:lp.backlog}].filter(V=>V.value>0),[a.length,i.length,s.length,l.length,c.length,r.length]),z=w.useMemo(()=>{const V=[],K=new Date,G=e.days;for(let J=G-1;J>=0;J--){const ee=new Date(K);ee.setDate(ee.getDate()-J),ee.setHours(0,0,0,0);const Y=new Date(ee);Y.setDate(Y.getDate()+1);const ie=J===0?"Today":G<=7?ee.toLocaleDateString("en-US",{weekday:"short"}):ee.toLocaleDateString("en-US",{month:"short",day:"numeric"}),fe=l.filter(me=>{const te=me.metadata?.orchestrator?.completedAt||me.updatedAt,oe=new Date(te);return oe>=ee&&oe<Y}).length;V.push({label:ie,value:fe,date:ee.toISOString().split("T")[0]})}return V},[l,e.days]),I=w.useMemo(()=>{const V={};[...a,...i,...s].forEach(J=>{if(J.assignee){const Y=b.find(ie=>ie.id===J.assignee)?.name||J.assignee.slice(0,8);V[J.assignee]||(V[J.assignee]={name:Y,count:0}),V[J.assignee].count++}});const G=Object.values(V).reduce((J,{count:ee})=>J+ee,0);return Object.entries(V).map(([J,{name:ee,count:Y}])=>({name:ee,value:Y,id:J,percentage:G>0?Math.round(Y/G*100):0})).sort((J,ee)=>ee.value-J.value).slice(0,10)},[a,i,s,b]),B=w.useMemo(()=>{const V={};q.forEach(G=>{const ee=G.metadata?.orchestrator?.assignedAgent||G.assignee;if(ee){const ie=b.find(fe=>fe.id===ee)?.name||ee.slice(0,8);V[ee]||(V[ee]={name:ie,count:0}),V[ee].count++}});const K=Object.values(V).reduce((G,{count:J})=>G+J,0);return Object.entries(V).map(([G,{name:J,count:ee}])=>({name:J,value:ee,id:G,percentage:K>0?Math.round(ee/K*100):0})).sort((G,J)=>J.value-G.value).slice(0,10)},[q,b]),F=w.useMemo(()=>{const V=u.filter(J=>J.status!=="closed"&&J.status!=="tombstone"),K={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Minimal"},G={};return V.forEach(J=>{G[J.priority]=(G[J.priority]||0)+1}),Object.entries(G).map(([J,ee])=>({name:K[Number(J)]||`P${J}`,value:ee,key:`p${J}`,color:jdt[Number(J)]||"#6b7280"})).filter(J=>J.value>0).sort((J,ee)=>J.name.localeCompare(ee.name))},[u]),U=w.useMemo(()=>{const V={task:"Task",feature:"Feature",bug:"Bug",chore:"Chore"},K={task:"#3b82f6",feature:"#8b5cf6",bug:"#ef4444",chore:"#6b7280"},G={};return u.filter(J=>J.status!=="tombstone").forEach(J=>{G[J.taskType]=(G[J.taskType]||0)+1}),Object.entries(G).map(([J,ee])=>({name:V[J]||J,value:ee,key:J,color:K[J]||"#6b7280"})).filter(J=>J.value>0).sort((J,ee)=>ee.value-J.value)},[u]);return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"metrics-page",children:[o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(GC,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Metrics"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Performance analytics and workspace health"})]})]}),o.jsx(Tdt,{selected:e,onSelect:t})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3","data-testid":"stats-cards",children:[o.jsx(cp,{label:"Completed",value:q.length,subtitle:`${$} today`,icon:Yn,iconColor:"bg-[color-mix(in_srgb,var(--color-success)_15%,transparent)] text-[var(--color-success)]",trend:L,testId:"stat-tasks-completed"}),o.jsx(cp,{label:"Active Agents",value:`${O}/${R}`,subtitle:`${y.length} workers, ${S.length} stewards`,icon:Ii,iconColor:"bg-[color-mix(in_srgb,var(--color-primary)_15%,transparent)] text-[var(--color-primary)]",testId:"stat-active-agents"}),o.jsx(cp,{label:"In Progress",value:i.length,subtitle:`${a.length} assigned total`,icon:Hh,iconColor:"bg-[color-mix(in_srgb,#eab308_15%,transparent)] text-[#eab308]",testId:"stat-in-progress"}),o.jsx(cp,{label:"Blocked",value:s.length,subtitle:`${n.length} unassigned`,icon:Bn,iconColor:"bg-[color-mix(in_srgb,var(--color-error)_15%,transparent)] text-[var(--color-error)]",warning:s.length>0,testId:"stat-blocked"}),o.jsx(cp,{label:"Avg Completion",value:A,subtitle:`${q.length} tasks measured`,icon:tn,iconColor:"bg-[color-mix(in_srgb,var(--color-accent)_15%,transparent)] text-[var(--color-accent)]",testId:"stat-avg-time"}),o.jsx(cp,{label:"Merge Queue",value:c.length,subtitle:`${k.merged} merged total`,icon:Ri,iconColor:"bg-[color-mix(in_srgb,#8b5cf6_15%,transparent)] text-[#8b5cf6]",testId:"stat-merge-queue"})]}),o.jsxs("div",{children:[o.jsx(YS,{title:"Activity & Distribution",icon:Zae}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4","data-testid":"charts-grid-activity",children:[o.jsx(J5e,{data:z,title:`Task Completions (${e.label})`,testId:"tasks-completed-chart",isLoading:E,isError:T,errorMessage:"Failed to load completion data",emptyMessage:"No completions in this period",total:q.length,height:220}),o.jsx(xD,{data:M,title:"Task Status Distribution",testId:"task-distribution-chart",isLoading:E,isError:T,errorMessage:"Failed to load task data",emptyMessage:"No tasks to display",height:220}),o.jsx(xD,{data:U,title:"Tasks by Type",testId:"task-type-chart",isLoading:E,isError:T,errorMessage:"Failed to load type data",emptyMessage:"No tasks to display",height:220})]})]}),o.jsxs("div",{children:[o.jsx(YS,{title:"Agent Performance",icon:eh}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4","data-testid":"charts-grid-agents",children:[o.jsx(UY,{data:B,title:`Tasks Completed by Agent (${e.label})`,testId:"agent-performance-chart",isLoading:E,isError:T,errorMessage:"Failed to load performance data",emptyMessage:"No completed tasks in this period",barColor:"#22c55e",height:240,maxBars:8}),o.jsx(UY,{data:I,title:"Current Workload by Agent",testId:"workload-by-agent-chart",isLoading:E,isError:T,errorMessage:"Failed to load workload data",emptyMessage:"No assigned tasks",barColor:"#3b82f6",height:240,maxBars:8})]})]}),o.jsxs("div",{children:[o.jsx(YS,{title:"Plans & Pipeline",icon:M6}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4","data-testid":"charts-grid-health",children:[o.jsx(Adt,{plans:_??[],allTasks:u,isLoading:N||d}),o.jsx(Ldt,{unassigned:n,blocked:s,inProgress:i,allTasks:u,isLoading:d}),o.jsx(Ddt,{counts:k,isLoading:j})]})]}),o.jsxs("div",{children:[o.jsx(YS,{title:"Priority Analysis",icon:Bn}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4","data-testid":"charts-grid-priority",children:o.jsx(xD,{data:F,title:"Open Tasks by Priority",testId:"priority-distribution-chart",isLoading:E,isError:T,errorMessage:"Failed to load priority data",emptyMessage:"No open tasks",height:220})})]})]})}function Idt(){const e=rl({from:"/settings"}),t=Ma(),r=e.tab||"preferences",n=a=>{t({to:"/settings",search:{tab:a}})};return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"settings-page",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(li,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Settings"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Configure your preferences and workspace"})]})]}),o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("nav",{className:"flex gap-1","aria-label":"Settings tabs",children:[o.jsx("button",{onClick:()=>n("preferences"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="preferences"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"settings-tab-preferences",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(P6,{className:"w-4 h-4"}),"Preferences"]})}),o.jsx("button",{onClick:()=>n("workspace"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="workspace"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"settings-tab-workspace",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(a0,{className:"w-4 h-4"}),"Workspace"]})})]})}),r==="preferences"?o.jsx(Rdt,{}):o.jsx(Bdt,{})]})}function Rdt(){const{theme:e,notifications:t,agentDefaults:r}=Ope(),n=jo();return o.jsxs("div",{className:"space-y-6 max-w-2xl","data-testid":"settings-preferences",children:[o.jsxs(Kc,{icon:P6,title:"Theme",description:"Choose how the interface looks",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(qL,{theme:"light",icon:Zk,label:"Light",isActive:e.theme==="light",onClick:()=>e.setTheme("light")}),o.jsx(qL,{theme:"dark",icon:Jk,label:"Dark",isActive:e.theme==="dark",onClick:()=>e.setTheme("dark")}),o.jsx(qL,{theme:"system",icon:E6,label:"System",isActive:e.theme==="system",onClick:()=>e.setTheme("system")})]}),o.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-tertiary)]",children:e.theme==="system"?`Currently using ${e.resolvedTheme} theme based on system preference`:`Using ${e.theme} theme`})]}),o.jsx(Kc,{icon:CO,title:"Notifications",description:"Configure how you receive alerts",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(Gc,{label:"Task completion alerts",description:"Notify when tasks are completed",checked:t.settings.taskCompletion,onChange:a=>t.setSettings({taskCompletion:a}),testId:"settings-notify-task"}),o.jsx(Gc,{label:"Agent health warnings",description:"Notify when agents encounter issues",checked:t.settings.agentHealth,onChange:a=>t.setSettings({agentHealth:a}),testId:"settings-notify-health"}),o.jsx(Gc,{label:"Merge notifications",description:"Notify when branches are merged",checked:t.settings.mergeNotifications,onChange:a=>t.setSettings({mergeNotifications:a}),testId:"settings-notify-merge"}),o.jsx("div",{className:"pt-2 border-t border-[var(--color-border)]",children:o.jsx(Gc,{label:"Sound",description:"Play a sound when notifications arrive",checked:t.settings.sound,onChange:a=>t.setSettings({sound:a}),icon:t.settings.sound?Mwe:Twe,testId:"settings-notify-sound"})}),o.jsxs("div",{className:"pt-2",children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Toast duration"}),o.jsxs("select",{value:t.settings.toastDuration,onChange:a=>t.setSettings({toastDuration:Number(a.target.value)}),className:"px-3 py-2 text-sm rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-toast-duration",children:[o.jsx("option",{value:"3000",children:"3 seconds"}),o.jsx("option",{value:"5000",children:"5 seconds"}),o.jsx("option",{value:"10000",children:"10 seconds"}),o.jsx("option",{value:"0",children:"Don't auto-dismiss"})]})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{onClick:()=>t.resetToDefaults(),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"settings-notify-reset",children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reset to defaults"]})})]})}),o.jsx(Pdt,{settings:r.settings,setSettings:r.setSettings,setDefaultModel:r.setDefaultModel,resetToDefaults:r.resetToDefaults}),o.jsx(Kc,{icon:Awe,title:"Keyboard Shortcuts",description:"Quick access to common actions",children:o.jsx(G6e,{defaults:ix,isMobile:n})})]})}const Cte={claude:"Claude",opencode:"OpenCode",codex:"Codex"};function Pdt({settings:e,setSettings:t,setDefaultModel:r,resetToDefaults:n}){const{data:a}=wB(),i=w.useMemo(()=>a?.providers??[],[a?.providers]),s=w.useMemo(()=>i.length>0?i:[{name:"claude",available:!0,installInstructions:""},{name:"opencode",available:!0,installInstructions:""},{name:"codex",available:!0,installInstructions:""}],[i]);return o.jsx(Kc,{icon:Xr,title:"Agent Defaults",description:"Default provider and model for new agents",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"default-provider",className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Default Provider"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{id:"default-provider",value:e.defaultProvider,onChange:l=>t({defaultProvider:l.target.value}),className:"w-full px-3 py-2 pr-8 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] appearance-none focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-default-provider",children:s.map(l=>o.jsxs("option",{value:l.name,disabled:!l.available,children:[Cte[l.name]??l.name,l.available?"":" (not installed)"]},l.name))}),o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Provider used by default when creating new agents"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-2",children:"Default Model per Provider"}),o.jsx("div",{className:"space-y-3",children:s.filter(l=>l.available).map(l=>o.jsx(zdt,{providerName:l.name,providerLabel:Cte[l.name]??l.name,selectedModel:e.defaultModels[l.name]??"",onModelChange:c=>r(l.name,c)},l.name))}),o.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-tertiary)]",children:"These models will be pre-selected when creating agents with the corresponding provider"})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"settings-agent-defaults-reset",children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reset to defaults"]})})]})})}function zdt({providerName:e,providerLabel:t,selectedModel:r,onModelChange:n}){const{data:a,isLoading:i}=SB(e),s=w.useMemo(()=>a?.models??[],[a?.models]),l=w.useMemo(()=>s.find(u=>u.isDefault),[s]),c=w.useMemo(()=>s.filter(u=>!u.isDefault),[s]);return o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-sm text-[var(--color-text)] w-24 flex-shrink-0 font-medium",children:t}),o.jsx("div",{className:"relative flex-1",children:i?o.jsxs("div",{className:"flex items-center gap-2 py-2 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),"Loading models..."]}):o.jsxs(o.Fragment,{children:[o.jsxs("select",{value:r,onChange:u=>n(u.target.value),className:"w-full px-3 py-1.5 pr-8 text-sm rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] appearance-none focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":`settings-default-model-${e}`,children:[o.jsx("option",{value:"",children:l?`Provider default (${l.displayName})`:"Provider default"}),c.map(u=>o.jsx("option",{value:u.id,children:u.providerName?`${u.displayName}  ${u.providerName}`:u.displayName},u.id))]}),o.jsx(cr,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})})]})}function Bdt(){const{workspace:e,stewardSchedules:t,resetAllToDefaults:r}=Ope(),[n,a]=w.useState(!1);return o.jsxs("div",{className:"space-y-6 max-w-2xl","data-testid":"settings-workspace",children:[o.jsx(Kc,{icon:cu,title:"Git Worktrees",description:"Configure how agent worktrees are managed",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Worktree directory"}),o.jsx("input",{type:"text",value:e.settings.worktreeDirectory,onChange:i=>e.setSettings({worktreeDirectory:i.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent",placeholder:".stoneforge/.worktrees/","data-testid":"settings-worktree-dir"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Directory relative to workspace root where agent worktrees are created"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Default branch"}),o.jsx("input",{type:"text",value:e.settings.defaultBranch,onChange:i=>e.setSettings({defaultBranch:i.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent",placeholder:"main","data-testid":"settings-default-branch"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Branch used as base for new worktrees"})]}),o.jsx(Gc,{label:"Auto-merge passing branches",description:"Automatically merge branches when tests pass",checked:e.settings.autoMerge,onChange:i=>e.setSettings({autoMerge:i}),testId:"settings-auto-merge"})]})}),o.jsx(Kc,{icon:tn,title:"Ephemeral Tasks",description:"Configure temporary task retention",children:o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Retention period"}),o.jsxs("select",{value:e.settings.ephemeralRetention,onChange:i=>e.setSettings({ephemeralRetention:i.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-ephemeral-retention",children:[o.jsx("option",{value:"1h",children:"1 hour"}),o.jsx("option",{value:"6h",children:"6 hours"}),o.jsx("option",{value:"12h",children:"12 hours"}),o.jsx("option",{value:"24h",children:"24 hours"}),o.jsx("option",{value:"7d",children:"7 days"}),o.jsx("option",{value:"30d",children:"30 days"})]}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Completed ephemeral tasks are automatically deleted after this period"})]})})}),o.jsx(Kc,{icon:Xo,title:"Steward Schedules",description:"Configure automated steward execution",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx(Gc,{label:"Health Steward",description:"Monitors agent health and restarts stuck agents",checked:t.settings.healthStewardEnabled,onChange:i=>t.setSettings({healthStewardEnabled:i}),testId:"settings-health-steward"}),t.settings.healthStewardEnabled&&o.jsxs("div",{className:"pl-6 border-l-2 border-[var(--color-border)]",children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Check interval"}),o.jsxs("select",{value:t.settings.healthCheckInterval,onChange:i=>t.setSettings({healthCheckInterval:i.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-health-interval",children:[o.jsx("option",{value:"1m",children:"Every minute"}),o.jsx("option",{value:"5m",children:"Every 5 minutes"}),o.jsx("option",{value:"15m",children:"Every 15 minutes"}),o.jsx("option",{value:"30m",children:"Every 30 minutes"})]})]}),o.jsx(Gc,{label:"Merge Steward",description:"Automatically merges completed branches",checked:t.settings.mergeStewardEnabled,onChange:i=>t.setSettings({mergeStewardEnabled:i}),testId:"settings-merge-steward"}),o.jsx(Gc,{label:"Ops Steward",description:"Runs scheduled maintenance tasks",checked:t.settings.opsStewardEnabled,onChange:i=>t.setSettings({opsStewardEnabled:i}),testId:"settings-ops-steward"}),t.settings.opsStewardEnabled&&o.jsxs("div",{className:"pl-6 border-l-2 border-[var(--color-border)]",children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(r0,{className:"w-4 h-4"}),"Schedule (cron)"]})}),o.jsx("input",{type:"text",value:t.settings.opsSchedule,onChange:i=>t.setSettings({opsSchedule:i.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] font-mono text-sm focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent",placeholder:"0 2 * * *","data-testid":"settings-ops-schedule"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Cron expression (default: 2 AM daily)"})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{onClick:()=>t.resetToDefaults(),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"settings-steward-reset",children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reset to defaults"]})})]})}),o.jsx($dt,{}),o.jsx(Kc,{icon:Sr,title:"Reset All Settings",description:"Reset all settings to their default values",variant:"danger",children:n?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Are you sure?"}),o.jsxs("button",{onClick:()=>{r(),a(!1)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 transition-opacity","data-testid":"settings-reset-confirm",children:[o.jsx(Vn,{className:"w-4 h-4"}),"Yes, Reset"]}),o.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors","data-testid":"settings-reset-cancel",children:"Cancel"})]}):o.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-danger-text)] bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-md hover:bg-[var(--color-danger)] hover:text-white transition-colors","data-testid":"settings-reset-all",children:[o.jsx(Rs,{className:"w-4 h-4"}),"Reset All Settings"]})})]})}function $dt(){const{data:e}=m1(),t=GJe(),r=e?.config?.directorInboxForwardingEnabled??!1;return o.jsx(Kc,{icon:ss,title:"Director",description:"Configure director agent behavior",children:o.jsx(Gc,{label:"Auto-forward inbox messages",description:"Forward new messages to the director's terminal when idle (120s debounce)",checked:r,onChange:n=>t.mutate({directorInboxForwardingEnabled:n}),testId:"settings-director-forwarding"})})}function Kc({icon:e,title:t,description:r,children:n,variant:a="default"}){const i=a==="danger"?"border-[var(--color-danger)]":"border-[var(--color-border)]",s=a==="danger"?"text-[var(--color-danger)]":"text-[var(--color-text-secondary)]";return o.jsxs("div",{className:`p-4 rounded-lg border ${i} bg-[var(--color-card-bg)]`,"data-testid":`settings-section-${t.toLowerCase().replace(/\s+/g,"-")}`,children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(e,{className:`w-5 h-5 ${s}`}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:t}),r&&o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:r})]})]}),n]})}function qL({theme:e,icon:t,label:r,isActive:n,onClick:a}){return o.jsxs("button",{onClick:a,className:`flex items-center gap-2 px-4 py-2 text-sm rounded-md border transition-colors ${n?"border-[var(--color-primary)] text-[var(--color-primary)] bg-[var(--color-primary-muted)]":"border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":`settings-theme-${e}`,children:[o.jsx(t,{className:"w-4 h-4"}),r,n&&o.jsx(Vn,{className:"w-3 h-3"})]})}function Gc({label:e,description:t,checked:r,onChange:n,icon:a,testId:i}){return o.jsxs("label",{className:"flex items-center justify-between cursor-pointer group","data-testid":i,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx(a,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-[var(--color-text)] group-hover:text-[var(--color-primary)]",children:e}),t&&o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:t})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"checkbox",checked:r,onChange:s=>n(s.target.checked),className:"sr-only peer","data-checked":r}),o.jsx("div",{className:"w-11 h-6 bg-[var(--color-surface-elevated)] peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-[var(--color-primary)] rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[var(--color-primary)]"})]})]})}const Fdt={disconnected:"bg-gray-400",connecting:"bg-yellow-500 animate-pulse",connected:"bg-green-500",error:"bg-red-500"},jte={director:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",icon:na},worker:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",icon:na},steward:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",icon:t0}};function Udt(){const e=rl({from:"/popout/terminal"}),t=e.agent,r=e.type||"terminal",n=e.name,a=e.role,i=e.mode,[s,l]=w.useState("disconnected"),{data:c,isLoading:u,error:d}=rme(t),{data:f}=kB(t),m=p2(),p=f1(),v=c?.agent,b=f?.hasActiveSession??!1,y=v?.metadata?.agent?.agentRole||a||"worker",S=v?.name||n||"Unknown Agent",_=v?.metadata?.agent?.workerMode||i;w.useEffect(()=>(S!=="Unknown Agent"&&(document.title=`Stoneforge | ${S} - Terminal`),()=>{document.title="Stoneforge"}),[S]);const N=async()=>{if(t)try{await m.mutateAsync({agentId:t,interactive:r==="terminal"})}catch(O){console.error("Failed to start session:",O)}},k=async()=>{if(t)try{await p.mutateAsync({agentId:t,graceful:!0})}catch(O){console.error("Failed to stop session:",O)}},j=w.useCallback(()=>{if(!t)return;const O={type:"pop-back-in",pane:{agentId:t,agentName:S,agentRole:y,workerMode:_,paneType:r}},R=new BroadcastChannel(b0e);R.postMessage(O),R.close(),window.close()},[t,S,y,_,r]);if(u&&!n)return o.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-[#1a1a1a]",children:o.jsxs("div",{className:"flex items-center gap-3 text-[var(--color-text-muted)]",children:[o.jsx(jr,{className:"w-5 h-5 animate-spin"}),o.jsx("span",{children:"Loading agent..."})]})});if(!t||d&&!n)return o.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-[#1a1a1a] p-6",children:[o.jsx(Bt,{className:"w-12 h-12 text-red-400 mb-4"}),o.jsx("h1",{className:"text-lg font-medium text-white mb-2",children:"Agent Not Found"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center max-w-md mb-6",children:t?"The specified agent could not be found.":"No agent ID provided."}),o.jsx("button",{onClick:()=>window.close(),className:`
            inline-flex items-center gap-2
            px-4 py-2 rounded-lg
            bg-[var(--color-surface)] border border-[var(--color-border)]
            text-[var(--color-text)]
            hover:bg-[var(--color-surface-hover)]
            transition-colors
          `,children:"Close Window"})]});const E=jte[y]||jte.worker,T=E.icon;return o.jsxs("div",{className:"h-screen w-screen flex flex-col bg-[#1a1a1a]",children:[o.jsxs("div",{className:`
        flex items-center justify-between
        px-4 py-2
        border-b border-[var(--color-border)]
        bg-[var(--color-surface)]
      `,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full flex-shrink-0 ${b?Fdt[s]:"bg-gray-400"}`,title:b?s:"Session not running"}),o.jsxs("span",{className:`
            inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium
            ${E.bg} ${E.text}
          `,children:[o.jsx(T,{className:"w-3.5 h-3.5"}),y]}),o.jsx("span",{className:"text-sm font-mono text-[var(--color-text)]",children:S}),_&&o.jsx("span",{className:`
              px-2 py-1 rounded text-xs
              bg-[var(--color-surface-hover)] text-[var(--color-text-tertiary)]
            `,children:_})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:j,className:`
              inline-flex items-center gap-1.5
              px-3 py-1.5 rounded-md
              bg-[var(--color-surface-hover)] hover:bg-[var(--color-border)]
              text-[var(--color-text-secondary)] text-sm font-medium
              transition-colors
              border border-[var(--color-border)]
            `,title:"Return to Workspaces",children:[o.jsx(Dwe,{className:"w-3.5 h-3.5"}),"Pop back in"]}),b?o.jsx("button",{onClick:k,disabled:p.isPending,className:`
                inline-flex items-center gap-1.5
                px-3 py-1.5 rounded-md
                bg-red-600 hover:bg-red-500
                text-white text-sm font-medium
                transition-colors
                disabled:opacity-50
              `,children:p.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}),"Stopping..."]}):o.jsxs(o.Fragment,{children:[o.jsx(uu,{className:"w-3.5 h-3.5"}),"Stop"]})}):o.jsx("button",{onClick:N,disabled:m.isPending,className:`
                inline-flex items-center gap-1.5
                px-3 py-1.5 rounded-md
                bg-green-600 hover:bg-green-500
                text-white text-sm font-medium
                transition-colors
                disabled:opacity-50
              `,children:m.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-3.5 h-3.5"}),"Start"]})})]})]}),o.jsxs("div",{className:"flex-1 min-h-0 relative",children:[r==="terminal"?o.jsx(xB,{agentId:t,onStatusChange:l,interactive:!0,autoFocus:!0,controlsResize:!0}):o.jsx(w0e,{agentId:t,agentName:S,onStatusChange:l}),!b&&o.jsxs("div",{className:`
              absolute inset-0 z-10
              flex flex-col items-center justify-center
              bg-[#1a1a1a]/95 backdrop-blur-sm
            `,children:[o.jsxs("div",{className:"relative mb-6",children:[o.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                relative p-4 rounded-2xl
                bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                border border-[#333]
                shadow-lg
              `,children:o.jsx(na,{className:"w-10 h-10 text-[var(--color-text-muted)]"})})]}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-1",children:"Session Idle"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-muted)] max-w-xs px-4",children:["Start a session to interact with ",S,"."]})]}),o.jsx("button",{onClick:N,disabled:m.isPending,className:`
                inline-flex items-center gap-2.5
                px-6 py-2.5 rounded-lg
                bg-gradient-to-r from-green-600 to-green-500
                hover:from-green-500 hover:to-green-400
                text-white font-medium text-sm
                shadow-lg shadow-green-500/25
                transition-all duration-200
                hover:scale-105 hover:shadow-green-500/40
                disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
              `,children:m.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-4 h-4 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(en,{className:"w-4 h-4"}),"Start Session"]})})]})]})]})}const WL=new Map;function j1({items:e,getItemKey:t,estimateSize:r,renderItem:n,overscan:a=5,className:i="",innerClassName:s="",scrollRestoreId:l,height:c,testId:u,renderEmpty:d,onScroll:f,gap:m=0}){const p=w.useRef(null),v=w.useRef(null),b=typeof r=="function"?r:()=>r,y=lj({count:e.length,getScrollElement:()=>p.current,estimateSize:N=>b(N)+(N<e.length-1?m:0),overscan:a,getItemKey:N=>t(e[N],N)});w.useEffect(()=>{if(l&&p.current){const N=WL.get(l);N!==void 0&&N>0&&requestAnimationFrame(()=>{y.scrollToOffset(N)})}},[l]),w.useEffect(()=>()=>{if(l&&p.current){const N=y.scrollOffset;N!==null&&N>0&&WL.set(l,N)}},[l,y]);const S=w.useCallback(()=>{v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{const N=y.scrollOffset;N!==null&&f&&f(N),l&&N!==null&&N>0&&WL.set(l,N)},100)},[y,f,l]);if(w.useEffect(()=>()=>{v.current&&clearTimeout(v.current)},[]),e.length===0)return o.jsx("div",{ref:p,className:i,style:c?{height:c}:void 0,"data-testid":u,children:d?d():o.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No items"})});const _=y.getVirtualItems();return o.jsx("div",{ref:p,className:`overflow-auto ${i}`,style:c?{height:c}:void 0,"data-testid":u,onScroll:S,tabIndex:0,role:"region","aria-label":"Scrollable list",children:o.jsx("div",{className:s,style:{height:y.getTotalSize(),width:"100%",position:"relative"},"data-testid":u?`${u}-inner`:void 0,children:_.map(N=>{const k=e[N.index];return o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${N.start}px)`},"data-index":N.index,"data-testid":u?`${u}-item-${N.index}`:void 0,children:n(k,N.index,N)},N.key)})})})}const Hdt={today:"Today",yesterday:"Yesterday","this-week":"This Week",earlier:"Earlier"};function qdt(e){const t=typeof e=="string"?new Date(e):e,r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=new Date(n);a.setDate(a.getDate()-1);const i=new Date(n);return i.setDate(i.getDate()-6),t>=n?"today":t>=a?"yesterday":t>=i?"this-week":"earlier"}function Wdt(e,t){const r=[];let n=null;for(const a of e){const i=t(a),s=qdt(i),l=s!==n;r.push({item:a,period:s,isFirstInGroup:l}),n=s}return r}function q0e(e){const t=typeof e=="string"?new Date(e):e,n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"now":a<60?`${a}m`:i<24?`${i}h`:s<7?`${s}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function Kdt(e){const t=typeof e=="string"?new Date(e):e;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function Gdt(e){const t=typeof e=="string"?new Date(e):e,r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=new Date(n);a.setDate(a.getDate()-1);const i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.getTime()===n.getTime()?"Today":i.getTime()===a.getTime()?"Yesterday":t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}function Vdt(e,t){const r=[];let n=null;for(const a of e){const i=t(a),s=Kdt(i),l=s!==n,c=l?Gdt(i):"";r.push({item:a,dateKey:s,formattedDate:c,isFirstInDay:l}),n=s}return r}const W0e="stoneforge-inbox-page-view",K0e="stoneforge-inbox-page-source-filter",G0e="stoneforge-inbox-page-sort-order";function Ydt(){const e=localStorage.getItem(W0e);return e==="unread"||e==="all"||e==="archived"?e:"unread"}function Qdt(e){localStorage.setItem(W0e,e)}function Jdt(){const e=localStorage.getItem(K0e);return e==="all"||e==="direct"||e==="mention"?e:"all"}function Zdt(e){localStorage.setItem(K0e,e)}function Xdt(){const e=localStorage.getItem(G0e);return e==="newest"||e==="oldest"||e==="sender"?e:"newest"}function eft(e){localStorage.setItem(G0e,e)}function tft(e="all",t){return gt({queryKey:["inbox",t,e],queryFn:async()=>{const r=new URLSearchParams({limit:"100",hydrate:"true"});e==="unread"?r.set("status","unread"):e==="archived"?r.set("status","archived"):r.set("status","unread,read"),t&&r.set("entityId",t);const n=await fetch(`/api/inbox/all?${r}`);if(!n.ok)throw new Error("Failed to fetch inbox");return n.json()},enabled:!!t,staleTime:0,refetchOnWindowFocus:"always"})}function rft(e){return gt({queryKey:["inbox",e,"count"],queryFn:async()=>{const t=new URLSearchParams;e&&t.set("entityId",e);const r=await fetch(`/api/inbox/count?${t}`);if(!r.ok)throw new Error("Failed to fetch inbox count");return r.json()},enabled:!!e,staleTime:0,refetchOnWindowFocus:"always"})}function nft(){const e=ht();return Ct({mutationFn:async({itemId:t,status:r})=>{const n=await fetch(`/api/inbox/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:r})});if(!n.ok)throw new Error("Failed to update inbox item");return n.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["inbox"]})}})}function aft(){const e=ht();return Ct({mutationFn:async({channelId:t,sender:r,content:n,threadId:a})=>{const i=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelId:t,sender:r,content:n,threadId:a})});if(!i.ok){const l=(await i.json().catch(()=>({})))?.error?.message||"Failed to send message";throw new Error(l)}return i.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["messages"]}),e.invalidateQueries({queryKey:["inbox"]}),r.threadId&&e.invalidateQueries({queryKey:["messages",r.threadId,"replies"]})}})}function ift(e){return gt({queryKey:["messages",e,"replies"],queryFn:async()=>{if(!e)return[];const t=await fetch(`/api/messages/${e}/replies?hydrate.content=true`);if(!t.ok)throw new Error("Failed to fetch thread replies");const r=await t.json();return await Promise.all(r.map(async a=>{try{const i=await fetch(`/api/entities/${a.sender}`);if(i.ok){const s=await i.json();return{...a,_senderEntity:s}}}catch{}return a}))},enabled:!!e,staleTime:1e4})}function sft({period:e}){return o.jsxs("div",{className:"sticky top-0 z-10 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center gap-2","data-testid":`inbox-page-time-period-${e}`,children:[o.jsx(r0,{className:"w-3 h-3 text-gray-500"}),o.jsx("span",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:Hdt[e]})]})}function oft({item:e,isSelected:t,onSelect:r,formattedTime:n}){const a=e.status==="unread",i=n??q0e(e.createdAt),s=e.sender?.name??"Unknown",l=e.sender?.entityType??"agent",u=(e.message?.contentPreview??"").split(`
`)[0]?.slice(0,50)||"",d=e.threadParent!==null&&e.threadParent!==void 0,f=e.threadParent?.sender?.name??"Unknown",m=()=>{switch(l){case"agent":return o.jsx(Xr,{className:"w-3 h-3"});case"human":return o.jsx(Zr,{className:"w-3 h-3"});case"system":return o.jsx(Od,{className:"w-3 h-3"});default:return o.jsx(Zr,{className:"w-3 h-3"})}},p=()=>{switch(l){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}};return o.jsxs("button",{onClick:r,className:`w-full text-left px-3 py-2 flex items-start gap-2 transition-colors border-b border-gray-100 dark:border-gray-800 ${t?"bg-blue-50 dark:bg-blue-900/30 border-l-2 border-l-blue-500":a?"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800":"bg-gray-50/50 dark:bg-gray-900/50 hover:bg-gray-100/50 dark:hover:bg-gray-800/50"}`,"data-testid":`inbox-page-list-item-${e.id}`,children:[o.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${p()}`,children:m()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("span",{className:`text-sm truncate ${a?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"}`,children:s}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500","data-testid":`inbox-page-list-item-time-${e.id}`,children:i}),a&&o.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500","data-testid":`inbox-page-list-item-unread-${e.id}`})]})]}),d&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-0.5","data-testid":`inbox-page-list-item-thread-${e.id}`,children:[o.jsx(Xae,{className:"w-3 h-3"}),o.jsxs("span",{children:["Reply to ",f]})]}),e.recipient&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[o.jsx("span",{children:"To:"}),o.jsx("span",{className:"font-medium",children:e.recipient.name})]}),u&&o.jsx("p",{className:`text-xs truncate ${a?"text-gray-600 dark:text-gray-400":"text-gray-500 dark:text-gray-500"}`,children:u})]})]})}function lft({item:e,onMarkRead:t,onMarkUnread:r,onArchive:n,onRestore:a,isPending:i,onNavigateToMessage:s,onNavigateToEntity:l,onReply:c,threadReplies:u,threadRepliesLoading:d,currentUserId:f}){const m=e.status==="unread",p=e.status==="archived",v=L=>new Date(L).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),b=L=>new Date(L).toLocaleString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit"}),y=L=>{const A=new Date(L),z=new Date().getTime()-A.getTime(),I=Math.floor(z/6e4),B=Math.floor(z/36e5),F=Math.floor(z/864e5);return I<1?"just now":I<60?`${I} minute${I===1?"":"s"} ago`:B<24?`${B} hour${B===1?"":"s"} ago`:F<7?`${F} day${F===1?"":"s"} ago`:""},S=e.sender?.name??"Unknown",_=e.sender?.entityType??"agent",N=e.sender?.id??e.message?.sender,k=e.channel?.name??e.channelId,j=e.message?.fullContent??e.message?.contentPreview??"",E=e.message?.contentType??"text",T=L=>{switch(L??_){case"agent":return o.jsx(Xr,{className:"w-5 h-5"});case"human":return o.jsx(Zr,{className:"w-5 h-5"});case"system":return o.jsx(Od,{className:"w-5 h-5"});default:return o.jsx(Zr,{className:"w-5 h-5"})}},O=L=>{switch(L??_){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},R=y(e.createdAt),q=e.attachments&&e.attachments.length>0,$=e.threadParent!==null&&e.threadParent!==void 0;return o.jsxs("div",{className:"flex flex-col","data-testid":`inbox-page-message-content-${e.id}`,children:[o.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:()=>N&&l(N),className:`w-10 h-10 rounded-full flex items-center justify-center ${O()} hover:ring-2 hover:ring-blue-300 transition-all`,"data-testid":`inbox-page-content-avatar-${e.id}`,children:T()}),o.jsxs("div",{children:[o.jsx("button",{onClick:()=>N&&l(N),className:"text-sm font-medium text-gray-900 dark:text-gray-100 hover:text-blue-600 hover:underline","data-testid":`inbox-page-content-sender-${e.id}`,children:S}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("button",{onClick:s,className:"hover:text-blue-600 hover:underline","data-testid":`inbox-page-content-channel-${e.id}`,children:["#",k]}),o.jsx("span",{children:"*"}),o.jsx("span",{className:`inline-flex items-center gap-0.5 px-1.5 py-0.5 text-xs font-medium rounded ${e.sourceType==="mention"?"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300":"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300"}`,children:e.sourceType==="mention"?o.jsxs(o.Fragment,{children:[o.jsx(R6,{className:"w-3 h-3"}),"Mention"]}):o.jsxs(o.Fragment,{children:[o.jsx(ss,{className:"w-3 h-3"}),"Direct"]})})]})]})]}),o.jsx("div",{className:"flex items-center gap-1",children:i?o.jsx($e,{className:"w-4 h-4 animate-spin text-gray-400"}):o.jsxs(o.Fragment,{children:[!p&&c&&o.jsx("button",{onClick:c,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Reply","data-testid":`inbox-page-content-reply-${e.id}`,children:o.jsx(MO,{className:"w-4 h-4"})}),p?o.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/30 rounded transition-colors",title:"Restore","data-testid":`inbox-page-content-restore-${e.id}`,children:o.jsx(jr,{className:"w-4 h-4"})}):o.jsxs(o.Fragment,{children:[m?o.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Mark as read","data-testid":`inbox-page-content-mark-read-${e.id}`,children:o.jsx(YC,{className:"w-4 h-4"})}):o.jsx("button",{onClick:r,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Mark as unread","data-testid":`inbox-page-content-mark-unread-${e.id}`,children:o.jsx(VC,{className:"w-4 h-4"})}),o.jsx("button",{onClick:n,className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/30 rounded transition-colors",title:"Archive","data-testid":`inbox-page-content-archive-${e.id}`,children:o.jsx(I6,{className:"w-4 h-4"})})]})]})})]}),o.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 cursor-help",title:b(e.createdAt),"data-testid":`inbox-page-content-time-${e.id}`,children:[v(e.createdAt),R&&o.jsxs("span",{className:"ml-1",children:["(",R,")"]})]})]}),o.jsxs("div",{className:"flex-1",children:[$&&e.threadParent&&o.jsxs("div",{className:"mx-4 mt-4 p-3 bg-gray-50 dark:bg-gray-800 border-l-4 border-gray-300 dark:border-gray-600 rounded-r","data-testid":`inbox-page-content-thread-context-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-1",children:[o.jsx(Xae,{className:"w-3 h-3"}),o.jsx("span",{children:"Reply to"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("button",{onClick:()=>e.threadParent?.sender?.id&&l(e.threadParent.sender.id),className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${O(e.threadParent.sender?.entityType)} hover:ring-2 hover:ring-blue-300 transition-all`,children:T(e.threadParent.sender?.entityType)}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("button",{onClick:()=>e.threadParent?.sender?.id&&l(e.threadParent.sender.id),className:"text-xs font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 hover:underline",children:e.threadParent.sender?.name??"Unknown"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-0.5",children:e.threadParent.contentPreview||"No content"})]})]})]}),o.jsx("div",{className:"p-4",children:o.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 whitespace-pre-wrap","data-testid":`inbox-page-content-body-${e.id}`,children:j||o.jsx("span",{className:"text-gray-400 italic",children:"No content"})})}),q&&o.jsxs("div",{className:"px-4 pb-4","data-testid":`inbox-page-content-attachments-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-2",children:[o.jsx(HC,{className:"w-3 h-3"}),o.jsxs("span",{children:[e.attachments.length," attachment",e.attachments.length!==1?"s":""]})]}),o.jsx("div",{className:"space-y-2",children:e.attachments.map(L=>o.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","data-testid":`inbox-page-content-attachment-${L.id}`,children:[o.jsx("div",{className:"flex items-start justify-between",children:o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx(rn,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate",children:L.title}),o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-xs font-medium bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:L.contentType??"text"})]})]})}),L.content&&o.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 line-clamp-3 whitespace-pre-wrap",children:[L.content.substring(0,200),L.content.length>200&&"..."]})]},L.id))})]}),u&&u.length>0&&o.jsxs("div",{className:"px-4 pb-4 border-t border-gray-200 dark:border-gray-700 mt-4 pt-4","data-testid":`inbox-page-content-thread-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-3",children:[o.jsx(ss,{className:"w-3 h-3"}),o.jsxs("span",{className:"font-medium",children:[u.length," ",u.length===1?"reply":"replies"," in thread"]})]}),o.jsx("div",{className:"space-y-3",children:u.map(L=>{const A=L.sender===f,M=L._senderEntity,z=M?.name??"Unknown",I=M?.entityType??"agent",B=()=>{switch(I){case"agent":return o.jsx(Xr,{className:"w-3 h-3"});case"human":return o.jsx(Zr,{className:"w-3 h-3"});case"system":return o.jsx(Od,{className:"w-3 h-3"});default:return o.jsx(Zr,{className:"w-3 h-3"})}},F=()=>{if(A)return"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400";switch(I){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},U=V=>{const K=new Date(V),J=new Date().getTime()-K.getTime(),ee=Math.floor(J/6e4),Y=Math.floor(J/36e5);return ee<1?"just now":ee<60?`${ee}m ago`:Y<24?`${Y}h ago`:K.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return o.jsxs("div",{className:`flex gap-2 p-3 rounded-lg ${A?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700"}`,"data-testid":`inbox-page-thread-reply-${L.id}`,children:[o.jsx("button",{onClick:()=>L.sender&&l(L.sender),className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${F()} hover:ring-2 hover:ring-blue-300 transition-all`,children:B()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>L.sender&&l(L.sender),className:`text-xs font-medium hover:text-blue-600 hover:underline ${A?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:z}),A&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-green-200 dark:bg-green-800 text-green-700 dark:text-green-300 rounded font-medium",children:"You"})]}),o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:U(L.createdAt)})]}),o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:L._content??""})]})]},L.id)})})]}),d&&o.jsx("div",{className:"px-4 pb-4 border-t border-gray-200 dark:border-gray-700 mt-4 pt-4",children:o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[o.jsx($e,{className:"w-3 h-3 animate-spin"}),o.jsx("span",{children:"Loading thread..."})]})})]}),o.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:o.jsxs("button",{onClick:s,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline flex items-center gap-1","data-testid":`inbox-page-content-view-in-channel-${e.id}`,children:["View in channel",o.jsx(gn,{className:"w-4 h-4"})]})})]})}function cft(){return o.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500","data-testid":"inbox-page-content-empty",children:[o.jsx(rs,{className:"w-12 h-12 mb-3"}),o.jsx("p",{className:"text-sm font-medium",children:"Select a message"}),o.jsx("p",{className:"text-xs mt-1",children:"Choose a message from the list to view its content"}),o.jsx("p",{className:"text-xs mt-3 text-gray-300 dark:text-gray-600",children:"Tip: Use J/K keys to navigate"})]})}function uft(){const e=Ma(),t=rl({strict:!1}),{currentUser:r,isLoading:n}=nl(),a=ht(),i=w.useRef(null),[s,l]=w.useState(()=>Ydt()),[c,u]=w.useState(()=>Jdt()),[d,f]=w.useState(()=>Xdt()),[m,p]=w.useState(t.message||null),[v,b]=w.useState(null),[y,S]=w.useState(0),[_,N]=w.useState(""),[k,j]=w.useState(!1),E=w.useCallback(Z=>{if(Z.elementType==="inbox-item"&&Z.eventType==="created"&&Z.newValue?.recipientId===r?.id){const ge=Z.newValue?.sourceType==="mention"?"You were mentioned in a message":"You have a new direct message";Kr.info(ge,{description:"Click to view in inbox",action:{label:"View",onClick:()=>{p(null)}}})}},[r?.id]);v2({channels:r?.id?[`inbox:${r.id}`,"inbox","messages"]:["inbox","messages"],onEvent:E}),w.useEffect(()=>{r?.id&&i.current!==r.id&&(p(null),j(!1),N(""),a.invalidateQueries({queryKey:["inbox",r.id]}),i.current=r.id)},[r?.id,a]),w.useEffect(()=>{const Z=setInterval(()=>{S(ue=>ue+1)},6e4);return()=>clearInterval(Z)},[]);const{data:T,isLoading:O,isError:R,refetch:q}=tft(s,r?.id??null),{data:$}=rft(r?.id??null),L=nft(),A=aft(),M=w.useMemo(()=>!m||!T?.items?null:T.items.find(ue=>ue.id===m)?.messageId??null,[m,T?.items]),{data:z,isLoading:I}=ift(M),B=w.useMemo(()=>{if(!T?.items)return[];let Z=[...T.items];return c==="direct"?Z=Z.filter(ue=>ue.sourceType==="direct"):c==="mention"&&(Z=Z.filter(ue=>ue.sourceType==="mention")),d==="newest"?Z.sort((ue,H)=>new Date(H.createdAt).getTime()-new Date(ue.createdAt).getTime()):d==="oldest"?Z.sort((ue,H)=>new Date(ue.createdAt).getTime()-new Date(H.createdAt).getTime()):d==="sender"&&Z.sort((ue,H)=>(ue.sender?.name??"").localeCompare(H.sender?.name??"")),Z},[T,c,d]),F=w.useMemo(()=>Wdt(B,Z=>new Date(Z.createdAt)),[B]),U=w.useMemo(()=>B.find(Z=>Z.id===m)||null,[B,m]),V=w.useCallback(Z=>{l(Z),Qdt(Z),p(null)},[]),K=w.useCallback(Z=>{u(Z),Zdt(Z)},[]),G=w.useCallback(Z=>{f(Z),eft(Z)},[]),J=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"read"},{onSettled:()=>b(null)})},[L]),ee=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"unread"},{onSettled:()=>b(null)})},[L]),Y=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"archived"},{onSuccess:()=>{const ue=B.findIndex(ge=>ge.id===Z),H=B[ue+1]||B[ue-1];p(H?.id||null)},onSettled:()=>b(null)})},[L,B]),ie=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"read"},{onSettled:()=>b(null)})},[L]),fe=w.useCallback((Z,ue)=>{console.log(`Navigate to channel: ${Z}`)},[]),me=w.useCallback(Z=>{e({to:"/agents",search:{selected:Z,tab:"agents",role:void 0}})},[e]),te=w.useCallback(Z=>{const ue=B.findIndex(ge=>ge.id===m);let H=ue;Z==="next"?H=ue<B.length-1?ue+1:ue:H=ue>0?ue-1:0,H!==ue&&B[H]&&p(B[H].id)},[B,m]);w.useEffect(()=>{const Z=ue=>{ue.target instanceof HTMLInputElement||ue.target instanceof HTMLTextAreaElement||(ue.key==="j"||ue.key==="J"?te("next"):(ue.key==="k"||ue.key==="K")&&te("prev"))};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[te]);const oe=jo(),ce=w.useCallback(async()=>{if(!(!_.trim()||!U||!r))try{await A.mutateAsync({channelId:U.channelId,sender:r.id,content:_.trim(),threadId:U.messageId}),N(""),j(!1)}catch(Z){console.error("Failed to send reply:",Z)}},[_,U,r,A]);return!n&&!r?o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-bg)]","data-testid":"inbox-page",children:[o.jsx(FP,{title:"Inbox",icon:rs,iconColor:"text-blue-500",subtitle:"No user selected",bordered:!0,testId:"inbox-header"}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[o.jsx(Zr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{className:"text-lg font-medium",children:"No user selected"}),o.jsx("p",{className:"text-sm mt-1",children:"Select a user from the header dropdown to view their inbox"})]})})]}):o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-bg)]","data-testid":"inbox-page",children:[o.jsx(FP,{title:r?`${r.name}'s Inbox`:"Inbox",icon:rs,iconColor:"text-blue-500",subtitle:$?.count!==void 0&&$.count>0?`${$.count} unread`:"No unread messages",bordered:!0,testId:"inbox-header",children:o.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1 w-fit",children:[o.jsxs("button",{onClick:()=>V("unread"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${s==="unread"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,"data-testid":"inbox-page-tab-unread",children:["Unread",$?.count!==void 0&&$.count>0&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full",children:$.count})]}),o.jsx("button",{onClick:()=>V("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${s==="all"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,"data-testid":"inbox-page-tab-all",children:"All"}),o.jsx("button",{onClick:()=>V("archived"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${s==="archived"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,"data-testid":"inbox-page-tab-archived",children:"Archived"})]})}),o.jsxs("div",{className:`flex items-center justify-between ${oe?"px-3":"px-6"} py-2 border-b border-[var(--color-border)] bg-gray-50 dark:bg-gray-900/50`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ru,{className:"w-4 h-4 text-gray-400"}),o.jsxs("select",{value:c,onChange:Z=>K(Z.target.value),className:"text-sm bg-transparent border-none text-gray-600 dark:text-gray-400 cursor-pointer focus:outline-none","data-testid":"inbox-page-source-filter",children:[o.jsx("option",{value:"all",children:"All sources"}),o.jsx("option",{value:"direct",children:"Direct messages"}),o.jsx("option",{value:"mention",children:"Mentions"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(e0,{className:"w-4 h-4 text-gray-400"}),o.jsxs("select",{value:d,onChange:Z=>G(Z.target.value),className:"text-sm bg-transparent border-none text-gray-600 dark:text-gray-400 cursor-pointer focus:outline-none","data-testid":"inbox-page-sort-order",children:[o.jsx("option",{value:"newest",children:"Newest first"}),o.jsx("option",{value:"oldest",children:"Oldest first"}),o.jsx("option",{value:"sender",children:"By sender"})]})]})]}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"w-2/5 border-r border-[var(--color-border)] overflow-hidden flex flex-col bg-white dark:bg-gray-900","data-testid":"inbox-page-message-list",children:[O?o.jsxs("div",{className:"flex items-center justify-center p-8",children:[o.jsx($e,{className:"w-6 h-6 animate-spin text-gray-400"}),o.jsx("span",{className:"ml-2 text-gray-500",children:"Loading inbox..."})]}):R?o.jsxs("div",{className:"text-center py-8 px-4","data-testid":"inbox-page-error",children:[o.jsx(Bt,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Failed to load inbox"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-3",children:"There was an error loading your messages"}),o.jsxs("button",{onClick:()=>q(),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors","data-testid":"inbox-page-retry",children:[o.jsx(jr,{className:"w-3 h-3"}),"Retry"]})]}):!T||T.items.length===0?o.jsxs("div",{className:"text-center py-8 px-4","data-testid":"inbox-page-empty",children:[o.jsx(rs,{className:"w-10 h-10 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s==="unread"?"No unread messages":s==="archived"?"No archived messages":"Your inbox is empty"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 max-w-xs mx-auto",children:s==="archived"?"Archived messages will appear here":"Direct messages and @mentions will appear here when other entities message you"}),s==="unread"&&o.jsx("button",{onClick:()=>V("all"),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View all messages"})]}):B.length===0?o.jsxs("div",{className:"text-center py-8 px-4","data-testid":"inbox-page-filtered-empty",children:[o.jsx(ru,{className:"w-8 h-8 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No messages match your filters"}),o.jsx("button",{onClick:()=>K("all"),className:"mt-2 text-xs font-medium text-blue-600 hover:text-blue-700",children:"Clear filters"})]}):o.jsx(j1,{items:F,getItemKey:Z=>Z.item.id,estimateSize:Z=>F[Z]?.isFirstInGroup&&d!=="sender"?100:72,height:"100%",testId:"inbox-page-items-list",renderItem:Z=>o.jsxs(o.Fragment,{children:[Z.isFirstInGroup&&d!=="sender"&&o.jsx(sft,{period:Z.period}),o.jsx(oft,{item:Z.item,isSelected:m===Z.item.id,onSelect:()=>p(Z.item.id),formattedTime:q0e(Z.item.createdAt)},`${Z.item.id}-${y}`)]})}),T&&T.items.length>0&&o.jsx("div",{className:"text-center text-xs text-gray-500 dark:text-gray-400 py-2 border-t border-gray-100 dark:border-gray-800",children:c!=="all"?o.jsxs(o.Fragment,{children:["Showing ",B.length," of ",T.items.length," (filtered)"]}):T.hasMore?o.jsxs(o.Fragment,{children:["Showing ",T.items.length," of ",T.total," items"]}):o.jsxs(o.Fragment,{children:[T.items.length," ",T.items.length===1?"item":"items"]})})]}),o.jsx("div",{className:"flex-1 overflow-hidden bg-white dark:bg-gray-900 flex flex-col","data-testid":"inbox-page-message-content-panel",children:U?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsx(lft,{item:U,onMarkRead:()=>J(U.id),onMarkUnread:()=>ee(U.id),onArchive:()=>Y(U.id),onRestore:()=>ie(U.id),isPending:v===U.id,onNavigateToMessage:()=>fe(U.channelId,U.messageId),onNavigateToEntity:me,onReply:()=>j(!k),threadReplies:z,threadRepliesLoading:I,currentUserId:r?.id})}),k&&U.status!=="archived"&&o.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-800","data-testid":"inbox-reply-composer",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs text-gray-500 dark:text-gray-400",children:[o.jsx(MO,{className:"w-3 h-3"}),o.jsxs("span",{children:["Replying as ",o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:r?.name})," to ",U.sender?.name??"Unknown"]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("textarea",{value:_,onChange:Z=>N(Z.target.value),placeholder:"Write your reply...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3,"data-testid":"inbox-reply-textarea",onKeyDown:Z=>{Z.key==="Enter"&&(Z.metaKey||Z.ctrlKey)&&ce()}}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("button",{onClick:ce,disabled:!_.trim()||A.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","data-testid":"inbox-reply-send",children:[A.isPending?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(MO,{className:"w-4 h-4"}),"Send"]}),o.jsx("button",{onClick:()=>{j(!1),N("")},className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 rounded-lg transition-colors","data-testid":"inbox-reply-cancel",children:"Cancel"})]})]}),A.isError&&o.jsx("p",{className:"mt-2 text-xs text-red-500","data-testid":"inbox-reply-error",children:A.error instanceof Error?A.error.message:"Failed to send reply. Please try again."}),o.jsxs("p",{className:"mt-2 text-xs text-gray-400",children:["Press ",navigator.platform.includes("Mac")?"Cmd":"Ctrl","+Enter to send"]})]})]}):o.jsx(cft,{})})]})]})}function dft({channel:e}){return e.channelType==="direct"?o.jsx(Ii,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}):e.permissions.visibility==="private"?o.jsx(qC,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}):o.jsx(qp,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})}function fft({channel:e,isSelected:t,onClick:r,isMobile:n=!1}){return o.jsxs("button",{"data-testid":`channel-item-${e.id}`,onClick:r,className:`w-full flex items-center gap-2 sm:gap-2 rounded-md text-left transition-colors touch-target ${n?"px-4 py-3 gap-3":"px-3 py-2"} ${t?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx(dft,{channel:e}),o.jsx("span",{className:`truncate font-medium ${n?"text-base":"text-sm"}`,children:e.name}),o.jsx("span",{className:`ml-auto text-gray-400 ${n?"text-sm":"text-xs"}`,children:e.members.length})]})}const hft=36,mft=48,pft=28;function Ete({channels:e,selectedChannelId:t,onSelectChannel:r,onNewChannel:n,totalChannels:a,searchQuery:i,onSearchChange:s,isMobile:l=!1}){const c=e.filter(v=>v.channelType==="group"),u=e.filter(v=>v.channelType==="direct"),d=[];c.length>0&&(d.push({type:"header",label:"Channels",key:"header-group"}),c.forEach(v=>{d.push({type:"channel",channel:v,key:v.id})})),u.length>0&&(d.push({type:"header",label:"Direct Messages",key:"header-direct"}),u.forEach(v=>{d.push({type:"channel",channel:v,key:v.id})}));const f=l?mft:hft,m=v=>d[v].type==="header"?pft:f,p=v=>v.type==="header"?o.jsx("div",{"data-testid":v.key==="header-group"?"channel-group-label":"channel-direct-label",className:`px-3 py-1 font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider ${l?"text-sm":"text-xs"}`,children:v.label}):o.jsx(fft,{channel:v.channel,isSelected:t===v.channel.id,onClick:()=>r(v.channel.id),isMobile:l});return o.jsxs("div",{"data-testid":"channel-list",className:`flex flex-col h-full bg-white dark:bg-[var(--color-bg)] ${l?"w-full":"w-64 border-r border-[var(--color-border)]"}`,children:[o.jsxs("div",{className:`border-b border-[var(--color-border)] ${l?"p-4 pt-2":"p-4"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h2",{className:`font-semibold text-[var(--color-text)] ${l?"text-xl":"text-lg"} flex items-center gap-2`,children:[o.jsx(ss,{className:`${l?"w-4 h-4":"w-5 h-5"} text-blue-500`}),"Channels"]}),o.jsx("button",{onClick:n,className:`text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors ${l?"p-2 touch-target":"p-1.5"}`,title:"New Channel","data-testid":"new-channel-button-sidebar",children:o.jsx(_r,{className:l?"w-6 h-6":"w-5 h-5"})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:`absolute top-1/2 -translate-y-1/2 text-gray-400 ${l?"left-3 w-5 h-5":"left-2.5 w-4 h-4"}`}),o.jsx("input",{type:"text",value:i,onChange:v=>s(v.target.value),placeholder:l?"Search...":"Search channels...",className:`w-full border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-[var(--color-surface)] text-[var(--color-text)] ${l?"pl-10 pr-4 py-2.5 text-base":"pl-8 pr-3 py-1.5 text-sm"}`,"data-testid":"channels-search-input"})]})]}),o.jsx("div",{className:"flex-1 min-h-0",children:e.length===0?o.jsxs("div",{"data-testid":"channel-empty-state",className:`text-center text-gray-500 dark:text-gray-400 ${l?"py-12":"py-8"}`,children:[o.jsx(ss,{className:`mx-auto mb-3 text-gray-300 dark:text-gray-600 ${l?"w-16 h-16":"w-12 h-12"}`}),o.jsx("p",{className:l?"text-base":"text-sm",children:i?"No channels match your search":"No channels yet"}),!i&&o.jsx("button",{onClick:n,className:`mt-3 text-blue-600 hover:text-blue-700 hover:underline ${l?"text-base py-2 px-4":"text-sm"}`,"data-testid":"new-channel-button-empty",children:"Create one"})]}):o.jsx(j1,{items:d,getItemKey:v=>v.key,estimateSize:m,renderItem:p,overscan:10,className:"h-full p-2",scrollRestoreId:"channel-list",testId:"channel-list-virtualized"})}),!l&&o.jsxs("div",{"data-testid":"channel-count",className:"p-3 border-t border-gray-200 dark:border-[var(--color-border)] text-xs text-gray-500 dark:text-gray-400",children:[a," ",a===1?"channel":"channels"]})]})}function gft({isMobile:e=!1}){return o.jsx("div",{"data-testid":"channel-placeholder",className:`flex-1 flex items-center justify-center bg-[var(--color-surface)] ${e?"hidden":""}`,children:o.jsxs("div",{className:"text-center px-4",children:[o.jsx(ss,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-1",children:"Select a channel"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose a channel from the sidebar to view messages"})]})})}const vft=100;function V0e({items:e,getItemKey:t,estimateSize:r,renderItem:n,overscan:a=5,className:i="",innerClassName:s="",scrollRestoreId:l,testId:c,renderEmpty:u,gap:d=8,onScrollToTop:f,isLoadingMore:m=!1,hasMore:p=!1,loadMoreThreshold:v=100,latestMessageId:b,onNewMessageWhileScrolledUp:y}){const S=w.useRef(null),[_,N]=w.useState(!0),[k,j]=w.useState(!1),E=w.useRef(b),T=w.useRef(!0),O=w.useRef(null),R=typeof r=="function"?r:()=>r,q=lj({count:e.length,getScrollElement:()=>S.current,estimateSize:I=>R(I)+(I<e.length-1?d:0),overscan:a,getItemKey:I=>t(e[I],I),measureElement:I=>I.getBoundingClientRect().height}),$=w.useCallback(()=>{if(!S.current)return!1;const{scrollTop:I,scrollHeight:B,clientHeight:F}=S.current;return B-I-F<vft},[]),L=w.useCallback(()=>S.current?S.current.scrollTop<v:!1,[v]),A=w.useCallback((I="smooth")=>{S.current&&(S.current.scrollTo({top:S.current.scrollHeight,behavior:I}),N(!0),j(!1))},[]),M=w.useCallback(()=>{O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{const I=$(),B=L();N(I),j(!I&&e.length>0),B&&p&&!m&&f&&f()},50)},[$,L,p,m,f,e.length]);if(w.useEffect(()=>()=>{O.current&&clearTimeout(O.current)},[]),w.useEffect(()=>{T.current&&e.length>0&&requestAnimationFrame(()=>{A("instant"),T.current=!1})},[e.length,A]),w.useEffect(()=>{if(T.current){E.current=b;return}b!==E.current&&(E.current=b,_?requestAnimationFrame(()=>{A("smooth")}):(j(!0),y&&y()))},[b,_,A,y]),e.length===0&&!m)return o.jsx("div",{ref:S,className:`h-full ${i}`,"data-testid":c,children:u?u():o.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No messages"})});const z=q.getVirtualItems();return o.jsxs("div",{className:"relative h-full",children:[m&&o.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 flex justify-center py-2 bg-gradient-to-b from-white to-transparent","data-testid":`${c}-loading-more`,children:o.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Loading older messages..."]})}),o.jsx("div",{ref:S,className:`overflow-auto h-full ${i}`,"data-testid":c,onScroll:M,tabIndex:0,role:"log","aria-live":"polite","aria-label":"Messages",children:o.jsx("div",{className:s,style:{height:q.getTotalSize(),width:"100%",position:"relative"},"data-testid":c?`${c}-inner`:void 0,children:z.map(I=>{const B=e[I.index];return o.jsx("div",{ref:q.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${I.start}px)`},"data-index":I.index,"data-testid":c?`${c}-item-${I.index}`:void 0,children:n(B,I.index,I)},I.key)})})}),k&&o.jsxs("button",{onClick:()=>A("smooth"),className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-20 flex items-center gap-1.5 px-4 py-2 bg-blue-500 text-white text-sm font-medium rounded-full shadow-lg hover:bg-blue-600 transition-all hover:shadow-xl","data-testid":`${c}-jump-to-latest`,"aria-label":"Jump to latest messages",children:[o.jsx(cr,{className:"w-4 h-4"}),"Jump to latest"]})]})}function bft({date:e,isSticky:t=!1}){return o.jsxs("div",{"data-testid":`date-separator-${e.replace(/\s/g,"-").toLowerCase()}`,className:`flex items-center gap-3 py-3 ${t?"sticky top-0 bg-white z-10 -mx-4 px-4 shadow-sm":""}`,children:[o.jsx("div",{className:"flex-1 h-px bg-gray-200"}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full",children:[o.jsx(r0,{className:"w-3 h-3 text-gray-500"}),o.jsx("span",{"data-testid":"date-separator-label",className:"text-xs font-medium text-gray-600",children:e})]}),o.jsx("div",{className:"flex-1 h-px bg-gray-200"})]})}function t5({message:e,onReply:t,replyCount:r=0,isThreaded:n=!1,isHighlighted:a=!1,isMobile:i=!1}){const[s,l]=w.useState(!1),[c,u]=w.useState(!1),d=w.useRef(null),f=w.useRef(null),{data:m}=AB(),v=m?.find(T=>T.id===e.sender)?.name,b=v?v.split(/\s+/).map(T=>T[0]).slice(0,2).join("").toUpperCase():e.sender.slice(-2).toUpperCase(),y=new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),S=async()=>{const T=e._content||"";try{await navigator.clipboard.writeText(T),l(!0),Kr.success("Message copied"),setTimeout(()=>l(!1),2e3),u(!1)}catch{Kr.error("Failed to copy message")}},_=T=>{T.key==="c"&&!T.ctrlKey&&!T.metaKey&&!T.altKey&&(T.preventDefault(),S())},N=()=>{i&&u(!0)},k=()=>{i&&(f.current=setTimeout(N,500))},j=()=>{f.current&&(clearTimeout(f.current),f.current=null)},E=()=>{f.current&&(clearTimeout(f.current),f.current=null)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{ref:d,"data-testid":`message-${e.id}`,className:`flex rounded-lg group relative focus:bg-blue-50 dark:focus:bg-blue-900/20 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 focus:outline-none transition-colors duration-300 ${i?"gap-2 p-2":"gap-3 p-3"} ${a?"bg-yellow-100 dark:bg-yellow-900/30 ring-2 ring-yellow-300 dark:ring-yellow-600":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,tabIndex:0,onKeyDown:_,onTouchStart:k,onTouchEnd:j,onTouchMove:E,children:[o.jsx("div",{"data-testid":`message-avatar-${e.id}`,className:`rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center flex-shrink-0 ${i?"w-8 h-8":"w-10 h-10"}`,children:o.jsx("span",{className:`text-blue-600 dark:text-blue-400 font-medium ${i?"text-xs":"text-sm"}`,children:b})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:`flex items-baseline ${i?"gap-1.5":"gap-2"}`,children:[o.jsx(zie,{entityRef:e.sender,className:`font-semibold ${i?"text-sm":""}`,"data-testid":`message-sender-${e.id}`,children:v}),o.jsx("span",{"data-testid":`message-time-${e.id}`,className:`text-gray-400 dark:text-gray-500 ${i?"text-[10px]":"text-xs"}`,children:y})]}),o.jsx("div",{"data-testid":`message-content-${e.id}`,className:`text-[var(--color-text-secondary)] mt-1 break-words overflow-hidden whitespace-pre-wrap ${i?"text-sm":""}`,children:e._content?ume(e._content):o.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:"Content not loaded"})}),e._attachments&&e._attachments.length>0&&o.jsx("div",{className:"mt-2 space-y-1","data-testid":`message-attachments-${e.id}`,children:e._attachments.map(T=>o.jsxs("a",{href:`/documents?selected=${T.id}`,className:`flex items-center gap-2 bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] rounded-lg border border-[var(--color-border)] transition-colors ${i?"px-2 py-1.5":"px-3 py-2"}`,"data-testid":`message-attachment-${T.id}`,children:[o.jsx(rn,{className:`text-gray-400 flex-shrink-0 ${i?"w-3 h-3":"w-4 h-4"}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:`font-medium text-blue-600 dark:text-blue-400 truncate ${i?"text-xs":"text-sm"}`,children:T.title||"Untitled Document"}),o.jsx("div",{className:i?"text-[10px]":"text-xs",children:o.jsx("span",{className:"px-1 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded text-[10px]",children:T.contentType})})]})]},T.id))}),o.jsxs("div",{className:`flex items-center gap-2 ${i?"mt-1.5":"mt-2"}`,children:[e.threadId&&!n&&o.jsx("div",{"data-testid":`message-thread-indicator-${e.id}`,className:`text-blue-500 ${i?"text-[10px]":"text-xs"}`,children:"Reply in thread"}),!n&&r>0&&o.jsxs("button",{"data-testid":`message-replies-${e.id}`,onClick:()=>t?.(e),className:`flex items-center gap-1 text-blue-600 hover:text-blue-700 ${i?"text-[10px]":"text-xs"}`,children:[o.jsx(hk,{className:i?"w-2.5 h-2.5":"w-3 h-3"}),o.jsxs("span",{children:[r," ",r===1?"reply":"replies"]})]}),!n&&!e.threadId&&t&&!i&&o.jsxs("button",{"data-testid":`message-reply-button-${e.id}`,onClick:()=>t(e),className:"flex items-center gap-1 text-xs text-gray-400 hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx(hk,{className:"w-3 h-3"}),o.jsx("span",{children:"Reply"})]})]})]}),!i&&o.jsxs("div",{"data-testid":`message-actions-${e.id}`,className:"absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-[var(--color-bg)] border border-[var(--color-border)] rounded-lg shadow-sm p-1",children:[o.jsx("button",{"data-testid":`message-copy-button-${e.id}`,onClick:S,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Copy message (C when focused)",children:s?o.jsx(Vn,{className:"w-4 h-4 text-green-500"}):o.jsx(ej,{className:"w-4 h-4"})}),!n&&t&&o.jsx("button",{"data-testid":`message-reply-action-${e.id}`,onClick:()=>t(e),className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Reply in thread",children:o.jsx(hk,{className:"w-4 h-4"})})]}),i&&o.jsx("button",{"data-testid":`message-more-button-${e.id}`,onClick:()=>u(!0),className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 self-start mt-1 touch-target","aria-label":"More actions",children:o.jsx(n0,{className:"w-4 h-4"})})]}),i&&c&&o.jsx(yft,{message:e,isThreaded:n,onCopy:S,onReply:t,copied:s,onClose:()=>u(!1)})]})}function yft({message:e,isThreaded:t,onCopy:r,onReply:n,copied:a,onClose:i}){return o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":`message-action-sheet-${e.id}`,role:"dialog","aria-modal":"true",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:i}),o.jsxs("div",{className:"absolute bottom-0 inset-x-0 bg-[var(--color-bg)] rounded-t-2xl shadow-2xl p-4 space-y-2 animate-in slide-in-from-bottom duration-200",children:[o.jsx("div",{className:"w-10 h-1 bg-gray-300 dark:bg-gray-600 rounded-full mx-auto mb-4"}),o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors touch-target","data-testid":`message-copy-action-mobile-${e.id}`,children:[a?o.jsx(Vn,{className:"w-5 h-5 text-green-500"}):o.jsx(ej,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:"Copy message"})]}),!t&&n&&o.jsxs("button",{onClick:()=>{n(e),i()},className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors touch-target","data-testid":`message-reply-action-mobile-${e.id}`,children:[o.jsx(hk,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:"Reply in thread"})]}),o.jsx("button",{onClick:i,className:"w-full flex items-center justify-center px-4 py-3 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors mt-2 touch-target",children:o.jsx("span",{className:"text-[var(--color-text)] font-medium",children:"Cancel"})})]})]})}const Mte={open:o.jsx(nu,{className:"w-4 h-4 text-gray-400"}),in_progress:o.jsx(tn,{className:"w-4 h-4 text-blue-500"}),blocked:o.jsx(Bt,{className:"w-4 h-4 text-red-500"}),completed:o.jsx(Pi,{className:"w-4 h-4 text-green-500"}),cancelled:o.jsx(Pi,{className:"w-4 h-4 text-gray-400"})},xft={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Trivial"},Tte={1:"bg-red-100 text-red-700",2:"bg-orange-100 text-orange-700",3:"bg-yellow-100 text-yellow-700",4:"bg-blue-100 text-blue-700",5:"bg-gray-100 text-gray-600"};function wft(e){return gt({queryKey:["tasks","search",e],queryFn:async()=>{const t=new URLSearchParams({limit:"50"});e&&t.set("search",e);const r=await fetch(`/api/tasks?${t}`);if(!r.ok)throw new Error("Failed to fetch tasks");const n=await r.json();return Array.isArray(n)?n:n.data||[]}})}function Sft({isOpen:e,onClose:t,onSelect:r,excludeIds:n=[]}){const[a,i]=w.useState(""),[s,l]=w.useState(0),c=w.useRef(null),u=w.useRef(null),{data:d,isLoading:f}=wft(a),m=d?.filter(S=>!n.includes(S.id))||[];w.useEffect(()=>{l(0)},[m.length,a]),w.useEffect(()=>{e&&c.current&&setTimeout(()=>{c.current?.focus()},50)},[e]),w.useEffect(()=>{e||(i(""),l(0))},[e]),w.useEffect(()=>{u.current&&u.current.querySelector(`[data-index="${s}"]`)?.scrollIntoView({block:"nearest"})},[s]);const p=w.useCallback(S=>{r(S),t()},[r,t]),v=w.useCallback(S=>{if(S.key==="Escape"){t();return}if(S.key==="ArrowDown"){S.preventDefault(),l(_=>_>=m.length-1?0:_+1);return}if(S.key==="ArrowUp"){S.preventDefault(),l(_=>_<=0?m.length-1:_-1);return}if(S.key==="Enter"){S.preventDefault();const _=m[s];_&&p(_.id);return}},[m,s,p,t]),b=jo(),y=b?m.length>0?o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[m.length," task",m.length!==1?"s":""," found"]}):null:o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Xg,{className:"w-3 h-3"}),o.jsx(cr,{className:"w-3 h-3"}),"Navigate"]}),o.jsx("span",{children:" Select"}),o.jsx("span",{children:"Esc Close"})]}),m.length>0&&o.jsxs("span",{children:[m.length," task",m.length!==1?"s":""]})]});return o.jsx(Bx,{open:e,onClose:t,title:"Select Task",size:"lg","data-testid":"task-picker-modal",footer:y,children:o.jsxs("div",{onKeyDown:v,children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:c,type:"text",value:a,onChange:S=>i(S.target.value),onKeyDown:v,placeholder:"Search tasks...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"task-picker-search"})]})}),o.jsx("div",{ref:u,className:`overflow-y-auto p-2 ${b?"max-h-[calc(100vh-200px)]":"max-h-[300px]"}`,"data-testid":"task-picker-list",children:f?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx($e,{className:"w-5 h-5 animate-spin mr-2"}),"Loading tasks..."]}):m.length===0?o.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:a?"No tasks match your search":"No tasks available"}):m.map((S,_)=>{const N=_===s,k=Mte[S.status]||Mte.open,j=S.priority||3,E=xft[j]||"Medium",T=Tte[j]||Tte[3];return o.jsxs("button",{"data-index":_,"data-testid":`task-picker-item-${S.id}`,onClick:()=>p(S.id),onMouseEnter:()=>!b&&l(_),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-colors touch-target ${N?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx("span",{className:"flex-shrink-0",children:k}),o.jsx("span",{className:"flex-1 truncate font-medium",children:S.title}),o.jsx("span",{className:`flex-shrink-0 px-2 py-0.5 text-xs font-medium rounded ${T}`,children:E})]},S.id)})})]})})}const Ate={text:o.jsx(rn,{className:"w-4 h-4 text-gray-500"}),markdown:o.jsx(qp,{className:"w-4 h-4 text-purple-500"}),json:o.jsx(Bs,{className:"w-4 h-4 text-blue-500"})},kft={text:"Text",markdown:"Markdown",json:"JSON"},Dte={text:"bg-gray-100 text-gray-700",markdown:"bg-purple-100 text-purple-700",json:"bg-blue-100 text-blue-700"};function _ft(e){return gt({queryKey:["documents","search",e],queryFn:async()=>{const t=new URLSearchParams({limit:"100"});e&&t.set("search",e);const r=await fetch(`/api/documents?${t}`);if(!r.ok)throw new Error("Failed to fetch documents");const n=await r.json();return Array.isArray(n)?n:n.items||n.data||[]}})}function Nft({isOpen:e,onClose:t,onSelect:r,excludeIds:n=[]}){const[a,i]=w.useState(""),[s,l]=w.useState(0),c=w.useRef(null),u=w.useRef(null),{data:d,isLoading:f}=_ft(a),m=d?.filter(S=>!n.includes(S.id))||[];w.useEffect(()=>{l(0)},[m.length,a]),w.useEffect(()=>{e&&c.current&&setTimeout(()=>{c.current?.focus()},50)},[e]),w.useEffect(()=>{e||(i(""),l(0))},[e]),w.useEffect(()=>{u.current&&u.current.querySelector(`[data-index="${s}"]`)?.scrollIntoView({block:"nearest"})},[s]);const p=w.useCallback(S=>{r(S),t()},[r,t]),v=w.useCallback(S=>{if(S.key==="Escape"){t();return}if(S.key==="ArrowDown"){S.preventDefault(),l(_=>_>=m.length-1?0:_+1);return}if(S.key==="ArrowUp"){S.preventDefault(),l(_=>_<=0?m.length-1:_-1);return}if(S.key==="Enter"){S.preventDefault();const _=m[s];_&&p(_.id);return}},[m,s,p,t]),b=jo(),y=b?m.length>0?o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[m.length," document",m.length!==1?"s":""," found"]}):null:o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Xg,{className:"w-3 h-3"}),o.jsx(cr,{className:"w-3 h-3"}),"Navigate"]}),o.jsx("span",{children:" Select"}),o.jsx("span",{children:"Esc Close"})]}),m.length>0&&o.jsxs("span",{children:[m.length," document",m.length!==1?"s":""]})]});return o.jsx(Bx,{open:e,onClose:t,title:"Select Document",size:"lg","data-testid":"document-picker-modal",footer:y,children:o.jsxs("div",{onKeyDown:v,children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:c,type:"text",value:a,onChange:S=>i(S.target.value),onKeyDown:v,placeholder:"Search documents...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"document-picker-search"})]})}),o.jsx("div",{ref:u,className:`overflow-y-auto p-2 ${b?"max-h-[calc(100vh-200px)]":"max-h-[300px]"}`,"data-testid":"document-picker-list",children:f?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx($e,{className:"w-5 h-5 animate-spin mr-2"}),"Loading documents..."]}):m.length===0?o.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:a?"No documents match your search":"No documents available"}):m.map((S,_)=>{const N=_===s,k=S.contentType||"text",j=Ate[k]||Ate.text,E=kft[k]||"Text",T=Dte[k]||Dte.text,O=S.title||`Document ${S.id}`;return o.jsxs("button",{"data-index":_,"data-testid":`document-picker-item-${S.id}`,onClick:()=>p(S.id),onMouseEnter:()=>!b&&l(_),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-colors touch-target ${N?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx("span",{className:"flex-shrink-0",children:j}),o.jsx("span",{className:"flex-1 truncate font-medium",children:O}),o.jsx("span",{className:`flex-shrink-0 px-2 py-0.5 text-xs font-medium rounded ${T}`,children:E})]},S.id)})})]})})}function r5(e){return[].concat(e)}function o$(e){return e.startsWith(":")}function Y0e(e){return q2(e)&&(e==="*"||e.length>1&&":>~.+*".includes(e.slice(0,1))||X0e(e))}function Q0e(e,t){return(q2(t)||typeof t=="number")&&!Z0e(e)&&!o$(e)&&!J0e(e)}function J0e(e){return e.startsWith("@media")}function Cft(e){return e==="."}function Z0e(e){return e==="--"}function q2(e){return e+""===e}function X0e(e){return q2(e)&&(e.startsWith("&")||o$(e))}function NC(e,t=""){return e.filter(Boolean).join(t)}function eve(e,t){let r=0;if(t.length===0)return r.toString();for(let n=0;n<t.length;n++){const a=t.charCodeAt(n);r=(r<<5)-r+a,r=r&r}return`${e??"cl"}_${r.toString(36)}`}function jft(e,t){return e==="content"?`"${t}"`:t}function Eft(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Lte(e,t){return`${e}:${t}`}function Mft(e){return e?`.${e}`:""}function Tft(e,t){return e?`${e}
${t}`:t}var tve=class rve{constructor(t,r,n,a){this.sheet=t,this.property=r,this.value=n,this.selector=a,this.property=r,this.value=n,this.joined=Lte(r,n);const i=this.selector.preconditions.concat(this.selector.postconditions);this.hash=this.selector.hasConditions?this.selector.scopeClassName:eve(this.sheet.name,this.joined),this.key=NC([this.joined,i,this.hash])}toString(){let t=n5(this.selector.preconditions,{right:this.hash});return t=n5(this.selector.postconditions,{left:t}),`${t} {${rve.genRule(this.property,this.value)}}`}static genRule(t,r){const n=Eft(t);return Lte(n,jft(t,r))+";"}};function n5(e,{left:t="",right:r=""}={}){const n=e.reduce((a,i)=>o$(i)?a+i:X0e(i)?a+i.slice(1):NC([a,i]," "),t);return NC([n,Mft(r)]," ")}var Aft=class Fk{constructor(t,r=null,{preconditions:n,postconditions:a}={}){this.sheet=t,this.preconditions=[],this.scopeClassName=null,this.scopeName=null,this.postconditions=[],this.preconditions=n?r5(n):[],this.postconditions=a?r5(a):[],this.setScope(r)}setScope(t){return t?(this.scopeClassName||(this.scopeName=t,this.scopeClassName=eve(this.sheet.name,t+this.sheet.count)),this):this}get hasConditions(){return this.preconditions.length>0||this.postconditions.length>0}addScope(t){return new Fk(this.sheet,t,{preconditions:this.preconditions,postconditions:this.postconditions})}addPrecondition(t){return new Fk(this.sheet,this.scopeClassName,{postconditions:this.postconditions,preconditions:this.preconditions.concat(t)})}addPostcondition(t){return new Fk(this.sheet,this.scopeClassName,{preconditions:this.preconditions,postconditions:this.postconditions.concat(t)})}createRule(t,r){return new tve(this.sheet,t,r,this)}},Dft=class{constructor(e,t){this.name=e,this.rootNode=t,this.storedStyles={},this.storedClasses={},this.style="",this.count=0,this.id=`flairup-${e}`,this.styleTag=this.createStyleTag()}getStyle(){return this.style}append(e){this.style=Tft(this.style,e)}apply(){this.count++,this.styleTag&&(this.styleTag.innerHTML=this.style)}isApplied(){return!!this.styleTag}createStyleTag(){if(typeof document>"u"||this.isApplied()||this.rootNode===null)return this.styleTag;const e=document.createElement("style");return e.type="text/css",e.id=this.id,(this.rootNode??document.head).appendChild(e),e}addRule(e){const t=this.storedClasses[e.key];return q2(t)?t:(this.storedClasses[e.key]=e.hash,this.storedStyles[e.hash]=[e.property,e.value],this.append(e.toString()),e.hash)}};function l$(e,t){for(const r in e)t(r.trim(),e[r])}function kr(...e){const t=e.reduce((r,n)=>(n instanceof Set?r.push(...n):typeof n=="string"?r.push(n):Array.isArray(n)?r.push(kr(...n)):typeof n=="object"&&Object.entries(n).forEach(([a,i])=>{i&&r.push(a)}),r),[]);return NC(t," ").trim()}function Lft(e,t){const r=new Dft(e,t);return{create:n,getStyle:r.getStyle.bind(r),isApplied:r.isApplied.bind(r)};function n(a){const i={};return nve(r,a,new Aft(r)).forEach(([l,c,u])=>{W2(r,c,u).forEach(d=>{s(l,d)})}),r.apply(),i;function s(l,c){i[l]=i[l]??new Set,i[l].add(c)}}}function nve(e,t,r){const n=[];return l$(t,(a,i)=>{if(Y0e(a))return nve(e,i,r.addPrecondition(a)).forEach(s=>n.push(s));n.push([a,t[a],r.addScope(a)])}),n}function W2(e,t,r){const n=new Set;return l$(t,(a,i)=>{let s=[];if(Y0e(a))s=W2(e,i,r.addPostcondition(a));else if(Cft(a))s=r5(i);else if(J0e(a))s=Ift(e,i,a,r);else if(Z0e(a))s=Oft(e,i,r);else if(Q0e(a,i)){const l=r.createRule(a,i);e.addRule(l),n.add(l.hash)}return ave(s,n)}),n}function ave(e,t){return e.forEach(r=>t.add(r)),t}function Oft(e,t,r){const n=new Set,a=[];if(l$(t,(i,s)=>{if(Q0e(i,s)){a.push(tve.genRule(i,s));return}const l=W2(e,s??{},r);ave(l,n)}),!r.scopeClassName)return n;if(a.length){const i=a.join(" ");e.append(`${n5(r.preconditions,{right:r.scopeClassName})} {${i}}`)}return n.add(r.scopeClassName),n}function Ift(e,t,r,n){e.append(r+" {");const a=W2(e,t,n);return e.append("}"),a}function Ote(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Rft(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=zft(e))||t){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pn(){return pn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pn.apply(null,arguments)}function Pft(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a5(e,t)}function ive(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function a5(e,t){return a5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},a5(e,t)}function zft(e,t){if(e){if(typeof e=="string")return Ote(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ote(e,t):void 0}}var Mr;(function(e){e.hiddenOnSearch="epr-hidden-on-search",e.searchActive="epr-search-active",e.hidden="epr-hidden",e.visible="epr-visible",e.active="epr-active",e.emoji="epr-emoji",e.category="epr-emoji-category",e.label="epr-emoji-category-label",e.categoryContent="epr-emoji-category-content",e.emojiHasVariations="epr-emoji-has-variations",e.scrollBody="epr-body",e.emojiList="epr-emoji-list",e.external="__EmojiPicker__",e.emojiPicker="EmojiPickerReact",e.open="epr-open",e.vertical="epr-vertical",e.horizontal="epr-horizontal",e.variationPicker="epr-emoji-variation-picker",e.darkTheme="epr-dark-theme",e.autoTheme="epr-auto-theme"})(Mr||(Mr={}));function Co(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(n){return"."+n}).join("")}var Dn=Lft("epr",null),Uk={display:"none",opacity:"0",pointerEvents:"none",visibility:"hidden",overflow:"hidden"},c$=Dn.create({hidden:pn({".":Mr.hidden},Uk)}),Bft=w.memo(function(){return w.createElement("style",{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:Dn.getStyle()}})}),sm=Dn.create({".epr-main":{":has(input:not(:placeholder-shown))":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},hiddenOnSearch:pn({".":Mr.hiddenOnSearch},Uk)},":has(input:placeholder-shown)":{visibleOnSearchOnly:Uk}},hiddenOnReactions:{transition:"all 0.5s ease-in-out"},".epr-reactions":{hiddenOnReactions:{height:"0px",width:"0px",opacity:"0",pointerEvents:"none",overflow:"hidden"}},".EmojiPickerReact:not(.epr-search-active)":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"},"&.epr-active":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},visibleOnSearchOnly:pn({".":"epr-visible-on-search-only"},Uk)}});function Pd(e,t){var r,n;return{".epr-dark-theme":(r={},r[e]=t,r),".epr-auto-theme":(n={},n[e]={"@media (prefers-color-scheme: dark)":t},n)}}function sve(e,t){var r,n,a=(r=e.customEmojis)!=null?r:[],i=(n=t.customEmojis)!=null?n:[];return e.open===t.open&&e.emojiVersion===t.emojiVersion&&e.reactionsDefaultOpen===t.reactionsDefaultOpen&&e.searchPlaceHolder===t.searchPlaceHolder&&e.searchPlaceholder===t.searchPlaceholder&&e.searchClearButtonLabel===t.searchClearButtonLabel&&e.defaultSkinTone===t.defaultSkinTone&&e.skinTonesDisabled===t.skinTonesDisabled&&e.autoFocusSearch===t.autoFocusSearch&&e.emojiStyle===t.emojiStyle&&e.theme===t.theme&&e.suggestedEmojisMode===t.suggestedEmojisMode&&e.lazyLoadEmojis===t.lazyLoadEmojis&&e.className===t.className&&e.height===t.height&&e.width===t.width&&e.style===t.style&&e.searchDisabled===t.searchDisabled&&e.skinTonePickerLocation===t.skinTonePickerLocation&&a.length===i.length&&e.emojiData===t.emojiData}var $ft=["1f44d","2764-fe0f","1f603","1f622","1f64f","1f44e","1f621"],Hg;(function(e){e.RECENT="recent",e.FREQUENT="frequent"})(Hg||(Hg={}));var As;(function(e){e.NATIVE="native",e.APPLE="apple",e.TWITTER="twitter",e.GOOGLE="google",e.FACEBOOK="facebook"})(As||(As={}));var Dd;(function(e){e.DARK="dark",e.LIGHT="light",e.AUTO="auto"})(Dd||(Dd={}));var Uo;(function(e){e.NEUTRAL="neutral",e.LIGHT="1f3fb",e.MEDIUM_LIGHT="1f3fc",e.MEDIUM="1f3fd",e.MEDIUM_DARK="1f3fe",e.DARK="1f3ff"})(Uo||(Uo={}));var Vt;(function(e){e.SUGGESTED="suggested",e.CUSTOM="custom",e.SMILEYS_PEOPLE="smileys_people",e.ANIMALS_NATURE="animals_nature",e.FOOD_DRINK="food_drink",e.TRAVEL_PLACES="travel_places",e.ACTIVITIES="activities",e.OBJECTS="objects",e.SYMBOLS="symbols",e.FLAGS="flags"})(Vt||(Vt={}));var qg;(function(e){e.SEARCH="SEARCH",e.PREVIEW="PREVIEW"})(qg||(qg={}));var Fft="https://cdn.jsdelivr.net/npm/emoji-datasource-apple/img/apple/64/",Uft="https://cdn.jsdelivr.net/npm/emoji-datasource-facebook/img/facebook/64/",Hft="https://cdn.jsdelivr.net/npm/emoji-datasource-twitter/img/twitter/64/",qft="https://cdn.jsdelivr.net/npm/emoji-datasource-google/img/google/64/";function Wft(e){switch(e){case As.TWITTER:return Hft;case As.GOOGLE:return qft;case As.FACEBOOK:return Uft;case As.APPLE:default:return Fft}}var CC=[Uo.NEUTRAL,Uo.LIGHT,Uo.MEDIUM_LIGHT,Uo.MEDIUM,Uo.MEDIUM_DARK,Uo.DARK],Kft=Object.entries(Uo).reduce(function(e,t){var r=t[0],n=t[1];return e[n]=r,e},{}),u$=CC.reduce(function(e,t){var r;return Object.assign(e,(r={},r[t]=t,r))},{}),si;(function(e){e.name="n",e.unified="u",e.variations="v",e.added_in="a",e.imgUrl="imgUrl"})(si||(si={}));function ove(e){var t;return(t=e[si.name])!=null?t:[]}function Gft(e){return parseFloat(e[si.added_in]||"0")}function Vft(e){if(!e)return"";var t=ove(e);return t[t.length-1]}function lve(e){var t=e.split("-"),r=t.splice(1,1),n=r[0];return u$[n]?t.join("-"):e}function om(e,t){var r,n=e[si.unified];return!t||!Yft(e)?n:(r=Qft(e,t))!=null?r:n}function cve(e,t){return""+Wft(t)+e+".png"}function d$(e){var t;return(t=e[si.variations])!=null?t:[]}function Yft(e){return d$(e).length>0}function Qft(e,t){return t?d$(e).find(function(r){return r.includes(t)}):om(e)}function Jft(e){var t=e.split("-"),r=t[1];return Object.keys(u$).includes(r)?r:null}var ao,Zft=[Vt.SUGGESTED,Vt.CUSTOM,Vt.SMILEYS_PEOPLE,Vt.ANIMALS_NATURE,Vt.FOOD_DRINK,Vt.TRAVEL_PLACES,Vt.ACTIVITIES,Vt.OBJECTS,Vt.SYMBOLS,Vt.FLAGS],Xft={name:"Recently Used",category:Vt.SUGGESTED},uve=(ao={},ao[Vt.SUGGESTED]={category:Vt.SUGGESTED,name:"Frequently Used"},ao[Vt.CUSTOM]={category:Vt.CUSTOM,name:"Custom Emojis"},ao[Vt.SMILEYS_PEOPLE]={category:Vt.SMILEYS_PEOPLE,name:"Smileys & People"},ao[Vt.ANIMALS_NATURE]={category:Vt.ANIMALS_NATURE,name:"Animals & Nature"},ao[Vt.FOOD_DRINK]={category:Vt.FOOD_DRINK,name:"Food & Drink"},ao[Vt.TRAVEL_PLACES]={category:Vt.TRAVEL_PLACES,name:"Travel & Places"},ao[Vt.ACTIVITIES]={category:Vt.ACTIVITIES,name:"Activities"},ao[Vt.OBJECTS]={category:Vt.OBJECTS,name:"Objects"},ao[Vt.SYMBOLS]={category:Vt.SYMBOLS,name:"Symbols"},ao[Vt.FLAGS]={category:Vt.FLAGS,name:"Flags"},ao);function dve(e){return Zft.map(function(t){return pn({},uve[t],e&&e[t]&&e[t])})}function K2(e){return e.category}function fve(e){return e.name}function eht(e,t,r){var n;e===void 0&&(e=[]),t===void 0&&(t={});var a=(function(){var s=r!=null&&r.categories?Object.fromEntries(Object.entries(r.categories).filter(function(u){var d=u[1];return!!d})):{};if(t.suggestionMode===Hg.RECENT){var l,c=r==null||(l=r.categories)==null?void 0:l.suggested_recent;s[Vt.SUGGESTED]=c?{category:Vt.SUGGESTED,name:c.name}:Xft}return s})(),i=dve(a);return(n=e)!=null&&n.length?e.map(function(s){return typeof s=="string"?Ite(s,a[s]):pn({},Ite(s.category,a[s.category]),s)}):i}function Ite(e,t){return t===void 0&&(t={}),Object.assign(uve[e],t)}var tht=["2640-fe0f","2642-fe0f","2695-fe0f"],jC="Search",hve="Clear",rht="No results found",mve=" found. Use up and down arrow keys to navigate.",nht="1 result"+mve,aht="%n results"+mve;function Rte(e){var t,r,n,a,i;e===void 0&&(e={});var s=pve(),l=(t=e.emojiData)==null||(r=t.categories)==null||(n=r.preview_mood)==null?void 0:n.name,c=pn({},s.previewConfig,l&&!((a=e.previewConfig)!=null&&a.defaultCaption)?{defaultCaption:l}:{},(i=e.previewConfig)!=null?i:{}),u=Object.assign(s,e),d=eht(e.categories,{suggestionMode:u.suggestedEmojisMode},e.emojiData);u.hiddenEmojis.forEach(function(m){u.unicodeToHide.add(m)});var f=u.searchDisabled?qg.PREVIEW:u.skinTonePickerLocation;return pn({},u,{categories:d,previewConfig:c,skinTonePickerLocation:f})}function pve(){return{autoFocusSearch:!0,categories:dve(),className:"",customEmojis:[],defaultSkinTone:Uo.NEUTRAL,emojiStyle:As.APPLE,emojiVersion:null,getEmojiUrl:cve,height:450,lazyLoadEmojis:!1,previewConfig:pn({},iht),searchDisabled:!1,searchPlaceHolder:jC,searchPlaceholder:jC,searchClearButtonLabel:hve,skinTonePickerLocation:qg.SEARCH,skinTonesDisabled:!1,style:{},suggestedEmojisMode:Hg.FREQUENT,theme:Dd.LIGHT,unicodeToHide:new Set(tht),width:350,reactionsDefaultOpen:!1,reactions:$ft,open:!0,allowExpandReactions:!0,hiddenEmojis:[],emojiData:void 0}}var iht={defaultEmoji:"1f60a",defaultCaption:"What's your mood?",showPreview:!0},sht=["children"],gve=w.createContext(pve());function oht(e){var t=e.children,r=ive(e,sht),n=lht(r);return w.createElement(gve.Provider,{value:n},t)}function lht(e){var t,r=w.useState(function(){return Rte(e)}),n=r[0],a=r[1];return w.useEffect(function(){sve(n,e)||a(Rte(e))},[(t=e.customEmojis)==null?void 0:t.length,e.open,e.emojiVersion,e.reactionsDefaultOpen,e.searchPlaceHolder,e.searchPlaceholder,e.searchClearButtonLabel,e.defaultSkinTone,e.skinTonesDisabled,e.autoFocusSearch,e.emojiStyle,e.theme,e.suggestedEmojisMode,e.lazyLoadEmojis,e.className,e.height,e.width,e.searchDisabled,e.skinTonePickerLocation,e.allowExpandReactions,e.emojiData]),n}function Ln(){return w.useContext(gve)}function Pte(e,t){t===void 0&&(t=0);var r=w.useState(e),n=r[0],a=r[1],i=w.useRef(null);function s(l){return new Promise(function(c){var u;i.current&&clearTimeout(i.current),i.current=(u=window)==null?void 0:u.setTimeout(function(){a(l),c(l)},t)})}return[n,s]}var cht={smileys_people:{category:"smileys_people",name:"people & body"},animals_nature:{category:"animals_nature",name:"animals & nature"},food_drink:{category:"food_drink",name:"food & drink"},travel_places:{category:"travel_places",name:"travel & places"},activities:{category:"activities",name:"activities"},objects:{category:"objects",name:"objects"},symbols:{category:"symbols",name:"symbols"},flags:{category:"flags",name:"flags"},suggested:{category:"suggested",name:"Frequently Used"},custom:{category:"custom",name:"Custom Emojis"},suggested_recent:{category:"suggested",name:"Recently Used"},preview_mood:{category:"preview_mood",name:"What's your mood?"}},uht={custom:[],smileys_people:[{n:["face","grin","grinning face"],u:"1f600",a:"1"},{n:["face","open","mouth","smile","grinning face with big eyes"],u:"1f603",a:"0.6"},{n:["eye","face","open","mouth","smile","grinning face with smiling eyes"],u:"1f604",a:"0.6"},{n:["eye","face","grin","smile","beaming face with smiling eyes"],u:"1f601",a:"0.6"},{n:["face","laugh","mouth","smile","satisfied","grinning squinting face"],u:"1f606",a:"0.6"},{n:["cold","face","open","smile","sweat","grinning face with sweat"],u:"1f605",a:"0.6"},{n:["face","rofl","floor","laugh","rotfl","rolling","rolling on the floor laughing"],u:"1f923",a:"3"},{n:["joy","face","tear","laugh","face with tears of joy"],u:"1f602",a:"0.6"},{n:["face","smile","slightly smiling face"],u:"1f642",a:"1"},{n:["face","upside down","upside down face"],u:"1f643",a:"1"},{n:["melt","liquid","dissolve","disappear","melting face"],u:"1fae0",a:"14"},{n:["face","wink","winking face"],u:"1f609",a:"0.6"},{n:["eye","face","blush","smile","smiling face with smiling eyes"],u:"1f60a",a:"0.6"},{n:["face","halo","angel","fantasy","innocent","smiling face with halo"],u:"1f607",a:"1"},{n:["adore","crush","hearts","in love","smiling face with hearts"],u:"1f970",a:"11"},{n:["eye","face","love","smile","smiling face with heart eyes"],u:"1f60d",a:"0.6"},{n:["eyes","face","star","grinning","star struck"],u:"1f929",a:"5"},{n:["face","kiss","face blowing a kiss"],u:"1f618",a:"0.6"},{n:["face","kiss","kissing face"],u:"1f617",a:"1"},{n:["eye","face","kiss","closed","kissing face with closed eyes"],u:"1f61a",a:"0.6"},{n:["eye","face","kiss","smile","kissing face with smiling eyes"],u:"1f619",a:"1"},{n:["tear","proud","smiling","touched","grateful","relieved","smiling face with tear"],u:"1f972",a:"13"},{n:["yum","face","smile","delicious","savouring","face savoring food"],u:"1f60b",a:"0.6"},{n:["face","tongue","face with tongue"],u:"1f61b",a:"1"},{n:["eye","face","joke","wink","tongue","winking face with tongue"],u:"1f61c",a:"0.6"},{n:["eye","goofy","large","small","zany face"],u:"1f92a",a:"5"},{n:["eye","face","taste","tongue","horrible","squinting face with tongue"],u:"1f61d",a:"0.6"},{n:["face","money","mouth","money mouth face"],u:"1f911",a:"1"},{n:["hug","face","hugging","open hands","smiling face","smiling face with open hands"],u:"1f917",a:"1"},{n:["whoops","face with hand over mouth"],u:"1f92d",a:"5"},{n:["awe","scared","surprise","amazement","disbelief","embarrass","face with open eyes and hand over mouth"],u:"1fae2",a:"14"},{n:["peep","stare","captivated","face with peeking eye"],u:"1fae3",a:"14"},{n:["quiet","shush","shushing face"],u:"1f92b",a:"5"},{n:["face","thinking","thinking face"],u:"1f914",a:"1"},{n:["ok","yes","sunny","salute","troops","saluting face"],u:"1fae1",a:"14"},{n:["zip","face","mouth","zipper","zipper mouth face"],u:"1f910",a:"1"},{n:["skeptic","distrust","face with raised eyebrow"],u:"1f928",a:"5"},{n:["meh","face","deadpan","neutral","neutral face"],u:"1f610",a:"0.7"},{n:["meh","face","inexpressive","unexpressive","expressionless","expressionless face"],u:"1f611",a:"1"},{n:["face","mouth","quiet","silent","face without mouth"],u:"1f636",a:"1"},{n:["hide","depressed","disappear","introvert","invisible","dotted line face"],u:"1fae5",a:"14"},{n:["absentminded","face in clouds","head in clouds","face in the fog"],u:"1f636-200d-1f32b-fe0f",a:"13.1"},{n:["face","smirk","smirking face"],u:"1f60f",a:"0.6"},{n:["face","unhappy","unamused","unamused face"],u:"1f612",a:"0.6"},{n:["eyes","face","eyeroll","rolling","face with rolling eyes"],u:"1f644",a:"1"},{n:["face","grimace","grimacing face"],u:"1f62c",a:"1"},{n:["gasp","groan","exhale","relief","whisper","whistle","face exhaling"],u:"1f62e-200d-1f4a8",a:"13.1"},{n:["lie","face","pinocchio","lying face"],u:"1f925",a:"3"},{n:["face","shock","shaking","vibrate","earthquake","shaking face"],u:"1fae8",a:"15"},{n:["no","shake","head shaking horizontally"],u:"1f642-200d-2194-fe0f",a:"15.1"},{n:["nod","yes","head shaking vertically"],u:"1f642-200d-2195-fe0f",a:"15.1"},{n:["face","relieved","relieved face"],u:"1f60c",a:"0.6"},{n:["face","pensive","dejected","pensive face"],u:"1f614",a:"0.6"},{n:["face","sleep","good night","sleepy face"],u:"1f62a",a:"0.6"},{n:["face","drooling","drooling face"],u:"1f924",a:"3"},{n:["zzz","face","sleep","good night","sleeping face"],u:"1f634",a:"1"},{n:["cold","face","mask","sick","doctor","face with medical mask"],u:"1f637",a:"0.6"},{n:["ill","face","sick","thermometer","face with thermometer"],u:"1f912",a:"1"},{n:["face","hurt","injury","bandage","face with head bandage"],u:"1f915",a:"1"},{n:["face","vomit","nauseated","nauseated face"],u:"1f922",a:"3"},{n:["puke","sick","vomit","face vomiting"],u:"1f92e",a:"5"},{n:["face","sneeze","gesundheit","sneezing face"],u:"1f927",a:"3"},{n:["hot","hot face","feverish","sweating","red faced","heat stroke"],u:"1f975",a:"11"},{n:["cold","icicles","freezing","cold face","frostbite","blue faced"],u:"1f976",a:"11"},{n:["dizzy","tipsy","woozy face","wavy mouth","intoxicated","uneven eyes"],u:"1f974",a:"11"},{n:["dead","face","knocked out","crossed out eyes","face with crossed out eyes"],u:"1f635",a:"0.6"},{n:["whoa","dizzy","spiral","trouble","hypnotized","face with spiral eyes"],u:"1f635-200d-1f4ab",a:"13.1"},{n:["shocked","mind blown","exploding head"],u:"1f92f",a:"5"},{n:["hat","face","cowboy","cowgirl","cowboy hat face"],u:"1f920",a:"3"},{n:["hat","horn","party","celebration","partying face"],u:"1f973",a:"11"},{n:["face","nose","glasses","disguise","incognito","disguised face"],u:"1f978",a:"13"},{n:["sun","cool","face","bright","sunglasses","smiling face with sunglasses"],u:"1f60e",a:"1"},{n:["face","geek","nerd","nerd face"],u:"1f913",a:"1"},{n:["face","stuffy","monocle","face with monocle"],u:"1f9d0",a:"5"},{n:["meh","face","confused","confused face"],u:"1f615",a:"1"},{n:["meh","unsure","skeptical","disappointed","face with diagonal mouth"],u:"1fae4",a:"14"},{n:["face","worried","worried face"],u:"1f61f",a:"1"},{n:["face","frown","slightly frowning face"],u:"1f641",a:"1"},{n:["face","open","mouth","sympathy","face with open mouth"],u:"1f62e",a:"1"},{n:["face","hushed","stunned","surprised","hushed face"],u:"1f62f",a:"1"},{n:["face","shocked","totally","astonished","astonished face"],u:"1f632",a:"0.6"},{n:["face","dazed","flushed","flushed face"],u:"1f633",a:"0.6"},{n:["mercy","begging","puppy eyes","pleading face"],u:"1f97a",a:"11"},{n:["cry","sad","angry","proud","resist","face holding back tears"],u:"1f979",a:"14"},{n:["face","open","frown","mouth","frowning face with open mouth"],u:"1f626",a:"1"},{n:["face","anguished","anguished face"],u:"1f627",a:"1"},{n:["face","fear","scared","fearful","fearful face"],u:"1f628",a:"0.6"},{n:["blue","cold","face","sweat","rushed","anxious face with sweat"],u:"1f630",a:"0.6"},{n:["face","whew","relieved","disappointed","sad but relieved face"],u:"1f625",a:"0.6"},{n:["cry","sad","face","tear","crying face"],u:"1f622",a:"0.6"},{n:["cry","sad","sob","face","tear","loudly crying face"],u:"1f62d",a:"0.6"},{n:["face","fear","munch","scared","scream","face screaming in fear"],u:"1f631",a:"0.6"},{n:["face","confounded","confounded face"],u:"1f616",a:"0.6"},{n:["face","persevere","persevering face"],u:"1f623",a:"0.6"},{n:["face","disappointed","disappointed face"],u:"1f61e",a:"0.6"},{n:["cold","face","sweat","downcast face with sweat"],u:"1f613",a:"0.6"},{n:["face","tired","weary","weary face"],u:"1f629",a:"0.6"},{n:["face","tired","tired face"],u:"1f62b",a:"0.6"},{n:["yawn","bored","tired","yawning face"],u:"1f971",a:"12"},{n:["won","face","triumph","face with steam from nose"],u:"1f624",a:"0.6"},{n:["mad","red","face","rage","angry","enraged","pouting","enraged face"],u:"1f621",a:"0.6"},{n:["mad","face","anger","angry","angry face"],u:"1f620",a:"0.6"},{n:["swearing","face with symbols on mouth"],u:"1f92c",a:"5"},{n:["face","horns","smile","fantasy","fairy tale","smiling face with horns"],u:"1f608",a:"1"},{n:["imp","face","demon","devil","fantasy","angry face with horns"],u:"1f47f",a:"0.6"},{n:["face","skull","death","monster","fairy tale"],u:"1f480",a:"0.6"},{n:["poo","dung","face","poop","monster","pile of poo"],u:"1f4a9",a:"0.6"},{n:["face","clown","clown face"],u:"1f921",a:"3"},{n:["ogre","face","fantasy","monster","creature","fairy tale"],u:"1f479",a:"0.6"},{n:["face","goblin","fantasy","monster","creature","fairy tale"],u:"1f47a",a:"0.6"},{n:["face","ghost","fantasy","monster","creature","fairy tale"],u:"1f47b",a:"0.6"},{n:["ufo","face","alien","fantasy","creature","extraterrestrial"],u:"1f47d",a:"0.6"},{n:["ufo","face","alien","monster","creature","alien monster","extraterrestrial"],u:"1f47e",a:"0.6"},{n:["face","robot","monster"],u:"1f916",a:"1"},{n:["cat","face","open","mouth","smile","grinning","grinning cat"],u:"1f63a",a:"0.6"},{n:["cat","eye","face","grin","smile","grinning cat with smiling eyes"],u:"1f638",a:"0.6"},{n:["cat","joy","face","tear","cat with tears of joy"],u:"1f639",a:"0.6"},{n:["cat","eye","face","love","heart","smile","smiling cat with heart eyes"],u:"1f63b",a:"0.6"},{n:["cat","wry","face","smile","ironic","cat with wry smile"],u:"1f63c",a:"0.6"},{n:["cat","eye","face","kiss","kissing cat"],u:"1f63d",a:"0.6"},{n:["oh","cat","face","weary","weary cat","surprised"],u:"1f640",a:"0.6"},{n:["cat","cry","sad","face","tear","crying cat"],u:"1f63f",a:"0.6"},{n:["cat","face","pouting","pouting cat"],u:"1f63e",a:"0.6"},{n:["see","evil","face","monkey","forbidden","see no evil monkey"],u:"1f648",a:"0.6"},{n:["evil","face","hear","monkey","forbidden","hear no evil monkey"],u:"1f649",a:"0.6"},{n:["evil","face","speak","monkey","forbidden","speak no evil monkey"],u:"1f64a",a:"0.6"},{n:["love","mail","heart","letter","love letter"],u:"1f48c",a:"0.6"},{n:["arrow","cupid","heart with arrow"],u:"1f498",a:"0.6"},{n:["ribbon","valentine","heart with ribbon"],u:"1f49d",a:"0.6"},{n:["excited","sparkle","sparkling heart"],u:"1f496",a:"0.6"},{n:["pulse","excited","growing","nervous","growing heart"],u:"1f497",a:"0.6"},{n:["beating","heartbeat","pulsating","beating heart"],u:"1f493",a:"0.6"},{n:["revolving","revolving hearts"],u:"1f49e",a:"0.6"},{n:["love","two hearts"],u:"1f495",a:"0.6"},{n:["heart","heart decoration"],u:"1f49f",a:"0.6"},{n:["break","broken","broken heart"],u:"1f494",a:"0.6"},{n:["burn","love","lust","heart","sacred heart","heart on fire"],u:"2764-fe0f-200d-1f525",a:"13.1"},{n:["well","mending","healthier","improving","recovering","recuperating","mending heart"],u:"2764-fe0f-200d-1fa79",a:"13.1"},{n:["cute","like","love","pink","heart","pink heart"],u:"1fa77",a:"15"},{n:["orange","orange heart"],u:"1f9e1",a:"5"},{n:["yellow","yellow heart"],u:"1f49b",a:"0.6"},{n:["green","green heart"],u:"1f49a",a:"0.6"},{n:["blue","blue heart"],u:"1f499",a:"0.6"},{n:["cyan","teal","heart","light blue","light blue heart"],u:"1fa75",a:"15"},{n:["purple","purple heart"],u:"1f49c",a:"0.6"},{n:["brown","heart","brown heart"],u:"1f90e",a:"12"},{n:["evil","black","wicked","black heart"],u:"1f5a4",a:"3"},{n:["gray","heart","slate","silver","grey heart"],u:"1fa76",a:"15"},{n:["heart","white","white heart"],u:"1f90d",a:"12"},{n:["kiss","lips","kiss mark"],u:"1f48b",a:"0.6"},{n:["100","full","score","hundred","hundred points"],u:"1f4af",a:"0.6"},{n:["mad","angry","comic","anger symbol"],u:"1f4a2",a:"0.6"},{n:["boom","comic","collision"],u:"1f4a5",a:"0.6"},{n:["star","dizzy","comic"],u:"1f4ab",a:"0.6"},{n:["comic","sweat","splashing","sweat droplets"],u:"1f4a6",a:"0.6"},{n:["dash","comic","running","dashing away"],u:"1f4a8",a:"0.6"},{n:["comic","bubble","dialog","speech","balloon","speech balloon"],u:"1f4ac",a:"0.6"},{n:["eye","bubble","speech","balloon","witness","eye in speech bubble"],u:"1f441-fe0f-200d-1f5e8-fe0f",a:"2"},{n:["comic","bubble","balloon","thought","thought balloon"],u:"1f4ad",a:"1"},{n:["ZZZ","zzz","comic","sleep","good night"],u:"1f4a4",a:"0.6"},{n:["hand","wave","waving","waving hand"],u:"1f44b",v:["1f44b-1f3fb","1f44b-1f3fc","1f44b-1f3fd","1f44b-1f3fe","1f44b-1f3ff"],a:"0.6"},{n:["raised","backhand","raised back of hand"],u:"1f91a",v:["1f91a-1f3fb","1f91a-1f3fc","1f91a-1f3fd","1f91a-1f3fe","1f91a-1f3ff"],a:"3"},{n:["hand","high 5","high five","raised hand"],u:"270b",v:["270b-1f3fb","270b-1f3fc","270b-1f3fd","270b-1f3fe","270b-1f3ff"],a:"0.6"},{n:["hand","spock","finger","vulcan","vulcan salute"],u:"1f596",v:["1f596-1f3fb","1f596-1f3fc","1f596-1f3fd","1f596-1f3fe","1f596-1f3ff"],a:"1"},{n:["hand","right","rightward","rightwards hand"],u:"1faf1",v:["1faf1-1f3fb","1faf1-1f3fc","1faf1-1f3fd","1faf1-1f3fe","1faf1-1f3ff"],a:"14"},{n:["hand","left","leftward","leftwards hand"],u:"1faf2",v:["1faf2-1f3fb","1faf2-1f3fc","1faf2-1f3fd","1faf2-1f3fe","1faf2-1f3ff"],a:"14"},{n:["drop","shoo","dismiss","palm down hand"],u:"1faf3",v:["1faf3-1f3fb","1faf3-1f3fc","1faf3-1f3fd","1faf3-1f3fe","1faf3-1f3ff"],a:"14"},{n:["come","catch","offer","beckon","palm up hand"],u:"1faf4",v:["1faf4-1f3fb","1faf4-1f3fc","1faf4-1f3fd","1faf4-1f3fe","1faf4-1f3ff"],a:"14"},{n:["push","stop","wait","refuse","leftward","high five","leftwards pushing hand"],u:"1faf7",v:["1faf7-1f3fb","1faf7-1f3fc","1faf7-1f3fd","1faf7-1f3fe","1faf7-1f3ff"],a:"15"},{n:["push","stop","wait","refuse","high five","rightward","rightwards pushing hand"],u:"1faf8",v:["1faf8-1f3fb","1faf8-1f3fc","1faf8-1f3fd","1faf8-1f3fe","1faf8-1f3ff"],a:"15"},{n:["ok","hand","OK hand"],u:"1f44c",v:["1f44c-1f3fb","1f44c-1f3fc","1f44c-1f3fd","1f44c-1f3fe","1f44c-1f3ff"],a:"0.6"},{n:["fingers","pinched","sarcastic","hand gesture","interrogation","pinched fingers"],u:"1f90c",v:["1f90c-1f3fb","1f90c-1f3fc","1f90c-1f3fd","1f90c-1f3fe","1f90c-1f3ff"],a:"13"},{n:["small amount","pinching hand"],u:"1f90f",v:["1f90f-1f3fb","1f90f-1f3fc","1f90f-1f3fd","1f90f-1f3fe","1f90f-1f3ff"],a:"12"},{n:["hand","luck","cross","finger","crossed fingers"],u:"1f91e",v:["1f91e-1f3fb","1f91e-1f3fc","1f91e-1f3fd","1f91e-1f3fe","1f91e-1f3ff"],a:"3"},{n:["love","snap","heart","money","expensive","hand with index finger and thumb crossed"],u:"1faf0",v:["1faf0-1f3fb","1faf0-1f3fc","1faf0-1f3fd","1faf0-1f3fe","1faf0-1f3ff"],a:"14"},{n:["ily","hand","love you gesture"],u:"1f91f",v:["1f91f-1f3fb","1f91f-1f3fc","1f91f-1f3fd","1f91f-1f3fe","1f91f-1f3ff"],a:"5"},{n:["hand","horns","finger","rock on","sign of the horns"],u:"1f918",v:["1f918-1f3fb","1f918-1f3fc","1f918-1f3fd","1f918-1f3fe","1f918-1f3ff"],a:"1"},{n:["call","hand","shaka","hang loose","call me hand"],u:"1f919",v:["1f919-1f3fb","1f919-1f3fc","1f919-1f3fd","1f919-1f3fe","1f919-1f3ff"],a:"3"},{n:["hand","index","point","finger","backhand","backhand index pointing left"],u:"1f448",v:["1f448-1f3fb","1f448-1f3fc","1f448-1f3fd","1f448-1f3fe","1f448-1f3ff"],a:"0.6"},{n:["hand","index","point","finger","backhand","backhand index pointing right"],u:"1f449",v:["1f449-1f3fb","1f449-1f3fc","1f449-1f3fd","1f449-1f3fe","1f449-1f3ff"],a:"0.6"},{n:["up","hand","point","finger","backhand","backhand index pointing up"],u:"1f446",v:["1f446-1f3fb","1f446-1f3fc","1f446-1f3fd","1f446-1f3fe","1f446-1f3ff"],a:"0.6"},{n:["hand","finger","middle finger"],u:"1f595",v:["1f595-1f3fb","1f595-1f3fc","1f595-1f3fd","1f595-1f3fe","1f595-1f3ff"],a:"1"},{n:["down","hand","point","finger","backhand","backhand index pointing down"],u:"1f447",v:["1f447-1f3fb","1f447-1f3fc","1f447-1f3fd","1f447-1f3fe","1f447-1f3ff"],a:"0.6"},{n:["you","point","index pointing at the viewer"],u:"1faf5",v:["1faf5-1f3fb","1faf5-1f3fc","1faf5-1f3fd","1faf5-1f3fe","1faf5-1f3ff"],a:"14"},{n:["+1","up","hand","thumb","thumbs up"],u:"1f44d",v:["1f44d-1f3fb","1f44d-1f3fc","1f44d-1f3fd","1f44d-1f3fe","1f44d-1f3ff"],a:"0.6"},{n:[" 1","down","hand","thumb","thumbs down"],u:"1f44e",v:["1f44e-1f3fb","1f44e-1f3fc","1f44e-1f3fd","1f44e-1f3fe","1f44e-1f3ff"],a:"0.6"},{n:["fist","hand","punch","clenched","raised fist"],u:"270a",v:["270a-1f3fb","270a-1f3fc","270a-1f3fd","270a-1f3fe","270a-1f3ff"],a:"0.6"},{n:["fist","hand","punch","clenched","oncoming fist"],u:"1f44a",v:["1f44a-1f3fb","1f44a-1f3fc","1f44a-1f3fd","1f44a-1f3fe","1f44a-1f3ff"],a:"0.6"},{n:["fist","leftwards","left facing fist"],u:"1f91b",v:["1f91b-1f3fb","1f91b-1f3fc","1f91b-1f3fd","1f91b-1f3fe","1f91b-1f3ff"],a:"3"},{n:["fist","rightwards","right facing fist"],u:"1f91c",v:["1f91c-1f3fb","1f91c-1f3fc","1f91c-1f3fd","1f91c-1f3fe","1f91c-1f3ff"],a:"3"},{n:["clap","hand","clapping hands"],u:"1f44f",v:["1f44f-1f3fb","1f44f-1f3fc","1f44f-1f3fd","1f44f-1f3fe","1f44f-1f3ff"],a:"0.6"},{n:["hand","hooray","raised","gesture","celebration","raising hands"],u:"1f64c",v:["1f64c-1f3fb","1f64c-1f3fc","1f64c-1f3fd","1f64c-1f3fe","1f64c-1f3ff"],a:"0.6"},{n:["love","heart hands"],u:"1faf6",v:["1faf6-1f3fb","1faf6-1f3fc","1faf6-1f3fd","1faf6-1f3fe","1faf6-1f3ff"],a:"14"},{n:["hand","open","open hands"],u:"1f450",v:["1f450-1f3fb","1f450-1f3fc","1f450-1f3fd","1f450-1f3fe","1f450-1f3ff"],a:"0.6"},{n:["prayer","palms up together"],u:"1f932",v:["1f932-1f3fb","1f932-1f3fc","1f932-1f3fd","1f932-1f3fe","1f932-1f3ff"],a:"5"},{n:["hand","shake","meeting","handshake","agreement"],u:"1f91d",v:["1f91d-1f3fb","1f91d-1f3fc","1f91d-1f3fd","1f91d-1f3fe","1f91d-1f3ff","1faf1-1f3fb-200d-1faf2-1f3fc","1faf1-1f3fb-200d-1faf2-1f3fd","1faf1-1f3fb-200d-1faf2-1f3fe","1faf1-1f3fb-200d-1faf2-1f3ff","1faf1-1f3fc-200d-1faf2-1f3fb","1faf1-1f3fc-200d-1faf2-1f3fd","1faf1-1f3fc-200d-1faf2-1f3fe","1faf1-1f3fc-200d-1faf2-1f3ff","1faf1-1f3fd-200d-1faf2-1f3fb","1faf1-1f3fd-200d-1faf2-1f3fc","1faf1-1f3fd-200d-1faf2-1f3fe","1faf1-1f3fd-200d-1faf2-1f3ff","1faf1-1f3fe-200d-1faf2-1f3fb","1faf1-1f3fe-200d-1faf2-1f3fc","1faf1-1f3fe-200d-1faf2-1f3fd","1faf1-1f3fe-200d-1faf2-1f3ff","1faf1-1f3ff-200d-1faf2-1f3fb","1faf1-1f3ff-200d-1faf2-1f3fc","1faf1-1f3ff-200d-1faf2-1f3fd","1faf1-1f3ff-200d-1faf2-1f3fe"],a:"3"},{n:["ask","hand","pray","high 5","please","thanks","high five","folded hands"],u:"1f64f",v:["1f64f-1f3fb","1f64f-1f3fc","1f64f-1f3fd","1f64f-1f3fe","1f64f-1f3ff"],a:"0.6"},{n:["care","nail","polish","manicure","cosmetics","nail polish"],u:"1f485",v:["1f485-1f3fb","1f485-1f3fc","1f485-1f3fd","1f485-1f3fe","1f485-1f3ff"],a:"0.6"},{n:["phone","selfie","camera"],u:"1f933",v:["1f933-1f3fb","1f933-1f3fc","1f933-1f3fd","1f933-1f3fe","1f933-1f3ff"],a:"3"},{n:["flex","comic","biceps","muscle","flexed biceps"],u:"1f4aa",v:["1f4aa-1f3fb","1f4aa-1f3fc","1f4aa-1f3fd","1f4aa-1f3fe","1f4aa-1f3ff"],a:"0.6"},{n:["prosthetic","accessibility","mechanical arm"],u:"1f9be",a:"12"},{n:["prosthetic","accessibility","mechanical leg"],u:"1f9bf",a:"12"},{n:["leg","kick","limb"],u:"1f9b5",v:["1f9b5-1f3fb","1f9b5-1f3fc","1f9b5-1f3fd","1f9b5-1f3fe","1f9b5-1f3ff"],a:"11"},{n:["foot","kick","stomp"],u:"1f9b6",v:["1f9b6-1f3fb","1f9b6-1f3fc","1f9b6-1f3fd","1f9b6-1f3fe","1f9b6-1f3ff"],a:"11"},{n:["ear","body"],u:"1f442",v:["1f442-1f3fb","1f442-1f3fc","1f442-1f3fd","1f442-1f3fe","1f442-1f3ff"],a:"0.6"},{n:["accessibility","hard of hearing","ear with hearing aid"],u:"1f9bb",v:["1f9bb-1f3fb","1f9bb-1f3fc","1f9bb-1f3fd","1f9bb-1f3fe","1f9bb-1f3ff"],a:"12"},{n:["nose","body"],u:"1f443",v:["1f443-1f3fb","1f443-1f3fc","1f443-1f3fd","1f443-1f3fe","1f443-1f3ff"],a:"0.6"},{n:["brain","intelligent"],u:"1f9e0",a:"5"},{n:["heart","organ","pulse","anatomical","cardiology","anatomical heart"],u:"1fac0",a:"13"},{n:["lungs","organ","breath","exhalation","inhalation","respiration"],u:"1fac1",a:"13"},{n:["tooth","dentist"],u:"1f9b7",a:"11"},{n:["bone","skeleton"],u:"1f9b4",a:"11"},{n:["eye","eyes","face"],u:"1f440",a:"0.6"},{n:["body","tongue"],u:"1f445",a:"0.6"},{n:["lips","mouth"],u:"1f444",a:"0.6"},{n:["fear","anxious","nervous","worried","flirting","biting lip","uncomfortable"],u:"1fae6",a:"14"},{n:["baby","young"],u:"1f476",v:["1f476-1f3fb","1f476-1f3fc","1f476-1f3fd","1f476-1f3fe","1f476-1f3ff"],a:"0.6"},{n:["child","young","gender neutral","unspecified gender"],u:"1f9d2",v:["1f9d2-1f3fb","1f9d2-1f3fc","1f9d2-1f3fd","1f9d2-1f3fe","1f9d2-1f3ff"],a:"5"},{n:["boy","young"],u:"1f466",v:["1f466-1f3fb","1f466-1f3fc","1f466-1f3fd","1f466-1f3fe","1f466-1f3ff"],a:"0.6"},{n:["girl","virgo","young","zodiac"],u:"1f467",v:["1f467-1f3fb","1f467-1f3fc","1f467-1f3fd","1f467-1f3fe","1f467-1f3ff"],a:"0.6"},{n:["adult","person","gender neutral","unspecified gender"],u:"1f9d1",v:["1f9d1-1f3fb","1f9d1-1f3fc","1f9d1-1f3fd","1f9d1-1f3fe","1f9d1-1f3ff"],a:"5"},{n:["hair","blond","person: blond hair","blond haired person"],u:"1f471",v:["1f471-1f3fb","1f471-1f3fc","1f471-1f3fd","1f471-1f3fe","1f471-1f3ff"],a:"0.6"},{n:["man","adult"],u:"1f468",v:["1f468-1f3fb","1f468-1f3fc","1f468-1f3fd","1f468-1f3fe","1f468-1f3ff"],a:"0.6"},{n:["beard","person","person: beard"],u:"1f9d4",v:["1f9d4-1f3fb","1f9d4-1f3fc","1f9d4-1f3fd","1f9d4-1f3fe","1f9d4-1f3ff"],a:"5"},{n:["man","beard","man: beard"],u:"1f9d4-200d-2642-fe0f",v:["1f9d4-1f3fb-200d-2642-fe0f","1f9d4-1f3fc-200d-2642-fe0f","1f9d4-1f3fd-200d-2642-fe0f","1f9d4-1f3fe-200d-2642-fe0f","1f9d4-1f3ff-200d-2642-fe0f"],a:"13.1"},{n:["beard","woman","woman: beard"],u:"1f9d4-200d-2640-fe0f",v:["1f9d4-1f3fb-200d-2640-fe0f","1f9d4-1f3fc-200d-2640-fe0f","1f9d4-1f3fd-200d-2640-fe0f","1f9d4-1f3fe-200d-2640-fe0f","1f9d4-1f3ff-200d-2640-fe0f"],a:"13.1"},{n:["man","adult","red hair","man: red hair"],u:"1f468-200d-1f9b0",v:["1f468-1f3fb-200d-1f9b0","1f468-1f3fc-200d-1f9b0","1f468-1f3fd-200d-1f9b0","1f468-1f3fe-200d-1f9b0","1f468-1f3ff-200d-1f9b0"],a:"11"},{n:["man","adult","curly hair","man: curly hair"],u:"1f468-200d-1f9b1",v:["1f468-1f3fb-200d-1f9b1","1f468-1f3fc-200d-1f9b1","1f468-1f3fd-200d-1f9b1","1f468-1f3fe-200d-1f9b1","1f468-1f3ff-200d-1f9b1"],a:"11"},{n:["man","adult","white hair","man: white hair"],u:"1f468-200d-1f9b3",v:["1f468-1f3fb-200d-1f9b3","1f468-1f3fc-200d-1f9b3","1f468-1f3fd-200d-1f9b3","1f468-1f3fe-200d-1f9b3","1f468-1f3ff-200d-1f9b3"],a:"11"},{n:["man","bald","adult","man: bald"],u:"1f468-200d-1f9b2",v:["1f468-1f3fb-200d-1f9b2","1f468-1f3fc-200d-1f9b2","1f468-1f3fd-200d-1f9b2","1f468-1f3fe-200d-1f9b2","1f468-1f3ff-200d-1f9b2"],a:"11"},{n:["woman","adult"],u:"1f469",v:["1f469-1f3fb","1f469-1f3fc","1f469-1f3fd","1f469-1f3fe","1f469-1f3ff"],a:"0.6"},{n:["adult","woman","red hair","woman: red hair"],u:"1f469-200d-1f9b0",v:["1f469-1f3fb-200d-1f9b0","1f469-1f3fc-200d-1f9b0","1f469-1f3fd-200d-1f9b0","1f469-1f3fe-200d-1f9b0","1f469-1f3ff-200d-1f9b0"],a:"11"},{n:["adult","person","red hair","gender neutral","person: red hair","unspecified gender"],u:"1f9d1-200d-1f9b0",v:["1f9d1-1f3fb-200d-1f9b0","1f9d1-1f3fc-200d-1f9b0","1f9d1-1f3fd-200d-1f9b0","1f9d1-1f3fe-200d-1f9b0","1f9d1-1f3ff-200d-1f9b0"],a:"12.1"},{n:["adult","woman","curly hair","woman: curly hair"],u:"1f469-200d-1f9b1",v:["1f469-1f3fb-200d-1f9b1","1f469-1f3fc-200d-1f9b1","1f469-1f3fd-200d-1f9b1","1f469-1f3fe-200d-1f9b1","1f469-1f3ff-200d-1f9b1"],a:"11"},{n:["adult","person","curly hair","gender neutral","person: curly hair","unspecified gender"],u:"1f9d1-200d-1f9b1",v:["1f9d1-1f3fb-200d-1f9b1","1f9d1-1f3fc-200d-1f9b1","1f9d1-1f3fd-200d-1f9b1","1f9d1-1f3fe-200d-1f9b1","1f9d1-1f3ff-200d-1f9b1"],a:"12.1"},{n:["adult","woman","white hair","woman: white hair"],u:"1f469-200d-1f9b3",v:["1f469-1f3fb-200d-1f9b3","1f469-1f3fc-200d-1f9b3","1f469-1f3fd-200d-1f9b3","1f469-1f3fe-200d-1f9b3","1f469-1f3ff-200d-1f9b3"],a:"11"},{n:["adult","person","white hair","gender neutral","person: white hair","unspecified gender"],u:"1f9d1-200d-1f9b3",v:["1f9d1-1f3fb-200d-1f9b3","1f9d1-1f3fc-200d-1f9b3","1f9d1-1f3fd-200d-1f9b3","1f9d1-1f3fe-200d-1f9b3","1f9d1-1f3ff-200d-1f9b3"],a:"12.1"},{n:["bald","adult","woman","woman: bald"],u:"1f469-200d-1f9b2",v:["1f469-1f3fb-200d-1f9b2","1f469-1f3fc-200d-1f9b2","1f469-1f3fd-200d-1f9b2","1f469-1f3fe-200d-1f9b2","1f469-1f3ff-200d-1f9b2"],a:"11"},{n:["bald","adult","person","person: bald","gender neutral","unspecified gender"],u:"1f9d1-200d-1f9b2",v:["1f9d1-1f3fb-200d-1f9b2","1f9d1-1f3fc-200d-1f9b2","1f9d1-1f3fd-200d-1f9b2","1f9d1-1f3fe-200d-1f9b2","1f9d1-1f3ff-200d-1f9b2"],a:"12.1"},{n:["hair","woman","blonde","woman: blond hair","blond haired woman"],u:"1f471-200d-2640-fe0f",v:["1f471-1f3fb-200d-2640-fe0f","1f471-1f3fc-200d-2640-fe0f","1f471-1f3fd-200d-2640-fe0f","1f471-1f3fe-200d-2640-fe0f","1f471-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","hair","blond","man: blond hair","blond haired man"],u:"1f471-200d-2642-fe0f",v:["1f471-1f3fb-200d-2642-fe0f","1f471-1f3fc-200d-2642-fe0f","1f471-1f3fd-200d-2642-fe0f","1f471-1f3fe-200d-2642-fe0f","1f471-1f3ff-200d-2642-fe0f"],a:"4"},{n:["old","adult","older person","gender neutral","unspecified gender"],u:"1f9d3",v:["1f9d3-1f3fb","1f9d3-1f3fc","1f9d3-1f3fd","1f9d3-1f3fe","1f9d3-1f3ff"],a:"5"},{n:["man","old","adult","old man"],u:"1f474",v:["1f474-1f3fb","1f474-1f3fc","1f474-1f3fd","1f474-1f3fe","1f474-1f3ff"],a:"0.6"},{n:["old","adult","woman","old woman"],u:"1f475",v:["1f475-1f3fb","1f475-1f3fc","1f475-1f3fd","1f475-1f3fe","1f475-1f3ff"],a:"0.6"},{n:["frown","gesture","person frowning"],u:"1f64d",v:["1f64d-1f3fb","1f64d-1f3fc","1f64d-1f3fd","1f64d-1f3fe","1f64d-1f3ff"],a:"0.6"},{n:["man","gesture","frowning","man frowning"],u:"1f64d-200d-2642-fe0f",v:["1f64d-1f3fb-200d-2642-fe0f","1f64d-1f3fc-200d-2642-fe0f","1f64d-1f3fd-200d-2642-fe0f","1f64d-1f3fe-200d-2642-fe0f","1f64d-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","gesture","frowning","woman frowning"],u:"1f64d-200d-2640-fe0f",v:["1f64d-1f3fb-200d-2640-fe0f","1f64d-1f3fc-200d-2640-fe0f","1f64d-1f3fd-200d-2640-fe0f","1f64d-1f3fe-200d-2640-fe0f","1f64d-1f3ff-200d-2640-fe0f"],a:"4"},{n:["gesture","pouting","person pouting"],u:"1f64e",v:["1f64e-1f3fb","1f64e-1f3fc","1f64e-1f3fd","1f64e-1f3fe","1f64e-1f3ff"],a:"0.6"},{n:["man","gesture","pouting","man pouting"],u:"1f64e-200d-2642-fe0f",v:["1f64e-1f3fb-200d-2642-fe0f","1f64e-1f3fc-200d-2642-fe0f","1f64e-1f3fd-200d-2642-fe0f","1f64e-1f3fe-200d-2642-fe0f","1f64e-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","gesture","pouting","woman pouting"],u:"1f64e-200d-2640-fe0f",v:["1f64e-1f3fb-200d-2640-fe0f","1f64e-1f3fc-200d-2640-fe0f","1f64e-1f3fd-200d-2640-fe0f","1f64e-1f3fe-200d-2640-fe0f","1f64e-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hand","gesture","forbidden","prohibited","person gesturing NO","person gesturing no"],u:"1f645",v:["1f645-1f3fb","1f645-1f3fc","1f645-1f3fd","1f645-1f3fe","1f645-1f3ff"],a:"0.6"},{n:["man","hand","gesture","forbidden","prohibited","man gesturing NO","man gesturing no"],u:"1f645-200d-2642-fe0f",v:["1f645-1f3fb-200d-2642-fe0f","1f645-1f3fc-200d-2642-fe0f","1f645-1f3fd-200d-2642-fe0f","1f645-1f3fe-200d-2642-fe0f","1f645-1f3ff-200d-2642-fe0f"],a:"4"},{n:["hand","woman","gesture","forbidden","prohibited","woman gesturing NO","woman gesturing no"],u:"1f645-200d-2640-fe0f",v:["1f645-1f3fb-200d-2640-fe0f","1f645-1f3fc-200d-2640-fe0f","1f645-1f3fd-200d-2640-fe0f","1f645-1f3fe-200d-2640-fe0f","1f645-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ok","hand","gesture","person gesturing OK","person gesturing ok"],u:"1f646",v:["1f646-1f3fb","1f646-1f3fc","1f646-1f3fd","1f646-1f3fe","1f646-1f3ff"],a:"0.6"},{n:["ok","man","hand","gesture","man gesturing OK","man gesturing ok"],u:"1f646-200d-2642-fe0f",v:["1f646-1f3fb-200d-2642-fe0f","1f646-1f3fc-200d-2642-fe0f","1f646-1f3fd-200d-2642-fe0f","1f646-1f3fe-200d-2642-fe0f","1f646-1f3ff-200d-2642-fe0f"],a:"4"},{n:["ok","hand","woman","gesture","woman gesturing OK","woman gesturing ok"],u:"1f646-200d-2640-fe0f",v:["1f646-1f3fb-200d-2640-fe0f","1f646-1f3fc-200d-2640-fe0f","1f646-1f3fd-200d-2640-fe0f","1f646-1f3fe-200d-2640-fe0f","1f646-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hand","help","sassy","tipping","information","person tipping hand"],u:"1f481",v:["1f481-1f3fb","1f481-1f3fc","1f481-1f3fd","1f481-1f3fe","1f481-1f3ff"],a:"0.6"},{n:["man","sassy","tipping hand","man tipping hand"],u:"1f481-200d-2642-fe0f",v:["1f481-1f3fb-200d-2642-fe0f","1f481-1f3fc-200d-2642-fe0f","1f481-1f3fd-200d-2642-fe0f","1f481-1f3fe-200d-2642-fe0f","1f481-1f3ff-200d-2642-fe0f"],a:"4"},{n:["sassy","woman","tipping hand","woman tipping hand"],u:"1f481-200d-2640-fe0f",v:["1f481-1f3fb-200d-2640-fe0f","1f481-1f3fc-200d-2640-fe0f","1f481-1f3fd-200d-2640-fe0f","1f481-1f3fe-200d-2640-fe0f","1f481-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hand","happy","raised","gesture","person raising hand"],u:"1f64b",v:["1f64b-1f3fb","1f64b-1f3fc","1f64b-1f3fd","1f64b-1f3fe","1f64b-1f3ff"],a:"0.6"},{n:["man","gesture","raising hand","man raising hand"],u:"1f64b-200d-2642-fe0f",v:["1f64b-1f3fb-200d-2642-fe0f","1f64b-1f3fc-200d-2642-fe0f","1f64b-1f3fd-200d-2642-fe0f","1f64b-1f3fe-200d-2642-fe0f","1f64b-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","gesture","raising hand","woman raising hand"],u:"1f64b-200d-2640-fe0f",v:["1f64b-1f3fb-200d-2640-fe0f","1f64b-1f3fc-200d-2640-fe0f","1f64b-1f3fd-200d-2640-fe0f","1f64b-1f3fe-200d-2640-fe0f","1f64b-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ear","deaf","hear","deaf person","accessibility"],u:"1f9cf",v:["1f9cf-1f3fb","1f9cf-1f3fc","1f9cf-1f3fd","1f9cf-1f3fe","1f9cf-1f3ff"],a:"12"},{n:["man","deaf","deaf man"],u:"1f9cf-200d-2642-fe0f",v:["1f9cf-1f3fb-200d-2642-fe0f","1f9cf-1f3fc-200d-2642-fe0f","1f9cf-1f3fd-200d-2642-fe0f","1f9cf-1f3fe-200d-2642-fe0f","1f9cf-1f3ff-200d-2642-fe0f"],a:"12"},{n:["deaf","woman","deaf woman"],u:"1f9cf-200d-2640-fe0f",v:["1f9cf-1f3fb-200d-2640-fe0f","1f9cf-1f3fc-200d-2640-fe0f","1f9cf-1f3fd-200d-2640-fe0f","1f9cf-1f3fe-200d-2640-fe0f","1f9cf-1f3ff-200d-2640-fe0f"],a:"12"},{n:["bow","sorry","apology","gesture","person bowing"],u:"1f647",v:["1f647-1f3fb","1f647-1f3fc","1f647-1f3fd","1f647-1f3fe","1f647-1f3ff"],a:"0.6"},{n:["man","favor","sorry","bowing","apology","gesture","man bowing"],u:"1f647-200d-2642-fe0f",v:["1f647-1f3fb-200d-2642-fe0f","1f647-1f3fc-200d-2642-fe0f","1f647-1f3fd-200d-2642-fe0f","1f647-1f3fe-200d-2642-fe0f","1f647-1f3ff-200d-2642-fe0f"],a:"4"},{n:["favor","sorry","woman","bowing","apology","gesture","woman bowing"],u:"1f647-200d-2640-fe0f",v:["1f647-1f3fb-200d-2640-fe0f","1f647-1f3fc-200d-2640-fe0f","1f647-1f3fd-200d-2640-fe0f","1f647-1f3fe-200d-2640-fe0f","1f647-1f3ff-200d-2640-fe0f"],a:"4"},{n:["face","palm","disbelief","exasperation","person facepalming"],u:"1f926",v:["1f926-1f3fb","1f926-1f3fc","1f926-1f3fd","1f926-1f3fe","1f926-1f3ff"],a:"3"},{n:["man","facepalm","disbelief","exasperation","man facepalming"],u:"1f926-200d-2642-fe0f",v:["1f926-1f3fb-200d-2642-fe0f","1f926-1f3fc-200d-2642-fe0f","1f926-1f3fd-200d-2642-fe0f","1f926-1f3fe-200d-2642-fe0f","1f926-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","facepalm","disbelief","exasperation","woman facepalming"],u:"1f926-200d-2640-fe0f",v:["1f926-1f3fb-200d-2640-fe0f","1f926-1f3fc-200d-2640-fe0f","1f926-1f3fd-200d-2640-fe0f","1f926-1f3fe-200d-2640-fe0f","1f926-1f3ff-200d-2640-fe0f"],a:"4"},{n:["doubt","shrug","ignorance","indifference","person shrugging"],u:"1f937",v:["1f937-1f3fb","1f937-1f3fc","1f937-1f3fd","1f937-1f3fe","1f937-1f3ff"],a:"3"},{n:["man","doubt","shrug","ignorance","indifference","man shrugging"],u:"1f937-200d-2642-fe0f",v:["1f937-1f3fb-200d-2642-fe0f","1f937-1f3fc-200d-2642-fe0f","1f937-1f3fd-200d-2642-fe0f","1f937-1f3fe-200d-2642-fe0f","1f937-1f3ff-200d-2642-fe0f"],a:"4"},{n:["doubt","shrug","woman","ignorance","indifference","woman shrugging"],u:"1f937-200d-2640-fe0f",v:["1f937-1f3fb-200d-2640-fe0f","1f937-1f3fc-200d-2640-fe0f","1f937-1f3fd-200d-2640-fe0f","1f937-1f3fe-200d-2640-fe0f","1f937-1f3ff-200d-2640-fe0f"],a:"4"},{n:["nurse","doctor","therapist","healthcare","health worker"],u:"1f9d1-200d-2695-fe0f",v:["1f9d1-1f3fb-200d-2695-fe0f","1f9d1-1f3fc-200d-2695-fe0f","1f9d1-1f3fd-200d-2695-fe0f","1f9d1-1f3fe-200d-2695-fe0f","1f9d1-1f3ff-200d-2695-fe0f"],a:"12.1"},{n:["man","nurse","doctor","therapist","healthcare","man health worker"],u:"1f468-200d-2695-fe0f",v:["1f468-1f3fb-200d-2695-fe0f","1f468-1f3fc-200d-2695-fe0f","1f468-1f3fd-200d-2695-fe0f","1f468-1f3fe-200d-2695-fe0f","1f468-1f3ff-200d-2695-fe0f"],a:"4"},{n:["nurse","woman","doctor","therapist","healthcare","woman health worker"],u:"1f469-200d-2695-fe0f",v:["1f469-1f3fb-200d-2695-fe0f","1f469-1f3fc-200d-2695-fe0f","1f469-1f3fd-200d-2695-fe0f","1f469-1f3fe-200d-2695-fe0f","1f469-1f3ff-200d-2695-fe0f"],a:"4"},{n:["student","graduate"],u:"1f9d1-200d-1f393",v:["1f9d1-1f3fb-200d-1f393","1f9d1-1f3fc-200d-1f393","1f9d1-1f3fd-200d-1f393","1f9d1-1f3fe-200d-1f393","1f9d1-1f3ff-200d-1f393"],a:"12.1"},{n:["man","student","graduate","man student"],u:"1f468-200d-1f393",v:["1f468-1f3fb-200d-1f393","1f468-1f3fc-200d-1f393","1f468-1f3fd-200d-1f393","1f468-1f3fe-200d-1f393","1f468-1f3ff-200d-1f393"],a:"4"},{n:["woman","student","graduate","woman student"],u:"1f469-200d-1f393",v:["1f469-1f3fb-200d-1f393","1f469-1f3fc-200d-1f393","1f469-1f3fd-200d-1f393","1f469-1f3fe-200d-1f393","1f469-1f3ff-200d-1f393"],a:"4"},{n:["teacher","lecturer","professor","instructor"],u:"1f9d1-200d-1f3eb",v:["1f9d1-1f3fb-200d-1f3eb","1f9d1-1f3fc-200d-1f3eb","1f9d1-1f3fd-200d-1f3eb","1f9d1-1f3fe-200d-1f3eb","1f9d1-1f3ff-200d-1f3eb"],a:"12.1"},{n:["man","teacher","lecturer","professor","instructor","man teacher"],u:"1f468-200d-1f3eb",v:["1f468-1f3fb-200d-1f3eb","1f468-1f3fc-200d-1f3eb","1f468-1f3fd-200d-1f3eb","1f468-1f3fe-200d-1f3eb","1f468-1f3ff-200d-1f3eb"],a:"4"},{n:["woman","teacher","lecturer","professor","instructor","woman teacher"],u:"1f469-200d-1f3eb",v:["1f469-1f3fb-200d-1f3eb","1f469-1f3fc-200d-1f3eb","1f469-1f3fd-200d-1f3eb","1f469-1f3fe-200d-1f3eb","1f469-1f3ff-200d-1f3eb"],a:"4"},{n:["law","judge","scales","justice"],u:"1f9d1-200d-2696-fe0f",v:["1f9d1-1f3fb-200d-2696-fe0f","1f9d1-1f3fc-200d-2696-fe0f","1f9d1-1f3fd-200d-2696-fe0f","1f9d1-1f3fe-200d-2696-fe0f","1f9d1-1f3ff-200d-2696-fe0f"],a:"12.1"},{n:["law","man","judge","scales","justice","man judge"],u:"1f468-200d-2696-fe0f",v:["1f468-1f3fb-200d-2696-fe0f","1f468-1f3fc-200d-2696-fe0f","1f468-1f3fd-200d-2696-fe0f","1f468-1f3fe-200d-2696-fe0f","1f468-1f3ff-200d-2696-fe0f"],a:"4"},{n:["law","judge","woman","scales","justice","woman judge"],u:"1f469-200d-2696-fe0f",v:["1f469-1f3fb-200d-2696-fe0f","1f469-1f3fc-200d-2696-fe0f","1f469-1f3fd-200d-2696-fe0f","1f469-1f3fe-200d-2696-fe0f","1f469-1f3ff-200d-2696-fe0f"],a:"4"},{n:["farmer","rancher","gardener"],u:"1f9d1-200d-1f33e",v:["1f9d1-1f3fb-200d-1f33e","1f9d1-1f3fc-200d-1f33e","1f9d1-1f3fd-200d-1f33e","1f9d1-1f3fe-200d-1f33e","1f9d1-1f3ff-200d-1f33e"],a:"12.1"},{n:["man","farmer","rancher","gardener","man farmer"],u:"1f468-200d-1f33e",v:["1f468-1f3fb-200d-1f33e","1f468-1f3fc-200d-1f33e","1f468-1f3fd-200d-1f33e","1f468-1f3fe-200d-1f33e","1f468-1f3ff-200d-1f33e"],a:"4"},{n:["woman","farmer","rancher","gardener","woman farmer"],u:"1f469-200d-1f33e",v:["1f469-1f3fb-200d-1f33e","1f469-1f3fc-200d-1f33e","1f469-1f3fd-200d-1f33e","1f469-1f3fe-200d-1f33e","1f469-1f3ff-200d-1f33e"],a:"4"},{n:["cook","chef"],u:"1f9d1-200d-1f373",v:["1f9d1-1f3fb-200d-1f373","1f9d1-1f3fc-200d-1f373","1f9d1-1f3fd-200d-1f373","1f9d1-1f3fe-200d-1f373","1f9d1-1f3ff-200d-1f373"],a:"12.1"},{n:["man","chef","cook","man cook"],u:"1f468-200d-1f373",v:["1f468-1f3fb-200d-1f373","1f468-1f3fc-200d-1f373","1f468-1f3fd-200d-1f373","1f468-1f3fe-200d-1f373","1f468-1f3ff-200d-1f373"],a:"4"},{n:["chef","cook","woman","woman cook"],u:"1f469-200d-1f373",v:["1f469-1f3fb-200d-1f373","1f469-1f3fc-200d-1f373","1f469-1f3fd-200d-1f373","1f469-1f3fe-200d-1f373","1f469-1f3ff-200d-1f373"],a:"4"},{n:["plumber","mechanic","electrician","tradesperson"],u:"1f9d1-200d-1f527",v:["1f9d1-1f3fb-200d-1f527","1f9d1-1f3fc-200d-1f527","1f9d1-1f3fd-200d-1f527","1f9d1-1f3fe-200d-1f527","1f9d1-1f3ff-200d-1f527"],a:"12.1"},{n:["man","plumber","mechanic","electrician","man mechanic","tradesperson"],u:"1f468-200d-1f527",v:["1f468-1f3fb-200d-1f527","1f468-1f3fc-200d-1f527","1f468-1f3fd-200d-1f527","1f468-1f3fe-200d-1f527","1f468-1f3ff-200d-1f527"],a:"4"},{n:["woman","plumber","mechanic","electrician","tradesperson","woman mechanic"],u:"1f469-200d-1f527",v:["1f469-1f3fb-200d-1f527","1f469-1f3fc-200d-1f527","1f469-1f3fd-200d-1f527","1f469-1f3fe-200d-1f527","1f469-1f3ff-200d-1f527"],a:"4"},{n:["worker","factory","assembly","industrial","factory worker"],u:"1f9d1-200d-1f3ed",v:["1f9d1-1f3fb-200d-1f3ed","1f9d1-1f3fc-200d-1f3ed","1f9d1-1f3fd-200d-1f3ed","1f9d1-1f3fe-200d-1f3ed","1f9d1-1f3ff-200d-1f3ed"],a:"12.1"},{n:["man","worker","factory","assembly","industrial","man factory worker"],u:"1f468-200d-1f3ed",v:["1f468-1f3fb-200d-1f3ed","1f468-1f3fc-200d-1f3ed","1f468-1f3fd-200d-1f3ed","1f468-1f3fe-200d-1f3ed","1f468-1f3ff-200d-1f3ed"],a:"4"},{n:["woman","worker","factory","assembly","industrial","woman factory worker"],u:"1f469-200d-1f3ed",v:["1f469-1f3fb-200d-1f3ed","1f469-1f3fc-200d-1f3ed","1f469-1f3fd-200d-1f3ed","1f469-1f3fe-200d-1f3ed","1f469-1f3ff-200d-1f3ed"],a:"4"},{n:["manager","business","architect","white collar","office worker"],u:"1f9d1-200d-1f4bc",v:["1f9d1-1f3fb-200d-1f4bc","1f9d1-1f3fc-200d-1f4bc","1f9d1-1f3fd-200d-1f4bc","1f9d1-1f3fe-200d-1f4bc","1f9d1-1f3ff-200d-1f4bc"],a:"12.1"},{n:["man","manager","business","architect","white collar","man office worker"],u:"1f468-200d-1f4bc",v:["1f468-1f3fb-200d-1f4bc","1f468-1f3fc-200d-1f4bc","1f468-1f3fd-200d-1f4bc","1f468-1f3fe-200d-1f4bc","1f468-1f3ff-200d-1f4bc"],a:"4"},{n:["woman","manager","business","architect","white collar","woman office worker"],u:"1f469-200d-1f4bc",v:["1f469-1f3fb-200d-1f4bc","1f469-1f3fc-200d-1f4bc","1f469-1f3fd-200d-1f4bc","1f469-1f3fe-200d-1f4bc","1f469-1f3ff-200d-1f4bc"],a:"4"},{n:["chemist","engineer","scientist","biologist","physicist"],u:"1f9d1-200d-1f52c",v:["1f9d1-1f3fb-200d-1f52c","1f9d1-1f3fc-200d-1f52c","1f9d1-1f3fd-200d-1f52c","1f9d1-1f3fe-200d-1f52c","1f9d1-1f3ff-200d-1f52c"],a:"12.1"},{n:["man","chemist","engineer","biologist","physicist","scientist","man scientist"],u:"1f468-200d-1f52c",v:["1f468-1f3fb-200d-1f52c","1f468-1f3fc-200d-1f52c","1f468-1f3fd-200d-1f52c","1f468-1f3fe-200d-1f52c","1f468-1f3ff-200d-1f52c"],a:"4"},{n:["woman","chemist","engineer","biologist","physicist","scientist","woman scientist"],u:"1f469-200d-1f52c",v:["1f469-1f3fb-200d-1f52c","1f469-1f3fc-200d-1f52c","1f469-1f3fd-200d-1f52c","1f469-1f3fe-200d-1f52c","1f469-1f3ff-200d-1f52c"],a:"4"},{n:["coder","inventor","software","developer","technologist"],u:"1f9d1-200d-1f4bb",v:["1f9d1-1f3fb-200d-1f4bb","1f9d1-1f3fc-200d-1f4bb","1f9d1-1f3fd-200d-1f4bb","1f9d1-1f3fe-200d-1f4bb","1f9d1-1f3ff-200d-1f4bb"],a:"12.1"},{n:["man","coder","inventor","software","developer","technologist","man technologist"],u:"1f468-200d-1f4bb",v:["1f468-1f3fb-200d-1f4bb","1f468-1f3fc-200d-1f4bb","1f468-1f3fd-200d-1f4bb","1f468-1f3fe-200d-1f4bb","1f468-1f3ff-200d-1f4bb"],a:"4"},{n:["coder","woman","inventor","software","developer","technologist","woman technologist"],u:"1f469-200d-1f4bb",v:["1f469-1f3fb-200d-1f4bb","1f469-1f3fc-200d-1f4bb","1f469-1f3fd-200d-1f4bb","1f469-1f3fe-200d-1f4bb","1f469-1f3ff-200d-1f4bb"],a:"4"},{n:["rock","star","actor","singer","entertainer"],u:"1f9d1-200d-1f3a4",v:["1f9d1-1f3fb-200d-1f3a4","1f9d1-1f3fc-200d-1f3a4","1f9d1-1f3fd-200d-1f3a4","1f9d1-1f3fe-200d-1f3a4","1f9d1-1f3ff-200d-1f3a4"],a:"12.1"},{n:["man","rock","star","actor","singer","man singer","entertainer"],u:"1f468-200d-1f3a4",v:["1f468-1f3fb-200d-1f3a4","1f468-1f3fc-200d-1f3a4","1f468-1f3fd-200d-1f3a4","1f468-1f3fe-200d-1f3a4","1f468-1f3ff-200d-1f3a4"],a:"4"},{n:["rock","star","actor","woman","singer","entertainer","woman singer"],u:"1f469-200d-1f3a4",v:["1f469-1f3fb-200d-1f3a4","1f469-1f3fc-200d-1f3a4","1f469-1f3fd-200d-1f3a4","1f469-1f3fe-200d-1f3a4","1f469-1f3ff-200d-1f3a4"],a:"4"},{n:["artist","palette"],u:"1f9d1-200d-1f3a8",v:["1f9d1-1f3fb-200d-1f3a8","1f9d1-1f3fc-200d-1f3a8","1f9d1-1f3fd-200d-1f3a8","1f9d1-1f3fe-200d-1f3a8","1f9d1-1f3ff-200d-1f3a8"],a:"12.1"},{n:["man","artist","palette","man artist"],u:"1f468-200d-1f3a8",v:["1f468-1f3fb-200d-1f3a8","1f468-1f3fc-200d-1f3a8","1f468-1f3fd-200d-1f3a8","1f468-1f3fe-200d-1f3a8","1f468-1f3ff-200d-1f3a8"],a:"4"},{n:["woman","artist","palette","woman artist"],u:"1f469-200d-1f3a8",v:["1f469-1f3fb-200d-1f3a8","1f469-1f3fc-200d-1f3a8","1f469-1f3fd-200d-1f3a8","1f469-1f3fe-200d-1f3a8","1f469-1f3ff-200d-1f3a8"],a:"4"},{n:["pilot","plane"],u:"1f9d1-200d-2708-fe0f",v:["1f9d1-1f3fb-200d-2708-fe0f","1f9d1-1f3fc-200d-2708-fe0f","1f9d1-1f3fd-200d-2708-fe0f","1f9d1-1f3fe-200d-2708-fe0f","1f9d1-1f3ff-200d-2708-fe0f"],a:"12.1"},{n:["man","pilot","plane","man pilot"],u:"1f468-200d-2708-fe0f",v:["1f468-1f3fb-200d-2708-fe0f","1f468-1f3fc-200d-2708-fe0f","1f468-1f3fd-200d-2708-fe0f","1f468-1f3fe-200d-2708-fe0f","1f468-1f3ff-200d-2708-fe0f"],a:"4"},{n:["pilot","plane","woman","woman pilot"],u:"1f469-200d-2708-fe0f",v:["1f469-1f3fb-200d-2708-fe0f","1f469-1f3fc-200d-2708-fe0f","1f469-1f3fd-200d-2708-fe0f","1f469-1f3fe-200d-2708-fe0f","1f469-1f3ff-200d-2708-fe0f"],a:"4"},{n:["rocket","astronaut"],u:"1f9d1-200d-1f680",v:["1f9d1-1f3fb-200d-1f680","1f9d1-1f3fc-200d-1f680","1f9d1-1f3fd-200d-1f680","1f9d1-1f3fe-200d-1f680","1f9d1-1f3ff-200d-1f680"],a:"12.1"},{n:["man","rocket","astronaut","man astronaut"],u:"1f468-200d-1f680",v:["1f468-1f3fb-200d-1f680","1f468-1f3fc-200d-1f680","1f468-1f3fd-200d-1f680","1f468-1f3fe-200d-1f680","1f468-1f3ff-200d-1f680"],a:"4"},{n:["woman","rocket","astronaut","woman astronaut"],u:"1f469-200d-1f680",v:["1f469-1f3fb-200d-1f680","1f469-1f3fc-200d-1f680","1f469-1f3fd-200d-1f680","1f469-1f3fe-200d-1f680","1f469-1f3ff-200d-1f680"],a:"4"},{n:["fire","firetruck","firefighter"],u:"1f9d1-200d-1f692",v:["1f9d1-1f3fb-200d-1f692","1f9d1-1f3fc-200d-1f692","1f9d1-1f3fd-200d-1f692","1f9d1-1f3fe-200d-1f692","1f9d1-1f3ff-200d-1f692"],a:"12.1"},{n:["man","firetruck","firefighter","man firefighter"],u:"1f468-200d-1f692",v:["1f468-1f3fb-200d-1f692","1f468-1f3fc-200d-1f692","1f468-1f3fd-200d-1f692","1f468-1f3fe-200d-1f692","1f468-1f3ff-200d-1f692"],a:"4"},{n:["woman","firetruck","firefighter","woman firefighter"],u:"1f469-200d-1f692",v:["1f469-1f3fb-200d-1f692","1f469-1f3fc-200d-1f692","1f469-1f3fd-200d-1f692","1f469-1f3fe-200d-1f692","1f469-1f3ff-200d-1f692"],a:"4"},{n:["cop","police","officer","police officer"],u:"1f46e",v:["1f46e-1f3fb","1f46e-1f3fc","1f46e-1f3fd","1f46e-1f3fe","1f46e-1f3ff"],a:"0.6"},{n:["cop","man","police","officer","man police officer"],u:"1f46e-200d-2642-fe0f",v:["1f46e-1f3fb-200d-2642-fe0f","1f46e-1f3fc-200d-2642-fe0f","1f46e-1f3fd-200d-2642-fe0f","1f46e-1f3fe-200d-2642-fe0f","1f46e-1f3ff-200d-2642-fe0f"],a:"4"},{n:["cop","woman","police","officer","woman police officer"],u:"1f46e-200d-2640-fe0f",v:["1f46e-1f3fb-200d-2640-fe0f","1f46e-1f3fc-200d-2640-fe0f","1f46e-1f3fd-200d-2640-fe0f","1f46e-1f3fe-200d-2640-fe0f","1f46e-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","spy","sleuth","detective","man detective"],u:"1f575-fe0f-200d-2642-fe0f",v:["1f575-1f3fb-200d-2642-fe0f","1f575-1f3fc-200d-2642-fe0f","1f575-1f3fd-200d-2642-fe0f","1f575-1f3fe-200d-2642-fe0f","1f575-1f3ff-200d-2642-fe0f"],a:"4"},{n:["spy","woman","sleuth","detective","woman detective"],u:"1f575-fe0f-200d-2640-fe0f",v:["1f575-1f3fb-200d-2640-fe0f","1f575-1f3fc-200d-2640-fe0f","1f575-1f3fd-200d-2640-fe0f","1f575-1f3fe-200d-2640-fe0f","1f575-1f3ff-200d-2640-fe0f"],a:"4"},{n:["guard"],u:"1f482",v:["1f482-1f3fb","1f482-1f3fc","1f482-1f3fd","1f482-1f3fe","1f482-1f3ff"],a:"0.6"},{n:["man","guard","man guard"],u:"1f482-200d-2642-fe0f",v:["1f482-1f3fb-200d-2642-fe0f","1f482-1f3fc-200d-2642-fe0f","1f482-1f3fd-200d-2642-fe0f","1f482-1f3fe-200d-2642-fe0f","1f482-1f3ff-200d-2642-fe0f"],a:"4"},{n:["guard","woman","woman guard"],u:"1f482-200d-2640-fe0f",v:["1f482-1f3fb-200d-2640-fe0f","1f482-1f3fc-200d-2640-fe0f","1f482-1f3fd-200d-2640-fe0f","1f482-1f3fe-200d-2640-fe0f","1f482-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ninja","hidden","fighter","stealth"],u:"1f977",v:["1f977-1f3fb","1f977-1f3fc","1f977-1f3fd","1f977-1f3fe","1f977-1f3ff"],a:"13"},{n:["hat","worker","construction","construction worker"],u:"1f477",v:["1f477-1f3fb","1f477-1f3fc","1f477-1f3fd","1f477-1f3fe","1f477-1f3ff"],a:"0.6"},{n:["man","worker","construction","man construction worker"],u:"1f477-200d-2642-fe0f",v:["1f477-1f3fb-200d-2642-fe0f","1f477-1f3fc-200d-2642-fe0f","1f477-1f3fd-200d-2642-fe0f","1f477-1f3fe-200d-2642-fe0f","1f477-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","worker","construction","woman construction worker"],u:"1f477-200d-2640-fe0f",v:["1f477-1f3fb-200d-2640-fe0f","1f477-1f3fc-200d-2640-fe0f","1f477-1f3fd-200d-2640-fe0f","1f477-1f3fe-200d-2640-fe0f","1f477-1f3ff-200d-2640-fe0f"],a:"4"},{n:["noble","regal","monarch","royalty","person with crown"],u:"1fac5",v:["1fac5-1f3fb","1fac5-1f3fc","1fac5-1f3fd","1fac5-1f3fe","1fac5-1f3ff"],a:"14"},{n:["prince"],u:"1f934",v:["1f934-1f3fb","1f934-1f3fc","1f934-1f3fd","1f934-1f3fe","1f934-1f3ff"],a:"3"},{n:["fantasy","princess","fairy tale"],u:"1f478",v:["1f478-1f3fb","1f478-1f3fc","1f478-1f3fd","1f478-1f3fe","1f478-1f3ff"],a:"0.6"},{n:["turban","person wearing turban"],u:"1f473",v:["1f473-1f3fb","1f473-1f3fc","1f473-1f3fd","1f473-1f3fe","1f473-1f3ff"],a:"0.6"},{n:["man","turban","man wearing turban"],u:"1f473-200d-2642-fe0f",v:["1f473-1f3fb-200d-2642-fe0f","1f473-1f3fc-200d-2642-fe0f","1f473-1f3fd-200d-2642-fe0f","1f473-1f3fe-200d-2642-fe0f","1f473-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","turban","woman wearing turban"],u:"1f473-200d-2640-fe0f",v:["1f473-1f3fb-200d-2640-fe0f","1f473-1f3fc-200d-2640-fe0f","1f473-1f3fd-200d-2640-fe0f","1f473-1f3fe-200d-2640-fe0f","1f473-1f3ff-200d-2640-fe0f"],a:"4"},{n:["cap","hat","person","skullcap","gua pi mao","person with skullcap"],u:"1f472",v:["1f472-1f3fb","1f472-1f3fc","1f472-1f3fd","1f472-1f3fe","1f472-1f3ff"],a:"0.6"},{n:["hijab","tichel","mantilla","headscarf","woman with headscarf"],u:"1f9d5",v:["1f9d5-1f3fb","1f9d5-1f3fc","1f9d5-1f3fd","1f9d5-1f3fe","1f9d5-1f3ff"],a:"5"},{n:["groom","person","tuxedo","person in tuxedo"],u:"1f935",v:["1f935-1f3fb","1f935-1f3fc","1f935-1f3fd","1f935-1f3fe","1f935-1f3ff"],a:"3"},{n:["man","tuxedo","man in tuxedo"],u:"1f935-200d-2642-fe0f",v:["1f935-1f3fb-200d-2642-fe0f","1f935-1f3fc-200d-2642-fe0f","1f935-1f3fd-200d-2642-fe0f","1f935-1f3fe-200d-2642-fe0f","1f935-1f3ff-200d-2642-fe0f"],a:"13"},{n:["woman","tuxedo","woman in tuxedo"],u:"1f935-200d-2640-fe0f",v:["1f935-1f3fb-200d-2640-fe0f","1f935-1f3fc-200d-2640-fe0f","1f935-1f3fd-200d-2640-fe0f","1f935-1f3fe-200d-2640-fe0f","1f935-1f3ff-200d-2640-fe0f"],a:"13"},{n:["veil","bride","person","wedding","person with veil"],u:"1f470",v:["1f470-1f3fb","1f470-1f3fc","1f470-1f3fd","1f470-1f3fe","1f470-1f3ff"],a:"0.6"},{n:["man","veil","man with veil"],u:"1f470-200d-2642-fe0f",v:["1f470-1f3fb-200d-2642-fe0f","1f470-1f3fc-200d-2642-fe0f","1f470-1f3fd-200d-2642-fe0f","1f470-1f3fe-200d-2642-fe0f","1f470-1f3ff-200d-2642-fe0f"],a:"13"},{n:["veil","woman","woman with veil"],u:"1f470-200d-2640-fe0f",v:["1f470-1f3fb-200d-2640-fe0f","1f470-1f3fc-200d-2640-fe0f","1f470-1f3fd-200d-2640-fe0f","1f470-1f3fe-200d-2640-fe0f","1f470-1f3ff-200d-2640-fe0f"],a:"13"},{n:["woman","pregnant","pregnant woman"],u:"1f930",v:["1f930-1f3fb","1f930-1f3fc","1f930-1f3fd","1f930-1f3fe","1f930-1f3ff"],a:"3"},{n:["full","belly","bloated","pregnant","pregnant man"],u:"1fac3",v:["1fac3-1f3fb","1fac3-1f3fc","1fac3-1f3fd","1fac3-1f3fe","1fac3-1f3ff"],a:"14"},{n:["full","belly","bloated","pregnant","pregnant person"],u:"1fac4",v:["1fac4-1f3fb","1fac4-1f3fc","1fac4-1f3fd","1fac4-1f3fe","1fac4-1f3ff"],a:"14"},{n:["baby","breast","nursing","breast feeding"],u:"1f931",v:["1f931-1f3fb","1f931-1f3fc","1f931-1f3fd","1f931-1f3fe","1f931-1f3ff"],a:"5"},{n:["baby","woman","feeding","nursing","woman feeding baby"],u:"1f469-200d-1f37c",v:["1f469-1f3fb-200d-1f37c","1f469-1f3fc-200d-1f37c","1f469-1f3fd-200d-1f37c","1f469-1f3fe-200d-1f37c","1f469-1f3ff-200d-1f37c"],a:"13"},{n:["man","baby","feeding","nursing","man feeding baby"],u:"1f468-200d-1f37c",v:["1f468-1f3fb-200d-1f37c","1f468-1f3fc-200d-1f37c","1f468-1f3fd-200d-1f37c","1f468-1f3fe-200d-1f37c","1f468-1f3ff-200d-1f37c"],a:"13"},{n:["baby","person","feeding","nursing","person feeding baby"],u:"1f9d1-200d-1f37c",v:["1f9d1-1f3fb-200d-1f37c","1f9d1-1f3fc-200d-1f37c","1f9d1-1f3fd-200d-1f37c","1f9d1-1f3fe-200d-1f37c","1f9d1-1f3ff-200d-1f37c"],a:"13"},{n:["baby","face","angel","fantasy","baby angel","fairy tale"],u:"1f47c",v:["1f47c-1f3fb","1f47c-1f3fc","1f47c-1f3fd","1f47c-1f3fe","1f47c-1f3ff"],a:"0.6"},{n:["claus","santa","father","christmas","Santa Claus","celebration"],u:"1f385",v:["1f385-1f3fb","1f385-1f3fc","1f385-1f3fd","1f385-1f3fe","1f385-1f3ff"],a:"0.6"},{n:["mrs.","claus","mother","christmas","Mrs. Claus","celebration"],u:"1f936",v:["1f936-1f3fb","1f936-1f3fc","1f936-1f3fd","1f936-1f3fe","1f936-1f3ff"],a:"3"},{n:["claus","mx claus","christmas"],u:"1f9d1-200d-1f384",v:["1f9d1-1f3fb-200d-1f384","1f9d1-1f3fc-200d-1f384","1f9d1-1f3fd-200d-1f384","1f9d1-1f3fe-200d-1f384","1f9d1-1f3ff-200d-1f384"],a:"13"},{n:["good","hero","heroine","superhero","superpower"],u:"1f9b8",v:["1f9b8-1f3fb","1f9b8-1f3fc","1f9b8-1f3fd","1f9b8-1f3fe","1f9b8-1f3ff"],a:"11"},{n:["man","good","hero","superpower","man superhero"],u:"1f9b8-200d-2642-fe0f",v:["1f9b8-1f3fb-200d-2642-fe0f","1f9b8-1f3fc-200d-2642-fe0f","1f9b8-1f3fd-200d-2642-fe0f","1f9b8-1f3fe-200d-2642-fe0f","1f9b8-1f3ff-200d-2642-fe0f"],a:"11"},{n:["good","hero","woman","heroine","superpower","woman superhero"],u:"1f9b8-200d-2640-fe0f",v:["1f9b8-1f3fb-200d-2640-fe0f","1f9b8-1f3fc-200d-2640-fe0f","1f9b8-1f3fd-200d-2640-fe0f","1f9b8-1f3fe-200d-2640-fe0f","1f9b8-1f3ff-200d-2640-fe0f"],a:"11"},{n:["evil","villain","criminal","superpower","supervillain"],u:"1f9b9",v:["1f9b9-1f3fb","1f9b9-1f3fc","1f9b9-1f3fd","1f9b9-1f3fe","1f9b9-1f3ff"],a:"11"},{n:["man","evil","villain","criminal","superpower","man supervillain"],u:"1f9b9-200d-2642-fe0f",v:["1f9b9-1f3fb-200d-2642-fe0f","1f9b9-1f3fc-200d-2642-fe0f","1f9b9-1f3fd-200d-2642-fe0f","1f9b9-1f3fe-200d-2642-fe0f","1f9b9-1f3ff-200d-2642-fe0f"],a:"11"},{n:["evil","woman","villain","criminal","superpower","woman supervillain"],u:"1f9b9-200d-2640-fe0f",v:["1f9b9-1f3fb-200d-2640-fe0f","1f9b9-1f3fc-200d-2640-fe0f","1f9b9-1f3fd-200d-2640-fe0f","1f9b9-1f3fe-200d-2640-fe0f","1f9b9-1f3ff-200d-2640-fe0f"],a:"11"},{n:["mage","witch","wizard","sorcerer","sorceress"],u:"1f9d9",v:["1f9d9-1f3fb","1f9d9-1f3fc","1f9d9-1f3fd","1f9d9-1f3fe","1f9d9-1f3ff"],a:"5"},{n:["wizard","man mage","sorcerer"],u:"1f9d9-200d-2642-fe0f",v:["1f9d9-1f3fb-200d-2642-fe0f","1f9d9-1f3fc-200d-2642-fe0f","1f9d9-1f3fd-200d-2642-fe0f","1f9d9-1f3fe-200d-2642-fe0f","1f9d9-1f3ff-200d-2642-fe0f"],a:"5"},{n:["witch","sorceress","woman mage"],u:"1f9d9-200d-2640-fe0f",v:["1f9d9-1f3fb-200d-2640-fe0f","1f9d9-1f3fc-200d-2640-fe0f","1f9d9-1f3fd-200d-2640-fe0f","1f9d9-1f3fe-200d-2640-fe0f","1f9d9-1f3ff-200d-2640-fe0f"],a:"5"},{n:["puck","fairy","oberon","titania"],u:"1f9da",v:["1f9da-1f3fb","1f9da-1f3fc","1f9da-1f3fd","1f9da-1f3fe","1f9da-1f3ff"],a:"5"},{n:["puck","oberon","man fairy"],u:"1f9da-200d-2642-fe0f",v:["1f9da-1f3fb-200d-2642-fe0f","1f9da-1f3fc-200d-2642-fe0f","1f9da-1f3fd-200d-2642-fe0f","1f9da-1f3fe-200d-2642-fe0f","1f9da-1f3ff-200d-2642-fe0f"],a:"5"},{n:["titania","woman fairy"],u:"1f9da-200d-2640-fe0f",v:["1f9da-1f3fb-200d-2640-fe0f","1f9da-1f3fc-200d-2640-fe0f","1f9da-1f3fd-200d-2640-fe0f","1f9da-1f3fe-200d-2640-fe0f","1f9da-1f3ff-200d-2640-fe0f"],a:"5"},{n:["undead","vampire","dracula"],u:"1f9db",v:["1f9db-1f3fb","1f9db-1f3fc","1f9db-1f3fd","1f9db-1f3fe","1f9db-1f3ff"],a:"5"},{n:["undead","dracula","man vampire"],u:"1f9db-200d-2642-fe0f",v:["1f9db-1f3fb-200d-2642-fe0f","1f9db-1f3fc-200d-2642-fe0f","1f9db-1f3fd-200d-2642-fe0f","1f9db-1f3fe-200d-2642-fe0f","1f9db-1f3ff-200d-2642-fe0f"],a:"5"},{n:["undead","woman vampire"],u:"1f9db-200d-2640-fe0f",v:["1f9db-1f3fb-200d-2640-fe0f","1f9db-1f3fc-200d-2640-fe0f","1f9db-1f3fd-200d-2640-fe0f","1f9db-1f3fe-200d-2640-fe0f","1f9db-1f3ff-200d-2640-fe0f"],a:"5"},{n:["merman","mermaid","merwoman","merperson"],u:"1f9dc",v:["1f9dc-1f3fb","1f9dc-1f3fc","1f9dc-1f3fd","1f9dc-1f3fe","1f9dc-1f3ff"],a:"5"},{n:["merman","triton"],u:"1f9dc-200d-2642-fe0f",v:["1f9dc-1f3fb-200d-2642-fe0f","1f9dc-1f3fc-200d-2642-fe0f","1f9dc-1f3fd-200d-2642-fe0f","1f9dc-1f3fe-200d-2642-fe0f","1f9dc-1f3ff-200d-2642-fe0f"],a:"5"},{n:["mermaid","merwoman"],u:"1f9dc-200d-2640-fe0f",v:["1f9dc-1f3fb-200d-2640-fe0f","1f9dc-1f3fc-200d-2640-fe0f","1f9dc-1f3fd-200d-2640-fe0f","1f9dc-1f3fe-200d-2640-fe0f","1f9dc-1f3ff-200d-2640-fe0f"],a:"5"},{n:["elf","magical"],u:"1f9dd",v:["1f9dd-1f3fb","1f9dd-1f3fc","1f9dd-1f3fd","1f9dd-1f3fe","1f9dd-1f3ff"],a:"5"},{n:["man elf","magical"],u:"1f9dd-200d-2642-fe0f",v:["1f9dd-1f3fb-200d-2642-fe0f","1f9dd-1f3fc-200d-2642-fe0f","1f9dd-1f3fd-200d-2642-fe0f","1f9dd-1f3fe-200d-2642-fe0f","1f9dd-1f3ff-200d-2642-fe0f"],a:"5"},{n:["magical","woman elf"],u:"1f9dd-200d-2640-fe0f",v:["1f9dd-1f3fb-200d-2640-fe0f","1f9dd-1f3fc-200d-2640-fe0f","1f9dd-1f3fd-200d-2640-fe0f","1f9dd-1f3fe-200d-2640-fe0f","1f9dd-1f3ff-200d-2640-fe0f"],a:"5"},{n:["genie","djinn"],u:"1f9de",a:"5"},{n:["djinn","man genie"],u:"1f9de-200d-2642-fe0f",a:"5"},{n:["djinn","woman genie"],u:"1f9de-200d-2640-fe0f",a:"5"},{n:["zombie","undead","walking dead"],u:"1f9df",a:"5"},{n:["undead","man zombie","walking dead"],u:"1f9df-200d-2642-fe0f",a:"5"},{n:["undead","woman zombie","walking dead"],u:"1f9df-200d-2640-fe0f",a:"5"},{n:["troll","fantasy","monster","fairy tale"],u:"1f9cc",a:"14"},{n:["face","salon","massage","person getting massage"],u:"1f486",v:["1f486-1f3fb","1f486-1f3fc","1f486-1f3fd","1f486-1f3fe","1f486-1f3ff"],a:"0.6"},{n:["man","face","massage","man getting massage"],u:"1f486-200d-2642-fe0f",v:["1f486-1f3fb-200d-2642-fe0f","1f486-1f3fc-200d-2642-fe0f","1f486-1f3fd-200d-2642-fe0f","1f486-1f3fe-200d-2642-fe0f","1f486-1f3ff-200d-2642-fe0f"],a:"4"},{n:["face","woman","massage","woman getting massage"],u:"1f486-200d-2640-fe0f",v:["1f486-1f3fb-200d-2640-fe0f","1f486-1f3fc-200d-2640-fe0f","1f486-1f3fd-200d-2640-fe0f","1f486-1f3fe-200d-2640-fe0f","1f486-1f3ff-200d-2640-fe0f"],a:"4"},{n:["barber","beauty","parlor","haircut","person getting haircut"],u:"1f487",v:["1f487-1f3fb","1f487-1f3fc","1f487-1f3fd","1f487-1f3fe","1f487-1f3ff"],a:"0.6"},{n:["man","haircut","man getting haircut"],u:"1f487-200d-2642-fe0f",v:["1f487-1f3fb-200d-2642-fe0f","1f487-1f3fc-200d-2642-fe0f","1f487-1f3fd-200d-2642-fe0f","1f487-1f3fe-200d-2642-fe0f","1f487-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","haircut","woman getting haircut"],u:"1f487-200d-2640-fe0f",v:["1f487-1f3fb-200d-2640-fe0f","1f487-1f3fc-200d-2640-fe0f","1f487-1f3fd-200d-2640-fe0f","1f487-1f3fe-200d-2640-fe0f","1f487-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hike","walk","walking","person walking"],u:"1f6b6",v:["1f6b6-1f3fb","1f6b6-1f3fc","1f6b6-1f3fd","1f6b6-1f3fe","1f6b6-1f3ff"],a:"0.6"},{n:["man","hike","walk","man walking"],u:"1f6b6-200d-2642-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f","1f6b6-1f3fc-200d-2642-fe0f","1f6b6-1f3fd-200d-2642-fe0f","1f6b6-1f3fe-200d-2642-fe0f","1f6b6-1f3ff-200d-2642-fe0f"],a:"4"},{n:["hike","walk","woman","woman walking"],u:"1f6b6-200d-2640-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f","1f6b6-1f3fc-200d-2640-fe0f","1f6b6-1f3fd-200d-2640-fe0f","1f6b6-1f3fe-200d-2640-fe0f","1f6b6-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hike","walk","walking","person walking","person walking facing right"],u:"1f6b6-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-27a1-fe0f","1f6b6-1f3fc-200d-27a1-fe0f","1f6b6-1f3fd-200d-27a1-fe0f","1f6b6-1f3fe-200d-27a1-fe0f","1f6b6-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["hike","walk","woman","woman walking","woman walking facing right"],u:"1f6b6-200d-2640-fe0f-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man","hike","walk","man walking","man walking facing right"],u:"1f6b6-200d-2642-fe0f-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["stand","standing","person standing"],u:"1f9cd",v:["1f9cd-1f3fb","1f9cd-1f3fc","1f9cd-1f3fd","1f9cd-1f3fe","1f9cd-1f3ff"],a:"12"},{n:["man","standing","man standing"],u:"1f9cd-200d-2642-fe0f",v:["1f9cd-1f3fb-200d-2642-fe0f","1f9cd-1f3fc-200d-2642-fe0f","1f9cd-1f3fd-200d-2642-fe0f","1f9cd-1f3fe-200d-2642-fe0f","1f9cd-1f3ff-200d-2642-fe0f"],a:"12"},{n:["woman","standing","woman standing"],u:"1f9cd-200d-2640-fe0f",v:["1f9cd-1f3fb-200d-2640-fe0f","1f9cd-1f3fc-200d-2640-fe0f","1f9cd-1f3fd-200d-2640-fe0f","1f9cd-1f3fe-200d-2640-fe0f","1f9cd-1f3ff-200d-2640-fe0f"],a:"12"},{n:["kneel","kneeling","person kneeling"],u:"1f9ce",v:["1f9ce-1f3fb","1f9ce-1f3fc","1f9ce-1f3fd","1f9ce-1f3fe","1f9ce-1f3ff"],a:"12"},{n:["man","kneeling","man kneeling"],u:"1f9ce-200d-2642-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f","1f9ce-1f3fc-200d-2642-fe0f","1f9ce-1f3fd-200d-2642-fe0f","1f9ce-1f3fe-200d-2642-fe0f","1f9ce-1f3ff-200d-2642-fe0f"],a:"12"},{n:["woman","kneeling","woman kneeling"],u:"1f9ce-200d-2640-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f","1f9ce-1f3fc-200d-2640-fe0f","1f9ce-1f3fd-200d-2640-fe0f","1f9ce-1f3fe-200d-2640-fe0f","1f9ce-1f3ff-200d-2640-fe0f"],a:"12"},{n:["kneel","kneeling","person kneeling","person kneeling facing right"],u:"1f9ce-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-27a1-fe0f","1f9ce-1f3fc-200d-27a1-fe0f","1f9ce-1f3fd-200d-27a1-fe0f","1f9ce-1f3fe-200d-27a1-fe0f","1f9ce-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman","kneeling","woman kneeling facing right"],u:"1f9ce-200d-2640-fe0f-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man","kneeling","man kneeling facing right"],u:"1f9ce-200d-2642-fe0f-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["blind","accessibility","person with white cane"],u:"1f9d1-200d-1f9af",v:["1f9d1-1f3fb-200d-1f9af","1f9d1-1f3fc-200d-1f9af","1f9d1-1f3fd-200d-1f9af","1f9d1-1f3fe-200d-1f9af","1f9d1-1f3ff-200d-1f9af"],a:"12.1"},{n:["blind","accessibility","person with white cane","person with white cane facing right"],u:"1f9d1-200d-1f9af-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["man","blind","accessibility","man with white cane"],u:"1f468-200d-1f9af",v:["1f468-1f3fb-200d-1f9af","1f468-1f3fc-200d-1f9af","1f468-1f3fd-200d-1f9af","1f468-1f3fe-200d-1f9af","1f468-1f3ff-200d-1f9af"],a:"12"},{n:["man","blind","accessibility","man with white cane","man with white cane facing right"],u:"1f468-200d-1f9af-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9af-200d-27a1-fe0f","1f468-1f3fc-200d-1f9af-200d-27a1-fe0f","1f468-1f3fd-200d-1f9af-200d-27a1-fe0f","1f468-1f3fe-200d-1f9af-200d-27a1-fe0f","1f468-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["blind","woman","accessibility","woman with white cane"],u:"1f469-200d-1f9af",v:["1f469-1f3fb-200d-1f9af","1f469-1f3fc-200d-1f9af","1f469-1f3fd-200d-1f9af","1f469-1f3fe-200d-1f9af","1f469-1f3ff-200d-1f9af"],a:"12"},{n:["blind","woman","accessibility","woman with white cane","woman with white cane facing right"],u:"1f469-200d-1f9af-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9af-200d-27a1-fe0f","1f469-1f3fc-200d-1f9af-200d-27a1-fe0f","1f469-1f3fd-200d-1f9af-200d-27a1-fe0f","1f469-1f3fe-200d-1f9af-200d-27a1-fe0f","1f469-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["wheelchair","accessibility","person in motorized wheelchair"],u:"1f9d1-200d-1f9bc",v:["1f9d1-1f3fb-200d-1f9bc","1f9d1-1f3fc-200d-1f9bc","1f9d1-1f3fd-200d-1f9bc","1f9d1-1f3fe-200d-1f9bc","1f9d1-1f3ff-200d-1f9bc"],a:"12.1"},{n:["wheelchair","accessibility","person in motorized wheelchair","person in motorized wheelchair facing right"],u:"1f9d1-200d-1f9bc-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["man","wheelchair","accessibility","man in motorized wheelchair"],u:"1f468-200d-1f9bc",v:["1f468-1f3fb-200d-1f9bc","1f468-1f3fc-200d-1f9bc","1f468-1f3fd-200d-1f9bc","1f468-1f3fe-200d-1f9bc","1f468-1f3ff-200d-1f9bc"],a:"12"},{n:["man","wheelchair","accessibility","man in motorized wheelchair","man in motorized wheelchair facing right"],u:"1f468-200d-1f9bc-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f468-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["woman","wheelchair","accessibility","woman in motorized wheelchair"],u:"1f469-200d-1f9bc",v:["1f469-1f3fb-200d-1f9bc","1f469-1f3fc-200d-1f9bc","1f469-1f3fd-200d-1f9bc","1f469-1f3fe-200d-1f9bc","1f469-1f3ff-200d-1f9bc"],a:"12"},{n:["woman","wheelchair","accessibility","woman in motorized wheelchair","woman in motorized wheelchair facing right"],u:"1f469-200d-1f9bc-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f469-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["wheelchair","accessibility","person in manual wheelchair"],u:"1f9d1-200d-1f9bd",v:["1f9d1-1f3fb-200d-1f9bd","1f9d1-1f3fc-200d-1f9bd","1f9d1-1f3fd-200d-1f9bd","1f9d1-1f3fe-200d-1f9bd","1f9d1-1f3ff-200d-1f9bd"],a:"12.1"},{n:["wheelchair","accessibility","person in manual wheelchair","person in manual wheelchair facing right"],u:"1f9d1-200d-1f9bd-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["man","wheelchair","accessibility","man in manual wheelchair"],u:"1f468-200d-1f9bd",v:["1f468-1f3fb-200d-1f9bd","1f468-1f3fc-200d-1f9bd","1f468-1f3fd-200d-1f9bd","1f468-1f3fe-200d-1f9bd","1f468-1f3ff-200d-1f9bd"],a:"12"},{n:["man","wheelchair","accessibility","man in manual wheelchair","man in manual wheelchair facing right"],u:"1f468-200d-1f9bd-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f468-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["woman","wheelchair","accessibility","woman in manual wheelchair"],u:"1f469-200d-1f9bd",v:["1f469-1f3fb-200d-1f9bd","1f469-1f3fc-200d-1f9bd","1f469-1f3fd-200d-1f9bd","1f469-1f3fe-200d-1f9bd","1f469-1f3ff-200d-1f9bd"],a:"12"},{n:["woman","wheelchair","accessibility","woman in manual wheelchair","woman in manual wheelchair facing right"],u:"1f469-200d-1f9bd-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f469-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["running","marathon","person running"],u:"1f3c3",v:["1f3c3-1f3fb","1f3c3-1f3fc","1f3c3-1f3fd","1f3c3-1f3fe","1f3c3-1f3ff"],a:"0.6"},{n:["man","racing","running","marathon","man running"],u:"1f3c3-200d-2642-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f","1f3c3-1f3fc-200d-2642-fe0f","1f3c3-1f3fd-200d-2642-fe0f","1f3c3-1f3fe-200d-2642-fe0f","1f3c3-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","racing","running","marathon","woman running"],u:"1f3c3-200d-2640-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f","1f3c3-1f3fc-200d-2640-fe0f","1f3c3-1f3fd-200d-2640-fe0f","1f3c3-1f3fe-200d-2640-fe0f","1f3c3-1f3ff-200d-2640-fe0f"],a:"4"},{n:["running","marathon","person running","person running facing right"],u:"1f3c3-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-27a1-fe0f","1f3c3-1f3fc-200d-27a1-fe0f","1f3c3-1f3fd-200d-27a1-fe0f","1f3c3-1f3fe-200d-27a1-fe0f","1f3c3-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman","racing","running","marathon","woman running facing right"],u:"1f3c3-200d-2640-fe0f-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man","racing","running","marathon","man running facing right"],u:"1f3c3-200d-2642-fe0f-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["dance","woman","dancing","woman dancing"],u:"1f483",v:["1f483-1f3fb","1f483-1f3fc","1f483-1f3fd","1f483-1f3fe","1f483-1f3ff"],a:"0.6"},{n:["man","dance","dancing","man dancing"],u:"1f57a",v:["1f57a-1f3fb","1f57a-1f3fc","1f57a-1f3fd","1f57a-1f3fe","1f57a-1f3ff"],a:"3"},{n:["dancer","partying","bunny ear","people with bunny ears"],u:"1f46f",a:"0.6"},{n:["men","dancer","partying","bunny ear","men with bunny ears"],u:"1f46f-200d-2642-fe0f",a:"4"},{n:["women","dancer","partying","bunny ear","women with bunny ears"],u:"1f46f-200d-2640-fe0f",a:"4"},{n:["sauna","steam room","person in steamy room"],u:"1f9d6",v:["1f9d6-1f3fb","1f9d6-1f3fc","1f9d6-1f3fd","1f9d6-1f3fe","1f9d6-1f3ff"],a:"5"},{n:["sauna","steam room","man in steamy room"],u:"1f9d6-200d-2642-fe0f",v:["1f9d6-1f3fb-200d-2642-fe0f","1f9d6-1f3fc-200d-2642-fe0f","1f9d6-1f3fd-200d-2642-fe0f","1f9d6-1f3fe-200d-2642-fe0f","1f9d6-1f3ff-200d-2642-fe0f"],a:"5"},{n:["sauna","steam room","woman in steamy room"],u:"1f9d6-200d-2640-fe0f",v:["1f9d6-1f3fb-200d-2640-fe0f","1f9d6-1f3fc-200d-2640-fe0f","1f9d6-1f3fd-200d-2640-fe0f","1f9d6-1f3fe-200d-2640-fe0f","1f9d6-1f3ff-200d-2640-fe0f"],a:"5"},{n:["climber","person climbing"],u:"1f9d7",v:["1f9d7-1f3fb","1f9d7-1f3fc","1f9d7-1f3fd","1f9d7-1f3fe","1f9d7-1f3ff"],a:"5"},{n:["climber","man climbing"],u:"1f9d7-200d-2642-fe0f",v:["1f9d7-1f3fb-200d-2642-fe0f","1f9d7-1f3fc-200d-2642-fe0f","1f9d7-1f3fd-200d-2642-fe0f","1f9d7-1f3fe-200d-2642-fe0f","1f9d7-1f3ff-200d-2642-fe0f"],a:"5"},{n:["climber","woman climbing"],u:"1f9d7-200d-2640-fe0f",v:["1f9d7-1f3fb-200d-2640-fe0f","1f9d7-1f3fc-200d-2640-fe0f","1f9d7-1f3fd-200d-2640-fe0f","1f9d7-1f3fe-200d-2640-fe0f","1f9d7-1f3ff-200d-2640-fe0f"],a:"5"},{n:["sword","fencer","fencing","person fencing"],u:"1f93a",a:"3"},{n:["horse","jockey","racing","racehorse","horse racing"],u:"1f3c7",v:["1f3c7-1f3fb","1f3c7-1f3fc","1f3c7-1f3fd","1f3c7-1f3fe","1f3c7-1f3ff"],a:"1"},{n:["ski","snow","snowboard","snowboarder"],u:"1f3c2",v:["1f3c2-1f3fb","1f3c2-1f3fc","1f3c2-1f3fd","1f3c2-1f3fe","1f3c2-1f3ff"],a:"0.6"},{n:["man","golf","man golfing"],u:"1f3cc-fe0f-200d-2642-fe0f",v:["1f3cc-1f3fb-200d-2642-fe0f","1f3cc-1f3fc-200d-2642-fe0f","1f3cc-1f3fd-200d-2642-fe0f","1f3cc-1f3fe-200d-2642-fe0f","1f3cc-1f3ff-200d-2642-fe0f"],a:"4"},{n:["golf","woman","woman golfing"],u:"1f3cc-fe0f-200d-2640-fe0f",v:["1f3cc-1f3fb-200d-2640-fe0f","1f3cc-1f3fc-200d-2640-fe0f","1f3cc-1f3fd-200d-2640-fe0f","1f3cc-1f3fe-200d-2640-fe0f","1f3cc-1f3ff-200d-2640-fe0f"],a:"4"},{n:["surfing","person surfing"],u:"1f3c4",v:["1f3c4-1f3fb","1f3c4-1f3fc","1f3c4-1f3fd","1f3c4-1f3fe","1f3c4-1f3ff"],a:"0.6"},{n:["man","surfing","man surfing"],u:"1f3c4-200d-2642-fe0f",v:["1f3c4-1f3fb-200d-2642-fe0f","1f3c4-1f3fc-200d-2642-fe0f","1f3c4-1f3fd-200d-2642-fe0f","1f3c4-1f3fe-200d-2642-fe0f","1f3c4-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","surfing","woman surfing"],u:"1f3c4-200d-2640-fe0f",v:["1f3c4-1f3fb-200d-2640-fe0f","1f3c4-1f3fc-200d-2640-fe0f","1f3c4-1f3fd-200d-2640-fe0f","1f3c4-1f3fe-200d-2640-fe0f","1f3c4-1f3ff-200d-2640-fe0f"],a:"4"},{n:["boat","rowboat","person rowing boat"],u:"1f6a3",v:["1f6a3-1f3fb","1f6a3-1f3fc","1f6a3-1f3fd","1f6a3-1f3fe","1f6a3-1f3ff"],a:"1"},{n:["man","boat","rowboat","man rowing boat"],u:"1f6a3-200d-2642-fe0f",v:["1f6a3-1f3fb-200d-2642-fe0f","1f6a3-1f3fc-200d-2642-fe0f","1f6a3-1f3fd-200d-2642-fe0f","1f6a3-1f3fe-200d-2642-fe0f","1f6a3-1f3ff-200d-2642-fe0f"],a:"4"},{n:["boat","woman","rowboat","woman rowing boat"],u:"1f6a3-200d-2640-fe0f",v:["1f6a3-1f3fb-200d-2640-fe0f","1f6a3-1f3fc-200d-2640-fe0f","1f6a3-1f3fd-200d-2640-fe0f","1f6a3-1f3fe-200d-2640-fe0f","1f6a3-1f3ff-200d-2640-fe0f"],a:"4"},{n:["swim","person swimming"],u:"1f3ca",v:["1f3ca-1f3fb","1f3ca-1f3fc","1f3ca-1f3fd","1f3ca-1f3fe","1f3ca-1f3ff"],a:"0.6"},{n:["man","swim","man swimming"],u:"1f3ca-200d-2642-fe0f",v:["1f3ca-1f3fb-200d-2642-fe0f","1f3ca-1f3fc-200d-2642-fe0f","1f3ca-1f3fd-200d-2642-fe0f","1f3ca-1f3fe-200d-2642-fe0f","1f3ca-1f3ff-200d-2642-fe0f"],a:"4"},{n:["swim","woman","woman swimming"],u:"1f3ca-200d-2640-fe0f",v:["1f3ca-1f3fb-200d-2640-fe0f","1f3ca-1f3fc-200d-2640-fe0f","1f3ca-1f3fd-200d-2640-fe0f","1f3ca-1f3fe-200d-2640-fe0f","1f3ca-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","ball","man bouncing ball"],u:"26f9-fe0f-200d-2642-fe0f",v:["26f9-1f3fb-200d-2642-fe0f","26f9-1f3fc-200d-2642-fe0f","26f9-1f3fd-200d-2642-fe0f","26f9-1f3fe-200d-2642-fe0f","26f9-1f3ff-200d-2642-fe0f"],a:"4"},{n:["ball","woman","woman bouncing ball"],u:"26f9-fe0f-200d-2640-fe0f",v:["26f9-1f3fb-200d-2640-fe0f","26f9-1f3fc-200d-2640-fe0f","26f9-1f3fd-200d-2640-fe0f","26f9-1f3fe-200d-2640-fe0f","26f9-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","weight lifter","man lifting weights"],u:"1f3cb-fe0f-200d-2642-fe0f",v:["1f3cb-1f3fb-200d-2642-fe0f","1f3cb-1f3fc-200d-2642-fe0f","1f3cb-1f3fd-200d-2642-fe0f","1f3cb-1f3fe-200d-2642-fe0f","1f3cb-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","weight lifter","woman lifting weights"],u:"1f3cb-fe0f-200d-2640-fe0f",v:["1f3cb-1f3fb-200d-2640-fe0f","1f3cb-1f3fc-200d-2640-fe0f","1f3cb-1f3fd-200d-2640-fe0f","1f3cb-1f3fe-200d-2640-fe0f","1f3cb-1f3ff-200d-2640-fe0f"],a:"4"},{n:["biking","bicycle","cyclist","person biking"],u:"1f6b4",v:["1f6b4-1f3fb","1f6b4-1f3fc","1f6b4-1f3fd","1f6b4-1f3fe","1f6b4-1f3ff"],a:"1"},{n:["man","biking","bicycle","cyclist","man biking"],u:"1f6b4-200d-2642-fe0f",v:["1f6b4-1f3fb-200d-2642-fe0f","1f6b4-1f3fc-200d-2642-fe0f","1f6b4-1f3fd-200d-2642-fe0f","1f6b4-1f3fe-200d-2642-fe0f","1f6b4-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","biking","bicycle","cyclist","woman biking"],u:"1f6b4-200d-2640-fe0f",v:["1f6b4-1f3fb-200d-2640-fe0f","1f6b4-1f3fc-200d-2640-fe0f","1f6b4-1f3fd-200d-2640-fe0f","1f6b4-1f3fe-200d-2640-fe0f","1f6b4-1f3ff-200d-2640-fe0f"],a:"4"},{n:["bike","bicycle","cyclist","mountain","bicyclist","person mountain biking"],u:"1f6b5",v:["1f6b5-1f3fb","1f6b5-1f3fc","1f6b5-1f3fd","1f6b5-1f3fe","1f6b5-1f3ff"],a:"1"},{n:["man","bike","bicycle","cyclist","mountain","man mountain biking"],u:"1f6b5-200d-2642-fe0f",v:["1f6b5-1f3fb-200d-2642-fe0f","1f6b5-1f3fc-200d-2642-fe0f","1f6b5-1f3fd-200d-2642-fe0f","1f6b5-1f3fe-200d-2642-fe0f","1f6b5-1f3ff-200d-2642-fe0f"],a:"4"},{n:["bike","woman","biking","bicycle","cyclist","mountain","woman mountain biking"],u:"1f6b5-200d-2640-fe0f",v:["1f6b5-1f3fb-200d-2640-fe0f","1f6b5-1f3fc-200d-2640-fe0f","1f6b5-1f3fd-200d-2640-fe0f","1f6b5-1f3fe-200d-2640-fe0f","1f6b5-1f3ff-200d-2640-fe0f"],a:"4"},{n:["cartwheel","gymnastics","person cartwheeling"],u:"1f938",v:["1f938-1f3fb","1f938-1f3fc","1f938-1f3fd","1f938-1f3fe","1f938-1f3ff"],a:"3"},{n:["man","cartwheel","gymnastics","man cartwheeling"],u:"1f938-200d-2642-fe0f",v:["1f938-1f3fb-200d-2642-fe0f","1f938-1f3fc-200d-2642-fe0f","1f938-1f3fd-200d-2642-fe0f","1f938-1f3fe-200d-2642-fe0f","1f938-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","cartwheel","gymnastics","woman cartwheeling"],u:"1f938-200d-2640-fe0f",v:["1f938-1f3fb-200d-2640-fe0f","1f938-1f3fc-200d-2640-fe0f","1f938-1f3fd-200d-2640-fe0f","1f938-1f3fe-200d-2640-fe0f","1f938-1f3ff-200d-2640-fe0f"],a:"4"},{n:["wrestle","wrestler","people wrestling"],u:"1f93c",a:"3"},{n:["men","wrestle","men wrestling"],u:"1f93c-200d-2642-fe0f",a:"4"},{n:["women","wrestle","women wrestling"],u:"1f93c-200d-2640-fe0f",a:"4"},{n:["polo","water","person playing water polo"],u:"1f93d",v:["1f93d-1f3fb","1f93d-1f3fc","1f93d-1f3fd","1f93d-1f3fe","1f93d-1f3ff"],a:"3"},{n:["man","water polo","man playing water polo"],u:"1f93d-200d-2642-fe0f",v:["1f93d-1f3fb-200d-2642-fe0f","1f93d-1f3fc-200d-2642-fe0f","1f93d-1f3fd-200d-2642-fe0f","1f93d-1f3fe-200d-2642-fe0f","1f93d-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","water polo","woman playing water polo"],u:"1f93d-200d-2640-fe0f",v:["1f93d-1f3fb-200d-2640-fe0f","1f93d-1f3fc-200d-2640-fe0f","1f93d-1f3fd-200d-2640-fe0f","1f93d-1f3fe-200d-2640-fe0f","1f93d-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ball","handball","person playing handball"],u:"1f93e",v:["1f93e-1f3fb","1f93e-1f3fc","1f93e-1f3fd","1f93e-1f3fe","1f93e-1f3ff"],a:"3"},{n:["man","handball","man playing handball"],u:"1f93e-200d-2642-fe0f",v:["1f93e-1f3fb-200d-2642-fe0f","1f93e-1f3fc-200d-2642-fe0f","1f93e-1f3fd-200d-2642-fe0f","1f93e-1f3fe-200d-2642-fe0f","1f93e-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","handball","woman playing handball"],u:"1f93e-200d-2640-fe0f",v:["1f93e-1f3fb-200d-2640-fe0f","1f93e-1f3fc-200d-2640-fe0f","1f93e-1f3fd-200d-2640-fe0f","1f93e-1f3fe-200d-2640-fe0f","1f93e-1f3ff-200d-2640-fe0f"],a:"4"},{n:["skill","juggle","balance","multitask","person juggling"],u:"1f939",v:["1f939-1f3fb","1f939-1f3fc","1f939-1f3fd","1f939-1f3fe","1f939-1f3ff"],a:"3"},{n:["man","juggling","multitask","man juggling"],u:"1f939-200d-2642-fe0f",v:["1f939-1f3fb-200d-2642-fe0f","1f939-1f3fc-200d-2642-fe0f","1f939-1f3fd-200d-2642-fe0f","1f939-1f3fe-200d-2642-fe0f","1f939-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","juggling","multitask","woman juggling"],u:"1f939-200d-2640-fe0f",v:["1f939-1f3fb-200d-2640-fe0f","1f939-1f3fc-200d-2640-fe0f","1f939-1f3fd-200d-2640-fe0f","1f939-1f3fe-200d-2640-fe0f","1f939-1f3ff-200d-2640-fe0f"],a:"4"},{n:["yoga","meditation","person in lotus position"],u:"1f9d8",v:["1f9d8-1f3fb","1f9d8-1f3fc","1f9d8-1f3fd","1f9d8-1f3fe","1f9d8-1f3ff"],a:"5"},{n:["yoga","meditation","man in lotus position"],u:"1f9d8-200d-2642-fe0f",v:["1f9d8-1f3fb-200d-2642-fe0f","1f9d8-1f3fc-200d-2642-fe0f","1f9d8-1f3fd-200d-2642-fe0f","1f9d8-1f3fe-200d-2642-fe0f","1f9d8-1f3ff-200d-2642-fe0f"],a:"5"},{n:["yoga","meditation","woman in lotus position"],u:"1f9d8-200d-2640-fe0f",v:["1f9d8-1f3fb-200d-2640-fe0f","1f9d8-1f3fc-200d-2640-fe0f","1f9d8-1f3fd-200d-2640-fe0f","1f9d8-1f3fe-200d-2640-fe0f","1f9d8-1f3ff-200d-2640-fe0f"],a:"5"},{n:["bath","bathtub","person taking bath"],u:"1f6c0",v:["1f6c0-1f3fb","1f6c0-1f3fc","1f6c0-1f3fd","1f6c0-1f3fe","1f6c0-1f3ff"],a:"0.6"},{n:["hotel","sleep","good night","person in bed"],u:"1f6cc",v:["1f6cc-1f3fb","1f6cc-1f3fc","1f6cc-1f3fd","1f6cc-1f3fe","1f6cc-1f3ff"],a:"1"},{n:["hand","hold","couple","person","holding hands","people holding hands"],u:"1f9d1-200d-1f91d-200d-1f9d1",v:["1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff"],a:"12"},{n:["hand","women","couple","holding hands","women holding hands"],u:"1f46d",v:["1f46d-1f3fb","1f46d-1f3fc","1f46d-1f3fd","1f46d-1f3fe","1f46d-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe"],a:"1"},{n:["man","hand","hold","woman","couple","holding hands","woman and man holding hands"],u:"1f46b",v:["1f46b-1f3fb","1f46b-1f3fc","1f46b-1f3fd","1f46b-1f3fe","1f46b-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"0.6"},{n:["man","men","twins","couple","gemini","zodiac","holding hands","men holding hands"],u:"1f46c",v:["1f46c-1f3fb","1f46c-1f3fc","1f46c-1f3fd","1f46c-1f3fe","1f46c-1f3ff","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"1"},{n:["kiss","couple"],u:"1f48f",v:["1f48f-1f3fb","1f48f-1f3fc","1f48f-1f3fd","1f48f-1f3fe","1f48f-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe"],a:"0.6"},{n:["man","kiss","woman","couple","kiss: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2"},{n:["man","kiss","couple","kiss: man, man"],u:"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2"},{n:["kiss","woman","couple","kiss: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff"],a:"2"},{n:["love","couple","couple with heart"],u:"1f491",v:["1f491-1f3fb","1f491-1f3fc","1f491-1f3fd","1f491-1f3fe","1f491-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fe"],a:"0.6"},{n:["man","love","woman","couple","couple with heart","couple with heart: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2"},{n:["man","love","couple","couple with heart","couple with heart: man, man"],u:"1f468-200d-2764-fe0f-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2"},{n:["love","woman","couple","couple with heart","couple with heart: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3ff"],a:"2"},{n:["boy","man","woman","family","family: man, woman, boy"],u:"1f468-200d-1f469-200d-1f466",a:"2"},{n:["man","girl","woman","family","family: man, woman, girl"],u:"1f468-200d-1f469-200d-1f467",a:"2"},{n:["boy","man","girl","woman","family","family: man, woman, girl, boy"],u:"1f468-200d-1f469-200d-1f467-200d-1f466",a:"2"},{n:["boy","man","woman","family","family: man, woman, boy, boy"],u:"1f468-200d-1f469-200d-1f466-200d-1f466",a:"2"},{n:["man","girl","woman","family","family: man, woman, girl, girl"],u:"1f468-200d-1f469-200d-1f467-200d-1f467",a:"2"},{n:["boy","man","family","family: man, man, boy"],u:"1f468-200d-1f468-200d-1f466",a:"2"},{n:["man","girl","family","family: man, man, girl"],u:"1f468-200d-1f468-200d-1f467",a:"2"},{n:["boy","man","girl","family","family: man, man, girl, boy"],u:"1f468-200d-1f468-200d-1f467-200d-1f466",a:"2"},{n:["boy","man","family","family: man, man, boy, boy"],u:"1f468-200d-1f468-200d-1f466-200d-1f466",a:"2"},{n:["man","girl","family","family: man, man, girl, girl"],u:"1f468-200d-1f468-200d-1f467-200d-1f467",a:"2"},{n:["boy","woman","family","family: woman, woman, boy"],u:"1f469-200d-1f469-200d-1f466",a:"2"},{n:["girl","woman","family","family: woman, woman, girl"],u:"1f469-200d-1f469-200d-1f467",a:"2"},{n:["boy","girl","woman","family","family: woman, woman, girl, boy"],u:"1f469-200d-1f469-200d-1f467-200d-1f466",a:"2"},{n:["boy","woman","family","family: woman, woman, boy, boy"],u:"1f469-200d-1f469-200d-1f466-200d-1f466",a:"2"},{n:["girl","woman","family","family: woman, woman, girl, girl"],u:"1f469-200d-1f469-200d-1f467-200d-1f467",a:"2"},{n:["boy","man","family","family: man, boy"],u:"1f468-200d-1f466",a:"4"},{n:["boy","man","family","family: man, boy, boy"],u:"1f468-200d-1f466-200d-1f466",a:"4"},{n:["man","girl","family","family: man, girl"],u:"1f468-200d-1f467",a:"4"},{n:["boy","man","girl","family","family: man, girl, boy"],u:"1f468-200d-1f467-200d-1f466",a:"4"},{n:["man","girl","family","family: man, girl, girl"],u:"1f468-200d-1f467-200d-1f467",a:"4"},{n:["boy","woman","family","family: woman, boy"],u:"1f469-200d-1f466",a:"4"},{n:["boy","woman","family","family: woman, boy, boy"],u:"1f469-200d-1f466-200d-1f466",a:"4"},{n:["girl","woman","family","family: woman, girl"],u:"1f469-200d-1f467",a:"4"},{n:["boy","girl","woman","family","family: woman, girl, boy"],u:"1f469-200d-1f467-200d-1f466",a:"4"},{n:["girl","woman","family","family: woman, girl, girl"],u:"1f469-200d-1f467-200d-1f467",a:"4"},{n:["bust","silhouette","bust in silhouette"],u:"1f464",a:"0.6"},{n:["bust","silhouette","busts in silhouette"],u:"1f465",a:"1"},{n:["hug","hello","thanks","goodbye","people hugging"],u:"1fac2",a:"13"},{n:["family"],u:"1f46a",a:"0.6"},{n:["family: adult, adult, child"],u:"1f9d1-200d-1f9d1-200d-1f9d2",a:"15.1"},{n:["family: adult, adult, child, child"],u:"1f9d1-200d-1f9d1-200d-1f9d2-200d-1f9d2",a:"15.1"},{n:["family: adult, child"],u:"1f9d1-200d-1f9d2",a:"15.1"},{n:["family: adult, child, child"],u:"1f9d1-200d-1f9d2-200d-1f9d2",a:"15.1"},{n:["print","clothing","footprint","footprints"],u:"1f463",a:"0.6"}],animals_nature:[{n:["face","monkey","monkey face"],u:"1f435",a:"0.6"},{n:["monkey"],u:"1f412",a:"0.6"},{n:["gorilla"],u:"1f98d",a:"3"},{n:["ape","orangutan"],u:"1f9a7",a:"12"},{n:["dog","pet","face","dog face"],u:"1f436",a:"0.6"},{n:["dog","pet"],u:"1f415",a:"0.7"},{n:["blind","guide","guide dog","accessibility"],u:"1f9ae",a:"12"},{n:["dog","service","assistance","service dog","accessibility"],u:"1f415-200d-1f9ba",a:"12"},{n:["dog","poodle"],u:"1f429",a:"0.6"},{n:["wolf","face"],u:"1f43a",a:"0.6"},{n:["fox","face"],u:"1f98a",a:"3"},{n:["sly","raccoon","curious"],u:"1f99d",a:"11"},{n:["cat","pet","face","cat face"],u:"1f431",a:"0.6"},{n:["cat","pet"],u:"1f408",a:"0.7"},{n:["cat","black","unlucky","black cat"],u:"1f408-200d-2b1b",a:"13"},{n:["leo","lion","face","zodiac"],u:"1f981",a:"1"},{n:["face","tiger","tiger face"],u:"1f42f",a:"0.6"},{n:["tiger"],u:"1f405",a:"1"},{n:["leopard"],u:"1f406",a:"1"},{n:["face","horse","horse face"],u:"1f434",a:"0.6"},{n:["elk","moose","animal","mammal","antlers"],u:"1face",a:"15"},{n:["ass","mule","burro","donkey","animal","mammal","stubborn"],u:"1facf",a:"15"},{n:["horse","racing","racehorse","equestrian"],u:"1f40e",a:"0.6"},{n:["face","unicorn"],u:"1f984",a:"1"},{n:["zebra","stripe"],u:"1f993",a:"5"},{n:["deer"],u:"1f98c",a:"3"},{n:["herd","bison","wisent","buffalo"],u:"1f9ac",a:"13"},{n:["cow","face","cow face"],u:"1f42e",a:"0.6"},{n:["ox","bull","taurus","zodiac"],u:"1f402",a:"1"},{n:["water","buffalo","water buffalo"],u:"1f403",a:"1"},{n:["cow"],u:"1f404",a:"1"},{n:["pig","face","pig face"],u:"1f437",a:"0.6"},{n:["pig","sow"],u:"1f416",a:"1"},{n:["pig","boar"],u:"1f417",a:"0.6"},{n:["pig","face","nose","pig nose"],u:"1f43d",a:"0.6"},{n:["ram","male","aries","sheep","zodiac"],u:"1f40f",a:"1"},{n:["ewe","sheep","female"],u:"1f411",a:"0.6"},{n:["goat","zodiac","capricorn"],u:"1f410",a:"1"},{n:["hump","camel","dromedary"],u:"1f42a",a:"1"},{n:["hump","camel","bactrian","two hump camel"],u:"1f42b",a:"0.6"},{n:["wool","llama","alpaca","vicua","guanaco"],u:"1f999",a:"11"},{n:["spots","giraffe"],u:"1f992",a:"5"},{n:["elephant"],u:"1f418",a:"0.6"},{n:["tusk","large","woolly","mammoth","extinction"],u:"1f9a3",a:"13"},{n:["rhinoceros"],u:"1f98f",a:"3"},{n:["hippo","hippopotamus"],u:"1f99b",a:"11"},{n:["face","mouse","mouse face"],u:"1f42d",a:"0.6"},{n:["mouse"],u:"1f401",a:"1"},{n:["rat"],u:"1f400",a:"1"},{n:["pet","face","hamster"],u:"1f439",a:"0.6"},{n:["pet","face","bunny","rabbit","rabbit face"],u:"1f430",a:"0.6"},{n:["pet","bunny","rabbit"],u:"1f407",a:"1"},{n:["dam","beaver"],u:"1f9ab",a:"13"},{n:["spiny","hedgehog"],u:"1f994",a:"5"},{n:["bat","vampire"],u:"1f987",a:"3"},{n:["bear","face"],u:"1f43b",a:"0.6"},{n:["bear","white","arctic","polar bear"],u:"1f43b-200d-2744-fe0f",a:"13"},{n:["face","koala","marsupial"],u:"1f428",a:"0.6"},{n:["face","panda"],u:"1f43c",a:"0.6"},{n:["lazy","slow","sloth"],u:"1f9a5",a:"12"},{n:["otter","fishing","playful"],u:"1f9a6",a:"12"},{n:["skunk","stink"],u:"1f9a8",a:"12"},{n:["joey","jump","kangaroo","marsupial"],u:"1f998",a:"11"},{n:["badger","pester","honey badger"],u:"1f9a1",a:"11"},{n:["paw","feet","print","paw prints"],u:"1f43e",a:"0.6"},{n:["bird","turkey"],u:"1f983",a:"1"},{n:["bird","chicken"],u:"1f414",a:"0.6"},{n:["bird","rooster"],u:"1f413",a:"1"},{n:["baby","bird","chick","hatching","hatching chick"],u:"1f423",a:"0.6"},{n:["baby","bird","chick","baby chick"],u:"1f424",a:"0.6"},{n:["baby","bird","chick","front facing baby chick"],u:"1f425",a:"0.6"},{n:["bird"],u:"1f426",a:"0.6"},{n:["bird","penguin"],u:"1f427",a:"0.6"},{n:["bird","eagle"],u:"1f985",a:"3"},{n:["duck","bird"],u:"1f986",a:"3"},{n:["swan","bird","cygnet","ugly duckling"],u:"1f9a2",a:"11"},{n:["owl","bird","wise"],u:"1f989",a:"3"},{n:["dodo","large","mauritius","extinction"],u:"1f9a4",a:"13"},{n:["bird","light","flight","feather","plumage"],u:"1fab6",a:"13"},{n:["flamingo","tropical","flamboyant"],u:"1f9a9",a:"12"},{n:["bird","proud","peahen","peacock","ostentatious"],u:"1f99a",a:"11"},{n:["bird","talk","parrot","pirate"],u:"1f99c",a:"11"},{n:["wing","bird","flying","angelic","aviation","mythology"],u:"1fabd",a:"15"},{n:["bird","crow","rook","black","raven","black bird"],u:"1f426-200d-2b1b",a:"15"},{n:["bird","fowl","honk","goose","silly"],u:"1fabf",a:"15"},{n:["phoenix","fantasy","rebirth","firebird","reincarnation"],u:"1f426-200d-1f525",a:"15.1"},{n:["frog","face"],u:"1f438",a:"0.6"},{n:["crocodile"],u:"1f40a",a:"1"},{n:["turtle","terrapin","tortoise"],u:"1f422",a:"0.6"},{n:["lizard","reptile"],u:"1f98e",a:"3"},{n:["snake","bearer","zodiac","serpent","ophiuchus"],u:"1f40d",a:"0.6"},{n:["face","dragon","fairy tale","dragon face"],u:"1f432",a:"0.6"},{n:["dragon","fairy tale"],u:"1f409",a:"1"},{n:["sauropod","diplodocus","brontosaurus","brachiosaurus"],u:"1f995",a:"5"},{n:["T Rex","t rex","tyrannosaurus rex"],u:"1f996",a:"5"},{n:["face","whale","spouting","spouting whale"],u:"1f433",a:"0.6"},{n:["whale"],u:"1f40b",a:"1"},{n:["dolphin","flipper"],u:"1f42c",a:"0.6"},{n:["seal","sea lion"],u:"1f9ad",a:"13"},{n:["fish","pisces","zodiac"],u:"1f41f",a:"0.6"},{n:["fish","tropical","tropical fish"],u:"1f420",a:"0.6"},{n:["fish","blowfish"],u:"1f421",a:"0.6"},{n:["fish","shark"],u:"1f988",a:"3"},{n:["octopus"],u:"1f419",a:"0.6"},{n:["shell","spiral","spiral shell"],u:"1f41a",a:"0.6"},{n:["reef","coral","ocean"],u:"1fab8",a:"14"},{n:["burn","ouch","jelly","marine","stinger","jellyfish","invertebrate"],u:"1fabc",a:"15"},{n:["snail"],u:"1f40c",a:"0.6"},{n:["insect","pretty","butterfly"],u:"1f98b",a:"3"},{n:["bug","insect"],u:"1f41b",a:"0.6"},{n:["ant","insect"],u:"1f41c",a:"0.6"},{n:["bee","insect","honeybee"],u:"1f41d",a:"0.6"},{n:["bug","beetle","insect"],u:"1fab2",a:"13"},{n:["beetle","insect","ladybug","ladybird","lady beetle"],u:"1f41e",a:"0.6"},{n:["cricket","grasshopper"],u:"1f997",a:"5"},{n:["pest","roach","insect","cockroach"],u:"1fab3",a:"13"},{n:["zodiac","scorpio","scorpion"],u:"1f982",a:"1"},{n:["pest","fever","virus","disease","malaria","mosquito"],u:"1f99f",a:"11"},{n:["fly","pest","maggot","disease","rotting"],u:"1fab0",a:"13"},{n:["worm","annelid","parasite","earthworm"],u:"1fab1",a:"13"},{n:["virus","amoeba","microbe","bacteria"],u:"1f9a0",a:"11"},{n:["flower","bouquet"],u:"1f490",a:"0.6"},{n:["cherry","flower","blossom","cherry blossom"],u:"1f338",a:"0.6"},{n:["flower","white flower"],u:"1f4ae",a:"0.6"},{n:["lotus","flower","purity","buddhism","hinduism"],u:"1fab7",a:"14"},{n:["rose","flower"],u:"1f339",a:"0.6"},{n:["flower","wilted","wilted flower"],u:"1f940",a:"3"},{n:["flower","hibiscus"],u:"1f33a",a:"0.6"},{n:["sun","flower","sunflower"],u:"1f33b",a:"0.6"},{n:["flower","blossom"],u:"1f33c",a:"0.6"},{n:["tulip","flower"],u:"1f337",a:"0.6"},{n:["flower","lupine","hyacinth","lavender","bluebonnet","snapdragon"],u:"1fabb",a:"15"},{n:["young","seedling"],u:"1f331",a:"0.6"},{n:["grow","house","plant","boring","useless","nurturing","potted plant"],u:"1fab4",a:"13"},{n:["tree","evergreen tree"],u:"1f332",a:"1"},{n:["tree","shedding","deciduous","deciduous tree"],u:"1f333",a:"1"},{n:["palm","tree","palm tree"],u:"1f334",a:"0.6"},{n:["plant","cactus"],u:"1f335",a:"0.6"},{n:["ear","rice","grain","sheaf of rice"],u:"1f33e",a:"0.6"},{n:["herb","leaf"],u:"1f33f",a:"0.6"},{n:["4","four","leaf","clover","four leaf clover"],u:"1f340",a:"0.6"},{n:["leaf","maple","falling","maple leaf"],u:"1f341",a:"0.6"},{n:["leaf","falling","fallen leaf"],u:"1f342",a:"0.6"},{n:["blow","leaf","wind","flutter","leaf fluttering in wind"],u:"1f343",a:"0.6"},{n:["nesting","empty nest"],u:"1fab9",a:"14"},{n:["nesting","nest with eggs"],u:"1faba",a:"14"},{n:["mushroom","toadstool"],u:"1f344",a:"0.6"}],food_drink:[{n:["fruit","grape","grapes"],u:"1f347",a:"0.6"},{n:["melon","fruit"],u:"1f348",a:"0.6"},{n:["fruit","watermelon"],u:"1f349",a:"0.6"},{n:["fruit","orange","tangerine"],u:"1f34a",a:"0.6"},{n:["lemon","fruit","citrus"],u:"1f34b",a:"1"},{n:["lime","fruit","citrus","tropical"],u:"1f34b-200d-1f7e9",a:"15.1"},{n:["fruit","banana"],u:"1f34c",a:"0.6"},{n:["fruit","pineapple"],u:"1f34d",a:"0.6"},{n:["mango","fruit","tropical"],u:"1f96d",a:"11"},{n:["red","apple","fruit","red apple"],u:"1f34e",a:"0.6"},{n:["apple","fruit","green","green apple"],u:"1f34f",a:"0.6"},{n:["pear","fruit"],u:"1f350",a:"1"},{n:["peach","fruit"],u:"1f351",a:"0.6"},{n:["red","fruit","cherry","berries","cherries"],u:"1f352",a:"0.6"},{n:["berry","fruit","strawberry"],u:"1f353",a:"0.6"},{n:["blue","berry","bilberry","blueberry","blueberries"],u:"1fad0",a:"13"},{n:["food","kiwi","fruit","kiwi fruit"],u:"1f95d",a:"3"},{n:["fruit","tomato","vegetable"],u:"1f345",a:"0.6"},{n:["food","olive"],u:"1fad2",a:"13"},{n:["palm","coconut","pia colada"],u:"1f965",a:"5"},{n:["food","fruit","avocado"],u:"1f951",a:"3"},{n:["eggplant","aubergine","vegetable"],u:"1f346",a:"0.6"},{n:["food","potato","vegetable"],u:"1f954",a:"3"},{n:["food","carrot","vegetable"],u:"1f955",a:"3"},{n:["ear","corn","maze","maize","ear of corn"],u:"1f33d",a:"0.6"},{n:["pepper","capsicum","vegetable","bell pepper"],u:"1fad1",a:"13"},{n:["food","pickle","cucumber","vegetable"],u:"1f952",a:"3"},{n:["kale","cabbage","lettuce","bok choy","leafy green"],u:"1f96c",a:"11"},{n:["broccoli","wild cabbage"],u:"1f966",a:"5"},{n:["garlic","flavoring"],u:"1f9c4",a:"12"},{n:["onion","flavoring"],u:"1f9c5",a:"12"},{n:["nut","food","peanut","peanuts","vegetable"],u:"1f95c",a:"3"},{n:["food","beans","kidney","legume"],u:"1fad8",a:"14"},{n:["plant","chestnut"],u:"1f330",a:"0.6"},{n:["beer","root","spice","ginger root"],u:"1fada",a:"15"},{n:["pea","pod","beans","legume","pea pod","edamame","vegetable"],u:"1fadb",a:"15"},{n:["food","fungus","nature","vegetable","brown mushroom"],u:"1f344-200d-1f7eb",a:"15.1"},{n:["loaf","bread"],u:"1f35e",a:"0.6"},{n:["food","roll","bread","french","croissant","breakfast"],u:"1f950",a:"3"},{n:["food","bread","french","baguette","baguette bread"],u:"1f956",a:"3"},{n:["naan","pita","arepa","lavash","flatbread"],u:"1fad3",a:"13"},{n:["pretzel","twisted"],u:"1f968",a:"5"},{n:["bagel","bakery","schmear","breakfast"],u:"1f96f",a:"11"},{n:["food","crpe","hotcake","pancake","pancakes","breakfast"],u:"1f95e",a:"3"},{n:["iron","waffle","breakfast","indecisive"],u:"1f9c7",a:"12"},{n:["cheese","cheese wedge"],u:"1f9c0",a:"1"},{n:["bone","meat","meat on bone"],u:"1f356",a:"0.6"},{n:["leg","bone","chicken","poultry","drumstick","poultry leg"],u:"1f357",a:"0.6"},{n:["chop","steak","lambchop","porkchop","cut of meat"],u:"1f969",a:"5"},{n:["food","meat","bacon","breakfast"],u:"1f953",a:"3"},{n:["burger","hamburger"],u:"1f354",a:"0.6"},{n:["fries","french","french fries"],u:"1f35f",a:"0.6"},{n:["pizza","slice","cheese"],u:"1f355",a:"0.6"},{n:["hotdog","hot dog","sausage","frankfurter"],u:"1f32d",a:"1"},{n:["bread","sandwich"],u:"1f96a",a:"5"},{n:["taco","mexican"],u:"1f32e",a:"1"},{n:["wrap","burrito","mexican"],u:"1f32f",a:"1"},{n:["tamale","mexican","wrapped"],u:"1fad4",a:"13"},{n:["food","gyro","kebab","falafel","stuffed","flatbread","stuffed flatbread"],u:"1f959",a:"3"},{n:["falafel","chickpea","meatball"],u:"1f9c6",a:"12"},{n:["egg","food","breakfast"],u:"1f95a",a:"3"},{n:["egg","pan","frying","cooking","breakfast"],u:"1f373",a:"0.6"},{n:["pan","food","paella","shallow","casserole","shallow pan of food"],u:"1f958",a:"3"},{n:["pot","stew","pot of food"],u:"1f372",a:"0.6"},{n:["pot","swiss","fondue","cheese","melted","chocolate"],u:"1fad5",a:"13"},{n:["cereal","congee","breakfast","bowl with spoon"],u:"1f963",a:"5"},{n:["food","green","salad","green salad"],u:"1f957",a:"3"},{n:["popcorn"],u:"1f37f",a:"1"},{n:["dairy","butter"],u:"1f9c8",a:"12"},{n:["salt","shaker","condiment"],u:"1f9c2",a:"11"},{n:["can","canned food"],u:"1f96b",a:"5"},{n:["box","bento","bento box"],u:"1f371",a:"0.6"},{n:["rice","cracker","rice cracker"],u:"1f358",a:"0.6"},{n:["ball","rice","japanese","rice ball"],u:"1f359",a:"0.6"},{n:["rice","cooked","cooked rice"],u:"1f35a",a:"0.6"},{n:["rice","curry","curry rice"],u:"1f35b",a:"0.6"},{n:["bowl","ramen","noodle","steaming","steaming bowl"],u:"1f35c",a:"0.6"},{n:["pasta","spaghetti"],u:"1f35d",a:"0.6"},{n:["sweet","potato","roasted","roasted sweet potato"],u:"1f360",a:"0.6"},{n:["oden","kebab","stick","skewer","seafood"],u:"1f362",a:"0.6"},{n:["sushi"],u:"1f363",a:"0.6"},{n:["fried","prawn","shrimp","tempura","fried shrimp"],u:"1f364",a:"0.6"},{n:["cake","fish","swirl","pastry","fish cake with swirl"],u:"1f365",a:"0.6"},{n:["autumn","yubng","festival","moon cake"],u:"1f96e",a:"11"},{n:["dango","stick","sweet","skewer","dessert","japanese"],u:"1f361",a:"0.6"},{n:["gyza","jiaozi","pierogi","dumpling","empanada","potsticker"],u:"1f95f",a:"5"},{n:["prophecy","fortune cookie"],u:"1f960",a:"5"},{n:["takeout box","oyster pail"],u:"1f961",a:"5"},{n:["crab","cancer","zodiac"],u:"1f980",a:"1"},{n:["claws","bisque","lobster","seafood"],u:"1f99e",a:"11"},{n:["food","small","shrimp","shellfish"],u:"1f990",a:"3"},{n:["food","squid","molusc"],u:"1f991",a:"3"},{n:["pearl","oyster","diving"],u:"1f9aa",a:"12"},{n:["ice","soft","cream","sweet","dessert","icecream","soft ice cream"],u:"1f366",a:"0.6"},{n:["ice","sweet","shaved","dessert","shaved ice"],u:"1f367",a:"0.6"},{n:["ice","cream","sweet","dessert","ice cream"],u:"1f368",a:"0.6"},{n:["donut","sweet","dessert","doughnut","breakfast"],u:"1f369",a:"0.6"},{n:["sweet","cookie","dessert"],u:"1f36a",a:"0.6"},{n:["cake","sweet","pastry","dessert","birthday","celebration","birthday cake"],u:"1f382",a:"0.6"},{n:["cake","slice","sweet","pastry","dessert","shortcake"],u:"1f370",a:"0.6"},{n:["sweet","bakery","cupcake"],u:"1f9c1",a:"11"},{n:["pie","pastry","filling"],u:"1f967",a:"5"},{n:["bar","sweet","dessert","chocolate","chocolate bar"],u:"1f36b",a:"0.6"},{n:["candy","sweet","dessert"],u:"1f36c",a:"0.6"},{n:["candy","sweet","dessert","lollipop"],u:"1f36d",a:"0.6"},{n:["sweet","custard","dessert","pudding"],u:"1f36e",a:"0.6"},{n:["pot","honey","sweet","honeypot","honey pot"],u:"1f36f",a:"0.6"},{n:["baby","milk","drink","bottle","baby bottle"],u:"1f37c",a:"1"},{n:["milk","drink","glass","glass of milk"],u:"1f95b",a:"3"},{n:["hot","tea","drink","coffee","beverage","steaming","hot beverage"],u:"2615",a:"0.6"},{n:["pot","tea","drink","teapot"],u:"1fad6",a:"13"},{n:["cup","tea","drink","teacup","beverage","teacup without handle"],u:"1f375",a:"0.6"},{n:["bar","cup","sake","drink","bottle","beverage"],u:"1f376",a:"0.6"},{n:["bar","cork","drink","bottle","popping","bottle with popping cork"],u:"1f37e",a:"1"},{n:["bar","wine","drink","glass","beverage","wine glass"],u:"1f377",a:"0.6"},{n:["bar","drink","glass","cocktail","cocktail glass"],u:"1f378",a:"0.6"},{n:["bar","drink","tropical","tropical drink"],u:"1f379",a:"0.6"},{n:["bar","mug","beer","drink","beer mug"],u:"1f37a",a:"0.6"},{n:["bar","mug","beer","clink","drink","clinking beer mugs"],u:"1f37b",a:"0.6"},{n:["clink","drink","glass","celebrate","clinking glasses"],u:"1f942",a:"3"},{n:["shot","glass","liquor","whisky","tumbler","tumbler glass"],u:"1f943",a:"3"},{n:["drink","empty","glass","spill","pouring liquid"],u:"1fad7",a:"14"},{n:["soda","juice","cup with straw"],u:"1f964",a:"5"},{n:["tea","milk","pearl","bubble","bubble tea"],u:"1f9cb",a:"13"},{n:["box","juice","straw","sweet","beverage","beverage box"],u:"1f9c3",a:"12"},{n:["mate","drink"],u:"1f9c9",a:"12"},{n:["ice","cold","iceberg","ice cube"],u:"1f9ca",a:"12"},{n:["hashi","chopsticks"],u:"1f962",a:"5"},{n:["fork","knife","cooking","cutlery","fork and knife"],u:"1f374",a:"0.6"},{n:["spoon","tableware"],u:"1f944",a:"3"},{n:["tool","hocho","knife","weapon","cooking","kitchen knife"],u:"1f52a",a:"0.6"},{n:["jar","empty","sauce","store","condiment","container"],u:"1fad9",a:"14"},{n:["jug","drink","zodiac","amphora","cooking","aquarius"],u:"1f3fa",a:"1"}],travel_places:[{n:["earth","globe","world","africa","europe","globe showing Europe Africa","globe showing europe africa"],u:"1f30d",a:"0.7"},{n:["earth","globe","world","americas","globe showing Americas","globe showing americas"],u:"1f30e",a:"0.7"},{n:["asia","earth","globe","world","australia","globe showing Asia Australia","globe showing asia australia"],u:"1f30f",a:"0.6"},{n:["earth","globe","world","meridians","globe with meridians"],u:"1f310",a:"1"},{n:["map","japan","map of Japan","map of japan"],u:"1f5fe",a:"0.6"},{n:["compass","magnetic","navigation","orienteering"],u:"1f9ed",a:"11"},{n:["volcano","eruption","mountain"],u:"1f30b",a:"0.6"},{n:["fuji","mountain","mount fuji"],u:"1f5fb",a:"0.6"},{n:["clay","wall","brick","bricks","mortar"],u:"1f9f1",a:"11"},{n:["rock","heavy","solid","stone","boulder"],u:"1faa8",a:"13"},{n:["log","wood","lumber","timber"],u:"1fab5",a:"13"},{n:["hut","yurt","house","roundhouse"],u:"1f6d6",a:"13"},{n:["home","house"],u:"1f3e0",a:"0.6"},{n:["home","house","garden","house with garden"],u:"1f3e1",a:"0.6"},{n:["building","office building"],u:"1f3e2",a:"0.6"},{n:["post","japanese","Japanese post office","japanese post office"],u:"1f3e3",a:"0.6"},{n:["post","european","post office"],u:"1f3e4",a:"1"},{n:["doctor","hospital","medicine"],u:"1f3e5",a:"0.6"},{n:["bank","building"],u:"1f3e6",a:"0.6"},{n:["hotel","building"],u:"1f3e8",a:"0.6"},{n:["love","hotel","love hotel"],u:"1f3e9",a:"0.6"},{n:["store","convenience","convenience store"],u:"1f3ea",a:"0.6"},{n:["school","building"],u:"1f3eb",a:"0.6"},{n:["store","department","department store"],u:"1f3ec",a:"0.6"},{n:["factory","building"],u:"1f3ed",a:"0.6"},{n:["castle","japanese","Japanese castle"],u:"1f3ef",a:"0.6"},{n:["castle","european"],u:"1f3f0",a:"0.6"},{n:["chapel","wedding","romance"],u:"1f492",a:"0.6"},{n:["tokyo","tower","Tokyo tower"],u:"1f5fc",a:"0.6"},{n:["statue","liberty","Statue of Liberty","statue of liberty"],u:"1f5fd",a:"0.6"},{n:["cross","church","religion","christian"],u:"26ea",a:"0.6"},{n:["islam","mosque","muslim","religion"],u:"1f54c",a:"1"},{n:["hindu","temple","hindu temple"],u:"1f6d5",a:"12"},{n:["jew","jewish","temple","religion","synagogue"],u:"1f54d",a:"1"},{n:["kaaba","islam","muslim","religion"],u:"1f54b",a:"1"},{n:["fountain"],u:"26f2",a:"0.6"},{n:["tent","camping"],u:"26fa",a:"0.6"},{n:["fog","foggy"],u:"1f301",a:"0.6"},{n:["star","night","night with stars"],u:"1f303",a:"0.6"},{n:["sun","morning","sunrise","mountain","sunrise over mountains"],u:"1f304",a:"0.6"},{n:["sun","sunrise","morning"],u:"1f305",a:"0.6"},{n:["city","dusk","sunset","evening","landscape","cityscape at dusk"],u:"1f306",a:"0.6"},{n:["sun","dusk","sunset"],u:"1f307",a:"0.6"},{n:["night","bridge","bridge at night"],u:"1f309",a:"0.6"},{n:["horse","carousel","carousel horse"],u:"1f3a0",a:"0.6"},{n:["play","theme park","amusement park","playground slide"],u:"1f6dd",a:"14"},{n:["wheel","ferris","theme park","ferris wheel","amusement park"],u:"1f3a1",a:"0.6"},{n:["roller","coaster","theme park","roller coaster","amusement park"],u:"1f3a2",a:"0.6"},{n:["pole","barber","haircut","barber pole"],u:"1f488",a:"0.6"},{n:["tent","circus","circus tent"],u:"1f3aa",a:"0.6"},{n:["steam","train","engine","railway","locomotive"],u:"1f682",a:"1"},{n:["car","tram","train","railway","electric","trolleybus","railway car"],u:"1f683",a:"0.6"},{n:["speed","train","railway","shinkansen","high speed train"],u:"1f684",a:"0.6"},{n:["speed","train","bullet","railway","shinkansen","bullet train"],u:"1f685",a:"0.6"},{n:["train","railway"],u:"1f686",a:"1"},{n:["metro","subway"],u:"1f687",a:"0.6"},{n:["railway","light rail"],u:"1f688",a:"1"},{n:["train","station","railway"],u:"1f689",a:"0.6"},{n:["tram","trolleybus"],u:"1f68a",a:"1"},{n:["vehicle","monorail"],u:"1f69d",a:"1"},{n:["car","railway","mountain","mountain railway"],u:"1f69e",a:"1"},{n:["car","tram","tram car","trolleybus"],u:"1f68b",a:"1"},{n:["bus","vehicle"],u:"1f68c",a:"0.6"},{n:["bus","oncoming","oncoming bus"],u:"1f68d",a:"0.7"},{n:["bus","tram","trolley","trolleybus"],u:"1f68e",a:"1"},{n:["bus","minibus"],u:"1f690",a:"1"},{n:["vehicle","ambulance"],u:"1f691",a:"0.6"},{n:["fire","truck","engine","fire engine"],u:"1f692",a:"0.6"},{n:["car","patrol","police","police car"],u:"1f693",a:"0.6"},{n:["car","police","oncoming","oncoming police car"],u:"1f694",a:"0.7"},{n:["taxi","vehicle"],u:"1f695",a:"0.6"},{n:["taxi","oncoming","oncoming taxi"],u:"1f696",a:"1"},{n:["car","automobile"],u:"1f697",a:"0.6"},{n:["car","oncoming","automobile","oncoming automobile"],u:"1f698",a:"0.7"},{n:["recreational","sport utility","sport utility vehicle"],u:"1f699",a:"0.6"},{n:["truck","pickup","pick up","pickup truck"],u:"1f6fb",a:"13"},{n:["truck","delivery","delivery truck"],u:"1f69a",a:"0.6"},{n:["semi","lorry","truck","articulated lorry"],u:"1f69b",a:"1"},{n:["tractor","vehicle"],u:"1f69c",a:"1"},{n:["motor","scooter","motor scooter"],u:"1f6f5",a:"3"},{n:["accessibility","manual wheelchair"],u:"1f9bd",a:"12"},{n:["accessibility","motorized wheelchair"],u:"1f9bc",a:"12"},{n:["tuk tuk","auto rickshaw"],u:"1f6fa",a:"12"},{n:["bike","bicycle"],u:"1f6b2",a:"0.6"},{n:["kick","scooter","kick scooter"],u:"1f6f4",a:"3"},{n:["board","skateboard"],u:"1f6f9",a:"11"},{n:["skate","roller","roller skate"],u:"1f6fc",a:"13"},{n:["bus","stop","bus stop"],u:"1f68f",a:"0.6"},{n:["gas","fuel","pump","diesel","station","fuelpump","fuel pump"],u:"26fd",a:"0.6"},{n:["tire","turn","wheel","circle"],u:"1f6de",a:"14"},{n:["car","light","beacon","police","revolving","police car light"],u:"1f6a8",a:"0.6"},{n:["light","signal","traffic","horizontal traffic light"],u:"1f6a5",a:"0.6"},{n:["light","signal","traffic","vertical traffic light"],u:"1f6a6",a:"1"},{n:["sign","stop","stop sign","octagonal"],u:"1f6d1",a:"3"},{n:["barrier","construction"],u:"1f6a7",a:"0.6"},{n:["ship","tool","anchor"],u:"2693",a:"0.6"},{n:["float","rescue","safety","ring buoy","life saver","life preserver"],u:"1f6df",a:"14"},{n:["sea","boat","yacht","resort","sailboat"],u:"26f5",a:"0.6"},{n:["boat","canoe"],u:"1f6f6",a:"3"},{n:["boat","speedboat"],u:"1f6a4",a:"0.6"},{n:["ship","boat","passenger"],u:"1f6a2",a:"0.6"},{n:["airplane","check in","aeroplane","departure","departures","airplane departure"],u:"1f6eb",a:"1"},{n:["landing","airplane","arrivals","arriving","aeroplane","airplane arrival"],u:"1f6ec",a:"1"},{n:["skydive","parasail","parachute","hang glide"],u:"1fa82",a:"12"},{n:["seat","chair"],u:"1f4ba",a:"0.6"},{n:["vehicle","helicopter"],u:"1f681",a:"1"},{n:["railway","suspension","suspension railway"],u:"1f69f",a:"1"},{n:["cable","gondola","mountain","mountain cableway"],u:"1f6a0",a:"1"},{n:["car","cable","aerial","gondola","tramway","aerial tramway"],u:"1f6a1",a:"1"},{n:["space","rocket"],u:"1f680",a:"0.6"},{n:["ufo","flying saucer"],u:"1f6f8",a:"5"},{n:["travel","luggage","packing"],u:"1f9f3",a:"11"},{n:["sand","timer","hourglass done"],u:"231b",a:"0.6"},{n:["sand","timer","hourglass","hourglass not done"],u:"23f3",a:"0.6"},{n:["watch","clock"],u:"231a",a:"0.6"},{n:["alarm","clock","alarm clock"],u:"23f0",a:"0.6"},{n:["00","12","12:00","clock","twelve","oclock","twelve oclock"],u:"1f55b",a:"0.6"},{n:["12","12:30","clock","thirty","twelve","twelve thirty"],u:"1f567",a:"0.7"},{n:["1","00","one","1:00","clock","oclock","one oclock"],u:"1f550",a:"0.6"},{n:["1","one","1:30","clock","thirty","one thirty"],u:"1f55c",a:"0.7"},{n:["2","00","two","2:00","clock","oclock","two oclock"],u:"1f551",a:"0.6"},{n:["2","two","2:30","clock","thirty","two thirty"],u:"1f55d",a:"0.7"},{n:["3","00","3:00","clock","three","oclock","three oclock"],u:"1f552",a:"0.6"},{n:["3","3:30","clock","three","thirty","three thirty"],u:"1f55e",a:"0.7"},{n:["4","00","4:00","four","clock","oclock","four oclock"],u:"1f553",a:"0.6"},{n:["4","4:30","four","clock","thirty","four thirty"],u:"1f55f",a:"0.7"},{n:["5","00","5:00","five","clock","oclock","five oclock"],u:"1f554",a:"0.6"},{n:["5","5:30","five","clock","thirty","five thirty"],u:"1f560",a:"0.7"},{n:["6","00","six","6:00","clock","oclock","six oclock"],u:"1f555",a:"0.6"},{n:["6","six","6:30","clock","thirty","six thirty"],u:"1f561",a:"0.7"},{n:["7","00","7:00","clock","seven","oclock","seven oclock"],u:"1f556",a:"0.6"},{n:["7","7:30","clock","seven","thirty","seven thirty"],u:"1f562",a:"0.7"},{n:["8","00","8:00","clock","eight","oclock","eight oclock"],u:"1f557",a:"0.6"},{n:["8","8:30","clock","eight","thirty","eight thirty"],u:"1f563",a:"0.7"},{n:["9","00","9:00","nine","clock","oclock","nine oclock"],u:"1f558",a:"0.6"},{n:["9","9:30","nine","clock","thirty","nine thirty"],u:"1f564",a:"0.7"},{n:["00","10","ten","10:00","clock","oclock","ten oclock"],u:"1f559",a:"0.6"},{n:["10","ten","10:30","clock","thirty","ten thirty"],u:"1f565",a:"0.7"},{n:["00","11","11:00","clock","eleven","oclock","eleven oclock"],u:"1f55a",a:"0.6"},{n:["11","11:30","clock","eleven","thirty","eleven thirty"],u:"1f566",a:"0.7"},{n:["dark","moon","new moon"],u:"1f311",a:"0.6"},{n:["moon","waxing","crescent","waxing crescent moon"],u:"1f312",a:"1"},{n:["moon","quarter","first quarter moon"],u:"1f313",a:"0.6"},{n:["moon","waxing","gibbous","waxing gibbous moon"],u:"1f314",a:"0.6"},{n:["full","moon","full moon"],u:"1f315",a:"0.6"},{n:["moon","waning","gibbous","waning gibbous moon"],u:"1f316",a:"1"},{n:["moon","quarter","last quarter moon"],u:"1f317",a:"1"},{n:["moon","waning","crescent","waning crescent moon"],u:"1f318",a:"1"},{n:["moon","crescent","crescent moon"],u:"1f319",a:"0.6"},{n:["face","moon","new moon face"],u:"1f31a",a:"1"},{n:["face","moon","quarter","first quarter moon face"],u:"1f31b",a:"0.6"},{n:["face","moon","quarter","last quarter moon face"],u:"1f31c",a:"0.7"},{n:["face","full","moon","bright","full moon face"],u:"1f31d",a:"1"},{n:["sun","face","bright","sun with face"],u:"1f31e",a:"1"},{n:["saturn","saturnine","ringed planet"],u:"1fa90",a:"12"},{n:["star"],u:"2b50",a:"0.6"},{n:["glow","star","shining","sparkle","glittery","glowing star"],u:"1f31f",a:"0.6"},{n:["star","falling","shooting","shooting star"],u:"1f320",a:"0.6"},{n:["space","milky way"],u:"1f30c",a:"0.6"},{n:["sun","cloud","sun behind cloud"],u:"26c5",a:"0.6"},{n:["dizzy","cyclone","twister","typhoon","hurricane"],u:"1f300",a:"0.6"},{n:["rain","rainbow"],u:"1f308",a:"0.6"},{n:["rain","clothing","umbrella","closed umbrella"],u:"1f302",a:"0.6"},{n:["drop","rain","clothing","umbrella","umbrella with rain drops"],u:"2614",a:"0.6"},{n:["zap","danger","voltage","electric","lightning","high voltage"],u:"26a1",a:"0.6"},{n:["cold","snow","snowman","snowman without snow"],u:"26c4",a:"0.6"},{n:["fire","tool","flame"],u:"1f525",a:"0.6"},{n:["cold","drop","comic","sweat","droplet"],u:"1f4a7",a:"0.6"},{n:["wave","ocean","water","water wave"],u:"1f30a",a:"0.6"}],activities:[{n:["jack","lantern","halloween","celebration","jack o lantern"],u:"1f383",a:"0.6"},{n:["tree","christmas","celebration","Christmas tree"],u:"1f384",a:"0.6"},{n:["fireworks","celebration"],u:"1f386",a:"0.6"},{n:["sparkle","sparkler","fireworks","celebration"],u:"1f387",a:"0.6"},{n:["dynamite","explosive","fireworks","firecracker"],u:"1f9e8",a:"11"},{n:["*","star","sparkle","sparkles"],u:"2728",a:"0.6"},{n:["balloon","celebration"],u:"1f388",a:"0.6"},{n:["tada","party","popper","celebration","party popper"],u:"1f389",a:"0.6"},{n:["ball","confetti","celebration","confetti ball"],u:"1f38a",a:"0.6"},{n:["tree","banner","japanese","celebration","tanabata tree"],u:"1f38b",a:"0.6"},{n:["pine","bamboo","japanese","celebration","pine decoration"],u:"1f38d",a:"0.6"},{n:["doll","festival","japanese","celebration","Japanese dolls","japanese dolls"],u:"1f38e",a:"0.6"},{n:["carp","streamer","celebration","carp streamer"],u:"1f38f",a:"0.6"},{n:["bell","wind","chime","wind chime","celebration"],u:"1f390",a:"0.6"},{n:["moon","ceremony","celebration","moon viewing ceremony"],u:"1f391",a:"0.6"},{n:["gift","money","hngbo","lai see","good luck","red envelope"],u:"1f9e7",a:"11"},{n:["ribbon","celebration"],u:"1f380",a:"0.6"},{n:["box","gift","present","wrapped","celebration","wrapped gift"],u:"1f381",a:"0.6"},{n:["ticket","admission"],u:"1f3ab",a:"0.6"},{n:["prize","trophy"],u:"1f3c6",a:"0.6"},{n:["medal","sports medal"],u:"1f3c5",a:"1"},{n:["gold","first","medal","1st place medal"],u:"1f947",a:"3"},{n:["medal","second","silver","2nd place medal"],u:"1f948",a:"3"},{n:["medal","third","bronze","3rd place medal"],u:"1f949",a:"3"},{n:["ball","soccer","football","soccer ball"],u:"26bd",a:"0.6"},{n:["ball","baseball"],u:"26be",a:"0.6"},{n:["ball","glove","softball","underarm"],u:"1f94e",a:"11"},{n:["ball","hoop","basketball"],u:"1f3c0",a:"0.6"},{n:["ball","game","volleyball"],u:"1f3d0",a:"1"},{n:["ball","american","football","american football"],u:"1f3c8",a:"0.6"},{n:["ball","rugby","football","rugby football"],u:"1f3c9",a:"1"},{n:["ball","tennis","racquet"],u:"1f3be",a:"0.6"},{n:["ultimate","flying disc"],u:"1f94f",a:"11"},{n:["ball","game","bowling"],u:"1f3b3",a:"0.6"},{n:["bat","ball","game","cricket game"],u:"1f3cf",a:"1"},{n:["ball","game","field","stick","hockey","field hockey"],u:"1f3d1",a:"1"},{n:["ice","game","puck","stick","hockey","ice hockey"],u:"1f3d2",a:"1"},{n:["ball","goal","stick","lacrosse"],u:"1f94d",a:"11"},{n:["bat","ball","game","paddle","ping pong","table tennis"],u:"1f3d3",a:"1"},{n:["game","birdie","racquet","badminton","shuttlecock"],u:"1f3f8",a:"1"},{n:["glove","boxing","boxing glove"],u:"1f94a",a:"3"},{n:["judo","karate","uniform","taekwondo","martial arts","martial arts uniform"],u:"1f94b",a:"3"},{n:["net","goal","goal net"],u:"1f945",a:"3"},{n:["golf","hole","flag in hole"],u:"26f3",a:"0.6"},{n:["fish","pole","fishing pole"],u:"1f3a3",a:"0.6"},{n:["scuba","diving","snorkeling","diving mask"],u:"1f93f",a:"12"},{n:["sash","shirt","running","athletics","running shirt"],u:"1f3bd",a:"0.6"},{n:["ski","skis","snow"],u:"1f3bf",a:"0.6"},{n:["sled","sledge","sleigh"],u:"1f6f7",a:"5"},{n:["game","rock","curling stone"],u:"1f94c",a:"5"},{n:["hit","dart","game","target","bullseye","direct hit"],u:"1f3af",a:"0.6"},{n:["toy","yo yo","fluctuate"],u:"1fa80",a:"12"},{n:["fly","kite","soar"],u:"1fa81",a:"12"},{n:["gun","tool","water","pistol","weapon","handgun","revolver","water pistol"],u:"1f52b",a:"0.6"},{n:["8","ball","game","eight","billiard","pool 8 ball"],u:"1f3b1",a:"0.6"},{n:["ball","tool","crystal","fantasy","fortune","fairy tale","crystal ball"],u:"1f52e",a:"0.6"},{n:["magic","witch","wizard","magic wand"],u:"1fa84",a:"13"},{n:["game","video game","controller"],u:"1f3ae",a:"0.6"},{n:["game","slot","slot machine"],u:"1f3b0",a:"0.6"},{n:["die","dice","game","game die"],u:"1f3b2",a:"0.6"},{n:["clue","piece","jigsaw","puzzle","puzzle piece","interlocking"],u:"1f9e9",a:"11"},{n:["toy","plush","stuffed","plaything","teddy bear"],u:"1f9f8",a:"11"},{n:["party","piata","celebration"],u:"1fa85",a:"13"},{n:["dance","disco","party","glitter","mirror ball"],u:"1faa9",a:"14"},{n:["doll","russia","nesting","nesting dolls"],u:"1fa86",a:"13"},{n:["card","game","joker","wildcard"],u:"1f0cf",a:"0.6"},{n:["red","game","mahjong","mahjong red dragon"],u:"1f004",a:"0.6"},{n:["card","game","flower","playing","japanese","flower playing cards"],u:"1f3b4",a:"0.6"},{n:["art","mask","theater","theatre","performing","performing arts"],u:"1f3ad",a:"0.6"},{n:["art","museum","palette","painting","artist palette"],u:"1f3a8",a:"0.6"},{n:["spool","thread","needle","sewing","string"],u:"1f9f5",a:"11"},{n:["needle","sewing","sutures","stitches","tailoring","embroidery","sewing needle"],u:"1faa1",a:"13"},{n:["yarn","ball","knit","crochet"],u:"1f9f6",a:"11"},{n:["tie","knot","rope","twine","twist","tangled"],u:"1faa2",a:"13"}],objects:[{n:["eye","glasses","eyewear","clothing","eyeglasses"],u:"1f453",a:"0.6"},{n:["goggles","welding","swimming","eye protection"],u:"1f97d",a:"11"},{n:["doctor","lab coat","scientist","experiment"],u:"1f97c",a:"11"},{n:["vest","safety","emergency","safety vest"],u:"1f9ba",a:"12"},{n:["tie","necktie","clothing"],u:"1f454",a:"0.6"},{n:["shirt","tshirt","t shirt","clothing"],u:"1f455",a:"0.6"},{n:["jeans","pants","clothing","trousers"],u:"1f456",a:"0.6"},{n:["neck","scarf"],u:"1f9e3",a:"5"},{n:["hand","gloves"],u:"1f9e4",a:"5"},{n:["coat","jacket"],u:"1f9e5",a:"5"},{n:["socks","stocking"],u:"1f9e6",a:"5"},{n:["dress","clothing"],u:"1f457",a:"0.6"},{n:["kimono","clothing"],u:"1f458",a:"0.6"},{n:["sari","dress","clothing"],u:"1f97b",a:"12"},{n:["bathing suit","one piece swimsuit"],u:"1fa71",a:"12"},{n:["briefs","swimsuit","one piece","underwear","bathing suit"],u:"1fa72",a:"12"},{n:["pants","shorts","underwear","bathing suit"],u:"1fa73",a:"12"},{n:["swim","bikini","clothing"],u:"1f459",a:"0.6"},{n:["woman","clothing","womans clothes"],u:"1f45a",a:"0.6"},{n:["fan","hot","shy","dance","cooling","flutter","folding hand fan"],u:"1faad",a:"15"},{n:["coin","purse","clothing"],u:"1f45b",a:"0.6"},{n:["bag","purse","handbag","clothing"],u:"1f45c",a:"0.6"},{n:["bag","pouch","clothing","clutch bag"],u:"1f45d",a:"0.6"},{n:["bag","school","satchel","backpack","rucksack"],u:"1f392",a:"0.6"},{n:["zri","thongs","sandals","thong sandal","beach sandals","thong sandals"],u:"1fa74",a:"13"},{n:["man","shoe","clothing","mans shoe"],u:"1f45e",a:"0.6"},{n:["shoe","sneaker","athletic","clothing","running shoe"],u:"1f45f",a:"0.6"},{n:["boot","hiking","camping","hiking boot","backpacking"],u:"1f97e",a:"11"},{n:["slip on","slipper","flat shoe","ballet flat"],u:"1f97f",a:"11"},{n:["heel","shoe","woman","clothing","high heeled shoe"],u:"1f460",a:"0.6"},{n:["shoe","woman","sandal","clothing","womans sandal"],u:"1f461",a:"0.6"},{n:["dance","ballet","ballet shoes"],u:"1fa70",a:"12"},{n:["boot","shoe","woman","clothing","womans boot"],u:"1f462",a:"0.6"},{n:["afro","comb","hair","pick","hair pick"],u:"1faae",a:"15"},{n:["king","crown","queen","clothing"],u:"1f451",a:"0.6"},{n:["hat","woman","clothing","womans hat"],u:"1f452",a:"0.6"},{n:["hat","top","tophat","top hat","clothing"],u:"1f3a9",a:"0.6"},{n:["cap","hat","clothing","graduation","celebration","graduation cap"],u:"1f393",a:"0.6"},{n:["billed cap","baseball cap"],u:"1f9e2",a:"5"},{n:["army","helmet","soldier","warrior","military","military helmet"],u:"1fa96",a:"13"},{n:["beads","prayer","clothing","necklace","religion","prayer beads"],u:"1f4ff",a:"1"},{n:["makeup","lipstick","cosmetics"],u:"1f484",a:"0.6"},{n:["ring","diamond"],u:"1f48d",a:"0.6"},{n:["gem","jewel","diamond","gem stone"],u:"1f48e",a:"0.6"},{n:["mute","quiet","silent","speaker","muted speaker"],u:"1f507",a:"1"},{n:["soft","speaker low volume"],u:"1f508",a:"0.7"},{n:["medium","speaker medium volume"],u:"1f509",a:"1"},{n:["loud","speaker high volume"],u:"1f50a",a:"0.6"},{n:["loud","loudspeaker","public address"],u:"1f4e2",a:"0.6"},{n:["cheering","megaphone"],u:"1f4e3",a:"0.6"},{n:["horn","post","postal","postal horn"],u:"1f4ef",a:"1"},{n:["bell"],u:"1f514",a:"0.6"},{n:["bell","mute","quiet","silent","forbidden","bell with slash"],u:"1f515",a:"1"},{n:["music","score","musical score"],u:"1f3bc",a:"0.6"},{n:["note","music","musical note"],u:"1f3b5",a:"0.6"},{n:["note","music","notes","musical notes"],u:"1f3b6",a:"0.6"},{n:["mic","karaoke","microphone"],u:"1f3a4",a:"0.6"},{n:["earbud","headphone"],u:"1f3a7",a:"0.6"},{n:["radio","video"],u:"1f4fb",a:"0.6"},{n:["sax","music","saxophone","instrument"],u:"1f3b7",a:"0.6"},{n:["accordion","concertina","squeeze box"],u:"1fa97",a:"13"},{n:["music","guitar","instrument"],u:"1f3b8",a:"0.6"},{n:["music","piano","keyboard","instrument","musical keyboard"],u:"1f3b9",a:"0.6"},{n:["music","trumpet","instrument"],u:"1f3ba",a:"0.6"},{n:["music","violin","instrument"],u:"1f3bb",a:"0.6"},{n:["banjo","music","stringed"],u:"1fa95",a:"12"},{n:["drum","music","drumsticks"],u:"1f941",a:"3"},{n:["beat","drum","conga","rhythm","long drum"],u:"1fa98",a:"13"},{n:["music","shake","rattle","maracas","instrument","percussion"],u:"1fa87",a:"15"},{n:["fife","pipe","flute","music","recorder","woodwind"],u:"1fa88",a:"15"},{n:["cell","phone","mobile","telephone","mobile phone"],u:"1f4f1",a:"0.6"},{n:["cell","arrow","phone","mobile","receive","mobile phone with arrow"],u:"1f4f2",a:"0.6"},{n:["phone","receiver","telephone","telephone receiver"],u:"1f4de",a:"0.6"},{n:["pager"],u:"1f4df",a:"0.6"},{n:["fax","fax machine"],u:"1f4e0",a:"0.6"},{n:["battery"],u:"1f50b",a:"0.6"},{n:["electronic","low energy","low battery"],u:"1faab",a:"14"},{n:["plug","electric","electricity","electric plug"],u:"1f50c",a:"0.6"},{n:["pc","laptop","computer","personal"],u:"1f4bb",a:"0.6"},{n:["disk","optical","computer","minidisk","computer disk"],u:"1f4bd",a:"0.6"},{n:["disk","floppy","computer","floppy disk"],u:"1f4be",a:"0.6"},{n:["cd","disk","optical","computer","optical disk"],u:"1f4bf",a:"0.6"},{n:["dvd","disk","blu ray","optical","computer"],u:"1f4c0",a:"0.6"},{n:["abacus","calculation"],u:"1f9ee",a:"11"},{n:["movie","camera","cinema","movie camera"],u:"1f3a5",a:"0.6"},{n:["movie","clapper","clapper board"],u:"1f3ac",a:"0.6"},{n:["tv","video","television"],u:"1f4fa",a:"0.6"},{n:["video","camera"],u:"1f4f7",a:"0.6"},{n:["flash","video","camera","camera with flash"],u:"1f4f8",a:"1"},{n:["video","camera","video camera"],u:"1f4f9",a:"0.6"},{n:["vhs","tape","video","videocassette"],u:"1f4fc",a:"0.6"},{n:["tool","glass","search","magnifying","magnifying glass tilted left"],u:"1f50d",a:"0.6"},{n:["tool","glass","search","magnifying","magnifying glass tilted right"],u:"1f50e",a:"0.6"},{n:["bulb","idea","comic","light","electric","light bulb"],u:"1f4a1",a:"0.6"},{n:["tool","light","torch","electric","flashlight"],u:"1f526",a:"0.6"},{n:["bar","red","light","lantern","red paper lantern"],u:"1f3ee",a:"0.6"},{n:["oil","diya","lamp","diya lamp"],u:"1fa94",a:"12"},{n:["book","cover","notebook","decorated","notebook with decorative cover"],u:"1f4d4",a:"0.6"},{n:["book","closed","closed book"],u:"1f4d5",a:"0.6"},{n:["book","open","open book"],u:"1f4d6",a:"0.6"},{n:["book","green","green book"],u:"1f4d7",a:"0.6"},{n:["blue","book","blue book"],u:"1f4d8",a:"0.6"},{n:["book","orange","orange book"],u:"1f4d9",a:"0.6"},{n:["book","books"],u:"1f4da",a:"0.6"},{n:["notebook"],u:"1f4d3",a:"0.6"},{n:["ledger","notebook"],u:"1f4d2",a:"0.6"},{n:["curl","page","document","page with curl"],u:"1f4c3",a:"0.6"},{n:["paper","scroll"],u:"1f4dc",a:"0.6"},{n:["page","document","page facing up"],u:"1f4c4",a:"0.6"},{n:["news","paper","newspaper"],u:"1f4f0",a:"0.6"},{n:["mark","tabs","marker","bookmark","bookmark tabs"],u:"1f4d1",a:"0.6"},{n:["mark","bookmark"],u:"1f516",a:"0.6"},{n:["bag","money","dollar","moneybag","money bag"],u:"1f4b0",a:"0.6"},{n:["coin","gold","metal","money","silver","treasure"],u:"1fa99",a:"13"},{n:["yen","bill","note","money","banknote","currency","yen banknote"],u:"1f4b4",a:"0.6"},{n:["bill","note","money","dollar","banknote","currency","dollar banknote"],u:"1f4b5",a:"0.6"},{n:["bill","euro","note","money","banknote","currency","euro banknote"],u:"1f4b6",a:"1"},{n:["bill","note","money","pound","banknote","currency","pound banknote"],u:"1f4b7",a:"1"},{n:["fly","bill","money","wings","banknote","money with wings"],u:"1f4b8",a:"0.6"},{n:["card","money","credit","credit card"],u:"1f4b3",a:"0.6"},{n:["proof","receipt","evidence","accounting","bookkeeping"],u:"1f9fe",a:"11"},{n:["yen","chart","graph","money","growth","chart increasing with yen"],u:"1f4b9",a:"0.6"},{n:["mail","email","e mail","letter"],u:"1f4e7",a:"0.6"},{n:["email","e mail","letter","receive","envelope","incoming","incoming envelope"],u:"1f4e8",a:"0.6"},{n:["arrow","email","e mail","envelope","outgoing","envelope with arrow"],u:"1f4e9",a:"0.6"},{n:["box","mail","sent","tray","letter","outbox","outbox tray"],u:"1f4e4",a:"0.6"},{n:["box","mail","tray","inbox","letter","receive","inbox tray"],u:"1f4e5",a:"0.6"},{n:["box","parcel","package"],u:"1f4e6",a:"0.6"},{n:["mail","closed","mailbox","postbox","closed mailbox with raised flag"],u:"1f4eb",a:"0.6"},{n:["mail","closed","lowered","mailbox","postbox","closed mailbox with lowered flag"],u:"1f4ea",a:"0.6"},{n:["mail","open","mailbox","postbox","open mailbox with raised flag"],u:"1f4ec",a:"0.7"},{n:["mail","open","lowered","mailbox","postbox","open mailbox with lowered flag"],u:"1f4ed",a:"0.7"},{n:["mail","postbox","mailbox"],u:"1f4ee",a:"0.6"},{n:["memo","pencil"],u:"1f4dd",a:"0.6"},{n:["briefcase"],u:"1f4bc",a:"0.6"},{n:["file","folder","file folder"],u:"1f4c1",a:"0.6"},{n:["file","open","folder","open file folder"],u:"1f4c2",a:"0.6"},{n:["date","calendar"],u:"1f4c5",a:"0.6"},{n:["calendar","tear off calendar"],u:"1f4c6",a:"0.6"},{n:["card","index","rolodex","card index"],u:"1f4c7",a:"0.6"},{n:["chart","graph","trend","growth","upward","chart increasing"],u:"1f4c8",a:"0.6"},{n:["down","chart","graph","trend","chart decreasing"],u:"1f4c9",a:"0.6"},{n:["bar","chart","graph","bar chart"],u:"1f4ca",a:"0.6"},{n:["clipboard"],u:"1f4cb",a:"0.6"},{n:["pin","pushpin"],u:"1f4cc",a:"0.6"},{n:["pin","pushpin","round pushpin"],u:"1f4cd",a:"0.6"},{n:["paperclip"],u:"1f4ce",a:"0.6"},{n:["ruler","straight edge","straight ruler"],u:"1f4cf",a:"0.6"},{n:["set","ruler","triangle","triangular ruler"],u:"1f4d0",a:"0.6"},{n:["locked","closed"],u:"1f512",a:"0.6"},{n:["lock","open","unlock","unlocked"],u:"1f513",a:"0.6"},{n:["ink","nib","pen","lock","privacy","locked with pen"],u:"1f50f",a:"0.6"},{n:["key","lock","closed","secure","locked with key"],u:"1f510",a:"0.6"},{n:["key","lock","password"],u:"1f511",a:"0.6"},{n:["tool","hammer"],u:"1f528",a:"0.6"},{n:["axe","chop","wood","split","hatchet"],u:"1fa93",a:"12"},{n:["bomb","comic"],u:"1f4a3",a:"0.6"},{n:["rebound","boomerang","repercussion"],u:"1fa83",a:"13"},{n:["bow","arrow","archer","zodiac","sagittarius","bow and arrow"],u:"1f3f9",a:"1"},{n:["saw","tool","lumber","carpenter","carpentry saw"],u:"1fa9a",a:"13"},{n:["tool","wrench","spanner"],u:"1f527",a:"0.6"},{n:["tool","screw","screwdriver"],u:"1fa9b",a:"13"},{n:["nut","bolt","tool","nut and bolt"],u:"1f529",a:"0.6"},{n:["blind","white cane","accessibility"],u:"1f9af",a:"12"},{n:["link"],u:"1f517",a:"0.6"},{n:["break","chain","cuffs","freedom","breaking","broken chain"],u:"26d3-fe0f-200d-1f4a5",a:"15.1"},{n:["hook","catch","crook","curve","ensnare","selling point"],u:"1fa9d",a:"13"},{n:["tool","chest","toolbox","mechanic"],u:"1f9f0",a:"11"},{n:["magnet","magnetic","horseshoe","attraction"],u:"1f9f2",a:"11"},{n:["rung","step","climb","ladder"],u:"1fa9c",a:"13"},{n:["lab","chemist","science","test tube","chemistry","experiment"],u:"1f9ea",a:"11"},{n:["lab","biology","culture","bacteria","biologist","petri dish"],u:"1f9eb",a:"11"},{n:["dna","gene","life","genetics","biologist","evolution"],u:"1f9ec",a:"11"},{n:["tool","science","microscope"],u:"1f52c",a:"1"},{n:["tool","science","telescope"],u:"1f52d",a:"1"},{n:["dish","antenna","satellite","satellite antenna"],u:"1f4e1",a:"0.6"},{n:["shot","sick","needle","syringe","medicine"],u:"1f489",a:"0.6"},{n:["bleed","injury","medicine","menstruation","drop of blood","blood donation"],u:"1fa78",a:"12"},{n:["pill","sick","doctor","medicine"],u:"1f48a",a:"0.6"},{n:["bandage","adhesive bandage"],u:"1fa79",a:"12"},{n:["cane","hurt","stick","crutch","disability","mobility aid"],u:"1fa7c",a:"14"},{n:["heart","doctor","medicine","stethoscope"],u:"1fa7a",a:"12"},{n:["x ray","bones","doctor","medical","skeleton"],u:"1fa7b",a:"14"},{n:["door"],u:"1f6aa",a:"0.6"},{n:["lift","hoist","elevator","accessibility"],u:"1f6d7",a:"13"},{n:["mirror","speculum","reflector","reflection"],u:"1fa9e",a:"13"},{n:["view","frame","window","opening","fresh air","transparent"],u:"1fa9f",a:"13"},{n:["sit","seat","chair"],u:"1fa91",a:"12"},{n:["toilet"],u:"1f6bd",a:"0.6"},{n:["toilet","plunger","plumber","suction","force cup"],u:"1faa0",a:"13"},{n:["water","shower"],u:"1f6bf",a:"1"},{n:["bath","bathtub"],u:"1f6c1",a:"1"},{n:["bait","trap","snare","mousetrap","mouse trap"],u:"1faa4",a:"13"},{n:["razor","sharp","shave"],u:"1fa92",a:"12"},{n:["lotion","shampoo","sunscreen","moisturizer","lotion bottle"],u:"1f9f4",a:"11"},{n:["diaper","punk rock","safety pin"],u:"1f9f7",a:"11"},{n:["broom","witch","cleaning","sweeping"],u:"1f9f9",a:"11"},{n:["basket","picnic","farming","laundry"],u:"1f9fa",a:"11"},{n:["paper towels","toilet paper","roll of paper"],u:"1f9fb",a:"11"},{n:["vat","cask","pail","bucket"],u:"1faa3",a:"13"},{n:["bar","soap","lather","bathing","cleaning","soapdish"],u:"1f9fc",a:"11"},{n:["burp","soap","clean","bubbles","underwater"],u:"1fae7",a:"14"},{n:["brush","clean","teeth","dental","hygiene","bathroom","toothbrush"],u:"1faa5",a:"13"},{n:["sponge","porous","cleaning","absorbing"],u:"1f9fd",a:"11"},{n:["fire","quench","extinguish","fire extinguisher"],u:"1f9ef",a:"11"},{n:["cart","trolley","shopping","shopping cart"],u:"1f6d2",a:"3"},{n:["smoking","cigarette"],u:"1f6ac",a:"0.6"},{n:["grave","cemetery","headstone","graveyard","tombstone"],u:"1faa6",a:"13"},{n:["bead","charm","nazar","evil eye","talisman","nazar amulet"],u:"1f9ff",a:"11"},{n:["hand","mary","hamsa","amulet","fatima","miriam","protection"],u:"1faac",a:"14"},{n:["moai","face","moyai","statue"],u:"1f5ff",a:"0.6"},{n:["sign","picket","placard","protest","demonstration"],u:"1faa7",a:"13"},{n:["id","license","security","credentials","identification card"],u:"1faaa",a:"14"}],symbols:[{n:["atm","bank","teller","ATM sign","atm sign","automated"],u:"1f3e7",a:"0.6"},{n:["litter","litter bin","litter in bin sign"],u:"1f6ae",a:"1"},{n:["water","potable","drinking","potable water"],u:"1f6b0",a:"1"},{n:["access","wheelchair symbol"],u:"267f",a:"0.6"},{n:["wc","man","toilet","bathroom","lavatory","restroom","mens room"],u:"1f6b9",a:"0.6"},{n:["wc","woman","toilet","bathroom","lavatory","restroom","womens room"],u:"1f6ba",a:"0.6"},{n:["wc","toilet","restroom","bathroom","lavatory"],u:"1f6bb",a:"0.6"},{n:["baby","changing","baby symbol"],u:"1f6bc",a:"0.6"},{n:["wc","water","closet","toilet","bathroom","lavatory","restroom","water closet"],u:"1f6be",a:"0.6"},{n:["control","passport","passport control"],u:"1f6c2",a:"1"},{n:["customs"],u:"1f6c3",a:"1"},{n:["claim","baggage","baggage claim"],u:"1f6c4",a:"1"},{n:["locker","baggage","luggage","left luggage"],u:"1f6c5",a:"1"},{n:["child","traffic","crossing","pedestrian","children crossing"],u:"1f6b8",a:"1"},{n:["no","not","entry","traffic","no entry","forbidden","prohibited"],u:"26d4",a:"0.6"},{n:["no","not","entry","forbidden","prohibited"],u:"1f6ab",a:"0.6"},{n:["no","bike","bicycle","forbidden","prohibited","no bicycles"],u:"1f6b3",a:"1"},{n:["no","not","smoking","forbidden","no smoking","prohibited"],u:"1f6ad",a:"0.6"},{n:["no","not","litter","forbidden","prohibited","no littering"],u:"1f6af",a:"1"},{n:["water","non potable","non drinking","non potable water"],u:"1f6b1",a:"1"},{n:["no","not","forbidden","pedestrian","prohibited","no pedestrians"],u:"1f6b7",a:"1"},{n:["no","cell","phone","mobile","forbidden","no mobile phones"],u:"1f4f5",a:"1"},{n:["18","eighteen","underage","prohibited","age restriction","no one under eighteen"],u:"1f51e",a:"0.6"},{n:["arrow","reload","clockwise","clockwise vertical arrows"],u:"1f503",a:"0.6"},{n:["arrow","withershins","anticlockwise","counterclockwise","counterclockwise arrows button"],u:"1f504",a:"1"},{n:["back","arrow","BACK arrow"],u:"1f519",a:"0.6"},{n:["end","arrow","END arrow"],u:"1f51a",a:"0.6"},{n:["on","on!","mark","arrow","ON! arrow"],u:"1f51b",a:"0.6"},{n:["soon","arrow","SOON arrow"],u:"1f51c",a:"0.6"},{n:["up","top","arrow","TOP arrow"],u:"1f51d",a:"0.6"},{n:["worship","religion","place of worship"],u:"1f6d0",a:"1"},{n:["menorah","religion","candelabrum","candlestick"],u:"1f54e",a:"1"},{n:["star","fortune","dotted six pointed star"],u:"1f52f",a:"0.6"},{n:["sikh","khanda","religion"],u:"1faaf",a:"15"},{n:["ram","Aries","aries","zodiac"],u:"2648",a:"0.6"},{n:["ox","bull","Taurus","taurus","zodiac"],u:"2649",a:"0.6"},{n:["twins","Gemini","gemini","zodiac"],u:"264a",a:"0.6"},{n:["crab","Cancer","cancer","zodiac"],u:"264b",a:"0.6"},{n:["Leo","leo","lion","zodiac"],u:"264c",a:"0.6"},{n:["Virgo","virgo","zodiac"],u:"264d",a:"0.6"},{n:["Libra","libra","scales","zodiac","balance","justice"],u:"264e",a:"0.6"},{n:["zodiac","Scorpio","scorpio","scorpion","scorpius"],u:"264f",a:"0.6"},{n:["archer","zodiac","Sagittarius","sagittarius"],u:"2650",a:"0.6"},{n:["goat","zodiac","Capricorn","capricorn"],u:"2651",a:"0.6"},{n:["water","bearer","zodiac","Aquarius","aquarius"],u:"2652",a:"0.6"},{n:["fish","Pisces","pisces","zodiac"],u:"2653",a:"0.6"},{n:["snake","bearer","zodiac","serpent","Ophiuchus","ophiuchus"],u:"26ce",a:"0.6"},{n:["arrow","crossed","shuffle tracks button"],u:"1f500",a:"1"},{n:["arrow","repeat","clockwise","repeat button"],u:"1f501",a:"1"},{n:["once","arrow","clockwise","repeat single button"],u:"1f502",a:"1"},{n:["fast","arrow","double","forward","fast forward button"],u:"23e9",a:"0.6"},{n:["arrow","double","rewind","fast reverse button"],u:"23ea",a:"0.6"},{n:["arrow","button","upwards button"],u:"1f53c",a:"0.6"},{n:["arrow","double","fast up button"],u:"23eb",a:"0.6"},{n:["down","arrow","button","downwards button"],u:"1f53d",a:"0.6"},{n:["down","arrow","double","fast down button"],u:"23ec",a:"0.6"},{n:["film","movie","cinema","camera"],u:"1f3a6",a:"0.6"},{n:["dim","low","dim button","brightness"],u:"1f505",a:"1"},{n:["bright","brightness","bright button"],u:"1f506",a:"1"},{n:["bar","cell","phone","mobile","antenna","antenna bars"],u:"1f4f6",a:"0.6"},{n:["wifi","wi fi","network","wireless","computer","internet"],u:"1f6dc",a:"15"},{n:["cell","mode","phone","mobile","telephone","vibration","vibration mode"],u:"1f4f3",a:"0.6"},{n:["off","cell","phone","mobile","telephone","mobile phone off"],u:"1f4f4",a:"0.6"},{n:["+","plus","math","sign"],u:"2795",a:"0.6"},{n:[" ","","math","sign","minus"],u:"2796",a:"0.6"},{n:["","math","sign","divide","division"],u:"2797",a:"0.6"},{n:["math","equality","heavy equals sign"],u:"1f7f0",a:"14"},{n:["?","mark","question","punctuation","red question mark"],u:"2753",a:"0.6"},{n:["?","mark","outlined","question","punctuation","white question mark"],u:"2754",a:"0.6"},{n:["!","mark","outlined","exclamation","punctuation","white exclamation mark"],u:"2755",a:"0.6"},{n:["!","mark","exclamation","punctuation","red exclamation mark"],u:"2757",a:"0.6"},{n:["bank","money","currency","exchange","currency exchange"],u:"1f4b1",a:"0.6"},{n:["money","dollar","currency","heavy dollar sign"],u:"1f4b2",a:"0.6"},{n:["ship","tool","anchor","emblem","trident","trident emblem"],u:"1f531",a:"0.6"},{n:["name","badge","name badge"],u:"1f4db",a:"0.6"},{n:["leaf","chevron","beginner","japanese","Japanese symbol for beginner","japanese symbol for beginner"],u:"1f530",a:"0.6"},{n:["o","red","large","circle","hollow red circle"],u:"2b55",a:"0.6"},{n:["","mark","check","button","check mark button"],u:"2705",a:"0.6"},{n:["x","","mark","cross","cancel","multiply","cross mark","multiplication"],u:"274c",a:"0.6"},{n:["x","","mark","square","cross mark button"],u:"274e",a:"0.6"},{n:["curl","loop","curly loop"],u:"27b0",a:"0.6"},{n:["curl","loop","double","double curly loop"],u:"27bf",a:"1"},{n:["keycap","keycap: #"],u:"0023-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: *"],u:"002a-fe0f-20e3",a:"2"},{n:["keycap","keycap: 0"],u:"0030-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 1"],u:"0031-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 2"],u:"0032-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 3"],u:"0033-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 4"],u:"0034-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 5"],u:"0035-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 6"],u:"0036-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 7"],u:"0037-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 8"],u:"0038-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 9"],u:"0039-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 10"],u:"1f51f",a:"0.6"},{n:["abcd","input","latin","letters","uppercase","input latin uppercase"],u:"1f520",a:"0.6"},{n:["abcd","input","latin","letters","lowercase","input latin lowercase"],u:"1f521",a:"0.6"},{n:["1234","input","numbers","input numbers"],u:"1f522",a:"0.6"},{n:["&%","input","input symbols"],u:"1f523",a:"0.6"},{n:["abc","input","latin","letters","alphabet","input latin letters"],u:"1f524",a:"0.6"},{n:["ab","blood type","AB button (blood type)","ab button (blood type)"],u:"1f18e",a:"0.6"},{n:["cl","CL button","cl button"],u:"1f191",a:"0.6"},{n:["cool","COOL button","cool button"],u:"1f192",a:"0.6"},{n:["free","FREE button","free button"],u:"1f193",a:"0.6"},{n:["id","identity","ID button","id button"],u:"1f194",a:"0.6"},{n:["new","NEW button","new button"],u:"1f195",a:"0.6"},{n:["ng","NG button","ng button"],u:"1f196",a:"0.6"},{n:["ok","OK button","ok button"],u:"1f197",a:"0.6"},{n:["sos","help","SOS button","sos button"],u:"1f198",a:"0.6"},{n:["up","up!","mark","UP! button","up! button"],u:"1f199",a:"0.6"},{n:["vs","versus","VS button","vs button"],u:"1f19a",a:"0.6"},{n:["","here","japanese","katakana","Japanese here button","japanese here button"],u:"1f201",a:"0.6"},{n:["","japanese","ideograph","not free of charge","Japanese not free of charge button","japanese not free of charge button"],u:"1f236",a:"0.6"},{n:["","japanese","ideograph","reserved","Japanese reserved button","japanese reserved button"],u:"1f22f",a:"0.6"},{n:["","japanese","ideograph","bargain","Japanese bargain button","japanese bargain button"],u:"1f250",a:"0.6"},{n:["","japanese","ideograph","discount","Japanese discount button","japanese discount button"],u:"1f239",a:"0.6"},{n:["","japanese","ideograph","free of charge","Japanese free of charge button","japanese free of charge button"],u:"1f21a",a:"0.6"},{n:["","japanese","ideograph","prohibited","Japanese prohibited button","japanese prohibited button"],u:"1f232",a:"0.6"},{n:["","japanese","ideograph","acceptable","Japanese acceptable button","japanese acceptable button"],u:"1f251",a:"0.6"},{n:["","japanese","ideograph","application","Japanese application button","japanese application button"],u:"1f238",a:"0.6"},{n:["","japanese","ideograph","passing grade","Japanese passing grade button","japanese passing grade button"],u:"1f234",a:"0.6"},{n:["","japanese","ideograph","vacancy","Japanese vacancy button","japanese vacancy button"],u:"1f233",a:"0.6"},{n:["","japanese","ideograph","open for business","Japanese open for business button","japanese open for business button"],u:"1f23a",a:"0.6"},{n:["","japanese","ideograph","no vacancy","Japanese no vacancy button","japanese no vacancy button"],u:"1f235",a:"0.6"},{n:["red","circle","geometric","red circle"],u:"1f534",a:"0.6"},{n:["circle","orange","orange circle"],u:"1f7e0",a:"12"},{n:["circle","yellow","yellow circle"],u:"1f7e1",a:"12"},{n:["green","circle","green circle"],u:"1f7e2",a:"12"},{n:["blue","circle","geometric","blue circle"],u:"1f535",a:"0.6"},{n:["circle","purple","purple circle"],u:"1f7e3",a:"12"},{n:["brown","circle","brown circle"],u:"1f7e4",a:"12"},{n:["circle","geometric","black circle"],u:"26ab",a:"0.6"},{n:["circle","geometric","white circle"],u:"26aa",a:"0.6"},{n:["red","square","red square"],u:"1f7e5",a:"12"},{n:["orange","square","orange square"],u:"1f7e7",a:"12"},{n:["square","yellow","yellow square"],u:"1f7e8",a:"12"},{n:["green","square","green square"],u:"1f7e9",a:"12"},{n:["blue","square","blue square"],u:"1f7e6",a:"12"},{n:["purple","square","purple square"],u:"1f7ea",a:"12"},{n:["brown","square","brown square"],u:"1f7eb",a:"12"},{n:["square","geometric","black large square"],u:"2b1b",a:"0.6"},{n:["square","geometric","white large square"],u:"2b1c",a:"0.6"},{n:["square","geometric","black medium small square"],u:"25fe",a:"0.6"},{n:["square","geometric","white medium small square"],u:"25fd",a:"0.6"},{n:["orange","diamond","geometric","large orange diamond"],u:"1f536",a:"0.6"},{n:["blue","diamond","geometric","large blue diamond"],u:"1f537",a:"0.6"},{n:["orange","diamond","geometric","small orange diamond"],u:"1f538",a:"0.6"},{n:["blue","diamond","geometric","small blue diamond"],u:"1f539",a:"0.6"},{n:["red","geometric","red triangle pointed up"],u:"1f53a",a:"0.6"},{n:["red","down","geometric","red triangle pointed down"],u:"1f53b",a:"0.6"},{n:["comic","inside","diamond","geometric","diamond with a dot"],u:"1f4a0",a:"0.6"},{n:["radio","button","geometric","radio button"],u:"1f518",a:"0.6"},{n:["button","square","outlined","geometric","white square button"],u:"1f533",a:"0.6"},{n:["button","square","geometric","black square button"],u:"1f532",a:"0.6"}],flags:[{n:["racing","checkered","chequered","chequered flag"],u:"1f3c1",a:"0.6"},{n:["post","triangular flag"],u:"1f6a9",a:"0.6"},{n:["cross","crossed","japanese","celebration","crossed flags"],u:"1f38c",a:"0.6"},{n:["waving","black flag"],u:"1f3f4",a:"1"},{n:["pride","rainbow","rainbow flag"],u:"1f3f3-fe0f-200d-1f308",a:"4"},{n:["flag","pink","white","light blue","transgender","transgender flag"],u:"1f3f3-fe0f-200d-26a7-fe0f",a:"13"},{n:["pirate","plunder","treasure","pirate flag","jolly roger"],u:"1f3f4-200d-2620-fe0f",a:"11"},{n:["AC","flag","flag: Ascension Island","flag: ascension island"],u:"1f1e6-1f1e8",a:"2"},{n:["AD","flag","flag: Andorra","flag: andorra"],u:"1f1e6-1f1e9",a:"2"},{n:["AE","flag","flag: United Arab Emirates","flag: united arab emirates"],u:"1f1e6-1f1ea",a:"2"},{n:["AF","flag","flag: Afghanistan","flag: afghanistan"],u:"1f1e6-1f1eb",a:"2"},{n:["AG","flag","flag: Antigua & Barbuda","flag: antigua & barbuda"],u:"1f1e6-1f1ec",a:"2"},{n:["AI","flag","flag: Anguilla","flag: anguilla"],u:"1f1e6-1f1ee",a:"2"},{n:["AL","flag","flag: Albania","flag: albania"],u:"1f1e6-1f1f1",a:"2"},{n:["AM","flag","flag: Armenia","flag: armenia"],u:"1f1e6-1f1f2",a:"2"},{n:["AO","flag","flag: Angola","flag: angola"],u:"1f1e6-1f1f4",a:"2"},{n:["AQ","flag","flag: Antarctica","flag: antarctica"],u:"1f1e6-1f1f6",a:"2"},{n:["AR","flag","flag: Argentina","flag: argentina"],u:"1f1e6-1f1f7",a:"2"},{n:["AS","flag","flag: American Samoa","flag: american samoa"],u:"1f1e6-1f1f8",a:"2"},{n:["AT","flag","flag: Austria","flag: austria"],u:"1f1e6-1f1f9",a:"2"},{n:["AU","flag","flag: Australia","flag: australia"],u:"1f1e6-1f1fa",a:"2"},{n:["AW","flag","flag: Aruba","flag: aruba"],u:"1f1e6-1f1fc",a:"2"},{n:["AX","flag","flag: land Islands","flag: land islands"],u:"1f1e6-1f1fd",a:"2"},{n:["AZ","flag","flag: Azerbaijan","flag: azerbaijan"],u:"1f1e6-1f1ff",a:"2"},{n:["BA","flag","flag: Bosnia & Herzegovina","flag: bosnia & herzegovina"],u:"1f1e7-1f1e6",a:"2"},{n:["BB","flag","flag: Barbados","flag: barbados"],u:"1f1e7-1f1e7",a:"2"},{n:["BD","flag","flag: Bangladesh","flag: bangladesh"],u:"1f1e7-1f1e9",a:"2"},{n:["BE","flag","flag: Belgium","flag: belgium"],u:"1f1e7-1f1ea",a:"2"},{n:["BF","flag","flag: Burkina Faso","flag: burkina faso"],u:"1f1e7-1f1eb",a:"2"},{n:["BG","flag","flag: Bulgaria","flag: bulgaria"],u:"1f1e7-1f1ec",a:"2"},{n:["BH","flag","flag: Bahrain","flag: bahrain"],u:"1f1e7-1f1ed",a:"2"},{n:["BI","flag","flag: Burundi","flag: burundi"],u:"1f1e7-1f1ee",a:"2"},{n:["BJ","flag","flag: Benin","flag: benin"],u:"1f1e7-1f1ef",a:"2"},{n:["BL","flag","flag: St. Barthlemy","flag: st. barthlemy"],u:"1f1e7-1f1f1",a:"2"},{n:["BM","flag","flag: Bermuda","flag: bermuda"],u:"1f1e7-1f1f2",a:"2"},{n:["BN","flag","flag: Brunei","flag: brunei"],u:"1f1e7-1f1f3",a:"2"},{n:["BO","flag","flag: Bolivia","flag: bolivia"],u:"1f1e7-1f1f4",a:"2"},{n:["BQ","flag","flag: Caribbean Netherlands","flag: caribbean netherlands"],u:"1f1e7-1f1f6",a:"2"},{n:["BR","flag","flag: Brazil","flag: brazil"],u:"1f1e7-1f1f7",a:"2"},{n:["BS","flag","flag: Bahamas","flag: bahamas"],u:"1f1e7-1f1f8",a:"2"},{n:["BT","flag","flag: Bhutan","flag: bhutan"],u:"1f1e7-1f1f9",a:"2"},{n:["BV","flag","flag: Bouvet Island","flag: bouvet island"],u:"1f1e7-1f1fb",a:"2"},{n:["BW","flag","flag: Botswana","flag: botswana"],u:"1f1e7-1f1fc",a:"2"},{n:["BY","flag","flag: Belarus","flag: belarus"],u:"1f1e7-1f1fe",a:"2"},{n:["BZ","flag","flag: Belize","flag: belize"],u:"1f1e7-1f1ff",a:"2"},{n:["CA","flag","flag: Canada","flag: canada"],u:"1f1e8-1f1e6",a:"2"},{n:["CC","flag","flag: Cocos (Keeling) Islands","flag: cocos (keeling) islands"],u:"1f1e8-1f1e8",a:"2"},{n:["CD","flag","flag: Congo   Kinshasa","flag: congo   kinshasa"],u:"1f1e8-1f1e9",a:"2"},{n:["CF","flag","flag: Central African Republic","flag: central african republic"],u:"1f1e8-1f1eb",a:"2"},{n:["CG","flag","flag: Congo   Brazzaville","flag: congo   brazzaville"],u:"1f1e8-1f1ec",a:"2"},{n:["CH","flag","flag: Switzerland","flag: switzerland"],u:"1f1e8-1f1ed",a:"2"},{n:["CI","flag","flag: Cte dIvoire","flag: cte divoire"],u:"1f1e8-1f1ee",a:"2"},{n:["CK","flag","flag: Cook Islands","flag: cook islands"],u:"1f1e8-1f1f0",a:"2"},{n:["CL","flag","flag: Chile","flag: chile"],u:"1f1e8-1f1f1",a:"2"},{n:["CM","flag","flag: Cameroon","flag: cameroon"],u:"1f1e8-1f1f2",a:"2"},{n:["CN","flag","flag: China","flag: china"],u:"1f1e8-1f1f3",a:"0.6"},{n:["CO","flag","flag: Colombia","flag: colombia"],u:"1f1e8-1f1f4",a:"2"},{n:["CP","flag","flag: Clipperton Island","flag: clipperton island"],u:"1f1e8-1f1f5",a:"2"},{n:["CR","flag","flag: Costa Rica","flag: costa rica"],u:"1f1e8-1f1f7",a:"2"},{n:["CU","flag","flag: Cuba","flag: cuba"],u:"1f1e8-1f1fa",a:"2"},{n:["CV","flag","flag: Cape Verde","flag: cape verde"],u:"1f1e8-1f1fb",a:"2"},{n:["CW","flag","flag: Curaao","flag: curaao"],u:"1f1e8-1f1fc",a:"2"},{n:["CX","flag","flag: Christmas Island","flag: christmas island"],u:"1f1e8-1f1fd",a:"2"},{n:["CY","flag","flag: Cyprus","flag: cyprus"],u:"1f1e8-1f1fe",a:"2"},{n:["CZ","flag","flag: Czechia","flag: czechia"],u:"1f1e8-1f1ff",a:"2"},{n:["DE","flag","flag: Germany","flag: germany"],u:"1f1e9-1f1ea",a:"0.6"},{n:["DG","flag","flag: Diego Garcia","flag: diego garcia"],u:"1f1e9-1f1ec",a:"2"},{n:["DJ","flag","flag: Djibouti","flag: djibouti"],u:"1f1e9-1f1ef",a:"2"},{n:["DK","flag","flag: Denmark","flag: denmark"],u:"1f1e9-1f1f0",a:"2"},{n:["DM","flag","flag: Dominica","flag: dominica"],u:"1f1e9-1f1f2",a:"2"},{n:["DO","flag","flag: Dominican Republic","flag: dominican republic"],u:"1f1e9-1f1f4",a:"2"},{n:["DZ","flag","flag: Algeria","flag: algeria"],u:"1f1e9-1f1ff",a:"2"},{n:["EA","flag","flag: Ceuta & Melilla","flag: ceuta & melilla"],u:"1f1ea-1f1e6",a:"2"},{n:["EC","flag","flag: Ecuador","flag: ecuador"],u:"1f1ea-1f1e8",a:"2"},{n:["EE","flag","flag: Estonia","flag: estonia"],u:"1f1ea-1f1ea",a:"2"},{n:["EG","flag","flag: Egypt","flag: egypt"],u:"1f1ea-1f1ec",a:"2"},{n:["EH","flag","flag: Western Sahara","flag: western sahara"],u:"1f1ea-1f1ed",a:"2"},{n:["ER","flag","flag: Eritrea","flag: eritrea"],u:"1f1ea-1f1f7",a:"2"},{n:["ES","flag","flag: Spain","flag: spain"],u:"1f1ea-1f1f8",a:"0.6"},{n:["ET","flag","flag: Ethiopia","flag: ethiopia"],u:"1f1ea-1f1f9",a:"2"},{n:["EU","flag","flag: European Union","flag: european union"],u:"1f1ea-1f1fa",a:"2"},{n:["FI","flag","flag: Finland","flag: finland"],u:"1f1eb-1f1ee",a:"2"},{n:["FJ","flag","flag: Fiji","flag: fiji"],u:"1f1eb-1f1ef",a:"2"},{n:["FK","flag","flag: Falkland Islands","flag: falkland islands"],u:"1f1eb-1f1f0",a:"2"},{n:["FM","flag","flag: Micronesia","flag: micronesia"],u:"1f1eb-1f1f2",a:"2"},{n:["FO","flag","flag: Faroe Islands","flag: faroe islands"],u:"1f1eb-1f1f4",a:"2"},{n:["FR","flag","flag: France","flag: france"],u:"1f1eb-1f1f7",a:"0.6"},{n:["GA","flag","flag: Gabon","flag: gabon"],u:"1f1ec-1f1e6",a:"2"},{n:["GB","flag","flag: United Kingdom","flag: united kingdom"],u:"1f1ec-1f1e7",a:"0.6"},{n:["GD","flag","flag: Grenada","flag: grenada"],u:"1f1ec-1f1e9",a:"2"},{n:["GE","flag","flag: Georgia","flag: georgia"],u:"1f1ec-1f1ea",a:"2"},{n:["GF","flag","flag: French Guiana","flag: french guiana"],u:"1f1ec-1f1eb",a:"2"},{n:["GG","flag","flag: Guernsey","flag: guernsey"],u:"1f1ec-1f1ec",a:"2"},{n:["GH","flag","flag: Ghana","flag: ghana"],u:"1f1ec-1f1ed",a:"2"},{n:["GI","flag","flag: Gibraltar","flag: gibraltar"],u:"1f1ec-1f1ee",a:"2"},{n:["GL","flag","flag: Greenland","flag: greenland"],u:"1f1ec-1f1f1",a:"2"},{n:["GM","flag","flag: Gambia","flag: gambia"],u:"1f1ec-1f1f2",a:"2"},{n:["GN","flag","flag: Guinea","flag: guinea"],u:"1f1ec-1f1f3",a:"2"},{n:["GP","flag","flag: Guadeloupe","flag: guadeloupe"],u:"1f1ec-1f1f5",a:"2"},{n:["GQ","flag","flag: Equatorial Guinea","flag: equatorial guinea"],u:"1f1ec-1f1f6",a:"2"},{n:["GR","flag","flag: Greece","flag: greece"],u:"1f1ec-1f1f7",a:"2"},{n:["GS","flag","flag: South Georgia & South Sandwich Islands","flag: south georgia & south sandwich islands"],u:"1f1ec-1f1f8",a:"2"},{n:["GT","flag","flag: Guatemala","flag: guatemala"],u:"1f1ec-1f1f9",a:"2"},{n:["GU","flag","flag: Guam","flag: guam"],u:"1f1ec-1f1fa",a:"2"},{n:["GW","flag","flag: Guinea Bissau","flag: guinea bissau"],u:"1f1ec-1f1fc",a:"2"},{n:["GY","flag","flag: Guyana","flag: guyana"],u:"1f1ec-1f1fe",a:"2"},{n:["HK","flag","flag: Hong Kong SAR China","flag: hong kong sar china"],u:"1f1ed-1f1f0",a:"2"},{n:["HM","flag","flag: Heard & McDonald Islands","flag: heard & mcdonald islands"],u:"1f1ed-1f1f2",a:"2"},{n:["HN","flag","flag: Honduras","flag: honduras"],u:"1f1ed-1f1f3",a:"2"},{n:["HR","flag","flag: Croatia","flag: croatia"],u:"1f1ed-1f1f7",a:"2"},{n:["HT","flag","flag: Haiti","flag: haiti"],u:"1f1ed-1f1f9",a:"2"},{n:["HU","flag","flag: Hungary","flag: hungary"],u:"1f1ed-1f1fa",a:"2"},{n:["IC","flag","flag: Canary Islands","flag: canary islands"],u:"1f1ee-1f1e8",a:"2"},{n:["ID","flag","flag: Indonesia","flag: indonesia"],u:"1f1ee-1f1e9",a:"2"},{n:["IE","flag","flag: Ireland","flag: ireland"],u:"1f1ee-1f1ea",a:"2"},{n:["IL","flag","flag: Israel","flag: israel"],u:"1f1ee-1f1f1",a:"2"},{n:["IM","flag","flag: Isle of Man","flag: isle of man"],u:"1f1ee-1f1f2",a:"2"},{n:["IN","flag","flag: India","flag: india"],u:"1f1ee-1f1f3",a:"2"},{n:["IO","flag","flag: British Indian Ocean Territory","flag: british indian ocean territory"],u:"1f1ee-1f1f4",a:"2"},{n:["IQ","flag","flag: Iraq","flag: iraq"],u:"1f1ee-1f1f6",a:"2"},{n:["IR","flag","flag: Iran","flag: iran"],u:"1f1ee-1f1f7",a:"2"},{n:["IS","flag","flag: Iceland","flag: iceland"],u:"1f1ee-1f1f8",a:"2"},{n:["IT","flag","flag: Italy","flag: italy"],u:"1f1ee-1f1f9",a:"0.6"},{n:["JE","flag","flag: Jersey","flag: jersey"],u:"1f1ef-1f1ea",a:"2"},{n:["JM","flag","flag: Jamaica","flag: jamaica"],u:"1f1ef-1f1f2",a:"2"},{n:["JO","flag","flag: Jordan","flag: jordan"],u:"1f1ef-1f1f4",a:"2"},{n:["JP","flag","flag: Japan","flag: japan"],u:"1f1ef-1f1f5",a:"0.6"},{n:["KE","flag","flag: Kenya","flag: kenya"],u:"1f1f0-1f1ea",a:"2"},{n:["KG","flag","flag: Kyrgyzstan","flag: kyrgyzstan"],u:"1f1f0-1f1ec",a:"2"},{n:["KH","flag","flag: Cambodia","flag: cambodia"],u:"1f1f0-1f1ed",a:"2"},{n:["KI","flag","flag: Kiribati","flag: kiribati"],u:"1f1f0-1f1ee",a:"2"},{n:["KM","flag","flag: Comoros","flag: comoros"],u:"1f1f0-1f1f2",a:"2"},{n:["KN","flag","flag: St. Kitts & Nevis","flag: st. kitts & nevis"],u:"1f1f0-1f1f3",a:"2"},{n:["KP","flag","flag: North Korea","flag: north korea"],u:"1f1f0-1f1f5",a:"2"},{n:["KR","flag","flag: South Korea","flag: south korea"],u:"1f1f0-1f1f7",a:"0.6"},{n:["KW","flag","flag: Kuwait","flag: kuwait"],u:"1f1f0-1f1fc",a:"2"},{n:["KY","flag","flag: Cayman Islands","flag: cayman islands"],u:"1f1f0-1f1fe",a:"2"},{n:["KZ","flag","flag: Kazakhstan","flag: kazakhstan"],u:"1f1f0-1f1ff",a:"2"},{n:["LA","flag","flag: Laos","flag: laos"],u:"1f1f1-1f1e6",a:"2"},{n:["LB","flag","flag: Lebanon","flag: lebanon"],u:"1f1f1-1f1e7",a:"2"},{n:["LC","flag","flag: St. Lucia","flag: st. lucia"],u:"1f1f1-1f1e8",a:"2"},{n:["LI","flag","flag: Liechtenstein","flag: liechtenstein"],u:"1f1f1-1f1ee",a:"2"},{n:["LK","flag","flag: Sri Lanka","flag: sri lanka"],u:"1f1f1-1f1f0",a:"2"},{n:["LR","flag","flag: Liberia","flag: liberia"],u:"1f1f1-1f1f7",a:"2"},{n:["LS","flag","flag: Lesotho","flag: lesotho"],u:"1f1f1-1f1f8",a:"2"},{n:["LT","flag","flag: Lithuania","flag: lithuania"],u:"1f1f1-1f1f9",a:"2"},{n:["LU","flag","flag: Luxembourg","flag: luxembourg"],u:"1f1f1-1f1fa",a:"2"},{n:["LV","flag","flag: Latvia","flag: latvia"],u:"1f1f1-1f1fb",a:"2"},{n:["LY","flag","flag: Libya","flag: libya"],u:"1f1f1-1f1fe",a:"2"},{n:["MA","flag","flag: Morocco","flag: morocco"],u:"1f1f2-1f1e6",a:"2"},{n:["MC","flag","flag: Monaco","flag: monaco"],u:"1f1f2-1f1e8",a:"2"},{n:["MD","flag","flag: Moldova","flag: moldova"],u:"1f1f2-1f1e9",a:"2"},{n:["ME","flag","flag: Montenegro","flag: montenegro"],u:"1f1f2-1f1ea",a:"2"},{n:["MF","flag","flag: St. Martin","flag: st. martin"],u:"1f1f2-1f1eb",a:"2"},{n:["MG","flag","flag: Madagascar","flag: madagascar"],u:"1f1f2-1f1ec",a:"2"},{n:["MH","flag","flag: Marshall Islands","flag: marshall islands"],u:"1f1f2-1f1ed",a:"2"},{n:["MK","flag","flag: North Macedonia","flag: north macedonia"],u:"1f1f2-1f1f0",a:"2"},{n:["ML","flag","flag: Mali","flag: mali"],u:"1f1f2-1f1f1",a:"2"},{n:["MM","flag","flag: Myanmar (Burma)","flag: myanmar (burma)"],u:"1f1f2-1f1f2",a:"2"},{n:["MN","flag","flag: Mongolia","flag: mongolia"],u:"1f1f2-1f1f3",a:"2"},{n:["MO","flag","flag: Macao SAR China","flag: macao sar china"],u:"1f1f2-1f1f4",a:"2"},{n:["MP","flag","flag: Northern Mariana Islands","flag: northern mariana islands"],u:"1f1f2-1f1f5",a:"2"},{n:["MQ","flag","flag: Martinique","flag: martinique"],u:"1f1f2-1f1f6",a:"2"},{n:["MR","flag","flag: Mauritania","flag: mauritania"],u:"1f1f2-1f1f7",a:"2"},{n:["MS","flag","flag: Montserrat","flag: montserrat"],u:"1f1f2-1f1f8",a:"2"},{n:["MT","flag","flag: Malta","flag: malta"],u:"1f1f2-1f1f9",a:"2"},{n:["MU","flag","flag: Mauritius","flag: mauritius"],u:"1f1f2-1f1fa",a:"2"},{n:["MV","flag","flag: Maldives","flag: maldives"],u:"1f1f2-1f1fb",a:"2"},{n:["MW","flag","flag: Malawi","flag: malawi"],u:"1f1f2-1f1fc",a:"2"},{n:["MX","flag","flag: Mexico","flag: mexico"],u:"1f1f2-1f1fd",a:"2"},{n:["MY","flag","flag: Malaysia","flag: malaysia"],u:"1f1f2-1f1fe",a:"2"},{n:["MZ","flag","flag: Mozambique","flag: mozambique"],u:"1f1f2-1f1ff",a:"2"},{n:["NA","flag","flag: Namibia","flag: namibia"],u:"1f1f3-1f1e6",a:"2"},{n:["NC","flag","flag: New Caledonia","flag: new caledonia"],u:"1f1f3-1f1e8",a:"2"},{n:["NE","flag","flag: Niger","flag: niger"],u:"1f1f3-1f1ea",a:"2"},{n:["NF","flag","flag: Norfolk Island","flag: norfolk island"],u:"1f1f3-1f1eb",a:"2"},{n:["NG","flag","flag: Nigeria","flag: nigeria"],u:"1f1f3-1f1ec",a:"2"},{n:["NI","flag","flag: Nicaragua","flag: nicaragua"],u:"1f1f3-1f1ee",a:"2"},{n:["NL","flag","flag: Netherlands","flag: netherlands"],u:"1f1f3-1f1f1",a:"2"},{n:["NO","flag","flag: Norway","flag: norway"],u:"1f1f3-1f1f4",a:"2"},{n:["NP","flag","flag: Nepal","flag: nepal"],u:"1f1f3-1f1f5",a:"2"},{n:["NR","flag","flag: Nauru","flag: nauru"],u:"1f1f3-1f1f7",a:"2"},{n:["NU","flag","flag: Niue","flag: niue"],u:"1f1f3-1f1fa",a:"2"},{n:["NZ","flag","flag: New Zealand","flag: new zealand"],u:"1f1f3-1f1ff",a:"2"},{n:["OM","flag","flag: Oman","flag: oman"],u:"1f1f4-1f1f2",a:"2"},{n:["PA","flag","flag: Panama","flag: panama"],u:"1f1f5-1f1e6",a:"2"},{n:["PE","flag","flag: Peru","flag: peru"],u:"1f1f5-1f1ea",a:"2"},{n:["PF","flag","flag: French Polynesia","flag: french polynesia"],u:"1f1f5-1f1eb",a:"2"},{n:["PG","flag","flag: Papua New Guinea","flag: papua new guinea"],u:"1f1f5-1f1ec",a:"2"},{n:["PH","flag","flag: Philippines","flag: philippines"],u:"1f1f5-1f1ed",a:"2"},{n:["PK","flag","flag: Pakistan","flag: pakistan"],u:"1f1f5-1f1f0",a:"2"},{n:["PL","flag","flag: Poland","flag: poland"],u:"1f1f5-1f1f1",a:"2"},{n:["PM","flag","flag: St. Pierre & Miquelon","flag: st. pierre & miquelon"],u:"1f1f5-1f1f2",a:"2"},{n:["PN","flag","flag: Pitcairn Islands","flag: pitcairn islands"],u:"1f1f5-1f1f3",a:"2"},{n:["PR","flag","flag: Puerto Rico","flag: puerto rico"],u:"1f1f5-1f1f7",a:"2"},{n:["PS","flag","flag: Palestinian Territories","flag: palestinian territories"],u:"1f1f5-1f1f8",a:"2"},{n:["PT","flag","flag: Portugal","flag: portugal"],u:"1f1f5-1f1f9",a:"2"},{n:["PW","flag","flag: Palau","flag: palau"],u:"1f1f5-1f1fc",a:"2"},{n:["PY","flag","flag: Paraguay","flag: paraguay"],u:"1f1f5-1f1fe",a:"2"},{n:["QA","flag","flag: Qatar","flag: qatar"],u:"1f1f6-1f1e6",a:"2"},{n:["RE","flag","flag: Runion","flag: runion"],u:"1f1f7-1f1ea",a:"2"},{n:["RO","flag","flag: Romania","flag: romania"],u:"1f1f7-1f1f4",a:"2"},{n:["RS","flag","flag: Serbia","flag: serbia"],u:"1f1f7-1f1f8",a:"2"},{n:["RU","flag","flag: Russia","flag: russia"],u:"1f1f7-1f1fa",a:"0.6"},{n:["RW","flag","flag: Rwanda","flag: rwanda"],u:"1f1f7-1f1fc",a:"2"},{n:["SA","flag","flag: Saudi Arabia","flag: saudi arabia"],u:"1f1f8-1f1e6",a:"2"},{n:["SB","flag","flag: Solomon Islands","flag: solomon islands"],u:"1f1f8-1f1e7",a:"2"},{n:["SC","flag","flag: Seychelles","flag: seychelles"],u:"1f1f8-1f1e8",a:"2"},{n:["SD","flag","flag: Sudan","flag: sudan"],u:"1f1f8-1f1e9",a:"2"},{n:["SE","flag","flag: Sweden","flag: sweden"],u:"1f1f8-1f1ea",a:"2"},{n:["SG","flag","flag: Singapore","flag: singapore"],u:"1f1f8-1f1ec",a:"2"},{n:["SH","flag","flag: St. Helena","flag: st. helena"],u:"1f1f8-1f1ed",a:"2"},{n:["SI","flag","flag: Slovenia","flag: slovenia"],u:"1f1f8-1f1ee",a:"2"},{n:["SJ","flag","flag: Svalbard & Jan Mayen","flag: svalbard & jan mayen"],u:"1f1f8-1f1ef",a:"2"},{n:["SK","flag","flag: Slovakia","flag: slovakia"],u:"1f1f8-1f1f0",a:"2"},{n:["SL","flag","flag: Sierra Leone","flag: sierra leone"],u:"1f1f8-1f1f1",a:"2"},{n:["SM","flag","flag: San Marino","flag: san marino"],u:"1f1f8-1f1f2",a:"2"},{n:["SN","flag","flag: Senegal","flag: senegal"],u:"1f1f8-1f1f3",a:"2"},{n:["SO","flag","flag: Somalia","flag: somalia"],u:"1f1f8-1f1f4",a:"2"},{n:["SR","flag","flag: Suriname","flag: suriname"],u:"1f1f8-1f1f7",a:"2"},{n:["SS","flag","flag: South Sudan","flag: south sudan"],u:"1f1f8-1f1f8",a:"2"},{n:["ST","flag","flag: So Tom & Prncipe","flag: so tom & prncipe"],u:"1f1f8-1f1f9",a:"2"},{n:["SV","flag","flag: El Salvador","flag: el salvador"],u:"1f1f8-1f1fb",a:"2"},{n:["SX","flag","flag: Sint Maarten","flag: sint maarten"],u:"1f1f8-1f1fd",a:"2"},{n:["SY","flag","flag: Syria","flag: syria"],u:"1f1f8-1f1fe",a:"2"},{n:["SZ","flag","flag: Eswatini","flag: eswatini"],u:"1f1f8-1f1ff",a:"2"},{n:["TA","flag","flag: Tristan da Cunha","flag: tristan da cunha"],u:"1f1f9-1f1e6",a:"2"},{n:["TC","flag","flag: Turks & Caicos Islands","flag: turks & caicos islands"],u:"1f1f9-1f1e8",a:"2"},{n:["TD","flag","flag: Chad","flag: chad"],u:"1f1f9-1f1e9",a:"2"},{n:["TF","flag","flag: French Southern Territories","flag: french southern territories"],u:"1f1f9-1f1eb",a:"2"},{n:["TG","flag","flag: Togo","flag: togo"],u:"1f1f9-1f1ec",a:"2"},{n:["TH","flag","flag: Thailand","flag: thailand"],u:"1f1f9-1f1ed",a:"2"},{n:["TJ","flag","flag: Tajikistan","flag: tajikistan"],u:"1f1f9-1f1ef",a:"2"},{n:["TK","flag","flag: Tokelau","flag: tokelau"],u:"1f1f9-1f1f0",a:"2"},{n:["TL","flag","flag: Timor Leste","flag: timor leste"],u:"1f1f9-1f1f1",a:"2"},{n:["TM","flag","flag: Turkmenistan","flag: turkmenistan"],u:"1f1f9-1f1f2",a:"2"},{n:["TN","flag","flag: Tunisia","flag: tunisia"],u:"1f1f9-1f1f3",a:"2"},{n:["TO","flag","flag: Tonga","flag: tonga"],u:"1f1f9-1f1f4",a:"2"},{n:["TR","flag","flag: Trkiye","flag: trkiye"],u:"1f1f9-1f1f7",a:"2"},{n:["TT","flag","flag: Trinidad & Tobago","flag: trinidad & tobago"],u:"1f1f9-1f1f9",a:"2"},{n:["TV","flag","flag: Tuvalu","flag: tuvalu"],u:"1f1f9-1f1fb",a:"2"},{n:["TW","flag","flag: Taiwan","flag: taiwan"],u:"1f1f9-1f1fc",a:"2"},{n:["TZ","flag","flag: Tanzania","flag: tanzania"],u:"1f1f9-1f1ff",a:"2"},{n:["UA","flag","flag: Ukraine","flag: ukraine"],u:"1f1fa-1f1e6",a:"2"},{n:["UG","flag","flag: Uganda","flag: uganda"],u:"1f1fa-1f1ec",a:"2"},{n:["UM","flag","flag: U.S. Outlying Islands","flag: u.s. outlying islands"],u:"1f1fa-1f1f2",a:"2"},{n:["UN","flag","flag: United Nations","flag: united nations"],u:"1f1fa-1f1f3",a:"4"},{n:["US","flag","flag: United States","flag: united states"],u:"1f1fa-1f1f8",a:"0.6"},{n:["UY","flag","flag: Uruguay","flag: uruguay"],u:"1f1fa-1f1fe",a:"2"},{n:["UZ","flag","flag: Uzbekistan","flag: uzbekistan"],u:"1f1fa-1f1ff",a:"2"},{n:["VA","flag","flag: Vatican City","flag: vatican city"],u:"1f1fb-1f1e6",a:"2"},{n:["VC","flag","flag: St. Vincent & Grenadines","flag: st. vincent & grenadines"],u:"1f1fb-1f1e8",a:"2"},{n:["VE","flag","flag: Venezuela","flag: venezuela"],u:"1f1fb-1f1ea",a:"2"},{n:["VG","flag","flag: British Virgin Islands","flag: british virgin islands"],u:"1f1fb-1f1ec",a:"2"},{n:["VI","flag","flag: U.S. Virgin Islands","flag: u.s. virgin islands"],u:"1f1fb-1f1ee",a:"2"},{n:["VN","flag","flag: Vietnam","flag: vietnam"],u:"1f1fb-1f1f3",a:"2"},{n:["VU","flag","flag: Vanuatu","flag: vanuatu"],u:"1f1fb-1f1fa",a:"2"},{n:["WF","flag","flag: Wallis & Futuna","flag: wallis & futuna"],u:"1f1fc-1f1eb",a:"2"},{n:["WS","flag","flag: Samoa","flag: samoa"],u:"1f1fc-1f1f8",a:"2"},{n:["XK","flag","flag: Kosovo","flag: kosovo"],u:"1f1fd-1f1f0",a:"2"},{n:["YE","flag","flag: Yemen","flag: yemen"],u:"1f1fe-1f1ea",a:"2"},{n:["YT","flag","flag: Mayotte","flag: mayotte"],u:"1f1fe-1f1f9",a:"2"},{n:["ZA","flag","flag: South Africa","flag: south africa"],u:"1f1ff-1f1e6",a:"2"},{n:["ZM","flag","flag: Zambia","flag: zambia"],u:"1f1ff-1f1f2",a:"2"},{n:["ZW","flag","flag: Zimbabwe","flag: zimbabwe"],u:"1f1ff-1f1fc",a:"2"},{n:["flag","gbeng","flag: England","flag: england"],u:"1f3f4-e0067-e0062-e0065-e006e-e0067-e007f",a:"5"},{n:["flag","gbsct","flag: Scotland","flag: scotland"],u:"1f3f4-e0067-e0062-e0073-e0063-e0074-e007f",a:"5"},{n:["flag","gbwls","flag: Wales","flag: wales"],u:"1f3f4-e0067-e0062-e0077-e006c-e0073-e007f",a:"5"}]},f$={categories:cht,emojis:uht};function h$(e){var t;return(t=e[si.name])!=null?t:[]}function zte(e){if(!e)return"";var t=h$(e);return t[t.length-1]}function vve(e){var t=e.split("-"),r=t.splice(1,1),n=r[0];return u$[n]?t.join("-"):e}function El(e,t){var r,n=e[si.unified];return!t||!S0(e)?n:(r=fht(e,t))!=null?r:n}function dht(){var e=Eve(),t=y$(),r=t[0],n=le.useMemo(function(){var a,i=(a=p$(e))!=null?a:[];return i.map(function(s){return m$(s.unified)}).filter(Boolean)},[r,e]);return function(i){var s;return i===Vt.SUGGESTED?n:(s=f$.emojis[i])!=null?s:[]}}function G2(e){var t;return(t=e[si.variations])!=null?t:[]}function S0(e){return G2(e).length>0}function fht(e,t){return t?G2(e).find(function(r){return r.includes(t)}):El(e)}function m$(e){if(e){if(Hk[e])return Hk[e];var t=vve(e);return Hk[t]}}var hht=Object.values(f$.emojis).flat(),Hk={};hht.reduce(function(e,t){return e[El(t)]=t,S0(t)&&G2(t).forEach(function(r){e[r]=t}),e},Hk);function mht(e){var t=e.split("-"),r=t[1];return CC.includes(r)?r:null}var bve="epr_suggested";function p$(e){try{var t,r,n;if(!((t=window)!=null&&t.localStorage))return[];var a=JSON.parse((r=(n=window)==null?void 0:n.localStorage.getItem(bve))!=null?r:"[]");return e===Hg.FREQUENT?a.sort(function(i,s){return s.count-i.count}):a}catch{return[]}}function pht(e,t){var r=p$(),n=El(e,t),a=El(e),i=r.find(function(c){var u=c.unified;return u===n}),s;i?s=[i].concat(r.filter(function(c){return c!==i})):(i={unified:n,original:a,count:0},s=[i].concat(r)),i.count++,s.length=Math.min(s.length,14);try{var l;(l=window)==null||l.localStorage.setItem(bve,JSON.stringify(s))}catch{}}var yve=le.createContext({emojiData:{},allEmojis:[],allEmojisByUnified:{},searchIndex:{},emojiByUnified:function(){},activeVariationFromUnified:function(){return null}});function ght(e){var t=e.children,r=Ln(),n=r.customEmojis,a=r.emojiData,i=le.useMemo(function(){var l=a||f$,c=JSON.parse(JSON.stringify(l));n&&n.length>0&&(c.emojis[Vt.CUSTOM]=n.map(bht));var u=c.emojis||{},d=Object.values(u).flat(),f={},m={};return d.forEach(function(p){var v=p[si.unified];if(f[v]=p,p[si.variations]){var b;(b=p[si.variations])==null||b.forEach(function(S){f[S]=p})}var y=(p[si.name]||[]).join("").toLowerCase().split("");y.forEach(function(S){var _;m[S]=(_=m[S])!=null?_:{},m[S][v]=p})}),{emojiData:c,allEmojis:d,allEmojisByUnified:f,searchIndex:m}},[a,n]),s=le.useCallback(function(l){var c;if(l){var u=(c=i.allEmojisByUnified[l])!=null?c:i.allEmojisByUnified[lve(l)];return u}},[i.allEmojisByUnified]);return le.createElement(yve.Provider,{value:pn({},i,{emojiByUnified:s,activeVariationFromUnified:Jft})},t)}function E1(){return le.useContext(yve)}function vht(){var e=E1(),t=e.emojiData,r=e.emojiByUnified,n=Eve(),a=y$(),i=a[0],s=le.useMemo(function(){var l,c=(l=p$(n))!=null?l:[];return c.map(function(u){return r(u.unified)}).filter(Boolean)},[i,n,r]);return function(c){var u,d;return c===Vt.SUGGESTED?s:(u=(d=t.emojis)==null?void 0:d[c])!=null?u:[]}}function bht(e){var t;return t={},t[si.name]=e.names.map(function(r){return r.toLowerCase()}),t[si.unified]=e.id.toLowerCase(),t[si.added_in]="0",t[si.imgUrl]=e.imgUrl,t}function yht(){var e=Bht();return function(t){return e.has(t)}}function xve(){var e=w.useRef({}),t=zht(),r=E1(),n=r.allEmojis;return w.useMemo(function(){var a=parseFloat(""+t);return!t||Number.isNaN(a)?e.current:n.reduce(function(i,s){return wht(s,a)&&(i[om(s)]=!0),i},e.current)},[t,n])}function xht(){var e=xve(),t=yht();return function(n){var a=lve(om(n));return!!(e[a]||t(a))}}function wht(e,t){return Gft(e)>t}function Sht(e){w.useEffect(function(){e(!0)},[e])}function kht(e){var t=e.children,r=xve(),n=Eht(),a=Pht(),i=E1(),s=i.searchIndex,l=w.useRef(s);w.useEffect(function(){l.current=s},[s]);var c=w.useRef(!1),u=w.useRef(!1),d=w.useRef(r),f=Pte(Date.now(),200),m=Pte("",100),p=w.useState(!1),v=w.useState(n),b=w.useState(null),y=w.useState(new Set),S=w.useState(null),_=w.useState(a),N=w.useState(!1),k=N[0],j=N[1],E=w.useState([]),T=w.useState(null);return Sht(j),w.createElement($s.Provider,{value:{activeCategoryState:b,activeSkinTone:v,disallowClickRef:c,disallowMouseRef:u,disallowedEmojisRef:d,emojiVariationPickerState:S,emojisThatFailedToLoadState:y,filterRef:l,isPastInitialLoad:k,searchTerm:m,skinToneFanOpenState:p,suggestedUpdateState:f,reactionsModeState:_,visibleCategoriesState:E,emojiSizeState:T}},t)}var $s=w.createContext({activeCategoryState:[null,function(){}],activeSkinTone:[Uo.NEUTRAL,function(){}],disallowClickRef:{current:!1},disallowMouseRef:{current:!1},disallowedEmojisRef:{current:{}},emojiVariationPickerState:[null,function(){}],emojisThatFailedToLoadState:[new Set,function(){}],filterRef:{current:{}},isPastInitialLoad:!0,searchTerm:["",function(){return new Promise(function(){})}],skinToneFanOpenState:[!1,function(){}],suggestedUpdateState:[Date.now(),function(){}],reactionsModeState:[!1,function(){}],visibleCategoriesState:[[],function(){return[]}],emojiSizeState:[null,function(){}]});function g$(){var e=w.useContext($s),t=e.filterRef;return t}function _ht(){var e=w.useContext($s),t=e.disallowClickRef;return t}function v$(){var e=w.useContext($s),t=e.disallowMouseRef;return t}function lm(){var e=w.useContext($s),t=e.reactionsModeState;return t}function V2(){var e=w.useContext($s),t=e.searchTerm;return t}function Y2(){var e=w.useContext($s),t=e.activeSkinTone;return t}function wve(){var e=w.useContext($s),t=e.emojisThatFailedToLoadState;return t}function k0(){var e=w.useContext($s),t=e.emojiVariationPickerState;return t}function M1(){var e=w.useContext($s),t=e.skinToneFanOpenState;return t}function b$(){var e=w.useContext($s),t=e.visibleCategoriesState;return t}function Sve(){var e=w.useContext($s),t=e.emojiSizeState;return t}function y$(){var e=w.useContext($s),t=e.suggestedUpdateState,r=t[0],n=t[1];return[r,function(){n(Date.now())}]}var kve=le.createContext({});function _ve(){var e=le.useContext(kve);return e}function Nht(e){var t=le.useRef({onEmojiClick:e.onEmojiClick||QS,onReactionClick:e.onReactionClick||e.onEmojiClick,onSkinToneChange:e.onSkinToneChange||QS});return le.useEffect(function(){t.current.onEmojiClick=e.onEmojiClick||QS,t.current.onReactionClick=e.onReactionClick||e.onEmojiClick},[e.onEmojiClick,e.onReactionClick]),le.useEffect(function(){t.current.onSkinToneChange=e.onSkinToneChange||QS},[e.onSkinToneChange]),t}function QS(){}var wx;(function(e){e.REACTIONS="reactions",e.PICKER="picker"})(wx||(wx={}));function Cht(){var e,t=Ln(),r=t.searchPlaceHolder,n=t.searchPlaceholder;return(e=[r,n].find(function(a){return a!==jC}))!=null?e:jC}function jht(){var e=Ln(),t=e.searchClearButtonLabel;return t??hve}function Eht(){var e=Ln(),t=e.defaultSkinTone;return t}function Nve(){var e=Ln(),t=e.allowExpandReactions;return t}function Cve(){var e=Ln(),t=e.skinTonesDisabled;return t}function cm(){var e=Ln(),t=e.emojiStyle;return t}function Mht(){var e=Ln(),t=e.autoFocusSearch;return t}function x$(){var e=Ln(),t=e.categories;return t}function Tht(){var e=Ln(),t=e.customEmojis;return t}function Aht(){var e=Ln(),t=e.open;return t}function Dht(e){var t=_ve(),r=t.current,n=lm(),a=n[1],i=r.onEmojiClick||function(){},s=r.onReactionClick;return e===wx.REACTIONS&&s?function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return s.apply(void 0,c.concat([{collapseToReactions:function(){a(function(f){return f})}}]))}:function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];i.apply(void 0,c.concat([{collapseToReactions:function(){a(!0)}}]))}}function Lht(){var e=_ve(),t=e.current;return t.onSkinToneChange||function(){}}function jve(){var e=Ln(),t=e.previewConfig;return t}function Oht(){var e=Ln(),t=e.theme;return t}function Eve(){var e=Ln(),t=e.suggestedEmojisMode;return t}function Mve(){var e=Ln(),t=e.lazyLoadEmojis;return t}function Iht(){var e=Ln(),t=e.className;return t}function Rht(){var e=Ln(),t=e.height,r=e.width,n=e.style;return pn({height:Bte(t),width:Bte(r)},n)}function Pht(){var e=Ln(),t=e.reactionsDefaultOpen;return t}function zht(){var e=Ln(),t=e.emojiVersion;return t}function Tve(){var e=Ln(),t=e.searchDisabled;return t}function Ave(){var e=Ln(),t=e.skinTonePickerLocation;return t}function Bht(){var e=Ln(),t=e.unicodeToHide;return t}function $ht(){var e=Ln(),t=e.reactions;return t}function um(){var e=Ln(),t=e.getEmojiUrl;return t}function Bte(e){return typeof e=="number"?e+"px":e}function Fht(e){var t=e>0,r=e>1;return t?r?aht.replace("%n",e.toString()):nht:rht}function Q2(){var e=V2(),t=e[0];return!!t}function Fs(e){e&&requestAnimationFrame(function(){e.focus()})}function Dve(e){if(e){var t=e.previousElementSibling;Fs(t)}}function Lve(e){if(e){var t=e.nextElementSibling;Fs(t)}}function Ove(e){if(e){var t=e.firstElementChild;Fs(t)}}function Sx(){return document.activeElement}function Uht(e){var t=e.children,r=w.useRef(null),n=w.useRef(null),a=w.useRef(null),i=w.useRef(null),s=w.useRef(null),l=w.useRef(null),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null);return w.createElement(Ive.Provider,{value:{AnchoredEmojiRef:n,BodyRef:a,EmojiListRef:i,CategoryNavigationRef:c,PickerMainRef:r,SearchInputRef:s,SkinTonePickerRef:l,VariationPickerRef:u,ReactionsRef:d}},t)}var Ive=w.createContext({AnchoredEmojiRef:w.createRef(),BodyRef:w.createRef(),CategoryNavigationRef:w.createRef(),EmojiListRef:w.createRef(),PickerMainRef:w.createRef(),SearchInputRef:w.createRef(),SkinTonePickerRef:w.createRef(),VariationPickerRef:w.createRef(),ReactionsRef:w.createRef()});function xu(){return w.useContext(Ive)}function Rve(){return xu().EmojiListRef}function _0(){return xu().PickerMainRef}function J2(){return xu().AnchoredEmojiRef}function Pve(){var e=J2();return function(t){t===null&&e.current!==null&&Fs(e.current),e.current=t}}function Us(){return xu().BodyRef}function Hht(){return xu().ReactionsRef}function Gd(){return xu().SearchInputRef}function w$(){return xu().SkinTonePickerRef}function S$(){return xu().CategoryNavigationRef}function qht(){return xu().VariationPickerRef}function zve(e,t){t===void 0&&(t=0);var r=Jve(e);r&&requestAnimationFrame(function(){r.scrollTop=t})}function Wht(e,t){var r=Jve(e);r&&requestAnimationFrame(function(){r.scrollTop=r.scrollTop+t})}function Kht(){var e=Us();return w.useCallback(function(t){requestAnimationFrame(function(){e.current&&(e.current.scrollTop=t)})},[e])}function Z2(e){if(!(!e||!Amt(e))&&!e.closest(Co(Mr.variationPicker))){var t=Xve(e),r=Zve(e);Wht(t,-(j$(Vd(e))-r))}}function X2(e){var t=A$(e);Fs(t),Z2(t)}function Ght(e){var t=A$(e);Fs(t),t?.click()}function Vht(e){Fs(nbe(e))}function Yht(e){if(e){var t=abe(e);if(!t)return X2(tE(e));Fs(t),Z2(t)}}function Qht(e){if(e){var t=T$(e);if(!t)return Vht(eE(e));Fs(t),Z2(t)}}function Jht(e,t){if(e){var r=Xht(e);if(!r)return t();Fs(r),Z2(r)}}function Zht(e){if(e){var t=emt(e);return Fs(t)}}function Xht(e){if(!e)return null;var t=ibe(e),r=Vd(t),n=Vve(t,e),a=Wg(r),i=a.indexOf(e),s=i%n;if(i===-1)return null;if(a[i-n])return a[i-n];var l=eE(r);if(!l)return null;var c=Wg(l),u=c.length%n-1;if(s>u)return c.at(-1);for(var d=c.length-1;d>=0;d--)if(d%n===s)return c[d];return c.at(-1)}function emt(e){var t;if(!e)return null;var r=ibe(e),n=Vd(r),a=Vve(r,e),i=Wg(n),s=i.indexOf(e);if(s===-1)return null;var l=a-s%a-1,c=s+l+1;if(i[c]){for(var u=s+a;u%a>=0;u--)if(i[u])return i[u]}var d=s%a,f=tE(n),m=Wg(f);return m[d]?m[d]:(t=m.at(0))!=null?t:null}function dm(){var e=k0(),t=e[0],r=e[1],n=M1(),a=n[0],i=n[1],s=w.useCallback(function(){t&&r(null),a&&i(!1)},[t,a,r,i]);return s}function Bve(){var e=k0(),t=e[0],r=M1(),n=r[0];return function(){return!!t||n}}function tmt(){var e=v$();return function(){e.current=!0}}function $ve(){var e=v$();return function(){e.current=!1}}function Fve(){var e=v$();return function(){return e.current}}function rmt(){var e=Us(),t=$ve(),r=Fve();w.useEffect(function(){var n=e.current;n?.addEventListener("mousemove",a,{passive:!0});function a(){r()&&t()}return function(){n?.removeEventListener("mousemove",a)}},[e,t,r])}function fm(){var e=Gd();return w.useCallback(function(){Fs(e.current)},[e])}function nmt(){var e=w$();return w.useCallback(function(){e.current&&Ove(e.current)},[e])}function Uve(){var e=S$();return w.useCallback(function(){e.current&&Ove(e.current)},[e])}function amt(){var e=g$();return function t(r){if(typeof r=="function")return t(r(e.current));e.current=r}}function Hve(){var e=k$(),t=Gd(),r=fm();return function(){t.current&&(t.current.value=""),e(""),r()}}function imt(){var e=Gd(),t=k$();return function(n){e.current?(e.current.value=""+e.current.value+n,t($te(e.current.value))):t($te(n))}}function smt(){var e=Gd(),t=g$(),r=amt(),n=k$(),a=V2(),i=a[0],s=fmt(t.current,i);return{onChange:l,searchTerm:i,SearchInputRef:e,statusSearchResults:s};function l(c){var u=t.current,d=c.toLowerCase();if(u!=null&&u[d]||d.length<=1)return n(d);var f=dmt(d,u);if(!f)return n(d);r(function(m){var p;return Object.assign(m,(p={},p[d]=omt(f,d),p))}),n(d)}}function k$(){var e=V2(),t=e[1],r=_0();return function(a){requestAnimationFrame(function(){t(a&&a?.toLowerCase()).then(function(){zve(r.current,0)})})}}function omt(e,t){var r={};for(var n in e){var a=e[n];lmt(a,t)&&(r[n]=a)}return r}function lmt(e,t){return ove(e).some(function(r){return r.includes(t)})}function cmt(){var e=g$(),t=e.current,r=V2(),n=r[0];return function(a){return umt(a,t,n)}}function umt(e,t,r){var n;return!t||!r?!1:!((n=t[r])!=null&&n[e])}function dmt(e,t){if(!t)return null;if(t[e])return t[e];var r=Object.keys(t).sort(function(n,a){return a.length-n.length}).find(function(n){return e.includes(n)});return r?t[r]:null}function $te(e){return!e||typeof e!="string"?"":e.trim().toLowerCase()}function fmt(e,t){var r;if(!(e!=null&&e[t]))return"";var n=((r=Object.entries(e?.[t]))==null?void 0:r.length)||0;return Fht(n)}function qve(){var e=Pve(),t=k0(),r=t[1];return function(a){var i=C$(a),s=i[0];s&&(e(a),r(s))}}function _$(){var e=Ave();return e===qg.SEARCH}function Wve(){var e=Ave();return e===qg.PREVIEW}var ma;(function(e){e.ArrowDown="ArrowDown",e.ArrowUp="ArrowUp",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.Escape="Escape",e.Enter="Enter",e.Space=" "})(ma||(ma={}));function hmt(){mmt(),pmt(),gmt(),vmt(),bmt()}function mmt(){var e=_0(),t=Hve(),r=Kht(),n=Gd(),a=fm(),i=Bve(),s=tmt(),l=dm(),c=w.useMemo(function(){return function(d){var f=d.key;switch(s(),f){case ma.Escape:if(d.preventDefault(),i()){l();return}t(),r(0),a();break}}},[r,t,l,a,i,s]);w.useEffect(function(){var u=e.current;if(u)return u.addEventListener("keydown",c),function(){u.removeEventListener("keydown",c)}},[e,n,r,c])}function pmt(){var e=nmt(),t=_0(),r=Us(),n=Gd(),a=M1(),i=a[1],s=Kve(),l=_$(),c=w.useMemo(function(){return function(d){var f=d.key;switch(f){case ma.ArrowRight:if(!l)return;d.preventDefault(),i(!0),e();break;case ma.ArrowDown:d.preventDefault(),s();break;case ma.Enter:d.preventDefault(),Ght(r.current);break}}},[e,s,i,r,l]);w.useEffect(function(){var u=n.current;if(u)return u.addEventListener("keydown",c),function(){u.removeEventListener("keydown",c)}},[t,n,c])}function gmt(){var e=w$(),t=fm(),r=Gd(),n=Kve(),a=M1(),i=a[0],s=a[1],l=Wve(),c=_$(),u=N$(),d=w.useMemo(function(){return(function(m){var p=m.key;if(c)switch(p){case ma.ArrowLeft:if(m.preventDefault(),!i)return t();Fte(t);break;case ma.ArrowRight:if(m.preventDefault(),!i)return t();Ute();break;case ma.ArrowDown:m.preventDefault(),i&&s(!1),n();break;default:u(m);break}if(l)switch(p){case ma.ArrowUp:if(m.preventDefault(),!i)return t();Fte(t);break;case ma.ArrowDown:if(m.preventDefault(),!i)return t();Ute();break;default:u(m);break}})},[i,t,s,n,u,l,c]);w.useEffect(function(){var f=e.current;if(f)return f.addEventListener("keydown",d),function(){f.removeEventListener("keydown",d)}},[e,r,i,d])}function vmt(){var e=fm(),t=S$(),r=Us(),n=N$(),a=w.useMemo(function(){return function(s){var l=s.key;switch(l){case ma.ArrowUp:s.preventDefault(),e();break;case ma.ArrowRight:s.preventDefault(),Lve(Sx());break;case ma.ArrowLeft:s.preventDefault(),Dve(Sx());break;case ma.ArrowDown:s.preventDefault(),X2(r.current);break;default:n(s);break}}},[r,e,n]);w.useEffect(function(){var i=t.current;if(i)return i.addEventListener("keydown",a),function(){i.removeEventListener("keydown",a)}},[t,r,a])}function bmt(){var e=Us(),t=ymt(),r=qve(),n=Bve(),a=dm(),i=N$(),s=w.useMemo(function(){return(function(c){var u=c.key,d=Jo(Sx());switch(u){case ma.ArrowRight:c.preventDefault(),Yht(d);break;case ma.ArrowLeft:c.preventDefault(),Qht(d);break;case ma.ArrowDown:if(c.preventDefault(),n()){a();break}Zht(d);break;case ma.ArrowUp:if(c.preventDefault(),n()){a();break}Jht(d,t);break;case ma.Space:c.preventDefault(),r(c.target);break;default:i(c);break}})},[t,i,r,n,a]);w.useEffect(function(){var l=e.current;if(l)return l.addEventListener("keydown",s),function(){l.removeEventListener("keydown",s)}},[e,s])}function Kve(){var e=Uve(),t=Q2(),r=Us();return w.useCallback(function(){return t?X2(r.current):e()},[r,e,t])}function ymt(){var e=fm(),t=Uve(),r=Q2();return w.useCallback(function(){return r?e():t()},[e,r,t])}function Fte(e){var t=Sx();t&&(Emt(t)||e(),Lve(t))}function Ute(){var e=Sx();e&&Dve(e)}function N$(){var e=imt(),t=fm(),r=Tve(),n=dm();return function(i){var s=i.key;xmt(i)||r||s.match(/(^[a-zA-Z0-9]$){1}/)&&(i.preventDefault(),n(),t(),e(s))}}function xmt(e){var t=e.metaKey,r=e.ctrlKey,n=e.altKey;return t||r||n}function wmt(e,t,r,n,a,i,s,l){if(e&&t!==As.NATIVE){var c=om(e);i5.has(c)||!i||!s||setTimeout(function(){var u=a+i.top,d=r+n,f=u>=d&&u<d+s.emojiSize*2;f&&Gve(l,e,t)})}}function Gve(e,t,r){if(t){var n=om(t);i5.has(n)||(i5.add(n),d$(t).concat(n).forEach(function(a){var i=e(a,r);Smt(i)}))}}var i5=new Set;function Smt(e){var t=new Image;t.src=e}function kmt(){var e=Us(),t=cm(),r=um();w.useEffect(function(){if(t===As.NATIVE)return;var n=e.current;return n?.addEventListener("focusin",a),function(){n?.removeEventListener("focusin",a)};function a(i){var s=Jo(i.target);if(s){var l=C$(s),c=l[0];c&&S0(c)&&Gve(r,c,t)}}},[e,t,r])}var _mt=["width","height"],s5=40;function Nmt(e){var t=e.children;return w.createElement(kht,null,w.createElement(Cmt,null,t))}function Cmt(e){var t,r=e.children,n=lm(),a=n[0],i=Oht(),s=Q2(),l=_0(),c=Iht(),u=Rht();hmt(),kmt();var d=u||{},f=d.width,m=d.height,p=ive(d,_mt);return w.createElement("aside",{className:kr(Hv.main,Hv.baseVariables,i===Dd.DARK&&Hv.darkTheme,i===Dd.AUTO&&Hv.autoThemeDark,(t={},t[Mr.searchActive]=s,t),a&&Hv.reactionsMenu,c),ref:l,style:pn({},p,!a&&{height:m,width:f})},r)}var Hte={"--epr-emoji-variation-picker-bg-color":"var(--epr-dark-emoji-variation-picker-bg-color)","--epr-hover-bg-color-reduced-opacity":"var(--epr-dark-hover-bg-color-reduced-opacity)","--epr-highlight-color":"var(--epr-dark-highlight-color)","--epr-text-color":"var(--epr-dark-text-color)","--epr-hover-bg-color":"var(--epr-dark-hover-bg-color)","--epr-focus-bg-color":"var(--epr-dark-focus-bg-color)","--epr-search-input-bg-color":"var(--epr-dark-search-input-bg-color)","--epr-category-label-bg-color":"var(--epr-dark-category-label-bg-color)","--epr-picker-border-color":"var(--epr-dark-picker-border-color)","--epr-bg-color":"var(--epr-dark-bg-color)","--epr-reactions-bg-color":"var(--epr-dark-reactions-bg-color)","--epr-search-input-bg-color-active":"var(--epr-dark-search-input-bg-color-active)","--epr-emoji-variation-indicator-color":"var(--epr-dark-emoji-variation-indicator-color)","--epr-category-icon-active-color":"var(--epr-dark-category-icon-active-color)","--epr-skin-tone-picker-menu-color":"var(--epr-dark-skin-tone-picker-menu-color)","--epr-skin-tone-outer-border-color":"var(--epr-dark-skin-tone-outer-border-color)","--epr-skin-tone-inner-border-color":"var(--epr-dark-skin-tone-inner-border-color)"},Hv=Dn.create({main:{".":["epr-main",Mr.emojiPicker],position:"relative",display:"flex",flexDirection:"column",borderWidth:"1px",borderStyle:"solid",borderRadius:"var(--epr-picker-border-radius)",borderColor:"var(--epr-picker-border-color)",backgroundColor:"var(--epr-bg-color)",overflow:"hidden",transition:"height 0.3s ease-in-out, background-color 0.1s ease-in-out","*":{boxSizing:"border-box",fontFamily:"sans-serif"}},baseVariables:{"--":{"--epr-highlight-color":"#007aeb","--epr-hover-bg-color":"#e5f0fa","--epr-hover-bg-color-reduced-opacity":"#e5f0fa80","--epr-focus-bg-color":"#e0f0ff","--epr-text-color":"#858585","--epr-search-input-bg-color":"#f6f6f6","--epr-picker-border-color":"#e7e7e7","--epr-bg-color":"#fff","--epr-reactions-bg-color":"#ffffff90","--epr-category-icon-active-color":"#6aa8de","--epr-skin-tone-picker-menu-color":"#ffffff95","--epr-skin-tone-outer-border-color":"#555555","--epr-skin-tone-inner-border-color":"var(--epr-bg-color)","--epr-horizontal-padding":"10px","--epr-picker-border-radius":"8px","--epr-header-padding":"15px var(--epr-horizontal-padding)","--epr-active-skin-tone-indicator-border-color":"var(--epr-highlight-color)","--epr-active-skin-hover-color":"var(--epr-hover-bg-color)","--epr-search-input-bg-color-active":"var(--epr-search-input-bg-color)","--epr-search-input-padding":"0 30px","--epr-search-input-border-radius":"8px","--epr-search-input-height":"40px","--epr-search-input-text-color":"var(--epr-text-color)","--epr-search-input-placeholder-color":"var(--epr-text-color)","--epr-search-bar-inner-padding":"var(--epr-horizontal-padding)","--epr-search-border-color":"var(--epr-search-input-bg-color)","--epr-search-border-color-active":"var(--epr-highlight-color)","--epr-category-navigation-button-size":"30px","--epr-emoji-variation-picker-height":"45px","--epr-emoji-variation-picker-bg-color":"var(--epr-bg-color)","--epr-preview-height":"70px","--epr-preview-text-size":"14px","--epr-preview-text-padding":"0 var(--epr-horizontal-padding)","--epr-preview-border-color":"var(--epr-picker-border-color)","--epr-preview-text-color":"var(--epr-text-color)","--epr-category-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-bg-color":"#ffffffe6","--epr-category-label-text-color":"var(--epr-text-color)","--epr-category-label-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-height":s5+"px","--epr-emoji-size":"30px","--epr-emoji-padding":"5px","--epr-emoji-fullsize":"calc(var(--epr-emoji-size) + var(--epr-emoji-padding) * 2)","--epr-emoji-hover-color":"var(--epr-hover-bg-color)","--epr-emoji-variation-indicator-color":"var(--epr-picker-border-color)","--epr-emoji-variation-indicator-color-hover":"var(--epr-text-color)","--epr-header-overlay-z-index":"3","--epr-emoji-variations-indictator-z-index":"1","--epr-category-label-z-index":"2","--epr-skin-variation-picker-z-index":"5","--epr-preview-z-index":"6","--epr-dark":"#000","--epr-dark-emoji-variation-picker-bg-color":"var(--epr-dark)","--epr-dark-highlight-color":"#c0c0c0","--epr-dark-text-color":"var(--epr-highlight-color)","--epr-dark-hover-bg-color":"#363636f6","--epr-dark-hover-bg-color-reduced-opacity":"#36363680","--epr-dark-focus-bg-color":"#474747","--epr-dark-search-input-bg-color":"#333333","--epr-dark-category-label-bg-color":"#222222e6","--epr-dark-picker-border-color":"#151617","--epr-dark-bg-color":"#222222","--epr-dark-reactions-bg-color":"#22222290","--epr-dark-search-input-bg-color-active":"var(--epr-dark)","--epr-dark-emoji-variation-indicator-color":"#444","--epr-dark-category-icon-active-color":"#3271b7","--epr-dark-skin-tone-picker-menu-color":"#22222295","--epr-dark-skin-tone-outer-border-color":"var(--epr-dark-picker-border-color)","--epr-dark-skin-tone-inner-border-color":"#00000000"}},autoThemeDark:{".":Mr.autoTheme,"@media (prefers-color-scheme: dark)":{"--":Hte}},darkTheme:{".":Mr.darkTheme,"--":Hte},reactionsMenu:{".":"epr-reactions",height:"50px",display:"inline-flex",backgroundColor:"var(--epr-reactions-bg-color)",backdropFilter:"blur(8px)","--":{"--epr-picker-border-radius":"50px"}}});function Vve(e,t){if(!e||!t)return 0;var r=e.getBoundingClientRect().width,n=t.getBoundingClientRect().width;return Math.floor(r/n)}function jmt(e,t,r){if(!e||!t.length)return null;var n=e.getBoundingClientRect().top,a=e.getBoundingClientRect().bottom,i=n+Yve(e),s=t.find(function(l){var c=l.getBoundingClientRect().top,u=l.getBoundingClientRect().bottom,d=l.clientHeight*r,f=c+d,m=u-d;return f<i?!1:f>=n&&f<=a||m>=n&&m<=a});return s||null}function Emt(e){return!!e.nextElementSibling}function Yve(e){if(!e)return s5;var t=e.querySelector(Co(Mr.label));if(t){var r=t.getBoundingClientRect().height;if(r>0)return r}return s5}var kx="button"+Co(Mr.emoji),Mmt=[kx,Co(Mr.visible),":not("+Co(Mr.hidden)+")"].join("");function Jo(e){var t;return(t=e?.closest(kx))!=null?t:null}function C$(e){var t=ebe(e),r=E$(e);if(!t)return[];var n=m$(r??t);return n?[n,r]:[]}function Tmt(e){var t;return!!(e?.matches(kx)||!(e==null||(t=e.parentElement)==null)&&t.matches(kx))}function qte(e){var t;return(t=e?.clientHeight)!=null?t:0}function Qve(e){if(!e)return 0;var t=Jo(e),r=Vd(t),n=j$(r);return Wte(t)+Wte(r)+n}function j$(e){var t,r;if(!e)return 0;var n=e.querySelector(Co(Mr.categoryContent));return((t=e?.clientHeight)!=null?t:0)-((r=n?.clientHeight)!=null?r:0)}function Amt(e){return e?Zve(e)<j$(Vd(e)):!1}function Jve(e){return e?e.matches(Co(Mr.scrollBody))?e:e.querySelector(Co(Mr.scrollBody)):null}function Zve(e){var t,r;return e?Qve(e)-((t=(r=Xve(e))==null?void 0:r.scrollTop)!=null?t:0):0}function Xve(e){var t;return e&&(t=e.closest(Co(Mr.scrollBody)))!=null?t:null}function Dmt(e){var t=Jo(e),r=Vd(t);return Kte(t)+Kte(r)}function Wte(e){var t;return(t=e?.offsetTop)!=null?t:0}function Kte(e){var t;return(t=e?.offsetLeft)!=null?t:0}function E$(e){var t;return(t=Lmt(Jo(e),"unified"))!=null?t:null}function ebe(e){var t=E$(e);return t?vve(t):null}function tbe(e){return e?{unified:E$(e),originalUnified:ebe(e)}:{unified:null,originalUnified:null}}function Lmt(e,t){var r;return(r=Omt(e)[t])!=null?r:null}function Omt(e){var t;return(t=e?.dataset)!=null?t:{}}function M$(e){return e.classList.contains(Mr.visible)}function rbe(e){return e?e.classList.contains(Mr.hidden):!0}function Wg(e){return e?Array.from(e.querySelectorAll(Mmt)):[]}function nbe(e){if(!e)return null;var t=Wg(e),r=t.slice(-1),n=r[0];return n?M$(n)?n:T$(n):null}function abe(e){var t=e.nextElementSibling;return t?M$(t)?t:abe(t):A$(tE(e))}function T$(e){var t=e.previousElementSibling;return t?M$(t)?t:T$(t):nbe(eE(e))}function A$(e){if(!e)return null;var t=Wg(e);return jmt(e,t,.1)}function eE(e){var t=Vd(e);if(!t)return null;var r=t.previousElementSibling;return r?rbe(r)?eE(r):r:null}function tE(e){var t=Vd(e);if(!t)return null;var r=t.nextElementSibling;return r?rbe(r)?tE(r):r:null}function Vd(e){return e?e.closest(Co(Mr.category)):null}function ibe(e){return e?e.closest(Co(Mr.categoryContent)):null}function sbe(e){return e.split("-").map(function(t){return String.fromCodePoint(parseInt(t,16))}).join("")}function Imt(e){return e.category===Vt.CUSTOM}function obe(e){return e.imgUrl!==void 0}function lbe(e,t){var r=w.useRef(),n=qve(),a=_ht(),i=k0(),s=i[1],l=dm(),c=Y2(),u=c[0],d=Dht(t),f=y$(),m=f[1],p=um(),v=cm(),b=w.useCallback(function(N){if(!a.current){l();var k=Gte(N),j=k[0],E=k[1];if(!(!j||!E)){var T=mht(E)||u;m(),pht(j,T),d(Rmt(j,T,v,p),N)}}},[u,l,a,d,m,p,v]),y=w.useCallback(function(N){var k;r.current&&clearTimeout(r.current);var j=Gte(N),E=j[0];!E||!S0(E)||(r.current=(k=window)==null?void 0:k.setTimeout(function(){a.current=!0,r.current=void 0,l(),n(N.target),s(E)},500))},[a,l,n,s]),S=w.useCallback(function(){r.current?(clearTimeout(r.current),r.current=void 0):a.current&&requestAnimationFrame(function(){a.current=!1})},[a]);w.useEffect(function(){if(e.current){var _=e.current;return _.addEventListener("click",b,{passive:!0}),_.addEventListener("mousedown",y,{passive:!0}),_.addEventListener("mouseup",S,{passive:!0}),function(){_?.removeEventListener("click",b),_?.removeEventListener("mousedown",y),_?.removeEventListener("mouseup",S)}}},[e,b,y,S])}function Gte(e){var t=e?.target;return Tmt(t)?C$(t):[]}function Rmt(e,t,r,n){var a=h$(e);if(obe(e)){var i=El(e);return{activeSkinTone:t,emoji:i,getImageUrl:function(){return e.imgUrl},imageUrl:e.imgUrl,isCustom:!0,names:a,unified:i,unifiedWithoutSkinTone:i}}var s=El(e,t);return{activeSkinTone:t,emoji:sbe(s),getImageUrl:function(c){return c===void 0&&(c=r??As.APPLE),n(s,c)},imageUrl:n(s,r??As.APPLE),isCustom:!1,names:a,unified:s,unifiedWithoutSkinTone:El(e)}}function T1(e){return w.createElement("button",Object.assign({type:"button"},e,{className:kr(Pmt.button,e.className)}),e.children)}var Pmt=Dn.create({button:{".":"epr-btn",cursor:"pointer",border:"0",background:"none",outline:"none"}});function zmt(e){var t,r=e.emojiNames,n=e.unified,a=e.hidden,i=e.hiddenOnSearch,s=e.showVariations,l=s===void 0?!0:s,c=e.hasVariations,u=e.children,d=e.className,f=e.noBackground,m=f===void 0?!1:f,p=e.style;return w.createElement(T1,{className:kr(KL.emoji,a&&c$.hidden,i&&sm.hiddenOnSearch,(t={},t[Mr.visible]=!a&&!i,t),!!(c&&l)&&KL.hasVariations,m&&KL.noBackground,d),"data-unified":n,"aria-label":Bmt(r),"data-full-name":r,style:p},u)}function Bmt(e){return e[e.length-1]}var KL=Dn.create({emoji:{".":Mr.emoji,position:"relative",width:"var(--epr-emoji-fullsize)",height:"var(--epr-emoji-fullsize)",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",borderRadius:"8px",overflow:"hidden",transition:"background-color 0.2s",":hover":{backgroundColor:"var(--epr-emoji-hover-color)"},":focus":{backgroundColor:"var(--epr-focus-bg-color)"}},noBackground:{background:"none",":hover":{backgroundColor:"transparent",background:"none"},":focus":{backgroundColor:"transparent",background:"none"}},hasVariations:{".":Mr.emojiHasVariations,":after":{content:"",display:"block",width:"0",height:"0",right:"0px",bottom:"1px",position:"absolute",borderLeft:"4px solid transparent",borderRight:"4px solid transparent",transform:"rotate(135deg)",borderBottom:"4px solid var(--epr-emoji-variation-indicator-color)",zIndex:"var(--epr-emoji-variations-indictator-z-index)"},":hover:after":{borderBottom:"4px solid var(--epr-emoji-variation-indicator-color-hover)"}}}),EC=Dn.create({external:{".":Mr.external,fontSize:"0"},common:{alignSelf:"center",justifySelf:"center",display:"block"}});function Vte(e){var t=e.emojiName,r=e.style,n=e.lazyLoad,a=n===void 0?!1:n,i=e.imgUrl,s=e.onError,l=e.className;return w.createElement("img",{src:i,alt:t,className:kr($mt.emojiImag,EC.external,EC.common,l),loading:a?"lazy":"eager",onError:s,style:r})}var $mt=Dn.create({emojiImag:{".":"epr-emoji-img",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",minWidth:"var(--epr-emoji-fullsize)",minHeight:"var(--epr-emoji-fullsize)",padding:"var(--epr-emoji-padding)"}});function Fmt(e){var t=e.unified,r=e.style,n=e.className;return w.createElement("span",{className:kr(Umt.nativeEmoji,EC.common,EC.external,n),"data-unified":t,style:r},sbe(t))}var Umt=Dn.create({nativeEmoji:{".":"epr-emoji-native",fontFamily:'"Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji"!important',position:"relative",lineHeight:"100%",fontSize:"var(--epr-emoji-size)",textAlign:"center",alignSelf:"center",justifySelf:"center",letterSpacing:"0",padding:"var(--epr-emoji-padding)"}});function o5(e){var t=e.emoji,r=e.unified,n=e.emojiStyle,a=e.size,i=e.lazyLoad,s=e.getEmojiUrl,l=s===void 0?cve:s,c=e.className,u=wve(),d=u[1],f=E1(),m=f.emojiByUnified,p={};a&&(p.width=p.height=p.fontSize=a+"px");var v=t||m(r);if(!v)return null;if(obe(v))return w.createElement(Vte,{style:p,emojiName:r,emojiStyle:As.NATIVE,lazyLoad:i,imgUrl:v.imgUrl,onError:b,className:c});return w.createElement(w.Fragment,null,n===As.NATIVE?w.createElement(Fmt,{unified:r,style:p,className:c}):w.createElement(Vte,{style:p,emojiName:Vft(v),emojiStyle:n,lazyLoad:i,imgUrl:l(r,n),onError:b,className:c}));function b(){d(function(y){return new Set(y).add(r)})}}function rE(e){var t=e.emoji,r=e.unified,n=e.hidden,a=e.hiddenOnSearch,i=e.emojiStyle,s=e.showVariations,l=s===void 0?!0:s,c=e.size,u=e.lazyLoad,d=e.getEmojiUrl,f=e.className,m=e.noBackground,p=m===void 0?!1:m,v=e.style,b=S0(t);return w.createElement(zmt,{hasVariations:b,showVariations:l,hidden:n,hiddenOnSearch:a,emojiNames:h$(t),unified:r,noBackground:p,style:v},w.createElement(o5,{unified:r,emoji:t,size:c,emojiStyle:i,lazyLoad:u,getEmojiUrl:d,className:f}))}var Hmt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI4LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNS43LDEwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsMTAuOSw2LjEsMTEsNi4zLDExaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjRWNi43YzAtMC4zLTAuMi0wLjUtMC41LTAuNQoJQzkuOCw2LDkuNiw2LjIsOS42LDYuNXYzLjRINi4yQzUuOSw5LjksNS43LDEwLjEsNS43LDEwLjRMNS43LDEwLjR6Ii8+CjxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik01LjcsMzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDMxLDYuMywzMWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuMgoJQzUuOSwyOS45LDUuNywzMC4xLDUuNywzMC40TDUuNywzMC40eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNS43LDUwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsNTAuOSw2LjEsNTEsNi4zLDUxaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjR2LTMuNGMwLTAuMy0wLjItMC41LTAuNS0wLjUKCXMtMC41LDAuMi0wLjUsMC41djMuNEg2LjJDNS45LDQ5LjksNS43LDUwLjEsNS43LDUwLjRMNS43LDUwLjR6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik01LjcsNzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDcxLDYuMyw3MWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuNAoJQzUuOSw2OS45LDUuNyw3MC4xLDUuNyw3MC40TDUuNyw3MC40eiIvPgo8L3N2Zz4=";function qmt(){var e=lm(),t=e[1];return w.createElement(T1,{"aria-label":"Show all Emojis",title:"Show all Emojis",tabIndex:0,className:kr(Wmt.plusSign),onClick:function(){return t(!1)}})}var Wmt=Dn.create(pn({plusSign:{fontSize:"20px",padding:"17px",color:"var(--epr-text-color)",borderRadius:"50%",textAlign:"center",lineHeight:"100%",width:"20px",height:"20px",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease-in-out",":after":{content:"",minWidth:"20px",minHeight:"20px",backgroundImage:"url("+Hmt+")",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",backgroundPositionY:"0"},":hover":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-20px"}},":focus":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-40px"}}}},Pd("plusSign",{":after":{backgroundPositionY:"-40px"},":hover:after":{backgroundPositionY:"-60px"}})));function Kmt(){var e=lm(),t=e[0],r=Hht(),n=$ht();lbe(r,wx.REACTIONS);var a=cm(),i=Nve(),s=um();return t?w.createElement("ul",{className:kr(Yte.list,!t&&c$.hidden),ref:r},n.map(function(l){var c=m$(l);return c?w.createElement("li",{key:l},w.createElement(rE,{emoji:c,emojiStyle:a,unified:l,showVariations:!1,className:kr(Yte.emojiButton),noBackground:!0,getEmojiUrl:s})):null}),i?w.createElement("li",null,w.createElement(qmt,null)):null):null}var Yte=Dn.create({list:{listStyle:"none",margin:"0",padding:"0 5px",display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%"},emojiButton:{":hover":{transform:"scale(1.2)"},":focus":{transform:"scale(1.2)"},":active":{transform:"scale(1.1)"},transition:"transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.5)"}});function Gmt(e){var t=dm(),r=w.useState(0),n=r[0],a=r[1];return w.useEffect(function(){var i=e.current;if(!i)return;i.addEventListener("scroll",s,{passive:!0});function s(){var l;a((l=i?.scrollTop)!=null?l:0),t()}return function(){i?.removeEventListener("scroll",s)}},[e,t]),n}function Vmt(e){var t=e.scrollTop,r=e.clientHeight,n=e.topOffset,a=e.style,i=e.dimensions;if(!a||!i)return!1;var s=n+a.top,l=s+i.emojiSize,c=l+i.emojiSize*2>=t&&s<=t+r+i.emojiSize;return!c}function Ymt(e,t){return e?{top:Math.floor(t/e.emojisPerRow)*e.emojiSize,left:t%e.emojisPerRow*e.emojiSize}:void 0}var Qmt=40;function Jmt(e){var t=Rve(),r=lm(),n=r[0],a=_0(),i=w.useRef(),s=b$(),l=s[0],c=Sve(),u=c[0],d=w.useState(),f=d[0],m=d[1],p=w.useCallback(function(){var v=t.current;if(v){var b=v.querySelector(kx),y=b?.clientHeight;y&&(i.current=y);var S=u||y||i.current||Qmt,_=v.clientWidth;if(!(_===0||S===0)){var N=Math.max(1,Math.floor(_/S)),k=Math.ceil(e/N),j=k*S;m({categoryHeight:j,emojisPerRow:N,emojiSize:S})}}},[t,e,u]);return w.useEffect(function(){p()},[e,n,p,l.length]),w.useEffect(function(){var v=a.current;if(v){var b=function(S){var _=S,N=_.propertyName;(N==="width"||N==="max-width"||N==="min-width"||N==="height"||N==="max-height"||N==="min-height")&&(typeof queueMicrotask=="function"?queueMicrotask(function(){return p()}):requestAnimationFrame(function(){return p()}))};return v.addEventListener("transitionend",b,{passive:!0}),function(){v.removeEventListener("transitionend",b)}}},[a,p]),f}function Zmt(){var e=wve(),t=e[0],r=cmt();return function(n){var a=om(n),i=t.has(a),s=r(a);return{failedToLoad:i,filteredOut:s,hidden:i||s}}}function Xmt(e){var t=e.categoryEmojis,r=e.topOffset,n=e.onHeightReady,a=e.scrollTop,i=e.isCategoryVisible,s=Zmt(),l=Mve(),c=cm(),u=Y2(),d=u[0],f=xht(),m=um(),p=!Cve(),v=Us(),b=0,y=t.filter(function(k){var j=f(k),E=s(k),T=E.failedToLoad,O=E.filteredOut,R=E.hidden;return!T&&!O&&!R&&!j}),S=Jmt(y.length);w.useEffect(function(){S&&n(S.categoryHeight)},[S,n,y.length]);var _=function(j){var E,T;return S&&v.current&&Vmt({scrollTop:a,clientHeight:(E=(T=v.current)==null?void 0:T.clientHeight)!=null?E:0,topOffset:r,style:j,dimensions:S})},N=y.reduce(function(k,j,E){var T=om(j,d),O=Ymt(S,E);if(_(O)){var R,q;return b++,wmt(j,c,a,(R=(q=v.current)==null?void 0:q.clientHeight)!=null?R:0,r,O,S,m),k}return i?(k.push(w.createElement(rE,{showVariations:p,key:T,emoji:j,unified:T,emojiStyle:c,lazyLoad:l,getEmojiUrl:m,style:pn({},O,{position:"absolute"})})),k):(b++,k)},[]);return{virtualizedCounter:b,emojis:N,dimensions:S}}function ept(e){var t=e.categoryConfig,r=e.children,n=e.hidden,a=e.hiddenOnSearch,i=e.height,s=K2(t),l=fve(t);return w.createElement("li",{className:kr(GL.category,n&&c$.hidden,a&&sm.hiddenOnSearch),"data-name":s,"aria-label":l},w.createElement("h2",{className:kr(GL.label)},l),w.createElement("div",{className:kr(GL.categoryContent),style:{height:i}},r))}var GL=Dn.create({category:{".":Mr.category,minHeight:"calc(var(--epr-emoji-fullsize) + var(--epr-category-label-height))",position:"relative"},categoryContent:{".":Mr.categoryContent,display:"grid",gridGap:"0",gridTemplateColumns:"repeat(auto-fill, var(--epr-emoji-fullsize))",justifyContent:"space-between",margin:"var(--epr-category-padding)",position:"relative"},label:{".":Mr.label,alignItems:"center",backdropFilter:"blur(3px)",backgroundColor:"var(--epr-category-label-bg-color)",color:"var(--epr-category-label-text-color)",display:"flex",fontSize:"16px",fontWeight:"bold",height:"var(--epr-category-label-height)",margin:"0",padding:"var(--epr-category-label-padding)",position:"sticky",textTransform:"capitalize",top:"0",width:"100%",zIndex:"var(--epr-category-label-z-index)"}});function tpt(){var e=x$(),t=dht(),r=cm(),n=um(),a=Mve(),i=Y2(),s=i[0],l=Sve(),c=l[0],u=l[1],d=w.useRef(null);if(w.useLayoutEffect(function(){d.current&&u(d.current.clientHeight)}),c)return null;var f=e[0],m=t(K2(f))[0],p=m?El(m,s):"";return m?w.createElement("div",{ref:d},w.createElement(rE,{emoji:m,unified:p,emojiStyle:r,getEmojiUrl:n,lazyLoad:a,showVariations:!1,hidden:!1,style:{opacity:0,pointerEvents:"none",position:"absolute",top:0,left:0,zIndex:-1,height:"var(--epr-emoji-fullsize)",width:"var(--epr-emoji-fullsize)"}})):null}function rpt(e){var t=e.scrollTop,r=x$(),n=w.useState({}),a=n[0],i=n[1],s=Rve(),l=vht(),c=Yve(s.current),u=0;return w.createElement("ul",{className:kr(apt.emojiList),ref:s},w.createElement(tpt,null),r.map(function(d){var f=K2(d),m=u,p=a[f];return p&&(u+=p+c),w.createElement(w.Suspense,{key:f},w.createElement(npt,{categoryEmojis:l(f),categoryConfig:d,topOffset:m,onHeightReady:function(b){a[f]!==b&&i(function(y){var S;return pn({},y,(S={},S[f]=b,S))})},scrollTop:t}))}))}function npt(e){var t=e.categoryEmojis,r=e.categoryConfig,n=e.topOffset,a=e.onHeightReady,i=e.scrollTop,s=b$(),l=s[0],c=Xmt({categoryEmojis:t,topOffset:n,onHeightReady:a,scrollTop:i,isCategoryVisible:l.includes(r.category)}),u=c.virtualizedCounter,d=c.emojis,f=c.dimensions;return w.createElement(ept,{categoryConfig:r,height:f?.categoryHeight,hidden:!d.length&&u===0},d)}var apt=Dn.create({emojiList:{".":Mr.emojiList,listStyle:"none",margin:"0",padding:"0"}}),ipt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IgoJIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDUwIDE1IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MCAxNSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnIGlkPSJMYXllcl8xIj4KPC9nPgo8ZyBpZD0iTGF5ZXJfMiI+Cgk8cGF0aCBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiNFOEU3RTciIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KCTxwYXRoIGZpbGw9IiMwMTAyMDIiIHN0cm9rZT0iIzE1MTYxNyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjYuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KPC9nPgo8L3N2Zz4=",Hp;(function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"})(Hp||(Hp={}));function spt(){var e=J2(),t=qht(),r=k0(),n=r[0],a=cm(),i=lpt(t),s=i.getTop,l=i.getMenuDirection,c=Pve(),u=opt(t),d=um(),f=Jo(e.current),m=!!(n&&f&&S0(n)&&f.classList.contains(Mr.emojiHasVariations));w.useEffect(function(){m&&X2(t.current)},[t,m,e]);var p,v;return!m&&e.current?c(null):(p=s(),v=u()),w.createElement("div",{ref:t,className:kr(JS.variationPicker,l()===Hp.Down&&JS.pointingUp,m&&JS.visible),style:{top:p}},m&&n?[El(n)].concat(G2(n)).slice(0,6).map(function(b){return w.createElement(rE,{key:b,emoji:n,unified:b,emojiStyle:a,showVariations:!1,getEmojiUrl:d})}):null,w.createElement("div",{className:kr(JS.pointer),style:v}))}function opt(e){var t=J2();return function(){var n={};if(!e.current)return n;if(t.current){var a=Jo(t.current),i=Dmt(a);if(!a)return n;n.left=i+a?.clientWidth/2}return n}}function lpt(e){var t=J2(),r=Us(),n=Hp.Up;return{getMenuDirection:a,getTop:i};function a(){return n}function i(){n=Hp.Up;var s=0;if(!e.current)return 0;var l=qte(e.current);if(t.current){var c,u=r.current,d=Jo(t.current),f=qte(d);s=Qve(d);var m=(c=u?.scrollTop)!=null?c:0;m>s-l&&(n=Hp.Down,s+=f+l)}return s-l}}var JS=Dn.create(pn({variationPicker:{".":Mr.variationPicker,position:"absolute",right:"15px",left:"15px",padding:"5px",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.2)",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-around",opacity:"0",visibility:"hidden",pointerEvents:"none",top:"-100%",border:"1px solid var(--epr-picker-border-color)",height:"var(--epr-emoji-variation-picker-height)",zIndex:"var(--epr-skin-variation-picker-z-index)",background:"var(--epr-emoji-variation-picker-bg-color)",transform:"scale(0.9)",transition:"transform 0.1s ease-out, opacity 0.2s ease-out"},visible:{opacity:"1",visibility:"visible",pointerEvents:"all",transform:"scale(1)"},pointingUp:{".":"pointing-up",transformOrigin:"center 0%",transform:"scale(0.9)"},".pointing-up":{pointer:{top:"0",transform:"rotate(180deg) translateY(100%) translateX(18px)"}},pointer:{".":"epr-emoji-pointer",content:"",position:"absolute",width:"25px",height:"15px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"50px 15px",top:"100%",transform:"translateX(-18px)",backgroundImage:"url("+ipt+")"}},Pd("pointer",{backgroundPosition:"-25px 0"})));function cpt(){var e=Us(),t=Gmt(e);return lbe(e,wx.PICKER),rmt(),w.createElement("div",{className:kr(upt.body,sm.hiddenOnReactions),ref:e},w.createElement(spt,null),w.createElement(rpt,{scrollTop:t}))}var upt=Dn.create({body:{".":Mr.scrollBody,flex:"1",overflowY:"scroll",overflowX:"hidden",position:"relative"}});function dpt(e,t){if(!e||!t)return 0;var r=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.height-(r.y-n.y)}function fpt(e,t){var r=Us(),n=Fve(),a=$ve();w.useEffect(function(){if(!e)return;var i=r.current;i?.addEventListener("keydown",c,{passive:!0}),i?.addEventListener("mouseover",u,!0),i?.addEventListener("focus",s,!0),i?.addEventListener("mouseout",l,{passive:!0}),i?.addEventListener("blur",l,!0);function s(d){var f=Jo(d.target);if(!f)return l();var m=tbe(f),p=m.unified,v=m.originalUnified;if(!p||!v)return l();t({unified:p,originalUnified:v})}function l(d){if(d){var f=d.relatedTarget;if(!Jo(f))return t(null)}t(null)}function c(d){d.key==="Escape"&&t(null)}function u(d){if(!n()){var f=Jo(d.target);if(f){var m=dpt(f,i),p=f.getBoundingClientRect().height;if(m<p)return hpt(f,t);Fs(f)}}}return function(){i?.removeEventListener("mouseover",u),i?.removeEventListener("mouseout",l),i?.removeEventListener("focus",s,!0),i?.removeEventListener("blur",l,!0),i?.removeEventListener("keydown",c)}},[r,e,t,n,a])}function hpt(e,t){var r,n=tbe(e),a=n.unified,i=n.originalUnified;!a||!i||((r=document.activeElement)==null||r.blur==null||r.blur(),t({unified:a,originalUnified:i}))}var ZS,_x;(function(e){e.ROW="FlexRow",e.COLUMN="FlexColumn"})(_x||(_x={}));function cbe(e){var t=e.children,r=e.className,n=e.style,a=n===void 0?{}:n,i=e.direction,s=i===void 0?_x.ROW:i;return w.createElement("div",{style:pn({},a),className:kr(Qte.flex,r,Qte[s])},t)}var Qte=Dn.create((ZS={flex:{display:"flex"}},ZS[_x.ROW]={flexDirection:"row"},ZS[_x.COLUMN]={flexDirection:"column"},ZS));function mpt(e){var t=e.className,r=e.style,n=r===void 0?{}:r;return w.createElement("div",{style:pn({flex:1},n),className:kr(t)})}function ppt(e){var t=e.children,r=e.className,n=e.style;return w.createElement("div",{style:pn({},n,{position:"absolute"}),className:r},t)}function nE(e){var t=e.children,r=e.className,n=e.style;return w.createElement("div",{style:pn({},n,{position:"relative"}),className:r},t)}function gpt(e){var t=e.isOpen,r=e.onClick,n=e.isActive,a=e.skinToneVariation,i=e.style;return w.createElement(T1,{style:i,onClick:r,className:kr("epr-tone-"+a,VL.tone,!t&&VL.closedTone,n&&VL.active),"aria-pressed":n,"aria-label":"Skin tone "+Kft[a]})}var VL=Dn.create({closedTone:{opacity:"0",zIndex:"0"},active:{".":"epr-active",zIndex:"1",opacity:"1"},tone:{".":"epr-tone",width:"var(--epr-skin-tone-size)",display:"block",cursor:"pointer",borderRadius:"4px",height:"var(--epr-skin-tone-size)",position:"absolute",right:"0",transition:"transform 0.3s ease-in-out, opacity 0.35s ease-in-out",zIndex:"0",border:"1px solid var(--epr-skin-tone-outer-border-color)",boxShadow:"inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)",":hover":{boxShadow:"0 0 0 3px var(--epr-active-skin-hover-color), inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)"},":focus":{boxShadow:"0 0 0 3px var(--epr-focus-bg-color)"},"&.epr-tone-neutral":{backgroundColor:"#ffd225"},"&.epr-tone-1f3fb":{backgroundColor:"#ffdfbd"},"&.epr-tone-1f3fc":{backgroundColor:"#e9c197"},"&.epr-tone-1f3fd":{backgroundColor:"#c88e62"},"&.epr-tone-1f3fe":{backgroundColor:"#a86637"},"&.epr-tone-1f3ff":{backgroundColor:"#60463a"}}}),Nb=28;function vpt(){return w.createElement(nE,{style:{height:Nb}},w.createElement(ppt,{style:{bottom:0,right:0}},w.createElement(ube,{direction:Nx.VERTICAL})))}function ube(e){var t=e.direction,r=t===void 0?Nx.HORIZONTAL:t,n=w$(),a=Cve(),i=M1(),s=i[0],l=i[1],c=Y2(),u=c[0],d=c[1],f=Lht(),m=dm(),p=fm();if(a)return null;var v=Nb*CC.length+"px",b=s?v:Nb+"px",y=r===Nx.VERTICAL;return w.createElement(nE,{className:kr(qv.skinTones,y&&qv.vertical,s&&qv.open,y&&s&&qv.verticalShadow),style:y?{flexBasis:b,height:b}:{flexBasis:b}},w.createElement("div",{className:kr(qv.select),ref:n},CC.map(function(S,_){var N=S===u;return w.createElement(gpt,{key:S,skinToneVariation:S,isOpen:s,style:{transform:kr(y?"translateY(-"+_*(s?Nb:0)+"px)":"translateX(-"+_*(s?Nb:0)+"px)",s&&N&&"scale(1.3)")},isActive:N,onClick:function(){s?(d(S),f(S),p()):l(!0),m()}})})))}var Nx;(function(e){e.VERTICAL="epr-vertical",e.HORIZONTAL="epr-horizontal"})(Nx||(Nx={}));var qv=Dn.create({skinTones:{".":"epr-skin-tones","--":{"--epr-skin-tone-size":"15px"},display:"flex",alignItems:"center",justifyContent:"flex-end",transition:"all 0.3s ease-in-out",padding:"10px 0"},vertical:{padding:"9px",alignItems:"flex-end",flexDirection:"column",borderRadius:"6px",border:"1px solid var(--epr-bg-color)"},verticalShadow:{boxShadow:"0px 0 7px var(--epr-picker-border-color)"},open:{backdropFilter:"blur(5px)",background:"var(--epr-skin-tone-picker-menu-color)",".epr-active":{border:"1px solid var(--epr-active-skin-tone-indicator-border-color)"}},select:{".":"epr-skin-tone-select",position:"relative",width:"var(--epr-skin-tone-size)",height:"var(--epr-skin-tone-size)"}});function bpt(){var e=jve(),t=Wve(),r=lm(),n=r[0];return e.showPreview?w.createElement(cbe,{className:kr(ty.preview,sm.hiddenOnReactions,n&&ty.hideOnReactions)},w.createElement(ypt,null),w.createElement(mpt,null),t?w.createElement(vpt,null):null):null}function ypt(){var e,t=jve(),r=w.useState(null),n=r[0],a=r[1],i=cm(),s=k0(),l=s[0],c=um(),u=E1(),d=u.emojiByUnified;fpt(t.showPreview,a);var f=d((e=n?.unified)!=null?e:n?.originalUnified),m=f!=null&&n!=null;return w.createElement(p,null);function p(){var v=l??d(t.defaultEmoji);if(!v)return null;var b=l?zte(l):t.defaultCaption;return w.createElement(w.Fragment,null,w.createElement("div",null,m?w.createElement(o5,{unified:n?.unified,emoji:f,emojiStyle:i,size:45,getEmojiUrl:c,className:kr(ty.emoji)}):v?w.createElement(o5,{unified:El(v),emoji:v,emojiStyle:i,size:45,getEmojiUrl:c,className:kr(ty.emoji)}):null),w.createElement("div",{className:kr(ty.label)},m?zte(f):b))}}var ty=Dn.create({preview:{alignItems:"center",borderTop:"1px solid var(--epr-preview-border-color)",height:"var(--epr-preview-height)",padding:"0 var(--epr-horizontal-padding)",position:"relative",zIndex:"var(--epr-preview-z-index)"},label:{color:"var(--epr-preview-text-color)",fontSize:"var(--epr-preview-text-size)",padding:"var(--epr-preview-text-padding)",textTransform:"capitalize"},emoji:{padding:"0"},hideOnReactions:{opacity:"0",transition:"opacity 0.5s ease-in-out"}});function xpt(e){var t;return(t=e?.getAttribute("data-name"))!=null?t:null}function wpt(e){var t=e.setActiveCategory,r=e.setVisibleCategories,n=Us();w.useEffect(function(){var a=new Map,i=new Map,s=n.current,l=new IntersectionObserver(function(c){if(s){for(var u=Rft(c),d;!(d=u()).done;){var f=d.value,m=xpt(f.target);m&&(a.set(m,f.intersectionRatio),i.set(m,f.isIntersecting))}var p=Array.from(a),v=p.filter(function(j){var E=j[0],T=j[1];return T>0||i.get(E)}).map(function(j){var E=j[0];return E});r(v);var b=p[p.length-1];if(b?.[1]==1)return t(b[0]);for(var y=0,S=p;y<S.length;y++){var _=S[y],N=_[0],k=_[1];if(k){t(N);break}}}},{root:s,threshold:[0,1]});return s?.querySelectorAll(Co(Mr.category)).forEach(function(c){l.observe(c)}),function(){l.disconnect()}},[n,t,r])}function Spt(){var e=Us(),t=_0();return function(n){var a;if(e.current){var i=(a=e.current)==null?void 0:a.querySelector('[data-name="'+n+'"]');if(i){var s=i.offsetTop||0;zve(t.current,s)}}}}function kpt(){var e=Tht();return e?e.length===0:!1}var _pt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMDBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgMjAwIDgwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyMDAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyBpZD0iTGF5ZXJfMTEiPgoJPGc+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTIuOCwyOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjEtMS4yYy0wLjYsMC0xLjIsMC41LTEuMiwxLjJDMTEuNiwyOSwxMi4yLDI5LjUsMTIuOCwyOS41eiBNMTIuOCwyOGMwLjIsMCwwLjQsMC4yLDAuNCwwLjQKCQkJYzAsMC4yLTAuMiwwLjQtMC40LDAuNGMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzEyLjQsMjguMSwxMi42LDI4LDEyLjgsMjh6Ii8+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsMjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNywyNi4yLDEzLjgsMjMsMTAsMjN6IE0xMCwzNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiwzMy40LDEzLjQsMzYuMiwxMCwzNi4yeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsMzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDMxLjUsMTQuNywzMS4zLDE0LjYsMzEuMnogTTEwLDM0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywzMy4yLDExLjYsMzQuMSwxMCwzNC4xeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiwyOS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDI5LDYuNiwyOS41LDcuMiwyOS41eiBNNy4yLDI4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDI4LjEsNywyOCw3LjIsMjh6Ii8+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjQuMSwzMy40bDIuMywwYzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjMKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40di0yLjFDNjMuNywzMy42LDYzLjgsMzMuNCw2NC4xLDMzLjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTczLjUsMzMuNWgyLjRjMC4yLDAsMC40LDAuMiwwLjQsMC40djJjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMkM3My4xLDMzLjYsNzMuMywzMy41LDczLjUsMzMuNXoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjMuNywyOC40aDEyLjZ2NUg2My43VjI4LjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTY1LjUsMjMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN3YtMy4xQzYzLjcsMjQuNSw2NC41LDIzLjYsNjUuNSwyMy42eiIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNjYuMiIgY3k9IjMwLjkiIHJ4PSIwLjkiIHJ5PSIxIi8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSI3My44IiBjeT0iMzAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNOTYuNCwzMGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCwyNi40LDk2LjQsMzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTk2LjMsMjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4xYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xYy0wLjEtMC4xLTAuMS0wLjEtMC4xLTAuMmMwLjUtMC4xLDEuMi0wLjIsMi0wLjFjMS4yLDAsMi41LDAuMywzLjUsMS4xYzEsMC44LDEuNywxLjgsMi4xLDIuOAoJCQkJQzk2LjEsMjcuOSw5Ni4yLDI4LjMsOTYuMywyOC42eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik04NCwzMi4yYzAsMCwwLTAuMSwwLTAuMWMwLjktMC4yLDIuOS0wLjQsNC43LDAuNmMxLjEsMC43LDEuOSwxLjUsMi40LDIuMwoJCQkJYzAuNCwwLjUsMC42LDEsMC43LDEuM2MtMC40LDAuMS0xLDAuMi0xLjcsMC4zYy0xLDAtMi4xLTAuMS0zLjItMC44cy0xLjktMS42LTIuNC0yLjVDODQuMiwzMi44LDg0LjEsMzIuNSw4NCwzMi4yeiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTExNi4zLDI2LjhsLTEuNCwybC0wLjgtMC44bC0wLjYtMC42bDAsMC45bC0wLjEsOC4yaC02LjgKCQkJCWwtMC4xLTguMmwwLTAuOWwtMC42LDAuNmwtMC44LDAuOGwtMS40LTJsMi42LTIuOWMwLjEtMC4xLDAuMi0wLjEsMC4zLTAuMWgxLjNsMC40LDAuN2MwLjcsMS4zLDIuNiwxLjMsMy4zLTAuMWwwLjMtMC42aDEuMgoJCQkJYzAuMSwwLDAuMiwwLDAuMywwLjFsMC4zLTAuM2wtMC4zLDAuM0wxMTYuMywyNi44eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMTAuMSwyNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDI3LjdMMTEwLjEsMjcuN3oiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMTI2LjgsMzQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMzMuMSwxMjYuOCwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNiwzNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDMyLjEsMTM3LjYsMzMuMSwxMzcuNiwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNywyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDI2LjIsMTI2LjgsMjMuNSwxMjYuOCwyMy41eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSIjMzM3MUI3IiBkPSJNMTcwLjgsMjMuMUwxNzAuOCwyMy4xYy0wLjMsMC0wLjUsMC0wLjgsMGMtMi4xLDAtNCwxLTUuMywyLjVsLTAuMSwwbC0wLjEtMC4xbC0xLTEuMmwtMC4zLDMuNGwzLjQsMC4zCgkJCQlsLTEuMS0xLjNsLTAuMS0wLjFsMC4xLTAuMWMxLjEtMS41LDMtMi4zLDUtMi4xbDAsMGMzLjIsMC4zLDUuNSwzLjEsNS4yLDYuM2MtMC4zLDMtMy4xLDUuMy02LjEsNS4xYy0zLjEtMC4yLTUuNC0yLjktNS4zLTYKCQkJCWwtMS4zLTAuMWMtMC4yLDMuOCwyLjYsNy4xLDYuMyw3LjRjMy45LDAuMyw3LjMtMi42LDcuNi02LjVDMTc3LjIsMjYuOCwxNzQuNCwyMy41LDE3MC44LDIzLjF6Ii8+CgkJCTxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik0xNzAuMywyNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNnMtMC42LDAuMy0wLjYsMC42djMuMmMwLDAuMiwwLjEsMC4zLDAuMiwwLjRjMC4xLDAuMSwwLjMsMC4yLDAuNCwwLjIKCQkJCWgyLjRjMC40LDAsMC42LTAuMywwLjYtMC42YzAtMC40LTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJ2LTAuMkwxNzAuMywyNy40TDE3MC4zLDI3LjR6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTE4Ni4yLDIzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43di03LjdDMTgzLjQsMjQuNiwxODQuNywyMy40LDE4Ni4yLDIzLjR6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxODYiIGN5PSIyOC45IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxOTQiIGN5PSIyNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDMzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjI1IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNTYsMjQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgkJYzAsMC0wLjIsMC4xLTAuOSwwLjJjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMC44LTAuMy0xLjctMC41LTIuNS0wLjVjLTAuMiwwLTAuNCwwLTAuNSwwYy0xLjMsMC0yLjUsMC4zLTMuNiwxCgkJYy0wLjIsMC4xLTAuMiwwLjItMC4yLDAuNHYxMS42YzAsMC4zLDAuMSwwLjUsMC4zLDAuNWMwLjYsMCwwLjUtMC40LDAuNS0wLjZ2LTUuN2MwLjctMC4zLDMuMi0xLjEsNS44LTAuMQoJCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjR2LTUuN0MxNTYuMiwyNC42LDE1Ni4xLDI0LjQsMTU2LDI0LjN6IE0xNTUuNiwzMC4yCgkJYy0wLjEsMC0wLjcsMC4xLTEsMC4xYy0wLjcsMC0yLjQtMC4xLTMuOC0wLjZjLTIuNS0xLTUtMC41LTYuMi0wLjF2LTQuOWMwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMAoJCWMwLjcsMCwxLjUsMC4yLDIuMiwwLjRjMS42LDAuNiwzLjUsMC43LDQuMywwLjdjMC4yLDAsMC44LDAsMS0wLjFWMzAuMnoiLz4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTQ4LjEsMjMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCUM0My42LDI1LjUsNDUuNiwyMy41LDQ4LjEsMjMuNXoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMjguOGMtMC4yLDAuMS0wLjUsMS4yLDAsMS41YzEuNCwxLDguNSwwLjgsMTEuMywwLjYKCQkJYzAuOC0wLjEsMS42LTAuNCwxLjctMS4yYzAtMC4zLTAuMS0wLjYtMC42LTAuOSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMC42TDQzLjMsMzFjLTAuMiwwLjUsMC4yLDEsMC43LDAuOWMwLjMtMC4xLDAuNSwwLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMiwwbDAuMi0wLjFjMC4zLTAuMiwwLjgtMC4yLDEuMSwwLjFsMC4yLDAuMmMwLjMsMC4zLDAuOCwwLjIsMS0wLjJsMC4xLTAuMmMwLjEtMC4yLDAtMC4zLDAuMi0wLjMKCQkJYzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMi4yYy0wLjEsMC4yLTAuMywwLjgsMCwxLjFjMC4zLDAuNCwzLDEuMSw2LjQsMS4xCgkJCWMyLjIsMCw0LjYtMC4zLDYtMC42YzAuNS0wLjEsMC45LTAuNSwwLjgtMC45YzAtMC4yLTAuMi0wLjUtMC40LTAuNyIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMy4zYzAsMC41LDAuNiwyLjMsMS4zLDIuN2MxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQljMS4zLTAuMSwyLjUtMC43LDMuMi0xLjhjMC4zLTAuNSwwLjUtMSwwLjUtMS40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUxLjYiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUzIiBjeT0iMjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNTMiIGN5PSIyNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjU0LjMiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUwLjkiIGN5PSIyNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJPC9nPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMjQuMiwzMXYtNy42YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjYsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDMyLjksMjQuMiwzMiwyNC4yLDMxeiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiwzMGw1LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDM0LjFsNS40LTEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzMGwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzNC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMzMzcxQjciIGQ9Ik0yOS41LDMyLjRMMjksMzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVzMC40LDAsMC41LDAuMmwwLjEsMC4yCgkJCUMyOC4zLDMyLjgsMjkuMSwzMi45LDI5LjUsMzIuNHoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTMyLjQsMzIuMWwtMC4xLDAuMmMtMC40LDEtMS44LDEuMS0yLjMsMC4yIi8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjI3LjYiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjMyLjQiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xMi44LDQ5LjVjMC42LDAsMS4xLTAuNSwxLjEtMS4xCgkJCWMwLTAuNi0wLjUtMS4yLTEuMS0xLjJjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMkMxMS42LDQ5LDEyLjIsNDkuNSwxMi44LDQ5LjV6IE0xMi44LDQ4YzAuMiwwLDAuNCwwLjIsMC40LDAuNAoJCQljMCwwLjItMC4yLDAuNC0wLjQsMC40Yy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDMTIuNCw0OC4xLDEyLjYsNDgsMTIuOCw0OHoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNC42LDUxLjJjLTAuMS0wLjEtMC4yLTAuMi0wLjMtMC4ySDUuNwoJCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNyw1MS41LDE0LjcsNTEuMywxNC42LDUxLjJ6IE0xMCw1NC4xCgkJCWMtMS42LDAtMy0wLjktMy43LTIuMmg3LjNDMTMsNTMuMiwxMS42LDU0LjEsMTAsNTQuMXoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik03LjIsNDkuNWMwLjYsMCwxLjItMC41LDEuMi0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4yLTEuMmMtMC42LDAtMS4xLDAuNS0xLjEsMS4yQzYuMSw0OSw2LjYsNDkuNSw3LjIsNDkuNXogTTcuMiw0OGMwLjIsMCwwLjQsMC4yLDAuNCwwLjRjMCwwLjItMC4yLDAuNC0wLjQsMC40CgkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzYuOCw0OC4xLDcsNDgsNy4yLDQ4eiIvPgoJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEwLDQzYy0zLjgsMC03LDMuMS03LDdjMCwzLjgsMy4xLDcsNyw3CgkJCXM3LTMuMSw3LTdDMTcsNDYuMiwxMy44LDQzLDEwLDQzeiBNMTAsNTYuMmMtMy40LDAtNi4yLTIuOC02LjItNi4yYzAtMy40LDIuOC02LjIsNi4yLTYuMnM2LjIsMi44LDYuMiw2LjIKCQkJQzE2LjIsNTMuNCwxMy40LDU2LjIsMTAsNTYuMnoiLz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02NC4xLDUzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDUzLjYsNjMuOCw1My40LDY0LjEsNTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNzMuNSw1My41aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2MmMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuNAoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRsMC0yQzczLjEsNTMuNiw3My4zLDUzLjUsNzMuNSw1My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02My43LDQ4LjRoMTIuNnY1SDYzLjdWNDguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNjUuNSw0My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw0NC41LDY0LjUsNDMuNiw2NS41LDQzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI2Ni4yIiBjeT0iNTAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjczLjgiIGN5PSI1MC45IiByeD0iMC45IiByeT0iMSIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik05Ni40LDUwYzAsMy42LTIuOSw2LjUtNi40LDYuNXMtNi40LTIuOS02LjQtNi41czIuOS02LjUsNi40LTYuNVM5Ni40LDQ2LjQsOTYuNCw1MHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNOTYuMyw0OC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw0Ny45LDk2LjIsNDguMyw5Ni4zLDQ4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTg0LDUyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDUyLjgsODQuMSw1Mi41LDg0LDUyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNDYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDQ2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTExMC4xLDQ3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNDcuN0wxMTAuMSw0Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0xMjYuOCw1NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw1My4xLDEyNi44LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy42LDU0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNTIuMSwxMzcuNiw1My4xLDEzNy42LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy43LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNDYuMiwxMjYuOCw0My41LDEyNi44LDQzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIGQ9Ik0xNzAuOCw0My4xTDE3MC44LDQzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjUsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw0Ni44LDE3NC40LDQzLjUsMTcwLjgsNDMuMXoiLz4KCQkJPHBhdGggZmlsbD0iI0MwQzBCRiIgZD0iTTE3MC4zLDQ3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZjMC0wLjMtMC4zLTAuNi0wLjYtMC42aC0xLjZoLTAuMnYtMC4yTDE3MC4zLDQ3LjRMMTcwLjMsNDcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNMTg2LjIsNDMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw0NC43LDE4NC43LDQzLjQsMTg2LjIsNDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE4NiIgY3k9IjQ4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE5NCIgY3k9IjQ2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNTMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iI0MwQzBCRiIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw0NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDQ0LjYsMTU2LjEsNDQuNCwxNTYsNDQuM3ogTTE1NS42LDUwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY1MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNDguMSw0My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNDUuNSw0NS42LDQzLjUsNDguMSw0My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw0OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDEsOC41LDAuOCwxMS4zLDAuNgoJCQljMC44LTAuMSwxLjYtMC40LDEuNy0xLjJjMC0wLjMtMC4xLTAuNi0wLjYtMC45Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUwLjZMNDMuMyw1MWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45YzAuMy0wLjEsMC41LDAsMC43LDAuMwoJCQlsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjIsMC44LDAuMSwxLjIsMGwwLjUtMC4yYzAuNC0wLjIsMC45LTAuMiwxLjMsMGwwLjUsMC4yCgkJCWMwLjQsMC4yLDAuOCwwLjIsMS4yLDBsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC41LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUzLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTEuNiIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTMiIGN5PSI0NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI1MyIgY3k9IjQ3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTQuMyIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTAuOSIgY3k9IjQ1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0yNC4yLDUxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNTIuOSwyNC4yLDUyLDI0LjIsNTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDUwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsNTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDUwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDU0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTI5LjUsNTIuNEwyOSw1MS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNTIuOCwyOS4xLDUyLjksMjkuNSw1Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw1Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMjcuNiIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMzIuNCIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KCTxnPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsNzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDcxLjUsMTQuNyw3MS4zLDE0LjYsNzEuMnogTTEwLDc0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMyw3My4yLDExLjYsNzQuMSwxMCw3NC4xeiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsNjkuNWMwLjYsMCwxLjEtMC41LDEuMS0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4xLTEuMmMtMC42LDAtMS4yLDAuNS0xLjIsMS4yQzExLjYsNjksMTIuMiw2OS41LDEyLjgsNjkuNXogTTEyLjgsNjhjMC4yLDAsMC40LDAuMiwwLjQsMC40CgkJCWMwLDAuMi0wLjIsMC40LTAuNCwwLjRjLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDY4LjEsMTIuNiw2OCwxMi44LDY4eiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw2OS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDY5LDYuNiw2OS41LDcuMiw2OS41eiBNNy4yLDY4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDY4LjEsNyw2OCw3LjIsNjh6Ii8+CgkJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsNjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNyw2Ni4yLDEzLjgsNjMsMTAsNjN6IE0xMCw3Ni4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiw3My40LDEzLjQsNzYuMiwxMCw3Ni4yeiIvPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTY0LjEsNzMuNGwyLjMsMGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi4zCgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNHYtMi4xQzYzLjcsNzMuNiw2My44LDczLjQsNjQuMSw3My40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik03My41LDczLjVoMi40YzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMi4xQzczLjEsNzMuNiw3My4zLDczLjUsNzMuNSw3My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik02My43LDY4LjRoMTIuNnY1SDYzLjdWNjguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNjUuNSw2My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw2NC41LDY0LjUsNjMuNiw2NS41LDYzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI2Ni4yIiBjeT0iNzAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNzMuOCIgY3k9IjcwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNOTYuNCw3MGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCw2Ni40LDk2LjQsNzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTk2LjMsNjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4yYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xLjFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw2Ny45LDk2LjIsNjguMyw5Ni4zLDY4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTg0LDcyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDcyLjgsODQuMSw3Mi40LDg0LDcyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNjYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDY2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTExMC4xLDY3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNjcuN0wxMTAuMSw2Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0xMjYuOCw3NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw3My4xLDEyNi44LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy42LDc0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNzIuMSwxMzcuNiw3My4xLDEzNy42LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy43LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDYzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNjYuMiwxMjYuOCw2My41LDEyNi44LDYzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xNzAuOCw2My4xTDE3MC44LDYzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw2Ni44LDE3NC40LDYzLjUsMTcwLjgsNjMuMXoiLz4KCQkJPHBhdGggZmlsbD0iIzZBQTlERCIgZD0iTTE3MC4zLDY3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZTMTcyLjQsNzAsMTcyLDcwaC0xLjZoLTAuMnYtMC4yTDE3MC4zLDY3LjRMMTcwLjMsNjcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNMTg2LjIsNjMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw2NC43LDE4NC43LDYzLjQsMTg2LjIsNjMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE4NiIgY3k9IjY4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE5NCIgY3k9IjY2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNzMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw2NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDY0LjYsMTU2LjEsNjQuNCwxNTYsNjQuM3ogTTE1NS42LDcwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY3MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNDguMSw2My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNjUuNSw0NS42LDYzLjUsNDguMSw2My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw2OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDAuOSw4LjUsMC44LDExLjMsMC42CgkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsNzAuNkw0My4zLDcxYy0wLjIsMC41LDAuMiwxLDAuNywwLjljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDcyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDczLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTEuNiIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTMiIGN5PSI2NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI1MyIgY3k9IjY3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTQuMyIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTAuOSIgY3k9IjY1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0yNC4yLDcxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNzIuOSwyNC4yLDcyLDI0LjIsNzF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDcwLjFsNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiw3NC4xbDUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTM4LjgsNzAuMWwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCw3NC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiM2QUE5REQiIGQ9Ik0yOS41LDcyLjRMMjksNzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVjMC4yLTAuMSwwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNzIuOCwyOS4xLDcyLjksMjkuNSw3Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw3Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMjcuNiIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMzIuNCIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KPC9nPgo8Zz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMgoJCWMwLTAuNi0wLjUtMS4xLTEuMS0xLjFjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMVMxMi4yLDkuNSwxMi44LDkuNXogTTEyLjgsNy45YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDguMSwxMi42LDcuOSwxMi44LDcuOXoiLz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw5LjVjMC42LDAsMS4yLTAuNSwxLjItMS4yCgkJYzAtMC42LTAuNS0xLjEtMS4yLTEuMWMtMC42LDAtMS4xLDAuNS0xLjEsMS4xUzYuNiw5LjUsNy4yLDkuNXogTTcuMiw3LjljMC4yLDAsMC40LDAuMiwwLjQsMC40YzAsMC4yLTAuMiwwLjQtMC40LDAuNAoJCUM3LDguNyw2LjgsOC41LDYuOCw4LjNDNi44LDguMSw3LDcuOSw3LjIsNy45eiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTQuNiwxMS4yYy0wLjEtMC4xLTAuMi0wLjItMC4zLTAuMkg1LjcKCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNywxMS40LDE0LjcsMTEuMywxNC42LDExLjJ6IE0xMCwxNC4xCgkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywxMy4yLDExLjYsMTQuMSwxMCwxNC4xeiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsM2MtMy44LDAtNywzLjEtNyw3czMuMSw3LDcsN3M3LTMuMSw3LTcKCQlTMTMuOCwzLDEwLDN6IE0xMCwxNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJTNi42LDMuOCwxMCwzLjhzNi4yLDIuOCw2LjIsNi4yUzEzLjQsMTYuMiwxMCwxNi4yeiIvPgo8L2c+CjxnIGlkPSJDYXJfMDAwMDAwMTg5MzUzOTUwODU0MTM0MTM3NTAwMDAwMDA4MjUyNzM4Nzc4NDI3NzU3MTVfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NC4xLDEzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDEzLjYsNjMuOCwxMy40LDY0LjEsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNzMuNSwxMy40aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi40CgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNGwwLTIuMUM3My4xLDEzLjYsNzMuMywxMy40LDczLjUsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNjMuNyw4LjRoMTIuNnY1SDYzLjdWOC40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NS41LDMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN1Y1LjVDNjMuNyw0LjQsNjQuNSwzLjYsNjUuNSwzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI2Ni4yIiBjeT0iMTAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNzMuOCIgY3k9IjEwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+CjwvZz4KPGcgaWQ9IkFjdGl2aXRpZXMiPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjQsMTBjMCwzLjYtMi45LDYuNS02LjQsNi41cy02LjQtMi45LTYuNC02LjVzMi45LTYuNSw2LjQtNi41Uzk2LjQsNi40LDk2LjQsMTB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjMsOC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTEuMWMtMC4xLTAuMS0wLjEtMC4yLTAuMS0wLjJjMC41LTAuMSwxLjItMC4yLDItMC4yYzEuMiwwLDIuNSwwLjMsMy41LDEuMWMxLDAuOCwxLjcsMS44LDIuMSwyLjgKCQkJCUM5Ni4xLDcuOSw5Ni4yLDguMyw5Ni4zLDguNnoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNODQsMTIuMWMwLDAsMC0wLjEsMC0wLjFjMC45LTAuMiwyLjktMC40LDQuNywwLjZjMS4xLDAuNiwxLjksMS41LDIuNCwyLjMKCQkJCWMwLjQsMC41LDAuNiwxLDAuNywxLjNjLTAuNCwwLjEtMSwwLjItMS43LDAuM2MtMSwwLTIuMS0wLjEtMy4yLTAuOGMtMS4xLTAuNi0xLjktMS42LTIuNC0yLjVDODQuMiwxMi44LDg0LjEsMTIuNCw4NCwxMi4xeiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iT2JqZWN0c18wMDAwMDA2NDMxMjM3MTczOTEzMDMxNTI1MDAwMDAxMDIyNTg4OTAzMjIyODYzMjk3NV8iPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNi44bC0xLjQsMkwxMTQuMSw4bC0wLjYtMC43bDAsMC45bC0wLjEsOC4yaC02LjhsLTAuMS04LjIKCQkJCWwwLTAuOUwxMDUuOSw4bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDYuOHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTEwLjEsNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDcuN0wxMTAuMSw3Ljd6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJTeW1ib2xzXzAwMDAwMDk2NzQ2OTA3ODY5OTI5OTIxMTgwMDAwMDA2NDg0ODEyODMwMjgyNTgyNDE2XyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMTQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMTMuMSwxMjYuOCwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMzcuNiwxNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDEyLjEsMTM3LjYsMTMuMSwxMzcuNiwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMjYuOCw0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTEzNy43LDQuNHY5LjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDYuMiwxMjYuOCwzLjUsMTI2LjgsMy41eiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iUmVjZW50cyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTE3MC44LDMuMUwxNzAuOCwzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJTDE2Myw5LjVjLTAuMiwzLjgsMi42LDcuMSw2LjMsNy40YzMuOSwwLjQsNy4zLTIuNiw3LjYtNi41QzE3Ny4yLDYuOCwxNzQuNCwzLjUsMTcwLjgsMy4xeiIvPgoJCQk8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNMTcwLjMsNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNlMxNjksNy4xLDE2OSw3LjR2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZzLTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJWOS44TDE3MC4zLDcuNEwxNzAuMyw3LjR6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJDdXN0b21fMDAwMDAxODEwODcyMjk0MzQzMDIzMzY3ODAwMDAwMDUxNTIyNzc5NDU5NDA2NzQ0ODhfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xODYuMiwzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43VjYuMUMxODMuNCw0LjYsMTg0LjcsMy40LDE4Ni4yLDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjE4NiIgY3k9IjguOSIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMTk0IiBjeT0iNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDEzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS13aWR0aD0iMC4yNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTU2LDQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgljMCwwLTAuMiwwLjEtMC45LDAuMWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCWMtMC4yLDAuMS0wLjIsMC4yLTAuMiwwLjR2MTEuNmMwLDAuMywwLjEsMC41LDAuMywwLjVjMC42LDAsMC41LTAuNCwwLjUtMC42di01LjdjMC43LTAuMywzLjItMS4xLDUuOC0wLjFjMS42LDAuNiwzLjUsMC43LDQuMywwLjcKCWMwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjRWNC43QzE1Ni4yLDQuNSwxNTYuMSw0LjQsMTU2LDQuM3ogTTE1NS42LDEwLjJjLTAuMSwwLTAuNywwLjEtMSwwLjEKCWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0yLjUtMS01LTAuNS02LjItMC4xVjQuN2MwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMGMwLjcsMCwxLjUsMC4yLDIuMiwwLjQKCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVYxMC4yeiIvPgo8ZyBpZD0iRm9vZCI+Cgk8ZyBpZD0iTGF5ZXJfMTIiPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik00OC4xLDMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCQlDNDMuNiw1LjUsNDUuNiwzLjUsNDguMSwzLjV6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw4LjdjLTAuMiwwLjEtMC41LDEuMiwwLDEuNWMxLjQsMC45LDguNSwwLjgsMTEuMywwLjYKCQkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDEwLjZMNDMuMywxMWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45CgkJCQljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjNsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjEsMC44LDAuMSwxLjIsMGwwLjUtMC4yCgkJCQljMC40LTAuMiwwLjktMC4yLDEuMywwbDAuNSwwLjJjMC40LDAuMiwwLjgsMC4xLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjEsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yCgkJCQljMC4xLTAuMiwwLTAuMywwLjItMC40YzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMTIuMWMtMC4xLDAuMi0wLjMsMC44LDAsMS4xYzAuMywwLjQsMywxLjEsNi40LDEuMQoJCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwxMy4zYzAsMC41LDAuNiwyLjQsMS4zLDIuNmMxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQkJYzEuMy0wLjEsMi41LTAuNywzLjItMS44YzAuMy0wLjUsMC41LTEsMC41LTEuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTEuNiIgY3k9IjYuNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTMiIGN5PSI0LjkiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjUzIiBjeT0iNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1NC4zIiBjeT0iNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1MC45IiBjeT0iNC45IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJBbmltYWxzIj4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTI0LjIsMTFWMy41YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjcsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDEyLjksMjQuMiwxMS45LDI0LjIsMTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDEwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsMTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDEwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDE0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTI5LjUsMTIuNEwyOSwxMS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsMTIuNywyOS4xLDEyLjksMjkuNSwxMi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCwxMi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMjcuNiIgY3k9IjkuNyIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSIzMi40IiBjeT0iOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+CjwvZz4KPC9zdmc+";function Npt(e){var t,r=e.isActiveCategory,n=e.category,a=e.allowNavigation,i=e.categoryConfig,s=e.onClick;return w.createElement(T1,{tabIndex:a?0:-1,className:kr(jpt.catBtn,sm.categoryBtn,"epr-icn-"+n,(t={},t[Mr.active]=r,t)),onClick:s,"aria-label":fve(i),"aria-selected":r,role:"tab","aria-controls":"epr-category-nav-id"})}var Jte={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 3)"},Cpt={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 2)"},Zte={":not(.epr-search-active)":{catBtn:{":hover":Jte,"&.epr-active":Jte}}},jpt=Dn.create(pn({catBtn:{".":"epr-cat-btn",display:"inline-block",transition:"opacity 0.2s ease-in-out",position:"relative",height:"var(--epr-category-navigation-button-size)",width:"var(--epr-category-navigation-button-size)",backgroundSize:"calc(var(--epr-category-navigation-button-size) * 10)",outline:"none",backgroundPosition:"0 0",backgroundImage:"url("+_pt+")",":focus:before":{content:"",position:"absolute",top:"-2px",left:"-2px",right:"-2px",bottom:"-2px",border:"2px solid var(--epr-category-icon-active-color)",borderRadius:"50%"},"&.epr-icn-suggested":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -8)"},"&.epr-icn-custom":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -9)"},"&.epr-icn-activities":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -4)"},"&.epr-icn-animals_nature":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -1)"},"&.epr-icn-flags":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -7)"},"&.epr-icn-food_drink":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -2)"},"&.epr-icn-objects":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -5)"},"&.epr-icn-smileys_people":{backgroundPositionX:"0px"},"&.epr-icn-symbols":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -6)"},"&.epr-icn-travel_places":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -3)"}}},Pd("catBtn",Cpt),{".epr-dark-theme":pn({},Zte),".epr-auto-theme":pn({},Zte)}));function Ept(){var e=w.useState(null),t=e[0],r=e[1],n=b$(),a=n[1],i=Spt();wpt({setActiveCategory:r,setVisibleCategories:a});var s=Q2(),l=x$(),c=S$(),u=kpt();return w.createElement("div",{className:kr(Mpt.nav),role:"tablist","aria-label":"Category navigation",id:"epr-category-nav-id",ref:c},l.map(function(d){var f=K2(d),m=f===t;if(Imt(d)&&u)return null;var p=!s&&!m;return w.createElement(Npt,{key:f,category:f,isActiveCategory:m,allowNavigation:p,categoryConfig:d,onClick:function(){i(f),setTimeout(function(){r(f)},10)}})}))}var Mpt=Dn.create({nav:{".":"epr-category-nav",display:"flex",flexDirection:"row",justifyContent:"space-around",padding:"var(--epr-header-padding)"},".epr-search-active":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}},".epr-main:has(input:not(:placeholder-shown))":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}}}),dbe="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNi45OCwxMy41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsOAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQyTDcuNzQsNy4yN2MtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywxMy4wNSw2Ljc3LDEzLjM5LDYuOTgsMTMuNTlMNi45OCwxMy41OXoiLz4KPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTEwLjE1LDE4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDE0Ljg0LDUuNzQsMTguNDMsMTAuMTUsMTguNDN6CgkgTTEwLjE1LDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0QzMuMjEsNi42LDYuMzMsMy40OSwxMC4xNSwzLjQ5CglMMTAuMTUsMy40OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTYuOTgsMzMuNTljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1czAuMjctMC4wNSwwLjM3LTAuMTVsMi40Mi0yLjQybDIuNDMsMi40MwoJYzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNWMwLjE0LDAsMC4yNy0wLjA1LDAuMzctMC4xNWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWwtMi40My0yLjQzTDEzLjMyLDI4CgljMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwbC0yLjQyLDIuNDJsLTIuNDEtMi40MWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywzMy4wNSw2Ljc3LDMzLjM5LDYuOTgsMzMuNTlMNi45OCwzMy41OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTEwLjE1LDM4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDM0Ljg0LDUuNzQsMzguNDMsMTAuMTUsMzguNDN6CgkgTTEwLjE1LDIzLjQ5YzMuODMsMCw2Ljk0LDMuMTEsNi45NCw2Ljk0YzAsMy44My0zLjExLDYuOTQtNi45NCw2Ljk0Yy0zLjgzLDAtNi45NC0zLjExLTYuOTQtNi45NAoJQzMuMjEsMjYuNiw2LjMzLDIzLjQ5LDEwLjE1LDIzLjQ5TDEwLjE1LDIzLjQ5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNi45OCw1My41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsNDgKCWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDBsLTIuNDIsMi40MmwtMi40MS0yLjQxYy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMAoJYy0wLjIxLDAuMjEtMC4yMSwwLjU0LDAsMC43NWwyLjQxLDIuNDFsLTIuNDIsMi40MkM2Ljc3LDUzLjA1LDYuNzcsNTMuMzksNi45OCw1My41OUw2Ljk4LDUzLjU5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNMTAuMTUsNTguNDNjNC40MSwwLDgtMy41OSw4LThjMC00LjQxLTMuNTktOC04LThjLTQuNDEsMC04LDMuNTktOCw4QzIuMTUsNTQuODQsNS43NCw1OC40MywxMC4xNSw1OC40M3oKCSBNMTAuMTUsNDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0CglDMy4yMSw0Ni42LDYuMzMsNDMuNDksMTAuMTUsNDMuNDlMMTAuMTUsNDMuNDl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik02Ljk4LDczLjU5YzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNXMwLjI3LTAuMDUsMC4zNy0wLjE1bDIuNDItMi40MmwyLjQzLDIuNDMKCWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVjMC4xNCwwLDAuMjctMC4wNSwwLjM3LTAuMTVjMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVsLTIuNDMtMi40M0wxMy4zMiw2OAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQybC0yLjQxLTIuNDFjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwCgljLTAuMjEsMC4yMS0wLjIxLDAuNTQsMCwwLjc1bDIuNDEsMi40MWwtMi40MiwyLjQyQzYuNzcsNzMuMDUsNi43Nyw3My4zOSw2Ljk4LDczLjU5TDYuOTgsNzMuNTl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xMC4xNSw3OC40M2M0LjQxLDAsOC0zLjU5LDgtOGMwLTQuNDEtMy41OS04LTgtOGMtNC40MSwwLTgsMy41OS04LDhDMi4xNSw3NC44NCw1Ljc0LDc4LjQzLDEwLjE1LDc4LjQzegoJIE0xMC4xNSw2My40OWMzLjgzLDAsNi45NCwzLjExLDYuOTQsNi45NGMwLDMuODMtMy4xMSw2Ljk0LTYuOTQsNi45NGMtMy44MywwLTYuOTQtMy4xMS02Ljk0LTYuOTQKCUMzLjIxLDY2LjYsNi4zMyw2My40OSwxMC4xNSw2My40OUwxMC4xNSw2My40OXoiLz4KPC9zdmc+";function Tpt(){var e=Hve(),t=jht();return w.createElement(T1,{className:kr(Xte.btnClearSearch,sm.visibleOnSearchOnly),onClick:e,"aria-label":t,title:t},w.createElement("div",{className:kr(Xte.icnClearnSearch)}))}var Apt={":hover":{"> .epr-icn-clear-search":{backgroundPositionY:"-60px"}}},Xte=Dn.create(pn({btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+dbe+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},Pd("icnClearnSearch",{backgroundPositionY:"-40px"}),Pd("btnClearSearch",Apt))),Dpt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjAgMCAyMCA0MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgNDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTEyLDguODFjMCwyLjA4LTEuNjgsMy43Ni0zLjc2LDMuNzZjLTIuMDgsMC0zLjc2LTEuNjgtMy43Ni0zLjc2CgljMC0yLjA4LDEuNjgtMy43NiwzLjc2LTMuNzZDMTAuMzIsNS4wNSwxMiw2LjczLDEyLDguODF6IE0xMS4yMywxMi43MmMtMC44MywwLjY0LTEuODcsMS4wMS0yLjk5LDEuMDFjLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTIKCWMwLTIuNzIsMi4yLTQuOTIsNC45Mi00LjkyYzIuNzIsMCw0LjkyLDIuMiw0LjkyLDQuOTJjMCwxLjEzLTAuMzgsMi4xNi0xLjAxLDIuOTlsMy45NCwzLjkzYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyCgljLTAuMjUsMC4yNS0wLjY2LDAuMjUtMC45MiwwTDExLjIzLDEyLjcyeiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTEyLDI4LjgxYzAsMi4wOC0xLjY4LDMuNzYtMy43NiwzLjc2Yy0yLjA4LDAtMy43Ni0xLjY4LTMuNzYtMy43NgoJYzAtMi4wOCwxLjY4LTMuNzYsMy43Ni0zLjc2QzEwLjMyLDI1LjA1LDEyLDI2LjczLDEyLDI4LjgxeiBNMTEuMjMsMzIuNzJjLTAuODMsMC42NC0xLjg3LDEuMDEtMi45OSwxLjAxCgljLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTJjMC0yLjcyLDIuMi00LjkyLDQuOTItNC45MmMyLjcyLDAsNC45MiwyLjIsNC45Miw0LjkyYzAsMS4xMy0wLjM4LDIuMTYtMS4wMSwyLjk5bDMuOTQsMy45MwoJYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyYy0wLjI1LDAuMjUtMC42NiwwLjI1LTAuOTIsMEwxMS4yMywzMi43MnoiLz4KPC9zdmc+";function Lpt(){return w.createElement("div",{className:kr(Opt.icnSearch)})}var Opt=Dn.create(pn({icnSearch:{".":"epr-icn-search",content:"",position:"absolute",top:"50%",left:"var(--epr-search-bar-inner-padding)",transform:"translateY(-50%)",width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"20px",backgroundImage:"url("+Dpt+")"}},Pd("icnSearch",{backgroundPositionY:"-20px"})));function Ipt(){var e=Tve(),t=_$();return e?null:w.createElement(cbe,{className:kr(qk.overlay)},w.createElement(Rpt,null),t?w.createElement(ube,null):null)}function Rpt(){var e=dm(),t=Gd(),r=Cht(),n=Mht(),a=smt(),i=a.statusSearchResults,s=a.searchTerm,l=a.onChange,c=t?.current,u=c?.value;return w.createElement(nE,{className:kr(qk.searchContainer)},w.createElement("input",{autoFocus:n,"aria-label":"Type to search for an emoji",onFocus:e,className:kr(qk.search),type:"text","aria-controls":"epr-search-id",placeholder:r,onChange:function(f){var m,p;l((m=f==null||(p=f.target)==null?void 0:p.value)!=null?m:u)},ref:t}),s?w.createElement("div",{role:"status",className:kr("epr-status-search-results",qk.visuallyHidden),"aria-live":"polite",id:"epr-search-id","aria-atomic":"true"},i):null,w.createElement(Lpt,null),w.createElement(Tpt,null))}var qk=Dn.create(pn({overlay:{padding:"var(--epr-header-padding)",zIndex:"var(--epr-header-overlay-z-index)"},searchContainer:{".":"epr-search-container",flex:"1",display:"block",minWidth:"0"},visuallyHidden:{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:"1px"},search:{outline:"none",transition:"all 0.2s ease-in-out",color:"var(--epr-search-input-text-color)",borderRadius:"var(--epr-search-input-border-radius)",padding:"var(--epr-search-input-padding)",height:"var(--epr-search-input-height)",backgroundColor:"var(--epr-search-input-bg-color)",border:"1px solid var(--epr-search-border-color)",width:"100%",":focus":{backgroundColor:"var(--epr-search-input-bg-color-active)",border:"1px solid var(--epr-search-border-color-active)"},"::placeholder":{color:"var(--epr-search-input-placeholder-color)"}},btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+dbe+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},Pd("icnClearnSearch",{backgroundPositionY:"-40px"}),Pd("btnClearSearch",{":hover > .epr-icn-clear-search":{backgroundPositionY:"-60px"}})));function Ppt(){return w.createElement(nE,{className:kr("epr-header",sm.hiddenOnReactions)},w.createElement(Ipt,null),w.createElement(Ept,null))}function zpt(e){return w.createElement(Uht,null,w.createElement(Bft,null),w.createElement(oht,Object.assign({},e),w.createElement(ght,null,w.createElement(Bpt,null))))}function Bpt(){var e=lm(),t=e[0],r=Nve(),n=w.useState(!t),a=n[0],i=n[1],s=Aht();return w.useEffect(function(){t&&!r||a||i(!0)},[a,r,t]),s?w.createElement(Nmt,null,w.createElement(Kmt,null),w.createElement($pt,{renderAll:a})):null}function $pt(e){var t=e.renderAll;return t?w.createElement(w.Fragment,null,w.createElement(Ppt,null),w.createElement(cpt,null),w.createElement(bpt,null)):null}var Fpt=w.memo(zpt,sve),Upt=(function(e){Pft(t,e);function t(n){var a;return a=e.call(this,n)||this,a.state={hasError:!1},a}t.getDerivedStateFromError=function(){return{hasError:!0}};var r=t.prototype;return r.componentDidCatch=function(a,i){console.error("Emoji Picker React failed to render:",a,i)},r.render=function(){return this.state.hasError?null:this.props.children},t})(w.Component);function Hpt(e){var t=Nht({onEmojiClick:e.onEmojiClick,onReactionClick:e.onReactionClick,onSkinToneChange:e.onSkinToneChange});return w.createElement(Upt,null,w.createElement(kve.Provider,{value:t},w.createElement(Fpt,Object.assign({},e))))}function qpt({isOpen:e,onClose:t,onSelect:r}){const[n,a]=w.useState([]);w.useEffect(()=>{if(e){const u=localStorage.getItem("stoneforge.recentEmojis");if(u)try{a(JSON.parse(u))}catch{a([])}}},[e]);const i=w.useCallback(u=>{const d=u.emoji;a(f=>{const m=f.filter(v=>v!==d),p=[d,...m].slice(0,20);return localStorage.setItem("stoneforge.recentEmojis",JSON.stringify(p)),p}),r(d),t()},[r,t]);w.useEffect(()=>{const u=d=>{e&&d.key==="Escape"&&(d.preventDefault(),t())};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[e,t]);const s=w.useMemo(()=>typeof document<"u"&&document.documentElement.classList.contains("dark")?Dd.DARK:Dd.LIGHT,[e]),l=jo(),c=l?null:o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Tip: Type ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-xs font-mono",children:":emoji:"})," in the editor to quickly insert emojis"]});return o.jsx(Bx,{open:e,onClose:t,title:"Insert Emoji",size:"sm","data-testid":"emoji-picker-modal",footer:c,children:o.jsx("div",{className:"p-2",children:o.jsx(Hpt,{onEmojiClick:i,theme:s,searchPlaceholder:"Search emojis...",suggestedEmojisMode:Hg.RECENT,categories:[{category:Vt.SUGGESTED,name:"Recently Used"},{category:Vt.SMILEYS_PEOPLE,name:"Smileys & People"},{category:Vt.ANIMALS_NATURE,name:"Animals & Nature"},{category:Vt.FOOD_DRINK,name:"Food & Drink"},{category:Vt.TRAVEL_PLACES,name:"Travel & Places"},{category:Vt.ACTIVITIES,name:"Activities"},{category:Vt.OBJECTS,name:"Objects"},{category:Vt.SYMBOLS,name:"Symbols"},{category:Vt.FLAGS,name:"Flags"}],width:l?"100%":350,height:l?"calc(100vh - 150px)":400,previewConfig:{showPreview:!l},lazyLoadEmojis:!0,"data-testid":"emoji-picker-grid"})})})}function Wpt({isOpen:e,onClose:t,onSelect:r,selectedIds:n}){const[a,i]=w.useState(""),{data:s,isLoading:l}=RJe(a),c=w.useRef(null);if(w.useEffect(()=>{e&&c.current&&c.current.focus()},[e]),w.useEffect(()=>{if(e){const d=f=>{f.key==="Escape"&&t()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)}},[e,t]),!e)return null;const u=s?.filter(d=>!n.includes(d.id))||[];return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"message-attachment-picker",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[60vh] flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attach Document"}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 rounded","data-testid":"attachment-picker-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:c,type:"text",placeholder:"Search documents...",value:a,onChange:d=>i(d.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500","data-testid":"attachment-search"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx($e,{className:"w-6 h-6 animate-spin text-gray-400"})}):u.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500","data-testid":"attachment-picker-empty",children:s?.length===0?"No documents available":a?"No documents match your search":"All documents are already attached"}):o.jsx("div",{className:"space-y-2",children:u.map(d=>o.jsxs("button",{onClick:()=>r(d),className:"w-full flex items-center gap-3 p-3 text-left bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors","data-testid":`attachment-option-${d.id}`,children:[o.jsx(rn,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 truncate",children:d.title||"Untitled Document"}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:d.id}),o.jsx("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-600 rounded",children:d.contentType})]})]})]},d.id))})})]})]})}function Kpt({channelId:e,channel:t,isMobile:r=!1}){const[n,a]=w.useState(""),[i,s]=w.useState([]),[l,c]=w.useState([]),[u,d]=w.useState(!1),[f,m]=w.useState(!1),[p,v]=w.useState(!1),[b,y]=w.useState(!1),[S,_]=w.useState(!1),[N,k]=w.useState(!1),j=kme(),E=w.useRef(null),T=w.useRef(null),[O,R]=w.useState(!1),{currentUser:q}=nl(),{data:$=[]}=AB();w.useEffect(()=>{E.current?.focus()},[e]);const L=w.useMemo(()=>({onTaskEmbed:()=>y(!0),onDocumentEmbed:()=>_(!0),onEmojiInsert:()=>k(!0)}),[]),A=w.useCallback(te=>{a(oe=>oe+`#task:${te}`),y(!1),E.current?.focus()},[]),M=w.useCallback(te=>{a(oe=>oe+`#doc:${te}`),_(!1),E.current?.focus()},[]),z=w.useCallback(te=>{a(oe=>oe+te),k(!1),E.current?.focus()},[]),I=te=>{s(oe=>[...oe,te]),d(!1)},B=te=>{s(oe=>oe.filter(ce=>ce.id!==te))},F=te=>{const oe=te.split("/").pop()||"image";c(ce=>[...ce,{url:te,filename:oe}]),m(!1)},U=te=>{c(oe=>oe.filter(ce=>ce.url!==te))},V=async te=>{if(!["image/jpeg","image/png","image/gif","image/webp"].includes(te.type))return Kr.error(`Invalid file type: ${te.type}`),null;if(te.size>10*1024*1024)return Kr.error("File too large (max 10MB)"),null;v(!0);try{const ce=new FormData;ce.append("file",te);const Z=await fetch("/api/uploads",{method:"POST",body:ce});if(!Z.ok)throw new Error("Upload failed");return(await Z.json()).url}catch{return Kr.error("Failed to upload image"),null}finally{v(!1)}},K=async te=>{const oe=await V(te);oe&&(F(oe),Kr.success("Image attached"))},G=async te=>{te.preventDefault(),R(!1);const oe=te.dataTransfer.files[0];if(oe&&oe.type.startsWith("image/")){const ce=await V(oe);ce&&(F(ce),Kr.success("Image attached"))}},J=te=>{te.preventDefault(),te.dataTransfer.types.includes("Files")&&R(!0)},ee=te=>{te.preventDefault(),R(!1)},Y=async()=>{const te=n.trim().length>0,oe=l.length>0,ce=i.length>0;if(!te&&!oe&&!ce||!t||!q)return;const Z=q.id;try{let ue=n.trim();if(l.length>0){const H=l.map(ge=>`![${ge.filename||"image"}](${ge.url})`).join(`
`);ue=ue?`${ue}

${H}`:H}await j.mutateAsync({channelId:e,sender:Z,content:ue,attachmentIds:i.map(H=>H.id)}),a(""),s([]),c([]),E.current?.clear()}catch(ue){console.error("Failed to send message:",ue)}},ie=te=>{te.preventDefault(),Y()},fe=i.length>0||l.length>0,me=n.trim()||fe;return o.jsxs(o.Fragment,{children:[o.jsxs("form",{ref:T,"data-testid":"message-composer",onSubmit:ie,onDrop:G,onDragOver:J,onDragLeave:ee,className:`border-t border-[var(--color-border)] bg-[var(--color-bg)] relative ${r?"p-2":"p-4"} ${O?"ring-2 ring-blue-500 ring-inset bg-blue-50 dark:bg-blue-900/30":""}`,children:[O&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-blue-50/90 dark:bg-blue-900/80 z-10 pointer-events-none",children:o.jsxs("div",{className:"flex flex-col items-center text-blue-600 dark:text-blue-400",children:[o.jsx(iy,{className:r?"w-6 h-6 mb-1":"w-8 h-8 mb-2"}),o.jsx("span",{className:`font-medium ${r?"text-xs":"text-sm"}`,children:"Drop image here"})]})}),l.length>0&&o.jsx("div",{className:`flex flex-wrap mb-2 ${r?"gap-1.5":"gap-2"}`,"data-testid":"message-image-attachments-preview",children:l.map(te=>o.jsxs("div",{className:"relative group","data-testid":`image-attachment-preview-${te.filename}`,children:[o.jsx("img",{src:te.url,alt:te.filename||"Attached image",className:`object-cover rounded-lg border border-[var(--color-border)] ${r?"w-14 h-14":"w-20 h-20"}`}),o.jsx("button",{type:"button",onClick:()=>U(te.url),className:`absolute -top-1 -right-1 bg-red-500 text-white rounded-full transition-opacity ${r?"p-0.5 opacity-100":"p-1 opacity-0 group-hover:opacity-100"}`,"data-testid":`remove-image-attachment-${te.filename}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},te.url))}),i.length>0&&o.jsx("div",{className:`flex flex-wrap mb-2 ${r?"gap-1.5":"gap-2"}`,"data-testid":"message-attachments-preview",children:i.map(te=>o.jsxs("div",{className:`flex items-center gap-2 bg-gray-100 dark:bg-gray-800 rounded-md ${r?"px-1.5 py-0.5 text-xs":"px-2 py-1 text-sm"}`,"data-testid":`attachment-preview-${te.id}`,children:[o.jsx(rn,{className:`text-gray-400 ${r?"w-3 h-3":"w-4 h-4"}`}),o.jsx("span",{className:`truncate ${r?"max-w-[100px]":"max-w-[150px]"}`,children:te.title||"Untitled"}),o.jsx("button",{type:"button",onClick:()=>B(te.id),className:"p-0.5 text-gray-400 hover:text-red-500","data-testid":`remove-attachment-${te.id}`,children:o.jsx(wt,{className:"w-3 h-3"})})]},te.id))}),o.jsxs("div",{className:`flex items-end ${r?"gap-1":"gap-2"}`,children:[o.jsx("button",{type:"button",onClick:()=>m(!0),disabled:p,className:`text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors self-end disabled:opacity-50 ${r?"p-2 touch-target":"p-2 mb-1"}`,"data-testid":"message-image-attach-button",title:"Attach image",children:p?o.jsx($e,{className:"w-5 h-5 animate-spin"}):o.jsx(iy,{className:"w-5 h-5"})}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:`text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors self-end ${r?"p-2 touch-target":"p-2 mb-1"}`,"data-testid":"message-attach-button",title:"Attach document",children:o.jsx(HC,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx(dhe,{ref:E,content:n,onChange:a,onSubmit:Y,onImagePaste:K,channelName:t?.name,disabled:j.isPending,maxHeight:r?120:180,minHeight:r?44:60,embedCallbacks:L,mentionEntities:$})}),o.jsxs("button",{type:"submit","data-testid":"message-send-button",disabled:!me||j.isPending,className:`bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center self-end ${r?"p-2.5 touch-target":"px-4 py-2 gap-2 mb-1"}`,children:[o.jsx(QC,{className:r?"w-5 h-5":"w-4 h-4"}),o.jsx("span",{className:"sr-only",children:"Send"})]})]}),j.isError&&o.jsx("p",{"data-testid":"message-send-error",className:`mt-2 text-red-500 ${r?"text-xs":"text-sm"}`,children:j.error?.message||"Failed to send message. Please try again."})]}),o.jsx(Wpt,{isOpen:u,onClose:()=>d(!1),onSelect:I,selectedIds:i.map(te=>te.id)}),o.jsx(YKe,{isOpen:f,onClose:()=>m(!1),onAttach:F}),o.jsx(Sft,{isOpen:b,onClose:()=>y(!1),onSelect:A}),o.jsx(Nft,{isOpen:S,onClose:()=>_(!1),onSelect:M}),o.jsx(qpt,{isOpen:N,onClose:()=>k(!1),onSelect:z})]})}function ere({searchQuery:e,channelId:t,onSelectResult:r,onClose:n}){const{data:a,isLoading:i}=IJe(e,t),s=a?.results||[],[l,c]=w.useState(0),u=w.useRef(null);if(w.useEffect(()=>{c(0)},[s.length]),w.useEffect(()=>{const f=m=>{m.key==="ArrowDown"?(m.preventDefault(),c(p=>Math.min(p+1,s.length-1))):m.key==="ArrowUp"?(m.preventDefault(),c(p=>Math.max(p-1,0))):m.key==="Enter"?(m.preventDefault(),s[l]&&(r(s[l].id),n())):m.key==="Escape"&&(m.preventDefault(),n())};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[s,l,r,n]),w.useEffect(()=>{if(u.current){const f=u.current.children[l];f&&f.scrollIntoView({block:"nearest"})}},[l]),!e.trim())return null;const d=f=>{const m=new Date(f),p=new Date;return m.toDateString()===p.toDateString()?m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):m.toLocaleDateString([],{month:"short",day:"numeric"})};return o.jsx("div",{"data-testid":"message-search-dropdown",className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-80 overflow-hidden",children:i?o.jsxs("div",{className:"flex items-center justify-center py-6","data-testid":"message-search-loading",children:[o.jsx($e,{className:"w-5 h-5 animate-spin text-gray-400"}),o.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Searching..."})]}):s.length===0?o.jsxs("div",{className:"py-6 text-center","data-testid":"message-search-empty",children:[o.jsx(br,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),o.jsx("p",{className:"text-sm text-gray-500",children:"No messages found"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Try a different search term"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500 border-b border-gray-100",children:[s.length," result",s.length!==1?"s":""," found"]}),o.jsx("div",{ref:u,className:"overflow-y-auto max-h-64","data-testid":"message-search-results",children:s.map((f,m)=>o.jsxs("button",{onClick:()=>{r(f.id),n()},className:`w-full text-left px-3 py-2 flex items-start gap-3 transition-colors ${m===l?"bg-blue-50":"hover:bg-gray-50"}`,"data-testid":`message-search-result-${f.id}`,children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:o.jsx("span",{className:"text-blue-600 font-medium text-xs",children:f.sender.slice(-2).toUpperCase()})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-baseline gap-2",children:[o.jsx(zie,{entityRef:f.sender,className:"font-medium text-sm"}),o.jsx("span",{className:"text-xs text-gray-400",children:d(f.createdAt)})]}),o.jsx("p",{className:"text-sm text-gray-600 truncate mt-0.5",children:VQe(f.snippet,e)})]})]},f.id))}),o.jsxs("div",{className:"px-3 py-2 text-xs text-gray-400 border-t border-gray-100",children:[o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:""})," ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:""})," navigate"," ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:"Enter"})," select"," ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:"Esc"})," close"]})]})})}function fbe({parentMessage:e,channel:t,onClose:r}){const{data:n=[],isLoading:a}=LJe(e.id);return o.jsxs("div",{"data-testid":"thread-panel",className:"w-80 border-l border-gray-200 flex flex-col bg-white",children:[o.jsxs("div",{"data-testid":"thread-header",className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[o.jsx("h3",{className:"font-medium text-gray-900",children:"Thread"}),o.jsx("button",{"data-testid":"thread-close-button",onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{"data-testid":"thread-parent-message",className:"border-b border-gray-100",children:o.jsx(t5,{message:e,isThreaded:!0})}),o.jsx("div",{"data-testid":"thread-replies",className:"flex-1 overflow-hidden p-2",children:a?o.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"Loading replies..."}):o.jsx(V0e,{items:n,getItemKey:i=>i.id,estimateSize:i=>{const c=n[i]?._content||"";return c.includes("![")&&c.includes("](")?420:80},testId:"virtualized-thread-replies",gap:4,latestMessageId:n[n.length-1]?.id,renderEmpty:()=>o.jsx("div",{"data-testid":"thread-empty",className:"text-center py-4 text-gray-500 text-sm",children:"No replies yet"}),renderItem:i=>o.jsx(t5,{message:i,isThreaded:!0})})}),o.jsx(Gpt,{parentMessage:e,channel:t})]})}function Gpt({parentMessage:e,channel:t}){const[r,n]=w.useState(""),a=kme(),i=w.useRef(null),{currentUser:s}=nl(),{data:l=[]}=AB(),c=async()=>{if(!r.trim()||!t||!s)return;const d=s.id;try{await a.mutateAsync({channelId:e.channelId,sender:d,content:r.trim(),threadId:e.id}),n(""),i.current?.clear()}catch(f){console.error("Failed to send reply:",f)}},u=d=>{d.preventDefault(),c()};return o.jsx("form",{"data-testid":"thread-composer",onSubmit:u,className:"p-3 border-t border-gray-200 bg-white",children:o.jsxs("div",{className:"flex gap-2 items-end",children:[o.jsx("div",{className:"flex-1",children:o.jsx(dhe,{ref:i,content:r,onChange:n,onSubmit:c,placeholder:"Reply in thread...",disabled:a.isPending,maxHeight:120,minHeight:48,mentionEntities:l})}),o.jsx("button",{type:"submit","data-testid":"thread-send-button",disabled:!r.trim()||a.isPending,className:"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors self-end mb-1",children:o.jsx(QC,{className:"w-4 h-4"})})]})})}const Vpt="el-0000",Ypt=100;function tre({channelId:e,isMobile:t=!1,onBack:r,onChannelDeleted:n}){const{data:a}=AJe(e),{data:i=[],isLoading:s,error:l}=DJe(e),{currentUser:c}=nl(),u=OJe(),[d,f]=w.useState(null),[m,p]=w.useState(!1),[v,b]=w.useState(!1),[y,S]=w.useState(null),[_,N]=w.useState(!1),{searchQuery:k,setSearchQuery:j,isSearchOpen:E,setIsSearchOpen:T,searchInputRef:O,clearSearch:R}=a_e({enableKeyboardShortcut:!0}),q=c?.id||"",$=a&&a.channelType!=="direct"&&(q===Vpt||a.createdBy===q),L=async()=>{if(!(!a||!q))try{await u.mutateAsync({channelId:a.id,actor:q}),N(!1),n?.()}catch{}},A=w.useCallback(K=>{R(),b(!1);const G=document.querySelector(`[data-testid="message-${K}"]`);G&&(G.scrollIntoView({behavior:"smooth",block:"center"}),S(K),setTimeout(()=>{S(null)},2e3))},[R]);w.useEffect(()=>{if(!y)return;const K=()=>{S(null)},G=setTimeout(()=>{document.addEventListener("click",K)},100);return()=>{clearTimeout(G),document.removeEventListener("click",K)}},[y]);const M=i.reduce((K,G)=>(G.threadId&&(K[G.threadId]=(K[G.threadId]||0)+1),K),{}),z=i.filter(K=>!K.threadId),I=w.useMemo(()=>Vdt(z,K=>K.createdAt),[z]),B=K=>{f(K)},F=()=>o.jsxs("div",{className:"relative","data-testid":"message-search-container",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:O,type:"text",value:k,onChange:K=>{j(K.target.value),T(K.target.value.length>0)},onFocus:()=>k&&T(!0),onKeyDown:K=>{K.key==="Escape"&&(R(),O.current?.blur())},placeholder:"Search messages...",className:"w-48 pl-8 pr-8 py-1.5 text-sm border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-[var(--color-surface)] text-[var(--color-text)]","data-testid":"message-search-input"}),k&&o.jsx("button",{onClick:()=>{R(),O.current?.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","data-testid":"message-search-clear",children:o.jsx(oi,{className:"w-4 h-4"})})]}),E&&o.jsx(ere,{searchQuery:k,channelId:e,onSelectResult:A,onClose:()=>T(!1)})]}),U=K=>$?o.jsx("button",{onClick:()=>N(!0),disabled:u.isPending,className:`rounded-md text-gray-500 dark:text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors disabled:opacity-50 ${K?"p-2 touch-target":"p-1.5 ml-2"}`,"data-testid":"delete-channel-header-button","aria-label":"Delete channel",title:"Delete channel",children:u.isPending?o.jsx($e,{className:`animate-spin ${K?"w-5 h-5":"w-4 h-4"}`}):o.jsx(Sr,{className:K?"w-5 h-5":"w-4 h-4"})}):null,V=({isMobile:K})=>a?K?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>b(!v),className:"p-2 rounded-md text-gray-500 dark:text-gray-400 hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"mobile-search-toggle","aria-label":"Search messages",children:o.jsx(br,{className:"w-5 h-5"})}),U(!0)]}):o.jsxs("div",{className:"flex items-center",children:[F(),U(!1)]}):null;return o.jsxs("div",{"data-testid":"channel-view",className:`flex-1 flex bg-[var(--color-bg)] ${t?"absolute inset-0 z-40":""}`,children:[o.jsxs("div",{className:"flex-1 flex flex-col",children:[a&&o.jsxs("div",{children:[o.jsx(n_e,{channel:a,isMobile:t,onBack:r,onOpenMembers:()=>p(!0),renderIcon:K=>o.jsx(Uie,{channel:K,className:t?"w-4 h-4":"w-5 h-5"}),renderActions:V}),t&&v&&o.jsxs("div",{className:"px-3 pb-3 relative","data-testid":"mobile-message-search-container",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:O,type:"text",value:k,onChange:K=>{j(K.target.value),T(K.target.value.length>0)},onFocus:()=>k&&T(!0),onKeyDown:K=>{K.key==="Escape"&&(R(),b(!1))},placeholder:"Search...",className:"w-full pl-10 pr-10 py-2.5 text-base border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-[var(--color-surface)] text-[var(--color-text)]","data-testid":"mobile-message-search-input",autoFocus:!0}),k&&o.jsx("button",{onClick:()=>{R(),O.current?.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(oi,{className:"w-5 h-5"})})]}),E&&o.jsx(ere,{searchQuery:k,channelId:e,onSelectResult:K=>{A(K),b(!1)},onClose:()=>{T(!1),b(!1)}})]})]}),o.jsx("div",{"data-testid":"messages-container",className:`flex-1 overflow-hidden ${t?"p-2":"p-4"}`,children:s?o.jsx("div",{"data-testid":"messages-loading",className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"Loading messages..."}):l?o.jsx("div",{"data-testid":"messages-error",className:"flex items-center justify-center h-full text-red-500",children:"Failed to load messages"}):o.jsx(V0e,{items:I,getItemKey:K=>K.item.id,estimateSize:K=>{const G=t?80:Ypt,J=I[K];let ee=G;J?.isFirstInDay&&(ee+=48);const Y=J?.item?._content||"";return Y.includes("![")&&Y.includes("](")&&(ee+=340),ee},scrollRestoreId:`messages-${e}`,testId:"virtualized-messages-list",gap:t?4:8,latestMessageId:z[z.length-1]?.id,renderEmpty:()=>o.jsxs("div",{"data-testid":"messages-empty",className:`flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 ${t?"px-4":""}`,children:[o.jsx(ss,{className:`mb-3 text-gray-300 dark:text-gray-600 ${t?"w-10 h-10":"w-12 h-12"}`}),o.jsx("p",{className:t?"text-base":"text-sm",children:"No messages yet"}),o.jsx("p",{className:`text-gray-400 dark:text-gray-500 mt-1 ${t?"text-sm":"text-xs"}`,children:"Be the first to send a message!"})]}),renderItem:K=>o.jsxs("div",{children:[K.isFirstInDay&&o.jsx(bft,{date:K.formattedDate}),o.jsx(t5,{message:K.item,onReply:B,replyCount:M[K.item.id]||0,isHighlighted:y===K.item.id,isMobile:t})]})})}),o.jsx(Kpt,{channelId:e,channel:a,isMobile:t})]}),d&&!t&&o.jsx(fbe,{parentMessage:d,channel:a,onClose:()=>f(null)}),d&&t&&o.jsx(Qpt,{selectedThread:d,channel:a,onClose:()=>f(null)}),m&&a&&q&&o.jsx(oGe,{channel:a,currentOperator:q,onClose:()=>p(!1),onChannelDeleted:n}),_&&a&&o.jsxs("div",{className:"fixed inset-0 z-[60]",onClick:()=>N(!1),"data-testid":"delete-channel-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm mx-4",onClick:K=>K.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Channel"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsxs("div",{className:"px-5 py-4",children:[o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-3",children:"All messages and data in this channel will be permanently deleted."}),o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-md border border-[var(--color-border)]",children:[o.jsxs("p",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:a.name,children:["#",a.name]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono mt-1",children:a.id})]})]}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>N(!1),disabled:u.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"delete-channel-cancel",children:"Cancel"}),o.jsxs("button",{onClick:L,disabled:u.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"delete-channel-confirm",children:[u.isPending&&o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Delete"]})]}),u.isError&&o.jsx("div",{className:"px-5 py-3 border-t border-[var(--color-border)]",children:o.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[o.jsx(Bt,{className:"w-4 h-4"}),u.error.message]})})]})})]})]})}function Qpt({selectedThread:e,channel:t,onClose:r}){return o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)] flex flex-col","data-testid":"mobile-thread-panel",children:[o.jsxs("div",{className:"flex items-center gap-2 p-3 border-b border-[var(--color-border)]",children:[o.jsx("button",{onClick:r,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"mobile-thread-back","aria-label":"Close thread",children:o.jsx(Fl,{className:"w-5 h-5"})}),o.jsx("span",{className:"font-medium text-[var(--color-text)]",children:"Thread"})]}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(fbe,{parentMessage:e,channel:t,onClose:r})})]})}function Jpt(){const e=Ma(),t=rl({from:"/messages"}),r=jo(),{currentUser:n}=nl(),[a,i]=w.useState(""),[s,l]=w.useState(t.channel??null),[c,u]=w.useState(!1),d=w.useRef(null);w.useEffect(()=>{d.current=n?.id??null},[n]);const f=w.useCallback(T=>{if(T.elementType==="message"&&T.eventType==="created"){const O=T.newValue?.channelId,R=T.newValue?.sender;if(R&&d.current&&R===d.current)return;O&&O===s&&Kr.info("New message received",{description:"The conversation has been updated",duration:3e3})}},[s]);v2({channels:s?[`messages:${s}`,"messages"]:["messages"],onEvent:f});const{data:m,isLoading:p,isError:v}=CJe(),b=w.useMemo(()=>EZe({search:a}),[a]),y=w.useMemo(()=>m?[...b?m.filter(b):m].sort((O,R)=>new Date(R.updatedAt).getTime()-new Date(O.updatedAt).getTime()):[],[m,b]),S=m?.length??0;w.useEffect(()=>{t.channel&&t.channel!==s&&l(t.channel),!t.channel&&s&&l(null)},[t.channel]);const _=T=>{l(T),e({to:"/messages",search:{channel:T,message:void 0}})},N=T=>{i(T)},k=T=>{l(T.id),e({to:"/messages",search:{channel:T.id,message:void 0}})},j=()=>{l(null),e({to:"/messages",search:{channel:void 0,message:void 0}})},E=w.useCallback(()=>{l(null),e({to:"/messages",search:{channel:void 0,message:void 0}}),Kr.success("Channel deleted",{description:"The channel has been permanently deleted",duration:3e3})},[e]);return v?o.jsx("div",{"data-testid":"messages-page-error",className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center px-4",children:[o.jsx("p",{className:"text-red-500 mb-2",children:"Failed to load channels"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Please try refreshing the page"})]})}):r?o.jsxs("div",{"data-testid":"messages-page",className:"flex flex-col h-full relative",children:[!s&&o.jsxs(o.Fragment,{children:[p?o.jsx("div",{"data-testid":"channels-loading",className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading channels..."})}):o.jsx(Ete,{channels:y,selectedChannelId:s,onSelectChannel:_,onNewChannel:()=>u(!0),totalChannels:S,searchQuery:a,onSearchChange:N,isMobile:!0}),o.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-20 right-4 w-14 h-14 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors z-30 touch-target","data-testid":"mobile-create-channel-fab","aria-label":"Create new channel",children:o.jsx(_r,{className:"w-6 h-6"})})]}),s&&o.jsx(tre,{channelId:s,isMobile:!0,onBack:j,onChannelDeleted:E}),o.jsx(sZ,{isOpen:c,onClose:()=>u(!1),onSuccess:k})]}):o.jsxs("div",{"data-testid":"messages-page",className:"flex h-full",children:[p?o.jsx("div",{"data-testid":"channels-loading",className:"w-64 border-r border-[var(--color-border)] flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading channels..."})}):o.jsx(Ete,{channels:y,selectedChannelId:s,onSelectChannel:_,onNewChannel:()=>u(!0),totalChannels:S,searchQuery:a,onSearchChange:N,isMobile:!1}),s?o.jsx(tre,{channelId:s,isMobile:!1,onChannelDeleted:E}):o.jsx(gft,{isMobile:!1}),o.jsx(sZ,{isOpen:c,onClose:()=>u(!1),onSuccess:k})]})}function rre({elementType:e,elementId:t,backRoute:r,backLabel:n,onDismiss:a}){const i=Ma(),s=()=>{a?.(),i({to:r})};return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center","data-testid":"element-not-found",children:[o.jsx("div",{className:"mb-4 p-3 bg-yellow-50 rounded-full",children:o.jsx(Bt,{className:"w-8 h-8 text-yellow-500"})}),o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2","data-testid":"not-found-title",children:[e," Not Found"]}),o.jsxs("p",{className:"text-gray-600 mb-1","data-testid":"not-found-message",children:["The ",e.toLowerCase()," you're looking for doesn't exist or has been deleted."]}),o.jsxs("p",{className:"text-sm text-gray-500 font-mono mb-6","data-testid":"not-found-id",children:["ID: ",t]}),o.jsxs("button",{onClick:s,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors","data-testid":"not-found-back-button",children:[o.jsx(zx,{className:"w-4 h-4"}),n]})]})}function Zpt({open:e,onClose:t,children:r,title:n,"data-testid":a="mobile-detail-sheet"}){const i=w.useRef(null),s=w.useRef(null),l=w.useRef(0);w.useEffect(()=>{if(e){const f=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=f}}},[e]),w.useEffect(()=>{if(!e)return;const f=m=>{m.key==="Escape"&&t()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[e,t]),w.useEffect(()=>{if(!e)return;window.history.pushState({mobileSheet:!0},"");const f=m=>{m.state?.mobileSheet===void 0&&t()};return window.addEventListener("popstate",f),()=>{window.removeEventListener("popstate",f),window.history.state?.mobileSheet&&window.history.back()}},[e,t]);const c=f=>{s.current=f.touches[0].clientY,l.current=0},u=f=>{s.current!==null&&(l.current=f.touches[0].clientY-s.current,l.current<0&&(l.current=0),i.current&&l.current>0&&(i.current.style.transform=`translateY(${l.current}px)`))},d=()=>{s.current!==null&&(l.current>100?t():i.current&&(i.current.style.transform="translateY(0)"),s.current=null,l.current=0)};return w.useEffect(()=>{e&&i.current&&i.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},[e]),e?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":a,role:"dialog","aria-modal":"true","aria-label":n||"Detail view",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-200",onClick:t,"data-testid":`${a}-backdrop`,"aria-hidden":"true"}),o.jsxs("div",{ref:i,className:"absolute inset-x-0 bottom-0 top-0 bg-[var(--color-bg)] shadow-2xl flex flex-col transform transition-transform duration-200 ease-out",style:{transform:e?"translateY(0)":"translateY(100%)"},"data-testid":`${a}-content`,children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",onTouchStart:c,onTouchMove:u,onTouchEnd:d,children:[o.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 w-10 h-1 bg-[var(--color-border)] rounded-full"}),o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Close","data-testid":`${a}-close`,children:o.jsx(Fl,{className:"w-5 h-5"})}),n&&o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)] truncate",children:n})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:r})]})]}):null}function Xpt(){return gt({queryKey:["libraries"],queryFn:async()=>{const e=await fetch("/api/libraries");if(!e.ok)throw new Error("Failed to fetch libraries");return e.json()}})}function egt(){const e=ht();return Ct({mutationFn:async t=>{const r=await fetch("/api/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to create document")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["libraries"]}),e.invalidateQueries({queryKey:["stats"]})}})}const tgt=[{value:"text",label:"Plain Text"},{value:"markdown",label:"Markdown"},{value:"json",label:"JSON"}];function nre({isOpen:e,onClose:t,onSuccess:r,defaultLibraryId:n,isMobile:a=!1}){const[i,s]=w.useState(""),[l,c]=w.useState("markdown"),[u,d]=w.useState(""),[f,m]=w.useState([]),[p,v]=w.useState(n||""),b=w.useRef(null),y=egt(),{data:S}=Xpt(),{currentUser:_}=nl();w.useEffect(()=>{e&&b.current&&b.current.focus()},[e]),w.useEffect(()=>{e||(s(""),c("markdown"),d(""),m([]),v(n||""),y.reset())},[e,n]),w.useEffect(()=>{n&&v(n)},[n]);const N=async j=>{if(j.preventDefault(),!i.trim()||!_)return;const E={title:i.trim(),contentType:l,content:u,createdBy:_.id};f.length>0&&(E.tags=f),p&&(E.libraryId=p);try{const T=await y.mutateAsync(E);r?.(T),t()}catch{}},k=j=>{j.key==="Escape"&&t()};return e?o.jsxs("div",{className:`fixed inset-0 z-50 flex ${a?"items-end":"items-start justify-center overflow-y-auto py-8"}`,"data-testid":"create-document-modal",onKeyDown:k,children:[o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"data-testid":"create-document-modal-backdrop"}),o.jsx("div",{className:`relative w-full ${a?"h-full":"max-w-lg mx-4"}`,children:o.jsxs("div",{className:`bg-white dark:bg-[var(--color-bg)] ${a?"h-full flex flex-col rounded-t-xl":"rounded-xl"} shadow-2xl border border-gray-200 dark:border-[var(--color-border)] overflow-hidden`,children:[o.jsxs("div",{className:`flex items-center justify-between ${a?"px-4 py-4":"px-4 py-3"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(rn,{className:"w-5 h-5 text-blue-500"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-[var(--color-text)]",children:"Create Document"})]}),o.jsx("button",{onClick:t,className:`${a?"p-2 touch-target":"p-1"} text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded`,"aria-label":"Close","data-testid":"create-document-modal-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:N,className:`${a?"flex-1 overflow-y-auto":""} p-4`,children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"document-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:b,id:"document-title",type:"text",value:i,onChange:j=>s(j.target.value),placeholder:"Enter document title...",className:`w-full px-3 ${a?"py-3":"py-2"} border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`,"data-testid":"create-document-title-input",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"document-content-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Content Type"}),o.jsx("select",{id:"document-content-type",value:l,onChange:j=>c(j.target.value),className:`w-full px-3 ${a?"py-3":"py-2"} border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`,"data-testid":"create-document-content-type-select",children:tgt.map(j=>o.jsx("option",{value:j.value,children:j.label},j.value))})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"document-library",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Library (optional)"}),o.jsxs("select",{id:"document-library",value:p,onChange:j=>v(j.target.value),className:`w-full px-3 ${a?"py-3":"py-2"} border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`,"data-testid":"create-document-library-select",children:[o.jsx("option",{value:"",children:"No library"}),S?.map(j=>o.jsx("option",{value:j.id,children:j.name},j.id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"document-content",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Initial Content"}),o.jsx("textarea",{id:"document-content",value:u,onChange:j=>d(j.target.value),placeholder:l==="json"?`{
  "key": "value"
}`:l==="markdown"?`# Heading

Start writing...`:"Start writing...",className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm ${a?"min-h-[150px]":""}`,"data-testid":"create-document-content-textarea",rows:a?8:6})]}),o.jsxs("div",{className:`${a?"mb-4":"mb-6"}`,children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags"}),o.jsx(aj,{tags:f,onChange:m,placeholder:"Type and press comma to add tags","data-testid":"create-document-tags-input"})]}),y.isError&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-md text-sm text-red-700 dark:text-red-300","data-testid":"create-document-error",children:y.error?.message||"Failed to create document"}),o.jsx("div",{className:`${a?"sticky bottom-0 pt-4 pb-safe bg-white dark:bg-[var(--color-bg)] border-t border-gray-200 dark:border-[var(--color-border)] -mx-4 px-4":""} flex items-center ${a?"flex-col gap-3":"justify-end gap-3"}`,children:a?o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"submit",disabled:y.isPending||!i.trim()||!_,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"create-document-submit-button",children:y.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Document"]})}),o.jsx("button",{type:"button",onClick:t,className:"w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors touch-target","data-testid":"create-document-cancel-button",children:"Cancel"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors","data-testid":"create-document-cancel-button",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:y.isPending||!i.trim()||!_,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"create-document-submit-button",children:y.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Document"]})})]})})]})]})})]}):null}function rgt(){return gt({queryKey:["libraries"],queryFn:async()=>{const e=await fetch("/api/libraries");if(!e.ok)throw new Error("Failed to fetch libraries");return e.json()}})}function ngt(){const e=ht();return Ct({mutationFn:async t=>{const r=await fetch("/api/libraries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to create library")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["libraries"]}),e.invalidateQueries({queryKey:["stats"]})}})}function are({isOpen:e,onClose:t,onSuccess:r,defaultParentId:n}){const[a,i]=w.useState(""),[s,l]=w.useState([]),[c,u]=w.useState(n||""),d=w.useRef(null),f=ngt(),{data:m}=rgt(),{currentUser:p}=nl();w.useEffect(()=>{e&&d.current&&d.current.focus()},[e]),w.useEffect(()=>{e||(i(""),l([]),u(n||""),f.reset())},[e,n]),w.useEffect(()=>{n&&u(n)},[n]);const v=async S=>{if(S.preventDefault(),!a.trim()||!p)return;const _={name:a.trim(),createdBy:p.id};s.length>0&&(_.tags=s),c&&(_.parentId=c);try{const N=await f.mutateAsync(_);r?.(N),t()}catch{}},b=S=>{S.key==="Escape"&&t()},y=o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors touch-target","data-testid":"create-library-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:v,disabled:f.isPending||!a.trim()||!p,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"create-library-submit-button",children:f.isPending?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(_r,{className:"w-4 h-4"}),"Create"]})})]});return o.jsx(Bx,{open:e,onClose:t,title:"Create Library",icon:o.jsx(z6,{className:"w-5 h-5 text-purple-500"}),size:"md","data-testid":"create-library-modal",footer:y,children:o.jsxs("form",{onSubmit:v,className:"p-4",onKeyDown:b,children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"library-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:d,id:"library-name",type:"text",value:a,onChange:S=>i(S.target.value),placeholder:"Enter library name...",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent touch-target","data-testid":"create-library-name-input",required:!0,maxLength:100}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"1-100 characters"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"library-parent",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Parent Library ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsxs("select",{id:"library-parent",value:c,onChange:S=>u(S.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent touch-target","data-testid":"create-library-parent-select",children:[o.jsx("option",{value:"",children:"No parent (root library)"}),m?.map(S=>o.jsx("option",{value:S.id,children:S.name},S.id))]}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Nest this library under another library"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tags ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsx(aj,{tags:s,onChange:l,placeholder:"Type and press comma to add tags","data-testid":"create-library-tags-input"})]}),f.isError&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-400","data-testid":"create-library-error",children:f.error?.message||"Failed to create library"})]})})}const agt=300,hbe=64,igt=36,ire={text:{label:"Plain Text",icon:o.jsx(eie,{className:"w-4 h-4"}),color:"bg-gray-100 text-gray-700"},markdown:{label:"Markdown",icon:o.jsx(qp,{className:"w-4 h-4"}),color:"bg-purple-100 text-purple-700"},json:{label:"JSON",icon:o.jsx(Kp,{className:"w-4 h-4"}),color:"bg-blue-100 text-blue-700"}};function sgt(e){const t=TB(e,agt);return gt({queryKey:["documents","search",t],queryFn:async()=>{if(!t.trim())return{results:[],query:""};const r=await fetch(`/api/documents/search?q=${encodeURIComponent(t)}&limit=10`);if(!r.ok)throw new Error("Failed to search documents");return r.json()},enabled:t.trim().length>0,staleTime:3e4})}function ogt(){return gt({queryKey:["libraries"],queryFn:async()=>{const e=await fetch("/api/libraries?limit=10000&hydrate.description=true");if(!e.ok)throw new Error("Failed to fetch libraries");const t=await e.json();return Array.isArray(t)?t:t.items||[]}})}function mbe(e){return gt({queryKey:["libraries",e],queryFn:async()=>{if(!e)throw new Error("No library selected");const t=await fetch(`/api/libraries/${e}?hydrate.description=true`);if(!t.ok)throw new Error("Failed to fetch library");return t.json()},enabled:!!e})}function lgt(e){return gt({queryKey:["libraries",e,"documents"],queryFn:async()=>{if(!e)throw new Error("No library selected");const t=await fetch(`/api/libraries/${e}/documents`);if(!t.ok)throw new Error("Failed to fetch documents");return t.json()},enabled:!!e})}function cgt(e){return gt({queryKey:["documents",e],queryFn:async()=>{if(!e)throw new Error("No document selected");const t=await fetch(`/api/documents/${e}`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch document")}return t.json()},enabled:!!e})}function ugt(){const e=ht();return Ct({mutationFn:async({id:t,updates:r})=>{const n=await fetch(`/api/documents/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to update document")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r.id]}),e.invalidateQueries({queryKey:["libraries"]})}})}function dgt(e){return gt({queryKey:["documents",e,"versions"],queryFn:async()=>{if(!e)throw new Error("No document selected");const t=await fetch(`/api/documents/${e}/versions`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch document versions")}return t.json()},enabled:!!e})}function fgt(e,t){return gt({queryKey:["documents",e,"versions",t],queryFn:async()=>{if(!e||!t)throw new Error("No document or version selected");const r=await fetch(`/api/documents/${e}/versions/${t}`);if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to fetch document version")}return r.json()},enabled:!!e&&!!t})}function hgt(){const e=ht();return Ct({mutationFn:async({id:t,version:r})=>{const n=await fetch(`/api/documents/${t}/restore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({version:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to restore document version")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r.id]}),e.invalidateQueries({queryKey:["documents",r.id,"versions"]}),e.invalidateQueries({queryKey:["libraries"]})}})}function mgt(){const e=ht();return Ct({mutationFn:async({id:t,createdBy:r,title:n,libraryId:a})=>{const i=await fetch(`/api/documents/${t}/clone`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({createdBy:r,title:n,libraryId:a})});if(!i.ok){const s=await i.json();throw new Error(s.error?.message||"Failed to clone document")}return i.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["libraries"]})}})}function pgt(e){return gt({queryKey:["documents",e,"links"],queryFn:async()=>{if(!e)throw new Error("No document selected");const t=await fetch(`/api/documents/${e}/links`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch document links")}return t.json()},enabled:!!e})}function ggt(){const e=ht();return Ct({mutationFn:async({blockedId:t,targetDocumentId:r})=>{const n=await fetch(`/api/documents/${t}/links`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetDocumentId:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to link document")}return n.json()},onSuccess:(t,{blockedId:r,targetDocumentId:n})=>{e.invalidateQueries({queryKey:["documents",r,"links"]}),e.invalidateQueries({queryKey:["documents",n,"links"]})}})}function vgt(){const e=ht();return Ct({mutationFn:async({blockedId:t,blockerId:r})=>{const n=await fetch(`/api/documents/${t}/links/${r}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to remove document link")}return n.json()},onSuccess:(t,{blockedId:r,blockerId:n})=>{e.invalidateQueries({queryKey:["documents",r,"links"]}),e.invalidateQueries({queryKey:["documents",n,"links"]})}})}function bgt(){return gt({queryKey:["documents","all"],queryFn:async()=>{const e=await fetch("/api/documents?limit=10000");if(!e.ok){const r=await e.json();throw new Error(r.error?.message||"Failed to fetch documents")}const t=await e.json();return t.items||t}})}function ygt(){const e=ht();return Ct({mutationFn:async({documentId:t,libraryId:r,actor:n})=>{const a=await fetch(`/api/documents/${t}/library`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({libraryId:r,actor:n})});if(!a.ok){const i=await a.json();throw new Error(i.error?.message||"Failed to move document")}return a.json()},onSuccess:(t,{documentId:r})=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r]}),e.invalidateQueries({queryKey:["libraries"]})}})}function xgt(){const e=ht();return Ct({mutationFn:async({documentId:t})=>{const r=await fetch(`/api/documents/${t}/library`,{method:"DELETE"});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to remove document from library")}return r.json()},onSuccess:(t,{documentId:r})=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r]}),e.invalidateQueries({queryKey:["libraries"]})}})}function wgt(){const e=ht();return Ct({mutationFn:async({libraryId:t,parentId:r,index:n,actor:a})=>{const i=await fetch(`/api/libraries/${t}/parent`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({parentId:r,index:n,actor:a})});if(!i.ok){const s=await i.json();throw new Error(s.error?.message||"Failed to move library")}return i.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["libraries"]})}})}function Sgt(){const e=ht();return Ct({mutationFn:async({libraryId:t,index:r})=>{const n=await fetch(`/api/libraries/${t}/order`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to reorder library")}return n.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["libraries"]})}})}function kgt(e){const t=new Map,r=[];for(const a of e)t.set(a.id,{...a,children:[]});for(const a of e){const i=t.get(a.id);a.parentId&&t.has(a.parentId)?t.get(a.parentId).children.push(i):r.push(i)}const n=a=>{a.some(s=>s.metadata?.sortIndex!==void 0)?a.sort((s,l)=>{const c=s.metadata?.sortIndex??1/0,u=l.metadata?.sortIndex??1/0;return c!==u?c-u:s.name.localeCompare(l.name)}):a.sort((s,l)=>s.name.localeCompare(l.name));for(const s of a)n(s.children)};return n(r),r}function l5(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function c5(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:l5(e)}function sre(e,t){if(!t||!e)return e;const r=e.toLowerCase(),n=t.toLowerCase(),a=r.indexOf(n);return a===-1?e:o.jsxs(o.Fragment,{children:[e.slice(0,a),o.jsx("mark",{className:"bg-yellow-200 text-gray-900 rounded-sm px-0.5",children:e.slice(a,a+t.length)}),e.slice(a+t.length)]})}function _gt({onSelectDocument:e}){const[t,r]=w.useState(""),[n,a]=w.useState(!1),i=w.useRef(null),s=w.useRef(null),{data:l,isLoading:c,isFetching:u}=sgt(t);w.useEffect(()=>{function y(S){s.current&&!s.current.contains(S.target)&&a(!1)}return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),w.useEffect(()=>{function y(S){S.key==="/"&&!(S.target instanceof HTMLInputElement||S.target instanceof HTMLTextAreaElement)&&(S.preventDefault(),i.current?.focus()),S.key==="Escape"&&document.activeElement===i.current&&(S.preventDefault(),t?r(""):(a(!1),i.current?.blur()))}return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[t]);const d=y=>{r(y.target.value),a(!0)},f=()=>{r(""),a(!1),i.current?.focus()},m=y=>{e(y),r(""),a(!1)},p=n&&t.trim().length>0,v=l?.results||[],b=(c||u)&&t.trim().length>0;return o.jsxs("div",{ref:s,className:"relative","data-testid":"document-search-container",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:i,type:"text",value:t,onChange:d,onFocus:()=>t.trim()&&a(!0),placeholder:"Search docs... (/)",className:"w-full pl-9 pr-8 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","data-testid":"document-search-input","aria-label":"Search documents"}),t&&o.jsx("button",{onClick:f,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 rounded","data-testid":"document-search-clear","aria-label":"Clear search",children:o.jsx(wt,{className:"w-3 h-3"})})]}),p&&o.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-y-auto","data-testid":"document-search-results",children:[b&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-500",children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Searching..."]}),!b&&v.length===0&&o.jsxs("div",{className:"px-3 py-4 text-sm text-gray-500 text-center","data-testid":"document-search-no-results",children:['No documents found for "',t,'"']}),!b&&v.length>0&&o.jsx("div",{"data-testid":"document-search-results-list",children:v.map(y=>o.jsxs("button",{onClick:()=>m(y.id),className:"w-full text-left px-3 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 focus:bg-gray-50 focus:outline-none","data-testid":`document-search-result-${y.id}`,children:[o.jsxs("div",{className:"font-medium text-gray-900 text-sm truncate",children:[o.jsx(rn,{className:"inline w-4 h-4 text-blue-400 mr-1.5"}),sre(y.title,t)]}),y.snippet&&o.jsx("div",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2","data-testid":`document-search-snippet-${y.id}`,children:sre(y.snippet,t)}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[o.jsx("span",{className:`px-1.5 py-0.5 rounded ${y.matchType==="content"?"bg-yellow-100 text-yellow-700":y.matchType==="both"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:y.matchType==="title"?"Title match":y.matchType==="content"?"Content match":"Title & content"}),o.jsx("span",{children:y.contentType})]})]},y.id))})]})]})}function pbe({document:e,isSelected:t,onClick:r,libraryId:n=null,draggable:a=!0}){const i=new Date(e.updatedAt).toLocaleDateString(),s=e.title||`Document ${e.id}`,l=e.metadata?.icon,c={type:"document",id:e.id,sourceLibraryId:n,name:s},{attributes:u,listeners:d,setNodeRef:f,transform:m,isDragging:p}=vpe({id:`document-drag-${e.id}`,data:c,disabled:!a}),v=m?{transform:Bl.Translate.toString(m),zIndex:p?999:void 0}:void 0;return o.jsxs("div",{ref:f,style:v,"data-testid":`document-item-${e.id}`,onClick:()=>r?.(e.id),className:`group flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${p?"opacity-50 border-blue-300 bg-blue-50 shadow-lg":t?"border-blue-300 bg-blue-50":"border-gray-100 hover:border-gray-200 hover:bg-gray-50"}`,children:[a&&o.jsx("div",{...u,...d,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 -ml-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity","data-testid":`document-drag-handle-${e.id}`,onClick:b=>b.stopPropagation(),children:o.jsx(Jae,{className:"w-4 h-4 text-gray-400"})}),l?o.jsx("span",{className:"w-8 h-8 flex items-center justify-center text-2xl flex-shrink-0","data-testid":`document-icon-${e.id}`,children:l}):o.jsx(rn,{className:`w-8 h-8 flex-shrink-0 ${t?"text-blue-500":"text-blue-400"}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{"data-testid":`document-title-${e.id}`,className:`font-medium truncate ${t?"text-blue-900":"text-gray-900"}`,children:s}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[o.jsx("span",{"data-testid":`document-type-${e.id}`,children:e.contentType}),o.jsx("span",{children:""}),o.jsx("span",{"data-testid":`document-date-${e.id}`,children:i})]})]})]})}function ore({data:e}){return o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-blue-300 max-w-xs",children:[o.jsx(rn,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}),o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name})]})}function Ngt(e){if(!e)return!1;const t=e.trim();return t.startsWith("<")&&(t.startsWith("<p>")||t.startsWith("<div>")||t.startsWith("<h1>")||t.startsWith("<h2>")||t.startsWith("<h3>")||t.startsWith("<ul>")||t.startsWith("<ol>")||t.startsWith("<blockquote>"))}function Cgt({content:e,contentType:t}){if(!e)return o.jsx("div",{"data-testid":"document-content-empty",className:"text-gray-400 italic",children:"No content"});switch(t){case"json":try{const r=JSON.stringify(JSON.parse(e),null,2);return o.jsx("pre",{"data-testid":"document-content-json",className:"whitespace-pre-wrap font-mono text-sm bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:o.jsx("code",{children:r})})}catch{return o.jsx("pre",{"data-testid":"document-content-json",className:"whitespace-pre-wrap font-mono text-sm bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:o.jsx("code",{children:e})})}case"markdown":case"text":default:{if(Ngt(e))return o.jsx("div",{"data-testid":"document-content-html",className:`prose prose-sm max-w-none text-gray-700
                       prose-headings:mt-4 prose-headings:mb-2 prose-headings:font-semibold
                       prose-h1:text-2xl prose-h2:text-xl prose-h3:text-lg
                       prose-p:my-2 prose-ul:my-2 prose-ol:my-2 prose-li:my-0.5
                       prose-blockquote:border-l-4 prose-blockquote:border-gray-300 prose-blockquote:pl-4 prose-blockquote:italic
                       prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:rounded-lg prose-pre:p-4
                       prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm
                       [&_mark]:bg-yellow-200 [&_mark]:px-0.5`,dangerouslySetInnerHTML:{__html:e}});const r=Hme(e);return o.jsx("div",{"data-testid":"document-content-markdown",className:`prose prose-sm max-w-none text-gray-700
                     prose-headings:mt-4 prose-headings:mb-2 prose-headings:font-semibold
                     prose-h1:text-2xl prose-h2:text-xl prose-h3:text-lg
                     prose-p:my-2 prose-ul:my-2 prose-ol:my-2 prose-li:my-0.5
                     prose-blockquote:border-l-4 prose-blockquote:border-gray-300 prose-blockquote:pl-4 prose-blockquote:italic
                     prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:rounded-lg prose-pre:p-4
                     prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm
                     [&_mark]:bg-yellow-200 [&_mark]:px-0.5`,dangerouslySetInnerHTML:{__html:r}})}}}function jgt({documentId:e,currentVersion:t,onPreviewVersion:r,previewingVersion:n,onClose:a}){const{data:i=[],isLoading:s,error:l}=dgt(e),c=hgt(),u=async d=>{if(confirm(`Restore to version ${d}? This will create a new version with the restored content.`))try{await c.mutateAsync({id:e,version:d}),r(null)}catch{}};return o.jsxs("div",{"data-testid":"version-history-sidebar",className:"w-72 border-l border-gray-200 bg-gray-50 flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-white",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Xf,{className:"w-4 h-4 text-gray-500"}),o.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:"Version History"})]}),o.jsx("button",{onClick:a,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","aria-label":"Close version history","data-testid":"version-history-close",children:o.jsx(wt,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[s&&o.jsx("div",{"data-testid":"version-history-loading",className:"text-center text-gray-500 text-sm py-4",children:"Loading versions..."}),l&&o.jsx("div",{"data-testid":"version-history-error",className:"text-center text-red-500 text-sm py-4",children:"Failed to load versions"}),!s&&!l&&i.length===0&&o.jsx("div",{"data-testid":"version-history-empty",className:"text-center text-gray-500 text-sm py-4",children:"No version history available"}),!s&&!l&&i.length>0&&o.jsx("div",{"data-testid":"version-history-list",className:"space-y-1",children:i.map(d=>{const f=d.version===t,m=n===d.version;return o.jsxs("div",{"data-testid":`version-item-${d.version}`,className:`p-2 rounded-md ${m?"bg-blue-100 border border-blue-300":f?"bg-green-50 border border-green-200":"bg-white border border-gray-100 hover:border-gray-200"}`,children:[o.jsx("div",{className:"flex items-center justify-between mb-1",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"font-medium text-sm text-gray-900",children:["v",d.version]}),f&&o.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded",children:"Current"}),m&&o.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded",children:"Previewing"})]})}),o.jsx("div",{className:"text-xs text-gray-500 mb-2",children:c5(d.updatedAt)}),o.jsx("div",{className:"flex items-center gap-1",children:!f&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>r(m?null:d.version),"data-testid":`version-preview-${d.version}`,className:`flex items-center gap-1 px-2 py-1 text-xs rounded ${m?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[o.jsx(du,{className:"w-3 h-3"}),m?"Exit Preview":"Preview"]}),o.jsxs("button",{onClick:()=>u(d.version),disabled:c.isPending,"data-testid":`version-restore-${d.version}`,className:"flex items-center gap-1 px-2 py-1 text-xs rounded bg-orange-100 text-orange-700 hover:bg-orange-200 disabled:opacity-50",children:[o.jsx(Rs,{className:"w-3 h-3"}),"Restore"]})]})})]},d.version)})})]}),c.isError&&o.jsx("div",{className:"p-2 m-2 bg-red-50 text-red-700 text-xs rounded",children:c.error?.message||"Failed to restore version"})]})}function Egt({isOpen:e,onClose:t,onSelectDocument:r,currentDocumentId:n,existingLinkIds:a}){const[i,s]=w.useState(""),{data:l=[],isLoading:c}=bgt(),u=l.filter(d=>{if(d.id===n||a.includes(d.id))return!1;if(i.trim()){const f=i.toLowerCase();return d.title?.toLowerCase().includes(f)||d.id.toLowerCase().includes(f)}return!0});return le.useEffect(()=>{if(!e)return;const d=f=>{f.key==="Escape"&&t()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[e,t]),e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"document-link-picker-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[o.jsx(Ox,{className:"w-5 h-5 text-blue-500"}),"Link Document"]}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","aria-label":"Close","data-testid":"document-link-picker-close",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-4 border-b border-gray-100",children:o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:i,onChange:d=>s(d.target.value),placeholder:"Search documents by title or ID...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0,"data-testid":"document-link-search"})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading documents..."}):u.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:i.trim()?"No matching documents found":"No documents available to link"}):o.jsx("div",{className:"space-y-2","data-testid":"document-link-list",children:u.map(d=>o.jsxs("button",{onClick:()=>r(d.id),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 text-left transition-colors","data-testid":`document-link-option-${d.id}`,children:[o.jsx(rn,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 truncate",children:d.title||`Document ${d.id}`}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:d.id}),o.jsx("span",{children:""}),o.jsx("span",{children:d.contentType})]})]}),o.jsx(qh,{className:"w-4 h-4 text-gray-400"})]},d.id))})})]})]}):null}function lre({document:e,direction:t,onRemove:r,onNavigate:n,isRemoving:a}){return o.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors group","data-testid":`linked-document-${e.id}`,children:[o.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center ${t==="outgoing"?"bg-blue-100":"bg-green-100"}`,title:t==="outgoing"?"Links to":"Linked from",children:t==="outgoing"?o.jsx(qh,{className:"w-3 h-3 text-blue-600"}):o.jsx(zx,{className:"w-3 h-3 text-green-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("button",{onClick:n,className:"font-medium text-gray-900 hover:text-blue-600 truncate block text-left w-full","data-testid":`linked-document-title-${e.id}`,children:e.title||`Document ${e.id}`}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:e.id}),o.jsx("span",{children:""}),o.jsx("span",{children:e.contentType})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:n,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Open document","data-testid":`linked-document-open-${e.id}`,children:o.jsx(Sl,{className:"w-4 h-4"})}),t==="outgoing"&&o.jsx("button",{onClick:r,disabled:a,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Remove link","data-testid":`linked-document-remove-${e.id}`,children:o.jsx(Kae,{className:"w-4 h-4"})})]})]})}function Mgt({documentId:e,onNavigateToDocument:t}){const[r,n]=w.useState(!0),[a,i]=w.useState(!1),{data:s,isLoading:l,isError:c}=pgt(e),u=ggt(),d=vgt(),f=s?.outgoing||[],m=s?.incoming||[],p=f.length+m.length,v=S=>{u.mutate({blockedId:e,targetDocumentId:S}),i(!1)},b=S=>{d.mutate({blockedId:e,blockerId:S})},y=f.map(S=>S.id);return o.jsxs("div",{className:"mb-6","data-testid":"linked-documents-section",children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-medium text-gray-500 uppercase tracking-wide mb-2 hover:text-gray-700 w-full","data-testid":"linked-documents-toggle",children:[r?o.jsx(cr,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),o.jsx(Ox,{className:"w-3 h-3"}),o.jsx("span",{children:"Linked Documents"}),p>0&&o.jsxs("span",{className:"text-gray-400 font-normal",children:["(",p,")"]})]}),r&&o.jsxs("div",{className:"space-y-4",children:[l&&o.jsx("div",{className:"text-sm text-gray-500",children:"Loading links..."}),c&&o.jsx("div",{className:"text-sm text-red-500",children:"Failed to load links"}),!l&&!c&&o.jsxs(o.Fragment,{children:[f.length>0&&o.jsxs("div",{"data-testid":"outgoing-links-section",children:[o.jsxs("div",{className:"text-xs text-gray-500 mb-2 flex items-center gap-1",children:[o.jsx(qh,{className:"w-3 h-3"}),"Links to (",f.length,")"]}),o.jsx("div",{className:"space-y-2",children:f.map(S=>o.jsx(lre,{document:S,direction:"outgoing",onRemove:()=>b(S.id),onNavigate:()=>t(S.id),isRemoving:d.isPending},S.id))})]}),m.length>0&&o.jsxs("div",{"data-testid":"incoming-links-section",children:[o.jsxs("div",{className:"text-xs text-gray-500 mb-2 flex items-center gap-1",children:[o.jsx(zx,{className:"w-3 h-3"}),"Linked from (",m.length,")"]}),o.jsx("div",{className:"space-y-2",children:m.map(S=>o.jsx(lre,{document:S,direction:"incoming",onRemove:()=>{},onNavigate:()=>t(S.id),isRemoving:!1},S.id))})]}),p===0&&o.jsx("div",{className:"text-sm text-gray-400 italic","data-testid":"no-links-message",children:"No linked documents"}),o.jsxs("button",{onClick:()=>i(!0),disabled:u.isPending,className:"inline-flex items-center gap-1.5 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50","data-testid":"add-document-link-button",children:[o.jsx(_r,{className:"w-4 h-4"}),"Link Document"]}),u.isError&&o.jsx("div",{className:"text-sm text-red-500 mt-2",children:u.error?.message||"Failed to add link"}),d.isError&&o.jsx("div",{className:"text-sm text-red-500 mt-2",children:d.error?.message||"Failed to remove link"})]})]}),o.jsx(Egt,{isOpen:a,onClose:()=>i(!1),onSelectDocument:v,currentDocumentId:e,existingLinkIds:y})]})}const gbe=w.createContext(null);function Hs(){const e=w.useContext(gbe);if(e===null)throw new Error("No Tree Api Provided");return e}const vbe=w.createContext(null);function Tgt(){const e=w.useContext(vbe);if(e===null)throw new Error("Provide a NodesContext");return e}const bbe=w.createContext(null);function Agt(){const e=w.useContext(bbe);if(e===null)throw new Error("Provide a DnDContext");return e}const ybe=w.createContext(0);function xbe(){w.useContext(ybe)}function Wk(e,t,r){return Math.max(Math.min(e,r),t)}function wbe(e){return e&&e.isLeaf}function Sbe(e){return e&&e.isInternal&&!e.isOpen}function kbe(e){var t;return e&&e.isOpen&&!(!((t=e.children)===null||t===void 0)&&t.length)}const _be=(e,t)=>{let r=e;for(;r;){if(r.id===t.id)return!0;r=r.parent}return!1},Nbe=e=>{if(!e.parent)throw Error("Node does not have a parent");return e.parent.children.findIndex(t=>t.id===e.id)};function D$(e,t){if(!e)return null;if(e.id===t)return e;if(e.children)for(let r of e.children){const n=D$(r,t);if(n)return n}return null}function MC(e,t){if(t(e),e.children)for(let r of e.children)MC(r,t)}function Cbe(e){const t=Ebe(e);let r;for(let n=0;n<t.length;++n)if(t[n]===e){r=Dgt(t,n);break}r?.focus()}function jbe(e){const t=Ebe(e);let r;for(let n=0;n<t.length;++n)if(t[n]===e){r=Lgt(t,n);break}r?.focus()}function Dgt(e,t){return t+1<e.length?e[t+1]:e[0]}function Lgt(e,t){return t-1>=0?e[t-1]:e[e.length-1]}function Ebe(e){return Array.from(document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled]), details:not([disabled]), summary:not(:disabled)')).filter(t=>t===e||!e.contains(t))}function Cb(e,t){return typeof t=="boolean"?t:typeof t=="string"?e[t]:t(e)}function Mbe(e){return e===null?null:Hf(e)}function Hf(e){return typeof e=="string"?e:e.id}function Tbe(e,...t){if(e)return e(...t)}function Abe(e){return new Promise((t,r)=>{let n=0;function a(){n+=1,n===100&&r(),e()?t():setTimeout(a,10)}a()})}function Dbe(e){var t,r;const n=e.focusedNode;return n?n.isOpen?0:n.parent?n.childIndex+1:0:(r=(t=e.root.children)===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0}function Lbe(e){const t=e.focusedNode;return t?t.isOpen?t.id:t.parent&&!t.parent.isRoot?t.parent.id:null:null}const Ogt=Object.freeze(Object.defineProperty({__proto__:null,access:Cb,bound:Wk,dfs:D$,focusNextElement:Cbe,focusPrevElement:jbe,getInsertIndex:Dbe,getInsertParentId:Lbe,identify:Hf,identifyNull:Mbe,indexOf:Nbe,isClosed:Sbe,isDescendant:_be,isItem:wbe,isOpenWithEmptyChildren:kbe,safeRun:Tbe,waitFor:Abe,walk:MC},Symbol.toStringTag,{value:"Module"})),Igt={display:"flex",alignItems:"center",zIndex:1},Rgt={flex:1,height:"2px",background:"#4B91E2",borderRadius:"1px"},Pgt={width:"4px",height:"4px",boxShadow:"0 0 0 3px #4B91E2",borderRadius:"50%"},zgt=le.memo(function({top:t,left:r,indent:n}){const a={position:"absolute",pointerEvents:"none",top:t-2+"px",left:r+"px",right:n+"px"};return o.jsxs("div",{style:Object.assign(Object.assign({},Igt),a),children:[o.jsx("div",{style:Object.assign({},Pgt)}),o.jsx("div",{style:Object.assign({},Rgt)})]})});function Bgt({node:e,attrs:t,innerRef:r,children:n}){return o.jsx("div",Object.assign({},t,{ref:r,onFocus:a=>a.stopPropagation(),onClick:e.handleClick,children:n}))}function $gt(e){return o.jsxs("div",{ref:e.dragHandle,style:e.style,children:[o.jsx("span",{onClick:t=>{t.stopPropagation(),e.node.toggle()},children:e.node.isLeaf?"":e.node.isOpen?"":""})," ",e.node.isEditing?o.jsx(Ugt,Object.assign({},e)):o.jsx(Fgt,Object.assign({},e))]})}function Fgt(e){return o.jsx(o.Fragment,{children:o.jsx("span",{children:e.node.data.name})})}function Ugt({node:e}){const t=w.useRef();return w.useEffect(()=>{var r,n;(r=t.current)===null||r===void 0||r.focus(),(n=t.current)===null||n===void 0||n.select()},[]),o.jsx("input",{ref:t,defaultValue:e.data.name,onBlur:()=>e.reset(),onKeyDown:r=>{var n;r.key==="Escape"&&e.reset(),r.key==="Enter"&&e.submit(((n=t.current)===null||n===void 0?void 0:n.value)||"")}})}function YL(e){return{type:"EDIT",id:e}}function Hgt(e={id:null},t){return t.type==="EDIT"?Object.assign(Object.assign({},e),{id:t.id}):e}function up(e){return{type:"FOCUS",id:e}}function qgt(){return{type:"TREE_BLUR"}}function Wgt(e={id:null,treeFocused:!1},t){return t.type==="FOCUS"?Object.assign(Object.assign({},e),{id:t.id,treeFocused:!0}):t.type==="TREE_BLUR"?Object.assign(Object.assign({},e),{treeFocused:!1}):e}class TC{constructor(t){this.handleClick=r=>{r.metaKey&&!this.tree.props.disableMultiSelection?this.isSelected?this.deselect():this.selectMulti():r.shiftKey&&!this.tree.props.disableMultiSelection?this.selectContiguous():(this.select(),this.activate())},this.tree=t.tree,this.id=t.id,this.data=t.data,this.level=t.level,this.children=t.children,this.parent=t.parent,this.isDraggable=t.isDraggable,this.rowIndex=t.rowIndex}get isRoot(){return this.id===Cx}get isLeaf(){return!Array.isArray(this.children)}get isInternal(){return!this.isLeaf}get isOpen(){return this.isLeaf?!1:this.tree.isOpen(this.id)}get isClosed(){return this.isLeaf?!1:!this.tree.isOpen(this.id)}get isEditable(){return this.tree.isEditable(this.data)}get isEditing(){return this.tree.editingId===this.id}get isSelected(){return this.tree.isSelected(this.id)}get isOnlySelection(){return this.isSelected&&this.tree.hasOneSelection}get isSelectedStart(){var t;return this.isSelected&&!(!((t=this.prev)===null||t===void 0)&&t.isSelected)}get isSelectedEnd(){var t;return this.isSelected&&!(!((t=this.next)===null||t===void 0)&&t.isSelected)}get isFocused(){return this.tree.isFocused(this.id)}get isDragging(){return this.tree.isDragging(this.id)}get willReceiveDrop(){return this.tree.willReceiveDrop(this.id)}get state(){return{isClosed:this.isClosed,isDragging:this.isDragging,isEditing:this.isEditing,isFocused:this.isFocused,isInternal:this.isInternal,isLeaf:this.isLeaf,isOpen:this.isOpen,isSelected:this.isSelected,isSelectedEnd:this.isSelectedEnd,isSelectedStart:this.isSelectedStart,willReceiveDrop:this.willReceiveDrop}}get childIndex(){return this.parent&&this.parent.children?this.parent.children.findIndex(t=>t.id===this.id):-1}get next(){return this.rowIndex===null?null:this.tree.at(this.rowIndex+1)}get prev(){return this.rowIndex===null?null:this.tree.at(this.rowIndex-1)}get nextSibling(){var t,r;const n=this.childIndex;return(r=(t=this.parent)===null||t===void 0?void 0:t.children[n+1])!==null&&r!==void 0?r:null}isAncestorOf(t){if(!t)return!1;let r=t;for(;r;){if(r.id===this.id)return!0;r=r.parent}return!1}select(){this.tree.select(this)}deselect(){this.tree.deselect(this)}selectMulti(){this.tree.selectMulti(this)}selectContiguous(){this.tree.selectContiguous(this)}activate(){this.tree.activate(this)}focus(){this.tree.focus(this)}toggle(){this.tree.toggle(this)}open(){this.tree.open(this)}openParents(){this.tree.openParents(this)}close(){this.tree.close(this)}submit(t){this.tree.submit(this,t)}reset(){this.tree.reset()}clone(){return new TC(Object.assign({},this))}edit(){return this.tree.edit(this)}}const Cx="__REACT_ARBORIST_INTERNAL_ROOT__";function cre(e){var t;function r(i,s,l){const c=e.accessId(i),u=new TC({tree:e,data:i,level:s,parent:l,id:c,children:null,isDraggable:e.isDraggable(i),rowIndex:null}),d=e.accessChildren(i);return d&&(u.children=d.map(f=>r(f,s+1,u))),u}const n=new TC({tree:e,id:Cx,data:{id:Cx},level:-1,parent:null,children:null,isDraggable:!0,rowIndex:null}),a=(t=e.props.data)!==null&&t!==void 0?t:[];return n.children=a.map(i=>r(i,0,n)),n}const u5={open(e,t){return{type:"VISIBILITY_OPEN",id:e,filtered:t}},close(e,t){return{type:"VISIBILITY_CLOSE",id:e,filtered:t}},toggle(e,t){return{type:"VISIBILITY_TOGGLE",id:e,filtered:t}},clear(e){return{type:"VISIBILITY_CLEAR",filtered:e}}};function ure(e={},t){if(t.type==="VISIBILITY_OPEN")return Object.assign(Object.assign({},e),{[t.id]:!0});if(t.type==="VISIBILITY_CLOSE")return Object.assign(Object.assign({},e),{[t.id]:!1});if(t.type==="VISIBILITY_TOGGLE"){const r=e[t.id];return Object.assign(Object.assign({},e),{[t.id]:!r})}else return t.type==="VISIBILITY_CLEAR"?{}:e}function Kgt(e={filtered:{},unfiltered:{}},t){return t.type.startsWith("VISIBILITY")?t.filtered?Object.assign(Object.assign({},e),{filtered:ure(e.filtered,t)}):Object.assign(Object.assign({},e),{unfiltered:ure(e.unfiltered,t)}):e}const Kg=e=>{var t;return{nodes:{open:{filtered:{},unfiltered:(t=e?.initialOpenState)!==null&&t!==void 0?t:{}},focus:{id:null,treeFocused:!1},edit:{id:null},drag:{id:null,selectedIds:[],destinationParentId:null,destinationIndex:null},selection:{ids:new Set,anchor:null,mostRecent:null}},dnd:{cursor:{type:"none"},dragId:null,dragIds:[],parentId:null,index:-1}}},Oo={clear:()=>({type:"SELECTION_CLEAR"}),only:e=>({type:"SELECTION_ONLY",id:Hf(e)}),add:e=>({type:"SELECTION_ADD",ids:(Array.isArray(e)?e:[e]).map(Hf)}),remove:e=>({type:"SELECTION_REMOVE",ids:(Array.isArray(e)?e:[e]).map(Hf)}),set:e=>Object.assign({type:"SELECTION_SET"},e),mostRecent:e=>({type:"SELECTION_MOST_RECENT",id:e===null?null:Hf(e)}),anchor:e=>({type:"SELECTION_ANCHOR",id:e===null?null:Hf(e)})};function Ggt(e=Kg().nodes.selection,t){const r=e.ids;switch(t.type){case"SELECTION_CLEAR":return Object.assign(Object.assign({},e),{ids:new Set});case"SELECTION_ONLY":return Object.assign(Object.assign({},e),{ids:new Set([t.id])});case"SELECTION_ADD":return t.ids.length===0?e:(t.ids.forEach(n=>r.add(n)),Object.assign(Object.assign({},e),{ids:new Set(r)}));case"SELECTION_REMOVE":return t.ids.length===0?e:(t.ids.forEach(n=>r.delete(n)),Object.assign(Object.assign({},e),{ids:new Set(r)}));case"SELECTION_SET":return Object.assign(Object.assign({},e),{ids:t.ids,mostRecent:t.mostRecent,anchor:t.anchor});case"SELECTION_MOST_RECENT":return Object.assign(Object.assign({},e),{mostRecent:t.id});case"SELECTION_ANCHOR":return Object.assign(Object.assign({},e),{anchor:t.id});default:return e}}const Gg={cursor(e){return{type:"DND_CURSOR",cursor:e}},dragStart(e,t){return{type:"DND_DRAG_START",id:e,dragIds:t}},dragEnd(){return{type:"DND_DRAG_END"}},hovering(e,t){return{type:"DND_HOVERING",parentId:e,index:t}}};function Vgt(e=Kg().dnd,t){switch(t.type){case"DND_CURSOR":return Object.assign(Object.assign({},e),{cursor:t.cursor});case"DND_DRAG_START":return Object.assign(Object.assign({},e),{dragId:t.id,dragIds:t.dragIds});case"DND_DRAG_END":return Kg().dnd;case"DND_HOVERING":return Object.assign(Object.assign({},e),{parentId:t.parentId,index:t.index});default:return e}}const Ygt={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},Qgt=e=>{if(!e)return{display:"none"};const{x:t,y:r}=e;return{transform:`translate(${t}px, ${r}px)`}},Jgt=e=>{if(!e)return{display:"none"};const{x:t,y:r}=e;return{transform:`translate(${t+10}px, ${r+10}px)`}};function Obe({offset:e,mouse:t,id:r,dragIds:n,isDragging:a}){return o.jsxs(Zgt,{isDragging:a,children:[o.jsx(Xgt,{offset:e,children:o.jsx(t0t,{id:r,dragIds:n})}),o.jsx(e0t,{mouse:t,count:n.length})]})}const Zgt=w.memo(function(t){return t.isDragging?o.jsx("div",{style:Ygt,children:t.children}):null});function Xgt(e){return o.jsx("div",{className:"row preview",style:Qgt(e.offset),children:e.children})}function e0t(e){const{count:t,mouse:r}=e;return t>1?o.jsx("div",{className:"selected-count",style:Jgt(r),children:t}):null}const t0t=w.memo(function(t){const r=Hs(),n=r.get(t.id);return n?o.jsx(r.renderNode,{preview:!0,node:n,style:{paddingLeft:n.level*r.indent,opacity:.2,background:"transparent"},tree:r}):null});var dre=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function r0t(e,t){return!!(e===t||dre(e)&&dre(t))}function n0t(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!r0t(e[r],t[r]))return!1;return!0}function QL(e,t){t===void 0&&(t=n0t);var r,n=[],a,i=!1;function s(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return i&&r===this&&t(l,n)||(a=e.apply(this,l),i=!0,r=this,n=l),a}return s}var a0t=typeof performance=="object"&&typeof performance.now=="function",fre=a0t?function(){return performance.now()}:function(){return Date.now()};function hre(e){cancelAnimationFrame(e.id)}function i0t(e,t){var r=fre();function n(){fre()-r>=t?e.call(null):a.id=requestAnimationFrame(n)}var a={id:requestAnimationFrame(n)};return a}var JL=-1;function mre(e){if(e===void 0&&(e=!1),JL===-1||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),JL=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return JL}var dp=null;function pre(e){if(e===void 0&&(e=!1),dp===null||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),a=n.style;return a.width="100px",a.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?dp="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?dp="negative":dp="positive-ascending"),document.body.removeChild(t),dp}return dp}var s0t=150,o0t=function(t,r){return t};function l0t(e){var t,r=e.getItemOffset,n=e.getEstimatedTotalSize,a=e.getItemSize,i=e.getOffsetForIndexAndAlignment,s=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,c=e.initInstanceProps,u=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return t=(function(f){cLe(m,f);function m(v){var b;return b=f.call(this,v)||this,b._instanceProps=c(b.props,vV(b)),b._outerRef=void 0,b._resetIsScrollingTimeoutId=null,b.state={instance:vV(b),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof b.props.initialScrollOffset=="number"?b.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},b._callOnItemsRendered=void 0,b._callOnItemsRendered=QL(function(y,S,_,N){return b.props.onItemsRendered({overscanStartIndex:y,overscanStopIndex:S,visibleStartIndex:_,visibleStopIndex:N})}),b._callOnScroll=void 0,b._callOnScroll=QL(function(y,S,_){return b.props.onScroll({scrollDirection:y,scrollOffset:S,scrollUpdateWasRequested:_})}),b._getItemStyle=void 0,b._getItemStyle=function(y){var S=b.props,_=S.direction,N=S.itemSize,k=S.layout,j=b._getItemStyleCache(u&&N,u&&k,u&&_),E;if(j.hasOwnProperty(y))E=j[y];else{var T=r(b.props,y,b._instanceProps),O=a(b.props,y,b._instanceProps),R=_==="horizontal"||k==="horizontal",q=_==="rtl",$=R?T:0;j[y]=E={position:"absolute",left:q?void 0:$,right:q?$:void 0,top:R?0:T,height:R?"100%":O,width:R?O:"100%"}}return E},b._getItemStyleCache=void 0,b._getItemStyleCache=QL(function(y,S,_){return{}}),b._onScrollHorizontal=function(y){var S=y.currentTarget,_=S.clientWidth,N=S.scrollLeft,k=S.scrollWidth;b.setState(function(j){if(j.scrollOffset===N)return null;var E=b.props.direction,T=N;if(E==="rtl")switch(pre()){case"negative":T=-N;break;case"positive-descending":T=k-_-N;break}return T=Math.max(0,Math.min(T,k-_)),{isScrolling:!0,scrollDirection:j.scrollOffset<T?"forward":"backward",scrollOffset:T,scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._onScrollVertical=function(y){var S=y.currentTarget,_=S.clientHeight,N=S.scrollHeight,k=S.scrollTop;b.setState(function(j){if(j.scrollOffset===k)return null;var E=Math.max(0,Math.min(k,N-_));return{isScrolling:!0,scrollDirection:j.scrollOffset<E?"forward":"backward",scrollOffset:E,scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._outerRefSetter=function(y){var S=b.props.outerRef;b._outerRef=y,typeof S=="function"?S(y):S!=null&&typeof S=="object"&&S.hasOwnProperty("current")&&(S.current=y)},b._resetIsScrollingDebounced=function(){b._resetIsScrollingTimeoutId!==null&&hre(b._resetIsScrollingTimeoutId),b._resetIsScrollingTimeoutId=i0t(b._resetIsScrolling,s0t)},b._resetIsScrolling=function(){b._resetIsScrollingTimeoutId=null,b.setState({isScrolling:!1},function(){b._getItemStyleCache(-1,null)})},b}m.getDerivedStateFromProps=function(b,y){return c0t(b,y),d(b),null};var p=m.prototype;return p.scrollTo=function(b){b=Math.max(0,b),this.setState(function(y){return y.scrollOffset===b?null:{scrollDirection:y.scrollOffset<b?"forward":"backward",scrollOffset:b,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},p.scrollToItem=function(b,y){y===void 0&&(y="auto");var S=this.props,_=S.itemCount,N=S.layout,k=this.state.scrollOffset;b=Math.max(0,Math.min(b,_-1));var j=0;if(this._outerRef){var E=this._outerRef;N==="vertical"?j=E.scrollWidth>E.clientWidth?mre():0:j=E.scrollHeight>E.clientHeight?mre():0}this.scrollTo(i(this.props,b,y,k,this._instanceProps,j))},p.componentDidMount=function(){var b=this.props,y=b.direction,S=b.initialScrollOffset,_=b.layout;if(typeof S=="number"&&this._outerRef!=null){var N=this._outerRef;y==="horizontal"||_==="horizontal"?N.scrollLeft=S:N.scrollTop=S}this._callPropsCallbacks()},p.componentDidUpdate=function(){var b=this.props,y=b.direction,S=b.layout,_=this.state,N=_.scrollOffset,k=_.scrollUpdateWasRequested;if(k&&this._outerRef!=null){var j=this._outerRef;if(y==="horizontal"||S==="horizontal")if(y==="rtl")switch(pre()){case"negative":j.scrollLeft=-N;break;case"positive-ascending":j.scrollLeft=N;break;default:var E=j.clientWidth,T=j.scrollWidth;j.scrollLeft=T-E-N;break}else j.scrollLeft=N;else j.scrollTop=N}this._callPropsCallbacks()},p.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&hre(this._resetIsScrollingTimeoutId)},p.render=function(){var b=this.props,y=b.children,S=b.className,_=b.direction,N=b.height,k=b.innerRef,j=b.innerElementType,E=b.innerTagName,T=b.itemCount,O=b.itemData,R=b.itemKey,q=R===void 0?o0t:R,$=b.layout,L=b.outerElementType,A=b.outerTagName,M=b.style,z=b.useIsScrolling,I=b.width,B=this.state.isScrolling,F=_==="horizontal"||$==="horizontal",U=F?this._onScrollHorizontal:this._onScrollVertical,V=this._getRangeToRender(),K=V[0],G=V[1],J=[];if(T>0)for(var ee=K;ee<=G;ee++)J.push(w.createElement(y,{data:O,key:q(ee,O),index:ee,isScrolling:z?B:void 0,style:this._getItemStyle(ee)}));var Y=n(this.props,this._instanceProps);return w.createElement(L||A||"div",{className:S,onScroll:U,ref:this._outerRefSetter,style:TI({position:"relative",height:N,width:I,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:_},M)},w.createElement(j||E||"div",{children:J,ref:k,style:{height:F?"100%":Y,pointerEvents:B?"none":void 0,width:F?Y:"100%"}}))},p._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var b=this.props.itemCount;if(b>0){var y=this._getRangeToRender(),S=y[0],_=y[1],N=y[2],k=y[3];this._callOnItemsRendered(S,_,N,k)}}if(typeof this.props.onScroll=="function"){var j=this.state,E=j.scrollDirection,T=j.scrollOffset,O=j.scrollUpdateWasRequested;this._callOnScroll(E,T,O)}},p._getRangeToRender=function(){var b=this.props,y=b.itemCount,S=b.overscanCount,_=this.state,N=_.isScrolling,k=_.scrollDirection,j=_.scrollOffset;if(y===0)return[0,0,0,0];var E=s(this.props,j,this._instanceProps),T=l(this.props,E,j,this._instanceProps),O=!N||k==="backward"?Math.max(1,S):1,R=!N||k==="forward"?Math.max(1,S):1;return[Math.max(0,E-O),Math.max(0,Math.min(y-1,T+R)),E,T]},m})(w.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var c0t=function(t,r){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,r.instance},u0t=l0t({getItemOffset:function(t,r){var n=t.itemSize;return r*n},getItemSize:function(t,r){var n=t.itemSize;return n},getEstimatedTotalSize:function(t){var r=t.itemCount,n=t.itemSize;return n*r},getOffsetForIndexAndAlignment:function(t,r,n,a,i,s){var l=t.direction,c=t.height,u=t.itemCount,d=t.itemSize,f=t.layout,m=t.width,p=l==="horizontal"||f==="horizontal",v=p?m:c,b=Math.max(0,u*d-v),y=Math.min(b,r*d),S=Math.max(0,r*d-v+d+s);switch(n==="smart"&&(a>=S-v&&a<=y+v?n="auto":n="center"),n){case"start":return y;case"end":return S;case"center":{var _=Math.round(S+(y-S)/2);return _<Math.ceil(v/2)?0:_>b+Math.floor(v/2)?b:_}case"auto":default:return a>=S&&a<=y?a:a<S?S:y}},getStartIndexForOffset:function(t,r){var n=t.itemCount,a=t.itemSize;return Math.max(0,Math.min(n-1,Math.floor(r/a)))},getStopIndexForStartIndex:function(t,r,n){var a=t.direction,i=t.height,s=t.itemCount,l=t.itemSize,c=t.layout,u=t.width,d=a==="horizontal"||c==="horizontal",f=r*l,m=d?u:i,p=Math.ceil((m+n-f)/l);return Math.max(0,Math.min(s-1,r+p-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){t.itemSize}});function d0t(){var e,t;const r=Hs(),a=Agt().cursor;if(!a||a.type!=="line")return null;const i=r.indent,s=r.rowHeight*a.index+((t=(e=r.props.padding)!==null&&e!==void 0?e:r.props.paddingTop)!==null&&t!==void 0?t:0),l=i*a.level,c=r.renderCursor;return o.jsx(c,{top:s,left:l,indent:i})}var f0t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const h0t=w.forwardRef(function(t,r){const{children:n}=t,a=f0t(t,["children"]),i=Hs();return o.jsxs("div",Object.assign({ref:r},a,{onClick:s=>{s.currentTarget===s.target&&i.deselectAll()},children:[o.jsx(m0t,{}),n]}))}),m0t=()=>{const e=Hs();return o.jsx("div",{style:{height:e.visibleNodes.length*e.rowHeight,width:"100%",position:"absolute",left:"0",right:"0"},children:o.jsx(d0t,{})})};var p0t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const g0t=w.forwardRef(function(t,r){var n,a,i,s,{style:l}=t,c=p0t(t,["style"]);const u=Hs(),d=(a=(n=u.props.padding)!==null&&n!==void 0?n:u.props.paddingTop)!==null&&a!==void 0?a:0,f=(s=(i=u.props.padding)!==null&&i!==void 0?i:u.props.paddingBottom)!==null&&s!==void 0?s:0;return o.jsx("div",Object.assign({ref:r,style:Object.assign(Object.assign({},l),{height:`${parseFloat(l.height)+d+f}px`})},c))});var Ibe=w.createContext({dragDropManager:void 0}),mo;(function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"})(mo||(mo={}));function ar(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(!e){var i;if(t===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;i=new Error(t.replace(/%s/g,function(){return n[s++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}var L$="dnd-core/INIT_COORDS",aE="dnd-core/BEGIN_DRAG",O$="dnd-core/PUBLISH_DRAG_SOURCE",iE="dnd-core/HOVER",sE="dnd-core/DROP",oE="dnd-core/END_DRAG";function gre(e,t){return{type:L$,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function Kk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kk=function(r){return typeof r}:Kk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Kk(e)}function v0t(e,t,r){return t.split(".").reduce(function(n,a){return n&&n[a]?n[a]:r||null},e)}function b0t(e,t){return e.filter(function(r){return r!==t})}function Rbe(e){return Kk(e)==="object"}function y0t(e,t){var r=new Map,n=function(s){r.set(s,r.has(s)?r.get(s)+1:1)};e.forEach(n),t.forEach(n);var a=[];return r.forEach(function(i,s){i===1&&a.push(s)}),a}function x0t(e,t){return e.filter(function(r){return t.indexOf(r)>-1})}var w0t={type:L$,payload:{clientOffset:null,sourceClientOffset:null}};function S0t(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{publishSource:!0},a=n.publishSource,i=a===void 0?!0:a,s=n.clientOffset,l=n.getSourceClientOffset,c=e.getMonitor(),u=e.getRegistry();e.dispatch(gre(s)),k0t(r,c,u);var d=C0t(r,c);if(d===null){e.dispatch(w0t);return}var f=null;if(s){if(!l)throw new Error("getSourceClientOffset must be defined");_0t(l),f=l(d)}e.dispatch(gre(s,f));var m=u.getSource(d),p=m.beginDrag(c,d);if(p!=null){N0t(p),u.pinSource(d);var v=u.getSourceType(d);return{type:aE,payload:{itemType:v,item:p,sourceId:d,clientOffset:s||null,sourceClientOffset:f||null,isSourcePublic:!!i}}}}}function k0t(e,t,r){ar(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(n){ar(r.getSource(n),"Expected sourceIds to be registered.")})}function _0t(e){ar(typeof e=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function N0t(e){ar(Rbe(e),"Item must be an object.")}function C0t(e,t){for(var r=null,n=e.length-1;n>=0;n--)if(t.canDragSource(e[n])){r=e[n];break}return r}function j0t(e){return function(){var r=e.getMonitor();if(r.isDragging())return{type:O$}}}function d5(e,t){return t===null?e===null:Array.isArray(e)?e.some(function(r){return r===t}):e===t}function E0t(e){return function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.clientOffset;M0t(r);var i=r.slice(0),s=e.getMonitor(),l=e.getRegistry();T0t(i,s,l);var c=s.getItemType();return A0t(i,l,c),D0t(i,s,l),{type:iE,payload:{targetIds:i,clientOffset:a||null}}}}function M0t(e){ar(Array.isArray(e),"Expected targetIds to be an array.")}function T0t(e,t,r){ar(t.isDragging(),"Cannot call hover while not dragging."),ar(!t.didDrop(),"Cannot call hover after drop.");for(var n=0;n<e.length;n++){var a=e[n];ar(e.lastIndexOf(a)===n,"Expected targetIds to be unique in the passed array.");var i=r.getTarget(a);ar(i,"Expected targetIds to be registered.")}}function A0t(e,t,r){for(var n=e.length-1;n>=0;n--){var a=e[n],i=t.getTargetType(a);d5(i,r)||e.splice(n,1)}}function D0t(e,t,r){e.forEach(function(n){var a=r.getTarget(n);a.hover(t,n)})}function vre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vre(Object(r),!0).forEach(function(n){L0t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L0t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O0t(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.getMonitor(),a=e.getRegistry();I0t(n);var i=z0t(n);i.forEach(function(s,l){var c=R0t(s,l,a,n),u={type:sE,payload:{dropResult:bre(bre({},r),c)}};e.dispatch(u)})}}function I0t(e){ar(e.isDragging(),"Cannot call drop while not dragging."),ar(!e.didDrop(),"Cannot call drop twice during one drag operation.")}function R0t(e,t,r,n){var a=r.getTarget(e),i=a?a.drop(n,e):void 0;return P0t(i),typeof i>"u"&&(i=t===0?{}:n.getDropResult()),i}function P0t(e){ar(typeof e>"u"||Rbe(e),"Drop result must either be an object or undefined.")}function z0t(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}function B0t(e){return function(){var r=e.getMonitor(),n=e.getRegistry();$0t(r);var a=r.getSourceId();if(a!=null){var i=n.getSource(a,!0);i.endDrag(r,a),n.unpinSource()}return{type:oE}}}function $0t(e){ar(e.isDragging(),"Cannot call endDrag while not dragging.")}function F0t(e){return{beginDrag:S0t(e),publishDragSource:j0t(e),hover:E0t(e),drop:O0t(e),endDrag:B0t(e)}}function U0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H0t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q0t(e,t,r){return t&&H0t(e.prototype,t),e}function Wv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var W0t=(function(){function e(t,r){var n=this;U0t(this,e),Wv(this,"store",void 0),Wv(this,"monitor",void 0),Wv(this,"backend",void 0),Wv(this,"isSetUp",!1),Wv(this,"handleRefCountChange",function(){var a=n.store.getState().refCount>0;n.backend&&(a&&!n.isSetUp?(n.backend.setup(),n.isSetUp=!0):!a&&n.isSetUp&&(n.backend.teardown(),n.isSetUp=!1))}),this.store=t,this.monitor=r,t.subscribe(this.handleRefCountChange)}return q0t(e,[{key:"receiveBackend",value:function(r){this.backend=r}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var r=this,n=this.store.dispatch;function a(s){return function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=s.apply(r,c);typeof d<"u"&&n(d)}}var i=F0t(this);return Object.keys(i).reduce(function(s,l){var c=i[l];return s[l]=a(c),s},{})}},{key:"dispatch",value:function(r){this.store.dispatch(r)}}]),e})();function io(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var yre=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})(),xre=function(){return Math.random().toString(36).substring(7).split("").join(".")},wre={INIT:"@@redux/INIT"+xre(),REPLACE:"@@redux/REPLACE"+xre()};function K0t(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Pbe(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(io(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(io(1));return r(Pbe)(e,t)}if(typeof e!="function")throw new Error(io(2));var a=e,i=t,s=[],l=s,c=!1;function u(){l===s&&(l=s.slice())}function d(){if(c)throw new Error(io(3));return i}function f(b){if(typeof b!="function")throw new Error(io(4));if(c)throw new Error(io(5));var y=!0;return u(),l.push(b),function(){if(y){if(c)throw new Error(io(6));y=!1,u();var _=l.indexOf(b);l.splice(_,1),s=null}}}function m(b){if(!K0t(b))throw new Error(io(7));if(typeof b.type>"u")throw new Error(io(8));if(c)throw new Error(io(9));try{c=!0,i=a(i,b)}finally{c=!1}for(var y=s=l,S=0;S<y.length;S++){var _=y[S];_()}return b}function p(b){if(typeof b!="function")throw new Error(io(10));a=b,m({type:wre.REPLACE})}function v(){var b,y=f;return b={subscribe:function(_){if(typeof _!="object"||_===null)throw new Error(io(11));function N(){_.next&&_.next(d())}N();var k=y(N);return{unsubscribe:k}}},b[yre]=function(){return this},b}return m({type:wre.INIT}),n={dispatch:m,subscribe:f,getState:d,replaceReducer:p},n[yre]=v,n}var G0t=function(t,r){return t===r};function V0t(e,t){return!e&&!t?!0:!e||!t?!1:e.x===t.x&&e.y===t.y}function Y0t(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:G0t;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!r(e[n],t[n]))return!1;return!0}function Sre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sre(Object(r),!0).forEach(function(n){Q0t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q0t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _re={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function J0t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_re,t=arguments.length>1?arguments[1]:void 0,r=t.payload;switch(t.type){case L$:case aE:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case iE:return V0t(e.clientOffset,r.clientOffset)?e:kre(kre({},e),{},{clientOffset:r.clientOffset});case oE:case sE:return _re;default:return e}}var I$="dnd-core/ADD_SOURCE",R$="dnd-core/ADD_TARGET",P$="dnd-core/REMOVE_SOURCE",lE="dnd-core/REMOVE_TARGET";function Z0t(e){return{type:I$,payload:{sourceId:e}}}function X0t(e){return{type:R$,payload:{targetId:e}}}function evt(e){return{type:P$,payload:{sourceId:e}}}function tvt(e){return{type:lE,payload:{targetId:e}}}function Nre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function so(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nre(Object(r),!0).forEach(function(n){rvt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rvt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var nvt={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function avt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nvt,t=arguments.length>1?arguments[1]:void 0,r=t.payload;switch(t.type){case aE:return so(so({},e),{},{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case O$:return so(so({},e),{},{isSourcePublic:!0});case iE:return so(so({},e),{},{targetIds:r.targetIds});case lE:return e.targetIds.indexOf(r.targetId)===-1?e:so(so({},e),{},{targetIds:b0t(e.targetIds,r.targetId)});case sE:return so(so({},e),{},{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case oE:return so(so({},e),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function ivt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I$:case R$:return e+1;case P$:case lE:return e-1;default:return e}}var AC=[],z$=[];AC.__IS_NONE__=!0;z$.__IS_ALL__=!0;function svt(e,t){if(e===AC)return!1;if(e===z$||typeof t>"u")return!0;var r=x0t(t,e);return r.length>0}function ovt(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case iE:break;case I$:case R$:case lE:case P$:return AC;case aE:case O$:case oE:case sE:default:return z$}var t=e.payload,r=t.targetIds,n=r===void 0?[]:r,a=t.prevTargetIds,i=a===void 0?[]:a,s=y0t(n,i),l=s.length>0||!Y0t(n,i);if(!l)return AC;var c=i[i.length-1],u=n[n.length-1];return c!==u&&(c&&s.push(c),u&&s.push(u)),s}function lvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e+1}function Cre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cre(Object(r),!0).forEach(function(n){cvt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cvt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:ovt(e.dirtyHandlerIds,{type:t.type,payload:jre(jre({},t.payload),{},{prevTargetIds:v0t(e,"dragOperation.targetIds",[])})}),dragOffset:J0t(e.dragOffset,t),refCount:ivt(e.refCount,t),dragOperation:avt(e.dragOperation,t),stateId:lvt(e.stateId)}}function dvt(e,t){return{x:e.x+t.x,y:e.y+t.y}}function zbe(e,t){return{x:e.x-t.x,y:e.y-t.y}}function fvt(e){var t=e.clientOffset,r=e.initialClientOffset,n=e.initialSourceClientOffset;return!t||!r||!n?null:zbe(dvt(t,n),r)}function hvt(e){var t=e.clientOffset,r=e.initialClientOffset;return!t||!r?null:zbe(t,r)}function mvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pvt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gvt(e,t,r){return t&&pvt(e.prototype,t),e}function Ere(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var vvt=(function(){function e(t,r){mvt(this,e),Ere(this,"store",void 0),Ere(this,"registry",void 0),this.store=t,this.registry=r}return gvt(e,[{key:"subscribeToStateChange",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{handlerIds:void 0},i=a.handlerIds;ar(typeof r=="function","listener must be a function."),ar(typeof i>"u"||Array.isArray(i),"handlerIds, when specified, must be an array of strings.");var s=this.store.getState().stateId,l=function(){var u=n.store.getState(),d=u.stateId;try{var f=d===s||d===s+1&&!svt(u.dirtyHandlerIds,i);f||r()}finally{s=d}};return this.store.subscribe(l)}},{key:"subscribeToOffsetChange",value:function(r){var n=this;ar(typeof r=="function","listener must be a function.");var a=this.store.getState().dragOffset,i=function(){var l=n.store.getState().dragOffset;l!==a&&(a=l,r())};return this.store.subscribe(i)}},{key:"canDragSource",value:function(r){if(!r)return!1;var n=this.registry.getSource(r);return ar(n,"Expected to find a valid source. sourceId=".concat(r)),this.isDragging()?!1:n.canDrag(this,r)}},{key:"canDropOnTarget",value:function(r){if(!r)return!1;var n=this.registry.getTarget(r);if(ar(n,"Expected to find a valid target. targetId=".concat(r)),!this.isDragging()||this.didDrop())return!1;var a=this.registry.getTargetType(r),i=this.getItemType();return d5(a,i)&&n.canDrop(this,r)}},{key:"isDragging",value:function(){return!!this.getItemType()}},{key:"isDraggingSource",value:function(r){if(!r)return!1;var n=this.registry.getSource(r,!0);if(ar(n,"Expected to find a valid source. sourceId=".concat(r)),!this.isDragging()||!this.isSourcePublic())return!1;var a=this.registry.getSourceType(r),i=this.getItemType();return a!==i?!1:n.isDragging(this,r)}},{key:"isOverTarget",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shallow:!1};if(!r)return!1;var a=n.shallow;if(!this.isDragging())return!1;var i=this.registry.getTargetType(r),s=this.getItemType();if(s&&!d5(i,s))return!1;var l=this.getTargetIds();if(!l.length)return!1;var c=l.indexOf(r);return a?c===l.length-1:c>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return!!this.store.getState().dragOperation.isSourcePublic}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return fvt(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return hvt(this.store.getState().dragOffset)}}]),e})(),bvt=0;function yvt(){return bvt++}function Gk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Gk=function(r){return typeof r}:Gk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Gk(e)}function xvt(e){ar(typeof e.canDrag=="function","Expected canDrag to be a function."),ar(typeof e.beginDrag=="function","Expected beginDrag to be a function."),ar(typeof e.endDrag=="function","Expected endDrag to be a function.")}function wvt(e){ar(typeof e.canDrop=="function","Expected canDrop to be a function."),ar(typeof e.hover=="function","Expected hover to be a function."),ar(typeof e.drop=="function","Expected beginDrag to be a function.")}function f5(e,t){if(t&&Array.isArray(e)){e.forEach(function(r){return f5(r,!1)});return}ar(typeof e=="string"||Gk(e)==="symbol",t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}const Mre=typeof global<"u"?global:self,Bbe=Mre.MutationObserver||Mre.WebKitMutationObserver;function $be(e){return function(){const r=setTimeout(a,0),n=setInterval(a,50);function a(){clearTimeout(r),clearInterval(n),e()}}}function Svt(e){let t=1;const r=new Bbe(e),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}const kvt=typeof Bbe=="function"?Svt:$be;class _vt{enqueueTask(t){const{queue:r,requestFlush:n}=this;r.length||(n(),this.flushing=!0),r[r.length]=t}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:t}=this;for(;this.index<t.length;){const r=this.index;if(this.index++,t[r].call(),this.index>this.capacity){for(let n=0,a=t.length-this.index;n<a;n++)t[n]=t[n+this.index];t.length-=this.index,this.index=0}}t.length=0,this.index=0,this.flushing=!1},this.registerPendingError=t=>{this.pendingErrors.push(t),this.requestErrorThrow()},this.requestFlush=kvt(this.flush),this.requestErrorThrow=$be(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class Nvt{call(){try{this.task&&this.task()}catch(t){this.onError(t)}finally{this.task=null,this.release(this)}}constructor(t,r){this.onError=t,this.release=r,this.task=null}}class Cvt{create(t){const r=this.freeTasks,n=r.length?r.pop():new Nvt(this.onError,a=>r[r.length]=a);return n.task=t,n}constructor(t){this.onError=t,this.freeTasks=[]}}const Fbe=new _vt,jvt=new Cvt(Fbe.registerPendingError);function Evt(e){Fbe.enqueueTask(jvt.create(e))}function Mvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tvt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Avt(e,t,r){return t&&Tvt(e.prototype,t),e}function fp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dvt(e,t){return Rvt(e)||Ivt(e,t)||Ovt(e,t)||Lvt()}function Lvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ovt(e,t){if(e){if(typeof e=="string")return Tre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tre(e,t)}}function Tre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ivt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Rvt(e){if(Array.isArray(e))return e}function Pvt(e){var t=yvt().toString();switch(e){case mo.SOURCE:return"S".concat(t);case mo.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function Are(e){switch(e[0]){case"S":return mo.SOURCE;case"T":return mo.TARGET;default:ar(!1,"Cannot parse handler ID: ".concat(e))}}function Dre(e,t){var r=e.entries(),n=!1;do{var a=r.next(),i=a.done,s=Dvt(a.value,2),l=s[1];if(l===t)return!0;n=!!i}while(!n);return!1}var zvt=(function(){function e(t){Mvt(this,e),fp(this,"types",new Map),fp(this,"dragSources",new Map),fp(this,"dropTargets",new Map),fp(this,"pinnedSourceId",null),fp(this,"pinnedSource",null),fp(this,"store",void 0),this.store=t}return Avt(e,[{key:"addSource",value:function(r,n){f5(r),xvt(n);var a=this.addHandler(mo.SOURCE,r,n);return this.store.dispatch(Z0t(a)),a}},{key:"addTarget",value:function(r,n){f5(r,!0),wvt(n);var a=this.addHandler(mo.TARGET,r,n);return this.store.dispatch(X0t(a)),a}},{key:"containsHandler",value:function(r){return Dre(this.dragSources,r)||Dre(this.dropTargets,r)}},{key:"getSource",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;ar(this.isSourceId(r),"Expected a valid source ID.");var a=n&&r===this.pinnedSourceId,i=a?this.pinnedSource:this.dragSources.get(r);return i}},{key:"getTarget",value:function(r){return ar(this.isTargetId(r),"Expected a valid target ID."),this.dropTargets.get(r)}},{key:"getSourceType",value:function(r){return ar(this.isSourceId(r),"Expected a valid source ID."),this.types.get(r)}},{key:"getTargetType",value:function(r){return ar(this.isTargetId(r),"Expected a valid target ID."),this.types.get(r)}},{key:"isSourceId",value:function(r){var n=Are(r);return n===mo.SOURCE}},{key:"isTargetId",value:function(r){var n=Are(r);return n===mo.TARGET}},{key:"removeSource",value:function(r){var n=this;ar(this.getSource(r),"Expected an existing source."),this.store.dispatch(evt(r)),Evt(function(){n.dragSources.delete(r),n.types.delete(r)})}},{key:"removeTarget",value:function(r){ar(this.getTarget(r),"Expected an existing target."),this.store.dispatch(tvt(r)),this.dropTargets.delete(r),this.types.delete(r)}},{key:"pinSource",value:function(r){var n=this.getSource(r);ar(n,"Expected an existing source."),this.pinnedSourceId=r,this.pinnedSource=n}},{key:"unpinSource",value:function(){ar(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(r,n,a){var i=Pvt(r);return this.types.set(i,n),r===mo.SOURCE?this.dragSources.set(i,a):r===mo.TARGET&&this.dropTargets.set(i,a),i}}]),e})();function Bvt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=$vt(n),i=new vvt(a,new zvt(a)),s=new W0t(a,i),l=e(s,t,r);return s.receiveBackend(l),s}function $vt(e){var t=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return Pbe(uvt,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}var Fvt=["children"];function Uvt(e,t){return Kvt(e)||Wvt(e,t)||qvt(e,t)||Hvt()}function Hvt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qvt(e,t){if(e){if(typeof e=="string")return Lre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lre(e,t)}}function Lre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wvt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Kvt(e){if(Array.isArray(e))return e}function Gvt(e,t){if(e==null)return{};var r=Vvt(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Vvt(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var Ore=0,Vk=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),Yvt=w.memo(function(t){var r=t.children,n=Gvt(t,Fvt),a=Qvt(n),i=Uvt(a,2),s=i[0],l=i[1];return w.useEffect(function(){if(l){var c=Ube();return++Ore,function(){--Ore===0&&(c[Vk]=null)}}},[]),o.jsx(Ibe.Provider,Object.assign({value:s},{children:r}),void 0)});function Qvt(e){if("manager"in e){var t={dragDropManager:e.manager};return[t,!1]}var r=Jvt(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[r,n]}function Jvt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ube(),r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=t;return a[Vk]||(a[Vk]={dragDropManager:Bvt(e,t,r,n)}),a[Vk]}function Ube(){return typeof global<"u"?global:window}function Zvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xvt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ebt(e,t,r){return t&&Xvt(e.prototype,t),e}function Ire(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ZL=!1,XL=!1,tbt=(function(){function e(t){Zvt(this,e),Ire(this,"internalMonitor",void 0),Ire(this,"sourceId",null),this.internalMonitor=t.getMonitor()}return ebt(e,[{key:"receiveHandlerId",value:function(r){this.sourceId=r}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){ar(!ZL,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return ZL=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{ZL=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;ar(!XL,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return XL=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{XL=!1}}},{key:"subscribeToStateChange",value:function(r,n){return this.internalMonitor.subscribeToStateChange(r,n)}},{key:"isDraggingSource",value:function(r){return this.internalMonitor.isDraggingSource(r)}},{key:"isOverTarget",value:function(r,n){return this.internalMonitor.isOverTarget(r,n)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(r){return this.internalMonitor.subscribeToOffsetChange(r)}},{key:"canDragSource",value:function(r){return this.internalMonitor.canDragSource(r)}},{key:"canDropOnTarget",value:function(r){return this.internalMonitor.canDropOnTarget(r)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e})();function rbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nbt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function abt(e,t,r){return t&&nbt(e.prototype,t),e}function Rre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var eO=!1,ibt=(function(){function e(t){rbt(this,e),Rre(this,"internalMonitor",void 0),Rre(this,"targetId",null),this.internalMonitor=t.getMonitor()}return abt(e,[{key:"receiveHandlerId",value:function(r){this.targetId=r}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(r,n){return this.internalMonitor.subscribeToStateChange(r,n)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;ar(!eO,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return eO=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{eO=!1}}},{key:"isOver",value:function(r){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,r):!1}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e})();function sbt(e){if(typeof e.type!="string"){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}function obt(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!w.isValidElement(t)){var n=t;return e(n,r),n}var a=t;sbt(a);var i=r?function(s){return e(s,r)}:e;return lbt(a,i)}}function Hbe(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{var a=obt(n);t[r]=function(){return a}}}),t}function Pre(e,t){typeof e=="function"?e(t):e.current=t}function lbt(e,t){var r=e.ref;return ar(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?w.cloneElement(e,{ref:function(a){Pre(r,a),Pre(t,a)}}):w.cloneElement(e,{ref:t})}function Yk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yk=function(r){return typeof r}:Yk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Yk(e)}function h5(e){return e!==null&&Yk(e)==="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function m5(e,t,r,n){var a=void 0;if(a!==void 0)return!!a;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;var i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),c=0;c<i.length;c++){var u=i[c];if(!l(u))return!1;var d=e[u],f=t[u];if(a=void 0,a===!1||a===void 0&&d!==f)return!1}return!0}function cbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ubt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dbt(e,t,r){return t&&ubt(e.prototype,t),e}function hi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fbt=(function(){function e(t){var r=this;cbt(this,e),hi(this,"hooks",Hbe({dragSource:function(a,i){r.clearDragSource(),r.dragSourceOptions=i||null,h5(a)?r.dragSourceRef=a:r.dragSourceNode=a,r.reconnectDragSource()},dragPreview:function(a,i){r.clearDragPreview(),r.dragPreviewOptions=i||null,h5(a)?r.dragPreviewRef=a:r.dragPreviewNode=a,r.reconnectDragPreview()}})),hi(this,"handlerId",null),hi(this,"dragSourceRef",null),hi(this,"dragSourceNode",void 0),hi(this,"dragSourceOptionsInternal",null),hi(this,"dragSourceUnsubscribe",void 0),hi(this,"dragPreviewRef",null),hi(this,"dragPreviewNode",void 0),hi(this,"dragPreviewOptionsInternal",null),hi(this,"dragPreviewUnsubscribe",void 0),hi(this,"lastConnectedHandlerId",null),hi(this,"lastConnectedDragSource",null),hi(this,"lastConnectedDragSourceOptions",null),hi(this,"lastConnectedDragPreview",null),hi(this,"lastConnectedDragPreviewOptions",null),hi(this,"backend",void 0),this.backend=t}return dbt(e,[{key:"receiveHandlerId",value:function(r){this.handlerId!==r&&(this.handlerId=r,this.reconnect())}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(r){this.dragSourceOptionsInternal=r}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(r){this.dragPreviewOptionsInternal=r}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var r=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();if(n&&this.disconnectDragSource(),!!this.handlerId){if(!r){this.lastConnectedDragSource=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=r,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,r,this.dragSourceOptions))}}},{key:"reconnectDragPreview",value:function(){var r=this.dragPreview,n=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!m5(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!m5(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}}]),e})();function hbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mbt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pbt(e,t,r){return t&&mbt(e.prototype,t),e}function fl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var gbt=(function(){function e(t){var r=this;hbt(this,e),fl(this,"hooks",Hbe({dropTarget:function(a,i){r.clearDropTarget(),r.dropTargetOptions=i,h5(a)?r.dropTargetRef=a:r.dropTargetNode=a,r.reconnect()}})),fl(this,"handlerId",null),fl(this,"dropTargetRef",null),fl(this,"dropTargetNode",void 0),fl(this,"dropTargetOptionsInternal",null),fl(this,"unsubscribeDropTarget",void 0),fl(this,"lastConnectedHandlerId",null),fl(this,"lastConnectedDropTarget",null),fl(this,"lastConnectedDropTargetOptions",null),fl(this,"backend",void 0),this.backend=t}return pbt(e,[{key:"connectTarget",get:function(){return this.dropTarget}},{key:"reconnect",value:function(){var r=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();r&&this.disconnectDropTarget();var n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}},{key:"receiveHandlerId",value:function(r){r!==this.handlerId&&(this.handlerId=r,this.reconnect())}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(r){this.dropTargetOptionsInternal=r}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!m5(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}}]),e})();function vbt(e,t,r){var n=r.getRegistry(),a=n.addTarget(e,t);return[a,function(){return n.removeTarget(a)}]}function bbt(e,t,r){var n=r.getRegistry(),a=n.addSource(e,t);return[a,function(){return n.removeSource(a)}]}var $h=typeof window<"u"?w.useLayoutEffect:w.useEffect;function Qk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qk=function(r){return typeof r}:Qk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Qk(e)}function ybt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xbt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wbt(e,t,r){return t&&xbt(e.prototype,t),e}function tO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Sbt=(function(){function e(t,r,n){ybt(this,e),tO(this,"spec",void 0),tO(this,"monitor",void 0),tO(this,"connector",void 0),this.spec=t,this.monitor=r,this.connector=n}return wbt(e,[{key:"beginDrag",value:function(){var r,n=this.spec,a=this.monitor,i=null;return Qk(n.item)==="object"?i=n.item:typeof n.item=="function"?i=n.item(a):i={},(r=i)!==null&&r!==void 0?r:null}},{key:"canDrag",value:function(){var r=this.spec,n=this.monitor;return typeof r.canDrag=="boolean"?r.canDrag:typeof r.canDrag=="function"?r.canDrag(n):!0}},{key:"isDragging",value:function(r,n){var a=this.spec,i=this.monitor,s=a.isDragging;return s?s(i):n===r.getSourceId()}},{key:"endDrag",value:function(){var r=this.spec,n=this.monitor,a=this.connector,i=r.end;i&&i(n.getItem(),n),a.reconnect()}}]),e})();function kbt(e,t,r){var n=w.useMemo(function(){return new Sbt(e,t,r)},[t,r]);return w.useEffect(function(){n.spec=e},[e]),n}function hm(){var e=w.useContext(Ibe),t=e.dragDropManager;return ar(t!=null,"Expected drag drop context"),t}function _bt(e){return w.useMemo(function(){var t=e.type;return ar(t!=null,"spec.type must be defined"),t},[e])}function Nbt(e,t){return Mbt(e)||Ebt(e,t)||jbt(e,t)||Cbt()}function Cbt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jbt(e,t){if(e){if(typeof e=="string")return zre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zre(e,t)}}function zre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ebt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Mbt(e){if(Array.isArray(e))return e}function Tbt(e,t,r){var n=hm(),a=kbt(e,t,r),i=_bt(e);$h(function(){if(i!=null){var l=bbt(i,a,n),c=Nbt(l,2),u=c[0],d=c[1];return t.receiveHandlerId(u),r.receiveHandlerId(u),d}},[n,t,r,a,i])}function Abt(e){return Ibt(e)||Obt(e)||Lbt(e)||Dbt()}function Dbt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lbt(e,t){if(e){if(typeof e=="string")return p5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p5(e,t)}}function Obt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ibt(e){if(Array.isArray(e))return p5(e)}function p5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qbe(e,t){var r=Abt(t||[]);return t==null&&typeof e!="function"&&r.push(e),w.useMemo(function(){return typeof e=="function"?e():e},r)}function Rbt(){var e=hm();return w.useMemo(function(){return new tbt(e)},[e])}function Pbt(e,t){var r=hm(),n=w.useMemo(function(){return new fbt(r.getBackend())},[r]);return $h(function(){return n.dragSourceOptions=e||null,n.reconnect(),function(){return n.disconnectDragSource()}},[n,e]),$h(function(){return n.dragPreviewOptions=t||null,n.reconnect(),function(){return n.disconnectDragPreview()}},[n,t]),n}var rO,Bre;function zbt(){return Bre||(Bre=1,rO=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,i;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(i=Object.keys(t),n=i.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[a]))return!1;for(a=n;a--!==0;){var s=i[a];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}),rO}var Bbt=zbt();const $bt=Fr(Bbt);function Fbt(e,t){return Wbt(e)||qbt(e,t)||Hbt(e,t)||Ubt()}function Ubt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hbt(e,t){if(e){if(typeof e=="string")return $re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $re(e,t)}}function $re(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qbt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Wbt(e){if(Array.isArray(e))return e}function Wbe(e,t,r){var n=w.useState(function(){return t(e)}),a=Fbt(n,2),i=a[0],s=a[1],l=w.useCallback(function(){var c=t(e);$bt(i,c)||(s(c),r&&r())},[i,e,r]);return $h(l),[i,l]}function Kbt(e,t){return Qbt(e)||Ybt(e,t)||Vbt(e,t)||Gbt()}function Gbt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vbt(e,t){if(e){if(typeof e=="string")return Fre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fre(e,t)}}function Fre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ybt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function Qbt(e){if(Array.isArray(e))return e}function Jbt(e,t,r){var n=Wbe(e,t,r),a=Kbt(n,2),i=a[0],s=a[1];return $h(function(){var c=e.getHandlerId();if(c!=null)return e.subscribeToStateChange(s,{handlerIds:[c]})},[e,s]),i}function Kbe(e,t,r){return Jbt(t,e||function(){return{}},function(){return r.reconnect()})}function Zbt(e){return w.useMemo(function(){return e.hooks.dragSource()},[e])}function Xbt(e){return w.useMemo(function(){return e.hooks.dragPreview()},[e])}function eyt(e,t){var r=qbe(e,t);ar(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");var n=Rbt(),a=Pbt(r.options,r.previewOptions);return Tbt(r,n,a),[Kbe(r.collect,n,a),Zbt(a),Xbt(a)]}function tyt(e){var t=e.accept;return w.useMemo(function(){return ar(e.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]},[t])}function ryt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ayt(e,t,r){return t&&nyt(e.prototype,t),e}function Ure(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var iyt=(function(){function e(t,r){ryt(this,e),Ure(this,"spec",void 0),Ure(this,"monitor",void 0),this.spec=t,this.monitor=r}return ayt(e,[{key:"canDrop",value:function(){var r=this.spec,n=this.monitor;return r.canDrop?r.canDrop(n.getItem(),n):!0}},{key:"hover",value:function(){var r=this.spec,n=this.monitor;r.hover&&r.hover(n.getItem(),n)}},{key:"drop",value:function(){var r=this.spec,n=this.monitor;if(r.drop)return r.drop(n.getItem(),n)}}]),e})();function syt(e,t){var r=w.useMemo(function(){return new iyt(e,t)},[t]);return w.useEffect(function(){r.spec=e},[e]),r}function oyt(e,t){return dyt(e)||uyt(e,t)||cyt(e,t)||lyt()}function lyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cyt(e,t){if(e){if(typeof e=="string")return Hre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hre(e,t)}}function Hre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function dyt(e){if(Array.isArray(e))return e}function fyt(e,t,r){var n=hm(),a=syt(e,t),i=tyt(e);$h(function(){var l=vbt(i,a,n),c=oyt(l,2),u=c[0],d=c[1];return t.receiveHandlerId(u),r.receiveHandlerId(u),d},[n,t,a,r,i.map(function(s){return s.toString()}).join("|")])}function hyt(){var e=hm();return w.useMemo(function(){return new ibt(e)},[e])}function myt(e){var t=hm(),r=w.useMemo(function(){return new gbt(t.getBackend())},[t]);return $h(function(){return r.dropTargetOptions=e||null,r.reconnect(),function(){return r.disconnectDropTarget()}},[e]),r}function pyt(e){return w.useMemo(function(){return e.hooks.dropTarget()},[e])}function Gbe(e,t){var r=qbe(e,t),n=hyt(),a=myt(r.options);return fyt(r,n,a),[Kbe(r.collect,n,a),pyt(a)]}function gyt(e,t){return xyt(e)||yyt(e,t)||byt(e,t)||vyt()}function vyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function byt(e,t){if(e){if(typeof e=="string")return qre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qre(e,t)}}function qre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,l;try{for(r=r.call(e);!(a=(s=r.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw l}}return n}}function xyt(e){if(Array.isArray(e))return e}function wyt(e){var t=hm(),r=t.getMonitor(),n=Wbe(r,e),a=gyt(n,2),i=a[0],s=a[1];return w.useEffect(function(){return r.subscribeToOffsetChange(s)}),w.useEffect(function(){return r.subscribeToStateChange(s)}),i}function Vbe(e){var t=null,r=function(){return t==null&&(t=e()),t};return r}function Syt(e,t){return e.filter(function(r){return r!==t})}function kyt(e,t){var r=new Set,n=function(s){return r.add(s)};e.forEach(n),t.forEach(n);var a=[];return r.forEach(function(i){return a.push(i)}),a}function _yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cyt(e,t,r){return t&&Nyt(e.prototype,t),e}function Wre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var jyt=(function(){function e(t){_yt(this,e),Wre(this,"entered",[]),Wre(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}return Cyt(e,[{key:"enter",value:function(r){var n=this,a=this.entered.length,i=function(l){return n.isNodeInDocument(l)&&(!l.contains||l.contains(r))};return this.entered=kyt(this.entered.filter(i),[r]),a===0&&this.entered.length>0}},{key:"leave",value:function(r){var n=this.entered.length;return this.entered=Syt(this.entered.filter(this.isNodeInDocument),r),n>0&&this.entered.length===0}},{key:"reset",value:function(){this.entered=[]}}]),e})(),Eyt=Vbe(function(){return/firefox/i.test(navigator.userAgent)}),Ybe=Vbe(function(){return!!window.safari});function Myt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ayt(e,t,r){return t&&Tyt(e.prototype,t),e}function Kv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Kre=(function(){function e(t,r){Myt(this,e),Kv(this,"xs",void 0),Kv(this,"ys",void 0),Kv(this,"c1s",void 0),Kv(this,"c2s",void 0),Kv(this,"c3s",void 0);for(var n=t.length,a=[],i=0;i<n;i++)a.push(i);a.sort(function(O,R){return t[O]<t[R]?-1:1});for(var s=[],l=[],c,u,d=0;d<n-1;d++)c=t[d+1]-t[d],u=r[d+1]-r[d],s.push(c),l.push(u/c);for(var f=[l[0]],m=0;m<s.length-1;m++){var p=l[m],v=l[m+1];if(p*v<=0)f.push(0);else{c=s[m];var b=s[m+1],y=c+b;f.push(3*y/((y+b)/p+(y+c)/v))}}f.push(l[l.length-1]);for(var S=[],_=[],N,k=0;k<f.length-1;k++){N=l[k];var j=f[k],E=1/s[k],T=j+f[k+1]-N-N;S.push((N-j-T)*E),_.push(T*E*E)}this.xs=t,this.ys=r,this.c1s=f,this.c2s=S,this.c3s=_}return Ayt(e,[{key:"interpolate",value:function(r){var n=this.xs,a=this.ys,i=this.c1s,s=this.c2s,l=this.c3s,c=n.length-1;if(r===n[c])return a[c];for(var u=0,d=l.length-1,f;u<=d;){f=Math.floor(.5*(u+d));var m=n[f];if(m<r)u=f+1;else if(m>r)d=f-1;else return a[f]}c=Math.max(0,d);var p=r-n[c],v=p*p;return a[c]+i[c]*p+s[c]*v+l[c]*p*v}}]),e})(),Dyt=1;function Qbe(e){var t=e.nodeType===Dyt?e:e.parentElement;if(!t)return null;var r=t.getBoundingClientRect(),n=r.top,a=r.left;return{x:a,y:n}}function XS(e){return{x:e.clientX,y:e.clientY}}function Lyt(e){var t;return e.nodeName==="IMG"&&(Eyt()||!((t=document.documentElement)!==null&&t!==void 0&&t.contains(e)))}function Oyt(e,t,r,n){var a=e?t.width:r,i=e?t.height:n;return Ybe()&&e&&(i/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:i}}function Iyt(e,t,r,n,a){var i=Lyt(t),s=i?e:t,l=Qbe(s),c={x:r.x-l.x,y:r.y-l.y},u=e.offsetWidth,d=e.offsetHeight,f=n.anchorX,m=n.anchorY,p=Oyt(i,t,u,d),v=p.dragPreviewWidth,b=p.dragPreviewHeight,y=function(){var T=new Kre([0,.5,1],[c.y,c.y/d*b,c.y+b-d]),O=T.interpolate(m);return Ybe()&&i&&(O+=(window.devicePixelRatio-1)*b),O},S=function(){var T=new Kre([0,.5,1],[c.x,c.x/u*v,c.x+v-u]);return T.interpolate(f)},_=a.offsetX,N=a.offsetY,k=_===0||_,j=N===0||N;return{x:k?_:S(),y:j?N:y()}}var Jbe="__NATIVE_FILE__",Zbe="__NATIVE_URL__",Xbe="__NATIVE_TEXT__",eye="__NATIVE_HTML__";const Gre=Object.freeze(Object.defineProperty({__proto__:null,FILE:Jbe,HTML:eye,TEXT:Xbe,URL:Zbe},Symbol.toStringTag,{value:"Module"}));function nO(e,t,r){var n=t.reduce(function(a,i){return a||e.getData(i)},"");return n??r}var hp;function ek(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g5=(hp={},ek(hp,Jbe,{exposeProperties:{files:function(t){return Array.prototype.slice.call(t.files)},items:function(t){return t.items},dataTransfer:function(t){return t}},matchesTypes:["Files"]}),ek(hp,eye,{exposeProperties:{html:function(t,r){return nO(t,r,"")},dataTransfer:function(t){return t}},matchesTypes:["Html","text/html"]}),ek(hp,Zbe,{exposeProperties:{urls:function(t,r){return nO(t,r,"").split(`
`)},dataTransfer:function(t){return t}},matchesTypes:["Url","text/uri-list"]}),ek(hp,Xbe,{exposeProperties:{text:function(t,r){return nO(t,r,"")},dataTransfer:function(t){return t}},matchesTypes:["Text","text/plain"]}),hp);function Ryt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zyt(e,t,r){return t&&Pyt(e.prototype,t),e}function Vre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Byt=(function(){function e(t){Ryt(this,e),Vre(this,"item",void 0),Vre(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}return zyt(e,[{key:"initializeExposedProperties",value:function(){var r=this;Object.keys(this.config.exposeProperties).forEach(function(n){Object.defineProperty(r.item,n,{configurable:!0,enumerable:!0,get:function(){return console.warn(`Browser doesn't allow reading "`.concat(n,'" until the drop event.')),null}})})}},{key:"loadDataTransfer",value:function(r){var n=this;if(r){var a={};Object.keys(this.config.exposeProperties).forEach(function(i){a[i]={value:n.config.exposeProperties[i](r,n.config.matchesTypes),configurable:!0,enumerable:!0}}),Object.defineProperties(this.item,a)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(r,n){return n===r.getSourceId()}},{key:"endDrag",value:function(){}}]),e})();function $yt(e,t){var r=new Byt(g5[e]);return r.loadDataTransfer(t),r}function aO(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(g5).filter(function(r){var n=g5[r].matchesTypes;return n.some(function(a){return t.indexOf(a)>-1})})[0]||null}function Fyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hyt(e,t,r){return t&&Uyt(e.prototype,t),e}function iO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var qyt=(function(){function e(t,r){Fyt(this,e),iO(this,"ownerDocument",null),iO(this,"globalContext",void 0),iO(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=r}return Hyt(e,[{key:"window",get:function(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}},{key:"document",get:function(){var r;return(r=this.globalContext)!==null&&r!==void 0&&r.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var r;return((r=this.optionsArgs)===null||r===void 0?void 0:r.rootElement)||this.window}}]),e})();function Yre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yre(Object(r),!0).forEach(function(n){vr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gyt(e,t,r){return t&&Kyt(e.prototype,t),e}function vr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Vyt=(function(){function e(t,r,n){var a=this;Wyt(this,e),vr(this,"options",void 0),vr(this,"actions",void 0),vr(this,"monitor",void 0),vr(this,"registry",void 0),vr(this,"enterLeaveCounter",void 0),vr(this,"sourcePreviewNodes",new Map),vr(this,"sourcePreviewNodeOptions",new Map),vr(this,"sourceNodes",new Map),vr(this,"sourceNodeOptions",new Map),vr(this,"dragStartSourceIds",null),vr(this,"dropTargetIds",[]),vr(this,"dragEnterTargetIds",[]),vr(this,"currentNativeSource",null),vr(this,"currentNativeHandle",null),vr(this,"currentDragSourceNode",null),vr(this,"altKeyPressed",!1),vr(this,"mouseMoveTimeoutTimer",null),vr(this,"asyncEndDragFrameId",null),vr(this,"dragOverTargetIds",null),vr(this,"lastClientOffset",null),vr(this,"hoverRafId",null),vr(this,"getSourceClientOffset",function(i){var s=a.sourceNodes.get(i);return s&&Qbe(s)||null}),vr(this,"endDragNativeItem",function(){a.isDraggingNativeItem()&&(a.actions.endDrag(),a.currentNativeHandle&&a.registry.removeSource(a.currentNativeHandle),a.currentNativeHandle=null,a.currentNativeSource=null)}),vr(this,"isNodeInDocument",function(i){return!!(i&&a.document&&a.document.body&&a.document.body.contains(i))}),vr(this,"endDragIfSourceWasRemovedFromDOM",function(){var i=a.currentDragSourceNode;i==null||a.isNodeInDocument(i)||a.clearCurrentDragSourceNode()&&a.monitor.isDragging()&&a.actions.endDrag()}),vr(this,"handleTopDragStartCapture",function(){a.clearCurrentDragSourceNode(),a.dragStartSourceIds=[]}),vr(this,"handleTopDragStart",function(i){if(!i.defaultPrevented){var s=a.dragStartSourceIds;a.dragStartSourceIds=null;var l=XS(i);a.monitor.isDragging()&&a.actions.endDrag(),a.actions.beginDrag(s||[],{publishSource:!1,getSourceClientOffset:a.getSourceClientOffset,clientOffset:l});var c=i.dataTransfer,u=aO(c);if(a.monitor.isDragging()){if(c&&typeof c.setDragImage=="function"){var d=a.monitor.getSourceId(),f=a.sourceNodes.get(d),m=a.sourcePreviewNodes.get(d)||f;if(m){var p=a.getCurrentSourcePreviewNodeOptions(),v=p.anchorX,b=p.anchorY,y=p.offsetX,S=p.offsetY,_={anchorX:v,anchorY:b},N={offsetX:y,offsetY:S},k=Iyt(f,m,l,_,N);c.setDragImage(m,k.x,k.y)}}try{c?.setData("application/json",{})}catch{}a.setCurrentDragSourceNode(i.target);var j=a.getCurrentSourcePreviewNodeOptions(),E=j.captureDraggingState;E?a.actions.publishDragSource():setTimeout(function(){return a.actions.publishDragSource()},0)}else if(u)a.beginDragNativeItem(u);else{if(c&&!c.types&&(i.target&&!i.target.hasAttribute||!i.target.hasAttribute("draggable")))return;i.preventDefault()}}}),vr(this,"handleTopDragEndCapture",function(){a.clearCurrentDragSourceNode()&&a.monitor.isDragging()&&a.actions.endDrag()}),vr(this,"handleTopDragEnterCapture",function(i){a.dragEnterTargetIds=[];var s=a.enterLeaveCounter.enter(i.target);if(!(!s||a.monitor.isDragging())){var l=i.dataTransfer,c=aO(l);c&&a.beginDragNativeItem(c,l)}}),vr(this,"handleTopDragEnter",function(i){var s=a.dragEnterTargetIds;if(a.dragEnterTargetIds=[],!!a.monitor.isDragging()){a.altKeyPressed=i.altKey,s.length>0&&a.actions.hover(s,{clientOffset:XS(i)});var l=s.some(function(c){return a.monitor.canDropOnTarget(c)});l&&(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=a.getCurrentDropEffect()))}}),vr(this,"handleTopDragOverCapture",function(){a.dragOverTargetIds=[]}),vr(this,"handleTopDragOver",function(i){var s=a.dragOverTargetIds;if(a.dragOverTargetIds=[],!a.monitor.isDragging()){i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none");return}a.altKeyPressed=i.altKey,a.lastClientOffset=XS(i),a.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(a.hoverRafId=requestAnimationFrame(function(){a.monitor.isDragging()&&a.actions.hover(s||[],{clientOffset:a.lastClientOffset}),a.hoverRafId=null}));var l=(s||[]).some(function(c){return a.monitor.canDropOnTarget(c)});l?(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=a.getCurrentDropEffect())):a.isDraggingNativeItem()?i.preventDefault():(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none"))}),vr(this,"handleTopDragLeaveCapture",function(i){a.isDraggingNativeItem()&&i.preventDefault();var s=a.enterLeaveCounter.leave(i.target);s&&a.isDraggingNativeItem()&&setTimeout(function(){return a.endDragNativeItem()},0)}),vr(this,"handleTopDropCapture",function(i){if(a.dropTargetIds=[],a.isDraggingNativeItem()){var s;i.preventDefault(),(s=a.currentNativeSource)===null||s===void 0||s.loadDataTransfer(i.dataTransfer)}else aO(i.dataTransfer)&&i.preventDefault();a.enterLeaveCounter.reset()}),vr(this,"handleTopDrop",function(i){var s=a.dropTargetIds;a.dropTargetIds=[],a.actions.hover(s,{clientOffset:XS(i)}),a.actions.drop({dropEffect:a.getCurrentDropEffect()}),a.isDraggingNativeItem()?a.endDragNativeItem():a.monitor.isDragging()&&a.actions.endDrag()}),vr(this,"handleSelectStart",function(i){var s=i.target;typeof s.dragDrop=="function"&&(s.tagName==="INPUT"||s.tagName==="SELECT"||s.tagName==="TEXTAREA"||s.isContentEditable||(i.preventDefault(),s.dragDrop()))}),this.options=new qyt(r,n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new jyt(this.isNodeInDocument)}return Gyt(e,[{key:"profile",value:function(){var r,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((r=this.dragStartSourceIds)===null||r===void 0?void 0:r.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var r=this.rootElement;if(r!==void 0){if(r.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");r.__isReactDndBackendSetUp=!0,this.addEventListeners(r)}}},{key:"teardown",value:function(){var r=this.rootElement;if(r!==void 0&&(r.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}},{key:"connectDragPreview",value:function(r,n,a){var i=this;return this.sourcePreviewNodeOptions.set(r,a),this.sourcePreviewNodes.set(r,n),function(){i.sourcePreviewNodes.delete(r),i.sourcePreviewNodeOptions.delete(r)}}},{key:"connectDragSource",value:function(r,n,a){var i=this;this.sourceNodes.set(r,n),this.sourceNodeOptions.set(r,a);var s=function(u){return i.handleDragStart(u,r)},l=function(u){return i.handleSelectStart(u)};return n.setAttribute("draggable","true"),n.addEventListener("dragstart",s),n.addEventListener("selectstart",l),function(){i.sourceNodes.delete(r),i.sourceNodeOptions.delete(r),n.removeEventListener("dragstart",s),n.removeEventListener("selectstart",l),n.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(r,n){var a=this,i=function(u){return a.handleDragEnter(u,r)},s=function(u){return a.handleDragOver(u,r)},l=function(u){return a.handleDrop(u,r)};return n.addEventListener("dragenter",i),n.addEventListener("dragover",s),n.addEventListener("drop",l),function(){n.removeEventListener("dragenter",i),n.removeEventListener("dragover",s),n.removeEventListener("drop",l)}}},{key:"addEventListeners",value:function(r){r.addEventListener&&(r.addEventListener("dragstart",this.handleTopDragStart),r.addEventListener("dragstart",this.handleTopDragStartCapture,!0),r.addEventListener("dragend",this.handleTopDragEndCapture,!0),r.addEventListener("dragenter",this.handleTopDragEnter),r.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.addEventListener("dragover",this.handleTopDragOver),r.addEventListener("dragover",this.handleTopDragOverCapture,!0),r.addEventListener("drop",this.handleTopDrop),r.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(r){r.removeEventListener&&(r.removeEventListener("dragstart",this.handleTopDragStart),r.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),r.removeEventListener("dragend",this.handleTopDragEndCapture,!0),r.removeEventListener("dragenter",this.handleTopDragEnter),r.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.removeEventListener("dragover",this.handleTopDragOver),r.removeEventListener("dragover",this.handleTopDragOverCapture,!0),r.removeEventListener("drop",this.handleTopDrop),r.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var r=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(r);return Qre({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var r=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(r);return Qre({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}},{key:"isDraggingNativeItem",value:function(){var r=this.monitor.getItemType();return Object.keys(Gre).some(function(n){return Gre[n]===r})}},{key:"beginDragNativeItem",value:function(r,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=$yt(r,n),this.currentNativeHandle=this.registry.addSource(r,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(r){var n=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=r;var a=1e3;this.mouseMoveTimeoutTimer=setTimeout(function(){var i;return(i=n.rootElement)===null||i===void 0?void 0:i.addEventListener("mousemove",n.endDragIfSourceWasRemovedFromDOM,!0)},a)}},{key:"clearCurrentDragSourceNode",value:function(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var r;(r=this.window)===null||r===void 0||r.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}},{key:"handleDragStart",value:function(r,n){r.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}},{key:"handleDragEnter",value:function(r,n){this.dragEnterTargetIds.unshift(n)}},{key:"handleDragOver",value:function(r,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}},{key:"handleDrop",value:function(r,n){this.dropTargetIds.unshift(n)}}]),e})(),tk;function Yyt(){return tk||(tk=new Image,tk.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),tk}var Qyt=function(t,r,n){return new Vyt(t,r,n)};function Jyt(e){const t=Hs(),r=t.selectedIds,[n,a,i]=eyt(()=>({canDrag:()=>e.isDraggable,type:"NODE",item:()=>{const s=t.isSelected(e.id)?Array.from(r):[e.id];return t.dispatch(Gg.dragStart(e.id,s)),{id:e.id,dragIds:s}},end:()=>{t.hideCursor(),t.dispatch(Gg.dragEnd())}}),[r,e]);return w.useEffect(()=>{i(Yyt())},[i]),a}function Zyt(e,t){const r=e.getBoundingClientRect(),n=t.x-Math.round(r.x),a=t.y-Math.round(r.y),i=r.height,s=a<i/2,l=!s,c=i/4,u=a>c&&a<i-c;return{x:n,inTopHalf:s,inBottomHalf:l,inMiddle:u,atTop:!u&&s,atBottom:!u&&l}}function Xyt(e,t,r,n){return e?e.isInternal?n.atTop?[t,e]:n.inMiddle?[e,e]:[e,r]:n.inTopHalf?[t,e]:[e,r]:[t,null]}function rk(e,t){return{parentId:e||null,index:t}}function mp(e,t){return{type:"line",index:e,level:t}}function ext(e){return{type:"highlight",id:e}}function sO(e,t){var r;let n=e;for(;n.parent&&n.level>t;)n=n.parent;const a=((r=n.parent)===null||r===void 0?void 0:r.id)||null,i=Nbe(n)+1;return{parentId:a,index:i}}function tye(e){var t;const r=Zyt(e.element,e.offset),n=e.indent,a=Math.round(Math.max(0,r.x-n)/n),{node:i,nextNode:s,prevNode:l}=e,[c,u]=Xyt(i,l,s,r);if(i&&i.isInternal&&r.inMiddle)return{drop:rk(i.id,null),cursor:ext(i.id)};if(!c)return{drop:rk((t=u?.parent)===null||t===void 0?void 0:t.id,0),cursor:mp(0,0)};if(wbe(c)){const d=Wk(a,u?.level||0,c.level);return{drop:sO(c,d),cursor:mp(c.rowIndex+1,d)}}if(Sbe(c)){const d=Wk(a,u?.level||0,c.level);return{drop:sO(c,d),cursor:mp(c.rowIndex+1,d)}}if(kbe(c)){const d=Wk(a,0,c.level+1);return d>c.level?{drop:rk(c.id,0),cursor:mp(c.rowIndex+1,d)}:{drop:sO(c,d),cursor:mp(c.rowIndex+1,d)}}return{drop:rk(c?.id,0),cursor:mp(c.rowIndex+1,c.level+1)}}function txt(e,t){const r=Hs(),[n,a]=Gbe(()=>({accept:"NODE",canDrop:()=>r.canDrop(),hover:(i,s)=>{const l=s.getClientOffset();if(!e.current||!l)return;const{cursor:c,drop:u}=tye({element:e.current,offset:l,indent:r.indent,node:t,prevNode:t.prev,nextNode:t.next});u&&r.dispatch(Gg.hovering(u.parentId,u.index)),s.canDrop()?c&&r.showCursor(c):r.hideCursor()},drop:(i,s)=>{if(!s.canDrop())return null;let{parentId:l,index:c,dragIds:u}=r.state.dnd;Tbe(r.props.onMove,{dragIds:u,parentId:l===Cx?null:l,index:c===null?0:c,dragNodes:r.dragNodes,parentNode:r.get(l)}),r.open(l)}}),[t,e.current,r.props]);return a}function rxt(e){const t=Hs(),r=t.at(e);if(!r)throw new Error(`Could not find node for index: ${e}`);return w.useMemo(()=>{const n=r.clone();return t.visibleNodes[e]=n,n},[...Object.values(r.state),r])}const nxt=le.memo(function({index:t,style:r}){xbe(),Tgt();const n=Hs(),a=rxt(t),i=w.useRef(null),s=Jyt(a),l=txt(i,a),c=w.useCallback(b=>{i.current=b,l(b)},[l]),u=n.indent*a.level,d=w.useMemo(()=>({paddingLeft:u}),[u]),f=w.useMemo(()=>{var b,y;return Object.assign(Object.assign({},r),{top:parseFloat(r.top)+((y=(b=n.props.padding)!==null&&b!==void 0?b:n.props.paddingTop)!==null&&y!==void 0?y:0)})},[r,n.props.padding,n.props.paddingTop]),m={role:"treeitem","aria-level":a.level+1,"aria-selected":a.isSelected,"aria-expanded":a.isOpen,style:f,tabIndex:-1,className:n.props.rowClassName};w.useEffect(()=>{var b;!a.isEditing&&a.isFocused&&((b=i.current)===null||b===void 0||b.focus({preventScroll:!0}))},[a.isEditing,a.isFocused,i.current]);const p=n.renderNode,v=n.renderRow;return o.jsx(v,{node:a,innerRef:c,attrs:m,children:o.jsx(p,{node:a,tree:n,style:d,dragHandle:s})})});let oO="",Jre=null;function rye(){xbe();const e=Hs();return o.jsx("div",{role:"tree",style:{height:e.height,width:e.width,minHeight:0,minWidth:0},onContextMenu:e.props.onContextMenu,onClick:e.props.onClick,tabIndex:0,onFocus:t=>{t.currentTarget.contains(t.relatedTarget)||e.onFocus()},onBlur:t=>{t.currentTarget.contains(t.relatedTarget)||e.onBlur()},onKeyDown:t=>{var r;if(e.isEditing)return;if(t.key==="Backspace"){if(!e.props.onDelete)return;const a=Array.from(e.selectedIds);if(a.length>1){let i=e.mostRecentNode;for(;i&&i.isSelected;)i=i.nextSibling;i||(i=e.lastNode),e.focus(i,{scroll:!1}),e.delete(Array.from(a))}else{const i=e.focusedNode;if(i){const s=i.nextSibling,l=i.parent;e.focus(s||l,{scroll:!1}),e.delete(i)}}return}if(t.key==="Tab"&&!t.shiftKey){t.preventDefault(),Cbe(t.currentTarget);return}if(t.key==="Tab"&&t.shiftKey){t.preventDefault(),jbe(t.currentTarget);return}if(t.key==="ArrowDown"){t.preventDefault();const a=e.nextNode;if(t.metaKey){e.select(e.focusedNode),e.activate(e.focusedNode);return}else if(!t.shiftKey||e.props.disableMultiSelection){e.focus(a);return}else{if(!a)return;const i=e.focusedNode;i?i.isSelected?e.selectContiguous(a):e.selectMulti(a):e.focus(e.firstNode);return}}if(t.key==="ArrowUp"){t.preventDefault();const a=e.prevNode;if(!t.shiftKey||e.props.disableMultiSelection){e.focus(a);return}else{if(!a)return;const i=e.focusedNode;i?i.isSelected?e.selectContiguous(a):e.selectMulti(a):e.focus(e.lastNode);return}}if(t.key==="ArrowRight"){const a=e.focusedNode;if(!a)return;a.isInternal&&a.isOpen?e.focus(e.nextNode):a.isInternal&&e.open(a.id);return}if(t.key==="ArrowLeft"){const a=e.focusedNode;if(!a||a.isRoot)return;a.isInternal&&a.isOpen?e.close(a.id):!((r=a.parent)===null||r===void 0)&&r.isRoot||e.focus(a.parent);return}if(t.key==="a"&&t.metaKey&&!e.props.disableMultiSelection){t.preventDefault(),e.selectAll();return}if(t.key==="a"&&!t.metaKey&&e.props.onCreate){e.createLeaf();return}if(t.key==="A"&&!t.metaKey){if(!e.props.onCreate)return;e.createInternal();return}if(t.key==="Home"){t.preventDefault(),e.focus(e.firstNode);return}if(t.key==="End"){t.preventDefault(),e.focus(e.lastNode);return}if(t.key==="Enter"){const a=e.focusedNode;if(!a||!a.isEditable||!e.props.onRename)return;setTimeout(()=>{a&&e.edit(a)});return}if(t.key===" "){t.preventDefault();const a=e.focusedNode;if(!a)return;a.isLeaf?(a.select(),a.activate()):a.toggle();return}if(t.key==="*"){const a=e.focusedNode;if(!a)return;e.openSiblings(a);return}if(t.key==="PageUp"){t.preventDefault(),e.pageUp();return}t.key==="PageDown"&&(t.preventDefault(),e.pageDown()),clearTimeout(Jre),oO+=t.key,Jre=setTimeout(()=>{oO=""},600);const n=e.visibleNodes.find(a=>{const i=a.data.name;return typeof i=="string"?i.toLowerCase().startsWith(oO):!1});n&&e.focus(n.id)},children:o.jsx(u0t,{className:e.props.className,outerRef:e.listEl,itemCount:e.visibleNodes.length,height:e.height,width:e.width,itemSize:e.rowHeight,overscanCount:e.overscanCount,itemKey:t=>{var r;return((r=e.visibleNodes[t])===null||r===void 0?void 0:r.id)||t},outerElementType:h0t,innerElementType:g0t,onScroll:e.props.onScroll,onItemsRendered:e.onItemsRendered.bind(e),ref:e.list,children:nxt})})}function Zre(e){return e.isFiltered?ixt(e.root,e.isMatch.bind(e)):axt(e.root)}function axt(e){const t=[];function r(n){var a;n.level>=0&&t.push(n),n.isOpen&&((a=n.children)===null||a===void 0||a.forEach(r))}return r(e),t.forEach(nye),t}function ixt(e,t){const r={},n=[];function a(s){if(!s.isRoot&&t(s)){r[s.id]=!0;let c=s.parent;for(;c;)r[c.id]=!0,c=c.parent}if(s.children)for(let c of s.children)a(c)}function i(s){var l;s.level>=0&&r[s.id]&&n.push(s),s.isOpen&&((l=s.children)===null||l===void 0||l.forEach(i))}return a(e),i(e),n.forEach(nye),n}function nye(e,t){e.rowIndex=t}const Xre=e=>e.reduce((t,r,n)=>(t[r.id]=n,t),{});var lO=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const{safeRun:La,identify:xc,identifyNull:Io}=Ogt;class ry{constructor(t,r,n,a){this.store=t,this.props=r,this.list=n,this.listEl=a,this.visibleStartIndex=0,this.visibleStopIndex=0,this.root=cre(this),this.visibleNodes=Zre(this),this.idToIndex=Xre(this.visibleNodes)}update(t){this.props=t,this.root=cre(this),this.visibleNodes=Zre(this),this.idToIndex=Xre(this.visibleNodes)}dispatch(t){return this.store.dispatch(t)}get state(){return this.store.getState()}get openState(){return this.state.nodes.open.unfiltered}get width(){var t;return(t=this.props.width)!==null&&t!==void 0?t:300}get height(){var t;return(t=this.props.height)!==null&&t!==void 0?t:500}get indent(){var t;return(t=this.props.indent)!==null&&t!==void 0?t:24}get rowHeight(){var t;return(t=this.props.rowHeight)!==null&&t!==void 0?t:24}get overscanCount(){var t;return(t=this.props.overscanCount)!==null&&t!==void 0?t:1}get searchTerm(){return(this.props.searchTerm||"").trim()}get matchFn(){var t;const r=(t=this.props.searchMatch)!==null&&t!==void 0?t:((n,a)=>JSON.stringify(Object.values(n.data)).toLocaleLowerCase().includes(a.toLocaleLowerCase()));return n=>r(n,this.searchTerm)}accessChildren(t){var r;const n=this.props.childrenAccessor||"children";return(r=Cb(t,n))!==null&&r!==void 0?r:null}accessId(t){const r=this.props.idAccessor||"id",n=Cb(t,r);if(!n)throw new Error("Data must contain an 'id' property or props.idAccessor must return a string");return n}get firstNode(){var t;return(t=this.visibleNodes[0])!==null&&t!==void 0?t:null}get lastNode(){var t;return(t=this.visibleNodes[this.visibleNodes.length-1])!==null&&t!==void 0?t:null}get focusedNode(){var t;return(t=this.get(this.state.nodes.focus.id))!==null&&t!==void 0?t:null}get mostRecentNode(){var t;return(t=this.get(this.state.nodes.selection.mostRecent))!==null&&t!==void 0?t:null}get nextNode(){const t=this.indexOf(this.focusedNode);return t===null?null:this.at(t+1)}get prevNode(){const t=this.indexOf(this.focusedNode);return t===null?null:this.at(t-1)}get(t){return t&&t in this.idToIndex&&this.visibleNodes[this.idToIndex[t]]||null}at(t){return this.visibleNodes[t]||null}nodesBetween(t,r){var n;if(t===null||r===null)return[];const a=(n=this.indexOf(t))!==null&&n!==void 0?n:0,i=this.indexOf(r);if(i===null)return[];const s=Math.min(a,i),l=Math.max(a,i);return this.visibleNodes.slice(s,l+1)}indexOf(t){const r=Mbe(t);return r?this.idToIndex[r]:null}get editingId(){return this.state.nodes.edit.id}createInternal(){return this.create({type:"internal"})}createLeaf(){return this.create({type:"leaf"})}create(){return lO(this,arguments,void 0,function*(t={}){var r,n;const a=t.parentId===void 0?Lbe(this):t.parentId,i=(r=t.index)!==null&&r!==void 0?r:Dbe(this),s=(n=t.type)!==null&&n!==void 0?n:"leaf",l=yield La(this.props.onCreate,{type:s,parentId:a,index:i,parentNode:this.get(a)});l&&(this.focus(l),setTimeout(()=>{this.edit(l).then(()=>{this.select(l),this.activate(l)})}))})}delete(t){return lO(this,void 0,void 0,function*(){if(!t)return;const n=(Array.isArray(t)?t:[t]).map(xc),a=n.map(i=>this.get(i)).filter(i=>!!i);yield La(this.props.onDelete,{nodes:a,ids:n})})}edit(t){const r=xc(t);return this.resolveEdit({cancelled:!0}),this.scrollTo(r),this.dispatch(YL(r)),new Promise(n=>{ry.editPromise=n})}submit(t,r){return lO(this,void 0,void 0,function*(){if(!t)return;const n=xc(t);yield La(this.props.onRename,{id:n,name:r,node:this.get(n)}),this.dispatch(YL(null)),this.resolveEdit({cancelled:!1,value:r}),setTimeout(()=>this.onFocus())})}reset(){this.dispatch(YL(null)),this.resolveEdit({cancelled:!0}),setTimeout(()=>this.onFocus())}activate(t){const r=this.get(Io(t));r&&La(this.props.onActivate,r)}resolveEdit(t){const r=ry.editPromise;r&&r(t),ry.editPromise=null}get selectedIds(){return this.state.nodes.selection.ids}get selectedNodes(){let t=[];for(let r of Array.from(this.selectedIds)){const n=this.get(r);n&&t.push(n)}return t}focus(t,r={}){t&&(this.props.selectionFollowsFocus?this.select(t):(this.dispatch(up(xc(t))),r.scroll!==!1&&this.scrollTo(t),this.focusedNode&&La(this.props.onFocus,this.focusedNode)))}pageUp(){var t,r;const n=this.visibleStartIndex,i=this.visibleStopIndex-n;let s=(r=(t=this.focusedNode)===null||t===void 0?void 0:t.rowIndex)!==null&&r!==void 0?r:0;s>n?s=n:s=Math.max(n-i,0),this.focus(this.at(s))}pageDown(){var t,r;const n=this.visibleStartIndex,a=this.visibleStopIndex,i=a-n;let s=(r=(t=this.focusedNode)===null||t===void 0?void 0:t.rowIndex)!==null&&r!==void 0?r:0;s<a?s=a:s=Math.min(s+i,this.visibleNodes.length-1),this.focus(this.at(s))}select(t,r={}){if(!t)return;const n=r.focus!==!1,a=xc(t);n&&this.dispatch(up(a)),this.dispatch(Oo.only(a)),this.dispatch(Oo.anchor(a)),this.dispatch(Oo.mostRecent(a)),this.scrollTo(a,r.align),this.focusedNode&&n&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes)}deselect(t){if(!t)return;const r=xc(t);this.dispatch(Oo.remove(r)),La(this.props.onSelect,this.selectedNodes)}selectMulti(t){const r=this.get(Io(t));r&&(this.dispatch(up(r.id)),this.dispatch(Oo.add(r.id)),this.dispatch(Oo.anchor(r.id)),this.dispatch(Oo.mostRecent(r.id)),this.scrollTo(r),this.focusedNode&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes))}selectContiguous(t){if(!t)return;const r=xc(t),{anchor:n,mostRecent:a}=this.state.nodes.selection;this.dispatch(up(r)),this.dispatch(Oo.remove(this.nodesBetween(n,a))),this.dispatch(Oo.add(this.nodesBetween(n,Io(r)))),this.dispatch(Oo.mostRecent(r)),this.scrollTo(r),this.focusedNode&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes)}deselectAll(){this.setSelection({ids:[],anchor:null,mostRecent:null}),La(this.props.onSelect,this.selectedNodes)}selectAll(){var t;this.setSelection({ids:Object.keys(this.idToIndex),anchor:this.firstNode,mostRecent:this.lastNode}),this.dispatch(up((t=this.lastNode)===null||t===void 0?void 0:t.id)),this.focusedNode&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes)}setSelection(t){var r;const n=new Set((r=t.ids)===null||r===void 0?void 0:r.map(xc)),a=Io(t.anchor),i=Io(t.mostRecent);this.dispatch(Oo.set({ids:n,anchor:a,mostRecent:i})),La(this.props.onSelect,this.selectedNodes)}get cursorParentId(){const{cursor:t}=this.state.dnd;switch(t.type){case"highlight":return t.id;default:return null}}get cursorOverFolder(){return this.state.dnd.cursor.type==="highlight"}get dragNodes(){return this.state.dnd.dragIds.map(t=>this.get(t)).filter(t=>!!t)}get dragNode(){return this.get(this.state.nodes.drag.id)}get dragDestinationParent(){return this.get(this.state.nodes.drag.destinationParentId)}get dragDestinationIndex(){return this.state.nodes.drag.destinationIndex}canDrop(){var t;if(this.isFiltered)return!1;const r=(t=this.get(this.state.dnd.parentId))!==null&&t!==void 0?t:this.root,n=this.dragNodes,a=this.props.disableDrop;for(const i of n)if(!i||!r||i.isInternal&&_be(r,i))return!1;return typeof a=="function"?!a({parentNode:r,dragNodes:this.dragNodes,index:this.state.dnd.index||0}):typeof a=="string"?!r.data[a]:typeof a=="boolean"?!a:!0}hideCursor(){this.dispatch(Gg.cursor({type:"none"}))}showCursor(t){this.dispatch(Gg.cursor(t))}open(t){const r=Io(t);r&&(this.isOpen(r)||(this.dispatch(u5.open(r,this.isFiltered)),La(this.props.onToggle,r)))}close(t){const r=Io(t);r&&this.isOpen(r)&&(this.dispatch(u5.close(r,this.isFiltered)),La(this.props.onToggle,r))}toggle(t){const r=Io(t);if(r)return this.isOpen(r)?this.close(r):this.open(r)}openParents(t){const r=Io(t);if(!r)return;const n=D$(this.root,r);let a=n?.parent;for(;a;)this.open(a.id),a=a.parent}openSiblings(t){const r=t.parent;if(!r)this.toggle(t.id);else if(r.children){const n=t.isOpen;for(let a of r.children)a.isInternal&&(n?this.close(a.id):this.open(a.id));this.scrollTo(this.focusedNode)}}openAll(){MC(this.root,t=>{t.isInternal&&t.open()})}closeAll(){MC(this.root,t=>{t.isInternal&&t.close()})}scrollTo(t,r="smart"){if(!t)return;const n=xc(t);return this.openParents(n),Abe(()=>n in this.idToIndex).then(()=>{var a;const i=this.idToIndex[n];i!==void 0&&((a=this.list.current)===null||a===void 0||a.scrollToItem(i,r))}).catch(()=>{})}get isEditing(){return this.state.nodes.edit.id!==null}get isFiltered(){var t;return!!(!((t=this.props.searchTerm)===null||t===void 0)&&t.trim())}get hasFocus(){return this.state.nodes.focus.treeFocused}get hasNoSelection(){return this.state.nodes.selection.ids.size===0}get hasOneSelection(){return this.state.nodes.selection.ids.size===1}get hasMultipleSelections(){return this.state.nodes.selection.ids.size>1}isSelected(t){return t?this.state.nodes.selection.ids.has(t):!1}isOpen(t){var r,n,a;if(!t)return!1;if(t===Cx)return!0;const i=(r=this.props.openByDefault)!==null&&r!==void 0?r:!0;return this.isFiltered?(n=this.state.nodes.open.filtered[t])!==null&&n!==void 0?n:!0:(a=this.state.nodes.open.unfiltered[t])!==null&&a!==void 0?a:i}isEditable(t){const r=this.props.disableEdit||(()=>!1);return!Cb(t,r)}isDraggable(t){const r=this.props.disableDrag||(()=>!1);return!Cb(t,r)}isDragging(t){const r=Io(t);return r?this.state.nodes.drag.id===r:!1}isFocused(t){return this.hasFocus&&this.state.nodes.focus.id===t}isMatch(t){return this.matchFn(t)}willReceiveDrop(t){const r=Io(t);if(!r)return!1;const{destinationParentId:n,destinationIndex:a}=this.state.nodes.drag;return r===n&&a===null}onFocus(){const t=this.focusedNode||this.firstNode;t&&this.dispatch(up(t.id))}onBlur(){this.dispatch(qgt())}onItemsRendered(t){this.visibleStartIndex=t.visibleStartIndex,this.visibleStopIndex=t.visibleStopIndex}get renderContainer(){return this.props.renderContainer||rye}get renderRow(){return this.props.renderRow||Bgt}get renderNode(){return this.props.children||$gt}get renderDragPreview(){return this.props.renderDragPreview||Obe}get renderCursor(){return this.props.renderCursor||zgt}}function pi(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var sxt=typeof Symbol=="function"&&Symbol.observable||"@@observable",ene=sxt,cO=()=>Math.random().toString(36).substring(7).split("").join("."),oxt={INIT:`@@redux/INIT${cO()}`,REPLACE:`@@redux/REPLACE${cO()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${cO()}`},DC=oxt;function lxt(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function aye(e,t,r){if(typeof e!="function")throw new Error(pi(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(pi(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(pi(1));return r(aye)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((y,S)=>{s.set(S,y)}))}function d(){if(c)throw new Error(pi(3));return a}function f(y){if(typeof y!="function")throw new Error(pi(4));if(c)throw new Error(pi(5));let S=!0;u();const _=l++;return s.set(_,y),function(){if(S){if(c)throw new Error(pi(6));S=!1,u(),s.delete(_),i=null}}}function m(y){if(!lxt(y))throw new Error(pi(7));if(typeof y.type>"u")throw new Error(pi(8));if(typeof y.type!="string")throw new Error(pi(17));if(c)throw new Error(pi(9));try{c=!0,a=n(a,y)}finally{c=!1}return(i=s).forEach(_=>{_()}),y}function p(y){if(typeof y!="function")throw new Error(pi(10));n=y,m({type:DC.REPLACE})}function v(){const y=f;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(pi(11));function _(){const k=S;k.next&&k.next(d())}return _(),{unsubscribe:y(_)}},[ene](){return this}}}return m({type:DC.INIT}),{dispatch:m,subscribe:f,getState:d,replaceReducer:p,[ene]:v}}function cxt(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:DC.INIT})>"u")throw new Error(pi(12));if(typeof r(void 0,{type:DC.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(pi(13))})}function tne(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{cxt(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],m=r[f],p=s[f],v=m(p,l);if(typeof v>"u")throw l&&l.type,new Error(pi(14));u[f]=v,c=c||v!==p}return c=c||n.length!==Object.keys(s).length,c?u:s}}function uxt(e=Kg().nodes.drag,t){switch(t.type){case"DND_DRAG_START":return Object.assign(Object.assign({},e),{id:t.id,selectedIds:t.dragIds});case"DND_DRAG_END":return Object.assign(Object.assign({},e),{id:null,destinationParentId:null,destinationIndex:null,selectedIds:[]});case"DND_HOVERING":return t.parentId!==e.destinationParentId||t.index!=e.destinationIndex?Object.assign(Object.assign({},e),{destinationParentId:t.parentId,destinationIndex:t.index}):e;default:return e}}const dxt=tne({nodes:tne({focus:Wgt,edit:Hgt,open:Kgt,selection:Ggt,drag:uxt}),dnd:Vgt}),fxt=Kg();function hxt({treeProps:e,imperativeHandle:t,children:r}){const n=w.useRef(null),a=w.useRef(null),i=w.useRef(aye(dxt,Kg(e))),s=Zz.useSyncExternalStore(i.current.subscribe,i.current.getState,()=>fxt),l=w.useMemo(()=>new ry(i.current,e,n,a),[]),c=w.useRef(0);return w.useMemo(()=>{c.current+=1,l.update(e)},[...Object.values(e),s.nodes.open]),w.useImperativeHandle(t,()=>l),w.useEffect(()=>{l.props.selection?l.select(l.props.selection,{focus:!1}):l.deselectAll()},[l.props.selection]),w.useEffect(()=>{l.props.searchTerm||i.current.dispatch(u5.clear(!0))},[l.props.searchTerm]),o.jsx(gbe.Provider,{value:l,children:o.jsx(ybe.Provider,{value:c.current,children:o.jsx(vbe.Provider,{value:s.nodes,children:o.jsx(bbe.Provider,{value:s.dnd,children:o.jsx(Yvt,Object.assign({backend:Qyt,options:{rootElement:l.props.dndRootElement||void 0}},e.dndManager&&{manager:e.dndManager},{children:r}))})})})})}function mxt(){const e=Hs(),[,t]=Gbe(()=>({accept:"NODE",canDrop:(r,n)=>n.isOver({shallow:!0})?e.canDrop():!1,hover:(r,n)=>{if(!n.isOver({shallow:!0}))return;const a=n.getClientOffset();if(!e.listEl.current||!a)return;const{cursor:i,drop:s}=tye({element:e.listEl.current,offset:a,indent:e.indent,node:null,prevNode:e.visibleNodes[e.visibleNodes.length-1],nextNode:null});s&&e.dispatch(Gg.hovering(s.parentId,s.index)),n.canDrop()?i&&e.showCursor(i):e.hideCursor()}}),[e]);t(e.listEl)}function pxt(e){return mxt(),e.children}function gxt(){const t=Hs().props.renderContainer||rye;return o.jsx(o.Fragment,{children:o.jsx(t,{})})}function vxt(){const e=Hs(),{offset:t,mouse:r,item:n,isDragging:a}=wyt(s=>({offset:s.getSourceClientOffset(),mouse:s.getClientOffset(),item:s.getItem(),isDragging:s.isDragging()})),i=e.props.renderDragPreview||Obe;return o.jsx(i,{offset:t,mouse:r,id:n?.id||null,dragIds:n?.dragIds||[],isDragging:a})}class bxt{constructor(t){this.root=yxt(t)}get data(){var t,r;return(r=(t=this.root.children)===null||t===void 0?void 0:t.map(n=>n.data))!==null&&r!==void 0?r:[]}create(t){const r=t.parentId?this.find(t.parentId):this.root;if(!r)return null;r.addChild(t.data,t.index)}move(t){const r=this.find(t.id),n=t.parentId?this.find(t.parentId):this.root;!r||!n||(n.addChild(r.data,t.index),r.drop())}update(t){const r=this.find(t.id);r&&r.update(t.changes)}drop(t){const r=this.find(t.id);r&&r.drop()}find(t,r=this.root){if(!r)return null;if(r.id===t)return r;if(r.children){for(let n of r.children){const a=this.find(t,n);if(a)return a}return null}return null}}function yxt(e){const t=new iye({id:"ROOT"},null);return t.children=e.map(r=>B$(r,t)),t}function B$(e,t){const r=new iye(e,t);return e.children&&(r.children=e.children.map(n=>B$(n,r))),r}class iye{constructor(t,r){this.data=t,this.parent=r,this.id=t.id}hasParent(){return!!this.parent}get childIndex(){return this.hasParent()?this.parent.children.indexOf(this):-1}addChild(t,r){var n,a;const i=B$(t,this);this.children=(n=this.children)!==null&&n!==void 0?n:[],this.children.splice(r,0,i),this.data.children=(a=this.data.children)!==null&&a!==void 0?a:[],this.data.children.splice(r,0,t)}removeChild(t){var r,n;(r=this.children)===null||r===void 0||r.splice(t,1),(n=this.data.children)===null||n===void 0||n.splice(t,1)}update(t){if(this.hasParent()){const r=this.childIndex;this.parent.addChild(Object.assign(Object.assign({},this.data),t),r),this.drop()}}drop(){this.hasParent()&&this.parent.removeChild(this.childIndex)}}let xxt=0;function wxt(e){const[t,r]=w.useState(e),n=w.useMemo(()=>new bxt(t),[t]);return[t,{onMove:u=>{for(const d of u.dragIds)n.move({id:d,parentId:u.parentId,index:u.index});r(n.data)},onRename:({name:u,id:d})=>{n.update({id:d,changes:{name:u}}),r(n.data)},onCreate:({parentId:u,index:d,type:f})=>{const m={id:`simple-tree-id-${xxt++}`,name:""};return f==="internal"&&(m.children=[]),n.create({parentId:u,index:d,data:m}),r(n.data),m},onDelete:u=>{u.ids.forEach(d=>n.drop({id:d})),r(n.data)}}]}function Sxt(e){if(e.initialData&&e.data)throw new Error("React Arborist Tree => Provide either a data or initialData prop, but not both.");if(e.initialData&&(e.onCreate||e.onDelete||e.onMove||e.onRename))throw new Error(`React Arborist Tree => You passed the initialData prop along with a data handler.
Use the data prop if you want to provide your own handlers.`);if(e.initialData){const[t,r]=wxt(e.initialData);return Object.assign(Object.assign(Object.assign({},e),r),{data:t})}else return e}function kxt(e,t){const r=Sxt(e);return o.jsxs(hxt,{treeProps:r,imperativeHandle:t,children:[o.jsx(pxt,{children:o.jsx(gxt,{})}),o.jsx(vxt,{})]})}const sye=w.forwardRef(kxt),oye=w.createContext({});function lye(e){return e.map(t=>({id:t.id,name:t.name,nodeType:"library",parentId:t.parentId,data:t,children:t.children.length>0?lye(t.children):void 0}))}function _xt({node:e,style:t,dragHandle:r}){const{onDeleteLibrary:n}=w.useContext(oye),a=e.isSelected,i=e.isOpen,s=!e.isLeaf,{isOver:l,setNodeRef:c}=M2({id:`library-drop-${e.id}`,data:{type:"library",id:e.id,name:e.data.name}});return o.jsx("div",{ref:c,"data-testid":`library-tree-item-${e.id}`,style:t,className:`relative ${l?"ring-2 ring-blue-400 ring-inset rounded":""}`,children:o.jsxs("div",{ref:r,className:`group flex items-center gap-1 px-2 py-1.5 rounded-md cursor-pointer transition-colors ${a?"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,onClick:u=>{u.stopPropagation(),e.select(),e.activate()},children:[o.jsx("button",{"data-testid":`library-toggle-${e.id}`,onClick:u=>{u.stopPropagation(),e.toggle()},className:"p-0.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded","aria-label":s?i?`Collapse ${e.data.name}`:`Expand ${e.data.name}`:"No children","aria-expanded":s?i:void 0,children:s?i?o.jsx(cr,{className:"w-4 h-4 text-gray-500"}):o.jsx(gn,{className:"w-4 h-4 text-gray-500"}):o.jsx("span",{className:"w-4 h-4","aria-hidden":"true"})}),i&&s?o.jsx(B6,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"}):o.jsx(a0,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"}),o.jsx("span",{"data-testid":`library-name-${e.id}`,className:"text-sm font-medium truncate flex-1",children:e.data.name}),n&&o.jsx("button",{"data-testid":`delete-library-button-${e.id}`,onClick:u=>{u.stopPropagation(),n(e.id)},className:"p-1 opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded transition-all",title:"Delete Library","aria-label":`Delete ${e.data.name}`,children:o.jsx(Sr,{className:"w-3.5 h-3.5"})})]})})}function Nxt({libraries:e,selectedLibraryId:t,expandedIds:r,onSelectLibrary:n,onToggleExpand:a,onNewDocument:i,onNewLibrary:s,onSelectDocument:l,onMoveLibrary:c,onReorderLibrary:u,onDeleteLibrary:d,activeDragData:f,isMobile:m=!1,compact:p=!1}){const v=w.useRef(null),b=w.useRef(null),[y,S]=w.useState(400);w.useEffect(()=>{if(!b.current)return;const M=new ResizeObserver(z=>{for(const I of z)S(I.contentRect.height)});return M.observe(b.current),()=>M.disconnect()},[]);const _=w.useMemo(()=>kgt(e),[e]),N=w.useMemo(()=>lye(_),[_]),k=w.useMemo(()=>{const M={};for(const z of r)M[z]=!0;return M},[r]),j=w.useCallback(M=>{M.length>0&&n(M[0].id)},[n]),E=w.useCallback(M=>{n(M.id)},[n]),T=w.useCallback(M=>{a(M)},[a]),O=w.useCallback(async({dragIds:M,parentId:z,parentNode:I,dragNodes:B,index:F})=>{const U=M[0];if(!U||U===z)return;const V=B[0];if(V&&I&&V.isAncestorOf(I)){console.warn("Cannot move library to its own descendant");return}(B[0]?.data.parentId??null)===z?u&&u(U,F):c&&c(U,z,F)},[c,u]),R=w.useCallback(({parentNode:M,dragNodes:z})=>{for(const I of z)if(I.isAncestorOf(M)||I.id===M.id)return!0;return!1},[]),{isOver:q,setNodeRef:$}=M2({id:"all-documents-drop",data:{type:"all-documents",id:null}}),L=f?.type==="document",A=w.useMemo(()=>({onDeleteLibrary:d}),[d]);return o.jsx(oye.Provider,{value:A,children:o.jsxs("div",{"data-testid":"library-tree",className:`${m?"w-full":p?"w-48 @3xl/docs:w-64 border-r border-gray-200 dark:border-[var(--color-border)]":"w-64 border-r border-gray-200 dark:border-[var(--color-border)]"} bg-white dark:bg-[var(--color-bg)] flex flex-col h-full`,children:[o.jsxs("div",{className:`${m?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h2",{className:`${m?"text-base":"text-lg"} font-semibold text-gray-900 dark:text-[var(--color-text)] flex items-center gap-2`,children:[o.jsx(Lwe,{className:`${m?"w-4 h-4":"w-5 h-5"} text-blue-500`}),"Libraries"]}),!m&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:s,className:"p-1.5 text-gray-500 hover:text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/30 rounded-md transition-colors",title:"New Library","data-testid":"new-library-button-sidebar",children:o.jsx(z6,{className:"w-4 h-4"})}),o.jsx("button",{onClick:i,className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-md transition-colors",title:"Create Document","data-testid":"new-document-button-sidebar",children:o.jsx(_r,{className:"w-4 h-4"})})]})]}),o.jsx(_gt,{onSelectDocument:l})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx("div",{className:"p-2 pb-0",children:o.jsxs("button",{ref:$,onClick:()=>n(null),className:`w-full flex items-center gap-2 ${m?"px-3 py-3":"px-3 py-2"} rounded-md text-left text-sm mb-2 transition-all ${t===null?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"} ${m?"touch-target":""} ${q&&L?"ring-2 ring-blue-400":""}`,"data-testid":"all-documents-button",children:[o.jsx(rn,{className:"w-4 h-4"}),"All Documents",q&&L&&o.jsx("span",{className:"ml-auto text-xs text-blue-500",children:"Drop to remove from library"})]})}),e.length===0?o.jsxs("div",{"data-testid":"library-empty-state",className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx(a0,{className:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{className:"text-sm",children:"No libraries yet"}),o.jsx("button",{onClick:s,className:"mt-2 text-sm text-purple-600 dark:text-purple-400 hover:underline","data-testid":"new-library-button-empty",children:"Create one"})]}):o.jsx("div",{ref:b,"data-testid":"library-list",className:"flex-1 overflow-hidden px-2",children:o.jsx(sye,{ref:v,data:N,width:"100%",height:y,rowHeight:m?44:igt,indent:16,paddingTop:4,paddingBottom:4,initialOpenState:k,selection:t??void 0,onSelect:j,onActivate:E,onToggle:T,onMove:O,disableDrop:R,disableMultiSelection:!0,openByDefault:!1,children:_xt})})]}),!m&&o.jsxs("div",{"data-testid":"library-count",className:"p-3 border-t border-gray-200 dark:border-[var(--color-border)] text-xs text-gray-500 dark:text-gray-400",children:[e.length," ",e.length===1?"library":"libraries"]})]})})}function Cxt({libraryId:e,selectedDocumentId:t,onSelectDocument:r,onSelectLibrary:n,onNewDocument:a,onDeleteLibrary:i,isMobile:s=!1}){const[l,c]=w.useState(""),[u,d]=w.useState(!1),[f,m]=w.useState("updatedAt"),[p,v]=w.useState("desc"),[b,y]=w.useState(Ob),{data:S,isLoading:_}=mbe(e),{data:N=[],isLoading:k,error:j}=lgt(e);Jx(),w.useEffect(()=>{const z=yce();m(z.field),v(z.direction)},[]),w.useEffect(()=>{y(Ob),c("")},[e]);const E=z=>{m(z),rN(z,p)},T=z=>{v(z),rN(f,z)},O=()=>{y(Ob)},R=_||k,q=w.useMemo(()=>[...N,...S?._documents||[]].filter((z,I,B)=>I===B.findIndex(F=>F.id===z.id)),[N,S?._documents]),$=w.useMemo(()=>{const z=new Set;return q.forEach(I=>{(I.tags||[]).forEach(B=>z.add(B))}),Array.from(z).sort()},[q]),L=w.useMemo(()=>{const z=xce(b,l),I=q.filter(z);return Dme(I,{field:f,direction:p})},[q,l,b,f,p]),A=Zx(b),M=w.useCallback(z=>o.jsx("div",{className:"px-4",children:o.jsx(pbe,{document:z,isSelected:t===z.id,onClick:r,libraryId:e,draggable:!0})}),[t,r,e]);return o.jsxs("div",{"data-testid":"library-view",className:"h-full flex flex-col bg-white dark:bg-[var(--color-bg)]",children:[o.jsxs("div",{"data-testid":"library-header",className:`flex-shrink-0 ${s?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:`flex items-center ${s?"gap-2":"gap-3"} min-w-0`,children:[o.jsx(B6,{className:`${s?"w-5 h-5":"w-6 h-6"} text-yellow-500 flex-shrink-0`}),S?o.jsxs(o.Fragment,{children:[o.jsx("h3",{"data-testid":"library-name",className:`font-semibold text-gray-900 dark:text-[var(--color-text)] ${s?"text-base":"text-lg"} truncate`,children:S.name}),o.jsxs("span",{"data-testid":"library-doc-count",className:`text-gray-400 dark:text-gray-500 flex-shrink-0 ${s?"text-xs":"text-sm"}`,children:[L.length," ",L.length===1?"doc":"docs"]})]}):o.jsx("div",{className:"animate-pulse h-6 w-32 bg-gray-200 dark:bg-gray-700 rounded"})]}),!s&&o.jsxs("div",{className:"flex items-center gap-2",children:[i&&o.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-colors",title:"Delete Library","data-testid":"delete-library-button",children:o.jsx(Sr,{className:"w-4 h-4"})}),o.jsxs("button",{onClick:a,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] rounded-md transition-colors","data-testid":"new-document-button-library",children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Document",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:Pl("action.createDocument")})]})]})]}),S?.description&&o.jsx("p",{"data-testid":"library-description",className:`mt-2 text-sm text-gray-600 dark:text-gray-400 ${s?"line-clamp-2":""}`,children:S.description}),o.jsxs("div",{className:"mt-3 relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:l,onChange:z=>c(z.target.value),placeholder:"Search documents...",className:`w-full pl-9 pr-4 ${s?"py-3":"py-2"} text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,"data-testid":"library-search-input"})]}),o.jsx("div",{className:"mt-3",children:s?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(nN,{sortField:f,sortDirection:p,onSortFieldChange:E,onSortDirectionChange:T}),o.jsxs("button",{onClick:()=>d(!0),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${nh(b)?"text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50":"text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800"}`,"data-testid":"mobile-filter-button",children:[o.jsx(ru,{className:"w-4 h-4"}),"Filters",A>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold bg-blue-600 text-white rounded-full",children:A})]})]}):o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(nN,{sortField:f,sortDirection:p,onSortFieldChange:E,onSortDirectionChange:T}),o.jsx("div",{className:"flex-1",children:o.jsx(wce,{filters:b,onFilterChange:y,onClearFilters:O,availableTags:$})})]})})]}),S?._subLibraries&&S._subLibraries.length>0&&o.jsxs("div",{"data-testid":"sub-libraries",className:`flex-shrink-0 ${s?"p-3":"p-4"} border-b border-gray-100 dark:border-gray-800`,children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Sub-libraries"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:S._subLibraries.map(z=>o.jsxs("button",{"data-testid":`sub-library-${z.id}`,onClick:()=>n(z.id),className:`flex items-center gap-1.5 ${s?"px-2.5 py-2":"px-3 py-1.5"} bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded-md text-sm hover:bg-yellow-100 dark:hover:bg-yellow-900/50 transition-colors cursor-pointer ${s?"touch-target":""}`,children:[o.jsx(a0,{className:"w-4 h-4"}),z.name]},z.id))})]}),o.jsx("div",{"data-testid":"documents-container",className:"flex-1 min-h-0",children:R?o.jsx("div",{"data-testid":"documents-loading",className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"Loading documents..."}):j?o.jsx("div",{"data-testid":"documents-error",className:"flex items-center justify-center h-full text-red-500 dark:text-red-400",children:"Failed to load documents"}):L.length===0?o.jsxs("div",{"data-testid":"documents-empty",className:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 px-4",children:[o.jsx(rn,{className:"w-12 h-12 mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{className:"text-sm",children:l||nh(b)?"No documents match your search or filters":"No documents in this library"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:l||nh(b)?"Try adjusting your search or filters":"Add documents to organize your knowledge"})]}):o.jsx(j1,{items:L,getItemKey:z=>z.id,estimateSize:s?72:hbe,renderItem:M,overscan:5,className:"h-full pt-2",scrollRestoreId:`library-documents-${e}`,testId:"virtualized-documents-list",gap:s?4:8})}),s&&o.jsx(Sce,{open:u,onClose:()=>d(!1),filters:b,onFilterChange:y,onClearFilters:O,availableTags:$})]})}function jxt({selectedDocumentId:e,onSelectDocument:t,onNewDocument:r,isMobile:n=!1}){const[a,i]=w.useState(""),[s,l]=w.useState(!1),[c,u]=w.useState("updatedAt"),[d,f]=w.useState("desc"),[m,p]=w.useState(Ob);Jx(),w.useEffect(()=>{const R=yce();u(R.field),f(R.direction)},[]);const v=R=>{u(R),rN(R,d)},b=R=>{f(R),rN(c,R)},y=()=>{p(Ob)},{data:S,isLoading:_}=MB(),N=w.useMemo(()=>{if(!S)return[];const R=S,q=new Set;return R.forEach($=>{($.tags||[]).forEach(L=>q.add(L))}),Array.from(q).sort()},[S]),k=w.useMemo(()=>{if(!S)return[];const R=S,q=xce(m,a),$=R.filter(q);return Dme($,{field:c,direction:d})},[S,a,m,c,d]),j=k.length,E=_,T=Zx(m),O=w.useCallback(R=>o.jsx("div",{className:`${n?"px-3":"px-4"}`,children:o.jsx(pbe,{document:R,isSelected:e===R.id,onClick:t,libraryId:null,draggable:!0})}),[e,t,n]);return o.jsxs("div",{"data-testid":"all-documents-view",className:"h-full flex flex-col bg-white dark:bg-[var(--color-bg)]",children:[o.jsxs("div",{"data-testid":"all-documents-header",className:`flex-shrink-0 ${n?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:`flex items-center ${n?"gap-2":"gap-3"} min-w-0`,children:[o.jsx(rn,{className:`${n?"w-5 h-5":"w-6 h-6"} text-blue-400 flex-shrink-0`}),o.jsx("h3",{className:`font-semibold text-gray-900 dark:text-[var(--color-text)] ${n?"text-base":"text-lg"}`,children:"All Documents"}),o.jsxs("span",{className:`text-gray-500 dark:text-gray-400 ${n?"text-xs":"text-sm"}`,"data-testid":"all-documents-count",children:[j," ",j===1?"doc":"docs"]})]}),!n&&o.jsxs("button",{onClick:r,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] rounded-md transition-colors","data-testid":"new-document-button-all",children:[o.jsx(_r,{className:"w-4 h-4"}),"Create Document",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:Pl("action.createDocument")})]})]}),o.jsxs("div",{className:"mt-3 relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:a,onChange:R=>i(R.target.value),placeholder:"Search documents...",className:`w-full pl-9 pr-4 ${n?"py-3":"py-2"} text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,"data-testid":"documents-search-input"})]}),o.jsx("div",{className:"mt-3",children:n?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(nN,{sortField:c,sortDirection:d,onSortFieldChange:v,onSortDirectionChange:b}),o.jsxs("button",{onClick:()=>l(!0),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${nh(m)?"text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50":"text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800"}`,"data-testid":"mobile-filter-button",children:[o.jsx(ru,{className:"w-4 h-4"}),"Filters",T>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold bg-blue-600 text-white rounded-full",children:T})]})]}):o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(nN,{sortField:c,sortDirection:d,onSortFieldChange:v,onSortDirectionChange:b}),o.jsx("div",{className:"flex-1",children:o.jsx(wce,{filters:m,onFilterChange:p,onClearFilters:y,availableTags:N})})]})})]}),o.jsx("div",{"data-testid":"all-documents-container",className:"flex-1 min-h-0",children:E?o.jsx("div",{"data-testid":"all-documents-loading",className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"Loading documents..."}):k.length===0?o.jsxs("div",{"data-testid":"all-documents-empty",className:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 px-4",children:[o.jsx(rn,{className:"w-12 h-12 mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{className:"text-sm text-center",children:a||nh(m)?"No documents match your search or filters":"No documents yet"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 text-center",children:a||nh(m)?"Try adjusting your search or filters":"Create documents to build your knowledge base"})]}):o.jsx(j1,{items:k,getItemKey:R=>R.id,estimateSize:n?72:hbe,renderItem:O,overscan:5,className:"h-full pt-2",scrollRestoreId:"all-documents-scroll",testId:"virtualized-all-documents-list",gap:n?4:8})}),n&&o.jsx(Sce,{open:s,onClose:()=>l(!1),filters:m,onFilterChange:p,onClearFilters:y,availableTags:N})]})}function uO({documentId:e,onClose:t,isExpanded:r=!1,onToggleExpand:n,isFullscreen:a=!1,onEnterFullscreen:i,onExitFullscreen:s,onDocumentCloned:l,libraryId:c,onNavigateToDocument:u,isMobile:d=!1}){const{data:f,isLoading:m,isError:p,error:v}=cgt(e),b=ugt(),y=mgt(),[S,_]=w.useState(!1),[N,k]=w.useState(""),[j,E]=w.useState(""),[T,O]=w.useState(!1),[R,q]=w.useState(null),{data:$}=fgt(R?e:null,R),L=()=>{f&&(k(f.content||""),E(f.title||""),_(!0))},A=()=>{_(!1),k(""),E("")},M=async()=>{if(!f)return;const F={};if(j!==(f.title||"")&&(F.title=j),N!==(f.content||"")&&(F.content=N),Object.keys(F).length>0)try{await b.mutateAsync({id:e,updates:F}),_(!1)}catch{}else _(!1)},z=async()=>{if(f)try{const F=await y.mutateAsync({id:e,createdBy:f.createdBy,libraryId:c||void 0});F?.id&&l&&l({id:F.id})}catch{}};if(m)return o.jsx("div",{"data-testid":"document-detail-loading",className:"h-full flex items-center justify-center bg-white dark:bg-[var(--color-bg)]",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading document..."})});if(p)return o.jsxs("div",{"data-testid":"document-detail-error",className:"h-full flex flex-col items-center justify-center bg-white dark:bg-[var(--color-bg)] px-4",children:[o.jsx("div",{className:"text-red-600 dark:text-red-400 mb-2",children:"Failed to load document"}),o.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:v?.message})]});if(!f)return o.jsx("div",{"data-testid":"document-detail-not-found",className:"h-full flex items-center justify-center bg-white dark:bg-[var(--color-bg)]",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Document not found"})});const I=f.title||`Document ${f.id}`,B=ire[f.contentType]||ire.text;return o.jsxs("div",{"data-testid":"document-detail-panel",className:`h-full flex flex-col bg-white dark:bg-[var(--color-bg)] ${d?"":"border-l border-gray-200 dark:border-[var(--color-border)]"}`,children:[o.jsxs("div",{className:`flex items-start justify-between ${d?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{"data-testid":"document-detail-type",className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded ${B.color}`,children:[B.icon,B.label]}),f.version!==void 0&&o.jsxs("span",{"data-testid":"document-detail-version",className:"text-xs text-gray-500",children:["v",f.version]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[f.metadata?.icon&&o.jsx("span",{className:"text-2xl","data-testid":"document-detail-icon",children:f.metadata.icon}),S?o.jsx("input",{type:"text",value:j,onChange:F=>E(F.target.value),"data-testid":"document-title-input",className:"text-lg font-semibold text-gray-900 flex-1 border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Document title"}):o.jsx("h2",{"data-testid":"document-detail-title",className:"text-lg font-semibold text-gray-900 truncate",children:I})]}),o.jsx("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 font-mono",children:o.jsx("span",{"data-testid":"document-detail-id",children:f.id})}),o.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-xs text-gray-500",children:[o.jsxs("div",{className:"flex items-center gap-1",title:l5(R!==null&&$?$.createdAt:f.createdAt),children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsxs("span",{children:["Created ",c5(R!==null&&$?$.createdAt:f.createdAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1",title:l5(R!==null&&$?$.updatedAt:f.updatedAt),children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsxs("span",{children:["Updated ",c5(R!==null&&$?$.updatedAt:f.updatedAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Zr,{className:"w-3 h-3"}),o.jsx("span",{className:"font-mono",children:f.createdBy})]})]})]}),o.jsxs("div",{className:`flex items-center ${d?"gap-0.5":"gap-1"} ml-2`,children:[S?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:M,disabled:b.isPending,"data-testid":"document-save-button",className:`${d?"p-2 touch-target":"p-1.5"} text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-900/30 rounded disabled:opacity-50`,"aria-label":"Save changes",title:"Save (Cmd+S)",children:o.jsx(XC,{className:"w-5 h-5"})}),o.jsx("button",{onClick:A,disabled:b.isPending,"data-testid":"document-cancel-button",className:`${d?"p-2 touch-target":"p-1.5"} text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/30 rounded disabled:opacity-50`,"aria-label":"Cancel editing",children:o.jsx(oi,{className:"w-5 h-5"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:L,disabled:R!==null,"data-testid":"document-edit-button",className:`${d?"p-2 touch-target":"p-1.5"} text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded disabled:opacity-50 disabled:cursor-not-allowed`,"aria-label":"Edit document",title:R!==null?"Exit preview to edit":"Edit document",children:o.jsx(EO,{className:"w-5 h-5"})}),!d&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:z,disabled:y.isPending||R!==null,"data-testid":"document-clone-button",className:"p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Clone document",title:R!==null?"Exit preview to clone":"Clone document",children:o.jsx(ej,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>O(!T),"data-testid":"document-history-button",className:`p-1.5 rounded ${T?"text-blue-600 bg-blue-50 dark:bg-blue-900/30":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,"aria-label":T?"Hide version history":"Show version history",title:"Version history",children:o.jsx(Xf,{className:"w-5 h-5"})})]})]}),!d&&n&&!a&&o.jsx("button",{onClick:n,"data-testid":"document-expand-button",className:`p-1.5 rounded ${r?"text-blue-600 bg-blue-50 dark:bg-blue-900/30":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,"aria-label":r?"Collapse document":"Expand document",title:r?"Show document list":"Hide document list",children:r?o.jsx(D6,{className:"w-5 h-5"}):o.jsx(JC,{className:"w-5 h-5"})}),!d&&a?o.jsx("button",{onClick:s,"data-testid":"document-fullscreen-button",className:"p-1.5 rounded text-blue-600 bg-blue-50 dark:bg-blue-900/30","aria-label":"Exit fullscreen",title:"Exit fullscreen (Escape)",children:o.jsx(Owe,{className:"w-5 h-5"})}):!d&&i&&o.jsx("button",{onClick:i,"data-testid":"document-fullscreen-button",className:"p-1.5 rounded text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800","aria-label":"Enter fullscreen",title:"Focus mode (fullscreen)",children:o.jsx(Iwe,{className:"w-5 h-5"})}),!d&&o.jsx("button",{onClick:a?s:t,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded","aria-label":a?"Exit fullscreen":"Close panel","data-testid":"document-detail-close",children:o.jsx(wt,{className:"w-5 h-5"})})]})]}),b.isError&&o.jsx("div",{"data-testid":"document-update-error",className:`${d?"mx-3":"mx-4"} mt-2 p-2 bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-sm rounded`,children:b.error?.message||"Failed to save document"}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:`flex-1 overflow-y-auto ${d?"p-3":"p-4"}`,children:[R!==null&&$&&o.jsxs("div",{"data-testid":"document-preview-banner",className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(du,{className:"w-4 h-4 text-blue-600"}),o.jsxs("span",{className:"text-sm text-blue-800",children:["Previewing version ",R]})]}),o.jsx("button",{onClick:()=>q(null),"data-testid":"exit-preview-button",className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Exit Preview"})]}),o.jsx("div",{"data-testid":"document-content",className:"mb-6",children:S?o.jsx("textarea",{value:N,onChange:F=>k(F.target.value),"data-testid":"document-content-textarea",className:"w-full min-h-[300px] p-3 border border-gray-300 rounded-lg font-mono text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter document content..."}):o.jsx(Cgt,{content:R!==null&&$?$.content||"":f.content||"",contentType:R!==null&&$?$.contentType:f.contentType})}),!R&&o.jsx("div",{className:"mb-6",children:o.jsx(Y6e,{tags:f.tags||[],onTagsChange:async F=>{try{await b.mutateAsync({id:e,updates:{tags:F}})}catch{}},disabled:b.isPending})}),!R&&u&&o.jsx(Mgt,{documentId:e,onNavigateToDocument:u})]}),T&&o.jsx(jgt,{documentId:e,currentVersion:f.version||1,onPreviewVersion:q,previewingVersion:R,onClose:()=>{O(!1),q(null)}})]})]})}function rne({isOpen:e,documentName:t,libraryName:r,isLoading:n=!1,onConfirm:a,onCancel:i}){return o.jsx(yie,{open:e,onOpenChange:s=>!s&&i(),children:o.jsxs($6,{children:[o.jsx(tj,{className:"fixed inset-0 bg-black/40 z-50"}),o.jsxs(rj,{"data-testid":"move-to-top-level-dialog",className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 w-full max-w-md p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center",children:o.jsx(Bn,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-500"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx(nj,{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Move to All Documents?"}),o.jsxs(U6,{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:[o.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:['"',t,'"']})," ","will be removed from"," ",o.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:['"',r,'"']})," ","and moved to the top-level documents list."]})]}),o.jsx(F6,{asChild:!0,children:o.jsx("button",{className:"flex-shrink-0 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Close",children:o.jsx(wt,{className:"w-5 h-5"})})})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:i,disabled:n,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors disabled:opacity-50","data-testid":"cancel-move-button",children:"Cancel"}),o.jsx("button",{onClick:a,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"confirm-move-button",children:n?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Moving..."]}):"Move to All Documents"})]})]})]})})}function Ext(){const e=Ma(),t=rl({from:"/documents"}),r=jo();Jx();const n=ht(),{data:a=[],isLoading:i,error:s}=ogt(),[l,c]=w.useState(t.library??null),[u,d]=w.useState(t.selected??null),[f,m]=w.useState(!1),[p,v]=w.useState(!1),[b,y]=w.useState(!1),[S,_]=w.useState(null),[N,k]=w.useState(null),{data:j}=mbe(S||""),E=j?._documents?.length||0,T=Ct({mutationFn:async({libraryId:ze,cascade:bt})=>{const tt=await fetch(`/api/libraries/${ze}?cascade=${bt}`,{method:"DELETE"});if(!tt.ok){const _e=await tt.json();throw new Error(_e.error?.message||"Failed to delete library")}return tt.json()},onSuccess:()=>{n.invalidateQueries({queryKey:["libraries"]}),n.invalidateQueries({queryKey:["documents"]}),y(!1),S===l&&c(null),_(null),k(null),Kr.success("Library deleted successfully")},onError:ze=>{k(ze.message),Kr.error(ze.message||"Failed to delete library")}}),[O,R]=w.useState(!1),[q,$]=w.useState(!1),[L,A]=w.useState(!1),[M,z]=w.useState(new Set),[I,B]=w.useState(null),[F,U]=w.useState(null),V=ygt(),K=xgt(),G=wgt(),J=Sgt(),ee=IB(dx(x1,{activationConstraint:{distance:8}}));w.useEffect(()=>{q||(localStorage.getItem("document.expanded")==="true"&&R(!0),$(!0))},[q]);const Y=ze=>{R(bt=>{const tt=typeof ze=="function"?ze(bt):ze;return localStorage.setItem("document.expanded",tt.toString()),tt})};w.useEffect(()=>{const ze=bt=>{bt.key==="Escape"&&L&&A(!1)};return document.addEventListener("keydown",ze),()=>document.removeEventListener("keydown",ze)},[L]);const{data:ie}=MB(),fe=jZe({data:ie,selectedId:t.selected,currentPage:1,pageSize:1e3,getId:ze=>ze.id,routePath:"/documents",rowTestIdPrefix:"document-item-",autoNavigate:!1,highlightDelay:200});w.useEffect(()=>{t.selected&&t.selected!==u&&d(t.selected),!t.selected&&u&&d(null),t.library&&t.library!==l&&c(t.library),!t.library&&l&&c(null)},[t.selected,t.library]);const me=ze=>{z(bt=>{const tt=new Set(bt);return tt.has(ze)?tt.delete(ze):tt.add(ze),tt})},te=ze=>{const bt=a.find(We=>We.id===ze);if(!bt)return;const tt=[];let _e=bt;for(;_e.parentId;){tt.push(_e.parentId);const We=a.find(Ve=>Ve.id===_e.parentId);if(!We)break;_e=We}tt.length>0&&z(We=>{const Ve=new Set(We);for(const Mt of tt)Ve.add(Mt);return Ve})},oe=ze=>{c(ze),d(null),Y(!1),ze&&te(ze)},ce=ze=>{d(ze),e({to:"/documents",search:{selected:ze,library:l??void 0}})},Z=()=>{d(null),e({to:"/documents",search:{selected:void 0,library:l??void 0}})},ue=()=>{m(!0)},H=()=>{m(!1)},ge=()=>{v(!0)},de=()=>{v(!1)},re=ze=>{c(ze.id)},ne=ze=>{d(ze.id)},pe=()=>{d(null),e({to:"/documents",search:{selected:void 0,library:l??void 0}})},ke=ze=>{k(null),_(ze||l),y(!0)},we=()=>{y(!1),_(null),k(null)},ve=async ze=>{S&&await T.mutateAsync({libraryId:S,cascade:ze})},Le=w.useCallback(async(ze,bt,tt)=>{try{await G.mutateAsync({libraryId:ze,parentId:bt,index:tt}),Kr.success("Library moved successfully")}catch(_e){Kr.error(_e.message||"Failed to move library")}},[G]),Ae=w.useCallback(async(ze,bt)=>{try{await J.mutateAsync({libraryId:ze,index:bt})}catch(tt){Kr.error(tt.message||"Failed to reorder library")}},[J]),Re=w.useCallback(ze=>{const bt=ze.active.data.current;bt&&B(bt)},[]),Ye=w.useCallback(ze=>{},[]),mt=w.useCallback(async ze=>{const{active:bt,over:tt}=ze;if(B(null),!tt)return;const _e=bt.data.current;if(!_e||_e.type!=="document")return;const We=tt.data.current;if(!We)return;const Ve=_e.id,Mt=_e.sourceLibraryId;if(We.type==="library"&&We.id){const kt=We.id;if(Mt===kt)return;try{await V.mutateAsync({documentId:Ve,libraryId:kt}),Kr.success(`Moved "${_e.name}" to "${We.name}"`)}catch(er){Kr.error(er.message||"Failed to move document")}}if(We.type==="all-documents"){if(!Mt){Kr.info("Document is already at top-level");return}const kt=a.find(er=>er.id===Mt);U({documentId:Ve,documentName:_e.name,libraryName:kt?.name||"Unknown Library"})}},[V,a]),ot=w.useCallback(async()=>{if(F)try{await K.mutateAsync({documentId:F.documentId}),Kr.success(`"${F.documentName}" moved to All Documents`)}catch(ze){Kr.error(ze.message||"Failed to move document")}finally{U(null)}},[F,K]),Ot=w.useCallback(()=>{U(null)},[]);if(s)return o.jsx("div",{"data-testid":"documents-page-error",className:"flex items-center justify-center h-full px-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-red-500 mb-2",children:"Failed to load libraries"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.message})]})});const rt=(ze=!1)=>l?o.jsx(Cxt,{libraryId:l,selectedDocumentId:u,onSelectDocument:ce,onSelectLibrary:oe,onNewDocument:ue,onDeleteLibrary:ke,isMobile:ze}):o.jsx(jxt,{selectedDocumentId:u,onSelectDocument:ce,onNewDocument:ue,isMobile:ze});return r?o.jsxs(mC,{sensors:ee,onDragStart:Re,onDragOver:Ye,onDragEnd:mt,children:[o.jsxs("div",{"data-testid":"documents-page",className:"flex flex-col h-full relative",children:[!u&&o.jsxs(o.Fragment,{children:[i?o.jsx("div",{"data-testid":"libraries-loading",className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."})}):o.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:rt(!0)}),o.jsx("button",{onClick:ue,className:"fixed bottom-20 right-4 w-14 h-14 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors z-30 touch-target","data-testid":"mobile-create-document-fab","aria-label":"Create new document",children:o.jsx(_r,{className:"w-6 h-6"})})]}),u&&o.jsx(Zpt,{open:!0,onClose:pe,title:"Document","data-testid":"mobile-document-sheet",children:fe.notFound?o.jsx(rre,{elementType:"Document",elementId:u,backRoute:"/documents",backLabel:"Back to Documents",onDismiss:pe}):o.jsx("div",{className:"h-full",children:o.jsx(uO,{documentId:u,onClose:pe,isExpanded:!0,isFullscreen:!1,onDocumentCloned:ne,libraryId:l,onNavigateToDocument:ce,isMobile:!0})})}),o.jsx(nre,{isOpen:f,onClose:H,onSuccess:ne,defaultLibraryId:l||void 0,isMobile:!0}),o.jsx(are,{isOpen:p,onClose:de,onSuccess:re,defaultParentId:l||void 0}),o.jsx(rne,{isOpen:!!F,documentName:F?.documentName||"",libraryName:F?.libraryName||"",isLoading:K.isPending,onConfirm:ot,onCancel:Ot}),o.jsx(VY,{isOpen:b,onClose:we,onConfirm:ve,library:S&&j?{id:S,name:j.name}:null,documentCount:E,isDeleting:T.isPending,error:N,isMobile:!0})]}),o.jsx(pC,{children:I&&o.jsx(ore,{data:I})})]}):o.jsxs(mC,{sensors:ee,onDragStart:Re,onDragOver:Ye,onDragEnd:mt,children:[o.jsxs("div",{"data-testid":"documents-page",className:"flex h-full @container/docs",children:[L&&u&&o.jsx("div",{"data-testid":"document-fullscreen-panel",className:"fixed inset-0 z-50 bg-white dark:bg-gray-900 flex flex-col",children:o.jsx(uO,{documentId:u,onClose:()=>A(!1),isExpanded:!0,onToggleExpand:()=>A(!1),isFullscreen:!0,onExitFullscreen:()=>A(!1),onDocumentCloned:ne,libraryId:l,onNavigateToDocument:ce})}),!L&&o.jsx(o.Fragment,{children:i?o.jsx("div",{"data-testid":"libraries-loading",className:"w-48 @3xl/docs:w-64 shrink-0 border-r border-gray-200 dark:border-[var(--color-border)] flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading libraries..."})}):o.jsx("div",{"data-testid":"library-tree-sidebar",className:"shrink-0",children:o.jsx(Nxt,{libraries:a,selectedLibraryId:l,expandedIds:M,onSelectLibrary:oe,onToggleExpand:me,onNewDocument:ue,onNewLibrary:ge,onSelectDocument:ce,onMoveLibrary:Le,onReorderLibrary:Ae,onDeleteLibrary:ke,activeDragData:I,compact:!0})})}),!L&&o.jsxs("div",{className:"flex-1 min-w-0 flex overflow-hidden",children:[(!u||!O)&&o.jsx("div",{className:`${u?"flex-1 min-w-0 border-r border-gray-200 dark:border-[var(--color-border)]":"flex-1 min-w-0"} h-full overflow-hidden`,children:rt()}),u&&o.jsx("div",{className:"flex-1 min-w-0 flex-shrink-0 overflow-hidden",children:fe.notFound?o.jsx(rre,{elementType:"Document",elementId:u,backRoute:"/documents",backLabel:"Back to Documents",onDismiss:Z}):o.jsx(uO,{documentId:u,onClose:Z,isExpanded:O,onToggleExpand:()=>Y(!O),isFullscreen:!1,onEnterFullscreen:()=>A(!0),onDocumentCloned:ne,libraryId:l,onNavigateToDocument:ce})})]}),o.jsx(nre,{isOpen:f,onClose:H,onSuccess:ne,defaultLibraryId:l||void 0}),o.jsx(are,{isOpen:p,onClose:de,onSuccess:re,defaultParentId:l||void 0}),o.jsx(rne,{isOpen:!!F,documentName:F?.documentName||"",libraryName:F?.libraryName||"",isLoading:K.isPending,onConfirm:ot,onCancel:Ot}),o.jsx(VY,{isOpen:b,onClose:we,onConfirm:ve,library:S&&j?{id:S,name:j.name}:null,documentCount:E,isDeleting:T.isPending,error:N,isMobile:r})]}),o.jsx(pC,{children:I&&o.jsx(ore,{data:I})})]})}function cye({task:e,onDeleted:t}){const[r,n]=w.useState(!1),[a,i]=w.useState(!1),[s,l]=w.useState(!1),c=w.useRef(null),u=w.useRef(void 0),d=FJe(),f=UJe(),m=e.metadata?.orchestrator?.mergeStatus;w.useEffect(()=>{const N=k=>{c.current&&!c.current.contains(k.target)&&(n(!1),i(!1))};if(r)return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[r]),w.useEffect(()=>{const N=k=>{k.key==="Escape"&&(n(!1),i(!1),l(!1))};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[]),w.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]);const p=()=>{clearTimeout(u.current),i(!0)},v=()=>{u.current=setTimeout(()=>i(!1),150)},b=async N=>{try{await d.mutateAsync({taskId:e.id,mergeStatus:N}),n(!1),i(!1)}catch(k){console.error("Failed to update merge status:",k)}},y=async()=>{try{await f.mutateAsync({taskId:e.id,reason:"Deleted via merge request page"}),l(!1),n(!1),t?.()}catch(N){console.error("Failed to delete merge request:",N)}},S=N=>{switch(N){case"pending":return o.jsx(tn,{className:"w-4 h-4 text-amber-500"});case"testing":return o.jsx(O6,{className:"w-4 h-4 text-blue-500"});case"merging":return o.jsx(Ri,{className:"w-4 h-4 text-blue-600"});case"merged":return o.jsx(Yn,{className:"w-4 h-4 text-green-500"});case"conflict":return o.jsx(Bn,{className:"w-4 h-4 text-red-500"});case"test_failed":return o.jsx(oi,{className:"w-4 h-4 text-orange-500"});case"failed":return o.jsx(oi,{className:"w-4 h-4 text-red-500"});case"not_applicable":return o.jsx(WC,{className:"w-4 h-4 text-gray-500"});default:return o.jsx(tn,{className:"w-4 h-4 text-gray-400"})}},_=HJe();return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",ref:c,children:[o.jsx("button",{onClick:N=>{N.stopPropagation(),n(!r)},className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Manage merge request","data-testid":"merge-request-manage-btn",children:o.jsx(n0,{className:"w-4 h-4"})}),r&&o.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg z-50 py-1","data-testid":"merge-request-manage-menu",children:[o.jsxs("div",{className:"relative",onMouseEnter:p,onMouseLeave:v,children:[o.jsxs("button",{className:"w-full flex items-center justify-between gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",onClick:N=>{N.stopPropagation(),i(!a)},"data-testid":"change-status-btn",children:[o.jsx("span",{children:"Change Status"}),o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]}),a&&o.jsx("div",{className:"absolute left-full top-0 ml-1 w-48 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg py-1","data-testid":"status-submenu",onMouseEnter:p,onMouseLeave:v,children:_.map(N=>o.jsxs("button",{onClick:k=>{k.stopPropagation(),b(N.value)},disabled:m===N.value||d.isPending,className:`w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors ${m===N.value?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"} disabled:opacity-50`,"data-testid":`status-option-${N.value}`,children:[d.isPending&&d.variables?.mergeStatus===N.value?o.jsx($e,{className:"w-4 h-4 animate-spin"}):S(N.value),o.jsx("span",{children:N.label}),m===N.value&&o.jsx(Yn,{className:"w-3.5 h-3.5 ml-auto text-[var(--color-primary)]"})]},N.value))})]}),o.jsx("div",{className:"my-1 border-t border-[var(--color-border)]"}),o.jsxs("button",{onClick:N=>{N.stopPropagation(),l(!0),n(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-danger)] hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors","data-testid":"delete-merge-request-btn",children:[o.jsx(Sr,{className:"w-4 h-4"}),o.jsx("span",{children:"Delete"})]})]})]}),s&&o.jsx(Mxt,{task:e,isDeleting:f.isPending,onConfirm:y,onCancel:()=>l(!1)})]})}function Mxt({task:e,isDeleting:t,onConfirm:r,onCancel:n}){return w.useEffect(()=>{const a=i=>{i.key==="Escape"&&!t&&n()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[t,n]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"delete-merge-request-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!t&&n()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-[var(--color-danger-muted)] flex items-center justify-center",children:o.jsx(Sr,{className:"w-5 h-5 text-[var(--color-danger)]"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Merge Request"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Are you sure you want to delete the merge request for"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e.title,'"']}),"? This action cannot be undone."]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:n,disabled:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"delete-merge-request-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:r,disabled:t,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 disabled:opacity-50","data-testid":"delete-merge-request-confirm-btn",children:t?o.jsxs(o.Fragment,{children:[o.jsx($e,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Sr,{className:"w-4 h-4"}),"Delete"]})})]})]})]})}function Txt({task:e,assigneeName:t,onClick:r,isSelected:n,onDeleted:a}){const i=e.metadata?.orchestrator,s=i?.mergeStatus,l=i?.lastTestResult,c=i?.branch,u=s?Cme(s):null;return o.jsxs("div",{className:`
        relative flex flex-col p-4 border rounded-lg cursor-pointer
        transition-all duration-150 ease-out
        ${n?"bg-[var(--color-primary-muted)] border-[var(--color-primary)]":"bg-[var(--color-surface)] border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] hover:border-[var(--color-border-hover)]"}
      `,onClick:r,"data-testid":`merge-request-card-${e.id}`,children:[u&&o.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 rounded-l-lg ${u.border.replace("border-","bg-")}`}),o.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[s&&o.jsx(Qp,{status:s}),o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.title,children:e.title})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)] whitespace-nowrap",children:Axt(e.updatedAt)}),o.jsx(cye,{task:e,onDeleted:a})]})]}),o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs text-[var(--color-text-secondary)]",children:[c&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(cu,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"font-mono truncate max-w-[200px]",title:c,children:c}),c!=="main"&&c!=="master"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsx("span",{className:"font-mono",children:"main"})]})]}),i?.mergeRequestUrl&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsxs("a",{href:i.mergeRequestUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-[var(--color-primary)] hover:underline",onClick:d=>d.stopPropagation(),children:[o.jsx(Sl,{className:"w-3 h-3"}),o.jsx("span",{children:"View MR"})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--color-text-secondary)]",children:[o.jsx(Xr,{className:"w-3.5 h-3.5 text-purple-500"}),o.jsx("span",{children:t||e.assignee||"Unassigned"})]}),l&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[l.passed?o.jsx(Yn,{className:"w-3.5 h-3.5 text-green-500"}):o.jsx(oi,{className:"w-3.5 h-3.5 text-red-500"}),o.jsx("span",{className:l.passed?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:l.totalTests!==void 0?o.jsxs(o.Fragment,{children:[l.passedTests??0,"/",l.totalTests," tests passed"]}):l.passed?"Tests passed":"Tests failed"})]}),!l&&s==="pending"&&o.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--color-text-tertiary)]",children:[o.jsx(tn,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Awaiting review"})]}),s==="testing"&&o.jsxs("div",{className:"flex items-center gap-1.5 text-blue-600 dark:text-blue-400",children:[o.jsx("div",{className:"w-3.5 h-3.5 border-2 border-current border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Running tests..."})]}),s==="merging"&&o.jsxs("div",{className:"flex items-center gap-1.5 text-blue-600 dark:text-blue-400",children:[o.jsx("div",{className:"w-3.5 h-3.5 border-2 border-current border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Merging..."})]})]})]})}function Axt(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function Dxt({result:e,compact:t=!1}){const{passed:r,totalTests:n,passedTests:a,failedTests:i,skippedTests:s,durationMs:l,errorMessage:c}=e,u=n!==void 0,d=u&&n>0?Math.round((a??0)/n*100):r?100:0;return t?o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r?o.jsx(Yn,{className:"w-4 h-4 text-green-500"}):o.jsx(oi,{className:"w-4 h-4 text-red-500"}),o.jsx("span",{className:r?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:u?`${a??0}/${n} passed`:r?"Passed":"Failed"})]}):o.jsxs("div",{className:"space-y-3","data-testid":"test-results-display",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center gap-2",children:r?o.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[o.jsx(Yn,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Tests Passed"})]}):o.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400",children:[o.jsx(oi,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Tests Failed"})]})}),l!==void 0&&o.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(tn,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:Lxt(l)})]})]}),u&&n>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"h-2 bg-[var(--color-surface-elevated)] rounded-full overflow-hidden",children:o.jsxs("div",{className:"h-full flex",children:[(a??0)>0&&o.jsx("div",{className:"h-full bg-green-500",style:{width:`${(a??0)/n*100}%`}}),(i??0)>0&&o.jsx("div",{className:"h-full bg-red-500",style:{width:`${(i??0)/n*100}%`}}),(s??0)>0&&o.jsx("div",{className:"h-full bg-yellow-500",style:{width:`${(s??0)/n*100}%`}})]})}),o.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-green-600 dark:text-green-400",children:[o.jsx(Yn,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:[a??0," passed"]})]}),(i??0)>0&&o.jsxs("div",{className:"flex items-center gap-1.5 text-red-600 dark:text-red-400",children:[o.jsx(oi,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:[i," failed"]})]}),(s??0)>0&&o.jsxs("div",{className:"flex items-center gap-1.5 text-yellow-600 dark:text-yellow-400",children:[o.jsx(Rwe,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:[s," skipped"]})]}),o.jsxs("div",{className:"text-[var(--color-text-tertiary)] ml-auto",children:[d,"% pass rate"]})]})]}),c&&o.jsx("div",{className:"mt-3 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Bn,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),o.jsx("pre",{className:"text-xs font-mono text-red-700 dark:text-red-300 whitespace-pre-wrap break-words overflow-x-auto",children:c})]})})]})}function Lxt(e){if(e<1e3)return`${e}ms`;if(e<6e4)return`${(e/1e3).toFixed(1)}s`;const t=Math.floor(e/6e4),r=Math.floor(e%6e4/1e3);return`${t}m ${r}s`}function Oxt({taskId:e,onClose:t,onBack:r,onDeleted:n}){const{data:a,isLoading:i,error:s}=$Je(e),{data:l}=y2(),c=a?.assignee&&l?l.find(v=>v.id===a.assignee)?.name:void 0;if(i)return o.jsx("div",{className:"h-full flex items-center justify-center bg-[var(--color-surface)]",children:o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading..."})]})});if(s||!a)return o.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-[var(--color-surface)]",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:s?.message||"Merge request not found"}),o.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 text-sm text-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] rounded-md",children:"Close"})]});const u=a.metadata?.orchestrator,d=u?.mergeStatus,f=u?.lastTestResult,m=u?.branch,p=d?Cme(d):null;return o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-surface)]","data-testid":"merge-request-detail-panel",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[r&&o.jsx("button",{onClick:r,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Back to list",children:o.jsx(zx,{className:"w-5 h-5"})}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Merge Request"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[a&&o.jsx(cye,{task:a,onDeleted:()=>{n?.(),t()}}),o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Close panel",children:o.jsx(wt,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"flex items-center gap-3 mb-2",children:d&&o.jsx("div",{className:`px-3 py-1.5 rounded-md ${p?.bg} ${p?.text}`,children:o.jsx(Qp,{status:d})})}),o.jsx("h3",{className:"text-xl font-semibold text-[var(--color-text)] mb-1",children:a.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:a.id})]}),o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsxs("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3 flex items-center gap-2",children:[o.jsx(tu,{className:"w-3.5 h-3.5"}),"Task"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Title"}),o.jsx("p",{className:"text-sm font-medium text-[var(--color-text)] mt-0.5",children:a.title})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Status"}),o.jsx("div",{className:"mt-0.5",children:o.jsx(Vp,{status:a.status})})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Priority"}),o.jsx("div",{className:"mt-0.5",children:o.jsx(Yp,{priority:a.priority})})]})]}),a.description&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Description"}),o.jsx("p",{className:"text-sm text-[var(--color-text)] mt-0.5 whitespace-pre-wrap line-clamp-4",children:a.description})]})]})]}),o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Git Info"}),o.jsxs("div",{className:"space-y-3",children:[m&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(cu,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("code",{className:"font-mono text-[var(--color-text)]",children:m}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsx("code",{className:"font-mono text-[var(--color-text)]",children:"main"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Xr,{className:"w-4 h-4 text-purple-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:c||a.assignee||"Unassigned"})]}),u?.mergeRequestUrl&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Ri,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("a",{href:u.mergeRequestUrl,target:"_blank",rel:"noopener noreferrer",className:"text-[var(--color-primary)] hover:underline truncate",children:u.mergeRequestUrl})]}),u?.sessionId&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Bs,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:"Session:"}),o.jsx("code",{className:"font-mono text-xs text-[var(--color-text-tertiary)]",children:u.sessionId})]})]})]}),f&&o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Test Results"}),o.jsx(Dxt,{result:f}),u?.testRunCount&&u.testRunCount>1&&o.jsxs("p",{className:"mt-2 text-xs text-[var(--color-text-tertiary)]",children:["Test run #",u.testRunCount]})]}),u?.mergeFailureReason&&o.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Bn,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Merge Failed"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:u.mergeFailureReason})]})]})}),o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Timeline"}),o.jsxs("div",{className:"space-y-3",children:[u?.completedAt&&o.jsx(nk,{icon:o.jsx(Yn,{className:"w-4 h-4"}),color:"text-green-500",label:"Task completed",time:u.completedAt}),f?.completedAt&&o.jsx(nk,{icon:f.passed?o.jsx(Yn,{className:"w-4 h-4"}):o.jsx(Bt,{className:"w-4 h-4"}),color:f.passed?"text-green-500":"text-red-500",label:f.passed?"Tests passed":"Tests failed",time:f.completedAt}),u?.mergedAt&&o.jsx(nk,{icon:o.jsx(Ri,{className:"w-4 h-4"}),color:"text-purple-500",label:"Merged to main",time:u.mergedAt}),o.jsx(nk,{icon:o.jsx(tn,{className:"w-4 h-4"}),color:"text-[var(--color-text-tertiary)]",label:"Created",time:a.createdAt})]})]})]})]})}function nk({icon:e,color:t,label:r,time:n}){return o.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[o.jsx("div",{className:t,children:e}),o.jsx("span",{className:"text-[var(--color-text)]",children:r}),o.jsx("span",{className:"text-[var(--color-text-tertiary)] text-xs ml-auto",title:Ixt(n),children:Rxt(n)})]})}function Ixt(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Rxt(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:i<24?`${i}h ago`:s<7?`${s}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}const Pxt=[{value:"all",label:"All",countKey:"all",icon:Tl},{value:"needs_review",label:"Needs Review",countKey:"needsReview",icon:Bt},{value:"testing",label:"Testing",countKey:"testing",icon:O6},{value:"conflicts",label:"Conflicts",countKey:"conflicts",icon:Bn}];function zxt({currentFilter:e,counts:t,showMerged:r,onFilterChange:n,onShowMergedChange:a}){return o.jsxs("div",{className:"flex items-center justify-between border-b border-[var(--color-border)] overflow-x-auto",children:[o.jsx("nav",{className:"flex gap-1 min-w-max","aria-label":"Merge request filters","data-testid":"merge-request-filters",children:Pxt.map(i=>{const s=t[i.countKey],l=e===i.value,c=i.icon;return o.jsx("button",{onClick:()=>n(i.value),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${l?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":`filter-tab-${i.value}`,children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(c,{className:"w-4 h-4"}),i.label,o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:s})]})},i.value)})}),o.jsxs("button",{onClick:()=>a(!r),className:`
          flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-md ml-4 mb-1
          transition-all duration-150 ease-out border
          ${r?"bg-[var(--color-success-muted)] text-[var(--color-success)] border-[var(--color-success)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:bg-[var(--color-surface-hover)]"}
        `,"data-testid":"toggle-show-merged",children:[r?o.jsx(du,{className:"w-4 h-4"}):o.jsx(Yae,{className:"w-4 h-4"}),o.jsxs("span",{children:["Merged (",t.merged,")"]})]})]})}function Bxt(){const e=rl({from:"/merge-requests"}),t=Ma(),[r,n]=w.useState(""),a=e.status||"all",i=e.showMerged??!1,s=e.selected,{data:l,isLoading:c,error:u,refetch:d}=BJe({status:a,showMerged:i}),{counts:f}=Nme(),{data:m}=y2(),p=w.useMemo(()=>{const j=new Map;return m&&m.forEach(E=>j.set(E.id,E.name)),j},[m]),v=w.useMemo(()=>{if(!l)return[];if(!r.trim())return l;const j=r.toLowerCase();return l.filter(E=>{const T=E.title.toLowerCase(),O=E.metadata?.orchestrator?.branch?.toLowerCase()||"",R=p.get(E.assignee||"")?.toLowerCase()||"";return T.includes(j)||O.includes(j)||R.includes(j)})},[l,r,p]),[b,y]=w.useState(0);w.useEffect(()=>{const j=E=>{if(!(E.target instanceof HTMLInputElement||E.target instanceof HTMLTextAreaElement))switch(E.key){case"j":E.preventDefault(),y(T=>Math.min(T+1,v.length-1));break;case"k":E.preventDefault(),y(T=>Math.max(T-1,0));break;case"Enter":E.preventDefault(),v[b]&&N(v[b].id);break;case"Escape":E.preventDefault(),k();break;case"r":!E.metaKey&&!E.ctrlKey&&(E.preventDefault(),d());break}};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[v,b,d]),w.useEffect(()=>{document.querySelector('[data-focused="true"]')?.scrollIntoView({block:"nearest",behavior:"smooth"})},[b]);const S=w.useCallback(j=>{t({to:"/merge-requests",search:{selected:e.selected,status:j==="all"?void 0:j,showMerged:e.showMerged}})},[t,e.selected,e.showMerged]),_=w.useCallback(j=>{t({to:"/merge-requests",search:{selected:e.selected,status:e.status,showMerged:j||void 0}})},[t,e.selected,e.status]),N=w.useCallback(j=>{t({to:"/merge-requests",search:{selected:j,status:e.status,showMerged:e.showMerged}})},[t,e.status,e.showMerged]),k=w.useCallback(()=>{t({to:"/merge-requests",search:{selected:void 0,status:e.status,showMerged:e.showMerged}})},[t,e.status,e.showMerged]);return o.jsxs("div",{className:"space-y-4 animate-fade-in","data-testid":"merge-requests-page",children:[s&&o.jsxs("div",{className:"fixed inset-0 z-40","data-testid":"merge-request-detail-overlay",children:[o.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:k}),o.jsx("div",{className:"absolute right-0 top-0 h-full w-full max-w-lg bg-[var(--color-surface)] shadow-xl border-l border-[var(--color-border)] animate-slide-in-right",children:o.jsx(Oxt,{taskId:s,onClose:k,onDeleted:k})})]}),o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Ri,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Merge Requests"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Review and merge completed agent work"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:"Search merge requests...",value:r,onChange:j=>n(j.target.value),className:"pl-9 pr-3 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent w-48 @md:w-64","data-testid":"merge-requests-search"})]}),o.jsx("button",{onClick:()=>d(),className:"p-2 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","aria-label":"Refresh","data-testid":"merge-requests-refresh",children:o.jsx(jr,{className:"w-4 h-4"})})]})]}),o.jsx(zxt,{currentFilter:a,counts:f,showMerged:i,onFilterChange:S,onShowMergedChange:_}),c?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx($e,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading merge requests..."})]}):u?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-danger)] rounded-lg bg-[var(--color-danger-muted)]",children:[o.jsx(Bt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"Failed to load merge requests"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:u.message}),o.jsxs("button",{onClick:()=>d(),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-surface)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"merge-requests-retry",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]}):v.length===0?o.jsx($xt,{searchQuery:r,currentFilter:a}):o.jsx("div",{className:"space-y-2","data-testid":"merge-requests-list",children:v.map((j,E)=>o.jsx("div",{"data-focused":E===b,className:E===b?"ring-2 ring-[var(--color-primary)] rounded-lg":"",children:o.jsx(Txt,{task:j,assigneeName:j.assignee?p.get(j.assignee):void 0,onClick:()=>N(j.id),isSelected:j.id===s,onDeleted:()=>{j.id===s&&k()}})},j.id))}),o.jsxs("div",{className:"fixed bottom-4 right-4 text-xs text-[var(--color-text-tertiary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg px-3 py-2 shadow-sm hidden md:block",children:[o.jsx("span",{className:"font-medium",children:"Shortcuts:"})," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"j"}),"/",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"k"})," navigate"," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"Enter"})," open"," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"Esc"})," close"," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"r"})," refresh"]})]})}function $xt({searchQuery:e,currentFilter:t}){if(e)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(br,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"No matching merge requests"}),o.jsxs("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:['No merge requests found matching "',e,'". Try a different search term.']})]});const r={all:{title:"No merge requests",description:"When agents complete tasks, their work will appear here for review and merging.",icon:o.jsx(Ri,{className:"w-12 h-12 text-[var(--color-text-tertiary)]"})},needs_review:{title:"No requests need review",description:"All merge requests have been reviewed. Nice work!",icon:o.jsx(Yn,{className:"w-12 h-12 text-green-500"})},testing:{title:"No tests running",description:"No merge requests are currently running tests.",icon:o.jsx($e,{className:"w-12 h-12 text-blue-500"})},conflicts:{title:"No conflicts",description:"No merge requests have conflicts. All clear!",icon:o.jsx(Yn,{className:"w-12 h-12 text-green-500"})},merged:{title:"No merged requests",description:"No merge requests have been merged yet.",icon:o.jsx(Ri,{className:"w-12 h-12 text-[var(--color-text-tertiary)]"})}},{title:n,description:a,icon:i}=r[t];return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[i,o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mt-4",children:n}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:a})]})}const Fxt=32,Uxt=500,$$=w.createContext(null);function uye(e){const t=e.lastIndexOf(".");return t>0?e.slice(t+1).toLowerCase():""}function Hxt(e,t,r){if(t)return r?B6:a0;const n=uye(e),a=e.toLowerCase();return a.endsWith(".lock")||a.endsWith("-lock.json")||a.endsWith("-lock.yaml")?qC:a==="package.json"||a==="cargo.toml"||a==="go.mod"?oy:["png","jpg","jpeg","gif","svg","webp","ico","bmp"].includes(n)?iy:["mp3","wav","ogg","flac","m4a","aac"].includes(n)?Pwe:["mp4","webm","mkv","avi","mov"].includes(n)?zwe:["db","sqlite","sqlite3","sql"].includes(n)?tie:["json","jsonc","json5"].includes(n)?rie:mZe(e)?Bs:Eme(e)?li:pZe(e)?eie:["md","txt","rtf","doc","docx","pdf"].includes(n)?rn:L6}function qxt(e,t){if(t)return"text-amber-500";const r=uye(e),n=e.toLowerCase();return n.endsWith(".lock")||n.endsWith("-lock.json")||n.endsWith("-lock.yaml")?"text-gray-400":n==="package.json"||n==="cargo.toml"||n==="go.mod"?"text-green-500":["ts","tsx"].includes(r)?"text-blue-500":["js","jsx","mjs","cjs"].includes(r)?"text-yellow-500":["py","pyw","pyi"].includes(r)?"text-blue-400":["rs"].includes(r)?"text-orange-500":["go"].includes(r)?"text-cyan-500":["rb","rake"].includes(r)?"text-red-500":["html","htm"].includes(r)?"text-orange-400":["css","scss","sass","less"].includes(r)?"text-pink-500":["sh","bash","zsh","fish"].includes(r)?"text-green-400":["json","jsonc","json5"].includes(r)?"text-yellow-400":["md","mdx"].includes(r)?"text-purple-400":["yaml","yml","toml"].includes(r)?"text-red-400":["png","jpg","jpeg","gif","svg","webp"].includes(r)?"text-purple-500":Eme(e)?"text-gray-400":"text-[var(--color-text-muted)]"}function Wxt({node:e,children:t}){const r=w.useContext($$);if(!r)return o.jsx(o.Fragment,{children:t});const{clipboard:n,onOpen:a,onCopy:i,onCut:s,onPaste:l,onCopyPath:c,onCopyRelativePath:u,onRename:d,onDelete:f}=r,m=e.nodeType==="folder",p=n!==null;return o.jsxs(xie,{children:[o.jsx(wie,{asChild:!0,children:t}),o.jsx(Sie,{children:o.jsxs(kie,{className:"min-w-[180px] bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-lg py-1 z-50","data-testid":"file-tree-context-menu",children:[o.jsx(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>a(e),"data-testid":"context-menu-open",children:o.jsx("span",{children:"Open"})}),o.jsx(mk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsx(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>i(e),"data-testid":"context-menu-copy",children:o.jsx("span",{children:"Copy"})}),o.jsx(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>s(e),"data-testid":"context-menu-cut",children:o.jsx("span",{children:"Cut"})}),o.jsx(_s,{className:`flex items-center justify-between px-3 py-1.5 text-sm outline-none ${p?"text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer":"text-[var(--color-text-muted)] opacity-50 cursor-not-allowed"}`,disabled:!p,onSelect:()=>{if(p)if(m)l(e);else{const v=e.path.lastIndexOf("/")>0?e.path.slice(0,e.path.lastIndexOf("/")):"";l({...e,path:v,nodeType:"folder"})}},"data-testid":"context-menu-paste",children:o.jsx("span",{children:"Paste"})}),o.jsx(mk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsx(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>c(e),"data-testid":"context-menu-copy-path",children:o.jsx("span",{children:"Copy Path"})}),o.jsx(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>u(e),"data-testid":"context-menu-copy-relative-path",children:o.jsx("span",{children:"Copy Relative Path"})}),o.jsx(mk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsxs(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>d(e),"data-testid":"context-menu-rename",children:[o.jsx("span",{children:"Rename"}),o.jsx("span",{className:"text-[var(--color-text-muted)] text-xs ml-4",children:"F2"})]}),o.jsxs(_s,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-red-400 data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>f(e),"data-testid":"context-menu-delete",children:[o.jsx("span",{children:"Delete"}),o.jsx("span",{className:"text-[var(--color-text-muted)] text-xs ml-4",children:"Del"})]})]})})]})}function Kxt({node:e,onSubmit:t,onCancel:r}){const n=w.useRef(null),[a,i]=w.useState(e.name),s=w.useRef(!1);w.useEffect(()=>{const d=setTimeout(()=>{if(n.current){if(n.current.focus(),e.nodeType==="file"){const f=e.name.lastIndexOf(".");f>0?n.current.setSelectionRange(0,f):n.current.select()}else n.current.select();s.current=!0}},50);return()=>clearTimeout(d)},[e.name,e.nodeType]);const l=()=>{const d=a.trim();d&&d!==e.name?t(e.path,d):r()},c=()=>{s.current&&l()},u=d=>{d.key==="Enter"?(d.preventDefault(),l()):d.key==="Escape"&&(d.preventDefault(),r())};return o.jsx("input",{ref:n,type:"text",value:a,onChange:d=>i(d.target.value),onBlur:c,onKeyDown:u,className:"flex-1 bg-[var(--color-bg)] border border-[var(--color-primary)] rounded px-1 py-0 text-sm text-[var(--color-text)] outline-none","data-testid":"inline-rename-input",onClick:d=>d.stopPropagation()})}function Gxt(e){const[t,r]=w.useState(!1),n=w.useRef(null),a=e.data.nodeType==="folder",i=!e.isOpen,s=e.willReceiveDrop;return w.useEffect(()=>(a&&i&&s?(r(!0),n.current=setTimeout(()=>{e.open(),r(!1)},Uxt)):(n.current&&(clearTimeout(n.current),n.current=null),r(!1)),()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[a,i,s,e]),t}function Vxt({node:e,style:t,dragHandle:r}){const n=w.useContext($$),a=e.data.nodeType==="folder",i=e.isOpen,s=e.isSelected,l=n?.renamingNodeId===e.data.id,c=e.willReceiveDrop,u=e.isDragging,d=Gxt(e),f=Hxt(e.data.name,a,i),m=qxt(e.data.name,a),p=b=>{b.stopPropagation(),a?e.toggle():(e.select(),e.activate())},v=o.jsx("div",{ref:r,"data-testid":`file-tree-item-${e.id}`,style:t,className:`pr-2 ${u?"opacity-50":""}`,children:o.jsxs("button",{"data-testid":`file-tree-button-${e.id}`,onClick:p,className:`
          w-full flex items-center gap-1.5 px-2 py-1 rounded-md text-sm
          transition-colors duration-150 ease-in-out
          ${c?d?"bg-[var(--color-primary-muted)] ring-1 ring-[var(--color-primary)] text-[var(--color-text)] animate-pulse":"bg-[var(--color-primary-muted)] ring-1 ring-[var(--color-primary)] text-[var(--color-text)]":s?"bg-[var(--color-primary)] text-white":"text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
        `,children:[a?o.jsx("span",{className:"flex-shrink-0 w-4 h-4 flex items-center justify-center",children:i?o.jsx(cr,{className:"w-3.5 h-3.5"}):o.jsx(gn,{className:"w-3.5 h-3.5"})}):o.jsx("span",{className:"w-4"}),o.jsx(f,{className:`w-4 h-4 flex-shrink-0 ${s?"text-white":m}`}),l&&n?o.jsx(Kxt,{node:e.data,onSubmit:n.onRenameSubmit,onCancel:n.onRenameCancel}):o.jsx("span",{className:"truncate flex-1 text-left",children:e.data.name})]})});return n&&!l?o.jsx(Wxt,{node:e.data,children:v}):v}function Yxt({node:e,isOpen:t,onConfirm:r,onCancel:n}){return o.jsx(sSe,{open:t,onOpenChange:a=>!a&&n(),children:o.jsxs(oSe,{children:[o.jsx(lSe,{className:"fixed inset-0 bg-black/40 z-50"}),o.jsxs(cSe,{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-xl z-50 w-full max-w-md p-6","data-testid":"delete-confirmation-dialog",children:[o.jsxs(uSe,{className:"text-lg font-semibold text-[var(--color-text)]",children:["Are you sure you want to delete ",e?.name,"?"]}),o.jsx(dSe,{className:"mt-2 text-sm text-[var(--color-text-muted)]",children:"This action cannot be undone."}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx(fSe,{asChild:!0,children:o.jsx("button",{className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"delete-cancel-button",children:"Cancel"})}),o.jsx(hSe,{asChild:!0,children:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors","data-testid":"delete-confirm-button",children:"Delete"})})]})]})]})})}function dye(e){return{id:e.id,name:e.name,nodeType:e.type==="directory"?"folder":"file",path:e.path,children:e.children?.map(dye)}}function Qxt(e){return{id:e.id,name:e.title||"Untitled",nodeType:"file",path:e.title||"Untitled",document:e}}function dO(e){const t=e.lastIndexOf("/");return t>0?e.slice(0,t):""}const Jxt=w.forwardRef(function({workspaceEntries:t=[],documents:r=[],source:n,selectedId:a,onSelectFile:i,onDoubleClickFile:s,onDeleteFile:l,onRenameFile:c,onPasteFile:u,onMoveFile:d,workspaceRoot:f,className:m=""},p){const v=w.useRef(null),b=w.useRef(null),[y,S]=w.useState(400);w.useImperativeHandle(p,()=>({closeAll:()=>b.current?.closeAll()}));const[_,N]=w.useState(null),[k,j]=w.useState(null),[E,T]=w.useState(null);w.useEffect(()=>{if(!v.current)return;const te=new ResizeObserver(oe=>{for(const ce of oe)S(Math.max(ce.contentRect.height-8,100))});return te.observe(v.current),()=>te.disconnect()},[]);const O=w.useMemo(()=>n==="workspace"?t.map(dye):r.map(Qxt),[n,t,r]),R=w.useCallback(te=>{te.length>0&&te[0].data.nodeType==="file"&&i(te[0].data)},[i]),q=w.useCallback(te=>{te.data.nodeType==="file"&&(s?s(te.data):i(te.data))},[i,s]),$=w.useCallback(te=>{if(te.nodeType==="folder"){const oe=b.current;if(oe){const ce=oe.get(te.id);ce&&ce.toggle()}}else i(te)},[i]),L=w.useCallback(te=>{N({node:te,operation:"copy"})},[]),A=w.useCallback(te=>{N({node:te,operation:"cut"})},[]),M=w.useCallback(async te=>{if(!(!_||!u))try{await u(_.node.path,te.path,_.operation),_.operation==="cut"&&N(null)}catch(oe){console.error("Failed to paste file:",oe)}},[_,u]),z=w.useCallback(te=>{const oe=f?`${f}/${te.path}`:`/${te.path}`;navigator.clipboard.writeText(oe)},[f]),I=w.useCallback(te=>{navigator.clipboard.writeText(te.path)},[]),B=w.useCallback(te=>{j(te.id)},[]),F=w.useCallback(async(te,oe)=>{if(!c){j(null);return}const ce=dO(te),Z=ce?`${ce}/${oe}`:oe;try{await c(te,Z)}catch(ue){console.error("Failed to rename file:",ue)}finally{j(null)}},[c]),U=w.useCallback(()=>{j(null)},[]),V=w.useCallback(te=>{T(te)},[]),K=w.useCallback(async()=>{if(!E||!l){T(null);return}try{await l(E.path)}catch(te){console.error("Failed to delete file:",te)}finally{T(null)}},[E,l]),G=w.useCallback(()=>{T(null)},[]),[J,ee]=w.useState(null),Y=w.useCallback(async te=>{if(d)for(const oe of te.dragNodes){const ce=oe.data.path,Z=oe.data.name,ue=te.parentNode?`${te.parentNode.data.path}/${Z}`:Z;if(ce!==ue&&!(te.parentNode&&te.parentNode.data.path.startsWith(ce+"/"))&&!(te.parentNode&&te.parentNode.data.path===ce))try{ee(null),await d(ce,ue)}catch(H){const ge=H instanceof Error?H.message:"Failed to move file";ee(ge),console.error("Failed to move file:",H),setTimeout(()=>ee(null),5e3)}}},[d]),ie=w.useCallback(te=>{const{parentNode:oe,dragNodes:ce}=te,Z=oe.isRoot;for(const ue of ce){if(Z){if(dO(ue.data.path)==="")return!0;continue}if(oe.data.nodeType==="file"||oe.data.path===ue.data.path||oe.data.path.startsWith(ue.data.path+"/"))return!0;const H=dO(ue.data.path),ge=oe.data.path;if(H===ge)return!0}return!1},[]),fe=n==="workspace"&&!!d,me=w.useMemo(()=>({clipboard:_,renamingNodeId:k,onOpen:$,onCopy:L,onCut:A,onPaste:M,onCopyPath:z,onCopyRelativePath:I,onRename:B,onDelete:V,onRenameSubmit:F,onRenameCancel:U}),[_,k,$,L,A,M,z,I,B,V,F,U]);return o.jsx($$.Provider,{value:me,children:o.jsxs("div",{ref:v,"data-testid":"editor-file-tree",className:`flex-1 overflow-hidden p-1 relative ${m}`,children:[O.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-muted)] text-sm",children:"No files to display"}):o.jsxs(o.Fragment,{children:[o.jsx(sye,{ref:b,data:O,width:"100%",height:y,rowHeight:Fxt,indent:16,paddingTop:4,paddingBottom:4,selection:a??void 0,onSelect:R,onActivate:q,disableMultiSelection:!0,openByDefault:!1,onMove:fe?Y:void 0,disableDrag:!fe,disableDrop:fe?ie:!0,children:Vxt}),J&&o.jsx("div",{className:"absolute bottom-2 left-2 right-2 px-3 py-2 text-xs text-red-400 bg-red-900/30 border border-red-800/50 rounded-md","data-testid":"move-error-message",children:J})]}),o.jsx(Yxt,{node:E,isOpen:E!==null,onConfirm:K,onCancel:G})]})})});function Zxt(e){const t=e.split(".").pop()?.toLowerCase()||"";return new Set(["js","jsx","ts","tsx","mjs","cjs","mts","cts","json","jsonc","json5","py","pyw","pyx","go","rs","java","kt","kts","c","cpp","cc","cxx","h","hpp","hxx","cs","php","rb","swift","r","lua","pl","pm","ex","exs","erl","hrl","clj","cljs","scala","vue","svelte","astro","html","htm","css","scss","sass","less","yaml","yml","toml","xml","svg","sql","graphql","gql","sh","bash","zsh","fish","ps1","dockerfile","makefile","cmake"]).has(t)?Bs:rn}function Xxt({lineContent:e,startIndex:t,endIndex:r}){const n=e.slice(0,t),a=e.slice(t,r),i=e.slice(r),s=60;let l=n,c=i;n.length>20&&(l="..."+n.slice(-17)),i.length>30&&(c=i.slice(0,27)+"...");const u=l.length+a.length+c.length;if(u>s){const d=u-s;c.length>d&&(c=c.slice(0,c.length-d-3)+"...")}return o.jsxs("span",{className:"font-mono text-xs leading-relaxed",children:[o.jsx("span",{className:"text-[var(--color-text-muted)]",children:l}),o.jsx("span",{className:"bg-[var(--color-warning)]/30 text-[var(--color-text)] font-semibold px-0.5 rounded",children:a}),o.jsx("span",{className:"text-[var(--color-text-muted)]",children:c})]})}function e1t({result:e,isExpanded:t,onToggleExpand:r,onSelectMatch:n}){const a=Zxt(e.name);return o.jsxs("div",{className:"border-b border-[var(--color-border)] last:border-b-0","data-testid":`search-result-${e.path}`,children:[o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-1.5 px-2 py-1.5 hover:bg-[var(--color-surface-hover)] transition-colors text-left","data-testid":`search-result-header-${e.path}`,children:[t?o.jsx(cr,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)] flex-shrink-0"}):o.jsx(gn,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)] flex-shrink-0"}),o.jsx(a,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)] flex-shrink-0"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text)] truncate flex-1",children:e.name}),o.jsx("span",{className:"text-xs px-1 py-0.5 bg-[var(--color-primary)]/10 text-[var(--color-primary)] rounded flex-shrink-0",children:e.totalMatches})]}),t&&o.jsxs("div",{className:"bg-[var(--color-surface)]/50",children:[e.matches.map((i,s)=>o.jsxs("button",{onClick:()=>n(e,i),className:"w-full flex items-start gap-1.5 px-2 py-1 pl-7 hover:bg-[var(--color-surface-hover)] transition-colors text-left","data-testid":`search-match-${e.path}-${i.line}`,children:[o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono w-6 text-right flex-shrink-0",children:i.line}),o.jsx(Xxt,{lineContent:i.lineContent,startIndex:i.startIndex,endIndex:i.endIndex})]},`${i.line}-${i.column}-${s}`)),e.totalMatches>e.matches.length&&o.jsxs("div",{className:"px-2 py-1 pl-7 text-xs text-[var(--color-text-muted)] italic",children:["+",e.totalMatches-e.matches.length," more..."]})]})]})}function fO({active:e,onClick:t,icon:r,label:n}){return o.jsx("button",{onClick:t,className:`
        flex items-center justify-center w-6 h-6 rounded transition-colors
        ${e?"bg-[var(--color-primary)] text-white":"text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
      `,title:n,"data-testid":`search-option-${n.toLowerCase().replace(/\s+/g,"-")}`,children:o.jsx(r,{className:"w-3.5 h-3.5"})})}const t1t=w.forwardRef(function({onSelectResult:t,className:r=""},n){const a=w.useRef(null),[i,s]=w.useState(new Set),{isOpen:l,isLoading:c,error:u}=g1(),{query:d,setQuery:f,isSearching:m,results:p,filesSearched:v,totalFiles:b,totalMatches:y,progress:S,error:_,isComplete:N,searchTime:k,options:j,setOptions:E,clearResults:T}=Bme();w.useImperativeHandle(n,()=>({focus:()=>{a.current?.focus()}}),[]),w.useEffect(()=>{p.length>0&&p.length<=3&&s(new Set(p.map(F=>F.path)))},[p]);const O=w.useCallback((F,U)=>{t(F.path,U.line,U.column)},[t]),R=w.useCallback(F=>{s(U=>{const V=new Set(U);return V.has(F)?V.delete(F):V.add(F),V})},[]),q=w.useCallback(()=>{E({caseSensitive:!j.caseSensitive})},[j.caseSensitive,E]),$=w.useCallback(()=>{E({useRegex:!j.useRegex})},[j.useRegex,E]),L=w.useCallback(()=>{E({wholeWord:!j.wholeWord})},[j.wholeWord,E]),A=w.useCallback(()=>{T(),s(new Set),a.current?.focus()},[T]),M=d.trim().length>0,z=m&&b>0,I=p.length>0,B=N&&M&&p.length===0&&!_;return o.jsxs("div",{className:`flex flex-col h-full overflow-hidden ${r}`,"data-testid":"editor-search-panel",children:[o.jsxs("div",{className:"flex-shrink-0 p-2 border-b border-[var(--color-border)] space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("input",{ref:a,type:"text",value:d,onChange:F=>f(F.target.value),placeholder:l?"Search...":"Open workspace...",className:"w-full h-7 pl-7 pr-7 text-xs bg-[var(--color-surface)] border border-[var(--color-border)] rounded focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] text-[var(--color-text)] placeholder:text-[var(--color-text-muted)]",disabled:!l,"data-testid":"editor-search-input"}),M&&o.jsx("button",{onClick:A,className:"absolute right-1.5 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text)]",title:"Clear search","data-testid":"editor-search-clear",children:o.jsx(wt,{className:"w-3.5 h-3.5"})}),m&&o.jsx($e,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 animate-spin text-[var(--color-primary)]"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(fO,{active:j.caseSensitive??!1,onClick:q,icon:Hae,label:"Match Case"}),o.jsx(fO,{active:j.wholeWord??!1,onClick:L,icon:qae,label:"Whole Word"}),o.jsx(fO,{active:j.useRegex??!1,onClick:$,icon:Wae,label:"Use Regex"})]}),z&&o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[o.jsx("div",{className:"flex-1 h-1 bg-[var(--color-surface)] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-[var(--color-primary)] transition-all duration-200",style:{width:`${S*100}%`}})}),o.jsxs("span",{className:"flex-shrink-0",children:[v,"/",b]})]}),N&&M&&!m&&o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[y," ",y===1?"result":"results"," in ",p.length," ",p.length===1?"file":"files",k!==null&&` (${Math.round(k)}ms)`]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto","data-testid":"editor-search-results",children:[c&&o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx($e,{className:"w-5 h-5 animate-spin text-[var(--color-text-muted)]"})}),u&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(Bt,{className:"w-6 h-6 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:u})]}),_&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-danger)]/10 text-[var(--color-danger)] text-xs",children:[o.jsx(Bt,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{children:_})]}),!c&&!u&&!l&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx($e,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3 animate-spin"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Loading..."}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Workspace is loading"})]}),l&&!M&&!m&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(br,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Search Files"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Type to search in all files"})]}),B&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(wt,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"No Results"}),o.jsxs("p",{className:"text-xs text-[var(--color-text-secondary)]",children:['No files contain "',d,'"']})]}),I&&o.jsx("div",{children:p.map(F=>o.jsx(e1t,{result:F,isExpanded:i.has(F.path),onToggleExpand:()=>R(F.path),onSelectMatch:O},F.path))})]})]})}),v5=(e,t)=>t.some(r=>e instanceof r);let nne,ane;function r1t(){return nne||(nne=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function n1t(){return ane||(ane=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const b5=new WeakMap,hO=new WeakMap,cE=new WeakMap;function a1t(e){const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{r(mh(e.result)),a()},s=()=>{n(e.error),a()};e.addEventListener("success",i),e.addEventListener("error",s)});return cE.set(t,e),t}function i1t(e){if(b5.has(e))return;const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{r(),a()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});b5.set(e,t)}let y5={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return b5.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return mh(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function fye(e){y5=e(y5)}function s1t(e){return n1t().includes(e)?function(...t){return e.apply(x5(this),t),mh(this.request)}:function(...t){return mh(e.apply(x5(this),t))}}function o1t(e){return typeof e=="function"?s1t(e):(e instanceof IDBTransaction&&i1t(e),v5(e,r1t())?new Proxy(e,y5):e)}function mh(e){if(e instanceof IDBRequest)return a1t(e);if(hO.has(e))return hO.get(e);const t=o1t(e);return t!==e&&(hO.set(e,t),cE.set(t,e)),t}const x5=e=>cE.get(e);function l1t(e,t,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const s=indexedDB.open(e,t),l=mh(s);return n&&s.addEventListener("upgradeneeded",c=>{n(mh(s.result),c.oldVersion,c.newVersion,mh(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const c1t=["get","getKey","getAll","getAllKeys","count"],u1t=["put","add","delete","clear"],mO=new Map;function ine(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(mO.get(t))return mO.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=u1t.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||c1t.includes(r)))return;const i=async function(s,...l){const c=this.transaction(s,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return mO.set(t,i),i}fye(e=>({...e,get:(t,r,n)=>ine(t,r)||e.get(t,r,n),has:(t,r)=>!!ine(t,r)||e.has(t,r)}));const d1t=["continue","continuePrimaryKey","advance"],sne={},w5=new WeakMap,hye=new WeakMap,f1t={get(e,t){if(!d1t.includes(t))return e[t];let r=sne[t];return r||(r=sne[t]=function(...n){w5.set(this,hye.get(this)[t](...n))}),r}};async function*h1t(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const r=new Proxy(t,f1t);for(hye.set(r,t),cE.set(r,x5(t));t;)yield r,t=await(w5.get(r)||t.continue()),w5.delete(r)}function one(e,t){return t===Symbol.asyncIterator&&v5(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&v5(e,[IDBIndex,IDBObjectStore])}fye(e=>({...e,get(t,r,n){return one(t,r)?h1t:e.get(t,r,n)},has(t,r){return one(t,r)||e.has(t,r)}}));const m1t="stoneforge-extensions",p1t=1,zd="installed_extensions",Vg="extension_files";let Sp=null,Gv=null;function g1t(){try{return!(typeof indexedDB>"u")}catch{return!1}}async function v1t(){if(Gv)return Gv;if(!Sp)return Gv=(async()=>{if(!g1t()){console.warn("[ExtensionStorage] IndexedDB is not available. Extensions will not persist across sessions.");return}try{Sp=await l1t(m1t,p1t,{upgrade(e){e.objectStoreNames.contains(zd)||e.createObjectStore(zd,{keyPath:"id"}),e.objectStoreNames.contains(Vg)||e.createObjectStore(Vg,{keyPath:"key"}).createIndex("byExtension","extensionId")},blocked(){console.warn("[ExtensionStorage] Database upgrade blocked. Please close other tabs using this application.")},blocking(){Sp?.close(),Sp=null},terminated(){console.warn("[ExtensionStorage] Database connection terminated unexpectedly."),Sp=null,Gv=null}})}catch(e){console.warn("[ExtensionStorage] Failed to initialize IndexedDB. Extensions will not persist across sessions.",e)}})(),Gv}async function uE(){return await v1t(),Sp}function b1t(e,t){return`${e}/${t}`}async function y1t(e,t,r){const n=await uE();if(!n){console.warn("[ExtensionStorage] Cannot save extension - IndexedDB unavailable");return}const a={id:e,manifest:t,installedAt:Date.now(),version:t.version},i=n.transaction([zd,Vg],"readwrite");try{await i.objectStore(zd).put(a);const s=i.objectStore(Vg),l=[];for(const[c,u]of r){const d={key:b1t(e,c),extensionId:e,filePath:c,content:u};l.push(s.put(d))}await Promise.all(l),await i.done}catch(s){throw new Error(`Failed to save extension ${e}: ${s instanceof Error?s.message:String(s)}`)}}async function mye(e){const t=await uE();if(!t){console.warn("[ExtensionStorage] Cannot remove extension - IndexedDB unavailable");return}const r=t.transaction([zd,Vg],"readwrite");try{await r.objectStore(zd).delete(e);const n=r.objectStore(Vg),s=(await n.index("byExtension").getAllKeys(e)).map(l=>n.delete(l));await Promise.all(s),await r.done}catch(n){throw new Error(`Failed to remove extension ${e}: ${n instanceof Error?n.message:String(n)}`)}}async function x1t(){const e=await uE();return e?(await e.getAll(zd)).sort((r,n)=>n.installedAt-r.installedAt):[]}async function lne(e){const t=await uE();return t?await t.get(zd,e)??null:null}const Ld=new Map,pye=new Set;function w1t(e){switch(e.split(".").pop()?.toLowerCase()){case"json":return"application/json";case"plist":case"tmLanguage":return"application/xml";case"tmTheme":return"application/xml";case"png":return"image/png";case"svg":return"image/svg+xml";case"jpg":case"jpeg":return"image/jpeg";default:return"application/octet-stream"}}function S1t(e,t){const r=w1t(t),n=new ArrayBuffer(e.byteLength);new Uint8Array(n).set(e);const a=new Blob([n],{type:r});return URL.createObjectURL(a)}function k1t(e){return`${e.publisher}.${e.name}`}function cne(e){return e.startsWith("#")?e.slice(1):e}function _1t(e,t){const r=t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");return`${e}-${r}`}function N1t(e){switch(e){case"vs":return"vs";case"vs-dark":return"vs-dark";case"hc-black":return"hc-black";case"hc-light":return"hc-light";default:return"vs-dark"}}function C1t(e,t){const r=[];if(e.tokenColors)for(const n of e.tokenColors){const a=n.settings;if(!a)continue;const i=n.scope;if(!i){(a.foreground||a.fontStyle)&&r.push({token:"",foreground:a.foreground?cne(a.foreground):void 0,fontStyle:a.fontStyle});continue}const s=Array.isArray(i)?i:[i];for(const l of s)!l||l.trim()===""||r.push({token:l,foreground:a.foreground?cne(a.foreground):void 0,fontStyle:a.fontStyle})}return{base:N1t(t),inherit:!0,rules:r,colors:e.colors||{}}}function j1t(e,t,r){const n=[],a=t.contributes?.themes;if(!a||a.length===0)return n;for(const i of a)try{let s=i.path;s.startsWith("./")?s=s.slice(2):s.startsWith("/")&&(s=s.slice(1));const l=r.get(s);if(!l){console.warn(`[ExtensionRegistry] Theme file not found: ${s} for extension ${e}`);continue}const c=new TextDecoder().decode(l),u=JSON.parse(c),d=i.id||_1t(e,i.label),f=C1t(u,i.uiTheme);Gp.defineTheme(d,f),pye.add(d),n.push(d),console.log(`[ExtensionRegistry] Registered theme: ${d} (${i.label})`)}catch(s){console.error(`[ExtensionRegistry] Failed to register theme ${i.label} from ${e}:`,s)}return n}function E1t(e,t){const r=k1t(e);if(Ld.has(r))return console.warn(`[ExtensionRegistry] Extension ${r} is already registered`),{success:!0,extension:Ld.get(r)};try{const n=new Map,a=[];for(const[u,d]of t){const f=S1t(d,u);n.set(u,f),a.push({dispose:()=>URL.revokeObjectURL(f)})}const i=j1t(r,e,t),s=e.contributes?.grammars;s&&Array.isArray(s)&&s.length>0&&console.warn(`[ExtensionRegistry] Extension ${r} contributes ${s.length} grammar(s) - TextMate grammar registration is not yet supported (requires vscode-textmate + vscode-oniguruma)`);const l=e.contributes?.snippets;l&&Array.isArray(l)&&l.length>0&&console.warn(`[ExtensionRegistry] Extension ${r} contributes ${l.length} snippet(s) - snippet registration is not yet supported`);const c={id:r,manifest:e,blobUrls:n,fileDisposables:a,definedThemeIds:i,dispose:async()=>{for(const u of a)u.dispose();for(const u of i)pye.delete(u)},whenReady:async()=>Promise.resolve()};return Ld.set(r,c),console.log(`[ExtensionRegistry] Registered extension: ${r} (${i.length} theme(s))`),{success:!0,extension:c}}catch(n){const a=n instanceof Error?n.message:String(n);return console.error(`[ExtensionRegistry] Failed to register extension ${r}:`,n),{success:!1,error:a}}}async function M1t(e){const t=Ld.get(e);if(!t){console.warn(`[ExtensionRegistry] Extension ${e} is not registered`);return}try{await t.dispose(),Ld.delete(e),console.log(`[ExtensionRegistry] Unregistered extension: ${e}`)}catch(r){throw console.error(`[ExtensionRegistry] Error unregistering extension ${e}:`,r),Ld.delete(e),r}}function T1t(){return Array.from(Ld.values())}function A1t(e){return Ld.has(e)}const gye=[{id:"stoneforge-dark",name:"Stoneforge Dark"},{id:"vs-dark",name:"Dark (VS Code)"},{id:"vs",name:"Light (VS Code)"},{id:"hc-black",name:"High Contrast Dark"},{id:"hc-light",name:"High Contrast Light"}],ak="stoneforge-dark";function D1t(){const e=T1t(),t=[];for(const r of e){const n=r.manifest.contributes;if(n?.themes)for(const a of n.themes)t.push({id:a.label,name:a.label,publisher:r.manifest.publisher,extensionName:r.manifest.displayName||r.manifest.name})}return t}function une(e,t){return gye.some(n=>n.id===e)?!0:t.some(n=>n.id===e)}function L1t({theme:e,onThemeChange:t}){const[r,n]=w.useState([]),a=w.useCallback(()=>{const i=D1t();return n(i),i},[]);return w.useEffect(()=>{const i=a();une(e,i)||(console.log(`[EditorSettingsPanel] Theme "${e}" is no longer available, falling back to ${ak}`),t(ak));const s=setInterval(()=>{const l=a();une(e,l)||(console.log(`[EditorSettingsPanel] Theme "${e}" was uninstalled, falling back to ${ak}`),t(ak))},2e3);return()=>clearInterval(s)},[e,t,a]),o.jsx("div",{className:"flex flex-col h-full overflow-y-auto","data-testid":"editor-settings-panel",children:o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(P6,{className:"w-4 h-4 text-[var(--color-text-muted)]"}),o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Appearance"})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"editor-theme",className:"text-sm font-medium text-[var(--color-text)]",children:"Theme"}),o.jsxs("select",{id:"editor-theme",value:e,onChange:i=>t(i.target.value),className:`
              w-full px-3 py-2
              text-sm
              bg-[var(--color-surface)]
              border border-[var(--color-border)]
              rounded-lg
              text-[var(--color-text)]
              focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
            `,"data-testid":"editor-theme-select",children:[o.jsx("optgroup",{label:"Built-in",children:gye.map(i=>o.jsx("option",{value:i.id,children:i.name},i.id))}),r.length>0&&o.jsx("optgroup",{label:"Installed",children:r.map(i=>o.jsxs("option",{value:i.id,children:[i.name," (",i.extensionName,")"]},`${i.publisher}.${i.id}`))})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Choose the color theme for the editor."})]})]})})}class LC extends Error{constructor(t,r,n){super(t),this.code=r,this.status=n,this.name="OpenVSXError"}}const vye="/api";async function bye(e,t){let r;try{r=await fetch(`${vye}${e}`,{...t,headers:{Accept:"application/json",...t?.headers}})}catch(n){throw new LC(`Network error: ${n instanceof Error?n.message:"Failed to connect"}`,"NETWORK_ERROR",0)}if(!r.ok){let n=null;try{n=await r.json()}catch{}const a=n?.error?.code||`HTTP_${r.status}`,i=n?.error?.message||yye(r.status);throw new LC(i,a,r.status)}return r.json()}function yye(e){switch(e){case 400:return"Invalid request parameters";case 404:return"Extension not found";case 429:return"Rate limit exceeded. Please try again later.";case 500:return"Server error. Please try again later.";case 502:return"Unable to reach extension registry";case 503:return"Extension registry temporarily unavailable";case 504:return"Request timed out";default:return`Request failed with status ${e}`}}async function O1t(e,t){const r=new URLSearchParams;e&&r.set("query",e),t?.category&&r.set("category",t.category),r.set("size",String(t.size)),t?.offset!==void 0&&r.set("offset",String(t.offset)),t?.sortBy&&r.set("sortBy",t.sortBy),t?.sortOrder&&r.set("sortOrder",t.sortOrder);const n=r.toString(),a=n?`/extensions/search?${n}`:"/extensions/search";return bye(a)}async function xye(e,t){return bye(`/extensions/${encodeURIComponent(e)}/${encodeURIComponent(t)}`)}async function I1t(e,t,r){const n=`/extensions/${encodeURIComponent(e)}/${encodeURIComponent(t)}/${encodeURIComponent(r)}/download`;let a;try{a=await fetch(`${vye}${n}`)}catch(i){throw new LC(`Network error: ${i instanceof Error?i.message:"Failed to connect"}`,"NETWORK_ERROR",0)}if(!a.ok){let i=null;if(a.headers.get("Content-Type")?.includes("application/json"))try{i=await a.json()}catch{}const l=i?.error?.code||`HTTP_${a.status}`,c=i?.error?.message||yye(a.status);throw new LC(c,l,a.status)}return a.arrayBuffer()}function ik(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pO={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var dne;function R1t(){return dne||(dne=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(n,a,i){function s(u,d){if(!a[u]){if(!n[u]){var f=typeof ik=="function"&&ik;if(!d&&f)return f(u,!0);if(l)return l(u,!0);var m=new Error("Cannot find module '"+u+"'");throw m.code="MODULE_NOT_FOUND",m}var p=a[u]={exports:{}};n[u][0].call(p.exports,function(v){var b=n[u][1][v];return s(b||v)},p,p.exports,r,n,a,i)}return a[u].exports}for(var l=typeof ik=="function"&&ik,c=0;c<i.length;c++)s(i[c]);return s})({1:[function(r,n,a){var i=r("./utils"),s=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var u,d,f,m,p,v,b,y=[],S=0,_=c.length,N=_,k=i.getTypeOf(c)!=="string";S<c.length;)N=_-S,f=k?(u=c[S++],d=S<_?c[S++]:0,S<_?c[S++]:0):(u=c.charCodeAt(S++),d=S<_?c.charCodeAt(S++):0,S<_?c.charCodeAt(S++):0),m=u>>2,p=(3&u)<<4|d>>4,v=1<N?(15&d)<<2|f>>6:64,b=2<N?63&f:64,y.push(l.charAt(m)+l.charAt(p)+l.charAt(v)+l.charAt(b));return y.join("")},a.decode=function(c){var u,d,f,m,p,v,b=0,y=0,S="data:";if(c.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var _,N=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&N--,c.charAt(c.length-2)===l.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=s.uint8array?new Uint8Array(0|N):new Array(0|N);b<c.length;)u=l.indexOf(c.charAt(b++))<<2|(m=l.indexOf(c.charAt(b++)))>>4,d=(15&m)<<4|(p=l.indexOf(c.charAt(b++)))>>2,f=(3&p)<<6|(v=l.indexOf(c.charAt(b++))),_[y++]=u,p!==64&&(_[y++]=d),v!==64&&(_[y++]=f);return _}},{"./support":30,"./utils":32}],2:[function(r,n,a){var i=r("./external"),s=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function u(d,f,m,p,v){this.compressedSize=d,this.uncompressedSize=f,this.crc32=m,this.compression=p,this.compressedContent=v}u.prototype={getContentWorker:function(){var d=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,f,m){return d.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(m)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,a){var i=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,a){var i=r("./utils"),s=(function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c})();n.exports=function(l,c){return l!==void 0&&l.length?i.getTypeOf(l)!=="string"?(function(u,d,f,m){var p=s,v=m+f;u^=-1;for(var b=m;b<v;b++)u=u>>>8^p[255&(u^d[b])];return-1^u})(0|c,l,l.length,0):(function(u,d,f,m){var p=s,v=m+f;u^=-1;for(var b=m;b<v;b++)u=u>>>8^p[255&(u^d.charCodeAt(b))];return-1^u})(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,n,a){var i=null;i=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:i}},{lie:37}],7:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),u=i?"uint8array":"array";function d(f,m){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=m,this.meta={}}a.magic="\b\0",l.inherits(d,c),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(u,f.data),!1)},d.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(m){f.push({data:m,meta:f.meta})}},a.compressWorker=function(f){return new d("Deflate",f)},a.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,a){function i(p,v){var b,y="";for(b=0;b<v;b++)y+=String.fromCharCode(255&p),p>>>=8;return y}function s(p,v,b,y,S,_){var N,k,j=p.file,E=p.compression,T=_!==u.utf8encode,O=l.transformTo("string",_(j.name)),R=l.transformTo("string",u.utf8encode(j.name)),q=j.comment,$=l.transformTo("string",_(q)),L=l.transformTo("string",u.utf8encode(q)),A=R.length!==j.name.length,M=L.length!==q.length,z="",I="",B="",F=j.dir,U=j.date,V={crc32:0,compressedSize:0,uncompressedSize:0};v&&!b||(V.crc32=p.crc32,V.compressedSize=p.compressedSize,V.uncompressedSize=p.uncompressedSize);var K=0;v&&(K|=8),T||!A&&!M||(K|=2048);var G=0,J=0;F&&(G|=16),S==="UNIX"?(J=798,G|=(function(Y,ie){var fe=Y;return Y||(fe=ie?16893:33204),(65535&fe)<<16})(j.unixPermissions,F)):(J=20,G|=(function(Y){return 63&(Y||0)})(j.dosPermissions)),N=U.getUTCHours(),N<<=6,N|=U.getUTCMinutes(),N<<=5,N|=U.getUTCSeconds()/2,k=U.getUTCFullYear()-1980,k<<=4,k|=U.getUTCMonth()+1,k<<=5,k|=U.getUTCDate(),A&&(I=i(1,1)+i(d(O),4)+R,z+="up"+i(I.length,2)+I),M&&(B=i(1,1)+i(d($),4)+L,z+="uc"+i(B.length,2)+B);var ee="";return ee+=`
\0`,ee+=i(K,2),ee+=E.magic,ee+=i(N,2),ee+=i(k,2),ee+=i(V.crc32,4),ee+=i(V.compressedSize,4),ee+=i(V.uncompressedSize,4),ee+=i(O.length,2),ee+=i(z.length,2),{fileRecord:f.LOCAL_FILE_HEADER+ee+O+z,dirRecord:f.CENTRAL_FILE_HEADER+i(J,2)+ee+i($.length,2)+"\0\0\0\0"+i(G,4)+i(y,4)+O+z+$}}var l=r("../utils"),c=r("../stream/GenericWorker"),u=r("../utf8"),d=r("../crc32"),f=r("../signature");function m(p,v,b,y){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=b,this.encodeFileName=y,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(m,c),m.prototype.push=function(p){var v=p.meta.percent||0,b=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:b?(v+100*(b-y-1))/b:100}}))},m.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var v=this.streamFiles&&!p.file.dir;if(v){var b=s(p,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(p){this.accumulate=!1;var v=this.streamFiles&&!p.file.dir,b=s(p,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),v)this.push({data:(function(y){return f.DATA_DESCRIPTOR+i(y.crc32,4)+i(y.compressedSize,4)+i(y.uncompressedSize,4)})(p),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var p=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var b=this.bytesWritten-p,y=(function(S,_,N,k,j){var E=l.transformTo("string",j(k));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(S,2)+i(S,2)+i(_,4)+i(N,4)+i(E.length,2)+E})(this.dirRecords.length,b,p,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(p){this._sources.push(p);var v=this;return p.on("data",function(b){v.processChunk(b)}),p.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),p.on("error",function(b){v.error(b)}),this},m.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(p){var v=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var b=0;b<v.length;b++)try{v[b].error(p)}catch{}return!0},m.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,v=0;v<p.length;v++)p[v].lock()},n.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,a){var i=r("../compressions"),s=r("./ZipFileWorker");a.generateWorker=function(l,c,u){var d=new s(c.streamFiles,u,c.platform,c.encodeFileName),f=0;try{l.forEach(function(m,p){f++;var v=(function(_,N){var k=_||N,j=i[k];if(!j)throw new Error(k+" is not a valid compression method !");return j})(p.options.compression,c.compression),b=p.options.compressionOptions||c.compressionOptions||{},y=p.dir,S=p.date;p._compressWorker(v,b).withStreamInfo("file",{name:m,dir:y,date:S,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(d)}),d.entriesCount=f}catch(m){d.error(m)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var l in this)typeof this[l]!="function"&&(s[l]=this[l]);return s}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(s,l){return new i().loadAsync(s,l)},i.external=r("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,a){var i=r("./utils"),s=r("./external"),l=r("./utf8"),c=r("./zipEntries"),u=r("./stream/Crc32Probe"),d=r("./nodejsUtils");function f(m){return new s.Promise(function(p,v){var b=m.decompressed.getContentWorker().pipe(new u);b.on("error",function(y){v(y)}).on("end",function(){b.streamInfo.crc32!==m.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}n.exports=function(m,p){var v=this;return p=i.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(m)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",m,!0,p.optimizedBinaryString,p.base64).then(function(b){var y=new c(p);return y.load(b),y}).then(function(b){var y=[s.Promise.resolve(b)],S=b.files;if(p.checkCRC32)for(var _=0;_<S.length;_++)y.push(f(S[_]));return s.Promise.all(y)}).then(function(b){for(var y=b.shift(),S=y.files,_=0;_<S.length;_++){var N=S[_],k=N.fileNameStr,j=i.resolve(N.fileNameStr);v.file(j,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:p.createFolders}),N.dir||(v.file(j).unsafeOriginalName=k)}return y.zipComment.length&&(v.comment=y.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,a){var i=r("../utils"),s=r("../stream/GenericWorker");function l(c,u){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(l,s),l.prototype._bindStream=function(c){var u=this;(this._stream=c).pause(),c.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},l.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,a){var i=r("readable-stream").Readable;function s(l,c,u){i.call(this,c),this._helper=l;var d=this;l.on("data",function(f,m){d.push(f)||d._helper.pause(),u&&u(m)}).on("error",function(f){d.emit("error",f)}).on("end",function(){d.push(null)})}r("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,n,a){function i(j,E,T){var O,R=l.getTypeOf(E),q=l.extend(T||{},d);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(j=S(j)),q.createFolders&&(O=y(j))&&_.call(this,O,!0);var $=R==="string"&&q.binary===!1&&q.base64===!1;T&&T.binary!==void 0||(q.binary=!$),(E instanceof f&&E.uncompressedSize===0||q.dir||!E||E.length===0)&&(q.base64=!1,q.binary=!0,E="",q.compression="STORE",R="string");var L=null;L=E instanceof f||E instanceof c?E:v.isNode&&v.isStream(E)?new b(j,E):l.prepareContent(j,E,q.binary,q.optimizedBinaryString,q.base64);var A=new m(j,L,q);this.files[j]=A}var s=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),u=r("./stream/StreamHelper"),d=r("./defaults"),f=r("./compressedObject"),m=r("./zipObject"),p=r("./generate"),v=r("./nodejsUtils"),b=r("./nodejs/NodejsStreamInputAdapter"),y=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var E=j.lastIndexOf("/");return 0<E?j.substring(0,E):""},S=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},_=function(j,E){return E=E!==void 0?E:d.createFolders,j=S(j),this.files[j]||i.call(this,j,null,{dir:!0,createFolders:E}),this.files[j]};function N(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var E,T,O;for(E in this.files)O=this.files[E],(T=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&j(T,O)},filter:function(j){var E=[];return this.forEach(function(T,O){j(T,O)&&E.push(O)}),E},file:function(j,E,T){if(arguments.length!==1)return j=this.root+j,i.call(this,j,E,T),this;if(N(j)){var O=j;return this.filter(function(q,$){return!$.dir&&O.test(q)})}var R=this.files[this.root+j];return R&&!R.dir?R:null},folder:function(j){if(!j)return this;if(N(j))return this.filter(function(R,q){return q.dir&&j.test(R)});var E=this.root+j,T=_.call(this,E),O=this.clone();return O.root=T.name,O},remove:function(j){j=this.root+j;var E=this.files[j];if(E||(j.slice(-1)!=="/"&&(j+="/"),E=this.files[j]),E&&!E.dir)delete this.files[j];else for(var T=this.filter(function(R,q){return q.name.slice(0,j.length)===j}),O=0;O<T.length;O++)delete this.files[T[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var E,T={};try{if((T=l.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");l.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var O=T.comment||this.comment||"";E=p.generateWorker(this,T,O)}catch(R){(E=new c("error")).error(R)}return new u(E,T.type||"string",T.mimeType)},generateAsync:function(j,E){return this.generateInternalStream(j).accumulate(E)},generateNodeStream:function(j,E){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(E)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,a){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,a){var i=r("./DataReader");function s(l){i.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(s,i),s.prototype.byteAt=function(l){return this.data[this.zero+l]},s.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===c&&this.data[m+1]===u&&this.data[m+2]===d&&this.data[m+3]===f)return m-this.zero;return-1},s.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),m=this.readData(4);return c===m[0]&&u===m[1]&&d===m[2]&&f===m[3]},s.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,n,a){var i=r("../utils");function s(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,u=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)u=(u<<8)+this.byteAt(c);return this.index+=l,u},readString:function(l){return i.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=s},{"../utils":32}],19:[function(r,n,a){var i=r("./Uint8ArrayReader");function s(l){i.call(this,l)}r("../utils").inherits(s,i),s.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,a){var i=r("./DataReader");function s(l){i.call(this,l)}r("../utils").inherits(s,i),s.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},s.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},s.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},s.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,n,a){var i=r("./ArrayReader");function s(l){i.call(this,l)}r("../utils").inherits(s,i),s.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,a){var i=r("../utils"),s=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),u=r("./NodeBufferReader"),d=r("./Uint8ArrayReader");n.exports=function(f){var m=i.getTypeOf(f);return i.checkSupport(m),m!=="string"||s.uint8array?m==="nodebuffer"?new u(f):s.uint8array?new d(i.transformTo("uint8array",f)):new l(i.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,a){var i=r("./GenericWorker"),s=r("../utils");function l(c){i.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(l,i),l.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,a){var i=r("./GenericWorker"),s=r("../crc32");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,i),l.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,a){var i=r("../utils"),s=r("./GenericWorker");function l(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(l,s),l.prototype.processChunk=function(c){if(c){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+c.data.length}s.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,a){var i=r("../utils"),s=r("./GenericWorker");function l(c){s.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=i.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}i.inherits(l,s),l.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,u);break;case"uint8array":c=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":c=this.data.slice(this.index,u)}return this.index=u,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,l){return this._listeners[s].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,l){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,l)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var l=this;return s.on("data",function(c){l.processChunk(c)}),s.on("end",function(){l.end()}),s.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,l){return this.extraStreamInfo[s]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(r,n,a){var i=r("../utils"),s=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),u=r("../support"),d=r("../external"),f=null;if(u.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(v,b){return new d.Promise(function(y,S){var _=[],N=v._internalType,k=v._outputType,j=v._mimeType;v.on("data",function(E,T){_.push(E),b&&b(T)}).on("error",function(E){_=[],S(E)}).on("end",function(){try{var E=(function(T,O,R){switch(T){case"blob":return i.newBlob(i.transformTo("arraybuffer",O),R);case"base64":return c.encode(O);default:return i.transformTo(T,O)}})(k,(function(T,O){var R,q=0,$=null,L=0;for(R=0;R<O.length;R++)L+=O[R].length;switch(T){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for($=new Uint8Array(L),R=0;R<O.length;R++)$.set(O[R],q),q+=O[R].length;return $;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+T+"'")}})(N,_),j);y(E)}catch(T){S(T)}_=[]}).resume()})}function p(v,b,y){var S=b;switch(b){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=b,this._mimeType=y,i.checkSupport(S),this._worker=v.pipe(new s(S)),v.lock()}catch(_){this._worker=new l("error"),this._worker.error(_)}}p.prototype={accumulate:function(v){return m(this,v)},on:function(v,b){var y=this;return v==="data"?this._worker.on(v,function(S){b.call(y,S.data,S.meta)}):this._worker.on(v,function(){i.delay(b,arguments,y)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,a){for(var i=r("./utils"),s=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function m(){c.call(this,"utf-8 encode")}a.utf8encode=function(p){return s.nodebuffer?l.newBufferFrom(p,"utf-8"):(function(v){var b,y,S,_,N,k=v.length,j=0;for(_=0;_<k;_++)(64512&(y=v.charCodeAt(_)))==55296&&_+1<k&&(64512&(S=v.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(S-56320),_++),j+=y<128?1:y<2048?2:y<65536?3:4;for(b=s.uint8array?new Uint8Array(j):new Array(j),_=N=0;N<j;_++)(64512&(y=v.charCodeAt(_)))==55296&&_+1<k&&(64512&(S=v.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(S-56320),_++),y<128?b[N++]=y:(y<2048?b[N++]=192|y>>>6:(y<65536?b[N++]=224|y>>>12:(b[N++]=240|y>>>18,b[N++]=128|y>>>12&63),b[N++]=128|y>>>6&63),b[N++]=128|63&y);return b})(p)},a.utf8decode=function(p){return s.nodebuffer?i.transformTo("nodebuffer",p).toString("utf-8"):(function(v){var b,y,S,_,N=v.length,k=new Array(2*N);for(b=y=0;b<N;)if((S=v[b++])<128)k[y++]=S;else if(4<(_=u[S]))k[y++]=65533,b+=_-1;else{for(S&=_===2?31:_===3?15:7;1<_&&b<N;)S=S<<6|63&v[b++],_--;1<_?k[y++]=65533:S<65536?k[y++]=S:(S-=65536,k[y++]=55296|S>>10&1023,k[y++]=56320|1023&S)}return k.length!==y&&(k.subarray?k=k.subarray(0,y):k.length=y),i.applyFromCharCode(k)})(p=i.transformTo(s.uint8array?"uint8array":"array",p))},i.inherits(f,c),f.prototype.processChunk=function(p){var v=i.transformTo(s.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var b=v;(v=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),v.set(b,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var y=(function(_,N){var k;for((N=N||_.length)>_.length&&(N=_.length),k=N-1;0<=k&&(192&_[k])==128;)k--;return k<0||k===0?N:k+u[_[k]]>N?k:N})(v),S=v;y!==v.length&&(s.uint8array?(S=v.subarray(0,y),this.leftOver=v.subarray(y,v.length)):(S=v.slice(0,y),this.leftOver=v.slice(y,v.length))),this.push({data:a.utf8decode(S),meta:p.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=f,i.inherits(m,c),m.prototype.processChunk=function(p){this.push({data:a.utf8encode(p.data),meta:p.meta})},a.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,a){var i=r("./support"),s=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function u(b){return b}function d(b,y){for(var S=0;S<b.length;++S)y[S]=255&b.charCodeAt(S);return y}r("setimmediate"),a.newBlob=function(b,y){a.checkSupport("blob");try{return new Blob([b],{type:y})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(b),S.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(b,y,S){var _=[],N=0,k=b.length;if(k<=S)return String.fromCharCode.apply(null,b);for(;N<k;)y==="array"||y==="nodebuffer"?_.push(String.fromCharCode.apply(null,b.slice(N,Math.min(N+S,k)))):_.push(String.fromCharCode.apply(null,b.subarray(N,Math.min(N+S,k)))),N+=S;return _.join("")},stringifyByChar:function(b){for(var y="",S=0;S<b.length;S++)y+=String.fromCharCode(b[S]);return y},applyCanBeUsed:{uint8array:(function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}})()}};function m(b){var y=65536,S=a.getTypeOf(b),_=!0;if(S==="uint8array"?_=f.applyCanBeUsed.uint8array:S==="nodebuffer"&&(_=f.applyCanBeUsed.nodebuffer),_)for(;1<y;)try{return f.stringifyByChunk(b,S,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(b)}function p(b,y){for(var S=0;S<b.length;S++)y[S]=b[S];return y}a.applyFromCharCode=m;var v={};v.string={string:u,array:function(b){return d(b,new Array(b.length))},arraybuffer:function(b){return v.string.uint8array(b).buffer},uint8array:function(b){return d(b,new Uint8Array(b.length))},nodebuffer:function(b){return d(b,l.allocBuffer(b.length))}},v.array={string:m,array:u,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return l.newBufferFrom(b)}},v.arraybuffer={string:function(b){return m(new Uint8Array(b))},array:function(b){return p(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:u,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return l.newBufferFrom(new Uint8Array(b))}},v.uint8array={string:m,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:u,nodebuffer:function(b){return l.newBufferFrom(b)}},v.nodebuffer={string:m,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return v.nodebuffer.uint8array(b).buffer},uint8array:function(b){return p(b,new Uint8Array(b.length))},nodebuffer:u},a.transformTo=function(b,y){if(y=y||"",!b)return y;a.checkSupport(b);var S=a.getTypeOf(y);return v[S][b](y)},a.resolve=function(b){for(var y=b.split("/"),S=[],_=0;_<y.length;_++){var N=y[_];N==="."||N===""&&_!==0&&_!==y.length-1||(N===".."?S.pop():S.push(N))}return S.join("/")},a.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&l.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(b){var y,S,_="";for(S=0;S<(b||"").length;S++)_+="\\x"+((y=b.charCodeAt(S))<16?"0":"")+y.toString(16).toUpperCase();return _},a.delay=function(b,y,S){setImmediate(function(){b.apply(S||null,y||[])})},a.inherits=function(b,y){function S(){}S.prototype=y.prototype,b.prototype=new S},a.extend=function(){var b,y,S={};for(b=0;b<arguments.length;b++)for(y in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],y)&&S[y]===void 0&&(S[y]=arguments[b][y]);return S},a.prepareContent=function(b,y,S,_,N){return c.Promise.resolve(y).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(j,E){var T=new FileReader;T.onload=function(O){j(O.target.result)},T.onerror=function(O){E(O.target.error)},T.readAsArrayBuffer(k)}):k}).then(function(k){var j=a.getTypeOf(k);return j?(j==="arraybuffer"?k=a.transformTo("uint8array",k):j==="string"&&(N?k=s.decode(k):S&&_!==!0&&(k=(function(E){return d(E,i.uint8array?new Uint8Array(E.length):new Array(E.length))})(k))),k):c.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,a){var i=r("./reader/readerFor"),s=r("./utils"),l=r("./signature"),c=r("./zipEntry"),u=r("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(m)+", expected "+s.pretty(f)+")")}},isSignature:function(f,m){var p=this.reader.index;this.reader.setIndex(f);var v=this.reader.readString(4)===m;return this.reader.setIndex(p),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),m=u.uint8array?"uint8array":"array",p=s.transformTo(m,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,m,p,v=this.zip64EndOfCentralSize-44;0<v;)f=this.reader.readInt(2),m=this.reader.readInt(4),p=this.reader.readData(m),this.zip64ExtensibleData[f]={id:f,length:m,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,m;for(f=0;f<this.files.length;f++)m=this.files[f],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var m=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var v=m-p;if(0<v)this.isSignature(m,l.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(f){this.reader=i(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,a){var i=r("./reader/readerFor"),s=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),u=r("./utf8"),d=r("./compressions"),f=r("./support");function m(p,v){this.options=p,this.loadOptions=v}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var v,b;if(p.skip(22),this.fileNameLength=p.readInt(2),b=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=(function(y){for(var S in d)if(Object.prototype.hasOwnProperty.call(d,S)&&d[S].magic===y)return d[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,v,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var v=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(v),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var v,b,y,S=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<S;)v=p.readInt(2),b=p.readInt(2),y=p.readData(b),this.extraFields[v]={id:v,length:b,value:y};p.setIndex(S)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var b=s.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var S=s.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var v=i(p.value);return v.readInt(1)!==1||c(this.fileName)!==v.readInt(4)?null:u.utf8decode(v.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var v=i(p.value);return v.readInt(1)!==1||c(this.fileComment)!==v.readInt(4)?null:u.utf8decode(v.readData(p.length-5))}return null}},n.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,a){function i(v,b,y){this.name=v,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=b,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var s=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),u=r("./compressedObject"),d=r("./stream/GenericWorker");i.prototype={internalStream:function(v){var b=null,y="string";try{if(!v)throw new Error("No output type specified.");var S=(y=v.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),b=this._decompressWorker();var _=!this._dataBinary;_&&!S&&(b=b.pipe(new c.Utf8EncodeWorker)),!_&&S&&(b=b.pipe(new c.Utf8DecodeWorker))}catch(N){(b=new d("error")).error(N)}return new s(b,y,"")},async:function(v,b){return this.internalStream(v).accumulate(b)},nodeStream:function(v,b){return this.internalStream(v||"nodebuffer").toNodejsStream(b)},_compressWorker:function(v,b){if(this._data instanceof u&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new c.Utf8EncodeWorker)),u.createWorkerFrom(y,v,b)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)i.prototype[f[p]]=m;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,a){(function(i){var s,l,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var u=0,d=new c(v),f=i.document.createTextNode("");d.observe(f,{characterData:!0}),s=function(){f.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){v(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(v,0)};else{var m=new i.MessageChannel;m.port1.onmessage=v,s=function(){m.port2.postMessage(0)}}var p=[];function v(){var b,y;l=!0;for(var S=p.length;S;){for(y=p,p=[],b=-1;++b<S;)y[b]();S=p.length}l=!1}n.exports=function(b){p.push(b)!==1||l||s()}}).call(this,typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,a){var i=r("immediate");function s(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function f(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==s&&b(this,S)}function m(S,_,N){this.promise=S,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function p(S,_,N){i(function(){var k;try{k=_(N)}catch(j){return l.reject(S,j)}k===S?l.reject(S,new TypeError("Cannot resolve promise with itself")):l.resolve(S,k)})}function v(S){var _=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof _=="function")return function(){_.apply(S,arguments)}}function b(S,_){var N=!1;function k(T){N||(N=!0,l.reject(S,T))}function j(T){N||(N=!0,l.resolve(S,T))}var E=y(function(){_(j,k)});E.status==="error"&&k(E.value)}function y(S,_){var N={};try{N.value=S(_),N.status="success"}catch(k){N.status="error",N.value=k}return N}(n.exports=f).prototype.finally=function(S){if(typeof S!="function")return this;var _=this.constructor;return this.then(function(N){return _.resolve(S()).then(function(){return N})},function(N){return _.resolve(S()).then(function(){throw N})})},f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,_){if(typeof S!="function"&&this.state===u||typeof _!="function"&&this.state===c)return this;var N=new this.constructor(s);return this.state!==d?p(N,this.state===u?S:_,this.outcome):this.queue.push(new m(N,S,_)),N},m.prototype.callFulfilled=function(S){l.resolve(this.promise,S)},m.prototype.otherCallFulfilled=function(S){p(this.promise,this.onFulfilled,S)},m.prototype.callRejected=function(S){l.reject(this.promise,S)},m.prototype.otherCallRejected=function(S){p(this.promise,this.onRejected,S)},l.resolve=function(S,_){var N=y(v,_);if(N.status==="error")return l.reject(S,N.value);var k=N.value;if(k)b(S,k);else{S.state=u,S.outcome=_;for(var j=-1,E=S.queue.length;++j<E;)S.queue[j].callFulfilled(_)}return S},l.reject=function(S,_){S.state=c,S.outcome=_;for(var N=-1,k=S.queue.length;++N<k;)S.queue[N].callRejected(_);return S},f.resolve=function(S){return S instanceof this?S:l.resolve(new this(s),S)},f.reject=function(S){var _=new this(s);return l.reject(_,S)},f.all=function(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=S.length,k=!1;if(!N)return this.resolve([]);for(var j=new Array(N),E=0,T=-1,O=new this(s);++T<N;)R(S[T],T);return O;function R(q,$){_.resolve(q).then(function(L){j[$]=L,++E!==N||k||(k=!0,l.resolve(O,j))},function(L){k||(k=!0,l.reject(O,L))})}},f.race=function(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=S.length,k=!1;if(!N)return this.resolve([]);for(var j=-1,E=new this(s);++j<N;)T=S[j],_.resolve(T).then(function(O){k||(k=!0,l.resolve(E,O))},function(O){k||(k=!0,l.reject(E,O))});var T;return E}},{immediate:36}],38:[function(r,n,a){var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,a){var i=r("./zlib/deflate"),s=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),u=r("./zlib/zstream"),d=Object.prototype.toString,f=0,m=-1,p=0,v=8;function b(S){if(!(this instanceof b))return new b(S);this.options=s.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},S||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var N=i.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(N!==f)throw new Error(c[N]);if(_.header&&i.deflateSetHeader(this.strm,_.header),_.dictionary){var k;if(k=typeof _.dictionary=="string"?l.string2buf(_.dictionary):d.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(N=i.deflateSetDictionary(this.strm,k))!==f)throw new Error(c[N]);this._dict_set=!0}}function y(S,_){var N=new b(_);if(N.push(S,!0),N.err)throw N.msg||c[N.err];return N.result}b.prototype.push=function(S,_){var N,k,j=this.strm,E=this.options.chunkSize;if(this.ended)return!1;k=_===~~_?_:_===!0?4:0,typeof S=="string"?j.input=l.string2buf(S):d.call(S)==="[object ArrayBuffer]"?j.input=new Uint8Array(S):j.input=S,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new s.Buf8(E),j.next_out=0,j.avail_out=E),(N=i.deflate(j,k))!==1&&N!==f)return this.onEnd(N),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(s.shrinkBuf(j.output,j.next_out))):this.onData(s.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&N!==1);return k===4?(N=i.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===f):k!==2||(this.onEnd(f),!(j.avail_out=0))},b.prototype.onData=function(S){this.chunks.push(S)},b.prototype.onEnd=function(S){S===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},a.Deflate=b,a.deflate=y,a.deflateRaw=function(S,_){return(_=_||{}).raw=!0,y(S,_)},a.gzip=function(S,_){return(_=_||{}).gzip=!0,y(S,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,a){var i=r("./zlib/inflate"),s=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),u=r("./zlib/messages"),d=r("./zlib/zstream"),f=r("./zlib/gzheader"),m=Object.prototype.toString;function p(b){if(!(this instanceof p))return new p(b);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},b||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||b&&b.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var S=i.inflateInit2(this.strm,y.windowBits);if(S!==c.Z_OK)throw new Error(u[S]);this.header=new f,i.inflateGetHeader(this.strm,this.header)}function v(b,y){var S=new p(y);if(S.push(b,!0),S.err)throw S.msg||u[S.err];return S.result}p.prototype.push=function(b,y){var S,_,N,k,j,E,T=this.strm,O=this.options.chunkSize,R=this.options.dictionary,q=!1;if(this.ended)return!1;_=y===~~y?y:y===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof b=="string"?T.input=l.binstring2buf(b):m.call(b)==="[object ArrayBuffer]"?T.input=new Uint8Array(b):T.input=b,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new s.Buf8(O),T.next_out=0,T.avail_out=O),(S=i.inflate(T,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&R&&(E=typeof R=="string"?l.string2buf(R):m.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,S=i.inflateSetDictionary(this.strm,E)),S===c.Z_BUF_ERROR&&q===!0&&(S=c.Z_OK,q=!1),S!==c.Z_STREAM_END&&S!==c.Z_OK)return this.onEnd(S),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&S!==c.Z_STREAM_END&&(T.avail_in!==0||_!==c.Z_FINISH&&_!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=l.utf8border(T.output,T.next_out),k=T.next_out-N,j=l.buf2string(T.output,N),T.next_out=k,T.avail_out=O-k,k&&s.arraySet(T.output,T.output,N,k,0),this.onData(j)):this.onData(s.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(q=!0)}while((0<T.avail_in||T.avail_out===0)&&S!==c.Z_STREAM_END);return S===c.Z_STREAM_END&&(_=c.Z_FINISH),_===c.Z_FINISH?(S=i.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===c.Z_OK):_!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(T.avail_out=0))},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},a.Inflate=p,a.inflate=v,a.inflateRaw=function(b,y){return(y=y||{}).raw=!0,v(b,y)},a.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(c){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])}}return c},a.shrinkBuf=function(c,u){return c.length===u?c:c.subarray?c.subarray(0,u):(c.length=u,c)};var s={arraySet:function(c,u,d,f,m){if(u.subarray&&c.subarray)c.set(u.subarray(d,d+f),m);else for(var p=0;p<f;p++)c[m+p]=u[d+p]},flattenChunks:function(c){var u,d,f,m,p,v;for(u=f=0,d=c.length;u<d;u++)f+=c[u].length;for(v=new Uint8Array(f),u=m=0,d=c.length;u<d;u++)p=c[u],v.set(p,m),m+=p.length;return v}},l={arraySet:function(c,u,d,f,m){for(var p=0;p<f;p++)c[m+p]=u[d+p]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,l))},a.setTyped(i)},{}],42:[function(r,n,a){var i=r("./common"),s=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new i.Buf8(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(f,m){if(m<65537&&(f.subarray&&l||!f.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(f,m));for(var p="",v=0;v<m;v++)p+=String.fromCharCode(f[v]);return p}c[254]=c[254]=1,a.string2buf=function(f){var m,p,v,b,y,S=f.length,_=0;for(b=0;b<S;b++)(64512&(p=f.charCodeAt(b)))==55296&&b+1<S&&(64512&(v=f.charCodeAt(b+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),b++),_+=p<128?1:p<2048?2:p<65536?3:4;for(m=new i.Buf8(_),b=y=0;y<_;b++)(64512&(p=f.charCodeAt(b)))==55296&&b+1<S&&(64512&(v=f.charCodeAt(b+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),b++),p<128?m[y++]=p:(p<2048?m[y++]=192|p>>>6:(p<65536?m[y++]=224|p>>>12:(m[y++]=240|p>>>18,m[y++]=128|p>>>12&63),m[y++]=128|p>>>6&63),m[y++]=128|63&p);return m},a.buf2binstring=function(f){return d(f,f.length)},a.binstring2buf=function(f){for(var m=new i.Buf8(f.length),p=0,v=m.length;p<v;p++)m[p]=f.charCodeAt(p);return m},a.buf2string=function(f,m){var p,v,b,y,S=m||f.length,_=new Array(2*S);for(p=v=0;p<S;)if((b=f[p++])<128)_[v++]=b;else if(4<(y=c[b]))_[v++]=65533,p+=y-1;else{for(b&=y===2?31:y===3?15:7;1<y&&p<S;)b=b<<6|63&f[p++],y--;1<y?_[v++]=65533:b<65536?_[v++]=b:(b-=65536,_[v++]=55296|b>>10&1023,_[v++]=56320|1023&b)}return d(_,v)},a.utf8border=function(f,m){var p;for((m=m||f.length)>f.length&&(m=f.length),p=m-1;0<=p&&(192&f[p])==128;)p--;return p<0||p===0?m:p+c[f[p]]>m?p:m}},{"./common":41}],43:[function(r,n,a){n.exports=function(i,s,l,c){for(var u=65535&i|0,d=i>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;d=d+(u=u+s[c++]|0)|0,--f;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(r,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,a){var i=(function(){for(var s,l=[],c=0;c<256;c++){s=c;for(var u=0;u<8;u++)s=1&s?3988292384^s>>>1:s>>>1;l[c]=s}return l})();n.exports=function(s,l,c,u){var d=i,f=u+c;s^=-1;for(var m=u;m<f;m++)s=s>>>8^d[255&(s^l[m])];return-1^s}},{}],46:[function(r,n,a){var i,s=r("../utils/common"),l=r("./trees"),c=r("./adler32"),u=r("./crc32"),d=r("./messages"),f=0,m=4,p=0,v=-2,b=-1,y=4,S=2,_=8,N=9,k=286,j=30,E=19,T=2*k+1,O=15,R=3,q=258,$=q+R+1,L=42,A=113,M=1,z=2,I=3,B=4;function F(H,ge){return H.msg=d[ge],ge}function U(H){return(H<<1)-(4<H?9:0)}function V(H){for(var ge=H.length;0<=--ge;)H[ge]=0}function K(H){var ge=H.state,de=ge.pending;de>H.avail_out&&(de=H.avail_out),de!==0&&(s.arraySet(H.output,ge.pending_buf,ge.pending_out,de,H.next_out),H.next_out+=de,ge.pending_out+=de,H.total_out+=de,H.avail_out-=de,ge.pending-=de,ge.pending===0&&(ge.pending_out=0))}function G(H,ge){l._tr_flush_block(H,0<=H.block_start?H.block_start:-1,H.strstart-H.block_start,ge),H.block_start=H.strstart,K(H.strm)}function J(H,ge){H.pending_buf[H.pending++]=ge}function ee(H,ge){H.pending_buf[H.pending++]=ge>>>8&255,H.pending_buf[H.pending++]=255&ge}function Y(H,ge){var de,re,ne=H.max_chain_length,pe=H.strstart,ke=H.prev_length,we=H.nice_match,ve=H.strstart>H.w_size-$?H.strstart-(H.w_size-$):0,Le=H.window,Ae=H.w_mask,Re=H.prev,Ye=H.strstart+q,mt=Le[pe+ke-1],ot=Le[pe+ke];H.prev_length>=H.good_match&&(ne>>=2),we>H.lookahead&&(we=H.lookahead);do if(Le[(de=ge)+ke]===ot&&Le[de+ke-1]===mt&&Le[de]===Le[pe]&&Le[++de]===Le[pe+1]){pe+=2,de++;do;while(Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&Le[++pe]===Le[++de]&&pe<Ye);if(re=q-(Ye-pe),pe=Ye-q,ke<re){if(H.match_start=ge,we<=(ke=re))break;mt=Le[pe+ke-1],ot=Le[pe+ke]}}while((ge=Re[ge&Ae])>ve&&--ne!=0);return ke<=H.lookahead?ke:H.lookahead}function ie(H){var ge,de,re,ne,pe,ke,we,ve,Le,Ae,Re=H.w_size;do{if(ne=H.window_size-H.lookahead-H.strstart,H.strstart>=Re+(Re-$)){for(s.arraySet(H.window,H.window,Re,Re,0),H.match_start-=Re,H.strstart-=Re,H.block_start-=Re,ge=de=H.hash_size;re=H.head[--ge],H.head[ge]=Re<=re?re-Re:0,--de;);for(ge=de=Re;re=H.prev[--ge],H.prev[ge]=Re<=re?re-Re:0,--de;);ne+=Re}if(H.strm.avail_in===0)break;if(ke=H.strm,we=H.window,ve=H.strstart+H.lookahead,Le=ne,Ae=void 0,Ae=ke.avail_in,Le<Ae&&(Ae=Le),de=Ae===0?0:(ke.avail_in-=Ae,s.arraySet(we,ke.input,ke.next_in,Ae,ve),ke.state.wrap===1?ke.adler=c(ke.adler,we,Ae,ve):ke.state.wrap===2&&(ke.adler=u(ke.adler,we,Ae,ve)),ke.next_in+=Ae,ke.total_in+=Ae,Ae),H.lookahead+=de,H.lookahead+H.insert>=R)for(pe=H.strstart-H.insert,H.ins_h=H.window[pe],H.ins_h=(H.ins_h<<H.hash_shift^H.window[pe+1])&H.hash_mask;H.insert&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[pe+R-1])&H.hash_mask,H.prev[pe&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=pe,pe++,H.insert--,!(H.lookahead+H.insert<R)););}while(H.lookahead<$&&H.strm.avail_in!==0)}function fe(H,ge){for(var de,re;;){if(H.lookahead<$){if(ie(H),H.lookahead<$&&ge===f)return M;if(H.lookahead===0)break}if(de=0,H.lookahead>=R&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+R-1])&H.hash_mask,de=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart),de!==0&&H.strstart-de<=H.w_size-$&&(H.match_length=Y(H,de)),H.match_length>=R)if(re=l._tr_tally(H,H.strstart-H.match_start,H.match_length-R),H.lookahead-=H.match_length,H.match_length<=H.max_lazy_match&&H.lookahead>=R){for(H.match_length--;H.strstart++,H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+R-1])&H.hash_mask,de=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart,--H.match_length!=0;);H.strstart++}else H.strstart+=H.match_length,H.match_length=0,H.ins_h=H.window[H.strstart],H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+1])&H.hash_mask;else re=l._tr_tally(H,0,H.window[H.strstart]),H.lookahead--,H.strstart++;if(re&&(G(H,!1),H.strm.avail_out===0))return M}return H.insert=H.strstart<R-1?H.strstart:R-1,ge===m?(G(H,!0),H.strm.avail_out===0?I:B):H.last_lit&&(G(H,!1),H.strm.avail_out===0)?M:z}function me(H,ge){for(var de,re,ne;;){if(H.lookahead<$){if(ie(H),H.lookahead<$&&ge===f)return M;if(H.lookahead===0)break}if(de=0,H.lookahead>=R&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+R-1])&H.hash_mask,de=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart),H.prev_length=H.match_length,H.prev_match=H.match_start,H.match_length=R-1,de!==0&&H.prev_length<H.max_lazy_match&&H.strstart-de<=H.w_size-$&&(H.match_length=Y(H,de),H.match_length<=5&&(H.strategy===1||H.match_length===R&&4096<H.strstart-H.match_start)&&(H.match_length=R-1)),H.prev_length>=R&&H.match_length<=H.prev_length){for(ne=H.strstart+H.lookahead-R,re=l._tr_tally(H,H.strstart-1-H.prev_match,H.prev_length-R),H.lookahead-=H.prev_length-1,H.prev_length-=2;++H.strstart<=ne&&(H.ins_h=(H.ins_h<<H.hash_shift^H.window[H.strstart+R-1])&H.hash_mask,de=H.prev[H.strstart&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=H.strstart),--H.prev_length!=0;);if(H.match_available=0,H.match_length=R-1,H.strstart++,re&&(G(H,!1),H.strm.avail_out===0))return M}else if(H.match_available){if((re=l._tr_tally(H,0,H.window[H.strstart-1]))&&G(H,!1),H.strstart++,H.lookahead--,H.strm.avail_out===0)return M}else H.match_available=1,H.strstart++,H.lookahead--}return H.match_available&&(re=l._tr_tally(H,0,H.window[H.strstart-1]),H.match_available=0),H.insert=H.strstart<R-1?H.strstart:R-1,ge===m?(G(H,!0),H.strm.avail_out===0?I:B):H.last_lit&&(G(H,!1),H.strm.avail_out===0)?M:z}function te(H,ge,de,re,ne){this.good_length=H,this.max_lazy=ge,this.nice_length=de,this.max_chain=re,this.func=ne}function oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*T),this.dyn_dtree=new s.Buf16(2*(2*j+1)),this.bl_tree=new s.Buf16(2*(2*E+1)),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(O+1),this.heap=new s.Buf16(2*k+1),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(H){var ge;return H&&H.state?(H.total_in=H.total_out=0,H.data_type=S,(ge=H.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?L:A,H.adler=ge.wrap===2?0:1,ge.last_flush=f,l._tr_init(ge),p):F(H,v)}function Z(H){var ge=ce(H);return ge===p&&(function(de){de.window_size=2*de.w_size,V(de.head),de.max_lazy_match=i[de.level].max_lazy,de.good_match=i[de.level].good_length,de.nice_match=i[de.level].nice_length,de.max_chain_length=i[de.level].max_chain,de.strstart=0,de.block_start=0,de.lookahead=0,de.insert=0,de.match_length=de.prev_length=R-1,de.match_available=0,de.ins_h=0})(H.state),ge}function ue(H,ge,de,re,ne,pe){if(!H)return v;var ke=1;if(ge===b&&(ge=6),re<0?(ke=0,re=-re):15<re&&(ke=2,re-=16),ne<1||N<ne||de!==_||re<8||15<re||ge<0||9<ge||pe<0||y<pe)return F(H,v);re===8&&(re=9);var we=new oe;return(H.state=we).strm=H,we.wrap=ke,we.gzhead=null,we.w_bits=re,we.w_size=1<<we.w_bits,we.w_mask=we.w_size-1,we.hash_bits=ne+7,we.hash_size=1<<we.hash_bits,we.hash_mask=we.hash_size-1,we.hash_shift=~~((we.hash_bits+R-1)/R),we.window=new s.Buf8(2*we.w_size),we.head=new s.Buf16(we.hash_size),we.prev=new s.Buf16(we.w_size),we.lit_bufsize=1<<ne+6,we.pending_buf_size=4*we.lit_bufsize,we.pending_buf=new s.Buf8(we.pending_buf_size),we.d_buf=1*we.lit_bufsize,we.l_buf=3*we.lit_bufsize,we.level=ge,we.strategy=pe,we.method=de,Z(H)}i=[new te(0,0,0,0,function(H,ge){var de=65535;for(de>H.pending_buf_size-5&&(de=H.pending_buf_size-5);;){if(H.lookahead<=1){if(ie(H),H.lookahead===0&&ge===f)return M;if(H.lookahead===0)break}H.strstart+=H.lookahead,H.lookahead=0;var re=H.block_start+de;if((H.strstart===0||H.strstart>=re)&&(H.lookahead=H.strstart-re,H.strstart=re,G(H,!1),H.strm.avail_out===0)||H.strstart-H.block_start>=H.w_size-$&&(G(H,!1),H.strm.avail_out===0))return M}return H.insert=0,ge===m?(G(H,!0),H.strm.avail_out===0?I:B):(H.strstart>H.block_start&&(G(H,!1),H.strm.avail_out),M)}),new te(4,4,8,4,fe),new te(4,5,16,8,fe),new te(4,6,32,32,fe),new te(4,4,16,16,me),new te(8,16,32,32,me),new te(8,16,128,128,me),new te(8,32,128,256,me),new te(32,128,258,1024,me),new te(32,258,258,4096,me)],a.deflateInit=function(H,ge){return ue(H,ge,_,15,8,0)},a.deflateInit2=ue,a.deflateReset=Z,a.deflateResetKeep=ce,a.deflateSetHeader=function(H,ge){return H&&H.state?H.state.wrap!==2?v:(H.state.gzhead=ge,p):v},a.deflate=function(H,ge){var de,re,ne,pe;if(!H||!H.state||5<ge||ge<0)return H?F(H,v):v;if(re=H.state,!H.output||!H.input&&H.avail_in!==0||re.status===666&&ge!==m)return F(H,H.avail_out===0?-5:v);if(re.strm=H,de=re.last_flush,re.last_flush=ge,re.status===L)if(re.wrap===2)H.adler=0,J(re,31),J(re,139),J(re,8),re.gzhead?(J(re,(re.gzhead.text?1:0)+(re.gzhead.hcrc?2:0)+(re.gzhead.extra?4:0)+(re.gzhead.name?8:0)+(re.gzhead.comment?16:0)),J(re,255&re.gzhead.time),J(re,re.gzhead.time>>8&255),J(re,re.gzhead.time>>16&255),J(re,re.gzhead.time>>24&255),J(re,re.level===9?2:2<=re.strategy||re.level<2?4:0),J(re,255&re.gzhead.os),re.gzhead.extra&&re.gzhead.extra.length&&(J(re,255&re.gzhead.extra.length),J(re,re.gzhead.extra.length>>8&255)),re.gzhead.hcrc&&(H.adler=u(H.adler,re.pending_buf,re.pending,0)),re.gzindex=0,re.status=69):(J(re,0),J(re,0),J(re,0),J(re,0),J(re,0),J(re,re.level===9?2:2<=re.strategy||re.level<2?4:0),J(re,3),re.status=A);else{var ke=_+(re.w_bits-8<<4)<<8;ke|=(2<=re.strategy||re.level<2?0:re.level<6?1:re.level===6?2:3)<<6,re.strstart!==0&&(ke|=32),ke+=31-ke%31,re.status=A,ee(re,ke),re.strstart!==0&&(ee(re,H.adler>>>16),ee(re,65535&H.adler)),H.adler=1}if(re.status===69)if(re.gzhead.extra){for(ne=re.pending;re.gzindex<(65535&re.gzhead.extra.length)&&(re.pending!==re.pending_buf_size||(re.gzhead.hcrc&&re.pending>ne&&(H.adler=u(H.adler,re.pending_buf,re.pending-ne,ne)),K(H),ne=re.pending,re.pending!==re.pending_buf_size));)J(re,255&re.gzhead.extra[re.gzindex]),re.gzindex++;re.gzhead.hcrc&&re.pending>ne&&(H.adler=u(H.adler,re.pending_buf,re.pending-ne,ne)),re.gzindex===re.gzhead.extra.length&&(re.gzindex=0,re.status=73)}else re.status=73;if(re.status===73)if(re.gzhead.name){ne=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ne&&(H.adler=u(H.adler,re.pending_buf,re.pending-ne,ne)),K(H),ne=re.pending,re.pending===re.pending_buf_size)){pe=1;break}pe=re.gzindex<re.gzhead.name.length?255&re.gzhead.name.charCodeAt(re.gzindex++):0,J(re,pe)}while(pe!==0);re.gzhead.hcrc&&re.pending>ne&&(H.adler=u(H.adler,re.pending_buf,re.pending-ne,ne)),pe===0&&(re.gzindex=0,re.status=91)}else re.status=91;if(re.status===91)if(re.gzhead.comment){ne=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ne&&(H.adler=u(H.adler,re.pending_buf,re.pending-ne,ne)),K(H),ne=re.pending,re.pending===re.pending_buf_size)){pe=1;break}pe=re.gzindex<re.gzhead.comment.length?255&re.gzhead.comment.charCodeAt(re.gzindex++):0,J(re,pe)}while(pe!==0);re.gzhead.hcrc&&re.pending>ne&&(H.adler=u(H.adler,re.pending_buf,re.pending-ne,ne)),pe===0&&(re.status=103)}else re.status=103;if(re.status===103&&(re.gzhead.hcrc?(re.pending+2>re.pending_buf_size&&K(H),re.pending+2<=re.pending_buf_size&&(J(re,255&H.adler),J(re,H.adler>>8&255),H.adler=0,re.status=A)):re.status=A),re.pending!==0){if(K(H),H.avail_out===0)return re.last_flush=-1,p}else if(H.avail_in===0&&U(ge)<=U(de)&&ge!==m)return F(H,-5);if(re.status===666&&H.avail_in!==0)return F(H,-5);if(H.avail_in!==0||re.lookahead!==0||ge!==f&&re.status!==666){var we=re.strategy===2?(function(ve,Le){for(var Ae;;){if(ve.lookahead===0&&(ie(ve),ve.lookahead===0)){if(Le===f)return M;break}if(ve.match_length=0,Ae=l._tr_tally(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++,Ae&&(G(ve,!1),ve.strm.avail_out===0))return M}return ve.insert=0,Le===m?(G(ve,!0),ve.strm.avail_out===0?I:B):ve.last_lit&&(G(ve,!1),ve.strm.avail_out===0)?M:z})(re,ge):re.strategy===3?(function(ve,Le){for(var Ae,Re,Ye,mt,ot=ve.window;;){if(ve.lookahead<=q){if(ie(ve),ve.lookahead<=q&&Le===f)return M;if(ve.lookahead===0)break}if(ve.match_length=0,ve.lookahead>=R&&0<ve.strstart&&(Re=ot[Ye=ve.strstart-1])===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]){mt=ve.strstart+q;do;while(Re===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]&&Re===ot[++Ye]&&Ye<mt);ve.match_length=q-(mt-Ye),ve.match_length>ve.lookahead&&(ve.match_length=ve.lookahead)}if(ve.match_length>=R?(Ae=l._tr_tally(ve,1,ve.match_length-R),ve.lookahead-=ve.match_length,ve.strstart+=ve.match_length,ve.match_length=0):(Ae=l._tr_tally(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++),Ae&&(G(ve,!1),ve.strm.avail_out===0))return M}return ve.insert=0,Le===m?(G(ve,!0),ve.strm.avail_out===0?I:B):ve.last_lit&&(G(ve,!1),ve.strm.avail_out===0)?M:z})(re,ge):i[re.level].func(re,ge);if(we!==I&&we!==B||(re.status=666),we===M||we===I)return H.avail_out===0&&(re.last_flush=-1),p;if(we===z&&(ge===1?l._tr_align(re):ge!==5&&(l._tr_stored_block(re,0,0,!1),ge===3&&(V(re.head),re.lookahead===0&&(re.strstart=0,re.block_start=0,re.insert=0))),K(H),H.avail_out===0))return re.last_flush=-1,p}return ge!==m?p:re.wrap<=0?1:(re.wrap===2?(J(re,255&H.adler),J(re,H.adler>>8&255),J(re,H.adler>>16&255),J(re,H.adler>>24&255),J(re,255&H.total_in),J(re,H.total_in>>8&255),J(re,H.total_in>>16&255),J(re,H.total_in>>24&255)):(ee(re,H.adler>>>16),ee(re,65535&H.adler)),K(H),0<re.wrap&&(re.wrap=-re.wrap),re.pending!==0?p:1)},a.deflateEnd=function(H){var ge;return H&&H.state?(ge=H.state.status)!==L&&ge!==69&&ge!==73&&ge!==91&&ge!==103&&ge!==A&&ge!==666?F(H,v):(H.state=null,ge===A?F(H,-3):p):v},a.deflateSetDictionary=function(H,ge){var de,re,ne,pe,ke,we,ve,Le,Ae=ge.length;if(!H||!H.state||(pe=(de=H.state).wrap)===2||pe===1&&de.status!==L||de.lookahead)return v;for(pe===1&&(H.adler=c(H.adler,ge,Ae,0)),de.wrap=0,Ae>=de.w_size&&(pe===0&&(V(de.head),de.strstart=0,de.block_start=0,de.insert=0),Le=new s.Buf8(de.w_size),s.arraySet(Le,ge,Ae-de.w_size,de.w_size,0),ge=Le,Ae=de.w_size),ke=H.avail_in,we=H.next_in,ve=H.input,H.avail_in=Ae,H.next_in=0,H.input=ge,ie(de);de.lookahead>=R;){for(re=de.strstart,ne=de.lookahead-(R-1);de.ins_h=(de.ins_h<<de.hash_shift^de.window[re+R-1])&de.hash_mask,de.prev[re&de.w_mask]=de.head[de.ins_h],de.head[de.ins_h]=re,re++,--ne;);de.strstart=re,de.lookahead=R-1,ie(de)}return de.strstart+=de.lookahead,de.block_start=de.strstart,de.insert=de.lookahead,de.lookahead=0,de.match_length=de.prev_length=R-1,de.match_available=0,H.next_in=we,H.input=ve,H.avail_in=ke,de.wrap=pe,p},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,a){n.exports=function(i,s){var l,c,u,d,f,m,p,v,b,y,S,_,N,k,j,E,T,O,R,q,$,L,A,M,z;l=i.state,c=i.next_in,M=i.input,u=c+(i.avail_in-5),d=i.next_out,z=i.output,f=d-(s-i.avail_out),m=d+(i.avail_out-257),p=l.dmax,v=l.wsize,b=l.whave,y=l.wnext,S=l.window,_=l.hold,N=l.bits,k=l.lencode,j=l.distcode,E=(1<<l.lenbits)-1,T=(1<<l.distbits)-1;e:do{N<15&&(_+=M[c++]<<N,N+=8,_+=M[c++]<<N,N+=8),O=k[_&E];t:for(;;){if(_>>>=R=O>>>24,N-=R,(R=O>>>16&255)===0)z[d++]=65535&O;else{if(!(16&R)){if((64&R)==0){O=k[(65535&O)+(_&(1<<R)-1)];continue t}if(32&R){l.mode=12;break e}i.msg="invalid literal/length code",l.mode=30;break e}q=65535&O,(R&=15)&&(N<R&&(_+=M[c++]<<N,N+=8),q+=_&(1<<R)-1,_>>>=R,N-=R),N<15&&(_+=M[c++]<<N,N+=8,_+=M[c++]<<N,N+=8),O=j[_&T];r:for(;;){if(_>>>=R=O>>>24,N-=R,!(16&(R=O>>>16&255))){if((64&R)==0){O=j[(65535&O)+(_&(1<<R)-1)];continue r}i.msg="invalid distance code",l.mode=30;break e}if($=65535&O,N<(R&=15)&&(_+=M[c++]<<N,(N+=8)<R&&(_+=M[c++]<<N,N+=8)),p<($+=_&(1<<R)-1)){i.msg="invalid distance too far back",l.mode=30;break e}if(_>>>=R,N-=R,(R=d-f)<$){if(b<(R=$-R)&&l.sane){i.msg="invalid distance too far back",l.mode=30;break e}if(A=S,(L=0)===y){if(L+=v-R,R<q){for(q-=R;z[d++]=S[L++],--R;);L=d-$,A=z}}else if(y<R){if(L+=v+y-R,(R-=y)<q){for(q-=R;z[d++]=S[L++],--R;);if(L=0,y<q){for(q-=R=y;z[d++]=S[L++],--R;);L=d-$,A=z}}}else if(L+=y-R,R<q){for(q-=R;z[d++]=S[L++],--R;);L=d-$,A=z}for(;2<q;)z[d++]=A[L++],z[d++]=A[L++],z[d++]=A[L++],q-=3;q&&(z[d++]=A[L++],1<q&&(z[d++]=A[L++]))}else{for(L=d-$;z[d++]=z[L++],z[d++]=z[L++],z[d++]=z[L++],2<(q-=3););q&&(z[d++]=z[L++],1<q&&(z[d++]=z[L++]))}break}}break}}while(c<u&&d<m);c-=q=N>>3,_&=(1<<(N-=q<<3))-1,i.next_in=c,i.next_out=d,i.avail_in=c<u?u-c+5:5-(c-u),i.avail_out=d<m?m-d+257:257-(d-m),l.hold=_,l.bits=N}},{}],49:[function(r,n,a){var i=r("../utils/common"),s=r("./adler32"),l=r("./crc32"),c=r("./inffast"),u=r("./inftrees"),d=1,f=2,m=0,p=-2,v=1,b=852,y=592;function S(L){return(L>>>24&255)+(L>>>8&65280)+((65280&L)<<8)+((255&L)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(L){var A;return L&&L.state?(A=L.state,L.total_in=L.total_out=A.total=0,L.msg="",A.wrap&&(L.adler=1&A.wrap),A.mode=v,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new i.Buf32(b),A.distcode=A.distdyn=new i.Buf32(y),A.sane=1,A.back=-1,m):p}function k(L){var A;return L&&L.state?((A=L.state).wsize=0,A.whave=0,A.wnext=0,N(L)):p}function j(L,A){var M,z;return L&&L.state?(z=L.state,A<0?(M=0,A=-A):(M=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?p:(z.window!==null&&z.wbits!==A&&(z.window=null),z.wrap=M,z.wbits=A,k(L))):p}function E(L,A){var M,z;return L?(z=new _,(L.state=z).window=null,(M=j(L,A))!==m&&(L.state=null),M):p}var T,O,R=!0;function q(L){if(R){var A;for(T=new i.Buf32(512),O=new i.Buf32(32),A=0;A<144;)L.lens[A++]=8;for(;A<256;)L.lens[A++]=9;for(;A<280;)L.lens[A++]=7;for(;A<288;)L.lens[A++]=8;for(u(d,L.lens,0,288,T,0,L.work,{bits:9}),A=0;A<32;)L.lens[A++]=5;u(f,L.lens,0,32,O,0,L.work,{bits:5}),R=!1}L.lencode=T,L.lenbits=9,L.distcode=O,L.distbits=5}function $(L,A,M,z){var I,B=L.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new i.Buf8(B.wsize)),z>=B.wsize?(i.arraySet(B.window,A,M-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(z<(I=B.wsize-B.wnext)&&(I=z),i.arraySet(B.window,A,M-z,I,B.wnext),(z-=I)?(i.arraySet(B.window,A,M-z,z,0),B.wnext=z,B.whave=B.wsize):(B.wnext+=I,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=I))),0}a.inflateReset=k,a.inflateReset2=j,a.inflateResetKeep=N,a.inflateInit=function(L){return E(L,15)},a.inflateInit2=E,a.inflate=function(L,A){var M,z,I,B,F,U,V,K,G,J,ee,Y,ie,fe,me,te,oe,ce,Z,ue,H,ge,de,re,ne=0,pe=new i.Buf8(4),ke=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return p;(M=L.state).mode===12&&(M.mode=13),F=L.next_out,I=L.output,V=L.avail_out,B=L.next_in,z=L.input,U=L.avail_in,K=M.hold,G=M.bits,J=U,ee=V,ge=m;e:for(;;)switch(M.mode){case v:if(M.wrap===0){M.mode=13;break}for(;G<16;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(2&M.wrap&&K===35615){pe[M.check=0]=255&K,pe[1]=K>>>8&255,M.check=l(M.check,pe,2,0),G=K=0,M.mode=2;break}if(M.flags=0,M.head&&(M.head.done=!1),!(1&M.wrap)||(((255&K)<<8)+(K>>8))%31){L.msg="incorrect header check",M.mode=30;break}if((15&K)!=8){L.msg="unknown compression method",M.mode=30;break}if(G-=4,H=8+(15&(K>>>=4)),M.wbits===0)M.wbits=H;else if(H>M.wbits){L.msg="invalid window size",M.mode=30;break}M.dmax=1<<H,L.adler=M.check=1,M.mode=512&K?10:12,G=K=0;break;case 2:for(;G<16;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(M.flags=K,(255&M.flags)!=8){L.msg="unknown compression method",M.mode=30;break}if(57344&M.flags){L.msg="unknown header flags set",M.mode=30;break}M.head&&(M.head.text=K>>8&1),512&M.flags&&(pe[0]=255&K,pe[1]=K>>>8&255,M.check=l(M.check,pe,2,0)),G=K=0,M.mode=3;case 3:for(;G<32;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}M.head&&(M.head.time=K),512&M.flags&&(pe[0]=255&K,pe[1]=K>>>8&255,pe[2]=K>>>16&255,pe[3]=K>>>24&255,M.check=l(M.check,pe,4,0)),G=K=0,M.mode=4;case 4:for(;G<16;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}M.head&&(M.head.xflags=255&K,M.head.os=K>>8),512&M.flags&&(pe[0]=255&K,pe[1]=K>>>8&255,M.check=l(M.check,pe,2,0)),G=K=0,M.mode=5;case 5:if(1024&M.flags){for(;G<16;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}M.length=K,M.head&&(M.head.extra_len=K),512&M.flags&&(pe[0]=255&K,pe[1]=K>>>8&255,M.check=l(M.check,pe,2,0)),G=K=0}else M.head&&(M.head.extra=null);M.mode=6;case 6:if(1024&M.flags&&(U<(Y=M.length)&&(Y=U),Y&&(M.head&&(H=M.head.extra_len-M.length,M.head.extra||(M.head.extra=new Array(M.head.extra_len)),i.arraySet(M.head.extra,z,B,Y,H)),512&M.flags&&(M.check=l(M.check,z,Y,B)),U-=Y,B+=Y,M.length-=Y),M.length))break e;M.length=0,M.mode=7;case 7:if(2048&M.flags){if(U===0)break e;for(Y=0;H=z[B+Y++],M.head&&H&&M.length<65536&&(M.head.name+=String.fromCharCode(H)),H&&Y<U;);if(512&M.flags&&(M.check=l(M.check,z,Y,B)),U-=Y,B+=Y,H)break e}else M.head&&(M.head.name=null);M.length=0,M.mode=8;case 8:if(4096&M.flags){if(U===0)break e;for(Y=0;H=z[B+Y++],M.head&&H&&M.length<65536&&(M.head.comment+=String.fromCharCode(H)),H&&Y<U;);if(512&M.flags&&(M.check=l(M.check,z,Y,B)),U-=Y,B+=Y,H)break e}else M.head&&(M.head.comment=null);M.mode=9;case 9:if(512&M.flags){for(;G<16;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(K!==(65535&M.check)){L.msg="header crc mismatch",M.mode=30;break}G=K=0}M.head&&(M.head.hcrc=M.flags>>9&1,M.head.done=!0),L.adler=M.check=0,M.mode=12;break;case 10:for(;G<32;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}L.adler=M.check=S(K),G=K=0,M.mode=11;case 11:if(M.havedict===0)return L.next_out=F,L.avail_out=V,L.next_in=B,L.avail_in=U,M.hold=K,M.bits=G,2;L.adler=M.check=1,M.mode=12;case 12:if(A===5||A===6)break e;case 13:if(M.last){K>>>=7&G,G-=7&G,M.mode=27;break}for(;G<3;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}switch(M.last=1&K,G-=1,3&(K>>>=1)){case 0:M.mode=14;break;case 1:if(q(M),M.mode=20,A!==6)break;K>>>=2,G-=2;break e;case 2:M.mode=17;break;case 3:L.msg="invalid block type",M.mode=30}K>>>=2,G-=2;break;case 14:for(K>>>=7&G,G-=7&G;G<32;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if((65535&K)!=(K>>>16^65535)){L.msg="invalid stored block lengths",M.mode=30;break}if(M.length=65535&K,G=K=0,M.mode=15,A===6)break e;case 15:M.mode=16;case 16:if(Y=M.length){if(U<Y&&(Y=U),V<Y&&(Y=V),Y===0)break e;i.arraySet(I,z,B,Y,F),U-=Y,B+=Y,V-=Y,F+=Y,M.length-=Y;break}M.mode=12;break;case 17:for(;G<14;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(M.nlen=257+(31&K),K>>>=5,G-=5,M.ndist=1+(31&K),K>>>=5,G-=5,M.ncode=4+(15&K),K>>>=4,G-=4,286<M.nlen||30<M.ndist){L.msg="too many length or distance symbols",M.mode=30;break}M.have=0,M.mode=18;case 18:for(;M.have<M.ncode;){for(;G<3;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}M.lens[ke[M.have++]]=7&K,K>>>=3,G-=3}for(;M.have<19;)M.lens[ke[M.have++]]=0;if(M.lencode=M.lendyn,M.lenbits=7,de={bits:M.lenbits},ge=u(0,M.lens,0,19,M.lencode,0,M.work,de),M.lenbits=de.bits,ge){L.msg="invalid code lengths set",M.mode=30;break}M.have=0,M.mode=19;case 19:for(;M.have<M.nlen+M.ndist;){for(;te=(ne=M.lencode[K&(1<<M.lenbits)-1])>>>16&255,oe=65535&ne,!((me=ne>>>24)<=G);){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(oe<16)K>>>=me,G-=me,M.lens[M.have++]=oe;else{if(oe===16){for(re=me+2;G<re;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(K>>>=me,G-=me,M.have===0){L.msg="invalid bit length repeat",M.mode=30;break}H=M.lens[M.have-1],Y=3+(3&K),K>>>=2,G-=2}else if(oe===17){for(re=me+3;G<re;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}G-=me,H=0,Y=3+(7&(K>>>=me)),K>>>=3,G-=3}else{for(re=me+7;G<re;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}G-=me,H=0,Y=11+(127&(K>>>=me)),K>>>=7,G-=7}if(M.have+Y>M.nlen+M.ndist){L.msg="invalid bit length repeat",M.mode=30;break}for(;Y--;)M.lens[M.have++]=H}}if(M.mode===30)break;if(M.lens[256]===0){L.msg="invalid code -- missing end-of-block",M.mode=30;break}if(M.lenbits=9,de={bits:M.lenbits},ge=u(d,M.lens,0,M.nlen,M.lencode,0,M.work,de),M.lenbits=de.bits,ge){L.msg="invalid literal/lengths set",M.mode=30;break}if(M.distbits=6,M.distcode=M.distdyn,de={bits:M.distbits},ge=u(f,M.lens,M.nlen,M.ndist,M.distcode,0,M.work,de),M.distbits=de.bits,ge){L.msg="invalid distances set",M.mode=30;break}if(M.mode=20,A===6)break e;case 20:M.mode=21;case 21:if(6<=U&&258<=V){L.next_out=F,L.avail_out=V,L.next_in=B,L.avail_in=U,M.hold=K,M.bits=G,c(L,ee),F=L.next_out,I=L.output,V=L.avail_out,B=L.next_in,z=L.input,U=L.avail_in,K=M.hold,G=M.bits,M.mode===12&&(M.back=-1);break}for(M.back=0;te=(ne=M.lencode[K&(1<<M.lenbits)-1])>>>16&255,oe=65535&ne,!((me=ne>>>24)<=G);){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(te&&(240&te)==0){for(ce=me,Z=te,ue=oe;te=(ne=M.lencode[ue+((K&(1<<ce+Z)-1)>>ce)])>>>16&255,oe=65535&ne,!(ce+(me=ne>>>24)<=G);){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}K>>>=ce,G-=ce,M.back+=ce}if(K>>>=me,G-=me,M.back+=me,M.length=oe,te===0){M.mode=26;break}if(32&te){M.back=-1,M.mode=12;break}if(64&te){L.msg="invalid literal/length code",M.mode=30;break}M.extra=15&te,M.mode=22;case 22:if(M.extra){for(re=M.extra;G<re;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}M.length+=K&(1<<M.extra)-1,K>>>=M.extra,G-=M.extra,M.back+=M.extra}M.was=M.length,M.mode=23;case 23:for(;te=(ne=M.distcode[K&(1<<M.distbits)-1])>>>16&255,oe=65535&ne,!((me=ne>>>24)<=G);){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if((240&te)==0){for(ce=me,Z=te,ue=oe;te=(ne=M.distcode[ue+((K&(1<<ce+Z)-1)>>ce)])>>>16&255,oe=65535&ne,!(ce+(me=ne>>>24)<=G);){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}K>>>=ce,G-=ce,M.back+=ce}if(K>>>=me,G-=me,M.back+=me,64&te){L.msg="invalid distance code",M.mode=30;break}M.offset=oe,M.extra=15&te,M.mode=24;case 24:if(M.extra){for(re=M.extra;G<re;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}M.offset+=K&(1<<M.extra)-1,K>>>=M.extra,G-=M.extra,M.back+=M.extra}if(M.offset>M.dmax){L.msg="invalid distance too far back",M.mode=30;break}M.mode=25;case 25:if(V===0)break e;if(Y=ee-V,M.offset>Y){if((Y=M.offset-Y)>M.whave&&M.sane){L.msg="invalid distance too far back",M.mode=30;break}ie=Y>M.wnext?(Y-=M.wnext,M.wsize-Y):M.wnext-Y,Y>M.length&&(Y=M.length),fe=M.window}else fe=I,ie=F-M.offset,Y=M.length;for(V<Y&&(Y=V),V-=Y,M.length-=Y;I[F++]=fe[ie++],--Y;);M.length===0&&(M.mode=21);break;case 26:if(V===0)break e;I[F++]=M.length,V--,M.mode=21;break;case 27:if(M.wrap){for(;G<32;){if(U===0)break e;U--,K|=z[B++]<<G,G+=8}if(ee-=V,L.total_out+=ee,M.total+=ee,ee&&(L.adler=M.check=M.flags?l(M.check,I,ee,F-ee):s(M.check,I,ee,F-ee)),ee=V,(M.flags?K:S(K))!==M.check){L.msg="incorrect data check",M.mode=30;break}G=K=0}M.mode=28;case 28:if(M.wrap&&M.flags){for(;G<32;){if(U===0)break e;U--,K+=z[B++]<<G,G+=8}if(K!==(4294967295&M.total)){L.msg="incorrect length check",M.mode=30;break}G=K=0}M.mode=29;case 29:ge=1;break e;case 30:ge=-3;break e;case 31:return-4;case 32:default:return p}return L.next_out=F,L.avail_out=V,L.next_in=B,L.avail_in=U,M.hold=K,M.bits=G,(M.wsize||ee!==L.avail_out&&M.mode<30&&(M.mode<27||A!==4))&&$(L,L.output,L.next_out,ee-L.avail_out)?(M.mode=31,-4):(J-=L.avail_in,ee-=L.avail_out,L.total_in+=J,L.total_out+=ee,M.total+=ee,M.wrap&&ee&&(L.adler=M.check=M.flags?l(M.check,I,ee,L.next_out-ee):s(M.check,I,ee,L.next_out-ee)),L.data_type=M.bits+(M.last?64:0)+(M.mode===12?128:0)+(M.mode===20||M.mode===15?256:0),(J==0&&ee===0||A===4)&&ge===m&&(ge=-5),ge)},a.inflateEnd=function(L){if(!L||!L.state)return p;var A=L.state;return A.window&&(A.window=null),L.state=null,m},a.inflateGetHeader=function(L,A){var M;return L&&L.state?(2&(M=L.state).wrap)==0?p:((M.head=A).done=!1,m):p},a.inflateSetDictionary=function(L,A){var M,z=A.length;return L&&L.state?(M=L.state).wrap!==0&&M.mode!==11?p:M.mode===11&&s(1,A,z,0)!==M.check?-3:$(L,A,z,z)?(M.mode=31,-4):(M.havedict=1,m):p},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,a){var i=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(d,f,m,p,v,b,y,S){var _,N,k,j,E,T,O,R,q,$=S.bits,L=0,A=0,M=0,z=0,I=0,B=0,F=0,U=0,V=0,K=0,G=null,J=0,ee=new i.Buf16(16),Y=new i.Buf16(16),ie=null,fe=0;for(L=0;L<=15;L++)ee[L]=0;for(A=0;A<p;A++)ee[f[m+A]]++;for(I=$,z=15;1<=z&&ee[z]===0;z--);if(z<I&&(I=z),z===0)return v[b++]=20971520,v[b++]=20971520,S.bits=1,0;for(M=1;M<z&&ee[M]===0;M++);for(I<M&&(I=M),L=U=1;L<=15;L++)if(U<<=1,(U-=ee[L])<0)return-1;if(0<U&&(d===0||z!==1))return-1;for(Y[1]=0,L=1;L<15;L++)Y[L+1]=Y[L]+ee[L];for(A=0;A<p;A++)f[m+A]!==0&&(y[Y[f[m+A]]++]=A);if(T=d===0?(G=ie=y,19):d===1?(G=s,J-=257,ie=l,fe-=257,256):(G=c,ie=u,-1),L=M,E=b,F=A=K=0,k=-1,j=(V=1<<(B=I))-1,d===1&&852<V||d===2&&592<V)return 1;for(;;){for(O=L-F,q=y[A]<T?(R=0,y[A]):y[A]>T?(R=ie[fe+y[A]],G[J+y[A]]):(R=96,0),_=1<<L-F,M=N=1<<B;v[E+(K>>F)+(N-=_)]=O<<24|R<<16|q|0,N!==0;);for(_=1<<L-1;K&_;)_>>=1;if(_!==0?(K&=_-1,K+=_):K=0,A++,--ee[L]==0){if(L===z)break;L=f[m+y[A]]}if(I<L&&(K&j)!==k){for(F===0&&(F=I),E+=M,U=1<<(B=L-F);B+F<z&&!((U-=ee[B+F])<=0);)B++,U<<=1;if(V+=1<<B,d===1&&852<V||d===2&&592<V)return 1;v[k=K&j]=I<<24|B<<16|E-b|0}}return K!==0&&(v[E+K]=L-F<<24|64<<16|0),S.bits=I,0}},{"../utils/common":41}],51:[function(r,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,a){var i=r("../utils/common"),s=0,l=1;function c(ne){for(var pe=ne.length;0<=--pe;)ne[pe]=0}var u=0,d=29,f=256,m=f+1+d,p=30,v=19,b=2*m+1,y=15,S=16,_=7,N=256,k=16,j=17,E=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$=new Array(2*(m+2));c($);var L=new Array(2*p);c(L);var A=new Array(512);c(A);var M=new Array(256);c(M);var z=new Array(d);c(z);var I,B,F,U=new Array(p);function V(ne,pe,ke,we,ve){this.static_tree=ne,this.extra_bits=pe,this.extra_base=ke,this.elems=we,this.max_length=ve,this.has_stree=ne&&ne.length}function K(ne,pe){this.dyn_tree=ne,this.max_code=0,this.stat_desc=pe}function G(ne){return ne<256?A[ne]:A[256+(ne>>>7)]}function J(ne,pe){ne.pending_buf[ne.pending++]=255&pe,ne.pending_buf[ne.pending++]=pe>>>8&255}function ee(ne,pe,ke){ne.bi_valid>S-ke?(ne.bi_buf|=pe<<ne.bi_valid&65535,J(ne,ne.bi_buf),ne.bi_buf=pe>>S-ne.bi_valid,ne.bi_valid+=ke-S):(ne.bi_buf|=pe<<ne.bi_valid&65535,ne.bi_valid+=ke)}function Y(ne,pe,ke){ee(ne,ke[2*pe],ke[2*pe+1])}function ie(ne,pe){for(var ke=0;ke|=1&ne,ne>>>=1,ke<<=1,0<--pe;);return ke>>>1}function fe(ne,pe,ke){var we,ve,Le=new Array(y+1),Ae=0;for(we=1;we<=y;we++)Le[we]=Ae=Ae+ke[we-1]<<1;for(ve=0;ve<=pe;ve++){var Re=ne[2*ve+1];Re!==0&&(ne[2*ve]=ie(Le[Re]++,Re))}}function me(ne){var pe;for(pe=0;pe<m;pe++)ne.dyn_ltree[2*pe]=0;for(pe=0;pe<p;pe++)ne.dyn_dtree[2*pe]=0;for(pe=0;pe<v;pe++)ne.bl_tree[2*pe]=0;ne.dyn_ltree[2*N]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function te(ne){8<ne.bi_valid?J(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function oe(ne,pe,ke,we){var ve=2*pe,Le=2*ke;return ne[ve]<ne[Le]||ne[ve]===ne[Le]&&we[pe]<=we[ke]}function ce(ne,pe,ke){for(var we=ne.heap[ke],ve=ke<<1;ve<=ne.heap_len&&(ve<ne.heap_len&&oe(pe,ne.heap[ve+1],ne.heap[ve],ne.depth)&&ve++,!oe(pe,we,ne.heap[ve],ne.depth));)ne.heap[ke]=ne.heap[ve],ke=ve,ve<<=1;ne.heap[ke]=we}function Z(ne,pe,ke){var we,ve,Le,Ae,Re=0;if(ne.last_lit!==0)for(;we=ne.pending_buf[ne.d_buf+2*Re]<<8|ne.pending_buf[ne.d_buf+2*Re+1],ve=ne.pending_buf[ne.l_buf+Re],Re++,we===0?Y(ne,ve,pe):(Y(ne,(Le=M[ve])+f+1,pe),(Ae=T[Le])!==0&&ee(ne,ve-=z[Le],Ae),Y(ne,Le=G(--we),ke),(Ae=O[Le])!==0&&ee(ne,we-=U[Le],Ae)),Re<ne.last_lit;);Y(ne,N,pe)}function ue(ne,pe){var ke,we,ve,Le=pe.dyn_tree,Ae=pe.stat_desc.static_tree,Re=pe.stat_desc.has_stree,Ye=pe.stat_desc.elems,mt=-1;for(ne.heap_len=0,ne.heap_max=b,ke=0;ke<Ye;ke++)Le[2*ke]!==0?(ne.heap[++ne.heap_len]=mt=ke,ne.depth[ke]=0):Le[2*ke+1]=0;for(;ne.heap_len<2;)Le[2*(ve=ne.heap[++ne.heap_len]=mt<2?++mt:0)]=1,ne.depth[ve]=0,ne.opt_len--,Re&&(ne.static_len-=Ae[2*ve+1]);for(pe.max_code=mt,ke=ne.heap_len>>1;1<=ke;ke--)ce(ne,Le,ke);for(ve=Ye;ke=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],ce(ne,Le,1),we=ne.heap[1],ne.heap[--ne.heap_max]=ke,ne.heap[--ne.heap_max]=we,Le[2*ve]=Le[2*ke]+Le[2*we],ne.depth[ve]=(ne.depth[ke]>=ne.depth[we]?ne.depth[ke]:ne.depth[we])+1,Le[2*ke+1]=Le[2*we+1]=ve,ne.heap[1]=ve++,ce(ne,Le,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],(function(ot,Ot){var rt,ze,bt,tt,_e,We,Ve=Ot.dyn_tree,Mt=Ot.max_code,kt=Ot.stat_desc.static_tree,er=Ot.stat_desc.has_stree,mr=Ot.stat_desc.extra_bits,Zt=Ot.stat_desc.extra_base,Wt=Ot.stat_desc.max_length,Rt=0;for(tt=0;tt<=y;tt++)ot.bl_count[tt]=0;for(Ve[2*ot.heap[ot.heap_max]+1]=0,rt=ot.heap_max+1;rt<b;rt++)Wt<(tt=Ve[2*Ve[2*(ze=ot.heap[rt])+1]+1]+1)&&(tt=Wt,Rt++),Ve[2*ze+1]=tt,Mt<ze||(ot.bl_count[tt]++,_e=0,Zt<=ze&&(_e=mr[ze-Zt]),We=Ve[2*ze],ot.opt_len+=We*(tt+_e),er&&(ot.static_len+=We*(kt[2*ze+1]+_e)));if(Rt!==0){do{for(tt=Wt-1;ot.bl_count[tt]===0;)tt--;ot.bl_count[tt]--,ot.bl_count[tt+1]+=2,ot.bl_count[Wt]--,Rt-=2}while(0<Rt);for(tt=Wt;tt!==0;tt--)for(ze=ot.bl_count[tt];ze!==0;)Mt<(bt=ot.heap[--rt])||(Ve[2*bt+1]!==tt&&(ot.opt_len+=(tt-Ve[2*bt+1])*Ve[2*bt],Ve[2*bt+1]=tt),ze--)}})(ne,pe),fe(Le,mt,ne.bl_count)}function H(ne,pe,ke){var we,ve,Le=-1,Ae=pe[1],Re=0,Ye=7,mt=4;for(Ae===0&&(Ye=138,mt=3),pe[2*(ke+1)+1]=65535,we=0;we<=ke;we++)ve=Ae,Ae=pe[2*(we+1)+1],++Re<Ye&&ve===Ae||(Re<mt?ne.bl_tree[2*ve]+=Re:ve!==0?(ve!==Le&&ne.bl_tree[2*ve]++,ne.bl_tree[2*k]++):Re<=10?ne.bl_tree[2*j]++:ne.bl_tree[2*E]++,Le=ve,mt=(Re=0)===Ae?(Ye=138,3):ve===Ae?(Ye=6,3):(Ye=7,4))}function ge(ne,pe,ke){var we,ve,Le=-1,Ae=pe[1],Re=0,Ye=7,mt=4;for(Ae===0&&(Ye=138,mt=3),we=0;we<=ke;we++)if(ve=Ae,Ae=pe[2*(we+1)+1],!(++Re<Ye&&ve===Ae)){if(Re<mt)for(;Y(ne,ve,ne.bl_tree),--Re!=0;);else ve!==0?(ve!==Le&&(Y(ne,ve,ne.bl_tree),Re--),Y(ne,k,ne.bl_tree),ee(ne,Re-3,2)):Re<=10?(Y(ne,j,ne.bl_tree),ee(ne,Re-3,3)):(Y(ne,E,ne.bl_tree),ee(ne,Re-11,7));Le=ve,mt=(Re=0)===Ae?(Ye=138,3):ve===Ae?(Ye=6,3):(Ye=7,4)}}c(U);var de=!1;function re(ne,pe,ke,we){ee(ne,(u<<1)+(we?1:0),3),(function(ve,Le,Ae,Re){te(ve),J(ve,Ae),J(ve,~Ae),i.arraySet(ve.pending_buf,ve.window,Le,Ae,ve.pending),ve.pending+=Ae})(ne,pe,ke)}a._tr_init=function(ne){de||((function(){var pe,ke,we,ve,Le,Ae=new Array(y+1);for(ve=we=0;ve<d-1;ve++)for(z[ve]=we,pe=0;pe<1<<T[ve];pe++)M[we++]=ve;for(M[we-1]=ve,ve=Le=0;ve<16;ve++)for(U[ve]=Le,pe=0;pe<1<<O[ve];pe++)A[Le++]=ve;for(Le>>=7;ve<p;ve++)for(U[ve]=Le<<7,pe=0;pe<1<<O[ve]-7;pe++)A[256+Le++]=ve;for(ke=0;ke<=y;ke++)Ae[ke]=0;for(pe=0;pe<=143;)$[2*pe+1]=8,pe++,Ae[8]++;for(;pe<=255;)$[2*pe+1]=9,pe++,Ae[9]++;for(;pe<=279;)$[2*pe+1]=7,pe++,Ae[7]++;for(;pe<=287;)$[2*pe+1]=8,pe++,Ae[8]++;for(fe($,m+1,Ae),pe=0;pe<p;pe++)L[2*pe+1]=5,L[2*pe]=ie(pe,5);I=new V($,T,f+1,m,y),B=new V(L,O,0,p,y),F=new V(new Array(0),R,0,v,_)})(),de=!0),ne.l_desc=new K(ne.dyn_ltree,I),ne.d_desc=new K(ne.dyn_dtree,B),ne.bl_desc=new K(ne.bl_tree,F),ne.bi_buf=0,ne.bi_valid=0,me(ne)},a._tr_stored_block=re,a._tr_flush_block=function(ne,pe,ke,we){var ve,Le,Ae=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=(function(Re){var Ye,mt=4093624447;for(Ye=0;Ye<=31;Ye++,mt>>>=1)if(1&mt&&Re.dyn_ltree[2*Ye]!==0)return s;if(Re.dyn_ltree[18]!==0||Re.dyn_ltree[20]!==0||Re.dyn_ltree[26]!==0)return l;for(Ye=32;Ye<f;Ye++)if(Re.dyn_ltree[2*Ye]!==0)return l;return s})(ne)),ue(ne,ne.l_desc),ue(ne,ne.d_desc),Ae=(function(Re){var Ye;for(H(Re,Re.dyn_ltree,Re.l_desc.max_code),H(Re,Re.dyn_dtree,Re.d_desc.max_code),ue(Re,Re.bl_desc),Ye=v-1;3<=Ye&&Re.bl_tree[2*q[Ye]+1]===0;Ye--);return Re.opt_len+=3*(Ye+1)+5+5+4,Ye})(ne),ve=ne.opt_len+3+7>>>3,(Le=ne.static_len+3+7>>>3)<=ve&&(ve=Le)):ve=Le=ke+5,ke+4<=ve&&pe!==-1?re(ne,pe,ke,we):ne.strategy===4||Le===ve?(ee(ne,2+(we?1:0),3),Z(ne,$,L)):(ee(ne,4+(we?1:0),3),(function(Re,Ye,mt,ot){var Ot;for(ee(Re,Ye-257,5),ee(Re,mt-1,5),ee(Re,ot-4,4),Ot=0;Ot<ot;Ot++)ee(Re,Re.bl_tree[2*q[Ot]+1],3);ge(Re,Re.dyn_ltree,Ye-1),ge(Re,Re.dyn_dtree,mt-1)})(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Ae+1),Z(ne,ne.dyn_ltree,ne.dyn_dtree)),me(ne),we&&te(ne)},a._tr_tally=function(ne,pe,ke){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=pe>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&pe,ne.pending_buf[ne.l_buf+ne.last_lit]=255&ke,ne.last_lit++,pe===0?ne.dyn_ltree[2*ke]++:(ne.matches++,pe--,ne.dyn_ltree[2*(M[ke]+f+1)]++,ne.dyn_dtree[2*G(pe)]++),ne.last_lit===ne.lit_bufsize-1},a._tr_align=function(ne){ee(ne,2,3),Y(ne,N,$),(function(pe){pe.bi_valid===16?(J(pe,pe.bi_buf),pe.bi_buf=0,pe.bi_valid=0):8<=pe.bi_valid&&(pe.pending_buf[pe.pending++]=255&pe.bi_buf,pe.bi_buf>>=8,pe.bi_valid-=8)})(ne)}},{"../utils/common":41}],53:[function(r,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,a){(function(i){(function(s,l){if(!s.setImmediate){var c,u,d,f,m=1,p={},v=!1,b=s.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(s);y=y&&y.setTimeout?y:s,c={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){_(k)})}:(function(){if(s.postMessage&&!s.importScripts){var k=!0,j=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=j,k}})()?(f="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",N,!1):s.attachEvent("onmessage",N),function(k){s.postMessage(f+k,"*")}):s.MessageChannel?((d=new MessageChannel).port1.onmessage=function(k){_(k.data)},function(k){d.port2.postMessage(k)}):b&&"onreadystatechange"in b.createElement("script")?(u=b.documentElement,function(k){var j=b.createElement("script");j.onreadystatechange=function(){_(k),j.onreadystatechange=null,u.removeChild(j),j=null},u.appendChild(j)}):function(k){setTimeout(_,0,k)},y.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var j=new Array(arguments.length-1),E=0;E<j.length;E++)j[E]=arguments[E+1];var T={callback:k,args:j};return p[m]=T,c(m),m++},y.clearImmediate=S}function S(k){delete p[k]}function _(k){if(v)setTimeout(_,0,k);else{var j=p[k];if(j){v=!0;try{(function(E){var T=E.callback,O=E.args;switch(O.length){case 0:T();break;case 1:T(O[0]);break;case 2:T(O[0],O[1]);break;case 3:T(O[0],O[1],O[2]);break;default:T.apply(l,O)}})(j)}finally{S(k),v=!1}}}}function N(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(f)===0&&_(+k.data.slice(f.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(pO)),pO.exports}var P1t=R1t();const z1t=Fr(P1t),fne=["themes","grammars","languages","snippets","iconThemes","productIconThemes"],hne="^1.85.0";function mne(e){const r=e.replace(/^[\^~]/,"").match(/^(\d+)\.(\d+)\.(\d+)/);return r?{major:parseInt(r[1],10),minor:parseInt(r[2],10),patch:parseInt(r[3],10)}:null}function B1t(e,t){const r=mne(e),n=mne(t);return!r||!n?!0:!(r.major!==n.major||r.minor>n.minor||r.minor===n.minor&&r.patch>n.patch)}function $1t(e){const t={compatible:!0,reasons:[],warnings:[]};if(e.main&&(t.compatible=!1,t.reasons.push(`Extension has a "main" entry point (${e.main}) which requires code execution`)),e.browser&&(t.compatible=!1,t.reasons.push(`Extension has a "browser" entry point (${e.browser}) which requires code execution`)),e.activationEvents&&e.activationEvents.length>0){const r=e.activationEvents.filter(n=>!n.startsWith("onLanguage:")&&n!=="*"&&n!=="onStartupFinished");r.length>0&&t.warnings.push(`Extension has activation events: ${r.join(", ")}`)}if(e.contributes){const r=Object.keys(e.contributes),n=r.filter(i=>!fne.includes(i)&&e.contributes[i]!==void 0&&e.contributes[i]!==null);n.length>0&&(t.compatible=!1,t.reasons.push(`Extension contributes unsupported types: ${n.join(", ")}`)),r.filter(i=>fne.includes(i)).length===0&&(t.compatible=!1,t.reasons.push("Extension has no supported declarative contributions"))}else t.compatible=!1,t.reasons.push("Extension has no contributions");if(e.engines?.vscode){const r=e.engines.vscode;B1t(r,hne)||t.warnings.push(`Extension requires VS Code ${r}, but we support ${hne}`)}return t}function F1t(e){const t=new Set;if(!e.contributes)return t;if(e.contributes.themes)for(const r of e.contributes.themes)r.path&&t.add(r.path);if(e.contributes.grammars)for(const r of e.contributes.grammars)r.path&&t.add(r.path);if(e.contributes.snippets)for(const r of e.contributes.snippets)r.path&&t.add(r.path);if(e.contributes.languages)for(const r of e.contributes.languages)r.configuration&&t.add(r.configuration);if(e.contributes.iconThemes)for(const r of e.contributes.iconThemes)r.path&&t.add(r.path);if(e.contributes.productIconThemes)for(const r of e.contributes.productIconThemes)r.path&&t.add(r.path);return e.icon&&t.add(e.icon),t}async function U1t(e){const t=await z1t.loadAsync(e),n=t.file("extension/package.json");if(!n)throw new Error("Invalid VSIX: package.json not found at extension/package.json");const a=await n.async("string");let i;try{i=JSON.parse(a)}catch(c){throw new Error(`Invalid VSIX: package.json is not valid JSON: ${c instanceof Error?c.message:"Unknown error"}`)}if(!i.name)throw new Error('Invalid VSIX: manifest missing required field "name"');if(!i.publisher)throw new Error('Invalid VSIX: manifest missing required field "publisher"');if(!i.version)throw new Error('Invalid VSIX: manifest missing required field "version"');const s=F1t(i),l=new Map;for(const c of s){const u=c.replace(/^\.\//,""),d=`extension/${u}`,f=t.file(d);if(f){const m=await f.async("uint8array");l.set(u,m)}else{const m=t.file(u);if(m){const p=await m.async("uint8array");l.set(u,p)}}}return{manifest:i,contributedFiles:l}}function H1t(e){return`${e.publisher}.${e.name}`}class q1t extends Error{constructor(t,r){super(t),this.reasons=r,this.name="ExtensionCompatibilityError"}}class td extends Error{constructor(t,r,n){super(t),this.phase=r,this.cause=n,this.name="ExtensionInstallError"}}const ny=new Set,S5=new Set;let wye=[],Sye=!1;function k5(){for(const e of S5)e()}function pne(e){return S5.add(e),()=>{S5.delete(e)}}function gne(){return wye}async function F$(){try{wye=await x1t(),Sye=!0,k5()}catch(e){console.error("[ExtensionManager] Failed to refresh installed extensions cache:",e)}}async function W1t(e,t,r){const n=`${e}.${t}`;if(ny.has(n))throw new td(`Extension ${n} is already being installed`,"download",void 0);ny.add(n),k5();let a=!1,i=null;try{let s;try{s=await I1t(e,t,r)}catch(v){throw new td(`Failed to download extension: ${v instanceof Error?v.message:String(v)}`,"download",v instanceof Error?v:void 0)}let l,c;try{const v=await U1t(s);l=v.manifest,c=v.contributedFiles}catch(v){throw new td(`Failed to parse VSIX: ${v instanceof Error?v.message:String(v)}`,"parse",v instanceof Error?v:void 0)}const u=l;if(i=H1t(l),await lne(i))throw new td(`Extension ${i} is already installed`,"storage",void 0);if(A1t(i))throw new td(`Extension ${i} is already registered`,"registration",void 0);const f=$1t(l);if(!f.compatible)throw new q1t(`Extension ${i} is not compatible: ${f.reasons.join("; ")}`,f.reasons);f.warnings.length>0&&console.warn(`[ExtensionManager] Extension ${i} has warnings:`,f.warnings);try{await y1t(i,u,c),a=!0}catch(v){throw new td(`Failed to save extension: ${v instanceof Error?v.message:String(v)}`,"storage",v instanceof Error?v:void 0)}const m=E1t(u,c);if(!m.success)throw new td(`Failed to register extension: ${m.error}`,"registration",void 0);if(m.extension)try{await m.extension.whenReady()}catch(v){console.warn(`[ExtensionManager] Extension ${i} whenReady failed, but registration succeeded:`,v)}console.log(`[ExtensionManager] Successfully installed extension: ${i}`),await F$();const p=await lne(i);if(!p)throw new td("Extension was saved but could not be retrieved","storage",void 0);return p}catch(s){if(a&&i)try{await mye(i),console.log(`[ExtensionManager] Cleaned up partial storage for ${i}`)}catch(l){console.error(`[ExtensionManager] Failed to clean up partial storage for ${i}:`,l)}throw s}finally{ny.delete(n),k5()}}async function K1t(e){console.log(`[ExtensionManager] Uninstalling extension: ${e}`);try{await M1t(e)}catch(t){console.error(`[ExtensionManager] Failed to unregister extension ${e}:`,t)}try{await mye(e)}catch(t){throw console.error(`[ExtensionManager] Failed to remove extension ${e} from storage:`,t),t}console.log(`[ExtensionManager] Successfully uninstalled extension: ${e}`),await F$()}function kye(){w.useEffect(()=>{Sye||F$()},[]);const e=w.useSyncExternalStore(pne,gne,gne),[t,r]=w.useState(()=>new Set(ny));w.useEffect(()=>pne(()=>{r(new Set(ny))}),[]);const n=w.useCallback(async(i,s,l)=>{await W1t(i,s,l)},[]),a=w.useCallback(async i=>{await K1t(i)},[]);return w.useMemo(()=>({installed:e,installing:t,install:n,uninstall:a}),[e,t,n,a])}function G1t(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toLocaleString()}function vne({extension:e,isInstalled:t,installedInfo:r,isInstalling:n,isUninstalling:a,isIncompatible:i=!1,incompatibilityReasons:s=[],onInstall:l,onUninstall:c,onClick:u}){const[d,f]=w.useState(null),m=e.displayName||e.name,p=e.namespace,v=e.description||"No description available",b=r?.version||e.version,y=e.files.icon,S=`${e.namespace}.${e.name}`,_=n||a,N=w.useCallback(()=>{i||_||(f(null),l(e.namespace,e.name))},[e.namespace,e.name,i,_,l]),k=w.useCallback(()=>{_||(f(null),c(S))},[S,_,c]),j=w.useMemo(()=>i?s.length===0?"This extension requires code execution and cannot be installed.":s.join(`
`):null,[i,s]),E=w.useCallback(()=>{u&&u(e)},[u,e]);return o.jsxs("div",{className:`
        flex gap-3 p-3 border-b border-[var(--color-border)] last:border-b-0
        ${i?"opacity-60":""}
        hover:bg-[var(--color-surface-hover)] transition-colors
      `,"data-testid":`extension-card-${S}`,children:[o.jsxs("button",{type:"button",onClick:E,className:"flex gap-3 flex-1 min-w-0 text-left cursor-pointer",disabled:!u,children:[o.jsxs("div",{className:"flex-shrink-0 w-10 h-10 rounded-md bg-[var(--color-surface)] flex items-center justify-center overflow-hidden",children:[y?o.jsx("img",{src:y,alt:`${m} icon`,className:"w-full h-full object-cover",loading:"lazy",onError:T=>{T.target.style.display="none",T.target.nextElementSibling?.classList.remove("hidden")}}):null,o.jsx(oy,{className:`w-5 h-5 text-[var(--color-text-muted)] ${y?"hidden":""}`})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:m}),o.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--color-surface)] text-[var(--color-text-muted)] flex-shrink-0",children:["v",b]}),i&&o.jsx(Cn,{content:j||"Incompatible extension",children:o.jsx("span",{className:"flex-shrink-0",children:o.jsx(Bn,{className:"w-3.5 h-3.5 text-[var(--color-warning)]"})})})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)] mb-1 flex items-center gap-2",children:[o.jsx("span",{children:p}),e.downloadCount!==void 0&&o.jsxs("span",{className:"flex items-center gap-0.5",children:[o.jsx(sy,{className:"w-3 h-3"}),G1t(e.downloadCount)]})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] line-clamp-2",children:v}),d&&o.jsx("p",{className:"text-xs text-[var(--color-danger)] mt-1",children:d})]})]}),o.jsx("div",{className:"flex-shrink-0 flex items-center",children:t?o.jsx(Cn,{content:"Uninstall extension",children:o.jsx("button",{onClick:k,disabled:_,className:`
                flex items-center justify-center w-8 h-8 rounded
                ${_?"bg-[var(--color-surface)] cursor-not-allowed":"bg-[var(--color-danger)]/10 hover:bg-[var(--color-danger)]/20 text-[var(--color-danger)]"}
                transition-colors
              `,"data-testid":`extension-uninstall-${S}`,children:a?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(Sr,{className:"w-4 h-4"})})}):o.jsx(Cn,{content:i?j||"Cannot install - incompatible extension":"Install extension",children:o.jsx("button",{onClick:N,disabled:_||i,className:`
                flex items-center justify-center w-8 h-8 rounded
                ${i?"bg-[var(--color-surface)] cursor-not-allowed text-[var(--color-text-muted)]":_?"bg-[var(--color-surface)] cursor-not-allowed":"bg-[var(--color-primary)]/10 hover:bg-[var(--color-primary)]/20 text-[var(--color-primary)]"}
                transition-colors
              `,"data-testid":`extension-install-${S}`,children:n?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(sy,{className:"w-4 h-4"})})})})]})}const V1t=300,Y1t={All:void 0,Themes:"Themes",Languages:"Programming Languages",Snippets:"Snippets"};function Q1t({className:e="",onExtensionClick:t}){const r=w.useRef(null),n=w.useRef(null),{installed:a,installing:i,install:s,uninstall:l}=kye(),[c,u]=w.useState("All"),[d,f]=w.useState(!0),[m,p]=w.useState({query:"",results:[],isSearching:!1,error:null,totalSize:0}),[v,b]=w.useState(new Set),[y,S]=w.useState(new Map),_=w.useCallback(async(F,U)=>{if(n.current&&window.clearTimeout(n.current),!F.trim()){p(V=>({...V,query:"",results:[],isSearching:!1,error:null,totalSize:0}));return}p(V=>({...V,query:F,isSearching:!0,error:null})),n.current=window.setTimeout(async()=>{try{const V=Y1t[U],K=await O1t(F,{category:V,size:50,sortBy:"downloadCount",sortOrder:"desc"});p(G=>({...G,results:K.extensions,isSearching:!1,totalSize:K.totalSize})),N(K.extensions)}catch(V){p(K=>({...K,results:[],isSearching:!1,error:V instanceof Error?V.message:"Search failed"}))}},V1t)},[]),N=w.useCallback(async F=>{const U=Date.now(),V=F.filter(G=>{const J=`${G.namespace}.${G.name}`,ee=y.get(J);return!ee||U-ee.checkedAt>300*1e3});if(V.length===0)return;const K=5;for(let G=0;G<V.length;G+=K){const J=V.slice(G,G+K),ee=await Promise.allSettled(J.map(async ie=>{const fe=await xye(ie.namespace,ie.name);return{ext:ie,metadata:fe}})),Y=new Map(y);for(const ie of ee)if(ie.status==="fulfilled"){const{ext:fe,metadata:me}=ie.value,te=`${fe.namespace}.${fe.name}`,oe=k(me);Y.set(te,{isCompatible:oe.isCompatible,reasons:oe.reasons,checkedAt:U})}S(Y)}},[y]),k=w.useCallback(F=>{const U=[],K=(F.categories||[]).map(ie=>ie.toLowerCase()),G=["themes","programming languages","snippets","language packs"],J=K.some(ie=>G.some(fe=>ie.includes(fe))),ee=["debuggers","formatters","linters","testing","notebooks","data science","machine learning","extension packs"];return K.some(ie=>ee.some(fe=>ie.includes(fe)))&&!J?(U.push("This extension likely requires code execution"),{isCompatible:!1,reasons:U}):{isCompatible:!0,reasons:[]}},[]),j=w.useCallback(F=>{const U=F.target.value;_(U,c)},[c,_]),E=w.useCallback(F=>{u(F),m.query&&_(m.query,F)},[m.query,_]),T=w.useCallback(()=>{p({query:"",results:[],isSearching:!1,error:null,totalSize:0}),r.current?.focus()},[]),O=w.useCallback(async(F,U)=>{try{await s(F,U,"latest")}catch(V){console.error("[EditorExtensionsPanel] Install failed:",V)}},[s]),R=w.useCallback(async F=>{b(U=>new Set(U).add(F));try{await l(F)}catch(U){console.error("[EditorExtensionsPanel] Uninstall failed:",U)}finally{b(U=>{const V=new Set(U);return V.delete(F),V})}},[l]),q=w.useCallback((F,U)=>{const V=`${F}.${U}`;return a.some(K=>K.id===V||K.id===`${F}.${U}`)},[a]),$=w.useCallback((F,U)=>{const V=`${F}.${U}`;return y.get(V)},[y]),L=m.query.trim().length>0,A=L&&m.results.length>0,M=L&&!m.isSearching&&m.results.length===0&&!m.error,z=a.length>0,I=w.useMemo(()=>m.results.filter(F=>!q(F.namespace,F.name)),[m.results,q]),B=w.useMemo(()=>{const F=[];if(m.error&&F.push({type:"error",message:m.error}),z&&(F.push({type:"installed-header"}),d))for(const U of a)F.push({type:"installed-card",ext:U});if(A)for(const U of I){const V=`${U.namespace}.${U.name}`,K=$(U.namespace,U.name);F.push({type:"search-card",ext:U,extId:V,compatibility:K})}return M&&F.push({type:"empty-state",variant:"no-results"}),!L&&!z&&!m.isSearching&&F.push({type:"empty-state",variant:"browse"}),!L&&z&&!d&&!m.isSearching&&F.push({type:"empty-state",variant:"find-more"}),F},[m.error,z,d,a,A,I,$,M,L,m.isSearching]);return w.useEffect(()=>()=>{n.current&&window.clearTimeout(n.current)},[]),o.jsxs("div",{className:`flex flex-col h-full overflow-hidden ${e}`,"data-testid":"editor-extensions-panel",children:[o.jsxs("div",{className:"flex-shrink-0 p-2 border-b border-[var(--color-border)] space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(br,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("input",{ref:r,type:"text",value:m.query,onChange:j,placeholder:"Search extensions...",className:"w-full h-7 pl-7 pr-7 text-xs bg-[var(--color-surface)] border border-[var(--color-border)] rounded focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] text-[var(--color-text)] placeholder:text-[var(--color-text-muted)]","data-testid":"extensions-search-input"}),L&&!m.isSearching&&o.jsx("button",{onClick:T,className:"absolute right-1.5 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text)]",title:"Clear search","data-testid":"extensions-search-clear",children:o.jsx(wt,{className:"w-3.5 h-3.5"})}),m.isSearching&&o.jsx($e,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 animate-spin text-[var(--color-primary)]"})]}),o.jsx("div",{className:"flex gap-1",children:["All","Themes","Languages","Snippets"].map(F=>o.jsx("button",{onClick:()=>E(F),className:`
                px-2 py-1 text-xs rounded transition-colors
                ${c===F?"bg-[var(--color-primary)] text-white":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}
              `,"data-testid":`extensions-category-${F.toLowerCase()}`,children:F},F))}),L&&!m.isSearching&&o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[m.results.length," of ",m.totalSize," results"]})]}),o.jsx("div",{className:"flex-1 overflow-hidden","data-testid":"extensions-content",children:o.jsx(j1,{items:B,getItemKey:(F,U)=>{switch(F.type){case"installed-header":return"installed-header";case"installed-card":return`installed-${F.ext.id}`;case"search-card":return`search-${F.extId}`;case"empty-state":return`empty-${F.variant}`;case"error":return"error";default:return U}},estimateSize:80,overscan:5,height:"100%",renderItem:F=>{switch(F.type){case"installed-header":return o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("button",{onClick:()=>f(!d),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"extensions-installed-header",children:[d?o.jsx(cr,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"}):o.jsx(gn,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Installed"}),o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-[var(--color-primary)]/10 text-[var(--color-primary)]",children:a.length})]})});case"installed-card":return o.jsx("div",{"data-testid":"extensions-installed-list",children:o.jsx(vne,{extension:{url:"",name:F.ext.manifest.name,namespace:F.ext.manifest.publisher,version:F.ext.version,displayName:F.ext.manifest.displayName,description:F.ext.manifest.description,files:{}},isInstalled:!0,installedInfo:F.ext,isInstalling:!1,isUninstalling:v.has(F.ext.id),onInstall:O,onUninstall:R,onClick:t})});case"search-card":return o.jsx("div",{"data-testid":"extensions-search-results",children:o.jsx(vne,{extension:F.ext,isInstalled:!1,isInstalling:i.has(F.extId),isUninstalling:!1,isIncompatible:F.compatibility?.isCompatible===!1,incompatibilityReasons:F.compatibility?.reasons,onInstall:O,onUninstall:R,onClick:t})});case"empty-state":return F.variant==="no-results"?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(wt,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"No Results"}),o.jsxs("p",{className:"text-xs text-[var(--color-text-secondary)]",children:['No extensions found for "',m.query,'"']})]}):F.variant==="browse"?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(oy,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Browse Extensions"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Search for themes, languages, and snippets"})]}):F.variant==="find-more"?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(br,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Find More"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Search for more extensions above"})]}):null;case"error":return o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-danger)]/10 text-[var(--color-danger)] text-xs",children:[o.jsx(Bt,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{children:F.message})]});default:return null}},renderEmpty:()=>o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(oy,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Browse Extensions"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Search for themes, languages, and snippets"})]})})})]})}function J1t(e){const t=e.split(".").pop()?.toLowerCase()||"",r=e.toLowerCase();return["json","jsonc","json5"].includes(t)?rie:r.endsWith(".config.js")||r.endsWith(".config.ts")||r.startsWith(".")||["yaml","yml","toml","ini"].includes(t)?li:["ts","tsx","js","jsx","mjs","cjs","py","rs","go","rb","java","c","cpp","h","hpp"].includes(t)?Bs:["md","txt","rtf","doc","docx"].includes(t)?rn:L6}function Z1t(e){const t=e.split(".").pop()?.toLowerCase()||"";return["ts","tsx"].includes(t)?"text-blue-500":["js","jsx","mjs","cjs"].includes(t)?"text-yellow-500":["json","jsonc"].includes(t)?"text-yellow-400":["py"].includes(t)?"text-blue-400":["md","mdx"].includes(t)?"text-purple-400":["css","scss","sass"].includes(t)?"text-pink-500":["html","htm"].includes(t)?"text-orange-400":"text-[var(--color-text-muted)]"}function X1t({isOpen:e,fileName:t,onSave:r,onDiscard:n,onCancel:a}){return e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"save-confirm-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)] mb-2",children:"Unsaved Changes"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mb-6",children:["Do you want to save the changes you made to"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',t,'"']}),"?"]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-danger)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)]","data-testid":"save-confirm-discard",children:"Close Without Saving"}),o.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)]","data-testid":"save-confirm-cancel",children:"Cancel"}),o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)]","data-testid":"save-confirm-save",children:"Save & Close"})]})]})]}):null}function _ye({tab:e,isActive:t,onSelect:r,onClose:n,isDragging:a=!1}){const i=e.source==="extension"?nie:J1t(e.name),s=e.source==="extension"?"text-purple-500":Z1t(e.name);return o.jsxs("div",{onClick:r,className:`
        group flex items-center gap-1.5 px-3 py-1.5 min-w-0 max-w-48 cursor-pointer
        border-r border-r-[var(--color-border)] transition-colors
        ${t?"bg-[var(--color-surface)] border-t-2 border-t-[var(--color-primary)]":"bg-[var(--color-surface-hover)] border-t-2 border-t-[var(--color-border)] hover:bg-[var(--color-surface)]"}
        ${a?"opacity-50":""}
      `,"data-testid":`editor-tab-${e.id}`,children:[e.hasUnsavedChanges?o.jsx("span",{className:"w-2 h-2 rounded-full bg-[var(--color-text-secondary)] flex-shrink-0","data-testid":`editor-tab-dirty-${e.id}`,title:"Unsaved changes"}):o.jsx(i,{className:`w-4 h-4 flex-shrink-0 ${t?s:"text-[var(--color-text-muted)]"}`}),o.jsx("span",{className:`truncate text-sm ${t?"text-[var(--color-text)]":"text-[var(--color-text-secondary)]"}`,title:e.path,children:e.name}),o.jsx("button",{onClick:n,className:`
          ml-1 p-0.5 rounded flex-shrink-0 transition-colors
          ${e.hasUnsavedChanges||t?"opacity-100":"opacity-0 group-hover:opacity-100"}
          hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text)]
        `,title:"Close (Ctrl+W)","data-testid":`editor-tab-close-${e.id}`,children:o.jsx(wt,{className:"w-3.5 h-3.5"})})]})}function ewt({children:e,onClose:t,onCloseOthers:r,onCloseToRight:n,onCloseSaved:a,onCloseAll:i}){const s="flex items-center px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none";return o.jsxs(xie,{children:[o.jsx(wie,{asChild:!0,children:e}),o.jsx(Sie,{children:o.jsxs(kie,{className:"min-w-[180px] bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-lg py-1 z-50","data-testid":"tab-context-menu",children:[o.jsx(_s,{className:s,onSelect:t,"data-testid":"tab-context-menu-close",children:"Close"}),o.jsx(_s,{className:s,onSelect:r,"data-testid":"tab-context-menu-close-others",children:"Close Others"}),o.jsx(_s,{className:s,onSelect:n,"data-testid":"tab-context-menu-close-to-right",children:"Close to the Right"}),o.jsx(mk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsx(_s,{className:s,onSelect:a,"data-testid":"tab-context-menu-close-saved",children:"Close Saved"}),o.jsx(_s,{className:s,onSelect:i,"data-testid":"tab-context-menu-close-all",children:"Close All"})]})})]})}function twt({onContextClose:e,onContextCloseOthers:t,onContextCloseToRight:r,onContextCloseSaved:n,onContextCloseAll:a,...i}){const{attributes:s,listeners:l,setNodeRef:c,transform:u,transition:d,isDragging:f}=Npe({id:i.tab.id}),m={transform:Bl.Transform.toString(u),transition:d};return o.jsx(ewt,{tab:i.tab,onClose:e,onCloseOthers:t,onCloseToRight:r,onCloseSaved:n,onCloseAll:a,children:o.jsx("div",{ref:c,style:m,...s,...l,children:o.jsx(_ye,{...i,isDragging:f})})})}function rwt({tabs:e,activeTabId:t,onTabSelect:r,onTabClose:n,onTabsReorder:a,onSaveRequest:i}){const[s,l]=w.useState(null),[c,u]=w.useState({isOpen:!1,tabId:"",fileName:""}),d=w.useRef([]),f=IB(dx(x1,{activationConstraint:{distance:8}}),dx(C2,{coordinateGetter:Cpe})),m=s?e.find(q=>q.id===s):null,p=q=>{l(q.active.id)},v=q=>{const{active:$,over:L}=q;if(l(null),!L||$.id===L.id)return;const A=e.findIndex(B=>B.id===$.id),M=e.findIndex(B=>B.id===L.id);if(A===-1||M===-1)return;const z=[...e],[I]=z.splice(A,1);z.splice(M,0,I),a(z)},b=w.useCallback((q,$)=>{q.stopPropagation(),$.hasUnsavedChanges?u({isOpen:!0,tabId:$.id,fileName:$.name}):n($.id)},[n]),y=w.useCallback(()=>{if(d.current.length===0)return;const q=d.current[0],$=e.find(L=>L.id===q);$?u({isOpen:!0,tabId:$.id,fileName:$.name}):(d.current.shift(),y())},[e]),S=w.useCallback(async()=>{const{tabId:q}=c;if(i)try{await i(q)}catch($){console.error("Failed to save file:",$)}n(q),u({isOpen:!1,tabId:"",fileName:""}),d.current.shift(),setTimeout(()=>y(),0)},[c,i,n,y]),_=w.useCallback(()=>{n(c.tabId),u({isOpen:!1,tabId:"",fileName:""}),d.current.shift(),setTimeout(()=>y(),0)},[c.tabId,n,y]),N=w.useCallback(()=>{u({isOpen:!1,tabId:"",fileName:""}),d.current=[]},[]),k=w.useCallback(q=>{const $=q.map(M=>e.find(z=>z.id===M)).filter(Boolean),L=$.filter(M=>!M.hasUnsavedChanges),A=$.filter(M=>M.hasUnsavedChanges);L.forEach(M=>n(M.id)),A.length>0&&(d.current=A.map(M=>M.id),y())},[e,n,y]),j=w.useCallback(q=>{k([q])},[k]),E=w.useCallback(q=>{const $=e.filter(L=>L.id!==q).map(L=>L.id);k($)},[e,k]),T=w.useCallback(q=>{const $=e.findIndex(A=>A.id===q);if($===-1)return;const L=e.slice($+1).map(A=>A.id);L.length!==0&&k(L)},[e,k]),O=w.useCallback(()=>{const q=e.filter($=>!$.hasUnsavedChanges).map($=>$.id);q.length!==0&&q.forEach($=>n($))},[e,n]),R=w.useCallback(()=>{const q=e.map($=>$.id);k(q)},[e,k]);return e.length===0?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-stretch bg-[var(--color-surface-elevated)] border-b border-[var(--color-border)] overflow-x-auto","data-testid":"editor-tab-bar",children:o.jsxs(mC,{sensors:f,collisionDetection:Oet,onDragStart:p,onDragEnd:v,children:[o.jsx(kpe,{items:e.map(q=>q.id),strategy:Gtt,children:e.map(q=>o.jsx(twt,{tab:q,isActive:q.id===t,onSelect:()=>r(q.id),onClose:$=>b($,q),onContextClose:()=>j(q.id),onContextCloseOthers:()=>E(q.id),onContextCloseToRight:()=>T(q.id),onContextCloseSaved:O,onContextCloseAll:R},q.id))}),o.jsx(pC,{children:m&&o.jsx(_ye,{tab:m,isActive:m.id===t,onSelect:()=>{},onClose:()=>{}})})]})}),o.jsx(X1t,{isOpen:c.isOpen,fileName:c.fileName,onSave:S,onDiscard:_,onCancel:N})]})}const nwt=["typescript","javascript","typescriptreact","javascriptreact","python","rust","go","css","scss","less","html","json","jsonc"];function OC(e){return nwt.includes(e)}var wf={},sk={},gO={},At={},Ja={},bne;function A1(){if(bne)return Ja;bne=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.stringArray=Ja.array=Ja.func=Ja.error=Ja.number=Ja.string=Ja.boolean=void 0;function e(l){return l===!0||l===!1}Ja.boolean=e;function t(l){return typeof l=="string"||l instanceof String}Ja.string=t;function r(l){return typeof l=="number"||l instanceof Number}Ja.number=r;function n(l){return l instanceof Error}Ja.error=n;function a(l){return typeof l=="function"}Ja.func=a;function i(l){return Array.isArray(l)}Ja.array=i;function s(l){return i(l)&&l.every(c=>t(c))}return Ja.stringArray=s,Ja}var yne;function Nye(){if(yne)return At;yne=1,Object.defineProperty(At,"__esModule",{value:!0}),At.Message=At.NotificationType9=At.NotificationType8=At.NotificationType7=At.NotificationType6=At.NotificationType5=At.NotificationType4=At.NotificationType3=At.NotificationType2=At.NotificationType1=At.NotificationType0=At.NotificationType=At.RequestType9=At.RequestType8=At.RequestType7=At.RequestType6=At.RequestType5=At.RequestType4=At.RequestType3=At.RequestType2=At.RequestType1=At.RequestType=At.RequestType0=At.AbstractMessageSignature=At.ParameterStructures=At.ResponseError=At.ErrorCodes=void 0;const e=A1();var t;(function(L){L.ParseError=-32700,L.InvalidRequest=-32600,L.MethodNotFound=-32601,L.InvalidParams=-32602,L.InternalError=-32603,L.jsonrpcReservedErrorRangeStart=-32099,L.serverErrorStart=-32099,L.MessageWriteError=-32099,L.MessageReadError=-32098,L.PendingResponseRejected=-32097,L.ConnectionInactive=-32096,L.ServerNotInitialized=-32002,L.UnknownErrorCode=-32001,L.jsonrpcReservedErrorRangeEnd=-32e3,L.serverErrorEnd=-32e3})(t||(At.ErrorCodes=t={}));class r extends Error{constructor(A,M,z){super(M),this.code=e.number(A)?A:t.UnknownErrorCode,this.data=z,Object.setPrototypeOf(this,r.prototype)}toJson(){const A={code:this.code,message:this.message};return this.data!==void 0&&(A.data=this.data),A}}At.ResponseError=r;class n{constructor(A){this.kind=A}static is(A){return A===n.auto||A===n.byName||A===n.byPosition}toString(){return this.kind}}At.ParameterStructures=n,n.auto=new n("auto"),n.byPosition=new n("byPosition"),n.byName=new n("byName");class a{constructor(A,M){this.method=A,this.numberOfParams=M}get parameterStructures(){return n.auto}}At.AbstractMessageSignature=a;class i extends a{constructor(A){super(A,0)}}At.RequestType0=i;class s extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}At.RequestType=s;class l extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}At.RequestType1=l;class c extends a{constructor(A){super(A,2)}}At.RequestType2=c;class u extends a{constructor(A){super(A,3)}}At.RequestType3=u;class d extends a{constructor(A){super(A,4)}}At.RequestType4=d;class f extends a{constructor(A){super(A,5)}}At.RequestType5=f;class m extends a{constructor(A){super(A,6)}}At.RequestType6=m;class p extends a{constructor(A){super(A,7)}}At.RequestType7=p;class v extends a{constructor(A){super(A,8)}}At.RequestType8=v;class b extends a{constructor(A){super(A,9)}}At.RequestType9=b;class y extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}At.NotificationType=y;class S extends a{constructor(A){super(A,0)}}At.NotificationType0=S;class _ extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}At.NotificationType1=_;class N extends a{constructor(A){super(A,2)}}At.NotificationType2=N;class k extends a{constructor(A){super(A,3)}}At.NotificationType3=k;class j extends a{constructor(A){super(A,4)}}At.NotificationType4=j;class E extends a{constructor(A){super(A,5)}}At.NotificationType5=E;class T extends a{constructor(A){super(A,6)}}At.NotificationType6=T;class O extends a{constructor(A){super(A,7)}}At.NotificationType7=O;class R extends a{constructor(A){super(A,8)}}At.NotificationType8=R;class q extends a{constructor(A){super(A,9)}}At.NotificationType9=q;var $;return(function(L){function A(I){const B=I;return B&&e.string(B.method)&&(e.string(B.id)||e.number(B.id))}L.isRequest=A;function M(I){const B=I;return B&&e.string(B.method)&&I.id===void 0}L.isNotification=M;function z(I){const B=I;return B&&(B.result!==void 0||!!B.error)&&(e.string(B.id)||e.number(B.id)||B.id===null)}L.isResponse=z})($||(At.Message=$={})),At}var wc={},xne;function Cye(){if(xne)return wc;xne=1;var e;Object.defineProperty(wc,"__esModule",{value:!0}),wc.LRUCache=wc.LinkedMap=wc.Touch=void 0;var t;(function(a){a.None=0,a.First=1,a.AsOld=a.First,a.Last=2,a.AsNew=a.Last})(t||(wc.Touch=t={}));class r{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(i){return this._map.has(i)}get(i,s=t.None){const l=this._map.get(i);if(l)return s!==t.None&&this.touch(l,s),l.value}set(i,s,l=t.None){let c=this._map.get(i);if(c)c.value=s,l!==t.None&&this.touch(c,l);else{switch(c={key:i,value:s,next:void 0,previous:void 0},l){case t.None:this.addItemLast(c);break;case t.First:this.addItemFirst(c);break;case t.Last:this.addItemLast(c);break;default:this.addItemLast(c);break}this._map.set(i,c),this._size++}return this}delete(i){return!!this.remove(i)}remove(i){const s=this._map.get(i);if(s)return this._map.delete(i),this.removeItem(s),this._size--,s.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const i=this._head;return this._map.delete(i.key),this.removeItem(i),this._size--,i.value}forEach(i,s){const l=this._state;let c=this._head;for(;c;){if(s?i.bind(s)(c.value,c.key,this):i(c.value,c.key,this),this._state!==l)throw new Error("LinkedMap got modified during iteration.");c=c.next}}keys(){const i=this._state;let s=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==i)throw new Error("LinkedMap got modified during iteration.");if(s){const c={value:s.key,done:!1};return s=s.next,c}else return{value:void 0,done:!0}}};return l}values(){const i=this._state;let s=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==i)throw new Error("LinkedMap got modified during iteration.");if(s){const c={value:s.value,done:!1};return s=s.next,c}else return{value:void 0,done:!0}}};return l}entries(){const i=this._state;let s=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==i)throw new Error("LinkedMap got modified during iteration.");if(s){const c={value:[s.key,s.value],done:!1};return s=s.next,c}else return{value:void 0,done:!0}}};return l}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(i){if(i>=this.size)return;if(i===0){this.clear();return}let s=this._head,l=this.size;for(;s&&l>i;)this._map.delete(s.key),s=s.next,l--;this._head=s,this._size=l,s&&(s.previous=void 0),this._state++}addItemFirst(i){if(!this._head&&!this._tail)this._tail=i;else if(this._head)i.next=this._head,this._head.previous=i;else throw new Error("Invalid list");this._head=i,this._state++}addItemLast(i){if(!this._head&&!this._tail)this._head=i;else if(this._tail)i.previous=this._tail,this._tail.next=i;else throw new Error("Invalid list");this._tail=i,this._state++}removeItem(i){if(i===this._head&&i===this._tail)this._head=void 0,this._tail=void 0;else if(i===this._head){if(!i.next)throw new Error("Invalid list");i.next.previous=void 0,this._head=i.next}else if(i===this._tail){if(!i.previous)throw new Error("Invalid list");i.previous.next=void 0,this._tail=i.previous}else{const s=i.next,l=i.previous;if(!s||!l)throw new Error("Invalid list");s.previous=l,l.next=s}i.next=void 0,i.previous=void 0,this._state++}touch(i,s){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(s!==t.First&&s!==t.Last)){if(s===t.First){if(i===this._head)return;const l=i.next,c=i.previous;i===this._tail?(c.next=void 0,this._tail=c):(l.previous=c,c.next=l),i.previous=void 0,i.next=this._head,this._head.previous=i,this._head=i,this._state++}else if(s===t.Last){if(i===this._tail)return;const l=i.next,c=i.previous;i===this._head?(l.previous=void 0,this._head=l):(l.previous=c,c.next=l),i.next=void 0,i.previous=this._tail,this._tail.next=i,this._tail=i,this._state++}}}toJSON(){const i=[];return this.forEach((s,l)=>{i.push([l,s])}),i}fromJSON(i){this.clear();for(const[s,l]of i)this.set(s,l)}}wc.LinkedMap=r;class n extends r{constructor(i,s=1){super(),this._limit=i,this._ratio=Math.min(Math.max(0,s),1)}get limit(){return this._limit}set limit(i){this._limit=i,this.checkTrim()}get ratio(){return this._ratio}set ratio(i){this._ratio=Math.min(Math.max(0,i),1),this.checkTrim()}get(i,s=t.AsNew){return super.get(i,s)}peek(i){return super.get(i,t.None)}set(i,s){return super.set(i,s,t.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return wc.LRUCache=n,wc}var Vv={},wne;function awt(){if(wne)return Vv;wne=1,Object.defineProperty(Vv,"__esModule",{value:!0}),Vv.Disposable=void 0;var e;return(function(t){function r(n){return{dispose:n}}t.create=r})(e||(Vv.Disposable=e={})),Vv}var Sf={},ok={},Sne;function mm(){if(Sne)return ok;Sne=1,Object.defineProperty(ok,"__esModule",{value:!0});let e;function t(){if(e===void 0)throw new Error("No runtime abstraction layer installed");return e}return(function(r){function n(a){if(a===void 0)throw new Error("No runtime abstraction layer provided");e=a}r.install=n})(t||(t={})),ok.default=t,ok}var kne;function D1(){if(kne)return Sf;kne=1,Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.Emitter=Sf.Event=void 0;const e=mm();var t;(function(a){const i={dispose(){}};a.None=function(){return i}})(t||(Sf.Event=t={}));class r{add(i,s=null,l){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(i),this._contexts.push(s),Array.isArray(l)&&l.push({dispose:()=>this.remove(i,s)})}remove(i,s=null){if(!this._callbacks)return;let l=!1;for(let c=0,u=this._callbacks.length;c<u;c++)if(this._callbacks[c]===i)if(this._contexts[c]===s){this._callbacks.splice(c,1),this._contexts.splice(c,1);return}else l=!0;if(l)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...i){if(!this._callbacks)return[];const s=[],l=this._callbacks.slice(0),c=this._contexts.slice(0);for(let u=0,d=l.length;u<d;u++)try{s.push(l[u].apply(c[u],i))}catch(f){(0,e.default)().console.error(f)}return s}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(i){this._options=i}get event(){return this._event||(this._event=(i,s,l)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(i,s);const c={dispose:()=>{this._callbacks&&(this._callbacks.remove(i,s),c.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(l)&&l.push(c),c}),this._event}fire(i){this._callbacks&&this._callbacks.invoke.call(this._callbacks,i)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return Sf.Emitter=n,n._noop=function(){},Sf}var kf={},_ne;function U$(){if(_ne)return kf;_ne=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.CancellationTokenSource=kf.CancellationToken=void 0;const e=mm(),t=A1(),r=D1();var n;(function(l){l.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),l.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None});function c(u){const d=u;return d&&(d===l.None||d===l.Cancelled||t.boolean(d.isCancellationRequested)&&!!d.onCancellationRequested)}l.is=c})(n||(kf.CancellationToken=n={}));const a=Object.freeze(function(l,c){const u=(0,e.default)().timer.setTimeout(l.bind(c),0);return{dispose(){u.dispose()}}});class i{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class s{get token(){return this._token||(this._token=new i),this._token}cancel(){this._token?this._token.cancel():this._token=n.Cancelled}dispose(){this._token?this._token instanceof i&&this._token.dispose():this._token=n.None}}return kf.CancellationTokenSource=s,kf}var _f={},Nne;function iwt(){if(Nne)return _f;Nne=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.SharedArrayReceiverStrategy=_f.SharedArraySenderStrategy=void 0;const e=U$();var t;(function(s){s.Continue=0,s.Cancelled=1})(t||(t={}));class r{constructor(){this.buffers=new Map}enableCancellation(l){if(l.id===null)return;const c=new SharedArrayBuffer(4),u=new Int32Array(c,0,1);u[0]=t.Continue,this.buffers.set(l.id,c),l.$cancellationData=c}async sendCancellation(l,c){const u=this.buffers.get(c);if(u===void 0)return;const d=new Int32Array(u,0,1);Atomics.store(d,0,t.Cancelled)}cleanup(l){this.buffers.delete(l)}dispose(){this.buffers.clear()}}_f.SharedArraySenderStrategy=r;class n{constructor(l){this.data=new Int32Array(l,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===t.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class a{constructor(l){this.token=new n(l)}cancel(){}dispose(){}}class i{constructor(){this.kind="request"}createCancellationTokenSource(l){const c=l.$cancellationData;return c===void 0?new e.CancellationTokenSource:new a(c)}}return _f.SharedArrayReceiverStrategy=i,_f}var Sc={},Yv={},Cne;function jye(){if(Cne)return Yv;Cne=1,Object.defineProperty(Yv,"__esModule",{value:!0}),Yv.Semaphore=void 0;const e=mm();class t{constructor(n=1){if(n<=0)throw new Error("Capacity must be greater than 0");this._capacity=n,this._active=0,this._waiting=[]}lock(n){return new Promise((a,i)=>{this._waiting.push({thunk:n,resolve:a,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const n=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const a=n.thunk();a instanceof Promise?a.then(i=>{this._active--,n.resolve(i),this.runNext()},i=>{this._active--,n.reject(i),this.runNext()}):(this._active--,n.resolve(a),this.runNext())}catch(a){this._active--,n.reject(a),this.runNext()}}}return Yv.Semaphore=t,Yv}var jne;function swt(){if(jne)return Sc;jne=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.ReadableStreamMessageReader=Sc.AbstractMessageReader=Sc.MessageReader=void 0;const e=mm(),t=A1(),r=D1(),n=jye();var a;(function(c){function u(d){let f=d;return f&&t.func(f.listen)&&t.func(f.dispose)&&t.func(f.onError)&&t.func(f.onClose)&&t.func(f.onPartialMessage)}c.is=u})(a||(Sc.MessageReader=a={}));class i{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(u){this.errorEmitter.fire(this.asError(u))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(u){this.partialMessageEmitter.fire(u)}asError(u){return u instanceof Error?u:new Error(`Reader received error. Reason: ${t.string(u.message)?u.message:"unknown"}`)}}Sc.AbstractMessageReader=i;var s;(function(c){function u(d){let f,m;const p=new Map;let v;const b=new Map;if(d===void 0||typeof d=="string")f=d??"utf-8";else{if(f=d.charset??"utf-8",d.contentDecoder!==void 0&&(m=d.contentDecoder,p.set(m.name,m)),d.contentDecoders!==void 0)for(const y of d.contentDecoders)p.set(y.name,y);if(d.contentTypeDecoder!==void 0&&(v=d.contentTypeDecoder,b.set(v.name,v)),d.contentTypeDecoders!==void 0)for(const y of d.contentTypeDecoders)b.set(y.name,y)}return v===void 0&&(v=(0,e.default)().applicationJson.decoder,b.set(v.name,v)),{charset:f,contentDecoder:m,contentDecoders:p,contentTypeDecoder:v,contentTypeDecoders:b}}c.fromOptions=u})(s||(s={}));class l extends i{constructor(u,d){super(),this.readable=u,this.options=s.fromOptions(d),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new n.Semaphore(1)}set partialMessageTimeout(u){this._partialMessageTimeout=u}get partialMessageTimeout(){return this._partialMessageTimeout}listen(u){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=u;const d=this.readable.onData(f=>{this.onData(f)});return this.readable.onError(f=>this.fireError(f)),this.readable.onClose(()=>this.fireClose()),d}onData(u){try{for(this.buffer.append(u);;){if(this.nextMessageLength===-1){const f=this.buffer.tryReadHeaders(!0);if(!f)return;const m=f.get("content-length");if(!m){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(f))}`));return}const p=parseInt(m);if(isNaN(p)){this.fireError(new Error(`Content-Length value must be a number. Got ${m}`));return}this.nextMessageLength=p}const d=this.buffer.tryReadBody(this.nextMessageLength);if(d===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const f=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(d):d,m=await this.options.contentTypeDecoder.decode(f,this.options);this.callback(m)}).catch(f=>{this.fireError(f)})}}catch(d){this.fireError(d)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((u,d)=>{this.partialMessageTimer=void 0,u===this.messageToken&&(this.firePartialMessage({messageToken:u,waitingTime:d}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Sc.ReadableStreamMessageReader=l,Sc}var kc={},Ene;function owt(){if(Ene)return kc;Ene=1,Object.defineProperty(kc,"__esModule",{value:!0}),kc.WriteableStreamMessageWriter=kc.AbstractMessageWriter=kc.MessageWriter=void 0;const e=mm(),t=A1(),r=jye(),n=D1(),a="Content-Length: ",i=`\r
`;var s;(function(d){function f(m){let p=m;return p&&t.func(p.dispose)&&t.func(p.onClose)&&t.func(p.onError)&&t.func(p.write)}d.is=f})(s||(kc.MessageWriter=s={}));class l{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(f,m,p){this.errorEmitter.fire([this.asError(f),m,p])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(f){return f instanceof Error?f:new Error(`Writer received error. Reason: ${t.string(f.message)?f.message:"unknown"}`)}}kc.AbstractMessageWriter=l;var c;(function(d){function f(m){return m===void 0||typeof m=="string"?{charset:m??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:m.charset??"utf-8",contentEncoder:m.contentEncoder,contentTypeEncoder:m.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}d.fromOptions=f})(c||(c={}));class u extends l{constructor(f,m){super(),this.writable=f,this.options=c.fromOptions(m),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError(p=>this.fireError(p)),this.writable.onClose(()=>this.fireClose())}async write(f){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(f,this.options).then(p=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(p):p).then(p=>{const v=[];return v.push(a,p.byteLength.toString(),i),v.push(i),this.doWrite(f,v,p)},p=>{throw this.fireError(p),p}))}async doWrite(f,m,p){try{return await this.writable.write(m.join(""),"ascii"),this.writable.write(p)}catch(v){return this.handleError(v,f),Promise.reject(v)}}handleError(f,m){this.errorCount++,this.fireError(f,m,this.errorCount)}end(){this.writable.end()}}return kc.WriteableStreamMessageWriter=u,kc}var Qv={},Mne;function lwt(){if(Mne)return Qv;Mne=1,Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.AbstractMessageBuffer=void 0;const e=13,t=10,r=`\r
`;class n{constructor(i="utf-8"){this._encoding=i,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(i){const s=typeof i=="string"?this.fromString(i,this._encoding):i;this._chunks.push(s),this._totalLength+=s.byteLength}tryReadHeaders(i=!1){if(this._chunks.length===0)return;let s=0,l=0,c=0,u=0;e:for(;l<this._chunks.length;){const p=this._chunks[l];for(c=0;c<p.length;){switch(p[c]){case e:switch(s){case 0:s=1;break;case 2:s=3;break;default:s=0}break;case t:switch(s){case 1:s=2;break;case 3:s=4,c++;break e;default:s=0}break;default:s=0}c++}u+=p.byteLength,l++}if(s!==4)return;const d=this._read(u+c),f=new Map,m=this.toString(d,"ascii").split(r);if(m.length<2)return f;for(let p=0;p<m.length-2;p++){const v=m[p],b=v.indexOf(":");if(b===-1)throw new Error(`Message header must separate key and value using ':'
${v}`);const y=v.substr(0,b),S=v.substr(b+1).trim();f.set(i?y.toLowerCase():y,S)}return f}tryReadBody(i){if(!(this._totalLength<i))return this._read(i)}get numberOfBytes(){return this._totalLength}_read(i){if(i===0)return this.emptyBuffer();if(i>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===i){const u=this._chunks[0];return this._chunks.shift(),this._totalLength-=i,this.asNative(u)}if(this._chunks[0].byteLength>i){const u=this._chunks[0],d=this.asNative(u,i);return this._chunks[0]=u.slice(i),this._totalLength-=i,d}const s=this.allocNative(i);let l=0,c=0;for(;i>0;){const u=this._chunks[c];if(u.byteLength>i){const d=u.slice(0,i);s.set(d,l),l+=i,this._chunks[c]=u.slice(i),this._totalLength-=i,i-=i}else s.set(u,l),l+=u.byteLength,this._chunks.shift(),this._totalLength-=u.byteLength,i-=u.byteLength}return s}}return Qv.AbstractMessageBuffer=n,Qv}var vO={},Tne;function cwt(){return Tne||(Tne=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=mm(),r=A1(),n=Nye(),a=Cye(),i=D1(),s=U$();var l;(function(A){A.type=new n.NotificationType("$/cancelRequest")})(l||(l={}));var c;(function(A){function M(z){return typeof z=="string"||typeof z=="number"}A.is=M})(c||(e.ProgressToken=c={}));var u;(function(A){A.type=new n.NotificationType("$/progress")})(u||(u={}));class d{constructor(){}}e.ProgressType=d;var f;(function(A){function M(z){return r.func(z)}A.is=M})(f||(f={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var m;(function(A){A[A.Off=0]="Off",A[A.Messages=1]="Messages",A[A.Compact=2]="Compact",A[A.Verbose=3]="Verbose"})(m||(e.Trace=m={}));var p;(function(A){A.Off="off",A.Messages="messages",A.Compact="compact",A.Verbose="verbose"})(p||(e.TraceValues=p={})),(function(A){function M(I){if(!r.string(I))return A.Off;switch(I=I.toLowerCase(),I){case"off":return A.Off;case"messages":return A.Messages;case"compact":return A.Compact;case"verbose":return A.Verbose;default:return A.Off}}A.fromString=M;function z(I){switch(I){case A.Off:return"off";case A.Messages:return"messages";case A.Compact:return"compact";case A.Verbose:return"verbose";default:return"off"}}A.toString=z})(m||(e.Trace=m={}));var v;(function(A){A.Text="text",A.JSON="json"})(v||(e.TraceFormat=v={})),(function(A){function M(z){return r.string(z)?(z=z.toLowerCase(),z==="json"?A.JSON:A.Text):A.Text}A.fromString=M})(v||(e.TraceFormat=v={}));var b;(function(A){A.type=new n.NotificationType("$/setTrace")})(b||(e.SetTraceNotification=b={}));var y;(function(A){A.type=new n.NotificationType("$/logTrace")})(y||(e.LogTraceNotification=y={}));var S;(function(A){A[A.Closed=1]="Closed",A[A.Disposed=2]="Disposed",A[A.AlreadyListening=3]="AlreadyListening"})(S||(e.ConnectionErrors=S={}));class _ extends Error{constructor(M,z){super(z),this.code=M,Object.setPrototypeOf(this,_.prototype)}}e.ConnectionError=_;var N;(function(A){function M(z){const I=z;return I&&r.func(I.cancelUndispatched)}A.is=M})(N||(e.ConnectionStrategy=N={}));var k;(function(A){function M(z){const I=z;return I&&(I.kind===void 0||I.kind==="id")&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(k||(e.IdCancellationReceiverStrategy=k={}));var j;(function(A){function M(z){const I=z;return I&&I.kind==="request"&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(j||(e.RequestCancellationReceiverStrategy=j={}));var E;(function(A){A.Message=Object.freeze({createCancellationTokenSource(z){return new s.CancellationTokenSource}});function M(z){return k.is(z)||j.is(z)}A.is=M})(E||(e.CancellationReceiverStrategy=E={}));var T;(function(A){A.Message=Object.freeze({sendCancellation(z,I){return z.sendNotification(l.type,{id:I})},cleanup(z){}});function M(z){const I=z;return I&&r.func(I.sendCancellation)&&r.func(I.cleanup)}A.is=M})(T||(e.CancellationSenderStrategy=T={}));var O;(function(A){A.Message=Object.freeze({receiver:E.Message,sender:T.Message});function M(z){const I=z;return I&&E.is(I.receiver)&&T.is(I.sender)}A.is=M})(O||(e.CancellationStrategy=O={}));var R;(function(A){function M(z){const I=z;return I&&r.func(I.handleMessage)}A.is=M})(R||(e.MessageStrategy=R={}));var q;(function(A){function M(z){const I=z;return I&&(O.is(I.cancellationStrategy)||N.is(I.connectionStrategy)||R.is(I.messageStrategy))}A.is=M})(q||(e.ConnectionOptions=q={}));var $;(function(A){A[A.New=1]="New",A[A.Listening=2]="Listening",A[A.Closed=3]="Closed",A[A.Disposed=4]="Disposed"})($||($={}));function L(A,M,z,I){const B=z!==void 0?z:e.NullLogger;let F=0,U=0,V=0;const K="2.0";let G;const J=new Map;let ee;const Y=new Map,ie=new Map;let fe,me=new a.LinkedMap,te=new Map,oe=new Set,ce=new Map,Z=m.Off,ue=v.Text,H,ge=$.New;const de=new i.Emitter,re=new i.Emitter,ne=new i.Emitter,pe=new i.Emitter,ke=new i.Emitter,we=I&&I.cancellationStrategy?I.cancellationStrategy:O.Message;function ve(W){if(W===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+W.toString()}function Le(W){return W===null?"res-unknown-"+(++V).toString():"res-"+W.toString()}function Ae(){return"not-"+(++U).toString()}function Re(W,se){n.Message.isRequest(se)?W.set(ve(se.id),se):n.Message.isResponse(se)?W.set(Le(se.id),se):W.set(Ae(),se)}function Ye(W){}function mt(){return ge===$.Listening}function ot(){return ge===$.Closed}function Ot(){return ge===$.Disposed}function rt(){(ge===$.New||ge===$.Listening)&&(ge=$.Closed,re.fire(void 0))}function ze(W){de.fire([W,void 0,void 0])}function bt(W){de.fire(W)}A.onClose(rt),A.onError(ze),M.onClose(rt),M.onError(bt);function tt(){fe||me.size===0||(fe=(0,t.default)().timer.setImmediate(()=>{fe=void 0,We()}))}function _e(W){n.Message.isRequest(W)?Mt(W):n.Message.isNotification(W)?er(W):n.Message.isResponse(W)?kt(W):mr(W)}function We(){if(me.size===0)return;const W=me.shift();try{const se=I?.messageStrategy;R.is(se)?se.handleMessage(W,_e):_e(W)}finally{tt()}}const Ve=W=>{try{if(n.Message.isNotification(W)&&W.method===l.type.method){const se=W.params.id,xe=ve(se),Ce=me.get(xe);if(n.Message.isRequest(Ce)){const st=I?.connectionStrategy,Tt=st&&st.cancelUndispatched?st.cancelUndispatched(Ce,Ye):void 0;if(Tt&&(Tt.error!==void 0||Tt.result!==void 0)){me.delete(xe),ce.delete(se),Tt.id=Ce.id,he(Tt,W.method,Date.now()),M.write(Tt).catch(()=>B.error("Sending response for canceled message failed."));return}}const dt=ce.get(se);if(dt!==void 0){dt.cancel(),Ue(W);return}else oe.add(se)}Re(me,W)}finally{tt()}};function Mt(W){if(Ot())return;function se(lt,Pt,ct){const Ht={jsonrpc:K,id:W.id};lt instanceof n.ResponseError?Ht.error=lt.toJson():Ht.result=lt===void 0?null:lt,he(Ht,Pt,ct),M.write(Ht).catch(()=>B.error("Sending response failed."))}function xe(lt,Pt,ct){const Ht={jsonrpc:K,id:W.id,error:lt.toJson()};he(Ht,Pt,ct),M.write(Ht).catch(()=>B.error("Sending response failed."))}function Ce(lt,Pt,ct){lt===void 0&&(lt=null);const Ht={jsonrpc:K,id:W.id,result:lt};he(Ht,Pt,ct),M.write(Ht).catch(()=>B.error("Sending response failed."))}De(W);const dt=J.get(W.method);let st,Tt;dt&&(st=dt.type,Tt=dt.handler);const Ft=Date.now();if(Tt||G){const lt=W.id??String(Date.now()),Pt=k.is(we.receiver)?we.receiver.createCancellationTokenSource(lt):we.receiver.createCancellationTokenSource(W);W.id!==null&&oe.has(W.id)&&Pt.cancel(),W.id!==null&&ce.set(lt,Pt);try{let ct;if(Tt)if(W.params===void 0){if(st!==void 0&&st.numberOfParams!==0){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${W.method} defines ${st.numberOfParams} params but received none.`),W.method,Ft);return}ct=Tt(Pt.token)}else if(Array.isArray(W.params)){if(st!==void 0&&st.parameterStructures===n.ParameterStructures.byName){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${W.method} defines parameters by name but received parameters by position`),W.method,Ft);return}ct=Tt(...W.params,Pt.token)}else{if(st!==void 0&&st.parameterStructures===n.ParameterStructures.byPosition){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${W.method} defines parameters by position but received parameters by name`),W.method,Ft);return}ct=Tt(W.params,Pt.token)}else G&&(ct=G(W.method,W.params,Pt.token));const Ht=ct;ct?Ht.then?Ht.then(rr=>{ce.delete(lt),se(rr,W.method,Ft)},rr=>{ce.delete(lt),rr instanceof n.ResponseError?xe(rr,W.method,Ft):rr&&r.string(rr.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed with message: ${rr.message}`),W.method,Ft):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed unexpectedly without providing any details.`),W.method,Ft)}):(ce.delete(lt),se(ct,W.method,Ft)):(ce.delete(lt),Ce(ct,W.method,Ft))}catch(ct){ce.delete(lt),ct instanceof n.ResponseError?se(ct,W.method,Ft):ct&&r.string(ct.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed with message: ${ct.message}`),W.method,Ft):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed unexpectedly without providing any details.`),W.method,Ft)}}else xe(new n.ResponseError(n.ErrorCodes.MethodNotFound,`Unhandled method ${W.method}`),W.method,Ft)}function kt(W){if(!Ot())if(W.id===null)W.error?B.error(`Received response message without id: Error is: 
${JSON.stringify(W.error,void 0,4)}`):B.error("Received response message without id. No further error information provided.");else{const se=W.id,xe=te.get(se);if(ut(W,xe),xe!==void 0){te.delete(se);try{if(W.error){const Ce=W.error;xe.reject(new n.ResponseError(Ce.code,Ce.message,Ce.data))}else if(W.result!==void 0)xe.resolve(W.result);else throw new Error("Should never happen.")}catch(Ce){Ce.message?B.error(`Response handler '${xe.method}' failed with message: ${Ce.message}`):B.error(`Response handler '${xe.method}' failed unexpectedly.`)}}}}function er(W){if(Ot())return;let se,xe;if(W.method===l.type.method){const Ce=W.params.id;oe.delete(Ce),Ue(W);return}else{const Ce=Y.get(W.method);Ce&&(xe=Ce.handler,se=Ce.type)}if(xe||ee)try{if(Ue(W),xe)if(W.params===void 0)se!==void 0&&se.numberOfParams!==0&&se.parameterStructures!==n.ParameterStructures.byName&&B.error(`Notification ${W.method} defines ${se.numberOfParams} params but received none.`),xe();else if(Array.isArray(W.params)){const Ce=W.params;W.method===u.type.method&&Ce.length===2&&c.is(Ce[0])?xe({token:Ce[0],value:Ce[1]}):(se!==void 0&&(se.parameterStructures===n.ParameterStructures.byName&&B.error(`Notification ${W.method} defines parameters by name but received parameters by position`),se.numberOfParams!==W.params.length&&B.error(`Notification ${W.method} defines ${se.numberOfParams} params but received ${Ce.length} arguments`)),xe(...Ce))}else se!==void 0&&se.parameterStructures===n.ParameterStructures.byPosition&&B.error(`Notification ${W.method} defines parameters by position but received parameters by name`),xe(W.params);else ee&&ee(W.method,W.params)}catch(Ce){Ce.message?B.error(`Notification handler '${W.method}' failed with message: ${Ce.message}`):B.error(`Notification handler '${W.method}' failed unexpectedly.`)}else ne.fire(W)}function mr(W){if(!W){B.error("Received empty message.");return}B.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(W,null,4)}`);const se=W;if(r.string(se.id)||r.number(se.id)){const xe=se.id,Ce=te.get(xe);Ce&&Ce.reject(new Error("The received response has neither a result nor an error property."))}}function Zt(W){if(W!=null)switch(Z){case m.Verbose:return JSON.stringify(W,null,4);case m.Compact:return JSON.stringify(W);default:return}}function Wt(W){if(!(Z===m.Off||!H))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&W.params&&(se=`Params: ${Zt(W.params)}

`),H.log(`Sending request '${W.method} - (${W.id})'.`,se)}else St("send-request",W)}function Rt(W){if(!(Z===m.Off||!H))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&(W.params?se=`Params: ${Zt(W.params)}

`:se=`No parameters provided.

`),H.log(`Sending notification '${W.method}'.`,se)}else St("send-notification",W)}function he(W,se,xe){if(!(Z===m.Off||!H))if(ue===v.Text){let Ce;(Z===m.Verbose||Z===m.Compact)&&(W.error&&W.error.data?Ce=`Error data: ${Zt(W.error.data)}

`:W.result?Ce=`Result: ${Zt(W.result)}

`:W.error===void 0&&(Ce=`No result returned.

`)),H.log(`Sending response '${se} - (${W.id})'. Processing request took ${Date.now()-xe}ms`,Ce)}else St("send-response",W)}function De(W){if(!(Z===m.Off||!H))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&W.params&&(se=`Params: ${Zt(W.params)}

`),H.log(`Received request '${W.method} - (${W.id})'.`,se)}else St("receive-request",W)}function Ue(W){if(!(Z===m.Off||!H||W.method===y.type.method))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&(W.params?se=`Params: ${Zt(W.params)}

`:se=`No parameters provided.

`),H.log(`Received notification '${W.method}'.`,se)}else St("receive-notification",W)}function ut(W,se){if(!(Z===m.Off||!H))if(ue===v.Text){let xe;if((Z===m.Verbose||Z===m.Compact)&&(W.error&&W.error.data?xe=`Error data: ${Zt(W.error.data)}

`:W.result?xe=`Result: ${Zt(W.result)}

`:W.error===void 0&&(xe=`No result returned.

`)),se){const Ce=W.error?` Request failed: ${W.error.message} (${W.error.code}).`:"";H.log(`Received response '${se.method} - (${W.id})' in ${Date.now()-se.timerStart}ms.${Ce}`,xe)}else H.log(`Received response ${W.id} without active response promise.`,xe)}else St("receive-response",W)}function St(W,se){if(!H||Z===m.Off)return;const xe={isLSPMessage:!0,type:W,message:se,timestamp:Date.now()};H.log(xe)}function jt(){if(ot())throw new _(S.Closed,"Connection is closed.");if(Ot())throw new _(S.Disposed,"Connection is disposed.")}function Je(){if(mt())throw new _(S.AlreadyListening,"Connection is already listening")}function Xe(){if(!mt())throw new Error("Call listen() first.")}function it(W){return W===void 0?null:W}function Xt(W){if(W!==null)return W}function X(W){return W!=null&&!Array.isArray(W)&&typeof W=="object"}function Oe(W,se){switch(W){case n.ParameterStructures.auto:return X(se)?Xt(se):[it(se)];case n.ParameterStructures.byName:if(!X(se))throw new Error("Received parameters by name but param is not an object literal.");return Xt(se);case n.ParameterStructures.byPosition:return[it(se)];default:throw new Error(`Unknown parameter structure ${W.toString()}`)}}function Ke(W,se){let xe;const Ce=W.numberOfParams;switch(Ce){case 0:xe=void 0;break;case 1:xe=Oe(W.parameterStructures,se[0]);break;default:xe=[];for(let dt=0;dt<se.length&&dt<Ce;dt++)xe.push(it(se[dt]));if(se.length<Ce)for(let dt=se.length;dt<Ce;dt++)xe.push(null);break}return xe}const be={sendNotification:(W,...se)=>{jt();let xe,Ce;if(r.string(W)){xe=W;const st=se[0];let Tt=0,Ft=n.ParameterStructures.auto;n.ParameterStructures.is(st)&&(Tt=1,Ft=st);let lt=se.length;const Pt=lt-Tt;switch(Pt){case 0:Ce=void 0;break;case 1:Ce=Oe(Ft,se[Tt]);break;default:if(Ft===n.ParameterStructures.byName)throw new Error(`Received ${Pt} parameters for 'by Name' notification parameter structure.`);Ce=se.slice(Tt,lt).map(ct=>it(ct));break}}else{const st=se;xe=W.method,Ce=Ke(W,st)}const dt={jsonrpc:K,method:xe,params:Ce};return Rt(dt),M.write(dt).catch(st=>{throw B.error("Sending notification failed."),st})},onNotification:(W,se)=>{jt();let xe;return r.func(W)?ee=W:se&&(r.string(W)?(xe=W,Y.set(W,{type:void 0,handler:se})):(xe=W.method,Y.set(W.method,{type:W,handler:se}))),{dispose:()=>{xe!==void 0?Y.delete(xe):ee=void 0}}},onProgress:(W,se,xe)=>{if(ie.has(se))throw new Error(`Progress handler for token ${se} already registered`);return ie.set(se,xe),{dispose:()=>{ie.delete(se)}}},sendProgress:(W,se,xe)=>be.sendNotification(u.type,{token:se,value:xe}),onUnhandledProgress:pe.event,sendRequest:(W,...se)=>{jt(),Xe();let xe,Ce,dt;if(r.string(W)){xe=W;const lt=se[0],Pt=se[se.length-1];let ct=0,Ht=n.ParameterStructures.auto;n.ParameterStructures.is(lt)&&(ct=1,Ht=lt);let rr=se.length;s.CancellationToken.is(Pt)&&(rr=rr-1,dt=Pt);const Dr=rr-ct;switch(Dr){case 0:Ce=void 0;break;case 1:Ce=Oe(Ht,se[ct]);break;default:if(Ht===n.ParameterStructures.byName)throw new Error(`Received ${Dr} parameters for 'by Name' request parameter structure.`);Ce=se.slice(ct,rr).map(vn=>it(vn));break}}else{const lt=se;xe=W.method,Ce=Ke(W,lt);const Pt=W.numberOfParams;dt=s.CancellationToken.is(lt[Pt])?lt[Pt]:void 0}const st=F++;let Tt;dt&&(Tt=dt.onCancellationRequested(()=>{const lt=we.sender.sendCancellation(be,st);return lt===void 0?(B.log(`Received no promise from cancellation strategy when cancelling id ${st}`),Promise.resolve()):lt.catch(()=>{B.log(`Sending cancellation messages for id ${st} failed`)})}));const Ft={jsonrpc:K,id:st,method:xe,params:Ce};return Wt(Ft),typeof we.sender.enableCancellation=="function"&&we.sender.enableCancellation(Ft),new Promise(async(lt,Pt)=>{const ct=Dr=>{lt(Dr),we.sender.cleanup(st),Tt?.dispose()},Ht=Dr=>{Pt(Dr),we.sender.cleanup(st),Tt?.dispose()},rr={method:xe,timerStart:Date.now(),resolve:ct,reject:Ht};try{te.set(st,rr),await M.write(Ft)}catch(Dr){throw te.delete(st),rr.reject(new n.ResponseError(n.ErrorCodes.MessageWriteError,Dr.message?Dr.message:"Unknown reason")),B.error("Sending request failed."),Dr}})},onRequest:(W,se)=>{jt();let xe=null;return f.is(W)?(xe=void 0,G=W):r.string(W)?(xe=null,se!==void 0&&(xe=W,J.set(W,{handler:se,type:void 0}))):se!==void 0&&(xe=W.method,J.set(W.method,{type:W,handler:se})),{dispose:()=>{xe!==null&&(xe!==void 0?J.delete(xe):G=void 0)}}},hasPendingResponse:()=>te.size>0,trace:async(W,se,xe)=>{let Ce=!1,dt=v.Text;xe!==void 0&&(r.boolean(xe)?Ce=xe:(Ce=xe.sendNotification||!1,dt=xe.traceFormat||v.Text)),Z=W,ue=dt,Z===m.Off?H=void 0:H=se,Ce&&!ot()&&!Ot()&&await be.sendNotification(b.type,{value:m.toString(W)})},onError:de.event,onClose:re.event,onUnhandledNotification:ne.event,onDispose:ke.event,end:()=>{M.end()},dispose:()=>{if(Ot())return;ge=$.Disposed,ke.fire(void 0);const W=new n.ResponseError(n.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const se of te.values())se.reject(W);te=new Map,ce=new Map,oe=new Set,me=new a.LinkedMap,r.func(M.dispose)&&M.dispose(),r.func(A.dispose)&&A.dispose()},listen:()=>{jt(),Je(),ge=$.Listening,A.listen(Ve)},inspect:()=>{(0,t.default)().console.log("inspect")}};return be.onNotification(y.type,W=>{if(Z===m.Off||!H)return;const se=Z===m.Verbose||Z===m.Compact;H.log(W.message,se?W.verbose:void 0)}),be.onNotification(u.type,W=>{const se=ie.get(W.token);se?se(W.value):pe.fire(W)}),be}e.createMessageConnection=L})(vO)),vO}var Ane;function _5(){return Ane||(Ane=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=Nye();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const r=Cye();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return r.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return r.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return r.Touch}});const n=awt();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return n.Disposable}});const a=D1();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return a.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return a.Emitter}});const i=U$();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return i.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return i.CancellationToken}});const s=iwt();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const l=swt();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return l.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return l.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return l.ReadableStreamMessageReader}});const c=owt();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=lwt();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const d=cwt();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return d.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return d.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return d.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return d.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return d.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return d.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return d.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return d.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return d.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return d.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return d.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return d.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return d.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return d.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return d.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return d.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return d.MessageStrategy}});const f=mm();e.RAL=f.default})(gO)),gO}var Dne;function uwt(){if(Dne)return sk;Dne=1,Object.defineProperty(sk,"__esModule",{value:!0});const e=_5();class t extends e.AbstractMessageBuffer{constructor(c="utf-8"){super(c),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return t.emptyBuffer}fromString(c,u){return new TextEncoder().encode(c)}toString(c,u){return u==="ascii"?this.asciiDecoder.decode(c):new TextDecoder(u).decode(c)}asNative(c,u){return u===void 0?c:c.slice(0,u)}allocNative(c){return new Uint8Array(c)}}t.emptyBuffer=new Uint8Array(0);class r{constructor(c){this.socket=c,this._onData=new e.Emitter,this._messageListener=u=>{u.data.arrayBuffer().then(f=>{this._onData.fire(new Uint8Array(f))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}onData(c){return this._onData.event(c)}}class n{constructor(c){this.socket=c}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}write(c,u){if(typeof c=="string"){if(u!==void 0&&u!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${u}`);this.socket.send(c)}else this.socket.send(c);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,i=Object.freeze({messageBuffer:Object.freeze({create:l=>new t(l)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(l,c)=>{if(c.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${c.charset}`);return Promise.resolve(a.encode(JSON.stringify(l,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(l,c)=>{if(!(l instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(c.charset).decode(l)))}})}),stream:Object.freeze({asReadableStream:l=>new r(l),asWritableStream:l=>new n(l)}),console,timer:Object.freeze({setTimeout(l,c,...u){const d=setTimeout(l,c,...u);return{dispose:()=>clearTimeout(d)}},setImmediate(l,...c){const u=setTimeout(l,0,...c);return{dispose:()=>clearTimeout(u)}},setInterval(l,c,...u){const d=setInterval(l,c,...u);return{dispose:()=>clearInterval(d)}}})});function s(){return i}return(function(l){function c(){e.RAL.install(i)}l.install=c})(s||(s={})),sk.default=s,sk}var Lne;function dwt(){return Lne||(Lne=1,(function(e){var t=wf&&wf.__createBinding||(Object.create?(function(c,u,d,f){f===void 0&&(f=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,f,m)}):(function(c,u,d,f){f===void 0&&(f=d),c[f]=u[d]})),r=wf&&wf.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,uwt().default.install();const a=_5();r(_5(),e);class i extends a.AbstractMessageReader{constructor(u){super(),this._onData=new a.Emitter,this._messageListener=d=>{this._onData.fire(d.data)},u.addEventListener("error",d=>this.fireError(d)),u.onmessage=this._messageListener}listen(u){return this._onData.event(u)}}e.BrowserMessageReader=i;class s extends a.AbstractMessageWriter{constructor(u){super(),this.port=u,this.errorCount=0,u.addEventListener("error",d=>this.fireError(d))}write(u){try{return this.port.postMessage(u),Promise.resolve()}catch(d){return this.handleError(d,u),Promise.reject(d)}}handleError(u,d){this.errorCount++,this.fireError(u,d,this.errorCount)}end(){}}e.BrowserMessageWriter=s;function l(c,u,d,f){return d===void 0&&(d=a.NullLogger),a.ConnectionStrategy.is(f)&&(f={connectionStrategy:f}),(0,a.createMessageConnection)(c,u,d,f)}e.createMessageConnection=l})(wf)),wf}var H$=dwt();class fwt extends H$.AbstractMessageReader{constructor(r){super();xt(this,"socket");xt(this,"state","initial");xt(this,"callback");xt(this,"events",[]);this.socket=r,this.socket.onMessage(n=>this.readMessage(n)),this.socket.onError(n=>this.fireError(n)),this.socket.onClose((n,a)=>{if(n!==1e3){const i={name:""+n,message:`Error during socket reconnect: code = ${n}, reason = ${a}`};this.fireError(i)}this.fireClose()})}listen(r){if(this.state==="initial")for(this.state="listening",this.callback=r;this.events.length!==0;){const n=this.events.pop();n.message!==void 0?this.readMessage(n.message):n.error!==void 0?this.fireError(n.error):this.fireClose()}return{dispose:()=>{this.callback===r&&(this.state="initial",this.callback=void 0)}}}dispose(){super.dispose(),this.state="initial",this.callback=void 0,this.events.splice(0,this.events.length)}readMessage(r){if(this.state==="initial")this.events.splice(0,0,{message:r});else if(this.state==="listening")try{const n=JSON.parse(r);this.callback(n)}catch(n){const a={name:"400",message:`Error during message parsing, reason = ${typeof n=="object"?n.message:"unknown"}`};this.fireError(a)}}fireError(r){this.state==="initial"?this.events.splice(0,0,{error:r}):this.state==="listening"&&super.fireError(r)}fireClose(){this.state==="initial"?this.events.splice(0,0,{}):this.state==="listening"&&super.fireClose(),this.state="closed"}}class hwt extends H$.AbstractMessageWriter{constructor(r){super();xt(this,"errorCount",0);xt(this,"socket");this.socket=r}end(){}async write(r){try{const n=JSON.stringify(r);this.socket.send(n)}catch(n){this.errorCount++,this.fireError(n,r,this.errorCount)}}}function mwt(e){return{send:t=>e.send(t),onMessage:t=>{e.onmessage=r=>t(r.data)},onError:t=>{e.onerror=r=>{Object.hasOwn(r,"message")&&t(r.message)}},onClose:t=>{e.onclose=r=>t(r.code,r.reason)},dispose:()=>e.close()}}var Nf={},Cf={},lk={},bO={},Dt={},Za={},One;function L1(){if(One)return Za;One=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.stringArray=Za.array=Za.func=Za.error=Za.number=Za.string=Za.boolean=void 0;function e(l){return l===!0||l===!1}Za.boolean=e;function t(l){return typeof l=="string"||l instanceof String}Za.string=t;function r(l){return typeof l=="number"||l instanceof Number}Za.number=r;function n(l){return l instanceof Error}Za.error=n;function a(l){return typeof l=="function"}Za.func=a;function i(l){return Array.isArray(l)}Za.array=i;function s(l){return i(l)&&l.every(c=>t(c))}return Za.stringArray=s,Za}var Ine;function Eye(){if(Ine)return Dt;Ine=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.Message=Dt.NotificationType9=Dt.NotificationType8=Dt.NotificationType7=Dt.NotificationType6=Dt.NotificationType5=Dt.NotificationType4=Dt.NotificationType3=Dt.NotificationType2=Dt.NotificationType1=Dt.NotificationType0=Dt.NotificationType=Dt.RequestType9=Dt.RequestType8=Dt.RequestType7=Dt.RequestType6=Dt.RequestType5=Dt.RequestType4=Dt.RequestType3=Dt.RequestType2=Dt.RequestType1=Dt.RequestType=Dt.RequestType0=Dt.AbstractMessageSignature=Dt.ParameterStructures=Dt.ResponseError=Dt.ErrorCodes=void 0;const e=L1();var t;(function(L){L.ParseError=-32700,L.InvalidRequest=-32600,L.MethodNotFound=-32601,L.InvalidParams=-32602,L.InternalError=-32603,L.jsonrpcReservedErrorRangeStart=-32099,L.serverErrorStart=-32099,L.MessageWriteError=-32099,L.MessageReadError=-32098,L.PendingResponseRejected=-32097,L.ConnectionInactive=-32096,L.ServerNotInitialized=-32002,L.UnknownErrorCode=-32001,L.jsonrpcReservedErrorRangeEnd=-32e3,L.serverErrorEnd=-32e3})(t||(Dt.ErrorCodes=t={}));class r extends Error{constructor(A,M,z){super(M),this.code=e.number(A)?A:t.UnknownErrorCode,this.data=z,Object.setPrototypeOf(this,r.prototype)}toJson(){const A={code:this.code,message:this.message};return this.data!==void 0&&(A.data=this.data),A}}Dt.ResponseError=r;class n{constructor(A){this.kind=A}static is(A){return A===n.auto||A===n.byName||A===n.byPosition}toString(){return this.kind}}Dt.ParameterStructures=n,n.auto=new n("auto"),n.byPosition=new n("byPosition"),n.byName=new n("byName");class a{constructor(A,M){this.method=A,this.numberOfParams=M}get parameterStructures(){return n.auto}}Dt.AbstractMessageSignature=a;class i extends a{constructor(A){super(A,0)}}Dt.RequestType0=i;class s extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Dt.RequestType=s;class l extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Dt.RequestType1=l;class c extends a{constructor(A){super(A,2)}}Dt.RequestType2=c;class u extends a{constructor(A){super(A,3)}}Dt.RequestType3=u;class d extends a{constructor(A){super(A,4)}}Dt.RequestType4=d;class f extends a{constructor(A){super(A,5)}}Dt.RequestType5=f;class m extends a{constructor(A){super(A,6)}}Dt.RequestType6=m;class p extends a{constructor(A){super(A,7)}}Dt.RequestType7=p;class v extends a{constructor(A){super(A,8)}}Dt.RequestType8=v;class b extends a{constructor(A){super(A,9)}}Dt.RequestType9=b;class y extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Dt.NotificationType=y;class S extends a{constructor(A){super(A,0)}}Dt.NotificationType0=S;class _ extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Dt.NotificationType1=_;class N extends a{constructor(A){super(A,2)}}Dt.NotificationType2=N;class k extends a{constructor(A){super(A,3)}}Dt.NotificationType3=k;class j extends a{constructor(A){super(A,4)}}Dt.NotificationType4=j;class E extends a{constructor(A){super(A,5)}}Dt.NotificationType5=E;class T extends a{constructor(A){super(A,6)}}Dt.NotificationType6=T;class O extends a{constructor(A){super(A,7)}}Dt.NotificationType7=O;class R extends a{constructor(A){super(A,8)}}Dt.NotificationType8=R;class q extends a{constructor(A){super(A,9)}}Dt.NotificationType9=q;var $;return(function(L){function A(I){const B=I;return B&&e.string(B.method)&&(e.string(B.id)||e.number(B.id))}L.isRequest=A;function M(I){const B=I;return B&&e.string(B.method)&&I.id===void 0}L.isNotification=M;function z(I){const B=I;return B&&(B.result!==void 0||!!B.error)&&(e.string(B.id)||e.number(B.id)||B.id===null)}L.isResponse=z})($||(Dt.Message=$={})),Dt}var _c={},Rne;function Mye(){if(Rne)return _c;Rne=1;var e;Object.defineProperty(_c,"__esModule",{value:!0}),_c.LRUCache=_c.LinkedMap=_c.Touch=void 0;var t;(function(a){a.None=0,a.First=1,a.AsOld=a.First,a.Last=2,a.AsNew=a.Last})(t||(_c.Touch=t={}));class r{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(i){return this._map.has(i)}get(i,s=t.None){const l=this._map.get(i);if(l)return s!==t.None&&this.touch(l,s),l.value}set(i,s,l=t.None){let c=this._map.get(i);if(c)c.value=s,l!==t.None&&this.touch(c,l);else{switch(c={key:i,value:s,next:void 0,previous:void 0},l){case t.None:this.addItemLast(c);break;case t.First:this.addItemFirst(c);break;case t.Last:this.addItemLast(c);break;default:this.addItemLast(c);break}this._map.set(i,c),this._size++}return this}delete(i){return!!this.remove(i)}remove(i){const s=this._map.get(i);if(s)return this._map.delete(i),this.removeItem(s),this._size--,s.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const i=this._head;return this._map.delete(i.key),this.removeItem(i),this._size--,i.value}forEach(i,s){const l=this._state;let c=this._head;for(;c;){if(s?i.bind(s)(c.value,c.key,this):i(c.value,c.key,this),this._state!==l)throw new Error("LinkedMap got modified during iteration.");c=c.next}}keys(){const i=this._state;let s=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==i)throw new Error("LinkedMap got modified during iteration.");if(s){const c={value:s.key,done:!1};return s=s.next,c}else return{value:void 0,done:!0}}};return l}values(){const i=this._state;let s=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==i)throw new Error("LinkedMap got modified during iteration.");if(s){const c={value:s.value,done:!1};return s=s.next,c}else return{value:void 0,done:!0}}};return l}entries(){const i=this._state;let s=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==i)throw new Error("LinkedMap got modified during iteration.");if(s){const c={value:[s.key,s.value],done:!1};return s=s.next,c}else return{value:void 0,done:!0}}};return l}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(i){if(i>=this.size)return;if(i===0){this.clear();return}let s=this._head,l=this.size;for(;s&&l>i;)this._map.delete(s.key),s=s.next,l--;this._head=s,this._size=l,s&&(s.previous=void 0),this._state++}addItemFirst(i){if(!this._head&&!this._tail)this._tail=i;else if(this._head)i.next=this._head,this._head.previous=i;else throw new Error("Invalid list");this._head=i,this._state++}addItemLast(i){if(!this._head&&!this._tail)this._head=i;else if(this._tail)i.previous=this._tail,this._tail.next=i;else throw new Error("Invalid list");this._tail=i,this._state++}removeItem(i){if(i===this._head&&i===this._tail)this._head=void 0,this._tail=void 0;else if(i===this._head){if(!i.next)throw new Error("Invalid list");i.next.previous=void 0,this._head=i.next}else if(i===this._tail){if(!i.previous)throw new Error("Invalid list");i.previous.next=void 0,this._tail=i.previous}else{const s=i.next,l=i.previous;if(!s||!l)throw new Error("Invalid list");s.previous=l,l.next=s}i.next=void 0,i.previous=void 0,this._state++}touch(i,s){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(s!==t.First&&s!==t.Last)){if(s===t.First){if(i===this._head)return;const l=i.next,c=i.previous;i===this._tail?(c.next=void 0,this._tail=c):(l.previous=c,c.next=l),i.previous=void 0,i.next=this._head,this._head.previous=i,this._head=i,this._state++}else if(s===t.Last){if(i===this._tail)return;const l=i.next,c=i.previous;i===this._head?(l.previous=void 0,this._head=l):(l.previous=c,c.next=l),i.next=void 0,i.previous=this._tail,this._tail.next=i,this._tail=i,this._state++}}}toJSON(){const i=[];return this.forEach((s,l)=>{i.push([l,s])}),i}fromJSON(i){this.clear();for(const[s,l]of i)this.set(s,l)}}_c.LinkedMap=r;class n extends r{constructor(i,s=1){super(),this._limit=i,this._ratio=Math.min(Math.max(0,s),1)}get limit(){return this._limit}set limit(i){this._limit=i,this.checkTrim()}get ratio(){return this._ratio}set ratio(i){this._ratio=Math.min(Math.max(0,i),1),this.checkTrim()}get(i,s=t.AsNew){return super.get(i,s)}peek(i){return super.get(i,t.None)}set(i,s){return super.set(i,s,t.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return _c.LRUCache=n,_c}var Jv={},Pne;function pwt(){if(Pne)return Jv;Pne=1,Object.defineProperty(Jv,"__esModule",{value:!0}),Jv.Disposable=void 0;var e;return(function(t){function r(n){return{dispose:n}}t.create=r})(e||(Jv.Disposable=e={})),Jv}var jf={},ck={},zne;function pm(){if(zne)return ck;zne=1,Object.defineProperty(ck,"__esModule",{value:!0});let e;function t(){if(e===void 0)throw new Error("No runtime abstraction layer installed");return e}return(function(r){function n(a){if(a===void 0)throw new Error("No runtime abstraction layer provided");e=a}r.install=n})(t||(t={})),ck.default=t,ck}var Bne;function O1(){if(Bne)return jf;Bne=1,Object.defineProperty(jf,"__esModule",{value:!0}),jf.Emitter=jf.Event=void 0;const e=pm();var t;(function(a){const i={dispose(){}};a.None=function(){return i}})(t||(jf.Event=t={}));class r{add(i,s=null,l){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(i),this._contexts.push(s),Array.isArray(l)&&l.push({dispose:()=>this.remove(i,s)})}remove(i,s=null){if(!this._callbacks)return;let l=!1;for(let c=0,u=this._callbacks.length;c<u;c++)if(this._callbacks[c]===i)if(this._contexts[c]===s){this._callbacks.splice(c,1),this._contexts.splice(c,1);return}else l=!0;if(l)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...i){if(!this._callbacks)return[];const s=[],l=this._callbacks.slice(0),c=this._contexts.slice(0);for(let u=0,d=l.length;u<d;u++)try{s.push(l[u].apply(c[u],i))}catch(f){(0,e.default)().console.error(f)}return s}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(i){this._options=i}get event(){return this._event||(this._event=(i,s,l)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(i,s);const c={dispose:()=>{this._callbacks&&(this._callbacks.remove(i,s),c.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(l)&&l.push(c),c}),this._event}fire(i){this._callbacks&&this._callbacks.invoke.call(this._callbacks,i)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return jf.Emitter=n,n._noop=function(){},jf}var Ef={},$ne;function q$(){if($ne)return Ef;$ne=1,Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.CancellationTokenSource=Ef.CancellationToken=void 0;const e=pm(),t=L1(),r=O1();var n;(function(l){l.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),l.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None});function c(u){const d=u;return d&&(d===l.None||d===l.Cancelled||t.boolean(d.isCancellationRequested)&&!!d.onCancellationRequested)}l.is=c})(n||(Ef.CancellationToken=n={}));const a=Object.freeze(function(l,c){const u=(0,e.default)().timer.setTimeout(l.bind(c),0);return{dispose(){u.dispose()}}});class i{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class s{get token(){return this._token||(this._token=new i),this._token}cancel(){this._token?this._token.cancel():this._token=n.Cancelled}dispose(){this._token?this._token instanceof i&&this._token.dispose():this._token=n.None}}return Ef.CancellationTokenSource=s,Ef}var Mf={},Fne;function gwt(){if(Fne)return Mf;Fne=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.SharedArrayReceiverStrategy=Mf.SharedArraySenderStrategy=void 0;const e=q$();var t;(function(s){s.Continue=0,s.Cancelled=1})(t||(t={}));class r{constructor(){this.buffers=new Map}enableCancellation(l){if(l.id===null)return;const c=new SharedArrayBuffer(4),u=new Int32Array(c,0,1);u[0]=t.Continue,this.buffers.set(l.id,c),l.$cancellationData=c}async sendCancellation(l,c){const u=this.buffers.get(c);if(u===void 0)return;const d=new Int32Array(u,0,1);Atomics.store(d,0,t.Cancelled)}cleanup(l){this.buffers.delete(l)}dispose(){this.buffers.clear()}}Mf.SharedArraySenderStrategy=r;class n{constructor(l){this.data=new Int32Array(l,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===t.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class a{constructor(l){this.token=new n(l)}cancel(){}dispose(){}}class i{constructor(){this.kind="request"}createCancellationTokenSource(l){const c=l.$cancellationData;return c===void 0?new e.CancellationTokenSource:new a(c)}}return Mf.SharedArrayReceiverStrategy=i,Mf}var Nc={},Zv={},Une;function Tye(){if(Une)return Zv;Une=1,Object.defineProperty(Zv,"__esModule",{value:!0}),Zv.Semaphore=void 0;const e=pm();class t{constructor(n=1){if(n<=0)throw new Error("Capacity must be greater than 0");this._capacity=n,this._active=0,this._waiting=[]}lock(n){return new Promise((a,i)=>{this._waiting.push({thunk:n,resolve:a,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const n=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const a=n.thunk();a instanceof Promise?a.then(i=>{this._active--,n.resolve(i),this.runNext()},i=>{this._active--,n.reject(i),this.runNext()}):(this._active--,n.resolve(a),this.runNext())}catch(a){this._active--,n.reject(a),this.runNext()}}}return Zv.Semaphore=t,Zv}var Hne;function vwt(){if(Hne)return Nc;Hne=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.ReadableStreamMessageReader=Nc.AbstractMessageReader=Nc.MessageReader=void 0;const e=pm(),t=L1(),r=O1(),n=Tye();var a;(function(c){function u(d){let f=d;return f&&t.func(f.listen)&&t.func(f.dispose)&&t.func(f.onError)&&t.func(f.onClose)&&t.func(f.onPartialMessage)}c.is=u})(a||(Nc.MessageReader=a={}));class i{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(u){this.errorEmitter.fire(this.asError(u))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(u){this.partialMessageEmitter.fire(u)}asError(u){return u instanceof Error?u:new Error(`Reader received error. Reason: ${t.string(u.message)?u.message:"unknown"}`)}}Nc.AbstractMessageReader=i;var s;(function(c){function u(d){let f,m;const p=new Map;let v;const b=new Map;if(d===void 0||typeof d=="string")f=d??"utf-8";else{if(f=d.charset??"utf-8",d.contentDecoder!==void 0&&(m=d.contentDecoder,p.set(m.name,m)),d.contentDecoders!==void 0)for(const y of d.contentDecoders)p.set(y.name,y);if(d.contentTypeDecoder!==void 0&&(v=d.contentTypeDecoder,b.set(v.name,v)),d.contentTypeDecoders!==void 0)for(const y of d.contentTypeDecoders)b.set(y.name,y)}return v===void 0&&(v=(0,e.default)().applicationJson.decoder,b.set(v.name,v)),{charset:f,contentDecoder:m,contentDecoders:p,contentTypeDecoder:v,contentTypeDecoders:b}}c.fromOptions=u})(s||(s={}));class l extends i{constructor(u,d){super(),this.readable=u,this.options=s.fromOptions(d),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new n.Semaphore(1)}set partialMessageTimeout(u){this._partialMessageTimeout=u}get partialMessageTimeout(){return this._partialMessageTimeout}listen(u){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=u;const d=this.readable.onData(f=>{this.onData(f)});return this.readable.onError(f=>this.fireError(f)),this.readable.onClose(()=>this.fireClose()),d}onData(u){try{for(this.buffer.append(u);;){if(this.nextMessageLength===-1){const f=this.buffer.tryReadHeaders(!0);if(!f)return;const m=f.get("content-length");if(!m){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(f))}`));return}const p=parseInt(m);if(isNaN(p)){this.fireError(new Error(`Content-Length value must be a number. Got ${m}`));return}this.nextMessageLength=p}const d=this.buffer.tryReadBody(this.nextMessageLength);if(d===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const f=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(d):d,m=await this.options.contentTypeDecoder.decode(f,this.options);this.callback(m)}).catch(f=>{this.fireError(f)})}}catch(d){this.fireError(d)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((u,d)=>{this.partialMessageTimer=void 0,u===this.messageToken&&(this.firePartialMessage({messageToken:u,waitingTime:d}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Nc.ReadableStreamMessageReader=l,Nc}var Cc={},qne;function bwt(){if(qne)return Cc;qne=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.WriteableStreamMessageWriter=Cc.AbstractMessageWriter=Cc.MessageWriter=void 0;const e=pm(),t=L1(),r=Tye(),n=O1(),a="Content-Length: ",i=`\r
`;var s;(function(d){function f(m){let p=m;return p&&t.func(p.dispose)&&t.func(p.onClose)&&t.func(p.onError)&&t.func(p.write)}d.is=f})(s||(Cc.MessageWriter=s={}));class l{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(f,m,p){this.errorEmitter.fire([this.asError(f),m,p])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(f){return f instanceof Error?f:new Error(`Writer received error. Reason: ${t.string(f.message)?f.message:"unknown"}`)}}Cc.AbstractMessageWriter=l;var c;(function(d){function f(m){return m===void 0||typeof m=="string"?{charset:m??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:m.charset??"utf-8",contentEncoder:m.contentEncoder,contentTypeEncoder:m.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}d.fromOptions=f})(c||(c={}));class u extends l{constructor(f,m){super(),this.writable=f,this.options=c.fromOptions(m),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError(p=>this.fireError(p)),this.writable.onClose(()=>this.fireClose())}async write(f){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(f,this.options).then(p=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(p):p).then(p=>{const v=[];return v.push(a,p.byteLength.toString(),i),v.push(i),this.doWrite(f,v,p)},p=>{throw this.fireError(p),p}))}async doWrite(f,m,p){try{return await this.writable.write(m.join(""),"ascii"),this.writable.write(p)}catch(v){return this.handleError(v,f),Promise.reject(v)}}handleError(f,m){this.errorCount++,this.fireError(f,m,this.errorCount)}end(){this.writable.end()}}return Cc.WriteableStreamMessageWriter=u,Cc}var Xv={},Wne;function ywt(){if(Wne)return Xv;Wne=1,Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.AbstractMessageBuffer=void 0;const e=13,t=10,r=`\r
`;class n{constructor(i="utf-8"){this._encoding=i,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(i){const s=typeof i=="string"?this.fromString(i,this._encoding):i;this._chunks.push(s),this._totalLength+=s.byteLength}tryReadHeaders(i=!1){if(this._chunks.length===0)return;let s=0,l=0,c=0,u=0;e:for(;l<this._chunks.length;){const p=this._chunks[l];for(c=0;c<p.length;){switch(p[c]){case e:switch(s){case 0:s=1;break;case 2:s=3;break;default:s=0}break;case t:switch(s){case 1:s=2;break;case 3:s=4,c++;break e;default:s=0}break;default:s=0}c++}u+=p.byteLength,l++}if(s!==4)return;const d=this._read(u+c),f=new Map,m=this.toString(d,"ascii").split(r);if(m.length<2)return f;for(let p=0;p<m.length-2;p++){const v=m[p],b=v.indexOf(":");if(b===-1)throw new Error(`Message header must separate key and value using ':'
${v}`);const y=v.substr(0,b),S=v.substr(b+1).trim();f.set(i?y.toLowerCase():y,S)}return f}tryReadBody(i){if(!(this._totalLength<i))return this._read(i)}get numberOfBytes(){return this._totalLength}_read(i){if(i===0)return this.emptyBuffer();if(i>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===i){const u=this._chunks[0];return this._chunks.shift(),this._totalLength-=i,this.asNative(u)}if(this._chunks[0].byteLength>i){const u=this._chunks[0],d=this.asNative(u,i);return this._chunks[0]=u.slice(i),this._totalLength-=i,d}const s=this.allocNative(i);let l=0,c=0;for(;i>0;){const u=this._chunks[c];if(u.byteLength>i){const d=u.slice(0,i);s.set(d,l),l+=i,this._chunks[c]=u.slice(i),this._totalLength-=i,i-=i}else s.set(u,l),l+=u.byteLength,this._chunks.shift(),this._totalLength-=u.byteLength,i-=u.byteLength}return s}}return Xv.AbstractMessageBuffer=n,Xv}var yO={},Kne;function xwt(){return Kne||(Kne=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=pm(),r=L1(),n=Eye(),a=Mye(),i=O1(),s=q$();var l;(function(A){A.type=new n.NotificationType("$/cancelRequest")})(l||(l={}));var c;(function(A){function M(z){return typeof z=="string"||typeof z=="number"}A.is=M})(c||(e.ProgressToken=c={}));var u;(function(A){A.type=new n.NotificationType("$/progress")})(u||(u={}));class d{constructor(){}}e.ProgressType=d;var f;(function(A){function M(z){return r.func(z)}A.is=M})(f||(f={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var m;(function(A){A[A.Off=0]="Off",A[A.Messages=1]="Messages",A[A.Compact=2]="Compact",A[A.Verbose=3]="Verbose"})(m||(e.Trace=m={}));var p;(function(A){A.Off="off",A.Messages="messages",A.Compact="compact",A.Verbose="verbose"})(p||(e.TraceValues=p={})),(function(A){function M(I){if(!r.string(I))return A.Off;switch(I=I.toLowerCase(),I){case"off":return A.Off;case"messages":return A.Messages;case"compact":return A.Compact;case"verbose":return A.Verbose;default:return A.Off}}A.fromString=M;function z(I){switch(I){case A.Off:return"off";case A.Messages:return"messages";case A.Compact:return"compact";case A.Verbose:return"verbose";default:return"off"}}A.toString=z})(m||(e.Trace=m={}));var v;(function(A){A.Text="text",A.JSON="json"})(v||(e.TraceFormat=v={})),(function(A){function M(z){return r.string(z)?(z=z.toLowerCase(),z==="json"?A.JSON:A.Text):A.Text}A.fromString=M})(v||(e.TraceFormat=v={}));var b;(function(A){A.type=new n.NotificationType("$/setTrace")})(b||(e.SetTraceNotification=b={}));var y;(function(A){A.type=new n.NotificationType("$/logTrace")})(y||(e.LogTraceNotification=y={}));var S;(function(A){A[A.Closed=1]="Closed",A[A.Disposed=2]="Disposed",A[A.AlreadyListening=3]="AlreadyListening"})(S||(e.ConnectionErrors=S={}));class _ extends Error{constructor(M,z){super(z),this.code=M,Object.setPrototypeOf(this,_.prototype)}}e.ConnectionError=_;var N;(function(A){function M(z){const I=z;return I&&r.func(I.cancelUndispatched)}A.is=M})(N||(e.ConnectionStrategy=N={}));var k;(function(A){function M(z){const I=z;return I&&(I.kind===void 0||I.kind==="id")&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(k||(e.IdCancellationReceiverStrategy=k={}));var j;(function(A){function M(z){const I=z;return I&&I.kind==="request"&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(j||(e.RequestCancellationReceiverStrategy=j={}));var E;(function(A){A.Message=Object.freeze({createCancellationTokenSource(z){return new s.CancellationTokenSource}});function M(z){return k.is(z)||j.is(z)}A.is=M})(E||(e.CancellationReceiverStrategy=E={}));var T;(function(A){A.Message=Object.freeze({sendCancellation(z,I){return z.sendNotification(l.type,{id:I})},cleanup(z){}});function M(z){const I=z;return I&&r.func(I.sendCancellation)&&r.func(I.cleanup)}A.is=M})(T||(e.CancellationSenderStrategy=T={}));var O;(function(A){A.Message=Object.freeze({receiver:E.Message,sender:T.Message});function M(z){const I=z;return I&&E.is(I.receiver)&&T.is(I.sender)}A.is=M})(O||(e.CancellationStrategy=O={}));var R;(function(A){function M(z){const I=z;return I&&r.func(I.handleMessage)}A.is=M})(R||(e.MessageStrategy=R={}));var q;(function(A){function M(z){const I=z;return I&&(O.is(I.cancellationStrategy)||N.is(I.connectionStrategy)||R.is(I.messageStrategy))}A.is=M})(q||(e.ConnectionOptions=q={}));var $;(function(A){A[A.New=1]="New",A[A.Listening=2]="Listening",A[A.Closed=3]="Closed",A[A.Disposed=4]="Disposed"})($||($={}));function L(A,M,z,I){const B=z!==void 0?z:e.NullLogger;let F=0,U=0,V=0;const K="2.0";let G;const J=new Map;let ee;const Y=new Map,ie=new Map;let fe,me=new a.LinkedMap,te=new Map,oe=new Set,ce=new Map,Z=m.Off,ue=v.Text,H,ge=$.New;const de=new i.Emitter,re=new i.Emitter,ne=new i.Emitter,pe=new i.Emitter,ke=new i.Emitter,we=I&&I.cancellationStrategy?I.cancellationStrategy:O.Message;function ve(W){if(W===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+W.toString()}function Le(W){return W===null?"res-unknown-"+(++V).toString():"res-"+W.toString()}function Ae(){return"not-"+(++U).toString()}function Re(W,se){n.Message.isRequest(se)?W.set(ve(se.id),se):n.Message.isResponse(se)?W.set(Le(se.id),se):W.set(Ae(),se)}function Ye(W){}function mt(){return ge===$.Listening}function ot(){return ge===$.Closed}function Ot(){return ge===$.Disposed}function rt(){(ge===$.New||ge===$.Listening)&&(ge=$.Closed,re.fire(void 0))}function ze(W){de.fire([W,void 0,void 0])}function bt(W){de.fire(W)}A.onClose(rt),A.onError(ze),M.onClose(rt),M.onError(bt);function tt(){fe||me.size===0||(fe=(0,t.default)().timer.setImmediate(()=>{fe=void 0,We()}))}function _e(W){n.Message.isRequest(W)?Mt(W):n.Message.isNotification(W)?er(W):n.Message.isResponse(W)?kt(W):mr(W)}function We(){if(me.size===0)return;const W=me.shift();try{const se=I?.messageStrategy;R.is(se)?se.handleMessage(W,_e):_e(W)}finally{tt()}}const Ve=W=>{try{if(n.Message.isNotification(W)&&W.method===l.type.method){const se=W.params.id,xe=ve(se),Ce=me.get(xe);if(n.Message.isRequest(Ce)){const st=I?.connectionStrategy,Tt=st&&st.cancelUndispatched?st.cancelUndispatched(Ce,Ye):void 0;if(Tt&&(Tt.error!==void 0||Tt.result!==void 0)){me.delete(xe),ce.delete(se),Tt.id=Ce.id,he(Tt,W.method,Date.now()),M.write(Tt).catch(()=>B.error("Sending response for canceled message failed."));return}}const dt=ce.get(se);if(dt!==void 0){dt.cancel(),Ue(W);return}else oe.add(se)}Re(me,W)}finally{tt()}};function Mt(W){if(Ot())return;function se(lt,Pt,ct){const Ht={jsonrpc:K,id:W.id};lt instanceof n.ResponseError?Ht.error=lt.toJson():Ht.result=lt===void 0?null:lt,he(Ht,Pt,ct),M.write(Ht).catch(()=>B.error("Sending response failed."))}function xe(lt,Pt,ct){const Ht={jsonrpc:K,id:W.id,error:lt.toJson()};he(Ht,Pt,ct),M.write(Ht).catch(()=>B.error("Sending response failed."))}function Ce(lt,Pt,ct){lt===void 0&&(lt=null);const Ht={jsonrpc:K,id:W.id,result:lt};he(Ht,Pt,ct),M.write(Ht).catch(()=>B.error("Sending response failed."))}De(W);const dt=J.get(W.method);let st,Tt;dt&&(st=dt.type,Tt=dt.handler);const Ft=Date.now();if(Tt||G){const lt=W.id??String(Date.now()),Pt=k.is(we.receiver)?we.receiver.createCancellationTokenSource(lt):we.receiver.createCancellationTokenSource(W);W.id!==null&&oe.has(W.id)&&Pt.cancel(),W.id!==null&&ce.set(lt,Pt);try{let ct;if(Tt)if(W.params===void 0){if(st!==void 0&&st.numberOfParams!==0){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${W.method} defines ${st.numberOfParams} params but received none.`),W.method,Ft);return}ct=Tt(Pt.token)}else if(Array.isArray(W.params)){if(st!==void 0&&st.parameterStructures===n.ParameterStructures.byName){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${W.method} defines parameters by name but received parameters by position`),W.method,Ft);return}ct=Tt(...W.params,Pt.token)}else{if(st!==void 0&&st.parameterStructures===n.ParameterStructures.byPosition){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${W.method} defines parameters by position but received parameters by name`),W.method,Ft);return}ct=Tt(W.params,Pt.token)}else G&&(ct=G(W.method,W.params,Pt.token));const Ht=ct;ct?Ht.then?Ht.then(rr=>{ce.delete(lt),se(rr,W.method,Ft)},rr=>{ce.delete(lt),rr instanceof n.ResponseError?xe(rr,W.method,Ft):rr&&r.string(rr.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed with message: ${rr.message}`),W.method,Ft):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed unexpectedly without providing any details.`),W.method,Ft)}):(ce.delete(lt),se(ct,W.method,Ft)):(ce.delete(lt),Ce(ct,W.method,Ft))}catch(ct){ce.delete(lt),ct instanceof n.ResponseError?se(ct,W.method,Ft):ct&&r.string(ct.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed with message: ${ct.message}`),W.method,Ft):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${W.method} failed unexpectedly without providing any details.`),W.method,Ft)}}else xe(new n.ResponseError(n.ErrorCodes.MethodNotFound,`Unhandled method ${W.method}`),W.method,Ft)}function kt(W){if(!Ot())if(W.id===null)W.error?B.error(`Received response message without id: Error is: 
${JSON.stringify(W.error,void 0,4)}`):B.error("Received response message without id. No further error information provided.");else{const se=W.id,xe=te.get(se);if(ut(W,xe),xe!==void 0){te.delete(se);try{if(W.error){const Ce=W.error;xe.reject(new n.ResponseError(Ce.code,Ce.message,Ce.data))}else if(W.result!==void 0)xe.resolve(W.result);else throw new Error("Should never happen.")}catch(Ce){Ce.message?B.error(`Response handler '${xe.method}' failed with message: ${Ce.message}`):B.error(`Response handler '${xe.method}' failed unexpectedly.`)}}}}function er(W){if(Ot())return;let se,xe;if(W.method===l.type.method){const Ce=W.params.id;oe.delete(Ce),Ue(W);return}else{const Ce=Y.get(W.method);Ce&&(xe=Ce.handler,se=Ce.type)}if(xe||ee)try{if(Ue(W),xe)if(W.params===void 0)se!==void 0&&se.numberOfParams!==0&&se.parameterStructures!==n.ParameterStructures.byName&&B.error(`Notification ${W.method} defines ${se.numberOfParams} params but received none.`),xe();else if(Array.isArray(W.params)){const Ce=W.params;W.method===u.type.method&&Ce.length===2&&c.is(Ce[0])?xe({token:Ce[0],value:Ce[1]}):(se!==void 0&&(se.parameterStructures===n.ParameterStructures.byName&&B.error(`Notification ${W.method} defines parameters by name but received parameters by position`),se.numberOfParams!==W.params.length&&B.error(`Notification ${W.method} defines ${se.numberOfParams} params but received ${Ce.length} arguments`)),xe(...Ce))}else se!==void 0&&se.parameterStructures===n.ParameterStructures.byPosition&&B.error(`Notification ${W.method} defines parameters by position but received parameters by name`),xe(W.params);else ee&&ee(W.method,W.params)}catch(Ce){Ce.message?B.error(`Notification handler '${W.method}' failed with message: ${Ce.message}`):B.error(`Notification handler '${W.method}' failed unexpectedly.`)}else ne.fire(W)}function mr(W){if(!W){B.error("Received empty message.");return}B.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(W,null,4)}`);const se=W;if(r.string(se.id)||r.number(se.id)){const xe=se.id,Ce=te.get(xe);Ce&&Ce.reject(new Error("The received response has neither a result nor an error property."))}}function Zt(W){if(W!=null)switch(Z){case m.Verbose:return JSON.stringify(W,null,4);case m.Compact:return JSON.stringify(W);default:return}}function Wt(W){if(!(Z===m.Off||!H))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&W.params&&(se=`Params: ${Zt(W.params)}

`),H.log(`Sending request '${W.method} - (${W.id})'.`,se)}else St("send-request",W)}function Rt(W){if(!(Z===m.Off||!H))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&(W.params?se=`Params: ${Zt(W.params)}

`:se=`No parameters provided.

`),H.log(`Sending notification '${W.method}'.`,se)}else St("send-notification",W)}function he(W,se,xe){if(!(Z===m.Off||!H))if(ue===v.Text){let Ce;(Z===m.Verbose||Z===m.Compact)&&(W.error&&W.error.data?Ce=`Error data: ${Zt(W.error.data)}

`:W.result?Ce=`Result: ${Zt(W.result)}

`:W.error===void 0&&(Ce=`No result returned.

`)),H.log(`Sending response '${se} - (${W.id})'. Processing request took ${Date.now()-xe}ms`,Ce)}else St("send-response",W)}function De(W){if(!(Z===m.Off||!H))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&W.params&&(se=`Params: ${Zt(W.params)}

`),H.log(`Received request '${W.method} - (${W.id})'.`,se)}else St("receive-request",W)}function Ue(W){if(!(Z===m.Off||!H||W.method===y.type.method))if(ue===v.Text){let se;(Z===m.Verbose||Z===m.Compact)&&(W.params?se=`Params: ${Zt(W.params)}

`:se=`No parameters provided.

`),H.log(`Received notification '${W.method}'.`,se)}else St("receive-notification",W)}function ut(W,se){if(!(Z===m.Off||!H))if(ue===v.Text){let xe;if((Z===m.Verbose||Z===m.Compact)&&(W.error&&W.error.data?xe=`Error data: ${Zt(W.error.data)}

`:W.result?xe=`Result: ${Zt(W.result)}

`:W.error===void 0&&(xe=`No result returned.

`)),se){const Ce=W.error?` Request failed: ${W.error.message} (${W.error.code}).`:"";H.log(`Received response '${se.method} - (${W.id})' in ${Date.now()-se.timerStart}ms.${Ce}`,xe)}else H.log(`Received response ${W.id} without active response promise.`,xe)}else St("receive-response",W)}function St(W,se){if(!H||Z===m.Off)return;const xe={isLSPMessage:!0,type:W,message:se,timestamp:Date.now()};H.log(xe)}function jt(){if(ot())throw new _(S.Closed,"Connection is closed.");if(Ot())throw new _(S.Disposed,"Connection is disposed.")}function Je(){if(mt())throw new _(S.AlreadyListening,"Connection is already listening")}function Xe(){if(!mt())throw new Error("Call listen() first.")}function it(W){return W===void 0?null:W}function Xt(W){if(W!==null)return W}function X(W){return W!=null&&!Array.isArray(W)&&typeof W=="object"}function Oe(W,se){switch(W){case n.ParameterStructures.auto:return X(se)?Xt(se):[it(se)];case n.ParameterStructures.byName:if(!X(se))throw new Error("Received parameters by name but param is not an object literal.");return Xt(se);case n.ParameterStructures.byPosition:return[it(se)];default:throw new Error(`Unknown parameter structure ${W.toString()}`)}}function Ke(W,se){let xe;const Ce=W.numberOfParams;switch(Ce){case 0:xe=void 0;break;case 1:xe=Oe(W.parameterStructures,se[0]);break;default:xe=[];for(let dt=0;dt<se.length&&dt<Ce;dt++)xe.push(it(se[dt]));if(se.length<Ce)for(let dt=se.length;dt<Ce;dt++)xe.push(null);break}return xe}const be={sendNotification:(W,...se)=>{jt();let xe,Ce;if(r.string(W)){xe=W;const st=se[0];let Tt=0,Ft=n.ParameterStructures.auto;n.ParameterStructures.is(st)&&(Tt=1,Ft=st);let lt=se.length;const Pt=lt-Tt;switch(Pt){case 0:Ce=void 0;break;case 1:Ce=Oe(Ft,se[Tt]);break;default:if(Ft===n.ParameterStructures.byName)throw new Error(`Received ${Pt} parameters for 'by Name' notification parameter structure.`);Ce=se.slice(Tt,lt).map(ct=>it(ct));break}}else{const st=se;xe=W.method,Ce=Ke(W,st)}const dt={jsonrpc:K,method:xe,params:Ce};return Rt(dt),M.write(dt).catch(st=>{throw B.error("Sending notification failed."),st})},onNotification:(W,se)=>{jt();let xe;return r.func(W)?ee=W:se&&(r.string(W)?(xe=W,Y.set(W,{type:void 0,handler:se})):(xe=W.method,Y.set(W.method,{type:W,handler:se}))),{dispose:()=>{xe!==void 0?Y.delete(xe):ee=void 0}}},onProgress:(W,se,xe)=>{if(ie.has(se))throw new Error(`Progress handler for token ${se} already registered`);return ie.set(se,xe),{dispose:()=>{ie.delete(se)}}},sendProgress:(W,se,xe)=>be.sendNotification(u.type,{token:se,value:xe}),onUnhandledProgress:pe.event,sendRequest:(W,...se)=>{jt(),Xe();let xe,Ce,dt;if(r.string(W)){xe=W;const lt=se[0],Pt=se[se.length-1];let ct=0,Ht=n.ParameterStructures.auto;n.ParameterStructures.is(lt)&&(ct=1,Ht=lt);let rr=se.length;s.CancellationToken.is(Pt)&&(rr=rr-1,dt=Pt);const Dr=rr-ct;switch(Dr){case 0:Ce=void 0;break;case 1:Ce=Oe(Ht,se[ct]);break;default:if(Ht===n.ParameterStructures.byName)throw new Error(`Received ${Dr} parameters for 'by Name' request parameter structure.`);Ce=se.slice(ct,rr).map(vn=>it(vn));break}}else{const lt=se;xe=W.method,Ce=Ke(W,lt);const Pt=W.numberOfParams;dt=s.CancellationToken.is(lt[Pt])?lt[Pt]:void 0}const st=F++;let Tt;dt&&(Tt=dt.onCancellationRequested(()=>{const lt=we.sender.sendCancellation(be,st);return lt===void 0?(B.log(`Received no promise from cancellation strategy when cancelling id ${st}`),Promise.resolve()):lt.catch(()=>{B.log(`Sending cancellation messages for id ${st} failed`)})}));const Ft={jsonrpc:K,id:st,method:xe,params:Ce};return Wt(Ft),typeof we.sender.enableCancellation=="function"&&we.sender.enableCancellation(Ft),new Promise(async(lt,Pt)=>{const ct=Dr=>{lt(Dr),we.sender.cleanup(st),Tt?.dispose()},Ht=Dr=>{Pt(Dr),we.sender.cleanup(st),Tt?.dispose()},rr={method:xe,timerStart:Date.now(),resolve:ct,reject:Ht};try{await M.write(Ft),te.set(st,rr)}catch(Dr){throw B.error("Sending request failed."),rr.reject(new n.ResponseError(n.ErrorCodes.MessageWriteError,Dr.message?Dr.message:"Unknown reason")),Dr}})},onRequest:(W,se)=>{jt();let xe=null;return f.is(W)?(xe=void 0,G=W):r.string(W)?(xe=null,se!==void 0&&(xe=W,J.set(W,{handler:se,type:void 0}))):se!==void 0&&(xe=W.method,J.set(W.method,{type:W,handler:se})),{dispose:()=>{xe!==null&&(xe!==void 0?J.delete(xe):G=void 0)}}},hasPendingResponse:()=>te.size>0,trace:async(W,se,xe)=>{let Ce=!1,dt=v.Text;xe!==void 0&&(r.boolean(xe)?Ce=xe:(Ce=xe.sendNotification||!1,dt=xe.traceFormat||v.Text)),Z=W,ue=dt,Z===m.Off?H=void 0:H=se,Ce&&!ot()&&!Ot()&&await be.sendNotification(b.type,{value:m.toString(W)})},onError:de.event,onClose:re.event,onUnhandledNotification:ne.event,onDispose:ke.event,end:()=>{M.end()},dispose:()=>{if(Ot())return;ge=$.Disposed,ke.fire(void 0);const W=new n.ResponseError(n.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const se of te.values())se.reject(W);te=new Map,ce=new Map,oe=new Set,me=new a.LinkedMap,r.func(M.dispose)&&M.dispose(),r.func(A.dispose)&&A.dispose()},listen:()=>{jt(),Je(),ge=$.Listening,A.listen(Ve)},inspect:()=>{(0,t.default)().console.log("inspect")}};return be.onNotification(y.type,W=>{if(Z===m.Off||!H)return;const se=Z===m.Verbose||Z===m.Compact;H.log(W.message,se?W.verbose:void 0)}),be.onNotification(u.type,W=>{const se=ie.get(W.token);se?se(W.value):pe.fire(W)}),be}e.createMessageConnection=L})(yO)),yO}var Gne;function N5(){return Gne||(Gne=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=Eye();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const r=Mye();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return r.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return r.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return r.Touch}});const n=pwt();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return n.Disposable}});const a=O1();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return a.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return a.Emitter}});const i=q$();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return i.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return i.CancellationToken}});const s=gwt();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const l=vwt();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return l.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return l.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return l.ReadableStreamMessageReader}});const c=bwt();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=ywt();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const d=xwt();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return d.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return d.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return d.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return d.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return d.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return d.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return d.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return d.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return d.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return d.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return d.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return d.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return d.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return d.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return d.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return d.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return d.MessageStrategy}});const f=pm();e.RAL=f.default})(bO)),bO}var Vne;function wwt(){if(Vne)return lk;Vne=1,Object.defineProperty(lk,"__esModule",{value:!0});const e=N5();class t extends e.AbstractMessageBuffer{constructor(c="utf-8"){super(c),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return t.emptyBuffer}fromString(c,u){return new TextEncoder().encode(c)}toString(c,u){return u==="ascii"?this.asciiDecoder.decode(c):new TextDecoder(u).decode(c)}asNative(c,u){return u===void 0?c:c.slice(0,u)}allocNative(c){return new Uint8Array(c)}}t.emptyBuffer=new Uint8Array(0);class r{constructor(c){this.socket=c,this._onData=new e.Emitter,this._messageListener=u=>{u.data.arrayBuffer().then(f=>{this._onData.fire(new Uint8Array(f))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}onData(c){return this._onData.event(c)}}class n{constructor(c){this.socket=c}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}write(c,u){if(typeof c=="string"){if(u!==void 0&&u!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${u}`);this.socket.send(c)}else this.socket.send(c);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,i=Object.freeze({messageBuffer:Object.freeze({create:l=>new t(l)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(l,c)=>{if(c.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${c.charset}`);return Promise.resolve(a.encode(JSON.stringify(l,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(l,c)=>{if(!(l instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(c.charset).decode(l)))}})}),stream:Object.freeze({asReadableStream:l=>new r(l),asWritableStream:l=>new n(l)}),console,timer:Object.freeze({setTimeout(l,c,...u){const d=setTimeout(l,c,...u);return{dispose:()=>clearTimeout(d)}},setImmediate(l,...c){const u=setTimeout(l,0,...c);return{dispose:()=>clearTimeout(u)}},setInterval(l,c,...u){const d=setInterval(l,c,...u);return{dispose:()=>clearInterval(d)}}})});function s(){return i}return(function(l){function c(){e.RAL.install(i)}l.install=c})(s||(s={})),lk.default=s,lk}var Yne;function N0(){return Yne||(Yne=1,(function(e){var t=Cf&&Cf.__createBinding||(Object.create?(function(c,u,d,f){f===void 0&&(f=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,f,m)}):(function(c,u,d,f){f===void 0&&(f=d),c[f]=u[d]})),r=Cf&&Cf.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,wwt().default.install();const a=N5();r(N5(),e);class i extends a.AbstractMessageReader{constructor(u){super(),this._onData=new a.Emitter,this._messageListener=d=>{this._onData.fire(d.data)},u.addEventListener("error",d=>this.fireError(d)),u.onmessage=this._messageListener}listen(u){return this._onData.event(u)}}e.BrowserMessageReader=i;class s extends a.AbstractMessageWriter{constructor(u){super(),this.port=u,this.errorCount=0,u.addEventListener("error",d=>this.fireError(d))}write(u){try{return this.port.postMessage(u),Promise.resolve()}catch(d){return this.handleError(d,u),Promise.reject(d)}}handleError(u,d){this.errorCount++,this.fireError(u,d,this.errorCount)}end(){}}e.BrowserMessageWriter=s;function l(c,u,d,f){return d===void 0&&(d=a.NullLogger),a.ConnectionStrategy.is(f)&&(f={connectionStrategy:f}),(0,a.createMessageConnection)(c,u,d,f)}e.createMessageConnection=l})(Cf)),Cf}var xO,Qne;function Jne(){return Qne||(Qne=1,xO=N0()),xO}var Tf={},C5;(function(e){function t(r){return typeof r=="string"}e.is=t})(C5||(C5={}));var IC;(function(e){function t(r){return typeof r=="string"}e.is=t})(IC||(IC={}));var j5;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647;function t(r){return typeof r=="number"&&e.MIN_VALUE<=r&&r<=e.MAX_VALUE}e.is=t})(j5||(j5={}));var jx;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647;function t(r){return typeof r=="number"&&e.MIN_VALUE<=r&&r<=e.MAX_VALUE}e.is=t})(jx||(jx={}));var po;(function(e){function t(n,a){return n===Number.MAX_VALUE&&(n=jx.MAX_VALUE),a===Number.MAX_VALUE&&(a=jx.MAX_VALUE),{line:n,character:a}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Me.uinteger(a.line)&&Me.uinteger(a.character)}e.is=r})(po||(po={}));var Qn;(function(e){function t(n,a,i,s){if(Me.uinteger(n)&&Me.uinteger(a)&&Me.uinteger(i)&&Me.uinteger(s))return{start:po.create(n,a),end:po.create(i,s)};if(po.is(n)&&po.is(a))return{start:n,end:a};throw new Error(`Range#create called with invalid arguments[${n}, ${a}, ${i}, ${s}]`)}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&po.is(a.start)&&po.is(a.end)}e.is=r})(Qn||(Qn={}));var Ex;(function(e){function t(n,a){return{uri:n,range:a}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Qn.is(a.range)&&(Me.string(a.uri)||Me.undefined(a.uri))}e.is=r})(Ex||(Ex={}));var E5;(function(e){function t(n,a,i,s){return{targetUri:n,targetRange:a,targetSelectionRange:i,originSelectionRange:s}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Qn.is(a.targetRange)&&Me.string(a.targetUri)&&Qn.is(a.targetSelectionRange)&&(Qn.is(a.originSelectionRange)||Me.undefined(a.originSelectionRange))}e.is=r})(E5||(E5={}));var RC;(function(e){function t(n,a,i,s){return{red:n,green:a,blue:i,alpha:s}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.numberRange(a.red,0,1)&&Me.numberRange(a.green,0,1)&&Me.numberRange(a.blue,0,1)&&Me.numberRange(a.alpha,0,1)}e.is=r})(RC||(RC={}));var M5;(function(e){function t(n,a){return{range:n,color:a}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Qn.is(a.range)&&RC.is(a.color)}e.is=r})(M5||(M5={}));var T5;(function(e){function t(n,a,i){return{label:n,textEdit:a,additionalTextEdits:i}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.string(a.label)&&(Me.undefined(a.textEdit)||Ml.is(a))&&(Me.undefined(a.additionalTextEdits)||Me.typedArray(a.additionalTextEdits,Ml.is))}e.is=r})(T5||(T5={}));var A5;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})(A5||(A5={}));var D5;(function(e){function t(n,a,i,s,l,c){const u={startLine:n,endLine:a};return Me.defined(i)&&(u.startCharacter=i),Me.defined(s)&&(u.endCharacter=s),Me.defined(l)&&(u.kind=l),Me.defined(c)&&(u.collapsedText=c),u}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.uinteger(a.startLine)&&Me.uinteger(a.startLine)&&(Me.undefined(a.startCharacter)||Me.uinteger(a.startCharacter))&&(Me.undefined(a.endCharacter)||Me.uinteger(a.endCharacter))&&(Me.undefined(a.kind)||Me.string(a.kind))}e.is=r})(D5||(D5={}));var PC;(function(e){function t(n,a){return{location:n,message:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Ex.is(a.location)&&Me.string(a.message)}e.is=r})(PC||(PC={}));var L5;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})(L5||(L5={}));var O5;(function(e){e.Unnecessary=1,e.Deprecated=2})(O5||(O5={}));var I5;(function(e){function t(r){const n=r;return Me.objectLiteral(n)&&Me.string(n.href)}e.is=t})(I5||(I5={}));var Mx;(function(e){function t(n,a,i,s,l,c){let u={range:n,message:a};return Me.defined(i)&&(u.severity=i),Me.defined(s)&&(u.code=s),Me.defined(l)&&(u.source=l),Me.defined(c)&&(u.relatedInformation=c),u}e.create=t;function r(n){var a;let i=n;return Me.defined(i)&&Qn.is(i.range)&&Me.string(i.message)&&(Me.number(i.severity)||Me.undefined(i.severity))&&(Me.integer(i.code)||Me.string(i.code)||Me.undefined(i.code))&&(Me.undefined(i.codeDescription)||Me.string((a=i.codeDescription)===null||a===void 0?void 0:a.href))&&(Me.string(i.source)||Me.undefined(i.source))&&(Me.undefined(i.relatedInformation)||Me.typedArray(i.relatedInformation,PC.is))}e.is=r})(Mx||(Mx={}));var Fh;(function(e){function t(n,a,...i){let s={title:n,command:a};return Me.defined(i)&&i.length>0&&(s.arguments=i),s}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.title)&&Me.string(a.command)}e.is=r})(Fh||(Fh={}));var Ml;(function(e){function t(i,s){return{range:i,newText:s}}e.replace=t;function r(i,s){return{range:{start:i,end:i},newText:s}}e.insert=r;function n(i){return{range:i,newText:""}}e.del=n;function a(i){const s=i;return Me.objectLiteral(s)&&Me.string(s.newText)&&Qn.is(s.range)}e.is=a})(Ml||(Ml={}));var ph;(function(e){function t(n,a,i){const s={label:n};return a!==void 0&&(s.needsConfirmation=a),i!==void 0&&(s.description=i),s}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.string(a.label)&&(Me.boolean(a.needsConfirmation)||a.needsConfirmation===void 0)&&(Me.string(a.description)||a.description===void 0)}e.is=r})(ph||(ph={}));var ai;(function(e){function t(r){const n=r;return Me.string(n)}e.is=t})(ai||(ai={}));var zc;(function(e){function t(i,s,l){return{range:i,newText:s,annotationId:l}}e.replace=t;function r(i,s,l){return{range:{start:i,end:i},newText:s,annotationId:l}}e.insert=r;function n(i,s){return{range:i,newText:"",annotationId:s}}e.del=n;function a(i){const s=i;return Ml.is(s)&&(ph.is(s.annotationId)||ai.is(s.annotationId))}e.is=a})(zc||(zc={}));var Tx;(function(e){function t(n,a){return{textDocument:n,edits:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Ax.is(a.textDocument)&&Array.isArray(a.edits)}e.is=r})(Tx||(Tx={}));var Yg;(function(e){function t(n,a,i){let s={kind:"create",uri:n};return a!==void 0&&(a.overwrite!==void 0||a.ignoreIfExists!==void 0)&&(s.options=a),i!==void 0&&(s.annotationId=i),s}e.create=t;function r(n){let a=n;return a&&a.kind==="create"&&Me.string(a.uri)&&(a.options===void 0||(a.options.overwrite===void 0||Me.boolean(a.options.overwrite))&&(a.options.ignoreIfExists===void 0||Me.boolean(a.options.ignoreIfExists)))&&(a.annotationId===void 0||ai.is(a.annotationId))}e.is=r})(Yg||(Yg={}));var Qg;(function(e){function t(n,a,i,s){let l={kind:"rename",oldUri:n,newUri:a};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(l.options=i),s!==void 0&&(l.annotationId=s),l}e.create=t;function r(n){let a=n;return a&&a.kind==="rename"&&Me.string(a.oldUri)&&Me.string(a.newUri)&&(a.options===void 0||(a.options.overwrite===void 0||Me.boolean(a.options.overwrite))&&(a.options.ignoreIfExists===void 0||Me.boolean(a.options.ignoreIfExists)))&&(a.annotationId===void 0||ai.is(a.annotationId))}e.is=r})(Qg||(Qg={}));var Jg;(function(e){function t(n,a,i){let s={kind:"delete",uri:n};return a!==void 0&&(a.recursive!==void 0||a.ignoreIfNotExists!==void 0)&&(s.options=a),i!==void 0&&(s.annotationId=i),s}e.create=t;function r(n){let a=n;return a&&a.kind==="delete"&&Me.string(a.uri)&&(a.options===void 0||(a.options.recursive===void 0||Me.boolean(a.options.recursive))&&(a.options.ignoreIfNotExists===void 0||Me.boolean(a.options.ignoreIfNotExists)))&&(a.annotationId===void 0||ai.is(a.annotationId))}e.is=r})(Jg||(Jg={}));var zC;(function(e){function t(r){let n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(a=>Me.string(a.kind)?Yg.is(a)||Qg.is(a)||Jg.is(a):Tx.is(a)))}e.is=t})(zC||(zC={}));class uk{constructor(t,r){this.edits=t,this.changeAnnotations=r}insert(t,r,n){let a,i;if(n===void 0?a=Ml.insert(t,r):ai.is(n)?(i=n,a=zc.insert(t,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),a=zc.insert(t,r,i)),this.edits.push(a),i!==void 0)return i}replace(t,r,n){let a,i;if(n===void 0?a=Ml.replace(t,r):ai.is(n)?(i=n,a=zc.replace(t,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),a=zc.replace(t,r,i)),this.edits.push(a),i!==void 0)return i}delete(t,r){let n,a;if(r===void 0?n=Ml.del(t):ai.is(r)?(a=r,n=zc.del(t,r)):(this.assertChangeAnnotations(this.changeAnnotations),a=this.changeAnnotations.manage(r),n=zc.del(t,a)),this.edits.push(n),a!==void 0)return a}add(t){this.edits.push(t)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(t){if(t===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}}class Zne{constructor(t){this._annotations=t===void 0?Object.create(null):t,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(t,r){let n;if(ai.is(t)?n=t:(n=this.nextId(),r=t),this._annotations[n]!==void 0)throw new Error(`Id ${n} is already in use.`);if(r===void 0)throw new Error(`No annotation provided for id ${n}`);return this._annotations[n]=r,this._size++,n}nextId(){return this._counter++,this._counter.toString()}}class Swt{constructor(t){this._textEditChanges=Object.create(null),t!==void 0?(this._workspaceEdit=t,t.documentChanges?(this._changeAnnotations=new Zne(t.changeAnnotations),t.changeAnnotations=this._changeAnnotations.all(),t.documentChanges.forEach(r=>{if(Tx.is(r)){const n=new uk(r.edits,this._changeAnnotations);this._textEditChanges[r.textDocument.uri]=n}})):t.changes&&Object.keys(t.changes).forEach(r=>{const n=new uk(t.changes[r]);this._textEditChanges[r]=n})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(t){if(Ax.is(t)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");const r={uri:t.uri,version:t.version};let n=this._textEditChanges[r.uri];if(!n){const a=[],i={textDocument:r,edits:a};this._workspaceEdit.documentChanges.push(i),n=new uk(a,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let r=this._textEditChanges[t];if(!r){let n=[];this._workspaceEdit.changes[t]=n,r=new uk(n),this._textEditChanges[t]=r}return r}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Zne,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(t,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let a;ph.is(r)||ai.is(r)?a=r:n=r;let i,s;if(a===void 0?i=Yg.create(t,n):(s=ai.is(a)?a:this._changeAnnotations.manage(a),i=Yg.create(t,n,s)),this._workspaceEdit.documentChanges.push(i),s!==void 0)return s}renameFile(t,r,n,a){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;ph.is(n)||ai.is(n)?i=n:a=n;let s,l;if(i===void 0?s=Qg.create(t,r,a):(l=ai.is(i)?i:this._changeAnnotations.manage(i),s=Qg.create(t,r,a,l)),this._workspaceEdit.documentChanges.push(s),l!==void 0)return l}deleteFile(t,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let a;ph.is(r)||ai.is(r)?a=r:n=r;let i,s;if(a===void 0?i=Jg.create(t,n):(s=ai.is(a)?a:this._changeAnnotations.manage(a),i=Jg.create(t,n,s)),this._workspaceEdit.documentChanges.push(i),s!==void 0)return s}}var R5;(function(e){function t(n){return{uri:n}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)}e.is=r})(R5||(R5={}));var P5;(function(e){function t(n,a){return{uri:n,version:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)&&Me.integer(a.version)}e.is=r})(P5||(P5={}));var Ax;(function(e){function t(n,a){return{uri:n,version:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)&&(a.version===null||Me.integer(a.version))}e.is=r})(Ax||(Ax={}));var z5;(function(e){function t(n,a,i,s){return{uri:n,languageId:a,version:i,text:s}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)&&Me.string(a.languageId)&&Me.integer(a.version)&&Me.string(a.text)}e.is=r})(z5||(z5={}));var BC;(function(e){e.PlainText="plaintext",e.Markdown="markdown";function t(r){const n=r;return n===e.PlainText||n===e.Markdown}e.is=t})(BC||(BC={}));var Zg;(function(e){function t(r){const n=r;return Me.objectLiteral(r)&&BC.is(n.kind)&&Me.string(n.value)}e.is=t})(Zg||(Zg={}));var B5;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(B5||(B5={}));var $5;(function(e){e.PlainText=1,e.Snippet=2})($5||($5={}));var F5;(function(e){e.Deprecated=1})(F5||(F5={}));var U5;(function(e){function t(n,a,i){return{newText:n,insert:a,replace:i}}e.create=t;function r(n){const a=n;return a&&Me.string(a.newText)&&Qn.is(a.insert)&&Qn.is(a.replace)}e.is=r})(U5||(U5={}));var H5;(function(e){e.asIs=1,e.adjustIndentation=2})(H5||(H5={}));var q5;(function(e){function t(r){const n=r;return n&&(Me.string(n.detail)||n.detail===void 0)&&(Me.string(n.description)||n.description===void 0)}e.is=t})(q5||(q5={}));var W5;(function(e){function t(r){return{label:r}}e.create=t})(W5||(W5={}));var K5;(function(e){function t(r,n){return{items:r||[],isIncomplete:!!n}}e.create=t})(K5||(K5={}));var Dx;(function(e){function t(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=t;function r(n){const a=n;return Me.string(a)||Me.objectLiteral(a)&&Me.string(a.language)&&Me.string(a.value)}e.is=r})(Dx||(Dx={}));var G5;(function(e){function t(r){let n=r;return!!n&&Me.objectLiteral(n)&&(Zg.is(n.contents)||Dx.is(n.contents)||Me.typedArray(n.contents,Dx.is))&&(r.range===void 0||Qn.is(r.range))}e.is=t})(G5||(G5={}));var V5;(function(e){function t(r,n){return n?{label:r,documentation:n}:{label:r}}e.create=t})(V5||(V5={}));var Y5;(function(e){function t(r,n,...a){let i={label:r};return Me.defined(n)&&(i.documentation=n),Me.defined(a)?i.parameters=a:i.parameters=[],i}e.create=t})(Y5||(Y5={}));var Q5;(function(e){e.Text=1,e.Read=2,e.Write=3})(Q5||(Q5={}));var J5;(function(e){function t(r,n){let a={range:r};return Me.number(n)&&(a.kind=n),a}e.create=t})(J5||(J5={}));var Z5;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(Z5||(Z5={}));var X5;(function(e){e.Deprecated=1})(X5||(X5={}));var e6;(function(e){function t(r,n,a,i,s){let l={name:r,kind:n,location:{uri:i,range:a}};return s&&(l.containerName=s),l}e.create=t})(e6||(e6={}));var t6;(function(e){function t(r,n,a,i){return i!==void 0?{name:r,kind:n,location:{uri:a,range:i}}:{name:r,kind:n,location:{uri:a}}}e.create=t})(t6||(t6={}));var r6;(function(e){function t(n,a,i,s,l,c){let u={name:n,detail:a,kind:i,range:s,selectionRange:l};return c!==void 0&&(u.children=c),u}e.create=t;function r(n){let a=n;return a&&Me.string(a.name)&&Me.number(a.kind)&&Qn.is(a.range)&&Qn.is(a.selectionRange)&&(a.detail===void 0||Me.string(a.detail))&&(a.deprecated===void 0||Me.boolean(a.deprecated))&&(a.children===void 0||Array.isArray(a.children))&&(a.tags===void 0||Array.isArray(a.tags))}e.is=r})(r6||(r6={}));var n6;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(n6||(n6={}));var Lx;(function(e){e.Invoked=1,e.Automatic=2})(Lx||(Lx={}));var a6;(function(e){function t(n,a,i){let s={diagnostics:n};return a!=null&&(s.only=a),i!=null&&(s.triggerKind=i),s}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.typedArray(a.diagnostics,Mx.is)&&(a.only===void 0||Me.typedArray(a.only,Me.string))&&(a.triggerKind===void 0||a.triggerKind===Lx.Invoked||a.triggerKind===Lx.Automatic)}e.is=r})(a6||(a6={}));var i6;(function(e){function t(n,a,i){let s={title:n},l=!0;return typeof a=="string"?(l=!1,s.kind=a):Fh.is(a)?s.command=a:s.edit=a,l&&i!==void 0&&(s.kind=i),s}e.create=t;function r(n){let a=n;return a&&Me.string(a.title)&&(a.diagnostics===void 0||Me.typedArray(a.diagnostics,Mx.is))&&(a.kind===void 0||Me.string(a.kind))&&(a.edit!==void 0||a.command!==void 0)&&(a.command===void 0||Fh.is(a.command))&&(a.isPreferred===void 0||Me.boolean(a.isPreferred))&&(a.edit===void 0||zC.is(a.edit))}e.is=r})(i6||(i6={}));var s6;(function(e){function t(n,a){let i={range:n};return Me.defined(a)&&(i.data=a),i}e.create=t;function r(n){let a=n;return Me.defined(a)&&Qn.is(a.range)&&(Me.undefined(a.command)||Fh.is(a.command))}e.is=r})(s6||(s6={}));var o6;(function(e){function t(n,a){return{tabSize:n,insertSpaces:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.uinteger(a.tabSize)&&Me.boolean(a.insertSpaces)}e.is=r})(o6||(o6={}));var l6;(function(e){function t(n,a,i){return{range:n,target:a,data:i}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Qn.is(a.range)&&(Me.undefined(a.target)||Me.string(a.target))}e.is=r})(l6||(l6={}));var c6;(function(e){function t(n,a){return{range:n,parent:a}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Qn.is(a.range)&&(a.parent===void 0||e.is(a.parent))}e.is=r})(c6||(c6={}));var u6;(function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"})(u6||(u6={}));var d6;(function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"})(d6||(d6={}));var f6;(function(e){function t(r){const n=r;return Me.objectLiteral(n)&&(n.resultId===void 0||typeof n.resultId=="string")&&Array.isArray(n.data)&&(n.data.length===0||typeof n.data[0]=="number")}e.is=t})(f6||(f6={}));var h6;(function(e){function t(n,a){return{range:n,text:a}}e.create=t;function r(n){const a=n;return a!=null&&Qn.is(a.range)&&Me.string(a.text)}e.is=r})(h6||(h6={}));var m6;(function(e){function t(n,a,i){return{range:n,variableName:a,caseSensitiveLookup:i}}e.create=t;function r(n){const a=n;return a!=null&&Qn.is(a.range)&&Me.boolean(a.caseSensitiveLookup)&&(Me.string(a.variableName)||a.variableName===void 0)}e.is=r})(m6||(m6={}));var p6;(function(e){function t(n,a){return{range:n,expression:a}}e.create=t;function r(n){const a=n;return a!=null&&Qn.is(a.range)&&(Me.string(a.expression)||a.expression===void 0)}e.is=r})(p6||(p6={}));var g6;(function(e){function t(n,a){return{frameId:n,stoppedLocation:a}}e.create=t;function r(n){const a=n;return Me.defined(a)&&Qn.is(n.stoppedLocation)}e.is=r})(g6||(g6={}));var $C;(function(e){e.Type=1,e.Parameter=2;function t(r){return r===1||r===2}e.is=t})($C||($C={}));var FC;(function(e){function t(n){return{value:n}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&(a.tooltip===void 0||Me.string(a.tooltip)||Zg.is(a.tooltip))&&(a.location===void 0||Ex.is(a.location))&&(a.command===void 0||Fh.is(a.command))}e.is=r})(FC||(FC={}));var v6;(function(e){function t(n,a,i){const s={position:n,label:a};return i!==void 0&&(s.kind=i),s}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&po.is(a.position)&&(Me.string(a.label)||Me.typedArray(a.label,FC.is))&&(a.kind===void 0||$C.is(a.kind))&&a.textEdits===void 0||Me.typedArray(a.textEdits,Ml.is)&&(a.tooltip===void 0||Me.string(a.tooltip)||Zg.is(a.tooltip))&&(a.paddingLeft===void 0||Me.boolean(a.paddingLeft))&&(a.paddingRight===void 0||Me.boolean(a.paddingRight))}e.is=r})(v6||(v6={}));var b6;(function(e){function t(r){return{kind:"snippet",value:r}}e.createSnippet=t})(b6||(b6={}));var y6;(function(e){function t(r,n,a,i){return{insertText:r,filterText:n,range:a,command:i}}e.create=t})(y6||(y6={}));var x6;(function(e){function t(r){return{items:r}}e.create=t})(x6||(x6={}));var w6;(function(e){e.Invoked=0,e.Automatic=1})(w6||(w6={}));var S6;(function(e){function t(r,n){return{range:r,text:n}}e.create=t})(S6||(S6={}));var k6;(function(e){function t(r,n){return{triggerKind:r,selectedCompletionInfo:n}}e.create=t})(k6||(k6={}));var _6;(function(e){function t(r){const n=r;return Me.objectLiteral(n)&&IC.is(n.uri)&&Me.string(n.name)}e.is=t})(_6||(_6={}));const kwt=[`
`,`\r
`,"\r"];var N6;(function(e){function t(i,s,l,c){return new _wt(i,s,l,c)}e.create=t;function r(i){let s=i;return!!(Me.defined(s)&&Me.string(s.uri)&&(Me.undefined(s.languageId)||Me.string(s.languageId))&&Me.uinteger(s.lineCount)&&Me.func(s.getText)&&Me.func(s.positionAt)&&Me.func(s.offsetAt))}e.is=r;function n(i,s){let l=i.getText(),c=a(s,(d,f)=>{let m=d.range.start.line-f.range.start.line;return m===0?d.range.start.character-f.range.start.character:m}),u=l.length;for(let d=c.length-1;d>=0;d--){let f=c[d],m=i.offsetAt(f.range.start),p=i.offsetAt(f.range.end);if(p<=u)l=l.substring(0,m)+f.newText+l.substring(p,l.length);else throw new Error("Overlapping edit");u=m}return l}e.applyEdits=n;function a(i,s){if(i.length<=1)return i;const l=i.length/2|0,c=i.slice(0,l),u=i.slice(l);a(c,s),a(u,s);let d=0,f=0,m=0;for(;d<c.length&&f<u.length;)s(c[d],u[f])<=0?i[m++]=c[d++]:i[m++]=u[f++];for(;d<c.length;)i[m++]=c[d++];for(;f<u.length;)i[m++]=u[f++];return i}})(N6||(N6={}));class _wt{constructor(t,r,n,a){this._uri=t,this._languageId=r,this._version=n,this._content=a,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let r=this.offsetAt(t.start),n=this.offsetAt(t.end);return this._content.substring(r,n)}return this._content}update(t,r){this._content=t.text,this._version=r,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let t=[],r=this._content,n=!0;for(let a=0;a<r.length;a++){n&&(t.push(a),n=!1);let i=r.charAt(a);n=i==="\r"||i===`
`,i==="\r"&&a+1<r.length&&r.charAt(a+1)===`
`&&a++}n&&r.length>0&&t.push(r.length),this._lineOffsets=t}return this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let r=this.getLineOffsets(),n=0,a=r.length;if(a===0)return po.create(0,t);for(;n<a;){let s=Math.floor((n+a)/2);r[s]>t?a=s:n=s+1}let i=n-1;return po.create(i,t-r[i])}offsetAt(t){let r=this.getLineOffsets();if(t.line>=r.length)return this._content.length;if(t.line<0)return 0;let n=r[t.line],a=t.line+1<r.length?r[t.line+1]:this._content.length;return Math.max(Math.min(n+t.character,a),n)}get lineCount(){return this.getLineOffsets().length}}var Me;(function(e){const t=Object.prototype.toString;function r(p){return typeof p<"u"}e.defined=r;function n(p){return typeof p>"u"}e.undefined=n;function a(p){return p===!0||p===!1}e.boolean=a;function i(p){return t.call(p)==="[object String]"}e.string=i;function s(p){return t.call(p)==="[object Number]"}e.number=s;function l(p,v,b){return t.call(p)==="[object Number]"&&v<=p&&p<=b}e.numberRange=l;function c(p){return t.call(p)==="[object Number]"&&-2147483648<=p&&p<=2147483647}e.integer=c;function u(p){return t.call(p)==="[object Number]"&&0<=p&&p<=2147483647}e.uinteger=u;function d(p){return t.call(p)==="[object Function]"}e.func=d;function f(p){return p!==null&&typeof p=="object"}e.objectLiteral=f;function m(p,v){return Array.isArray(p)&&p.every(v)}e.typedArray=m})(Me||(Me={}));const Nwt=Object.freeze(Object.defineProperty({__proto__:null,get AnnotatedTextEdit(){return zc},get ChangeAnnotation(){return ph},get ChangeAnnotationIdentifier(){return ai},get CodeAction(){return i6},get CodeActionContext(){return a6},get CodeActionKind(){return n6},get CodeActionTriggerKind(){return Lx},get CodeDescription(){return I5},get CodeLens(){return s6},get Color(){return RC},get ColorInformation(){return M5},get ColorPresentation(){return T5},get Command(){return Fh},get CompletionItem(){return W5},get CompletionItemKind(){return B5},get CompletionItemLabelDetails(){return q5},get CompletionItemTag(){return F5},get CompletionList(){return K5},get CreateFile(){return Yg},get DeleteFile(){return Jg},get Diagnostic(){return Mx},get DiagnosticRelatedInformation(){return PC},get DiagnosticSeverity(){return L5},get DiagnosticTag(){return O5},get DocumentHighlight(){return J5},get DocumentHighlightKind(){return Q5},get DocumentLink(){return l6},get DocumentSymbol(){return r6},get DocumentUri(){return C5},EOL:kwt,get FoldingRange(){return D5},get FoldingRangeKind(){return A5},get FormattingOptions(){return o6},get Hover(){return G5},get InlayHint(){return v6},get InlayHintKind(){return $C},get InlayHintLabelPart(){return FC},get InlineCompletionContext(){return k6},get InlineCompletionItem(){return y6},get InlineCompletionList(){return x6},get InlineCompletionTriggerKind(){return w6},get InlineValueContext(){return g6},get InlineValueEvaluatableExpression(){return p6},get InlineValueText(){return h6},get InlineValueVariableLookup(){return m6},get InsertReplaceEdit(){return U5},get InsertTextFormat(){return $5},get InsertTextMode(){return H5},get Location(){return Ex},get LocationLink(){return E5},get MarkedString(){return Dx},get MarkupContent(){return Zg},get MarkupKind(){return BC},get OptionalVersionedTextDocumentIdentifier(){return Ax},get ParameterInformation(){return V5},get Position(){return po},get Range(){return Qn},get RenameFile(){return Qg},get SelectedCompletionInfo(){return S6},get SelectionRange(){return c6},get SemanticTokenModifiers(){return d6},get SemanticTokenTypes(){return u6},get SemanticTokens(){return f6},get SignatureInformation(){return Y5},get StringValue(){return b6},get SymbolInformation(){return e6},get SymbolKind(){return Z5},get SymbolTag(){return X5},get TextDocument(){return N6},get TextDocumentEdit(){return Tx},get TextDocumentIdentifier(){return R5},get TextDocumentItem(){return z5},get TextEdit(){return Ml},get URI(){return IC},get VersionedTextDocumentIdentifier(){return P5},WorkspaceChange:Swt,get WorkspaceEdit(){return zC},get WorkspaceFolder(){return _6},get WorkspaceSymbol(){return t6},get integer(){return j5},get uinteger(){return jx}},Symbol.toStringTag,{value:"Module"})),W$=q1e(Nwt);var Ci={},Xne;function $n(){if(Xne)return Ci;Xne=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.ProtocolNotificationType=Ci.ProtocolNotificationType0=Ci.ProtocolRequestType=Ci.ProtocolRequestType0=Ci.RegistrationType=Ci.MessageDirection=void 0;const e=N0();var t;(function(l){l.clientToServer="clientToServer",l.serverToClient="serverToClient",l.both="both"})(t||(Ci.MessageDirection=t={}));class r{constructor(c){this.method=c}}Ci.RegistrationType=r;class n extends e.RequestType0{constructor(c){super(c)}}Ci.ProtocolRequestType0=n;class a extends e.RequestType{constructor(c){super(c,e.ParameterStructures.byName)}}Ci.ProtocolRequestType=a;class i extends e.NotificationType0{constructor(c){super(c)}}Ci.ProtocolNotificationType0=i;class s extends e.NotificationType{constructor(c){super(c,e.ParameterStructures.byName)}}return Ci.ProtocolNotificationType=s,Ci}var wO={},ra={},eae;function K$(){if(eae)return ra;eae=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.objectLiteral=ra.typedArray=ra.stringArray=ra.array=ra.func=ra.error=ra.number=ra.string=ra.boolean=void 0;function e(u){return u===!0||u===!1}ra.boolean=e;function t(u){return typeof u=="string"||u instanceof String}ra.string=t;function r(u){return typeof u=="number"||u instanceof Number}ra.number=r;function n(u){return u instanceof Error}ra.error=n;function a(u){return typeof u=="function"}ra.func=a;function i(u){return Array.isArray(u)}ra.array=i;function s(u){return i(u)&&u.every(d=>t(d))}ra.stringArray=s;function l(u,d){return Array.isArray(u)&&u.every(d)}ra.typedArray=l;function c(u){return u!==null&&typeof u=="object"}return ra.objectLiteral=c,ra}var eb={},tae;function Cwt(){if(tae)return eb;tae=1,Object.defineProperty(eb,"__esModule",{value:!0}),eb.ImplementationRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/implementation",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(eb.ImplementationRequest=t={})),eb}var tb={},rae;function jwt(){if(rae)return tb;rae=1,Object.defineProperty(tb,"__esModule",{value:!0}),tb.TypeDefinitionRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/typeDefinition",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(tb.TypeDefinitionRequest=t={})),tb}var Af={},nae;function Ewt(){if(nae)return Af;nae=1,Object.defineProperty(Af,"__esModule",{value:!0}),Af.DidChangeWorkspaceFoldersNotification=Af.WorkspaceFoldersRequest=void 0;const e=$n();var t;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=e.MessageDirection.serverToClient,n.type=new e.ProtocolRequestType0(n.method)})(t||(Af.WorkspaceFoldersRequest=t={}));var r;return(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolNotificationType(n.method)})(r||(Af.DidChangeWorkspaceFoldersNotification=r={})),Af}var rb={},aae;function Mwt(){if(aae)return rb;aae=1,Object.defineProperty(rb,"__esModule",{value:!0}),rb.ConfigurationRequest=void 0;const e=$n();var t;return(function(r){r.method="workspace/configuration",r.messageDirection=e.MessageDirection.serverToClient,r.type=new e.ProtocolRequestType(r.method)})(t||(rb.ConfigurationRequest=t={})),rb}var Df={},iae;function Twt(){if(iae)return Df;iae=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.ColorPresentationRequest=Df.DocumentColorRequest=void 0;const e=$n();var t;(function(n){n.method="textDocument/documentColor",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(t||(Df.DocumentColorRequest=t={}));var r;return(function(n){n.method="textDocument/colorPresentation",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(r||(Df.ColorPresentationRequest=r={})),Df}var Lf={},sae;function Awt(){if(sae)return Lf;sae=1,Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.FoldingRangeRefreshRequest=Lf.FoldingRangeRequest=void 0;const e=$n();var t;(function(n){n.method="textDocument/foldingRange",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(t||(Lf.FoldingRangeRequest=t={}));var r;return(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=e.MessageDirection.serverToClient,n.type=new e.ProtocolRequestType0(n.method)})(r||(Lf.FoldingRangeRefreshRequest=r={})),Lf}var nb={},oae;function Dwt(){if(oae)return nb;oae=1,Object.defineProperty(nb,"__esModule",{value:!0}),nb.DeclarationRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/declaration",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(nb.DeclarationRequest=t={})),nb}var ab={},lae;function Lwt(){if(lae)return ab;lae=1,Object.defineProperty(ab,"__esModule",{value:!0}),ab.SelectionRangeRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/selectionRange",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(ab.SelectionRangeRequest=t={})),ab}var jc={},cae;function Owt(){if(cae)return jc;cae=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.WorkDoneProgressCancelNotification=jc.WorkDoneProgressCreateRequest=jc.WorkDoneProgress=void 0;const e=N0(),t=$n();var r;(function(i){i.type=new e.ProgressType;function s(l){return l===i.type}i.is=s})(r||(jc.WorkDoneProgress=r={}));var n;(function(i){i.method="window/workDoneProgress/create",i.messageDirection=t.MessageDirection.serverToClient,i.type=new t.ProtocolRequestType(i.method)})(n||(jc.WorkDoneProgressCreateRequest=n={}));var a;return(function(i){i.method="window/workDoneProgress/cancel",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolNotificationType(i.method)})(a||(jc.WorkDoneProgressCancelNotification=a={})),jc}var Ec={},uae;function Iwt(){if(uae)return Ec;uae=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.CallHierarchyOutgoingCallsRequest=Ec.CallHierarchyIncomingCallsRequest=Ec.CallHierarchyPrepareRequest=void 0;const e=$n();var t;(function(a){a.method="textDocument/prepareCallHierarchy",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(t||(Ec.CallHierarchyPrepareRequest=t={}));var r;(function(a){a.method="callHierarchy/incomingCalls",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(r||(Ec.CallHierarchyIncomingCallsRequest=r={}));var n;return(function(a){a.method="callHierarchy/outgoingCalls",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(n||(Ec.CallHierarchyOutgoingCallsRequest=n={})),Ec}var ji={},dae;function Rwt(){if(dae)return ji;dae=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.SemanticTokensRefreshRequest=ji.SemanticTokensRangeRequest=ji.SemanticTokensDeltaRequest=ji.SemanticTokensRequest=ji.SemanticTokensRegistrationType=ji.TokenFormat=void 0;const e=$n();var t;(function(l){l.Relative="relative"})(t||(ji.TokenFormat=t={}));var r;(function(l){l.method="textDocument/semanticTokens",l.type=new e.RegistrationType(l.method)})(r||(ji.SemanticTokensRegistrationType=r={}));var n;(function(l){l.method="textDocument/semanticTokens/full",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method),l.registrationMethod=r.method})(n||(ji.SemanticTokensRequest=n={}));var a;(function(l){l.method="textDocument/semanticTokens/full/delta",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method),l.registrationMethod=r.method})(a||(ji.SemanticTokensDeltaRequest=a={}));var i;(function(l){l.method="textDocument/semanticTokens/range",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method),l.registrationMethod=r.method})(i||(ji.SemanticTokensRangeRequest=i={}));var s;return(function(l){l.method="workspace/semanticTokens/refresh",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType0(l.method)})(s||(ji.SemanticTokensRefreshRequest=s={})),ji}var ib={},fae;function Pwt(){if(fae)return ib;fae=1,Object.defineProperty(ib,"__esModule",{value:!0}),ib.ShowDocumentRequest=void 0;const e=$n();var t;return(function(r){r.method="window/showDocument",r.messageDirection=e.MessageDirection.serverToClient,r.type=new e.ProtocolRequestType(r.method)})(t||(ib.ShowDocumentRequest=t={})),ib}var sb={},hae;function zwt(){if(hae)return sb;hae=1,Object.defineProperty(sb,"__esModule",{value:!0}),sb.LinkedEditingRangeRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/linkedEditingRange",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(sb.LinkedEditingRangeRequest=t={})),sb}var Xa={},mae;function Bwt(){if(mae)return Xa;mae=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.WillDeleteFilesRequest=Xa.DidDeleteFilesNotification=Xa.DidRenameFilesNotification=Xa.WillRenameFilesRequest=Xa.DidCreateFilesNotification=Xa.WillCreateFilesRequest=Xa.FileOperationPatternKind=void 0;const e=$n();var t;(function(c){c.file="file",c.folder="folder"})(t||(Xa.FileOperationPatternKind=t={}));var r;(function(c){c.method="workspace/willCreateFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolRequestType(c.method)})(r||(Xa.WillCreateFilesRequest=r={}));var n;(function(c){c.method="workspace/didCreateFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolNotificationType(c.method)})(n||(Xa.DidCreateFilesNotification=n={}));var a;(function(c){c.method="workspace/willRenameFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolRequestType(c.method)})(a||(Xa.WillRenameFilesRequest=a={}));var i;(function(c){c.method="workspace/didRenameFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolNotificationType(c.method)})(i||(Xa.DidRenameFilesNotification=i={}));var s;(function(c){c.method="workspace/didDeleteFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolNotificationType(c.method)})(s||(Xa.DidDeleteFilesNotification=s={}));var l;return(function(c){c.method="workspace/willDeleteFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolRequestType(c.method)})(l||(Xa.WillDeleteFilesRequest=l={})),Xa}var Mc={},pae;function $wt(){if(pae)return Mc;pae=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.MonikerRequest=Mc.MonikerKind=Mc.UniquenessLevel=void 0;const e=$n();var t;(function(a){a.document="document",a.project="project",a.group="group",a.scheme="scheme",a.global="global"})(t||(Mc.UniquenessLevel=t={}));var r;(function(a){a.$import="import",a.$export="export",a.local="local"})(r||(Mc.MonikerKind=r={}));var n;return(function(a){a.method="textDocument/moniker",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(n||(Mc.MonikerRequest=n={})),Mc}var Tc={},gae;function Fwt(){if(gae)return Tc;gae=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.TypeHierarchySubtypesRequest=Tc.TypeHierarchySupertypesRequest=Tc.TypeHierarchyPrepareRequest=void 0;const e=$n();var t;(function(a){a.method="textDocument/prepareTypeHierarchy",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(t||(Tc.TypeHierarchyPrepareRequest=t={}));var r;(function(a){a.method="typeHierarchy/supertypes",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(r||(Tc.TypeHierarchySupertypesRequest=r={}));var n;return(function(a){a.method="typeHierarchy/subtypes",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(n||(Tc.TypeHierarchySubtypesRequest=n={})),Tc}var Of={},vae;function Uwt(){if(vae)return Of;vae=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.InlineValueRefreshRequest=Of.InlineValueRequest=void 0;const e=$n();var t;(function(n){n.method="textDocument/inlineValue",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(t||(Of.InlineValueRequest=t={}));var r;return(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=e.MessageDirection.serverToClient,n.type=new e.ProtocolRequestType0(n.method)})(r||(Of.InlineValueRefreshRequest=r={})),Of}var Ac={},bae;function Hwt(){if(bae)return Ac;bae=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.InlayHintRefreshRequest=Ac.InlayHintResolveRequest=Ac.InlayHintRequest=void 0;const e=$n();var t;(function(a){a.method="textDocument/inlayHint",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(t||(Ac.InlayHintRequest=t={}));var r;(function(a){a.method="inlayHint/resolve",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(r||(Ac.InlayHintResolveRequest=r={}));var n;return(function(a){a.method="workspace/inlayHint/refresh",a.messageDirection=e.MessageDirection.serverToClient,a.type=new e.ProtocolRequestType0(a.method)})(n||(Ac.InlayHintRefreshRequest=n={})),Ac}var bs={},yae;function qwt(){if(yae)return bs;yae=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.DiagnosticRefreshRequest=bs.WorkspaceDiagnosticRequest=bs.DocumentDiagnosticRequest=bs.DocumentDiagnosticReportKind=bs.DiagnosticServerCancellationData=void 0;const e=N0(),t=K$(),r=$n();var n;(function(c){function u(d){const f=d;return f&&t.boolean(f.retriggerRequest)}c.is=u})(n||(bs.DiagnosticServerCancellationData=n={}));var a;(function(c){c.Full="full",c.Unchanged="unchanged"})(a||(bs.DocumentDiagnosticReportKind=a={}));var i;(function(c){c.method="textDocument/diagnostic",c.messageDirection=r.MessageDirection.clientToServer,c.type=new r.ProtocolRequestType(c.method),c.partialResult=new e.ProgressType})(i||(bs.DocumentDiagnosticRequest=i={}));var s;(function(c){c.method="workspace/diagnostic",c.messageDirection=r.MessageDirection.clientToServer,c.type=new r.ProtocolRequestType(c.method),c.partialResult=new e.ProgressType})(s||(bs.WorkspaceDiagnosticRequest=s={}));var l;return(function(c){c.method="workspace/diagnostic/refresh",c.messageDirection=r.MessageDirection.serverToClient,c.type=new r.ProtocolRequestType0(c.method)})(l||(bs.DiagnosticRefreshRequest=l={})),bs}var Pn={},xae;function Wwt(){if(xae)return Pn;xae=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.DidCloseNotebookDocumentNotification=Pn.DidSaveNotebookDocumentNotification=Pn.DidChangeNotebookDocumentNotification=Pn.NotebookCellArrayChange=Pn.DidOpenNotebookDocumentNotification=Pn.NotebookDocumentSyncRegistrationType=Pn.NotebookDocument=Pn.NotebookCell=Pn.ExecutionSummary=Pn.NotebookCellKind=void 0;const e=W$,t=K$(),r=$n();var n;(function(p){p.Markup=1,p.Code=2;function v(b){return b===1||b===2}p.is=v})(n||(Pn.NotebookCellKind=n={}));var a;(function(p){function v(S,_){const N={executionOrder:S};return(_===!0||_===!1)&&(N.success=_),N}p.create=v;function b(S){const _=S;return t.objectLiteral(_)&&e.uinteger.is(_.executionOrder)&&(_.success===void 0||t.boolean(_.success))}p.is=b;function y(S,_){return S===_?!0:S==null||_===null||_===void 0?!1:S.executionOrder===_.executionOrder&&S.success===_.success}p.equals=y})(a||(Pn.ExecutionSummary=a={}));var i;(function(p){function v(_,N){return{kind:_,document:N}}p.create=v;function b(_){const N=_;return t.objectLiteral(N)&&n.is(N.kind)&&e.DocumentUri.is(N.document)&&(N.metadata===void 0||t.objectLiteral(N.metadata))}p.is=b;function y(_,N){const k=new Set;return _.document!==N.document&&k.add("document"),_.kind!==N.kind&&k.add("kind"),_.executionSummary!==N.executionSummary&&k.add("executionSummary"),(_.metadata!==void 0||N.metadata!==void 0)&&!S(_.metadata,N.metadata)&&k.add("metadata"),(_.executionSummary!==void 0||N.executionSummary!==void 0)&&!a.equals(_.executionSummary,N.executionSummary)&&k.add("executionSummary"),k}p.diff=y;function S(_,N){if(_===N)return!0;if(_==null||N===null||N===void 0||typeof _!=typeof N||typeof _!="object")return!1;const k=Array.isArray(_),j=Array.isArray(N);if(k!==j)return!1;if(k&&j){if(_.length!==N.length)return!1;for(let E=0;E<_.length;E++)if(!S(_[E],N[E]))return!1}if(t.objectLiteral(_)&&t.objectLiteral(N)){const E=Object.keys(_),T=Object.keys(N);if(E.length!==T.length||(E.sort(),T.sort(),!S(E,T)))return!1;for(let O=0;O<E.length;O++){const R=E[O];if(!S(_[R],N[R]))return!1}}return!0}})(i||(Pn.NotebookCell=i={}));var s;(function(p){function v(y,S,_,N){return{uri:y,notebookType:S,version:_,cells:N}}p.create=v;function b(y){const S=y;return t.objectLiteral(S)&&t.string(S.uri)&&e.integer.is(S.version)&&t.typedArray(S.cells,i.is)}p.is=b})(s||(Pn.NotebookDocument=s={}));var l;(function(p){p.method="notebookDocument/sync",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.RegistrationType(p.method)})(l||(Pn.NotebookDocumentSyncRegistrationType=l={}));var c;(function(p){p.method="notebookDocument/didOpen",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(c||(Pn.DidOpenNotebookDocumentNotification=c={}));var u;(function(p){function v(y){const S=y;return t.objectLiteral(S)&&e.uinteger.is(S.start)&&e.uinteger.is(S.deleteCount)&&(S.cells===void 0||t.typedArray(S.cells,i.is))}p.is=v;function b(y,S,_){const N={start:y,deleteCount:S};return _!==void 0&&(N.cells=_),N}p.create=b})(u||(Pn.NotebookCellArrayChange=u={}));var d;(function(p){p.method="notebookDocument/didChange",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(d||(Pn.DidChangeNotebookDocumentNotification=d={}));var f;(function(p){p.method="notebookDocument/didSave",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(f||(Pn.DidSaveNotebookDocumentNotification=f={}));var m;return(function(p){p.method="notebookDocument/didClose",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(m||(Pn.DidCloseNotebookDocumentNotification=m={})),Pn}var ob={},wae;function Kwt(){if(wae)return ob;wae=1,Object.defineProperty(ob,"__esModule",{value:!0}),ob.InlineCompletionRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/inlineCompletion",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(ob.InlineCompletionRequest=t={})),ob}var Sae;function Gwt(){return Sae||(Sae=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbolRequest=e.CodeActionResolveRequest=e.CodeActionRequest=e.DocumentSymbolRequest=e.DocumentHighlightRequest=e.ReferencesRequest=e.DefinitionRequest=e.SignatureHelpRequest=e.SignatureHelpTriggerKind=e.HoverRequest=e.CompletionResolveRequest=e.CompletionRequest=e.CompletionTriggerKind=e.PublishDiagnosticsNotification=e.WatchKind=e.RelativePattern=e.FileChangeType=e.DidChangeWatchedFilesNotification=e.WillSaveTextDocumentWaitUntilRequest=e.WillSaveTextDocumentNotification=e.TextDocumentSaveReason=e.DidSaveTextDocumentNotification=e.DidCloseTextDocumentNotification=e.DidChangeTextDocumentNotification=e.TextDocumentContentChangeEvent=e.DidOpenTextDocumentNotification=e.TextDocumentSyncKind=e.TelemetryEventNotification=e.LogMessageNotification=e.ShowMessageRequest=e.ShowMessageNotification=e.MessageType=e.DidChangeConfigurationNotification=e.ExitNotification=e.ShutdownRequest=e.InitializedNotification=e.InitializeErrorCodes=e.InitializeRequest=e.WorkDoneProgressOptions=e.TextDocumentRegistrationOptions=e.StaticRegistrationOptions=e.PositionEncodingKind=e.FailureHandlingKind=e.ResourceOperationKind=e.UnregistrationRequest=e.RegistrationRequest=e.DocumentSelector=e.NotebookCellTextDocumentFilter=e.NotebookDocumentFilter=e.TextDocumentFilter=void 0,e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.WillRenameFilesRequest=e.DidRenameFilesNotification=e.WillCreateFilesRequest=e.DidCreateFilesNotification=e.FileOperationPatternKind=e.LinkedEditingRangeRequest=e.ShowDocumentRequest=e.SemanticTokensRegistrationType=e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.TokenFormat=e.CallHierarchyPrepareRequest=e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=e.SelectionRangeRequest=e.DeclarationRequest=e.FoldingRangeRefreshRequest=e.FoldingRangeRequest=e.ColorPresentationRequest=e.DocumentColorRequest=e.ConfigurationRequest=e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=e.TypeDefinitionRequest=e.ImplementationRequest=e.ApplyWorkspaceEditRequest=e.ExecuteCommandRequest=e.PrepareRenameRequest=e.RenameRequest=e.PrepareSupportDefaultBehavior=e.DocumentOnTypeFormattingRequest=e.DocumentRangesFormattingRequest=e.DocumentRangeFormattingRequest=e.DocumentFormattingRequest=e.DocumentLinkResolveRequest=e.DocumentLinkRequest=e.CodeLensRefreshRequest=e.CodeLensResolveRequest=e.CodeLensRequest=e.WorkspaceSymbolResolveRequest=void 0,e.InlineCompletionRequest=e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=e.InlineValueRefreshRequest=e.InlineValueRequest=e.TypeHierarchySupertypesRequest=e.TypeHierarchySubtypesRequest=e.TypeHierarchyPrepareRequest=void 0;const t=$n(),r=W$,n=K$(),a=Cwt();Object.defineProperty(e,"ImplementationRequest",{enumerable:!0,get:function(){return a.ImplementationRequest}});const i=jwt();Object.defineProperty(e,"TypeDefinitionRequest",{enumerable:!0,get:function(){return i.TypeDefinitionRequest}});const s=Ewt();Object.defineProperty(e,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(e,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const l=Mwt();Object.defineProperty(e,"ConfigurationRequest",{enumerable:!0,get:function(){return l.ConfigurationRequest}});const c=Twt();Object.defineProperty(e,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(e,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const u=Awt();Object.defineProperty(e,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}}),Object.defineProperty(e,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return u.FoldingRangeRefreshRequest}});const d=Dwt();Object.defineProperty(e,"DeclarationRequest",{enumerable:!0,get:function(){return d.DeclarationRequest}});const f=Lwt();Object.defineProperty(e,"SelectionRangeRequest",{enumerable:!0,get:function(){return f.SelectionRangeRequest}});const m=Owt();Object.defineProperty(e,"WorkDoneProgress",{enumerable:!0,get:function(){return m.WorkDoneProgress}}),Object.defineProperty(e,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return m.WorkDoneProgressCreateRequest}}),Object.defineProperty(e,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return m.WorkDoneProgressCancelNotification}});const p=Iwt();Object.defineProperty(e,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(e,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(e,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return p.CallHierarchyPrepareRequest}});const v=Rwt();Object.defineProperty(e,"TokenFormat",{enumerable:!0,get:function(){return v.TokenFormat}}),Object.defineProperty(e,"SemanticTokensRequest",{enumerable:!0,get:function(){return v.SemanticTokensRequest}}),Object.defineProperty(e,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return v.SemanticTokensDeltaRequest}}),Object.defineProperty(e,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return v.SemanticTokensRangeRequest}}),Object.defineProperty(e,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return v.SemanticTokensRefreshRequest}}),Object.defineProperty(e,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return v.SemanticTokensRegistrationType}});const b=Pwt();Object.defineProperty(e,"ShowDocumentRequest",{enumerable:!0,get:function(){return b.ShowDocumentRequest}});const y=zwt();Object.defineProperty(e,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const S=Bwt();Object.defineProperty(e,"FileOperationPatternKind",{enumerable:!0,get:function(){return S.FileOperationPatternKind}}),Object.defineProperty(e,"DidCreateFilesNotification",{enumerable:!0,get:function(){return S.DidCreateFilesNotification}}),Object.defineProperty(e,"WillCreateFilesRequest",{enumerable:!0,get:function(){return S.WillCreateFilesRequest}}),Object.defineProperty(e,"DidRenameFilesNotification",{enumerable:!0,get:function(){return S.DidRenameFilesNotification}}),Object.defineProperty(e,"WillRenameFilesRequest",{enumerable:!0,get:function(){return S.WillRenameFilesRequest}}),Object.defineProperty(e,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return S.DidDeleteFilesNotification}}),Object.defineProperty(e,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return S.WillDeleteFilesRequest}});const _=$wt();Object.defineProperty(e,"UniquenessLevel",{enumerable:!0,get:function(){return _.UniquenessLevel}}),Object.defineProperty(e,"MonikerKind",{enumerable:!0,get:function(){return _.MonikerKind}}),Object.defineProperty(e,"MonikerRequest",{enumerable:!0,get:function(){return _.MonikerRequest}});const N=Fwt();Object.defineProperty(e,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return N.TypeHierarchyPrepareRequest}}),Object.defineProperty(e,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return N.TypeHierarchySubtypesRequest}}),Object.defineProperty(e,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return N.TypeHierarchySupertypesRequest}});const k=Uwt();Object.defineProperty(e,"InlineValueRequest",{enumerable:!0,get:function(){return k.InlineValueRequest}}),Object.defineProperty(e,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return k.InlineValueRefreshRequest}});const j=Hwt();Object.defineProperty(e,"InlayHintRequest",{enumerable:!0,get:function(){return j.InlayHintRequest}}),Object.defineProperty(e,"InlayHintResolveRequest",{enumerable:!0,get:function(){return j.InlayHintResolveRequest}}),Object.defineProperty(e,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return j.InlayHintRefreshRequest}});const E=qwt();Object.defineProperty(e,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return E.DiagnosticServerCancellationData}}),Object.defineProperty(e,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return E.DocumentDiagnosticReportKind}}),Object.defineProperty(e,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return E.DocumentDiagnosticRequest}}),Object.defineProperty(e,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return E.WorkspaceDiagnosticRequest}}),Object.defineProperty(e,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return E.DiagnosticRefreshRequest}});const T=Wwt();Object.defineProperty(e,"NotebookCellKind",{enumerable:!0,get:function(){return T.NotebookCellKind}}),Object.defineProperty(e,"ExecutionSummary",{enumerable:!0,get:function(){return T.ExecutionSummary}}),Object.defineProperty(e,"NotebookCell",{enumerable:!0,get:function(){return T.NotebookCell}}),Object.defineProperty(e,"NotebookDocument",{enumerable:!0,get:function(){return T.NotebookDocument}}),Object.defineProperty(e,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return T.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(e,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidOpenNotebookDocumentNotification}}),Object.defineProperty(e,"NotebookCellArrayChange",{enumerable:!0,get:function(){return T.NotebookCellArrayChange}}),Object.defineProperty(e,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidChangeNotebookDocumentNotification}}),Object.defineProperty(e,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidSaveNotebookDocumentNotification}}),Object.defineProperty(e,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidCloseNotebookDocumentNotification}});const O=Kwt();Object.defineProperty(e,"InlineCompletionRequest",{enumerable:!0,get:function(){return O.InlineCompletionRequest}});var R;(function(X){function Oe(Ke){const be=Ke;return n.string(be)||n.string(be.language)||n.string(be.scheme)||n.string(be.pattern)}X.is=Oe})(R||(e.TextDocumentFilter=R={}));var q;(function(X){function Oe(Ke){const be=Ke;return n.objectLiteral(be)&&(n.string(be.notebookType)||n.string(be.scheme)||n.string(be.pattern))}X.is=Oe})(q||(e.NotebookDocumentFilter=q={}));var $;(function(X){function Oe(Ke){const be=Ke;return n.objectLiteral(be)&&(n.string(be.notebook)||q.is(be.notebook))&&(be.language===void 0||n.string(be.language))}X.is=Oe})($||(e.NotebookCellTextDocumentFilter=$={}));var L;(function(X){function Oe(Ke){if(!Array.isArray(Ke))return!1;for(let be of Ke)if(!n.string(be)&&!R.is(be)&&!$.is(be))return!1;return!0}X.is=Oe})(L||(e.DocumentSelector=L={}));var A;(function(X){X.method="client/registerCapability",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolRequestType(X.method)})(A||(e.RegistrationRequest=A={}));var M;(function(X){X.method="client/unregisterCapability",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolRequestType(X.method)})(M||(e.UnregistrationRequest=M={}));var z;(function(X){X.Create="create",X.Rename="rename",X.Delete="delete"})(z||(e.ResourceOperationKind=z={}));var I;(function(X){X.Abort="abort",X.Transactional="transactional",X.TextOnlyTransactional="textOnlyTransactional",X.Undo="undo"})(I||(e.FailureHandlingKind=I={}));var B;(function(X){X.UTF8="utf-8",X.UTF16="utf-16",X.UTF32="utf-32"})(B||(e.PositionEncodingKind=B={}));var F;(function(X){function Oe(Ke){const be=Ke;return be&&n.string(be.id)&&be.id.length>0}X.hasId=Oe})(F||(e.StaticRegistrationOptions=F={}));var U;(function(X){function Oe(Ke){const be=Ke;return be&&(be.documentSelector===null||L.is(be.documentSelector))}X.is=Oe})(U||(e.TextDocumentRegistrationOptions=U={}));var V;(function(X){function Oe(be){const W=be;return n.objectLiteral(W)&&(W.workDoneProgress===void 0||n.boolean(W.workDoneProgress))}X.is=Oe;function Ke(be){const W=be;return W&&n.boolean(W.workDoneProgress)}X.hasWorkDoneProgress=Ke})(V||(e.WorkDoneProgressOptions=V={}));var K;(function(X){X.method="initialize",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(K||(e.InitializeRequest=K={}));var G;(function(X){X.unknownProtocolVersion=1})(G||(e.InitializeErrorCodes=G={}));var J;(function(X){X.method="initialized",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(J||(e.InitializedNotification=J={}));var ee;(function(X){X.method="shutdown",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType0(X.method)})(ee||(e.ShutdownRequest=ee={}));var Y;(function(X){X.method="exit",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType0(X.method)})(Y||(e.ExitNotification=Y={}));var ie;(function(X){X.method="workspace/didChangeConfiguration",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(ie||(e.DidChangeConfigurationNotification=ie={}));var fe;(function(X){X.Error=1,X.Warning=2,X.Info=3,X.Log=4,X.Debug=5})(fe||(e.MessageType=fe={}));var me;(function(X){X.method="window/showMessage",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolNotificationType(X.method)})(me||(e.ShowMessageNotification=me={}));var te;(function(X){X.method="window/showMessageRequest",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolRequestType(X.method)})(te||(e.ShowMessageRequest=te={}));var oe;(function(X){X.method="window/logMessage",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolNotificationType(X.method)})(oe||(e.LogMessageNotification=oe={}));var ce;(function(X){X.method="telemetry/event",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolNotificationType(X.method)})(ce||(e.TelemetryEventNotification=ce={}));var Z;(function(X){X.None=0,X.Full=1,X.Incremental=2})(Z||(e.TextDocumentSyncKind=Z={}));var ue;(function(X){X.method="textDocument/didOpen",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(ue||(e.DidOpenTextDocumentNotification=ue={}));var H;(function(X){function Oe(be){let W=be;return W!=null&&typeof W.text=="string"&&W.range!==void 0&&(W.rangeLength===void 0||typeof W.rangeLength=="number")}X.isIncremental=Oe;function Ke(be){let W=be;return W!=null&&typeof W.text=="string"&&W.range===void 0&&W.rangeLength===void 0}X.isFull=Ke})(H||(e.TextDocumentContentChangeEvent=H={}));var ge;(function(X){X.method="textDocument/didChange",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(ge||(e.DidChangeTextDocumentNotification=ge={}));var de;(function(X){X.method="textDocument/didClose",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(de||(e.DidCloseTextDocumentNotification=de={}));var re;(function(X){X.method="textDocument/didSave",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(re||(e.DidSaveTextDocumentNotification=re={}));var ne;(function(X){X.Manual=1,X.AfterDelay=2,X.FocusOut=3})(ne||(e.TextDocumentSaveReason=ne={}));var pe;(function(X){X.method="textDocument/willSave",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(pe||(e.WillSaveTextDocumentNotification=pe={}));var ke;(function(X){X.method="textDocument/willSaveWaitUntil",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(ke||(e.WillSaveTextDocumentWaitUntilRequest=ke={}));var we;(function(X){X.method="workspace/didChangeWatchedFiles",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolNotificationType(X.method)})(we||(e.DidChangeWatchedFilesNotification=we={}));var ve;(function(X){X.Created=1,X.Changed=2,X.Deleted=3})(ve||(e.FileChangeType=ve={}));var Le;(function(X){function Oe(Ke){const be=Ke;return n.objectLiteral(be)&&(r.URI.is(be.baseUri)||r.WorkspaceFolder.is(be.baseUri))&&n.string(be.pattern)}X.is=Oe})(Le||(e.RelativePattern=Le={}));var Ae;(function(X){X.Create=1,X.Change=2,X.Delete=4})(Ae||(e.WatchKind=Ae={}));var Re;(function(X){X.method="textDocument/publishDiagnostics",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolNotificationType(X.method)})(Re||(e.PublishDiagnosticsNotification=Re={}));var Ye;(function(X){X.Invoked=1,X.TriggerCharacter=2,X.TriggerForIncompleteCompletions=3})(Ye||(e.CompletionTriggerKind=Ye={}));var mt;(function(X){X.method="textDocument/completion",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(mt||(e.CompletionRequest=mt={}));var ot;(function(X){X.method="completionItem/resolve",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(ot||(e.CompletionResolveRequest=ot={}));var Ot;(function(X){X.method="textDocument/hover",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Ot||(e.HoverRequest=Ot={}));var rt;(function(X){X.Invoked=1,X.TriggerCharacter=2,X.ContentChange=3})(rt||(e.SignatureHelpTriggerKind=rt={}));var ze;(function(X){X.method="textDocument/signatureHelp",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(ze||(e.SignatureHelpRequest=ze={}));var bt;(function(X){X.method="textDocument/definition",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(bt||(e.DefinitionRequest=bt={}));var tt;(function(X){X.method="textDocument/references",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(tt||(e.ReferencesRequest=tt={}));var _e;(function(X){X.method="textDocument/documentHighlight",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(_e||(e.DocumentHighlightRequest=_e={}));var We;(function(X){X.method="textDocument/documentSymbol",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(We||(e.DocumentSymbolRequest=We={}));var Ve;(function(X){X.method="textDocument/codeAction",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Ve||(e.CodeActionRequest=Ve={}));var Mt;(function(X){X.method="codeAction/resolve",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Mt||(e.CodeActionResolveRequest=Mt={}));var kt;(function(X){X.method="workspace/symbol",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(kt||(e.WorkspaceSymbolRequest=kt={}));var er;(function(X){X.method="workspaceSymbol/resolve",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(er||(e.WorkspaceSymbolResolveRequest=er={}));var mr;(function(X){X.method="textDocument/codeLens",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(mr||(e.CodeLensRequest=mr={}));var Zt;(function(X){X.method="codeLens/resolve",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Zt||(e.CodeLensResolveRequest=Zt={}));var Wt;(function(X){X.method="workspace/codeLens/refresh",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolRequestType0(X.method)})(Wt||(e.CodeLensRefreshRequest=Wt={}));var Rt;(function(X){X.method="textDocument/documentLink",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Rt||(e.DocumentLinkRequest=Rt={}));var he;(function(X){X.method="documentLink/resolve",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(he||(e.DocumentLinkResolveRequest=he={}));var De;(function(X){X.method="textDocument/formatting",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(De||(e.DocumentFormattingRequest=De={}));var Ue;(function(X){X.method="textDocument/rangeFormatting",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Ue||(e.DocumentRangeFormattingRequest=Ue={}));var ut;(function(X){X.method="textDocument/rangesFormatting",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(ut||(e.DocumentRangesFormattingRequest=ut={}));var St;(function(X){X.method="textDocument/onTypeFormatting",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(St||(e.DocumentOnTypeFormattingRequest=St={}));var jt;(function(X){X.Identifier=1})(jt||(e.PrepareSupportDefaultBehavior=jt={}));var Je;(function(X){X.method="textDocument/rename",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Je||(e.RenameRequest=Je={}));var Xe;(function(X){X.method="textDocument/prepareRename",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(Xe||(e.PrepareRenameRequest=Xe={}));var it;(function(X){X.method="workspace/executeCommand",X.messageDirection=t.MessageDirection.clientToServer,X.type=new t.ProtocolRequestType(X.method)})(it||(e.ExecuteCommandRequest=it={}));var Xt;(function(X){X.method="workspace/applyEdit",X.messageDirection=t.MessageDirection.serverToClient,X.type=new t.ProtocolRequestType("workspace/applyEdit")})(Xt||(e.ApplyWorkspaceEditRequest=Xt={}))})(wO)),wO}var lb={},kae;function Vwt(){if(kae)return lb;kae=1,Object.defineProperty(lb,"__esModule",{value:!0}),lb.createProtocolConnection=void 0;const e=N0();function t(r,n,a,i){return e.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,e.createMessageConnection)(r,n,a,i)}return lb.createProtocolConnection=t,lb}var _ae;function Ywt(){return _ae||(_ae=1,(function(e){var t=Tf&&Tf.__createBinding||(Object.create?(function(i,s,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(s,l);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[l]}}),Object.defineProperty(i,c,u)}):(function(i,s,l,c){c===void 0&&(c=l),i[c]=s[l]})),r=Tf&&Tf.__exportStar||function(i,s){for(var l in i)l!=="default"&&!Object.prototype.hasOwnProperty.call(s,l)&&t(s,i,l)};Object.defineProperty(e,"__esModule",{value:!0}),e.LSPErrorCodes=e.createProtocolConnection=void 0,r(N0(),e),r(W$,e),r($n(),e),r(Gwt(),e);var n=Vwt();Object.defineProperty(e,"createProtocolConnection",{enumerable:!0,get:function(){return n.createProtocolConnection}});var a;(function(i){i.lspReservedErrorRangeStart=-32899,i.RequestFailed=-32803,i.ServerCancelled=-32802,i.ContentModified=-32801,i.RequestCancelled=-32800,i.lspReservedErrorRangeEnd=-32800})(a||(e.LSPErrorCodes=a={}))})(Tf)),Tf}var Nae;function Qwt(){return Nae||(Nae=1,(function(e){var t=Nf&&Nf.__createBinding||(Object.create?(function(i,s,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(s,l);(!u||("get"in u?!s.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return s[l]}}),Object.defineProperty(i,c,u)}):(function(i,s,l,c){c===void 0&&(c=l),i[c]=s[l]})),r=Nf&&Nf.__exportStar||function(i,s){for(var l in i)l!=="default"&&!Object.prototype.hasOwnProperty.call(s,l)&&t(s,i,l)};Object.defineProperty(e,"__esModule",{value:!0}),e.createProtocolConnection=void 0;const n=Jne();r(Jne(),e),r(Ywt(),e);function a(i,s,l,c){return(0,n.createMessageConnection)(i,s,l,c)}e.createProtocolConnection=a})(Nf)),Nf}var Tr=Qwt();class Jwt{constructor(t){xt(this,"connection",null);xt(this,"socket",null);xt(this,"disposables",[]);xt(this,"documentVersion",0);xt(this,"language");xt(this,"workspaceRoot");xt(this,"monacoInstance",null);xt(this,"_isConnected",!1);xt(this,"documentToModelUri",new Map);this.language=t.language,this.workspaceRoot=t.workspaceRoot||"/"}get isConnected(){return this._isConnected}async start(t,r){this.socket=t,this.monacoInstance=r;const n=mwt(t),a=new fwt(n),i=new hwt(n);this.connection=H$.createMessageConnection(a,i),this.setupNotificationHandlers(),this.connection.listen(),await this.connection.sendRequest("initialize",{processId:null,capabilities:{textDocument:{completion:{completionItem:{snippetSupport:!0,documentationFormat:[Tr.MarkupKind.Markdown,Tr.MarkupKind.PlainText]}},hover:{contentFormat:[Tr.MarkupKind.Markdown,Tr.MarkupKind.PlainText]},publishDiagnostics:{relatedInformation:!0},definition:{},synchronization:{didSave:!0,dynamicRegistration:!1}},workspace:{workspaceFolders:!0}},rootUri:`file://${this.workspaceRoot}`,workspaceFolders:[{uri:`file://${this.workspaceRoot}`,name:this.workspaceRoot.split("/").pop()||"workspace"}]}),this.connection.sendNotification("initialized",{}),this.registerProviders(),this._isConnected=!0}setupNotificationHandlers(){this.connection&&this.connection.onNotification("textDocument/publishDiagnostics",t=>{if(!this.monacoInstance)return;const r=this.documentToModelUri.get(t.uri),n=this.monacoInstance.editor.getModels(),a=n.find(i=>{const s=i.uri.toString();return r&&s===r?!0:s===t.uri||`file://${s}`===t.uri||s===t.uri.replace("file://","")});if(a){const i=t.diagnostics.map(s=>Xwt(s));this.monacoInstance.editor.setModelMarkers(a,"lsp",i),console.log(`[lsp-client] Set ${i.length} diagnostics for ${t.uri}`)}else t.diagnostics.length>0&&console.warn(`[lsp-client] No model found for diagnostics URI: ${t.uri}`,`Mapped model URI: ${r||"none"}`,`Available models: ${n.map(i=>i.uri.toString()).join(", ")}`)})}registerProviders(){if(!this.monacoInstance||!this.connection)return;const t=this.connection,r=this.language;this.disposables.push(this.monacoInstance.languages.registerCompletionItemProvider(r,{triggerCharacters:[".","/",'"',"'","`","<","@"],provideCompletionItems:async(n,a)=>{try{const i=await t.sendRequest("textDocument/completion",{textDocument:{uri:n.uri.toString()},position:{line:a.lineNumber-1,character:a.column-1}});if(!i)return{suggestions:[]};const s=Array.isArray(i)?i:i.items,l=n.getWordUntilPosition(a),c={startLineNumber:a.lineNumber,startColumn:l.startColumn,endLineNumber:a.lineNumber,endColumn:l.endColumn};return{suggestions:s.map(u=>tSt(u,c,this.monacoInstance))}}catch{return{suggestions:[]}}}})),this.disposables.push(this.monacoInstance.languages.registerHoverProvider(r,{provideHover:async(n,a)=>{try{const i=await t.sendRequest("textDocument/hover",{textDocument:{uri:n.uri.toString()},position:{line:a.lineNumber-1,character:a.column-1}});if(!i)return null;const s=c=>typeof c=="string"?{value:c}:c&&typeof c=="object"&&"value"in c?{value:String(c.value)}:{value:String(c)};return{contents:Array.isArray(i.contents)?i.contents.map(s):[s(i.contents)],range:i.range?{startLineNumber:i.range.start.line+1,startColumn:i.range.start.character+1,endLineNumber:i.range.end.line+1,endColumn:i.range.end.character+1}:void 0}}catch{return null}}})),this.disposables.push(this.monacoInstance.languages.registerDefinitionProvider(r,{provideDefinition:async(n,a)=>{try{const i=await t.sendRequest("textDocument/definition",{textDocument:{uri:n.uri.toString()},position:{line:a.lineNumber-1,character:a.column-1}});return i?(Array.isArray(i)?i:[i]).map(l=>({uri:this.monacoInstance.Uri.parse("uri"in l?l.uri:""),range:{startLineNumber:("range"in l?l.range.start.line:0)+1,startColumn:("range"in l?l.range.start.character:0)+1,endLineNumber:("range"in l?l.range.end.line:0)+1,endColumn:("range"in l?l.range.end.character:0)+1}})):null}catch{return null}}}))}resolveDocumentUri(t){return t.startsWith("/")?`file://${t}`:`file://${this.workspaceRoot}/${t}`}sendDidOpen(t,r,n,a){this.connection&&(this.documentVersion=1,a&&a!==t&&this.documentToModelUri.set(t,a),this.connection.sendNotification("textDocument/didOpen",{textDocument:{uri:t,languageId:r,version:this.documentVersion,text:n}}))}sendDidChange(t,r){this.connection&&(this.documentVersion++,this.connection.sendNotification("textDocument/didChange",{textDocument:{uri:t,version:this.documentVersion},contentChanges:[{text:r}]}))}sendDidClose(t){this.connection&&(this.documentToModelUri.delete(t),this.connection.sendNotification("textDocument/didClose",{textDocument:{uri:t}}))}async stop(){this._isConnected=!1;for(const t of this.disposables)t.dispose();this.disposables=[],this.connection&&(this.connection.dispose(),this.connection=null),this.socket&&this.socket.readyState===WebSocket.OPEN&&(this.socket.close(),this.socket=null)}}function Zwt(e){switch(e){case Tr.DiagnosticSeverity.Error:return 8;case Tr.DiagnosticSeverity.Warning:return 4;case Tr.DiagnosticSeverity.Information:return 2;case Tr.DiagnosticSeverity.Hint:return 1;default:return 2}}function Xwt(e){return{severity:Zwt(e.severity),message:e.message,startLineNumber:e.range.start.line+1,startColumn:e.range.start.character+1,endLineNumber:e.range.end.line+1,endColumn:e.range.end.character+1,source:e.source,code:typeof e.code=="number"?String(e.code):e.code}}function eSt(e,t){const r=t.languages.CompletionItemKind;switch(e){case Tr.CompletionItemKind.Text:return r.Text;case Tr.CompletionItemKind.Method:return r.Method;case Tr.CompletionItemKind.Function:return r.Function;case Tr.CompletionItemKind.Constructor:return r.Constructor;case Tr.CompletionItemKind.Field:return r.Field;case Tr.CompletionItemKind.Variable:return r.Variable;case Tr.CompletionItemKind.Class:return r.Class;case Tr.CompletionItemKind.Interface:return r.Interface;case Tr.CompletionItemKind.Module:return r.Module;case Tr.CompletionItemKind.Property:return r.Property;case Tr.CompletionItemKind.Unit:return r.Unit;case Tr.CompletionItemKind.Value:return r.Value;case Tr.CompletionItemKind.Enum:return r.Enum;case Tr.CompletionItemKind.Keyword:return r.Keyword;case Tr.CompletionItemKind.Snippet:return r.Snippet;case Tr.CompletionItemKind.Color:return r.Color;case Tr.CompletionItemKind.File:return r.File;case Tr.CompletionItemKind.Reference:return r.Reference;case Tr.CompletionItemKind.Folder:return r.Folder;case Tr.CompletionItemKind.EnumMember:return r.EnumMember;case Tr.CompletionItemKind.Constant:return r.Constant;case Tr.CompletionItemKind.Struct:return r.Struct;case Tr.CompletionItemKind.Event:return r.Event;case Tr.CompletionItemKind.Operator:return r.Operator;case Tr.CompletionItemKind.TypeParameter:return r.TypeParameter;default:return r.Text}}function tSt(e,t,r){const n=e.documentation?typeof e.documentation=="string"?e.documentation:{value:e.documentation.value}:void 0;return{label:e.label,kind:eSt(e.kind,r),detail:e.detail,documentation:n,insertText:e.insertText||e.label,range:t,sortText:e.sortText,filterText:e.filterText}}let SO=null,pp=null;const Sd=new Map,C6=new Set;function rSt(e){return C6.add(e),()=>{C6.delete(e)}}function Cae(e,t){C6.forEach(r=>{try{r(e,t)}catch(n){console.error("[lsp-client] Error in connection state callback:",n)}})}async function G$(e=!1){return SO&&!e?SO:(pp&&!e||(pp=fetch("/api/lsp/status").then(t=>{if(!t.ok)throw new Error(`Failed to fetch LSP status: ${t.statusText}`);return t.json()}).then(t=>(SO=t,pp=null,t)).catch(t=>{throw pp=null,t})),pp)}async function jae(e){try{return(await G$()).servers.find(n=>n.languages.includes(e))?.available??!1}catch{return!1}}function nSt(e){const t=window.location.protocol==="https:"?"wss:":"ws:",r=window.location.host;return`${t}//${r}/ws/lsp?language=${encodeURIComponent(e)}`}async function aSt(e,t,r){if(Sd.has(e)){const s=Sd.get(e);if(s.socket.readyState===WebSocket.OPEN&&s.client.isConnected)return console.log(`[lsp-client] Already connected to ${e} server`),s.client;await Aye(e)}if(!t)return console.log(`[lsp-client] Monaco instance required for ${e} LSP connection`),null;const n=await G$();if(!n.servers.find(s=>s.languages.includes(e))?.available)return console.log(`[lsp-client] No LSP server available for ${e}`),null;const i=n.workspaceRoot;return console.log(`[lsp-client] Connecting to ${e} language server...`),new Promise((s,l)=>{const c=nSt(e),u=new WebSocket(c);u.onopen=async()=>{console.log(`[lsp-client] WebSocket connected for ${e}`);try{const d=new Jwt({language:e,workspaceRoot:i});await d.start(u,t),Sd.set(e,{client:d,socket:u,language:e}),Cae(e,"connected"),console.log(`[lsp-client] Language client started for ${e}`),s(d)}catch(d){console.error("[lsp-client] Error creating language client:",d),u.close(),l(d)}},u.onerror=d=>{console.error(`[lsp-client] WebSocket error for ${e}:`,d),l(new Error(`WebSocket connection failed for ${e}`))},u.onclose=d=>{console.log(`[lsp-client] WebSocket closed for ${e}: code=${d.code}, reason=${d.reason}`),Sd.delete(e),Cae(e,"disconnected")}})}async function Aye(e){const t=Sd.get(e);if(t){console.log(`[lsp-client] Disconnecting from ${e} server...`);try{await t.client.stop()}catch(r){console.warn(`[lsp-client] Error stopping client for ${e}:`,r)}Sd.delete(e)}}function Eae(e){const t=Sd.get(e);return t&&t.socket.readyState===WebSocket.OPEN&&t.client.isConnected?"connected":"disconnected"}function kO(e){return Sd.get(e)?.client??null}function iSt({monaco:e,language:t,documentUri:r,autoConnect:n=!0}){const[a,i]=w.useState("idle"),[s,l]=w.useState(!1),[c,u]=w.useState(null),[d,f]=w.useState(null),m=w.useRef(!0),p=w.useCallback(async()=>{try{const y=await G$(!0);m.current&&f(y)}catch(y){console.error("[useLsp] Error fetching status:",y)}},[]);w.useEffect(()=>{if(!OC(t)){l(!1),i("unavailable");return}let y=!1;return jae(t).then(S=>{y||!m.current||(l(S),S||i("unavailable"))}),()=>{y=!0}},[t]);const v=w.useCallback(async()=>{if(!e){u("Monaco instance not available"),i("error");return}if(!OC(t)){i("unavailable");return}if(!await jae(t)){i("unavailable");return}i("connecting"),u(null);try{const S=await aSt(t,e,r);m.current&&i(S?"connected":"unavailable")}catch(S){m.current&&(u(S instanceof Error?S.message:"Connection failed"),i("error"))}},[e,t,r]),b=w.useCallback(async()=>{await Aye(t),m.current&&(i("idle"),u(null))},[t]);return w.useEffect(()=>{if(!(!n||!e||!s||a!=="idle")){if(Eae(t)==="connected"){i("connected");return}v()}},[n,e,s,a,t,v]),w.useEffect(()=>{p()},[p]),w.useEffect(()=>(m.current=!0,()=>{m.current=!1}),[]),w.useEffect(()=>rSt((S,_)=>{S!==t||!m.current||(_==="connected"&&a!=="connected"&&a!=="connecting"?i("connected"):_==="disconnected"&&a==="connected"&&(i("idle"),console.log(`[useLsp] LSP disconnected for ${t}, reverting to idle state`)))}),[t,a]),w.useEffect(()=>{const y=Eae(t);y==="connected"&&a!=="connected"&&a!=="connecting"?i("connected"):y==="disconnected"&&a==="connected"&&i("idle")},[t,a]),{state:a,available:s,error:c,connect:v,disconnect:b,status:d,refreshStatus:p}}let dk=null,j6=!1;const sSt={base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6A9955",fontStyle:"italic"},{token:"keyword",foreground:"C586C0"},{token:"keyword.control",foreground:"C586C0"},{token:"keyword.operator",foreground:"C586C0"},{token:"string",foreground:"CE9178"},{token:"string.escape",foreground:"D7BA7D"},{token:"number",foreground:"B5CEA8"},{token:"regexp",foreground:"D16969"},{token:"type",foreground:"4EC9B0"},{token:"type.identifier",foreground:"4EC9B0"},{token:"class",foreground:"4EC9B0"},{token:"interface",foreground:"4EC9B0",fontStyle:"italic"},{token:"enum",foreground:"4EC9B0"},{token:"typeParameter",foreground:"4EC9B0",fontStyle:"italic"},{token:"function",foreground:"DCDCAA"},{token:"function.declaration",foreground:"DCDCAA"},{token:"method",foreground:"DCDCAA"},{token:"variable",foreground:"9CDCFE"},{token:"variable.readonly",foreground:"4FC1FF"},{token:"variable.constant",foreground:"4FC1FF"},{token:"parameter",foreground:"9CDCFE",fontStyle:"italic"},{token:"property",foreground:"9CDCFE"},{token:"namespace",foreground:"4EC9B0"},{token:"decorator",foreground:"DCDCAA"},{token:"tag",foreground:"569CD6"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"tag.tsx",foreground:"4EC9B0"},{token:"tag.jsx",foreground:"4EC9B0"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"markup.heading",foreground:"569CD6",fontStyle:"bold"},{token:"markup.bold",fontStyle:"bold"},{token:"markup.italic",fontStyle:"italic"},{token:"markup.inline.raw",foreground:"CE9178"},{token:"variable.shell",foreground:"9CDCFE"}],colors:{"editor.background":"#1a1a2e","editor.foreground":"#d4d4d4","editor.lineHighlightBackground":"#2a2a4e","editor.selectionBackground":"#264f78","editorCursor.foreground":"#aeafad","editorWhitespace.foreground":"#3b3b5b","editorLineNumber.foreground":"#5a5a8a","editorLineNumber.activeForeground":"#c6c6c6","editor.inactiveSelectionBackground":"#3a3d41","editorIndentGuide.background1":"#404060","editorIndentGuide.activeBackground1":"#707090"}};async function oSt(){return dk||(dk=(async()=>{if(j6)return;Gp.defineTheme("stoneforge-dark",sSt);const e={noSemanticValidation:!0,noSyntaxValidation:!1};ws.typescript.typescriptDefaults.setDiagnosticsOptions(e),ws.typescript.javascriptDefaults.setDiagnosticsOptions(e),ws.typescript.typescriptDefaults.setCompilerOptions({...ws.typescript.typescriptDefaults.getCompilerOptions(),jsx:ws.typescript.JsxEmit.ReactJSX,noUnusedLocals:!1,noUnusedParameters:!1,allowNonTsExtensions:!0,target:ws.typescript.ScriptTarget.ES2020,module:ws.typescript.ModuleKind.ESNext,moduleResolution:ws.typescript.ModuleResolutionKind.NodeJs}),ws.typescript.javascriptDefaults.setCompilerOptions({...ws.typescript.javascriptDefaults.getCompilerOptions(),jsx:ws.typescript.JsxEmit.ReactJSX,noUnusedLocals:!1,noUnusedParameters:!1,allowNonTsExtensions:!0}),typeof window<"u"&&(window.monaco=TO),j6=!0,console.log("[monaco-init] Monaco initialized with TS worker configuration")})(),dk)}function lSt(){return j6}const cSt=["typescript","javascript","typescriptreact","javascriptreact"],uSt={completionItems:!0,hovers:!0,diagnostics:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,codeActions:!0,signatureHelp:!0,selectionRanges:!0,foldingRanges:!0},dSt={completionItems:!1,hovers:!1,diagnostics:!1,definitions:!1,references:!1,documentHighlights:!1,rename:!1,codeActions:!1,signatureHelp:!1,selectionRanges:!0,foldingRanges:!0},fSt={automaticLayout:!0,minimap:{enabled:!0,scale:1,showSlider:"mouseover",renderCharacters:!1},fontSize:14,fontFamily:"'Fira Code', 'JetBrains Mono', 'Cascadia Code', Menlo, Monaco, 'Courier New', monospace",fontLigatures:!0,lineNumbers:"on",scrollBeyondLastLine:!1,wordWrap:"on",padding:{top:16,bottom:16},renderWhitespace:"selection",bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0,highlightActiveIndentation:!0},smoothScrolling:!0,cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",hover:{enabled:!0,delay:300},occurrencesHighlight:"singleFile",selectionHighlight:!0,suggest:{showMethods:!0,showFunctions:!0,showConstructors:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0}};function Mae(e,t,r){const n=e?`file:///${e.replace(/^\//,"")}`:`inmemory://model/${Date.now()}`,a=mSe.parse(n);let i=Gp.getModel(a);return i||(i=Gp.createModel(t,r,a)),i}function hSt({value:e,language:t,readOnly:r=!1,onChange:n,onMount:a,onReady:i,theme:s="stoneforge-dark",className:l="",filePath:c,onLspStateChange:u}){const[d]=w.useState(()=>lSt()?null:(console.error("[LspMonacoEditor] Monaco not initialized! FileEditorPage should call initializeMonaco() first."),"Editor not initialized. Please refresh the page.")),f=w.useRef(null),m=w.useRef(null),p=w.useRef(!1),v=w.useRef(e),b=w.useRef(c),y=w.useRef(c);y.current=c;const S=w.useRef(t),_=w.useRef(null),N=w.useRef([]),k=w.useRef(!1),{state:j}=iSt({monaco:d?void 0:TO,language:t,documentUri:c?`file://${c}`:void 0,autoConnect:OC(t)&&!r});return w.useEffect(()=>{if(d||!f.current||m.current)return;const E=Mae(c,e,t),T=Gp.create(f.current,{...fSt,model:E,theme:s,readOnly:r,quickSuggestions:!r,suggestOnTriggerCharacters:!r,parameterHints:{enabled:!r}});m.current=T,p.current=!1,v.current=e;const O=T.onDidChangeModelContent(()=>{if(!k.current){const L=T.getModel()?.getAlternativeVersionId();n?.(L)}p.current&&(_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{const L=kO(t);if(L){const A=T.getModel();if(A){const M=y.current,z=M?L.resolveDocumentUri(M):A.uri.toString();L.sendDidChange(z,A.getValue())}}},200))}),R=T.onDidFocusEditorWidget(()=>{zp().setEnabled(!1)}),q=T.onDidBlurEditorWidget(()=>{zp().setEnabled(!0)});N.current=[O,R,q],a&&a(T,TO);const $=E.getAlternativeVersionId();return i&&i($),()=>{_.current&&clearTimeout(_.current);for(const L of N.current)L.dispose();N.current=[],zp().setEnabled(!0),m.current&&(m.current.dispose(),m.current=null)}},[d]),w.useEffect(()=>{if(d||!m.current||c===b.current&&t===S.current)return;const E=m.current,T=kO(t);b.current&&p.current&&T&&T.sendDidClose(T.resolveDocumentUri(b.current)),p.current=!1;const O=Mae(c,e,t);k.current=!0,E.setModel(O),O.getValue()!==e&&O.setValue(e),k.current=!1,b.current=c,S.current=t,v.current=e,i&&i(O.getAlternativeVersionId())},[c,t,e,d,i]),w.useEffect(()=>{if(d||!cSt.includes(t))return;const E=j==="connected",T=E?dSt:uSt;try{t==="typescript"||t==="typescriptreact"?ws.typescript.typescriptDefaults.setModeConfiguration(T):(t==="javascript"||t==="javascriptreact")&&ws.typescript.javascriptDefaults.setModeConfiguration(T),console.log(`[LspMonacoEditor] ${E?"Disabled":"Enabled"} built-in TS intellisense for ${t}`)}catch(O){console.warn("[LspMonacoEditor] Failed to set mode configuration:",O)}},[d,t,j]),w.useEffect(()=>{if(j!=="connected"||!m.current)return;const E=kO(t);if(!E||(b.current!==c&&(b.current&&p.current&&E.sendDidClose(E.resolveDocumentUri(b.current)),p.current=!1,b.current=c),p.current))return;const T=m.current.getModel();if(!T)return;const O=c?E.resolveDocumentUri(c):T.uri.toString(),R=T.uri.toString();E.sendDidOpen(O,t,T.getValue(),R),p.current=!0,console.log(`[LspMonacoEditor] Sent didOpen for ${O} (model: ${R})`)},[j,t,c]),w.useEffect(()=>{u&&u(j)},[j,u]),w.useEffect(()=>{if(e===v.current||(v.current=e,!m.current))return;const E=m.current.getModel();E&&E.getValue()!==e&&(k.current=!0,E.setValue(e),k.current=!1)},[e]),w.useEffect(()=>{m.current&&m.current.updateOptions({readOnly:r,quickSuggestions:!r,suggestOnTriggerCharacters:!r,parameterHints:{enabled:!r}})},[r]),w.useEffect(()=>{d||Gp.setTheme(s)},[s,d]),d?o.jsx("div",{className:`flex items-center justify-center h-full bg-[var(--color-surface)] ${l}`,children:o.jsxs("div",{className:"text-center p-4",children:[o.jsx("p",{className:"text-[var(--color-danger)] mb-2",children:"Failed to load editor"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:d})]})}):o.jsx("div",{className:`relative h-full ${l}`,"data-testid":"lsp-monaco-editor",children:o.jsx("div",{ref:f,style:{width:"100%",height:"100%"}})})}const mSt=w.memo(hSt);function pSt(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}function gSt(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/(1e3*60*60*24));return a<1?"Today":a===1?"Yesterday":a<7?`${a} days ago`:a<30?`${Math.floor(a/7)} weeks ago`:a<365?`${Math.floor(a/30)} months ago`:`${Math.floor(a/365)} years ago`}function vSt(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function bSt({rating:e}){const t=Math.floor(e),r=e-t>=.5,n=5-t-(r?1:0);return o.jsxs("div",{className:"flex items-center gap-0.5",children:[Array.from({length:t}).map((a,i)=>o.jsx(fT,{className:"w-3.5 h-3.5 fill-yellow-400 text-yellow-400"},`full-${i}`)),r&&o.jsx(fT,{className:"w-3.5 h-3.5 text-yellow-400",style:{clipPath:"inset(0 50% 0 0)"}},"half"),Array.from({length:n}).map((a,i)=>o.jsx(fT,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"},`empty-${i}`)),o.jsxs("span",{className:"ml-1 text-xs text-[var(--color-text-secondary)]",children:["(",e.toFixed(1),")"]})]})}function Tae({content:e,isLoading:t,error:r,emptyMessage:n}){if(t)return o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx($e,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"})});if(r)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:r})]});if(!e)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[o.jsx(rn,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:n})]});const a=Ar.parse(e);return o.jsx("div",{className:"extension-readme-content prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:a}})}function ySt({extensionId:e,className:t=""}){const[r,n]=w.useState("details"),[a,i]=e.split("."),{installed:s,installing:l,install:c,uninstall:u}=kye(),d=s.some($=>$.id===e),f=l.has(e),[m,p]=w.useState(!1),{data:v,isLoading:b,error:y}=gt({queryKey:["extension",a,i],queryFn:()=>xye(a,i),staleTime:300*1e3,enabled:!!a&&!!i}),{data:S,isLoading:_,error:N}=gt({queryKey:["extension",a,i,"readme"],queryFn:async()=>{if(!v?.files?.readme)return"";const $=await fetch(v.files.readme);if(!$.ok)throw new Error("Failed to load README");return $.text()},staleTime:300*1e3,enabled:!!v?.files?.readme}),{data:k,isLoading:j,error:E}=gt({queryKey:["extension",a,i,"changelog"],queryFn:async()=>{if(!v?.files?.changelog)return"";const $=await fetch(v.files.changelog);if(!$.ok)throw new Error("Failed to load changelog");return $.text()},staleTime:300*1e3,enabled:!!v?.files?.changelog&&r==="changelog"}),T=w.useCallback(async()=>{if(!(f||!a||!i))try{await c(a,i,"latest")}catch($){console.error("[ExtensionDetailPage] Install failed:",$)}},[a,i,f,c]),O=w.useCallback(async()=>{if(!m){p(!0);try{await u(e)}catch($){console.error("[ExtensionDetailPage] Uninstall failed:",$)}finally{p(!1)}}},[e,m,u]);if(b)return o.jsx("div",{className:`flex items-center justify-center h-full ${t}`,children:o.jsx($e,{className:"w-8 h-8 animate-spin text-[var(--color-text-muted)]"})});if(y||!v)return o.jsxs("div",{className:`flex flex-col items-center justify-center h-full text-center p-6 ${t}`,children:[o.jsx(Bt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Failed to Load Extension"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:y instanceof Error?y.message:"Could not load extension details."})]});const R=v.displayName||v.name,q=v.files?.icon;return o.jsxs("div",{className:`flex flex-col h-full overflow-hidden bg-[var(--color-bg)] ${t}`,children:[o.jsx("div",{className:"flex-shrink-0 p-6 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsxs("div",{className:"flex-shrink-0 w-20 h-20 rounded-lg bg-[var(--color-surface)] flex items-center justify-center overflow-hidden",children:[q?o.jsx("img",{src:q,alt:`${R} icon`,className:"w-full h-full object-cover",loading:"lazy",onError:$=>{$.target.style.display="none",$.target.nextElementSibling?.classList.remove("hidden")}}):null,o.jsx(oy,{className:`w-10 h-10 text-[var(--color-text-muted)] ${q?"hidden":""}`})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h1",{className:"text-2xl font-bold text-[var(--color-text)] mb-1 truncate",children:R}),o.jsxs("div",{className:"flex items-center gap-4 text-sm text-[var(--color-text-secondary)] mb-2",children:[o.jsx("span",{children:v.namespace}),v.downloadCount!==void 0&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(sy,{className:"w-3.5 h-3.5"}),pSt(v.downloadCount)]}),v.averageRating!==void 0&&v.averageRating>0&&o.jsx(bSt,{rating:v.averageRating})]}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] line-clamp-2",children:v.description||"No description available"})]}),o.jsx("div",{className:"flex-shrink-0",children:d?o.jsxs("button",{onClick:O,disabled:m,className:`
                  flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors
                  ${m?"bg-[var(--color-surface)] text-[var(--color-text-muted)] cursor-not-allowed":"bg-[var(--color-danger)] text-white hover:bg-[var(--color-danger)]/90"}
                `,children:[m?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(Sr,{className:"w-4 h-4"}),o.jsx("span",{children:m?"Uninstalling...":"Uninstall"})]}):o.jsxs("button",{onClick:T,disabled:f,className:`
                  flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors
                  ${f?"bg-[var(--color-surface)] text-[var(--color-text-muted)] cursor-not-allowed":"bg-[var(--color-primary)] text-white hover:bg-[var(--color-primary-hover)]"}
                `,children:[f?o.jsx($e,{className:"w-4 h-4 animate-spin"}):o.jsx(sy,{className:"w-4 h-4"}),o.jsx("span",{children:f?"Installing...":"Install"})]})})]})}),o.jsx("hr",{className:"border-[var(--color-border)]"}),o.jsxs("div",{className:"flex-shrink-0 flex items-center border-b border-[var(--color-border)] px-6",children:[o.jsxs("button",{onClick:()=>n("details"),className:`
            px-4 py-3 text-sm font-medium transition-colors relative
            ${r==="details"?"text-[var(--color-text)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
          `,children:["Details",r==="details"&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[var(--color-primary)]"})]}),o.jsxs("button",{onClick:()=>n("changelog"),className:`
            px-4 py-3 text-sm font-medium transition-colors relative
            ${r==="changelog"?"text-[var(--color-text)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
          `,children:["Changelog",r==="changelog"&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[var(--color-primary)]"})]})]}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"flex-1 overflow-y-auto p-6 min-w-0",style:{width:"70%"},children:[r==="details"&&o.jsx(Tae,{content:S||"",isLoading:_,error:N instanceof Error?N.message:null,emptyMessage:"No details available"}),r==="changelog"&&o.jsx(Tae,{content:k||"",isLoading:j,error:E instanceof Error?E.message:null,emptyMessage:"No changelog available"})]}),o.jsxs("div",{className:"flex-shrink-0 w-72 overflow-y-auto p-6 border-l border-[var(--color-border)] bg-[var(--color-surface)]",style:{position:"sticky",top:0},children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Installation"}),o.jsxs("dl",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Identifier"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)] font-mono",children:e})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Version"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)]",children:v.version})]}),v.timestamp&&o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Last Updated"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)]",children:gSt(v.timestamp)})]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Marketplace"}),o.jsx("dl",{className:"space-y-2",children:v.timestamp&&o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Last Released"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)]",children:vSt(v.timestamp)})]})})]}),v.categories&&v.categories.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Categories"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:v.categories.map($=>o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-[var(--color-surface-hover)] text-[var(--color-text-secondary)]",children:$},$))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Resources"}),o.jsxs("ul",{className:"space-y-2",children:[v.repository&&o.jsx("li",{children:o.jsxs("a",{href:v.repository,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-[var(--color-primary)] hover:underline",children:[o.jsx(a0,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Repository"}),o.jsx(Sl,{className:"w-3 h-3 ml-auto"})]})}),v.files?.license&&o.jsx("li",{children:o.jsxs("a",{href:v.files.license,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-[var(--color-primary)] hover:underline",children:[o.jsx(Bwe,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"License"}),o.jsx(Sl,{className:"w-3 h-3 ml-auto"})]})}),v.url&&o.jsx("li",{children:o.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-[var(--color-primary)] hover:underline",children:[o.jsx(Gae,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Marketplace"}),o.jsx(Sl,{className:"w-3 h-3 ml-auto"})]})})]})]})]})]}),o.jsx("style",{children:`
        .extension-readme-content {
          color: var(--color-text);
        }

        .extension-readme-content h1,
        .extension-readme-content h2,
        .extension-readme-content h3,
        .extension-readme-content h4,
        .extension-readme-content h5,
        .extension-readme-content h6 {
          color: var(--color-text);
          font-weight: 600;
          margin-top: 1.5em;
          margin-bottom: 0.5em;
        }

        .extension-readme-content h1 {
          font-size: 1.5rem;
          border-bottom: 1px solid var(--color-border);
          padding-bottom: 0.3em;
        }

        .extension-readme-content h2 {
          font-size: 1.25rem;
          border-bottom: 1px solid var(--color-border);
          padding-bottom: 0.3em;
        }

        .extension-readme-content h3 {
          font-size: 1.1rem;
        }

        .extension-readme-content p {
          margin-bottom: 1em;
          line-height: 1.6;
        }

        .extension-readme-content a {
          color: var(--color-primary);
          text-decoration: none;
        }

        .extension-readme-content a:hover {
          text-decoration: underline;
        }

        .extension-readme-content code {
          background-color: var(--color-surface-hover);
          border-radius: 0.25rem;
          padding: 0.125rem 0.375rem;
          font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
          font-size: 0.875em;
        }

        .extension-readme-content pre {
          background-color: var(--color-surface);
          border-radius: 0.375rem;
          padding: 0.75rem 1rem;
          overflow-x: auto;
          margin: 1em 0;
        }

        .extension-readme-content pre code {
          background-color: transparent;
          padding: 0;
          font-size: 0.875rem;
        }

        .extension-readme-content ul,
        .extension-readme-content ol {
          margin: 1em 0;
          padding-left: 2em;
        }

        .extension-readme-content li {
          margin-bottom: 0.25em;
        }

        .extension-readme-content blockquote {
          border-left: 4px solid var(--color-border);
          margin: 1em 0;
          padding-left: 1em;
          color: var(--color-text-secondary);
        }

        .extension-readme-content img {
          max-width: 100%;
          height: auto;
          border-radius: 0.375rem;
        }

        .extension-readme-content table {
          width: 100%;
          border-collapse: collapse;
          margin: 1em 0;
        }

        .extension-readme-content th,
        .extension-readme-content td {
          border: 1px solid var(--color-border);
          padding: 0.5em 1em;
          text-align: left;
        }

        .extension-readme-content th {
          background-color: var(--color-surface);
          font-weight: 600;
        }

        .extension-readme-content hr {
          border: none;
          border-top: 1px solid var(--color-border);
          margin: 2em 0;
        }
      `})]})}function xSt(e){return gt({queryKey:["document",e,"content"],queryFn:async()=>{if(!e)return null;const t=await fetch(`/api/documents/${e}`);if(!t.ok)throw new Error("Failed to fetch document");return await t.json()},enabled:!!e,staleTime:3e4})}function wSt(e){return e?hZe(e.contentType,e.title):"plaintext"}function SSt(){return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6","data-testid":"editor-no-file-selected",children:[o.jsx(Bs,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Select a File"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"Choose a file from the sidebar to view its content in the editor."})]})}function kSt({source:e,onSourceChange:t,isWorkspaceOpen:r,workspaceName:n}){return o.jsxs("div",{className:"flex items-center gap-1 p-1 bg-[var(--color-surface-hover)] rounded-lg",children:[o.jsxs("button",{onClick:()=>t("workspace"),className:`
          flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded transition-colors
          ${e==="workspace"?"bg-[var(--color-surface)] text-[var(--color-text)] shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
        `,title:r?`Workspace: ${n}`:"No workspace open",children:[o.jsx(Hwe,{className:"w-3 h-3"}),"Local"]}),o.jsxs("button",{onClick:()=>t("documents"),className:`
          flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded transition-colors
          ${e==="documents"?"bg-[var(--color-surface)] text-[var(--color-text)] shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
        `,children:[o.jsx(tie,{className:"w-3 h-3"}),"Docs"]})]})}function _St({activePanel:e,onPanelChange:t}){const r=[{id:"files",icon:Uwe,label:"Explorer"},{id:"search",icon:br,label:"Search"},{id:"extensions",icon:nie,label:"Extensions"}],n=[{id:"settings",icon:li,label:"Settings"}],a=i=>{const s=i.icon,l=e===i.id;return o.jsx("button",{onClick:()=>t(i.id),className:`
          w-10 h-10 flex items-center justify-center rounded-md transition-colors
          ${l?"bg-[var(--color-surface)] text-[var(--color-text)] shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)]"}
        `,title:i.label,"data-testid":`activity-bar-${i.id}`,"aria-pressed":l,children:o.jsx(s,{className:"w-5 h-5"})},i.id)};return o.jsxs("div",{className:"w-12 flex-shrink-0 bg-[var(--color-surface-hover)] border-r border-[var(--color-border)] flex flex-col justify-between items-center py-2","data-testid":"editor-activity-bar",children:[o.jsx("div",{className:"flex flex-col items-center gap-1",children:r.map(a)}),o.jsx("div",{className:"flex flex-col items-center gap-1",children:n.map(a)})]})}function NSt(){const[e,t]=w.useState(!1),[r,n]=w.useState(null),[a,i]=w.useState([]),[s,l]=w.useState(null),c=w.useRef(null);c.current=s;const u=w.useRef([]);u.current=a;const d=w.useRef(new Set),[f,m]=w.useState(null),[p,v]=w.useState("workspace"),[b,y]=w.useState(!1),[S,_]=w.useState(null),[N,k]=w.useState("files"),[j,E]=w.useState(()=>localStorage.getItem("editor.theme")||"stoneforge-dark"),T=w.useRef(null),O=w.useRef(null),R=w.useRef(null),[q,$]=w.useState("idle"),L=w.useRef(null),[A,M]=w.useState(null),[z,I]=w.useState(""),[B,F]=w.useState(null),[U,V]=w.useState(!1),K=w.useRef(null);w.useEffect(()=>{let X=!0;return oSt().then(()=>{X&&t(!0)}).catch(Oe=>{X&&(console.error("[FileEditorPage] Failed to initialize Monaco:",Oe),n(Oe instanceof Error?Oe.message:"Failed to initialize editor"))}),()=>{X=!1}},[]),w.useEffect(()=>()=>{R.current&&clearTimeout(R.current)},[]);const{isOpen:G,workspaceName:J,workspaceRoot:ee,entries:Y,isLoading:ie,error:fe,deleteFile:me,renameFile:te,readFileByPath:oe,writeFile:ce,refreshTree:Z,createFolder:ue}=g1(),[H,ge]=w.useState(!1),[de,re]=w.useState(null),{data:ne=[],isLoading:pe,isError:ke}=MB(),{data:we,isLoading:ve,isError:Le}=xSt(p==="documents"?f:null),Ae=w.useMemo(()=>a.find(X=>X.id===s)||null,[a,s]),Re=w.useCallback(()=>{const X=c.current;if(!X||!T.current)return;const Oe=T.current.getModel();if(!Oe)return;const Ke=Oe.getValue();i(be=>{const W=be.find(se=>se.id===X);return!W||W.content===Ke?be:be.map(se=>se.id===X?{...se,content:Ke}:se)})},[]);w.useEffect(()=>{if(p==="documents"&&we&&f){Re();const X={id:f,name:we.title||"Untitled",path:we.title||"Untitled",content:we.content||"",savedContent:we.content||"",language:wSt(we),source:"documents",isPreview:!1,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0};i(Oe=>{const Ke=Oe.findIndex(se=>se.id===f);if(Ke!==-1){const se=[...Oe];return se[Ke]={...se[Ke],...X,isPreview:se[Ke].isPreview},se}const be=c.current,W=Oe.findIndex(se=>se.id===be);if(W!==-1&&!Oe[W].isDirty){const se=[...Oe];return se[W]=X,se}return[...Oe,X]}),l(f)}},[p,we,f,Re]);const Ye=w.useCallback(async(X,Oe=!1)=>{if(X.nodeType==="folder")return;if(m(X.id),_(null),X.id!==c.current&&Re(),u.current.find(be=>be.id===X.id)){l(X.id),Oe&&i(be=>be.map(W=>W.id===X.id?{...W,isPreview:!1}:W));return}if(!d.current.has(X.id)&&p==="workspace"){d.current.add(X.id),y(!0);try{const be=await oe(X.path);if(!be)throw new Error("File not found");const W={id:X.id,name:be.name,path:be.path,content:be.content,savedContent:be.content,language:be.language||"plaintext",source:"workspace",isPreview:!Oe,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0};i(se=>{const xe=se.findIndex(st=>st.id===X.id);if(xe!==-1){if(Oe){const st=[...se];return st[xe]={...st[xe],isPreview:!1},st}return se}if(Oe)return[...se,W];const Ce=c.current,dt=se.findIndex(st=>st.id===Ce);if(dt!==-1&&!se[dt].isDirty){const st=[...se];return st[dt]=W,st}return[...se,W]}),l(X.id)}catch(be){_(be instanceof Error?be.message:"Failed to read file")}finally{d.current.delete(X.id),y(!1)}}},[p,oe,Re]),mt=w.useCallback(async X=>{await Ye(X,!0)},[Ye]),ot=w.useCallback(async X=>{try{await me(X),i(Oe=>{const Ke=Oe.filter(be=>be.path!==X&&!be.path.startsWith(X+"/"));return c.current&&(!Ke.find(W=>W.id===c.current)&&Ke.length>0?(l(Ke[0].id),m(Ke[0].id)):Ke.length===0&&(l(null),m(null))),Ke})}catch(Oe){throw console.error("Failed to delete file:",Oe),Oe}},[me]),Ot=w.useCallback(async(X,Oe)=>{try{await te(X,Oe),i(Ke=>Ke.map(be=>{if(be.path===X){const W=Oe.split("/").pop()||be.name;return{...be,id:Oe,path:Oe,name:W}}if(be.path.startsWith(X+"/")){const W=Oe+be.path.slice(X.length);return{...be,id:W,path:W}}return be})),c.current===X&&(l(Oe),m(Oe))}catch(Ke){throw console.error("Failed to rename file:",Ke),Ke}},[te]),rt=w.useCallback(async(X,Oe,Ke)=>{try{const be=X.split("/").pop()||"file";if(Ke==="copy"){const W=be.lastIndexOf("."),se=W>0?be.slice(0,W):be,xe=W>0?be.slice(W):"";let Ce=Oe?`${Oe}/${be}`:be,dt=0;for(;await oe(Ce);){dt++;const Ft=`${se} (${dt})${xe}`;if(Ce=Oe?`${Oe}/${Ft}`:Ft,dt>99)break}const st=await oe(X);if(st){const Tt=Ce.split("/").pop()||be;await ce({id:Ce,name:Tt,type:"file",path:Ce},st.content)}}else{const W=Oe?`${Oe}/${be}`:be;await te(X,W),i(se=>se.map(xe=>xe.path===X?{...xe,id:W,path:W}:xe))}await Z()}catch(be){throw console.error("Failed to paste file:",be),be}},[oe,ce,te,Z]),ze=w.useCallback(async(X,Oe,Ke)=>{Re();const be=a.find(W=>W.path===X);if(be){l(be.id),setTimeout(()=>{T.current&&(T.current.revealLineInCenter(Oe),T.current.setPosition({lineNumber:Oe,column:Ke}),T.current.focus())},50);return}m(X),_(null),y(!0);try{const W=await oe(X);if(!W)throw new Error("File not found");const se={id:X,name:W.name,path:W.path,content:W.content,savedContent:W.content,language:W.language||"plaintext",source:"workspace",isPreview:!0,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0};i(xe=>{const Ce=xe.findIndex(dt=>dt.isPreview&&!dt.isDirty);if(Ce!==-1){const dt=[...xe];return dt[Ce]=se,dt}return[...xe,se]}),l(X),setTimeout(()=>{T.current&&(T.current.revealLineInCenter(Oe),T.current.setPosition({lineNumber:Oe,column:Ke}),T.current.focus())},100)}catch(W){_(W instanceof Error?W.message:"Failed to read file")}finally{y(!1)}},[a,oe,Re]),bt=w.useCallback(X=>{X!==s&&Re(),l(X),a.find(Ke=>Ke.id===X)&&m(X)},[a,s,Re]),tt=w.useCallback(X=>{i(Oe=>{const Ke=Oe.findIndex(W=>W.id===X);if(Ke===-1)return Oe;const be=Oe.filter(W=>W.id!==X);if(s===X&&be.length>0){const W=Math.max(0,Ke-1);l(be[W]?.id||null),m(be[W]?.id||null)}else be.length===0&&(l(null),m(null));return be})},[s]),_e=w.useCallback(X=>{i(X)},[]),We=w.useCallback(X=>{s&&(i(Oe=>{const Ke=Oe.find(W=>W.id===s);return Ke?X!==void 0&&X===Ke.savedVersionId?(R.current&&(clearTimeout(R.current),R.current=null),!Ke.isDirty||Ke.isPreview||Ke.hasUnsavedChanges!==!1?Oe.map(se=>se.id===s?{...se,isDirty:!0,isPreview:!1,hasUnsavedChanges:!1}:se):Oe):!Ke.isDirty||Ke.isPreview||!Ke.hasUnsavedChanges?Oe.map(W=>W.id===s?{...W,isDirty:!0,isPreview:!1,hasUnsavedChanges:!0}:W):Oe:Oe}),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{R.current=null;const Oe=c.current;if(!Oe||!T.current)return;const Ke=T.current.getModel();if(!Ke)return;const be=Ke.getValue();i(W=>{const se=W.find(Ce=>Ce.id===Oe);if(!se)return W;const xe=be!==se.savedContent;return se.hasUnsavedChanges===xe?W:W.map(Ce=>Ce.id===Oe?{...Ce,hasUnsavedChanges:xe}:Ce)})},300))},[s]),Ve=w.useCallback(async X=>{const Oe=X||s;if(!Oe)return;const Ke=a.find(W=>W.id===Oe);if(!Ke||!Ke.hasUnsavedChanges)return;if(Ke.source!=="workspace"){re({type:"error",text:"Document saving is not yet supported"}),setTimeout(()=>re(null),3e3);return}ge(!0),re(null);const be=Oe===s&&T.current?T.current.getValue():Ke.content;try{const W={id:Ke.path,name:Ke.name,type:"file",path:Ke.path};await ce(W,be);const se=Oe===s&&T.current?T.current.getModel()?.getAlternativeVersionId()??0:Ke.savedVersionId;i(xe=>xe.map(Ce=>Ce.id===Oe?{...Ce,content:be,savedContent:be,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:se}:Ce)),re({type:"success",text:"File saved successfully"}),setTimeout(()=>re(null),2e3)}catch(W){const se=W instanceof Error?W.message:"Failed to save file";re({type:"error",text:se}),setTimeout(()=>re(null),5e3)}finally{ge(!1)}},[s,a,ce]),Mt=w.useCallback(X=>{v(X),m(null),_(null)},[]),kt=w.useCallback(X=>{k(X),X==="search"&&setTimeout(()=>{O.current?.focus()},50)},[]),er=w.useCallback(X=>{E(X),localStorage.setItem("editor.theme",X)},[]),mr=w.useCallback(X=>{const Oe=`ext:${X.namespace}.${X.name}`,Ke=X.displayName||X.name;if(u.current.find(se=>se.id===Oe)){l(Oe);return}Re();const W={id:Oe,name:Ke,path:`Extension: ${Ke}`,content:"",savedContent:"",language:"plaintext",source:"extension",isPreview:!1,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0,extensionId:`${X.namespace}.${X.name}`};i(se=>{const xe=se.findIndex(Ce=>Ce.source==="extension");if(xe!==-1){const Ce=[...se];return Ce[xe]=W,Ce}return[...se,W]}),l(Oe)},[Re]);w.useEffect(()=>{const X=Oe=>{if((Oe.metaKey||Oe.ctrlKey)&&Oe.key.toLowerCase()==="s"&&!Oe.shiftKey){Oe.preventDefault(),Ve();return}if((Oe.metaKey||Oe.ctrlKey)&&Oe.shiftKey&&Oe.key.toLowerCase()==="f"){Oe.preventDefault(),k("search"),setTimeout(()=>{O.current?.focus()},50);return}if((Oe.metaKey||Oe.ctrlKey)&&Oe.key.toLowerCase()==="w"){Oe.preventDefault(),s&&tt(s);return}};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[s,tt,Ve]);const Zt=w.useCallback(X=>{M({type:X}),I(""),F(null),setTimeout(()=>K.current?.focus(),50)},[]),Wt=w.useCallback(()=>{M(null),I(""),F(null),V(!1)},[]),Rt=w.useCallback(async()=>{if(!A||U)return;const X=z.trim();if(!X){F("Please enter a name");return}if(X.startsWith("/")||X.endsWith("/")||X.includes("//")){F("Invalid path format");return}V(!0),F(null);try{if(A.type==="file"){const Oe=X.split("/"),Ke=Oe[Oe.length-1];await ce({id:X,name:Ke,type:"file",path:X},""),await Z(),Ye({id:X,name:Ke,nodeType:"file",path:X})}else await ue(X),await Z();Wt()}catch(Oe){V(!1),F(Oe instanceof Error?Oe.message:"Failed to create")}},[A,z,U,ce,ue,Z,Ye,Wt]),he=w.useCallback(()=>{L.current?.closeAll()},[]),De=p==="workspace"?ie:pe,Ue=p==="documents"?ve:b,ut=p==="workspace"?!!fe:ke,St=p==="documents"?Le:!!S,jt=p==="workspace"?Y.length===0:ne.length===0,Je=w.useMemo(()=>Ae?Ae.path:p==="workspace"&&G?`Workspace: ${J}`:p==="documents"?"Document library":"Open a workspace or select a document",[Ae,p,G,J]),Xe=w.useCallback(X=>{T.current=X},[]),it=w.useCallback(X=>{const Oe=c.current;Oe&&i(Ke=>Ke.map(be=>be.id===Oe&&be.savedVersionId===0?{...be,savedVersionId:X}:be))},[]),Xt=Ae?p1(Ae.name):null;return o.jsxs("div",{className:"h-full flex flex-col space-y-6 animate-fade-in","data-testid":"file-editor-page",children:[o.jsx("div",{className:"flex items-center justify-between","data-testid":"editor-header",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Bs,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Editor"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:Je})]})]})}),o.jsxs("div",{className:"flex-1 flex overflow-hidden rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":"editor-main-content",children:[o.jsx(_St,{activePanel:N,onPanelChange:kt}),o.jsxs("div",{className:"w-64 flex-shrink-0 border-r border-[var(--color-border)] flex flex-col overflow-hidden","data-testid":"editor-sidebar",children:[N==="files"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)] space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Explorer"}),o.jsx(kSt,{source:p,onSourceChange:Mt,isWorkspaceOpen:G,workspaceName:J})]}),p==="workspace"&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:Z,disabled:ie,className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors disabled:opacity-50",title:"Refresh",children:o.jsx(jr,{className:`w-3 h-3 ${ie?"animate-spin":""}`})}),o.jsx("button",{onClick:()=>Zt("file"),className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors",title:"New File",children:o.jsx(Iae,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>Zt("folder"),className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors",title:"New Folder",children:o.jsx(z6,{className:"w-3 h-3"})}),o.jsx("button",{onClick:he,className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors",title:"Collapse All",children:o.jsx($we,{className:"w-3 h-3"})}),o.jsx("span",{className:"flex-1 text-xs text-[var(--color-text-muted)] truncate ml-1",children:J||"Workspace"})]})]}),o.jsx("div",{className:"flex-1 flex flex-col overflow-hidden","data-testid":"editor-file-tree-container",children:De?o.jsx("div",{className:"flex items-center justify-center py-8","data-testid":"editor-loading-tree",children:o.jsx($e,{className:"w-5 h-5 animate-spin text-[var(--color-text-muted)]"})}):ut?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center","data-testid":"editor-error-tree",children:[o.jsx(Bt,{className:"w-5 h-5 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:p==="workspace"?fe:"Failed to load documents"})]}):jt?o.jsx("div",{className:"text-center py-8","data-testid":"editor-empty-tree",children:o.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:p==="workspace"?"No files found":"No documents available"})}):o.jsx(Jxt,{ref:L,workspaceEntries:Y,documents:ne,source:p,selectedId:f,onSelectFile:Ye,onDoubleClickFile:mt,onDeleteFile:p==="workspace"?ot:void 0,onRenameFile:p==="workspace"?Ot:void 0,onPasteFile:p==="workspace"?rt:void 0,onMoveFile:p==="workspace"?Ot:void 0,workspaceRoot:ee})})]}),N==="search"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Search"})}),o.jsx(t1t,{ref:O,onSelectResult:ze})]}),N==="extensions"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Extensions"})}),o.jsx(Q1t,{onExtensionClick:mr})]}),N==="settings"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Settings"})}),o.jsx(L1t,{theme:j,onThemeChange:er})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden","data-testid":"editor-panel",children:[o.jsx(rwt,{tabs:a,activeTabId:s,onTabSelect:bt,onTabClose:tt,onTabsReorder:_e,onSaveRequest:Ve}),r?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6","data-testid":"editor-monaco-error",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Editor Failed to Load"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:r})]}):e?a.length===0?o.jsx(SSt,{}):Ue?o.jsx("div",{className:"flex items-center justify-center h-full","data-testid":"editor-loading-content",children:o.jsx($e,{className:"w-8 h-8 animate-spin text-[var(--color-text-muted)]"})}):St||S?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6","data-testid":"editor-error-content",children:[o.jsx(Bt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Failed to Load"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:S||"Could not load the file content."})]}):Ae?Ae.source==="extension"?o.jsx(ySt,{extensionId:Ae.extensionId,className:"flex-1 overflow-auto"}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Fwe,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:Xt?.displayName||"Plain Text"})]}),OC(Ae.language)&&o.jsxs("div",{className:`flex items-center gap-1.5 text-xs ${q==="connected"?"text-green-500":q==="connecting"?"text-yellow-500":q==="error"?"text-red-500":"text-[var(--color-text-muted)]"}`,title:q==="connected"?"LSP connected - Autocompletion, hover info, and diagnostics active":q==="connecting"?"Connecting to language server...":q==="error"?"LSP connection failed":q==="unavailable"?"Language server not available":"LSP idle",children:[o.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${q==="connected"?"bg-green-500":q==="connecting"?"bg-yellow-500 animate-pulse":q==="error"?"bg-red-500":"bg-[var(--color-text-muted)]"}`}),o.jsx("span",{children:"LSP"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[de&&o.jsxs("div",{className:`flex items-center gap-1.5 text-xs ${de.type==="success"?"text-green-500":"text-[var(--color-danger)]"}`,"data-testid":"save-message",children:[de.type==="success"?o.jsx(Pi,{className:"w-3.5 h-3.5"}):o.jsx(Bt,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:de.text})]}),Ae.source==="workspace"&&o.jsxs("button",{onClick:()=>Ve(),disabled:!Ae.hasUnsavedChanges||H,className:`
                          flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded transition-colors
                          ${Ae.hasUnsavedChanges?"text-[var(--color-primary)] hover:bg-[var(--color-surface)] cursor-pointer":"text-[var(--color-text-muted)] cursor-not-allowed"}
                          disabled:opacity-50
                        `,title:Ae.hasUnsavedChanges?"Save (Cmd+S)":"No unsaved changes","data-testid":"save-button",children:[H?o.jsx($e,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(XC,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Save"})]}),Ae.source==="documents"&&o.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Read Only"})]})]}),o.jsx(mSt,{value:Ae.content,language:Ae.language,theme:j,readOnly:Ae.source==="documents",onChange:We,onMount:Xe,onReady:it,onLspStateChange:$,filePath:Ae.source==="workspace"?Ae.path:void 0,className:"flex-1"})]}):null:o.jsxs("div",{className:"flex flex-col items-center justify-center h-full","data-testid":"editor-monaco-loading",children:[o.jsx($e,{className:"w-8 h-8 animate-spin text-[var(--color-text-muted)] mb-3"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Initializing editor..."})]})]})]}),A&&o.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",onClick:U?void 0:Wt,children:o.jsxs("div",{className:"bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-xl w-full max-w-sm p-4",onClick:X=>X.stopPropagation(),"data-testid":"create-popup-dialog",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-3",children:A.type==="file"?"New File":"New Folder"}),o.jsx("label",{className:"block text-xs text-[var(--color-text-secondary)] mb-1",children:A.type==="file"?"Enter file name:":"Enter folder name:"}),o.jsx("input",{ref:K,type:"text",value:z,onChange:X=>{I(X.target.value),F(null)},onKeyDown:X=>{X.key==="Enter"?(X.preventDefault(),Rt()):X.key==="Escape"&&(X.preventDefault(),U||Wt())},placeholder:A.type==="file"?"e.g. src/utils/helpers.ts":"e.g. src/components/ui",className:"w-full bg-[var(--color-bg)] border border-[var(--color-border)] rounded px-3 py-1.5 text-sm text-[var(--color-text)] outline-none focus:border-[var(--color-primary)] transition-colors disabled:opacity-50",disabled:U,"data-testid":"create-popup-input"}),B&&o.jsx("p",{className:"text-xs text-[var(--color-danger)] mt-1","data-testid":"create-popup-error",children:B}),o.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[o.jsx("button",{onClick:Wt,className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] rounded transition-colors disabled:opacity-50",disabled:U,"data-testid":"create-popup-cancel",children:"Cancel"}),o.jsxs("button",{onClick:Rt,className:"px-3 py-1.5 text-xs font-medium text-white bg-[var(--color-primary)] hover:opacity-90 rounded transition-colors disabled:opacity-50 flex items-center gap-1.5",disabled:U,"data-testid":"create-popup-submit",children:[U&&o.jsx($e,{className:"w-3 h-3 animate-spin"}),U?"Creating":"Create"]})]})]})})]})}function CSt(){const{location:e}=UC();return e.pathname.startsWith("/popout")?o.jsx(Lae,{}):o.jsx(oXe,{})}const Si=W1e({component:CSt}),jSt=yi({getParentRoute:()=>Si,path:"/",beforeLoad:()=>{throw G1e({to:"/activity"})}}),ESt=yi({getParentRoute:()=>Si,path:"/activity",component:MXe}),MSt=yi({getParentRoute:()=>Si,path:"/tasks",component:yrt,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,page:typeof e.page=="number"?e.page:typeof e.page=="string"&&parseInt(e.page,10)||1,limit:typeof e.limit=="number"?e.limit:typeof e.limit=="string"&&parseInt(e.limit,10)||25,status:typeof e.status=="string"?e.status:void 0,assignee:typeof e.assignee=="string"?e.assignee:void 0,showClosed:e.showClosed===!0||e.showClosed==="true"?!0:void 0,action:typeof e.action=="string"?e.action:void 0,backlog:e.backlog===!0||e.backlog==="true"?!0:void 0})}),TSt=yi({getParentRoute:()=>Si,path:"/plans",component:krt,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,status:typeof e.status=="string"?e.status:void 0})}),ASt=yi({getParentRoute:()=>Si,path:"/agents",component:Ict,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,tab:typeof e.tab=="string"?e.tab:"agents",role:typeof e.role=="string"?e.role:void 0})}),DSt=yi({getParentRoute:()=>Si,path:"/workspaces",component:$ut,validateSearch:e=>({layout:typeof e.layout=="string"?e.layout:"single",agent:typeof e.agent=="string"?e.agent:void 0,resumeSessionId:typeof e.resumeSessionId=="string"?e.resumeSessionId:void 0,resumePrompt:typeof e.resumePrompt=="string"?e.resumePrompt:void 0})}),LSt=yi({getParentRoute:()=>Si,path:"/workflows",component:Cdt,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,tab:typeof e.tab=="string"?e.tab:"templates"})}),OSt=yi({getParentRoute:()=>Si,path:"/metrics",component:Odt,validateSearch:e=>({range:typeof e.range=="string"?e.range:"7d"})}),ISt=yi({getParentRoute:()=>Si,path:"/settings",component:Idt,validateSearch:e=>({tab:typeof e.tab=="string"?e.tab:"preferences"})}),RSt=yi({getParentRoute:()=>Si,path:"/inbox",component:uft,validateSearch:e=>({message:typeof e.message=="string"?e.message:void 0})}),PSt=yi({getParentRoute:()=>Si,path:"/messages",component:Jpt,validateSearch:e=>({channel:typeof e.channel=="string"?e.channel:void 0,message:typeof e.message=="string"?e.message:void 0})}),zSt=yi({getParentRoute:()=>Si,path:"/documents",component:Ext,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,library:typeof e.library=="string"?e.library:void 0})}),BSt=yi({getParentRoute:()=>Si,path:"/merge-requests",component:Bxt,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,status:typeof e.status=="string"?e.status:void 0,showMerged:e.showMerged===!0||e.showMerged==="true"?!0:void 0})}),$St=yi({getParentRoute:()=>Si,path:"/editor",component:NSt}),Dye=yi({getParentRoute:()=>Si,path:"/popout"}),FSt=yi({getParentRoute:()=>Dye,path:"/terminal",component:Udt,validateSearch:e=>({agent:typeof e.agent=="string"?e.agent:void 0,type:typeof e.type=="string"?e.type:"terminal",name:typeof e.name=="string"?e.name:void 0,role:typeof e.role=="string"?e.role:void 0,mode:typeof e.mode=="string"?e.mode:void 0})}),USt=Si.addChildren([jSt,ESt,MSt,TSt,ASt,DSt,LSt,OSt,ISt,RSt,PSt,zSt,BSt,$St,Dye.addChildren([FSt])]),HSt=K1e({routeTree:USt});function qSt({totalElements:e,showProgress:t}){return o.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50","data-testid":"data-preloader-loading",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[o.jsx("div",{className:"absolute inset-0 border-4 border-gray-200 rounded-full"}),o.jsx("div",{className:"absolute inset-0 border-4 border-blue-500 rounded-full animate-spin",style:{borderTopColor:"transparent",borderRightColor:"transparent"}})]}),o.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Stoneforge"}),t&&o.jsx("p",{className:"text-sm text-gray-500",children:e>0?`Loaded ${e.toLocaleString()} elements`:"Fetching data..."})]})})}function WSt({error:e,onRetry:t}){return o.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50","data-testid":"data-preloader-error",children:o.jsxs("div",{className:"text-center max-w-md p-6",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-100 flex items-center justify-center",children:o.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Failed to Load Data"}),o.jsx("p",{className:"text-sm text-gray-500 mb-4",children:e?.message||"An error occurred while loading the application data."}),o.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]})})}function KSt({children:e}){const t=MJe();return v2({channels:["*"],onEvent:r=>{t(r)},autoInvalidate:!0}),o.jsx(o.Fragment,{children:e})}function GSt({children:e,showProgress:t=!0,errorFallback:r}){const{isLoading:n,isError:a,error:i,totalElements:s,refetch:l}=_Je();return n?o.jsx(qSt,{totalElements:s,showProgress:t}):a?r?o.jsx(o.Fragment,{children:r}):o.jsx(WSt,{error:i,onRetry:()=>l()}):o.jsx(KSt,{children:e})}function VSt(){const e=localStorage.getItem("settings.theme"),t=e==="light"||e==="dark"||e==="system"?e:"system",r=window.matchMedia("(prefers-color-scheme: dark)").matches,n=document.documentElement;n.classList.remove("dark","theme-dark","theme-light"),(t==="system"?r?"dark":"light":t)==="dark"?n.classList.add("dark","theme-dark"):n.classList.add("theme-light")}VSt();const YSt=new V1e({defaultOptions:{queries:{staleTime:1e3*60,refetchOnWindowFocus:!0}}});ySe.createRoot(document.getElementById("root")).render(o.jsx(w.StrictMode,{children:o.jsx(Y1e,{client:YSt,children:o.jsx(uZe,{children:o.jsx(yZe,{children:o.jsxs(QSe,{children:[o.jsx(GSt,{children:o.jsx(Q1e,{router:HSt})}),o.jsx(qwe,{position:"bottom-right",duration:5e3,richColors:!0,closeButton:!0})]})})})})}));
